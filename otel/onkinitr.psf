; CASEMaker AcuBench Program Structure File, Version 9.2
; WARNING: DO NOT MODIFY THIS FILE!

[PROGRAM_CONTENT]
QUIT_CONFIRM=0
MAIN_SCREEN_NAME=Form1

{{@DESCRIPTION:

@}}

[WORKING_STORAGE]
m_nType=1
m_strName=Working Storage
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionWK

@}}
[FDITEM0_WK]
m_strName=rapor-acenta
m_strRawPic=x(04)
m_strPic=x(04)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_WK

@}}
[FDITEM1_WK]
m_strName=mesaj
m_strRawPic=x(60)
m_strPic=x(60)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_WK

@}}
[FDITEM2_WK]
m_strName=ilk-tarih
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM2_WK

@}}
[FDITEM3_WK]
m_nType=10
m_strName=ilk-yil
m_strRawPic=9(04)
m_strPic=9(04)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM3_WK

@}}
[FDITEM4_WK]
m_nType=10
m_strName=ilk-ay
m_strRawPic=9(02)
m_strPic=9(02)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM4_WK

@}}
[FDITEM5_WK]
m_nType=10
m_strName=ilk-gun
m_strRawPic=9(02)
m_strPic=9(02)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_rapor_y__1
{{@DataItem_m_strDescriptionFDITEM5_WK

@}}
[FDITEM6_WK]
m_strName=gidis-id
m_strRawPic=9(04)
m_strPic=9(04)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM6_WK

@}}
[FDITEM7_WK]
m_strName=gec-gecme
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM7_WK

@}}
[FDITEM8_WK]
m_strName=borc-tutar-tl
m_strRawPic=s9(15)v99
m_strPic=s9(15)v99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM8_WK

@}}
[FDITEM9_WK]
m_strName=alac-tutar-tl
m_strRawPic=s9(15)v99
m_strPic=s9(15)v99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM9_WK

@}}
[FDITEM10_WK]
m_strName=i
m_strRawPic=99
m_strPic=99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_alac_tu__1
{{@DataItem_m_strDescriptionFDITEM10_WK

@}}
[FDITEM11_WK]
m_strName=ilk-tur
m_strRawPic=9
m_strPic=9
m_strDefaultValue=0
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_alac_tu__1
{{@DataItem_m_strDescriptionFDITEM11_WK

@}}
[FDITEM12_WK]
m_nType=10
m_strName=Small-Font
m_nUsage=37
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM12_WK

@}}
[FDITEM13_WK]
m_nType=10
m_strName=Form1-Handle
m_nUsage=24
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM13_WK

@}}
[FDITEM14_WK]
m_nType=10
m_strName=Default-Font
m_nUsage=38
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM14_WK

@}}
[FDITEM15_WK]
m_nType=10
m_strName=Form1-St-1-Handle
m_nUsage=51
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM15_WK

@}}
[FDITEM16_WK]
m_strName=link-var
m_strRawPic=9
m_strPic=9
m_nUsage=2
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM16_WK

@}}
[FDITEM17_WK]
m_nType=10
m_strName=cb-kaynak
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM17_WK

@}}


[LINKAGE_SECTION]
m_nType=1
m_strName=Linkage Section
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionLK

@}}
[FDITEM0_LK]
m_strName=Lnk-item01
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_LK

@}}


{{@SCREEN:
*   Screen Painter Data
*   Schema 6.0
*
BEGIN-SPDATA

GRAPHICAL-SCREEN

Begin Screen Form1
   PREFIX            = Form1
   LOCK-CONTROL      = FALSE
   (Name)            = Form1
   Absolute Column   = 0
   Absolute Line     = 0
   Action            = (None)
   Auto Minimize     = FALSE
   Auto Resize       = FALSE
   Bind To Thread    = FALSE
   Boxed             = FALSE
   Cell              = TRUE
   Cell Height       = 10
   Cell Measure      = Pixels
   Cell Width        = 10
   Color             = 65793
   Controls Uncropped = FALSE
   Erase Screen      = FALSE
   Font              = Small Font
   Font Variable     = Small-Font
   Handle Variable   = Form1-Handle
   Help ID           = 301002
   Label Offset      = 0
   Layout Manager    = None
   Lines             = 17.00
   Link To Thread    = TRUE
   Max Lines         = 0.00
   Max Size          = 0.00
   Measuring Control = Label
   Measuring Font    = Default Font
   Measuring Style   = [None]
   Min Lines         = 0.00
   Min Size          = 0.00
   Modeless          = FALSE
   No Close          = FALSE
   Resizable         = FALSE
   Scroll            = FALSE
   Size              = 32.00
   System Menu       = TRUE
   Title             = "Onkasayi Referanslara Dagit......"
   Title Bar         = TRUE
   Unit              = Cells
   User Gray         = TRUE
   User White        = TRUE
   Visible           = 1:TRUE
   Window Type       = Floating
   Wrap              = FALSE
   Event Procedure   = Form1-Event-Proc
   Exception Procedure = Form1-Exception-Proc
   Other(ex)         = exception-procedure
   Before Create     = Form1-Bef-Create
   After Initdata    = Form1-Aft-Initdata
   After Routine     = Form1-Aft-Routine
   Begin Frame Form1-Fr-1
      SCREEN-COL        = 1.60
      SCREEN-LINE       = 1.50
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Fr-1
      3D Style          = Raised
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 1.60
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 1
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.50
      Lines             = 6.70
      Low Color         = 0
      Size              = 30.40
      Tab Order         = 1
      Thickness         = Default
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Frame Form1-Fr-2
         SCREEN-COL        = 2.20
         SCREEN-LINE       = 2.00
         LOCK-CONTROL      = FALSE
         (Name)            = Form1-Fr-2
         3D Style          = Lowered
         Alternate         = FALSE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 1.60
         Csize             = 0
         Destroy Type      = Automatic
         Font              = Default Font
         Full Height       = FALSE
         Help ID           = 0
         High Color        = 0
         ID                = 2
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 1.50
         Lines             = 5.30
         Low Color         = 0
         Size              = 29.30
         Tab Order         = 1
         Thickness         = Default
         Title Position    = 0:Unaligned
         Visible           = 1:TRUE
         Begin Label Form1-La-1
            SCREEN-COL        = 3.50
            SCREEN-LINE       = 4.00
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-La-1
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 2.30
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Font Variable     = Default-Font
            Help ID           = 0
            ID                = 4
            Justification     = Left
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 3.00
            Lines             = 2.00
            No Key Letter     = FALSE
            Size              = 7.00
            Tab Order         = 1
            Title             = "Tarih :"
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Entry-Field ef-rapor-gun
            SCREEN-COL        = 11.40
            SCREEN-LINE       = 4.00
            LOCK-CONTROL      = FALSE
            (Name)            = ef-rapor-gun
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 10.20
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 5
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 3.00
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 2
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 2.50
            Style             = Singleline
            Tab Order         = 2
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = ilk-gun
            Visible           = 1:TRUE
            Before Procedure  = Before-Procedure
         End
         Begin Entry-Field ef-rapor-ay
            SCREEN-COL        = 14.90
            SCREEN-LINE       = 4.00
            LOCK-CONTROL      = FALSE
            (Name)            = ef-rapor-ay
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 13.70
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 6
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 3.00
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 2
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 2.50
            Style             = Singleline
            Tab Order         = 3
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = ilk-ay
            Visible           = 1:TRUE
            Before Procedure  = Before-Procedure
         End
         Begin Entry-Field ef-rapor-yil
            SCREEN-COL        = 18.50
            SCREEN-LINE       = 4.00
            LOCK-CONTROL      = FALSE
            (Name)            = ef-rapor-yil
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 17.30
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 7
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 3.00
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 4
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 4.00
            Style             = Singleline
            Tab Order         = 4
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = ilk-yil
            Visible           = 1:TRUE
            Before Procedure  = Before-Procedure
         End
      End
   End
   Begin Status-Bar Form1-St-1
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-St-1
      Font              = Default Font
      Font Variable     = Default-Font
      Grip              = TRUE
      Handle Variable   = Form1-St-1-Handle
      PANEL-WIDTHS      = ( 80 )
      PANEL-STYLE       = ( 1 )
      Tab Order         = 2
   End
   Begin Push-Button Form1-Pb-1a
      SCREEN-COL        = 10.50
      SCREEN-LINE       = 12.50
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Pb-1a
      Bitmap Frame      = FALSE
      Bitmap Number     = 1
      Bitmap Square     = TRUE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 10.50
      Copy Resource     = TRUE
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Exception Value   = 2
      Flat              = FALSE
      Font              = Default Font
      Help ID           = 0
      ID                = 8
      Is Link           = FALSE
      Key               = 4
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 12.50
      Lines             = 3.00
      Multiline         = FALSE
      No Auto Default   = FALSE
      No Tab            = FALSE
      Self Act          = FALSE
      Size              = 10.80
      Style             = Other
      Tab Order         = 3
      Termination Value = 0
      Title             = "F2->&Basla       "
      Transparent Color = -1
      Visible           = 1:TRUE
      Before Procedure  = Before-Procedure
   End
   Begin Check-Box Form1-Cb-1
      SCREEN-COL        = 2.20
      SCREEN-LINE       = 9.00
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Cb-1
      Bitmap Frame      = FALSE
      Bitmap Number     = 1
      Bitmap Square     = TRUE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 2.20
      Copy Resource     = TRUE
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Exception Value   = 0
      Flat              = FALSE
      Font              = Small Font
      Font Variable     = Small-Font
      Help ID           = 0
      ID                = 3
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Left Text         = FALSE
      Line              = 9.00
      Lines             = 2.50
      Multiline         = FALSE
      No Tab            = FALSE
      Notify            = FALSE
      Self Act          = FALSE
      Size              = 25.80
      Tab Order         = 4
      Termination Value = 0
      Text Only         = FALSE
      Title             = "Hareketler Kaynak Foliodan"
      Value             = 1:TRUE
      Value Variable    = cb-kaynak
      Visible           = 1:TRUE
      Vtop              = FALSE
   End
End

END-SPDATA

@}}

{{@REPORT:
*   Report Writer Data
*   Schema 6.0
*
BEGIN-RWDATA-6.0A

END-RWDATA

@}}

{{@PARAGRAPH:
*
 Form1-Bef-Create.
       perform adresleri-tasi.
       open i-o   onkasar konuk cast 
       open input yromhrk  romhrk exthrk konum odalar onkasa depkod 
       call "c$narg" using link-var.
     .
 before-procedure.
     initialize mesaj.
     evaluate control-id
          when 5
          when 6
          when 7
          evaluate true
                  when turkce
                       move "Tarih Giriniz "   to mesaj
                  when ingilizce
                       move "Tarih Giriniz "   to mesaj
                  when almanca
                       move "Tarih Giriniz "   to mesaj
              end-evaluate
          
          when 8
          evaluate true
                  when turkce
                       move "Islemi Baslat  "   to mesaj
                  when ingilizce
                       move "Islemi Baslat  "   to mesaj
                  when almanca
                       move "Islemi Baslat  "   to mesaj
              end-evaluate
     end-evaluate.

            modify form1-st-1-handle,
            panel-index = 1 
            panel-text = mesaj.
     .
 exception-procedure.
     evaluate key-status
         when 2
              perform tarih-kontrol
              if gec-gecme = 0 
                     
                    perform islem-yap thru islem-yap-exit
                     
                    display message box "Islem Bitti...Transfer Tamam....."
                    move 27 to key-status 

              else 
                  move 4         to accept-control
                  move gidis-id  to control-id
              end-if 
        when 7
              open input takvim 
              initialize onkasa-rec
              start onkasa key > onkasa-anah  
                  invalid
                   continue
                   not invalid
                   perform until fs-onkasa = "10" 
                     read onkasa next no lock 
                        end move "10" to fs-onkasa
                        not end
                          if onkasa-tutar-tl > 0 then 
                               move onkasa-tarih to ilk-tarih
                               move "10" to fs-onkasa
                           end-if
                      end-read
                   end-perform 
             end-start

           move ilk-tarih to takvim-anah
           start takvim key >= takvim-anah invalid
              continue
              not invalid
                 perform until fs-takvim = "10"
                    read takvim next no lock 
                      end move "10" to fs-takvim
                      not end
                        if takvim-anah > tarih-tasi then 
                              move "10" to fs-takvim
                           else
                             move takvim-anah to ilk-tarih
                             perform islem-yap thru islem-yap-exit
                        end-if

                       
                   end-read
                 end-perform
          end-start
          close takvim
             display message box "Tum Islem Bitti...Transfer Tamam....."
             
        when 4
              open input takvim 
           move ilk-tarih to takvim-anah
           start takvim key >= takvim-anah invalid
              continue
              not invalid
                 perform until fs-takvim = "10"
                    read takvim next no lock 
                      end move "10" to fs-takvim
                      not end
                        if takvim-anah > tarih-tasi then 
                              move "10" to fs-takvim
                           else
                             move takvim-anah to ilk-tarih
                             perform islem-yap thru islem-yap-exit
                        end-if

                       
                   end-read
                 end-perform
          end-start
          close takvim
             display message box "Tum Islem Bitti...Transfer Tamam....."
             
     end-evaluate.

 islem-yap.
 islem-basla. 
    perform varying  i from 1 by 1 until i = 10
       
    initialize onkasar-rec

    move i         to onkasar-ref
    move ilk-tarih to onkasar-tarih
    start onkasar key not < onkasar-anah 
       invalid
          continue
     not invalid
    perform until fs-onkasar = "10"   
      read onkasar next no lock 
         end move "10" to fs-onkasar
         not end
          if onkasar-tarih > ilk-tarih or 
             onkasar-ref not = i 
               move "10" to fs-onkasar
            else
               if onkasar-dep   not = 888 and 
                  onkasar-dep   not = 999 
                
                  initialize onkasar-tutar-tl onkasar-tutar-dv
                             onkasar-corr-tutar-tl onkasar-corr-tutar-dv onkasaR-matrah-disi
                  rewrite onkasar-rec 
                     invalid continue
                  end-rewrite 
               end-if 
          end-if
      end-read
     end-perform
     end-start
     end-perform.


 yoda-bul.
       initialize yromhrk-rec.
       move ilk-tarih     to yromhrk-tarih.
       move spaces        to yromhrk-depkod.
       start yromhrk key not < yromhrk-anah2 invalid 
            go yoda-bul-exit.
 yoda-oku.
        read yromhrk next no lock end go yoda-bul-exit.
        if fs-yromhrk = 99 go yoda-oku.
*           display romhrk-anah line 05 col 15 color palet-07.
        if yromhrk-tarih > ilk-tarih go yoda-bul-exit.
        if yromhrk-tarih = ilk-tarih 
           continue
        else 
           go yoda-oku
        end-if.
        move yromhrk-depkod         to depkod-kodu        
         initialize hrkgir-rec.
           move yromhrk-rec   to hrkgir-rec.
        if yromhrk-corr-depkod > 0 then
           move yromhrk-corr-depkod to depkod-kodu
           read depkod no lock invalid
                display message box "hata ---25555"
           end-read
           if depkod-ref > 0 then 
              move depkod-ref to konum-ref
           else
              perform casttan-bul
           end-if

           move yromhrk-depkod         to depkod-kodu
           read depkod no lock invalid 
               display message box "hata ---2225555"
           end-read
        else
             move yromhrk-depkod       to depkod-kodu
             read depkod no lock invalid 
                 display message box "hata ---2225555"
             end-read
             if depkod-ref > 0 then 
                move depkod-ref to konum-ref
             else
                perform casttan-bul
             end-if
        end-if
             perform onkasar-artir thru onkasar-artir-exit
              if hrkgir-corr-depkod <> zeroes and depkod-turu = 2
                 perform onkasar-corr-artir
              end-if
*/Dovizler icin            
           go yoda-oku.
 yoda-bul-exit. 
    exit.









  
 oda-bul.
      if cb-kaynak = 1
          go oda-bul-exit
      end-if 
       initialize romhrk-rec.
       move ilk-tarih     to romhrk-tarih.
       move spaces        to romhrk-depkod.
       start romhrk key not < romhrk-anah2 invalid 
            go oda-bul-exit.
 oda-oku.
        read romhrk next no lock end go oda-bul-exit.
        if fs-romhrk = 99 go oda-oku.
*           display romhrk-anah line 05 col 15 color palet-07.
        if romhrk-tarih > ilk-tarih go oda-bul-exit.
        if romhrk-tarih = ilk-tarih 
           continue
        else 
           go oda-oku
        end-if.
        move romhrk-depkod         to depkod-kodu        
         initialize hrkgir-rec.
           move romhrk-rec   to hrkgir-rec.
        if romhrk-corr-depkod > 0 then
           move romhrk-corr-depkod to depkod-kodu
           read depkod no lock invalid
                display message box "hata ---25555"
           end-read
           if depkod-ref > 0 then 
              move depkod-ref to konum-ref
           else
              perform casttan-bul
           end-if

           move romhrk-depkod         to depkod-kodu
           read depkod no lock invalid 
               display message box "hata ---2225555"
           end-read
        else
             move romhrk-depkod       to depkod-kodu
             read depkod no lock invalid 
                 display message box "hata ---2225555"
             end-read
             if depkod-ref > 0 then 
                move depkod-ref to konum-ref
             else
                perform casttan-bul
             end-if
        end-if
             perform onkasar-artir thru onkasar-artir-exit
              if hrkgir-corr-depkod <> zeroes and depkod-turu = 2
                 perform onkasar-corr-artir
              end-if
*/Dovizler icin            
           go oda-oku.
 oda-bul-exit. 
    exit.
 ext-bul.
      if cb-kaynak = 1
          go ext-bul-exit
      end-if 
       initialize exthrk-rec.
       move ilk-tarih     to exthrk-tarih.
       move spaces        to exthrk-depkod.
      start exthrk key not < exthrk-anah2 invalid 
            go ext-bul-exit.
 ext-oku.
        read exthrk next no lock end go ext-bul-exit.
        if fs-exthrk = 99 go ext-oku.
*           display exthrk-anah line 05 col 15 color palet-07.
        if exthrk-tarih > ilk-tarih go ext-bul-exit.
        if exthrk-tarih = ilk-tarih 
           continue
        else 
           go ext-oku
        end-if.
        initialize hrkgir-rec.
           move exthrk-rec   to hrkgir-rec.
         move exthrk-depkod         to depkod-kodu
        if exthrk-corr-depkod > 0 then
          move exthrk-corr-depkod to depkod-kodu
          read depkod no lock invalid
             display message box "hata ---25555"
         end-read
          if depkod-ref > 0 then 
            move depkod-ref to konum-ref
            else
            perform casttan-bul
          end-if
           move exthrk-depkod         to depkod-kodu
             read depkod no lock invalid 
                 display message box "hata ---2225555"
             end-read
          else
              move exthrk-depkod         to depkod-kodu
             read depkod no lock invalid 
                 display message box "hata ---2225555"
             end-read
             if depkod-ref > 0 then 
               move depkod-ref to konum-ref
               else
              perform casttan-bul
             end-if
        
          
          end-if
           
             perform onkasar-artir   thru onkasar-artir-exit.
            if hrkgir-corr-depkod <> zeroes and depkod-turu = 2
              perform onkasar-corr-artir
           end-if

*/Dovizler icin
           go ext-oku.
 ext-bul-exit. 
       exit.

 islem-bitti. 
    
       go islem-yap-exit.
*
 casttan-bul.


     move hrkgir-folio to konuk-folio
     read konuk no lock invalid
          display message box "ONKINITR-KONUK-23444"
     end-read
     
     evaluate onkpara-referans-nerden     
          when 2  

              move hrkgir-folio to konuk-folio
             
              MOVE KONUK-ODAno TO odalar-anah
               if konuk-rez-no > 0 then 
                   move konuk-rez-no to cast-rez-no
               else
                   move konuk-extra-rez-no to cast-rez-no
              end-if
        
               move hrkgir-tarih to cast-tarih
               read cast no lock invalid
                      MOVE KONUK-ODAno TO odalar-anah

                 not invalid
                   if cast-oda-no > spaces
                      move cast-oda-no to odalar-anah
                      else
                        MOVE KONUK-ODAno TO odalar-anah
                   end-if
              end-read

              READ odalar NO LOCK INVALID
                    DISPLAY MESSAGE BOX "oda-KONUK-23644-oda " odalar-anah "- folyo " konuk-folio
              END-READ
              if odalar-referans >= 1 and  odalar-referans <= 9
                 continue
                 else
                 if ilk-tur = 0 
                    move 1 to ilk-tur
                    display message box odalar-anah " nolu odanin referans yok balans tutmayacaktir"
                 end-if
             end-if
              move odalar-referans to konum-ref
          when other
             move hrkgir-folio to konuk-folio
             read konuk no lock invalid
                  display message box "ONKINITR-KONUK-23444"
              end-read
            if konuk-rez-no > 0 then 
               move konuk-rez-no to cast-rez-no
               else
               move konuk-extra-rez-no to cast-rez-no
            end-if
        
               move hrkgir-tarih to cast-tarih
               read cast no lock invalid
                 if konuk-oda-konumu not > 0 then
                    move 1 to konuk-oda-konumu
                end-if
                 move xkonum-ref(konuk-oda-konumu) to konum-ref
                 
                 not invalid

                 |********move konuk-oda-konumu to cast-oda-konumu || silinecekkkkk 
 
                 if cast-oda-konumu > 0 then 
                         move xkonum-ref(cast-oda-konumu) to konum-ref
                 else
                    if konuk-oda-konumu not > 0 then
                       move 1 to konuk-oda-konumu
                    end-if
                     move xkonum-ref(konuk-oda-konumu) to konum-ref
                 end-if
               end-read
       end-evaluate
 
            if konum-ref < 1 and konum-ref > 3 then 
              stop " "
            end-if .
      

 onkasar-artir. 
       
       move hrkgir-tarih    to onkasar-tarih.
       move hrkgir-depkod   to onkasar-dep.
       move konum-ref       to onkasar-ref
       read onkasar no lock invalid go Onkasar-Yeni-Isle.
       compute onkasar-tutar-tl   = onkasar-tutar-tl + hrkgir-tl-tutar. 
       compute onkasar-tutar-dv   = onkasar-tutar-dv + hrkgir-dv-tutar.
       rewrite onkasar-rec invalid write onkasar-rec end-rewrite. 
       go onkasar-artir-exit.
 onkasar-yeni-isle. 
       initialize onkasar-rec.
       move konum-ref         to onkasar-ref
       move hrkgir-tarih      to onkasar-tarih.
       move hrkgir-depkod     to onkasar-dep.
       move hrkgir-tl-tutar   to onkasar-tutar-tl.
       move hrkgir-dv-tutar   to onkasar-tutar-dv.
       write onkasar-rec invalid rewrite onkasar-rec end-write. 
 onkasar-artir-exit. 
      if onkasar-ref = 2 then display onkasar-rec end-if. 
*      exit.

 son.
     continue.

 islem-yap-exit.
     exit.

*
 Form1-Aft-Initdata.
     open input genel
     move 1 to genel-anahtar
     read genel no lock invalid
          initialize mesaj-link
          move 03 to mesaj-no
          perform mesaj-ver
     not invalid
         continue
     end-read
     close genel

     move calisma-tarihi    to ilk-tarih
       if link-var = 1 and Lnk-item01 = 8 then 
             move tarih-tasi    to ilk-tarih
       end-if

     display form1.
     if link-var = 1 then 
      modify Form1-Pb-1a  visible = 0
        move 2 to key-status
        perform  exception-procedure
        set exit-pushed to true
        exit paragraph
    end-if
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
* 
 tarih-kontrol.
    initialize gec-gecme gidis-id
    open input takvim
    move ilk-tarih  to takvim-anah
    read takvim no lock invalid
          move 1 to gec-gecme
          initialize mesaj-link
          move 13 to mesaj-no
          perform mesaj-ver
          move 4 to accept-control
          move 7 to control-id gidis-id
    not invalid
        continue
    end-read
    close takvim.
*
*
 Form1-Aft-Routine.
       close  yromhrk konum onkasar konuk romhrk exthrk odalar onkasa depkod cast.
     .
 ref-bul.
     move hrkgir-folio to konuk-folio
     read konuk no lock invalid
          display message box "ONKINITR-KONUK-23444"
     end-read
     evaluate onkpara-referans-nerden     
         when 2  
              MOVE KONUK-ODAno TO odalar-anah
              READ odalar NO LOCK INVALID
                    DISPLAY MESSAGE BOX "oda-KONUK-23644-oda " odalar-anah "- folyo " konuk-folio
              END-READ  
              move odalar-referans to konum-ref

         when other  
         move konuk-oda-konumu to konum-anahtar
         read konum no lock invalid
              display message box "ONKINITR-KONUK-23644"
         end-read
          
         if konum-ref < 1 and konum-ref > 3 then 
            stop " "
         end-if
     end-evaluate.
*
*/CORRECTION
 onkasar-corr-artir.
       move hrkgir-tarih              to onkasar-tarih.
       move hrkgir-corr-depkod        to onkasar-dep.
       move konum-ref       to onkasar-ref
       read onkasar no lock invalid 
            initialize onkasar-rec
            move hrkgir-tarih         to onkasar-tarih
            move hrkgir-corr-depkod   to onkasar-dep
            move konum-ref       to onkasar-ref
       end-read

       initialize depkod-rec
       move hrkgir-corr-depkod  to depkod-anah
       read depkod no lock invalid
          continue 
       end-read 
          
       compute onkasar-corr-tutar-tl = onkasar-corr-tutar-tl + hrkgir-tl-tutar.
       compute onkasar-corr-tutar-dv = onkasar-corr-tutar-dv + hrkgir-dv-tutar.
       initialize depkod-rec 
       move hrkgir-depkod  to depkod-anah
       read depkod no lock invalid
           continue 
       end-read
 
       rewrite onkasar-rec invalid 
               write onkasar-rec end-write
       end-rewrite.



@}}

[KEY_STATUS_FIELD_FORMAT]
PIC=9(4)
USAGE=[None]

[KEYSTATUS_CONTENT:KS1]
CONDITION=Exit-Pushed
VALUE=27

[KEYSTATUS_CONTENT:KS2]
CONDITION=Message-Received
VALUE=95

[KEYSTATUS_CONTENT:KS3]
CONDITION=Event-Occurred
VALUE=96

[KEYSTATUS_CONTENT:KS4]
CONDITION=Screen-No-Input-Field
VALUE=97

[CODE_GENERATION_OPTIONS]
FOLLOW_PROJECT_OPTIONS=1
GENERATE_PROGRAM_FILE=1
GENERATE_WORKING_STORAGE=1
GENERATE_EVENT_PARAGRAPH=1
GENERATE_SCREEN_SECTION=1
GENERATE_REPORT_SECTION=1
GENERATE_PROCEDURE_DIVISION=1
GENERATE_MENU_PARAGRAPH=1
GENERATE_LINKAGE_SECTION=1
REPLACE_REMARK_PART=1
EXCLUDE_PROGRAM_VARIABLE=0
EXCLUDE_PROGRAM_PARAGRAPH=0
PROGRAM_EXTENSION=.cbl
WORKINGSTORAGE_EXTENSION=.wrk
EVENT_EXTENSION=.evt
SCREEN_EXTENSION=.scr
REPORT_EXTENSION=.rpt
PROCEDURE_EXTENSION=.prd
MENU_EXTENSION=.mnu
LINKAGE_EXTENSION=.lks
PROGRAM_FILE_READ_ONLY=0
LINK_CLOSE_TO_OPEN=0
COPYBOOK_READ_ONLY=0
GENERATE_COPY_FILES=1
ACCEPT_CONTROL=1
ANSI_DOCUMENT_FORMAT=0