; CASEMaker AcuBench Program Structure File, Version 9.2
; WARNING: DO NOT MODIFY THIS FILE!

[PROGRAM_CONTENT]
QUIT_CONFIRM=0
MAIN_SCREEN_NAME=Form1

{{@DESCRIPTION:

@}}

[WORKING_STORAGE]
m_nType=1
m_strName=Working Storage
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionWK

@}}
[FDITEM0_WK]
m_strName=link-var
m_strRawPic=9
m_strPic=9
m_nUsage=2
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_WK

@}}
[FDITEM1_WK]
m_strName=fs-mod-acenta
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_WK

@}}
[FDITEM2_WK]
m_strName=fs-ekodlar02
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM2_WK

@}}
[FDITEM3_WK]
m_strName=bf-anah
m_strRawPic=99
m_strPic=99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM3_WK

@}}
[FDITEM4_WK]
m_strName=i
m_strRawPic=99
m_strPic=99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM4_WK

@}}
[FDITEM5_WK]
m_strName=debug
m_strRawPic=9
m_strPic=9
m_strDefaultValue=0
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM5_WK

@}}
[FDITEM6_WK]
m_strName=bf-ulke
m_strRawPic=999
m_strPic=999
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM6_WK

@}}
[FDITEM7_WK]
m_strName=eski-konuk
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM7_WK

@}}
[FDITEM8_WK]
m_strName=son-rez
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM8_WK

@}}
[FDITEM9_WK]
m_strName=eski-balans
m_strRawPic=s9(10)v99
m_strPic=s9(10)v99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM9_WK

@}}
[FDITEM10_WK]
m_strName=yeni-balans
m_strRawPic=s9(10)v99
m_strPic=s9(10)v99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM10_WK

@}}
[FDITEM11_WK]
m_strName=kk
m_strRawPic=99
m_strPic=99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM11_WK

@}}
[FDITEM12_WK]
m_strName=rr
m_strRawPic=9999
m_strPic=9999
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM12_WK

@}}
[FDITEM13_WK]
m_strName=bossss
m_strRawPic=99
m_strPic=99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM13_WK

@}}
[FDITEM14_WK]
m_strName=evet-hayir
m_strRawPic=x
m_strPic=x
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM14_WK

@}}
[FDITEM15_WK]
m_strName=evet
m_nItemLevel=88
m_nSync=-1
m_bFixed=1
m_strTrue="e","E"
{{@DataItem_m_strDescriptionFDITEM15_WK

@}}
[FDITEM16_WK]
m_strName=hayir
m_nItemLevel=88
m_nSync=-1
m_bFixed=1
m_strTrue="h", "H"
{{@DataItem_m_strDescriptionFDITEM16_WK

@}}
[FDITEM17_WK]
m_strName=sayac-2
m_strRawPic=9(04)
m_strPic=9(04)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM17_WK

@}}
[FDITEM18_WK]
m_strName=k
m_strRawPic=999
m_strPic=999
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM18_WK

@}}
[FDITEM19_WK]
m_strName=klasac-unix
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM19_WK

@}}
[FDITEM20_WK]
m_strName=FILLER
m_strRawPic=x(26)
m_strPic=x(26)
m_strDefaultValue="mkdir /asya/ytl/data/otel/"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM20_WK

@}}
[FDITEM21_WK]
m_strName=sir1-adres
m_strRawPic=x(08)
m_strPic=x(08)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM21_WK

@}}
[FDITEM22_WK]
m_strName=FILLER
m_strRawPic=x(4)
m_strPic=x(4)
m_strDefaultValue="/tr1"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__1
{{@DataItem_m_strDescriptionFDITEM22_WK

@}}
[FDITEM23_WK]
m_strName=klasac-dos
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM23_WK

@}}
[FDITEM24_WK]
m_strName=FILLER
m_strRawPic=x(15)
m_strPic=x(15)
m_strDefaultValue="command.com /c "
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__1
{{@DataItem_m_strDescriptionFDITEM24_WK

@}}
[FDITEM25_WK]
m_strName=FILLER
m_strRawPic=x(26)
m_strPic=x(26)
m_strDefaultValue="mkdir \asya\ytl\data\otel\"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM25_WK

@}}
[FDITEM26_WK]
m_strName=sir2-adres
m_strRawPic=x(08)
m_strPic=x(08)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM26_WK

@}}
[FDITEM27_WK]
m_strName=FILLER
m_strRawPic=x(4)
m_strPic=x(4)
m_strDefaultValue="\tr1"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__1
{{@DataItem_m_strDescriptionFDITEM27_WK

@}}
[FDITEM28_WK]
m_strName=kopyala-unix
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM28_WK

@}}
[FDITEM29_WK]
m_strName=FILLER
m_strRawPic=x(23)
m_strPic=x(23)
m_strDefaultValue="cp /asya/ytl/data/otel/"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM29_WK

@}}
[FDITEM30_WK]
m_strName=copya-adres
m_strRawPic=x(08)
m_strPic=x(08)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM30_WK

@}}
[FDITEM31_WK]
m_strName=FILLER
m_strRawPic=x(1)
m_strPic=x(1)
m_strDefaultValue="/"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__1
{{@DataItem_m_strDescriptionFDITEM31_WK

@}}
[FDITEM32_WK]
m_strName=kopya-dosya
m_strRawPic=x(8)
m_strPic=x(8)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__1
{{@DataItem_m_strDescriptionFDITEM32_WK

@}}
[FDITEM33_WK]
m_strName=FILLER
m_strRawPic=x(21)
m_strPic=x(21)
m_strDefaultValue=" /asya/ytl/data/otel/"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__1
{{@DataItem_m_strDescriptionFDITEM33_WK

@}}
[FDITEM34_WK]
m_strName=paste-adres
m_strRawPic=x(08)
m_strPic=x(08)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__2
{{@DataItem_m_strDescriptionFDITEM34_WK

@}}
[FDITEM35_WK]
m_strName=FILLER
m_strRawPic=x(6)
m_strPic=x(6)
m_strDefaultValue="/tr1/."
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__1
{{@DataItem_m_strDescriptionFDITEM35_WK

@}}
[FDITEM36_WK]
m_strName=kopyala-dos
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM36_WK

@}}
[FDITEM37_WK]
m_strName=FILLER
m_strRawPic=x(15)
m_strPic=x(15)
m_strDefaultValue="command.com /c "
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__1
{{@DataItem_m_strDescriptionFDITEM37_WK

@}}
[FDITEM38_WK]
m_strName=FILLER
m_strRawPic=x(25)
m_strPic=x(25)
m_strDefaultValue="copy \asya\ytl\data\otel\"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__1
{{@DataItem_m_strDescriptionFDITEM38_WK

@}}
[FDITEM39_WK]
m_strName=copya2-adres
m_strRawPic=x(08)
m_strPic=x(08)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=copya_adres__1
{{@DataItem_m_strDescriptionFDITEM39_WK

@}}
[FDITEM40_WK]
m_strName=FILLER
m_strRawPic=x(1)
m_strPic=x(1)
m_strDefaultValue="\"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__1
{{@DataItem_m_strDescriptionFDITEM40_WK

@}}
[FDITEM41_WK]
m_strName=kopya2-dosya
m_strRawPic=x(8)
m_strPic=x(8)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__1
{{@DataItem_m_strDescriptionFDITEM41_WK

@}}
[FDITEM42_WK]
m_strName=FILLER
m_strRawPic=x(21)
m_strPic=x(21)
m_strDefaultValue=" \asya\ytl\data\otel\"
m_nItemLevel=2
m_bValue=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM42_WK

@}}
[FDITEM43_WK]
m_strName=paste2-adres
m_strRawPic=x(08)
m_strPic=x(08)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__2
{{@DataItem_m_strDescriptionFDITEM43_WK

@}}
[FDITEM44_WK]
m_strName=FILLER
m_strRawPic=x(5)
m_strPic=x(5)
m_strDefaultValue="\tr1"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_copya_a__1
{{@DataItem_m_strDescriptionFDITEM44_WK

@}}
[FDITEM45_WK]
m_strName=sonuc
m_strRawPic=s9
m_strPic=s9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM45_WK

@}}
[FDITEM46_WK]
m_nType=10
m_strName=Form1-Handle
m_nUsage=24
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM46_WK

@}}
[FDITEM47_WK]
m_nType=10
m_strName=vis-1
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM47_WK

@}}
[FDITEM48_WK]
m_nType=10
m_strName=Default-Font
m_nUsage=38
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM48_WK

@}}
[FDITEM49_WK]
m_nType=10
m_strName=Form1-Ef-1-Value
m_strRawPic=X(90)
m_strPic=X(90)
m_strDefaultValue="Bu Program MOD otel sistemindeki verileri alir"
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM49_WK

@}}
[FDITEM50_WK]
m_nType=10
m_strName=Form1-St-1-Handle
m_nUsage=51
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM50_WK

@}}
[FDITEM51_WK]
m_nType=10
m_strName=Small-Font
m_nUsage=37
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM51_WK

@}}
[FDITEM52_WK]
m_nType=10
m_strName=fiyat-value
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM52_WK

@}}
[FDITEM53_WK]
m_nType=10
m_strName=acenta-value
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM53_WK

@}}
[FDITEM54_WK]
m_nType=10
m_strName=acenta-eskisini-sil
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM54_WK

@}}
[FDITEM55_WK]
m_nType=10
m_strName=acenta-ustune-yaz
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM55_WK

@}}
[FDITEM56_WK]
m_nType=10
m_strName=fiyat-eskisini-sil
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM56_WK

@}}
[FDITEM57_WK]
m_nType=10
m_strName=rez-value
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM57_WK

@}}
[FDITEM58_WK]
m_nType=10
m_strName=rez-eskisini-sil
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM58_WK

@}}
[FDITEM59_WK]
m_nType=10
m_strName=konuk-value
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM59_WK

@}}
[FDITEM60_WK]
m_nType=10
m_strName=Histkonuk-value
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM60_WK

@}}
[FDITEM61_WK]
m_nType=10
m_strName=ilkleme-value
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM61_WK

@}}
[FDITEM62_WK]
m_nType=10
m_strName=hrk-value
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM62_WK

@}}


[LINKAGE_SECTION]
m_nType=1
m_strName=Linkage Section
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionLK

@}}


{{@SCREEN:
*   Screen Painter Data
*   Schema 6.0
*
BEGIN-SPDATA

GRAPHICAL-SCREEN

Begin Screen Form1
   PREFIX            = Form1
   LOCK-CONTROL      = FALSE
   (Name)            = Form1
   Absolute Column   = 0
   Absolute Line     = 0
   Action            = (None)
   Auto Minimize     = FALSE
   Auto Resize       = FALSE
   Bind To Thread    = FALSE
   Boxed             = FALSE
   Cell              = TRUE
   Cell Height       = 10
   Cell Measure      = Pixels
   Cell Width        = 10
   Color             = 65793
   Controls Uncropped = FALSE
   Erase Screen      = TRUE
   Font              = Default Font
   Handle Variable   = Form1-Handle
   Help ID           = 301002
   Label Offset      = 0
   Layout Manager    = None
   Lines             = 34.70
   Link To Thread    = TRUE
   Max Lines         = 0.00
   Max Size          = 0.00
   Measuring Control = Label
   Measuring Font    = Default Font
   Measuring Style   = [None]
   Min Lines         = 0.00
   Min Size          = 0.00
   Modeless          = FALSE
   No Close          = FALSE
   Resizable         = FALSE
   Scroll            = FALSE
   Size              = 46.50
   System Menu       = TRUE
   Title             = "Asya Dosya Transferi --1"
   Title Bar         = TRUE
   Unit              = Cells
   User Gray         = TRUE
   User White        = TRUE
   Visible           = 1:TRUE
   Window Type       = Floating
   Wrap              = FALSE
   Exception Procedure = Form1-Exception-Proc
   Other(ex)         = exception-procedure
   Before Create     = Form1-Bef-Create
   After Initdata    = Form1-Aft-Initdata
   Begin Frame Form1-Fr-1
      SCREEN-COL        = 1.60
      SCREEN-LINE       = 1.50
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Fr-1
      3D Style          = Raised
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 1.60
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 1
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.50
      Lines             = 25.60
      Low Color         = 0
      Size              = 45.50
      Tab Order         = 1
      Thickness         = Default
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Visible Variable  = vis-1
      Begin Frame Form1-Fr-2
         SCREEN-COL        = 2.10
         SCREEN-LINE       = 2.00
         LOCK-CONTROL      = FALSE
         (Name)            = Form1-Fr-2
         3D Style          = Lowered
         Alternate         = FALSE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 1.50
         Csize             = 0
         Destroy Type      = Automatic
         Font              = Default Font
         Full Height       = FALSE
         Help ID           = 0
         High Color        = 0
         ID                = 2
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 1.50
         Lines             = 23.70
         Low Color         = 0
         Size              = 44.50
         Tab Order         = 1
         Thickness         = Default
         Title Position    = 0:Unaligned
         Visible           = 1:TRUE
         Visible Variable  = vis-1
         Begin Label Form1-La-2
            SCREEN-COL        = 2.90
            SCREEN-LINE       = 22.30
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-La-2
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 5
            Column            = 1.80
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 12
            Justification     = Unaligned
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 21.30
            Lines             = 2.00
            No Key Letter     = FALSE
            Size              = 11.00
            Tab Order         = 1
            Title             = "Islem Durumu :"
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Label lb-isl-durumu
            SCREEN-COL        = 16.60
            SCREEN-LINE       = 11.20
            LOCK-CONTROL      = FALSE
            (Name)            = lb-isl-durumu
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 15.50
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 13
            Justification     = Unaligned
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 10.20
            Lines             = 2.00
            No Key Letter     = FALSE
            Size              = 17.00
            Tab Order         = 2
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Label lb-isl-durumu-1
            SCREEN-COL        = 35.60
            SCREEN-LINE       = 9.20
            LOCK-CONTROL      = FALSE
            (Name)            = lb-isl-durumu-1
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 34.50
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 14
            Justification     = Unaligned
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 8.20
            Lines             = 2.00
            No Key Letter     = FALSE
            Size              = 10.00
            Tab Order         = 3
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Entry-Field Form1-Ef-1
            SCREEN-COL        = 2.60
            SCREEN-LINE       = 3.00
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Ef-1
            Auto              = FALSE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 1.50
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Font Variable     = Default-Font
            Help ID           = 0
            ID                = 3
            Justification     = Center
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.00
            Lines             = 5.50
            Max Lines         = 0
            Max Text          = 0
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = TRUE
            Notify Change     = FALSE
            Numeric           = FALSE
            Read Only         = TRUE
            Required          = FALSE
            Secure            = FALSE
            Size              = 43.50
            Style             = Vscroll Bar
            Tab Order         = 4
            Use Return        = FALSE
            Use Tab           = FALSE
            Value             = "Bu Program MOD otel sistemindeki verileri alir"
            Value Multiple    = FALSE
            Value Picture     = X(90)
            Value Variable    = Form1-Ef-1-Value
            Visible           = 1:TRUE
            Visible Variable  = vis-1
         End
         Begin Check-Box Form1-Cb-1
            SCREEN-COL        = 6.10
            SCREEN-LINE       = 9.30
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 5.00
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Small Font
            Font Variable     = Small-Font
            Help ID           = 0
            ID                = 4
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 8.30
            Lines             = 1.60
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 12.70
            Tab Order         = 5
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Acentalari Transfer et"
            Value             = 1:TRUE
            Value Variable    = acenta-value
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1a
            SCREEN-COL        = 6.10
            SCREEN-LINE       = 11.50
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1a
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 5.00
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Small Font
            Font Variable     = Small-Font
            Help ID           = 0
            ID                = 5
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 10.50
            Lines             = 1.60
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 20.90
            Tab Order         = 6
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Kontrat Fiyatlari"
            Value             = 1:TRUE
            Value Variable    = fiyat-value
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1aa
            SCREEN-COL        = 6.10
            SCREEN-LINE       = 13.70
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1aa
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 5.00
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Small Font
            Font Variable     = Small-Font
            Help ID           = 0
            ID                = 6
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 12.70
            Lines             = 1.60
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 13.00
            Tab Order         = 7
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Rezervasyonlar"
            Value             = 1:TRUE
            Value Variable    = rez-value
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1ab
            SCREEN-COL        = 6.10
            SCREEN-LINE       = 15.70
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1ab
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 5.00
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Small Font
            Font Variable     = Small-Font
            Help ID           = 0
            ID                = 7
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 14.70
            Lines             = 1.60
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 20.90
            Tab Order         = 8
            Termination Value = 0
            Text Only         = FALSE
            Title             = "History konuk"
            Value             = 1:TRUE
            Value Variable    = Histkonuk-value
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1ac
            SCREEN-COL        = 6.10
            SCREEN-LINE       = 17.70
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1ac
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 5.00
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Small Font
            Font Variable     = Small-Font
            Help ID           = 0
            ID                = 8
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 16.70
            Lines             = 1.60
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 20.90
            Tab Order         = 9
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Ilklemeler"
            Value             = 1:TRUE
            Value Variable    = ilkleme-value
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1ad
            SCREEN-COL        = 6.20
            SCREEN-LINE       = 19.80
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1ad
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 5.10
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Small Font
            Font Variable     = Small-Font
            Help ID           = 0
            ID                = 9
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 18.80
            Lines             = 1.60
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 20.90
            Tab Order         = 10
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Hareketleri Al"
            Value             = 1:TRUE
            Value Variable    = hrk-value
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1b
            SCREEN-COL        = 20.20
            SCREEN-LINE       = 9.40
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1b
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 19.10
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Small Font
            Font Variable     = Small-Font
            Help ID           = 0
            ID                = 10
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 8.40
            Lines             = 1.60
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 13.10
            Tab Order         = 11
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Eski Dosyayi Sil"
            Value             = 1:TRUE
            Value Variable    = acenta-eskisini-sil
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1ba
            SCREEN-COL        = 34.10
            SCREEN-LINE       = 9.50
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1ba
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 33.00
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Small Font
            Font Variable     = Small-Font
            Help ID           = 0
            ID                = 15
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 8.50
            Lines             = 1.60
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 11.70
            Tab Order         = 12
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Ustune yaz"
            Value             = 1:TRUE
            Value Variable    = acenta-ustune-yaz
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1bb
            SCREEN-COL        = 20.10
            SCREEN-LINE       = 11.40
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1bb
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 19.00
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Small Font
            Font Variable     = Small-Font
            Help ID           = 0
            ID                = 16
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 10.40
            Lines             = 1.60
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 13.10
            Tab Order         = 13
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Eski Dosyayi Sil"
            Value             = 1:TRUE
            Value Variable    = fiyat-eskisini-sil
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1bc
            SCREEN-COL        = 20.00
            SCREEN-LINE       = 13.80
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1bc
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 18.90
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Small Font
            Font Variable     = Small-Font
            Help ID           = 0
            ID                = 17
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 12.80
            Lines             = 1.60
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 13.10
            Tab Order         = 14
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Eski Dosyayi Sil"
            Value             = 1:TRUE
            Value Variable    = rez-eskisini-sil
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
      End
   End
   Begin Status-Bar Form1-St-1
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-St-1
      Font              = Default Font
      Font Variable     = Default-Font
      Grip              = TRUE
      Handle Variable   = Form1-St-1-Handle
      PANEL-WIDTHS      = ( 80 )
      PANEL-STYLE       = ( 1 )
      Tab Order         = 2
   End
   Begin Push-Button Form1-Pb-1
      SCREEN-COL        = 16.00
      SCREEN-LINE       = 29.40
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Pb-1
      Bitmap Frame      = FALSE
      Bitmap Number     = 1
      Bitmap Square     = TRUE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 16.00
      Copy Resource     = TRUE
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Exception Value   = 2
      Flat              = FALSE
      Font              = Default Font
      Help ID           = 0
      ID                = 11
      Is Link           = FALSE
      Key               = 4
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 29.40
      Lines             = 3.50
      Multiline         = FALSE
      No Auto Default   = FALSE
      No Tab            = FALSE
      Self Act          = FALSE
      Size              = 16.50
      Style             = Other
      Tab Order         = 3
      Termination Value = 0
      Title             = "F2->Islem &Basla       "
      Transparent Color = -1
      Visible           = 1:TRUE
      Before Procedure  = Before-Procedure
   End
End

END-SPDATA

@}}

{{@REPORT:
*   Report Writer Data
*   Schema 6.0
*
BEGIN-RWDATA-6.0A

END-RWDATA

@}}

{{@PARAGRAPH:
*
 Form1-Bef-Create. 
      set environment "extra-keys-ok" to 1.
*       set enviroment "Flush-count" to 2048    
       perform adresleri-tasi .

       
      
*
 before-procedure. 
    
             .

 Form1-Aft-Initdata. 
    
    open input genel
    move 1 to genel-anahtar
    read genel no lock invalid
          initialize mesaj-link
          move 03 to mesaj-no
          perform mesaj-ver
    not invalid
        continue
    end-read
    close genel.

*      
 exception-procedure. 
     evaluate key-status
          when 2 
               open output trnot
*****               perform odeme-kodlari-duzelt
*****                perform doviz-duzelt               
                      perform islem-yap 
***                      perform fiyatlari-duzelt  
***                  perform inhouse-ozluk-al
               close trnot
               display  message box "Islem Bitti"  
            
     
          
         end-evaluate. 

         
           

*
 islem-yap. 
***         perform kur-al
****** sakýn alam bozarsin        perform mod-dep-al.
         
*        if ilkleme-value = 1 then perform ilklemeler end-if
        
        
*         if acenta-value = 1 then  perform acenta-al end-if
*         if fiyat-value  = 1 then  perform fiyatlar-al end-if 
         if rez-value = 1 then   perform rez-al end-if
***        if histkonuk-value = 1   then  perform hiskonuk-al end-if
***        if hrk-value = 1 then  perform hrk-al end-if
***         perform ali-cengiz.
*         perform cor-ali
        .
*
 ilklemeler.
         open output mod2asya  
        close mod2asya
        
        perform kodlar02-yaz

        
        perform konum-ac.
        perform doviz-al
        perform ulke-al.
        perform staf-al.
        perform oda-al.

 kodlar02-yaz.
        open output kodlar02 close kodlar02
        open i-o kodlar02
        open input ekodlar02 
        initialize ekodlar02-rec
        move "D" to ekodlar02-tipi
         
        start ekodlar02 key > ekodlar02-anah 
           invalid
             continue
           not invalid
            perform until ekodlar02-tipi not = "D"
              read ekodlar02 next no lock 
                 end move "Z" to ekodlar02-tipi
                 not end
                   if   ekodlar02-tipi = "D"
                      move ekodlar02-rec to kodlar02-rec  
                      write kodlar02-rec invalid 
                        stop " "
                      end-write
                   end-if
              end-read
            end-perform 

        end-start
        move "D" to kodlar02-tipi
        move "99"  to kodlar02-tipi
        move "OZEL FIYAT" to kodlar02-adi
         write kodlar02-rec end-write
        close ekodlar02.
        move "A" to kodlar02-tipi
        move "X" to PAN-ODA 
        move 1 to ODA-DEP  
 
        move "B " to kodlar02-kodu  move "BED            " to kodlar02-adi write kodlar02-rec end-write
        move "BB" to kodlar02-kodu  move "BED & Breakfast" to kodlar02-adi write kodlar02-rec end-write
        move "HB" to kodlar02-kodu  move "HALF Board     " to kodlar02-adi write kodlar02-rec end-write
        move "OB" to kodlar02-kodu  move "ONLY BED       " to kodlar02-adi write kodlar02-rec end-write
        move "FB" to kodlar02-kodu  move "FULL Board     " to kodlar02-adi write kodlar02-rec end-write
        move "AL" to kodlar02-kodu  move "All Inclusive  " to kodlar02-adi write kodlar02-rec end-write
        move "UL" to kodlar02-kodu  move "ULTRA ALL Inc  " to kodlar02-adi write kodlar02-rec end-write
        move "ML" to kodlar02-kodu  move "               " to kodlar02-adi write kodlar02-rec end-write
        
        move "B" to kodlar02-tipi
        
        move "01" to kodlar02-kodu  move "PESIN          " to kodlar02-adi 
        move "A" to ode-tipi  
        write kodlar02-rec end-write
        move "02" to kodlar02-kodu  move "KREDI          " to kodlar02-adi 
        move "B" to ode-tipi 
        write kodlar02-rec end-write
        move "20" to kodlar02-kodu  move "COMPLIMENTARY  " to kodlar02-adi 
        move "D" to ode-tipi move "H" to ode-posting  
        write kodlar02-rec end-write
        move "30" to kodlar02-kodu  move "ODENMEZ        " to kodlar02-adi 
        move "O" to ode-tipi 
        write kodlar02-rec end-write
        move "40" to kodlar02-kodu  move "HOUSE USE      " to kodlar02-adi 
        move "F" to ode-tipi 
        write kodlar02-rec end-write
        initialize kodlar02-rec
        move "G" to kodlar02-tipi

        move "TW" to kodlar02-kodu  move "TWIN BED       " to kodlar02-adi write kodlar02-rec end-write
        move "FR" to kodlar02-kodu  move "FRENCH BED     " to kodlar02-adi write kodlar02-rec end-write
        move "U " to kodlar02-kodu  move "TRIPLE         " to kodlar02-adi write kodlar02-rec end-write
        move "D " to kodlar02-kodu  move "QADRPL         " to kodlar02-adi write kodlar02-rec end-write
        move "B " to kodlar02-kodu  move "FIVE           " to kodlar02-adi write kodlar02-rec end-write
        move "SL" to kodlar02-kodu  move "SMALL ROOM     " to kodlar02-adi write kodlar02-rec end-write
        initialize kodlar02-rec
        move "F" to kodlar02-tipi
        move "01" to kodlar02-kodu  move "1. KAT         " to kodlar02-adi write kodlar02-rec end-write
        move "02" to kodlar02-kodu  move "2. KAT         " to kodlar02-adi write kodlar02-rec end-write
        move "03" to kodlar02-kodu  move "3. KAT         " to kodlar02-adi write kodlar02-rec end-write
        move "04" to kodlar02-kodu  move "4. KAT         " to kodlar02-adi write kodlar02-rec end-write
        move "05" to kodlar02-kodu  move "5. KAT         " to kodlar02-adi write kodlar02-rec end-write
        move "98" to kodlar02-kodu  move "BODRUM         " to kodlar02-adi write kodlar02-rec end-write
        move "99" to kodlar02-kodu  move "ZEMIN          " to kodlar02-adi write kodlar02-rec end-write
       

        initialize kodlar02-rec
        move "C" to kodlar02-tipi
        move "VC" to kodlar02-kodu  move "VACANCY CLEAN  " to kodlar02-adi write kodlar02-rec end-write
        
        
        
        close kodlar02.
        perform odeme-al
        perform pazar-al.
        .
*
 ulke-al.
       open i-o mod2asya
       open input ulkex
       
       open output ulke
       close ulke
       
       open i-o ulke
        initialize  fs-mod-acenta bf-ulke
         MOVE "AAA" TO ULKEX-ANAHTAR
         start ulkex key > ulkex-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read ulkex next no lock 
              end move "10" to fs-mod-acenta
              not end
                  initialize mod2asya-rec
                  move "ulke" to mod2asya-tip
                 move ulkex-anahtar to mod2asya-mod-kodu
                  add 1 to bf-ulke
                 move bf-ulke to mod2asya-asya-kodu
                 write mod2asya-rec invalid
                     display message box 
                         "Transfer dosya REWRITE--" new-line
                             mod2asya-rec  
                  end-write
                  move bf-ulke to ulke-anah1
                  move ulkex-adi     to ulke-adi
                  write ulke-rec invalid
                       stop " "
                  end-write
                 
                
             end-read
             end-perform
         end-start
       

       close ulkex ulke mod2asya.




*        
 acenta-al.
       open i-o mod2asya
       open i-o tmacenta
       
       open output acenta
       close acenta
       
       open i-o acenta
        initialize  fs-mod-acenta
        
            perform until fs-mod-acenta = "10"
            read tmacenta next no lock 
              end move "10" to fs-mod-acenta
              not end
                    if tmacenta-anlasma not > 0 and 
                    tmacenta-anlasma not < 99
                     then 
                     exit perform cycle
                     end-if
                      initialize mod2asya-rec
                  move "acenta" to mod2asya-tip
                 move tmacenta-anahtar to mod2asya-mod-kodu
                  if tmacenta-anlasma(2:1) = spaces then
                     move tmacenta-anlasma(1:1) to tmacenta-anlasma(2:1)
                     move "0" to tmacenta-anlasma(1:1)
                  rewrite tmacenta-rec end-rewrite
                  end-if 
                 move tmacenta-master to mod2asya-asya-kodu
                   
                  write mod2asya-rec invalid
                     display message box 
                         "Transfer dosya REWRITE--" new-line
                             mod2asya-rec  
                  end-write
               
             

                 
                  if tmacenta-anahtar = tmacenta-master then 
                  move tmacenta-anahtar to acenta-kodu
                  move tmacenta-adi     to acenta-adi
                  write acenta-rec invalid
                      
                           rewrite acenta-rec
                           display message box "Acenta-rec"
                      
                  end-write
                  end-if
                
             end-read
             end-perform
       

       close tmacenta acenta  mod2asya.

 odeme-al.
       
       open input odemex
       open i-o mod2asya
       initialize odemex-rec  mod2asya-rec  fs-mod-acenta
       start odemex key > odemex-kodu
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read odemex next no lock 
              end move "10" to fs-mod-acenta
              not end
                    initialize mod2asya-rec
                 move "odeme" to mod2asya-tip
              
                 move odemex-kodu to mod2asya-mod-kodu
                 evaluate odemex-tip
                    when "1"
                         move "01" to mod2asya-asya-kodu
                    when "4"
                    when "2"
                    
                       move "02" to mod2asya-asya-kodu
                    when "3"
                    when "7"
                       move "20" to mod2asya-asya-kodu
                    when "6"
                       move "30" to mod2asya-asya-kodu
                    when "5"
                       move "40" to mod2asya-asya-kodu
                    when other 
                       display message box "Beklenmeyen Mod Odeme tipi--" odemex-tip  
                 end-evaluate
                  
                  write mod2asya-rec invalid
                     display message box 
                         "Transfer dosya REWRITE--" new-line
                             mod2asya-rec  
                  end-write
               
             end-read

             end-perform
             end-start

       close odemex mod2asya
          
      .              
 eacenta-al.
       stop " "
       open input mod-acenta
       if acenta-eskisini-sil = 1 then 
       open output acenta
       close acenta
       end-if
       open i-o acenta
        initialize mod-acenta-rec  fs-mod-acenta
        start mod-acenta key > mod-acenta-anahtar
           invalid
            display message box "Acenta Yok"
            not invalid
            perform until fs-mod-acenta = "10"
            read mod-acenta next no lock 
              end move "10" to fs-mod-acenta
              not end
                  
                  move  mod-acenta-kodu  to acenta-kodu 
                  move  mod-acenta-adi   to acenta-adi
                  write acenta-rec invalid
                       if acenta-ustune-yaz = 1 
                           rewrite acenta-rec
                           display message box "Acenta-rec"
                       end-if
                  end-write
             end-read
             end-perform
         end-start


       close mod-acenta acenta
          
      .
 konum-al.
       
       open output konum
       close konum
       
       open input odatipx
       open i-o mod2asya konum
       initialize odatipx-rec bf-anah mod2asya-rec  fs-mod-acenta
       start odatipx key > odatipx-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read odatipx next no lock 
              end move "10" to fs-mod-acenta
              not end
                      initialize mod2asya-rec
                 move "konum" to mod2asya-tip
                 move odatipx-kodu to mod2asya-mod-kodu
                 add 1 to bf-anah 
                 move bf-anah to konum-anahtar mod2asya-asya-kodu
                 move odatipx-kodu   to KONUM-ADI
                 move odatipx-sayi to KONUM-TOP-ODA KONUM-HAZIR-ODA  
                   write konum-rec invalid
                     display message box 
                         "Transfer dosya KONUM--" new-line
                             konum-rec  
                  end-write

                  write mod2asya-rec invalid
                     display message box 
                         "Transfer dosya REWRITE--" new-line
                             mod2asya-rec  
                  end-write
               
             end-read

             end-perform
             end-start
                 initialize konum-rec mod2asya-rec
                 move "konum" to mod2asya-tip
                 move all spaces to mod2asya-mod-kodu
                 add 1 to bf-anah 
                 move bf-anah to konum-anahtar mod2asya-asya-kodu
                 move "P.M."   to KONUM-ADI
                 move 0 to KONUM-TOP-ODA KONUM-HAZIR-ODA  
                   write konum-rec invalid
                     display message box 
                         "Transfer dosya KONUM--" new-line
                             konum-rec  
                  end-write

                  write mod2asya-rec invalid
                     display message box 
                         "Transfer dosya REWRITE--" new-line
                             mod2asya-rec  
                  end-write

       close odatipx mod2asya konum.
*
 konum-ac.
       
       open output konum
       close konum
       
       open input odatipx
       open i-o mod2asya konum
       initialize odatipx-rec bf-anah mod2asya-rec  fs-mod-acenta
       
       
        initialize mod2asya-rec
        move "konum" to mod2asya-tip
        move "STD " to mod2asya-mod-kodu
        move "01" to konum-anahtar mod2asya-asya-kodu
        write mod2asya-rec invalid
            display message box 
                "Transfer dosya REWRITE--" new-line
                    mod2asya-rec  
        end-write         
        move "STD "  to KONUM-ADI
        move 61 to KONUM-TOP-ODA KONUM-HAZIR-ODA  
          write konum-rec invalid
            display message box 
                "Transfer dosya KONUM--" new-line
                    konum-rec  
         end-write
          
         initialize mod2asya-rec
        move "konum" to mod2asya-tip
        move "VSTD " to mod2asya-mod-kodu
        move "02" to konum-anahtar mod2asya-asya-kodu
        write mod2asya-rec invalid
            display message box 
                "Transfer dosya REWRITE--" new-line
                    mod2asya-rec  
        end-write         
        move "VSTD"  to KONUM-ADI
        move 78 to KONUM-TOP-ODA KONUM-HAZIR-ODA  
          write konum-rec invalid
            display message box 
                "Transfer dosya KONUM--" new-line
                    konum-rec  
         end-write
          
        
                   
         initialize mod2asya-rec
        move "konum" to mod2asya-tip
        move "TRP " to mod2asya-mod-kodu
        move "03" to konum-anahtar mod2asya-asya-kodu
        write mod2asya-rec invalid
            display message box 
                "Transfer dosya REWRITE--" new-line
                    mod2asya-rec  
        end-write         
        move "TRP "  to KONUM-ADI
        move 43 to KONUM-TOP-ODA KONUM-HAZIR-ODA  
          write konum-rec invalid
            display message box 
                "Transfer dosya KONUM--" new-line
                    konum-rec  
         end-write
          
                     
         initialize mod2asya-rec
        move "konum" to mod2asya-tip
        move "FAM " to mod2asya-mod-kodu
        move "04" to konum-anahtar mod2asya-asya-kodu
        write mod2asya-rec invalid
            display message box 
                "Transfer dosya REWRITE--" new-line
                    mod2asya-rec  
        end-write         
        move "FAM "  to KONUM-ADI
        move 118 to KONUM-TOP-ODA KONUM-HAZIR-ODA  
          write konum-rec invalid
            display message box 
                "Transfer dosya KONUM--" new-line
                    konum-rec  
         end-write
          
        
               
       
        initialize konum-rec mod2asya-rec
        move "konum" to mod2asya-tip
        move "SPAR" to mod2asya-mod-kodu
        add 1 to bf-anah 
        move "05" to konum-anahtar mod2asya-asya-kodu
        move "EKO "   to KONUM-ADI
        move 0 to KONUM-TOP-ODA KONUM-HAZIR-ODA  
          write konum-rec invalid
            display message box 
                "Transfer dosya KONUM--" new-line
                    konum-rec  
         end-write

         write mod2asya-rec invalid
            display message box 
                "Transfer dosya REWRITE--" new-line
                    mod2asya-rec  
         end-write

        initialize konum-rec mod2asya-rec
        move "konum" to mod2asya-tip
        move "DUMY" to mod2asya-mod-kodu
        add 1 to bf-anah 
        move "06" to konum-anahtar mod2asya-asya-kodu
        move "P.M."   to KONUM-ADI
        move 0 to KONUM-TOP-ODA KONUM-HAZIR-ODA  
          write konum-rec invalid
            display message box 
                "Transfer dosya KONUM--" new-line
                    konum-rec  
         end-write

         write mod2asya-rec invalid
            display message box 
                "Transfer dosya REWRITE--" new-line
                    mod2asya-rec  
         end-write

       close odatipx mod2asya konum.
     
*     
*
 pazar-al.
       
       
       
       
       open input reztipx
       open i-o mod2asya kodlar02
       initialize reztipx-rec bf-anah mod2asya-rec  fs-mod-acenta
       start reztipx key > reztipx-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read reztipx next no lock 
              end move "10" to fs-mod-acenta
              not end
                     initialize mod2asya-rec
                 move "pazar" to mod2asya-tip
                 move reztipx-kodu to mod2asya-mod-kodu
                 add 1 to bf-anah 
                 move bf-anah to kodlar02-kodu mod2asya-asya-kodu
                 move reztipx-adi   to kodlar02-ADI
                  move "E" to kodlar02-tipi 
                  write kodlar02-rec invalid
                     display message box 
                         " kodlar02 REWRITE--" new-line
                             kodlar02-rec 
                             stop " "
                  end-write

                  write mod2asya-rec invalid
                     display message box 
                         "Transfer dosya REWRITE--" new-line
                             mod2asya-rec                    end-write
               
             end-read

             end-perform
             end-start

       close reztipx mod2asya kodlar02.



 doviz-al.
 
       
       open output doviz
       close doviz
       
       open input kuradix
       open i-o  doviz
       initialize kuradix-rec bf-anah mod2asya-rec  fs-mod-acenta
       start kuradix key > kuradix-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read kuradix next no lock 
              end move "10" to fs-mod-acenta
              not end
                if  kuradix-kodu = 0 then 
                   move 99 to doviz-kodu
                 else
                   add 1 to bf-anah 
                   move bf-anah to doviz-kodu 
                 end-if
          
                 move kuradix-adi   to d-ADI-1 d-kisa-adi
                 move  bf-anah to kk
                if kk = 2 or kk= 3  or kk =4  or kk=5  or kk=6  or kk  = 7  or
                    Kk= 8  or kk=9  or kk=10  or kk=13  or kk= 14  or kk = 15  or 
                    kk = 16  or kk = 18 then 
                    exit perform cycle 
                  end-if
                  write doviz-rec invalid
                     display message box 
                         " doviz REWRITE--" new-line
                             doviz-rec 
                             stop " "
                  end-write

                  
               
             end-read

             end-perform
             end-start
               MOVE 99 TO DOViz-kodu
               move "TL" to d-ADI-1 d-kisa-adi
               write doviz-rec invalid
                     display message box 
                         " doviz REWRITE--" new-line
                             doviz-rec 
                             stop " "
                  end-write
       close kuradix  doviz.
                 
 staf-al.
       
       open input unvan
       open i-o  kllnc
       initialize unvan-rec bf-anah mod2asya-rec  fs-mod-acenta
       start unvan key > unvan-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read unvan next no lock 
              end move "10" to fs-mod-acenta
              not end
                move unvan-kodu to k-kodu
                move unvan-adi to k-adi k-soyadi
                move "MODE" to k-staf
                
                  write kllnc-rec invalid
                     rewrite kllnc-rec
                  end-write

                  
               
             end-read

             end-perform
             end-start
             move "MODE" to k-kodu
                move "MODE dan TRANS" to k-adi k-soyadi
                move "ASYA" to k-staf
                
                  write kllnc-rec invalid
                     rewrite kllnc-rec
                  end-write

       close unvan  kllnc.   
 ODA-AL.
       open output odalar
       close odalar
        open input room mod2asya
       open i-o  odalar
       initialize room-rec  fs-mod-acenta
       
       start room key > room-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read room next no lock 
              end move "10" to fs-mod-acenta
              not end

                move room-kodu to odalar-no
                 if  ROOM-hayali  not  = "R"
                     MOVE   06 TO ODALAR-KONUMU 
                     else 
                          initialize mod2asya-rec
                     move "konum" to mod2asya-tip
                      move room-konumu to mod2asya-mod-kodu
                     read mod2asya no lock
                        
                         invalid
                           stop " "
                     end-read

                     move  mod2asya-asya-kodu(1:2)  to ODALAR-KONUMU
               
             end-if

             move ROOM-kat    to odalar-kat
                if  room-kat = 0 then
                     move 1    to odalar-kat
                  else   
                    MOVE ROOM-KAT to odalar-kat
                end-if
                move ROOM-tip    to odalar-tipi
                move "VC"   to odalar-durumu house-durumu
                move ROOM-adult  to odalar-kapasite
                if  ROOM-hayali not = "R"  or    ODALAR-KONUMU = 03
                   move "H" to odalar-hayali
                   move 99 to odalar-kat
                   else 
                    move "G" to odalar-hayali
                end-if
                write odalar-rec invalid
                     display message box "ODALAR REWRITE"
                end-write
                  
                  
               
             end-read

             end-perform
       end-start
                
           
       close room odalar mod2asya.   
        .

*           
 fiyatlar-al.
       if acenta-eskisini-sil = 1 then 
       
       open output fiyatana 
       close fiyatana
       end-if
        open input tacenta mod2asya
        open input tmacenta
        open i-o  fiyatana
       initialize tacenta-rec  fs-mod-acenta fiyatana-rec
       move 2007 to tacenta-yil    
       
       start tacenta key > tacenta-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read tacenta next no lock 
              end move "10" to fs-mod-acenta
              not end
                 if  tacenta-acenta > "ZZZZ"
                       move "10" to fs-mod-acenta
                   else
                   move tacenta-acenta      to  tmacenta-anahtar
                   read tmacenta no lock invalid 
                      display message box "mod acenta yok--" tmacenta-rec
                   end-read
                    
                    move tmacenta-master     to FIYATANA-ACENTA
                   
                   move tacenta-board       to FIYATANA-PAN-TIPI
                   if tacenta-doviz = 0 then move 99 to tacenta-doviz end-if
                   move tacenta-doviz       to FIYATANA-DOVIZ 
                   move 1 to  FIYATANA-REZ-TIPI
                   move "01" to  FIYATANA-BANKA 
                   if tmacenta-anlasma = "00" 
                       move  "99" to  tmacenta-anlasma 

                   end-if
                   move tmacenta-anlasma to FIYATANA-ANLASMA
                        initialize mod2asya-rec
                   move "konum" to mod2asya-tip
                   move tacenta-konum to mod2asya-mod-kodu
                     read mod2asya no lock  invalid stop " "
                     end-read
                     move  mod2asya-asya-kodu(1:2)  to kk
                     if tmacenta-single = "1" then 
                       move 5 to kk
                     
                    end-if
                   perform  varying i from 1 by 1 
                        until i > 24 or  tacenta-bas-tar(i) = spaces   or  tacenta-bas-tar(i) = zeroes
                           move tacenta-bas-tar(i)(1:2)  to FIYATANA-ILK-gun 
                           move tacenta-bas-tar(i)(3:2)  to FIYATANA-ILK-ay
                           move tacenta-bas-tar(i)(5:4)  to FIYATANA-ILK-yil
                           move tacenta-bit-tar(i)(1:2)  to FIYATANA-son-gun 
                           move tacenta-bit-tar(i)(3:2)  to FIYATANA-son-ay
                           move tacenta-bit-tar(i)(5:4)  to FIYATANA-son-yil 
                           move 1 to   FIYATANA-BUYUK
                           move 0 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 1 to   FIYATANA-BUYUK
                           move 1 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 1 to   FIYATANA-BUYUK
                           move 2 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                          
                           
                           move 2 to   FIYATANA-BUYUK
                           move 0 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 2 to   FIYATANA-BUYUK
                           move 1 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 2 to   FIYATANA-BUYUK
                           move 2 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 2 to   FIYATANA-BUYUK
                           move 3 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 3 to   FIYATANA-BUYUK
                           move 0 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 3 to   FIYATANA-BUYUK
                           move 1 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 3 to   FIYATANA-BUYUK
                           move 2 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 3 to   FIYATANA-BUYUK
                           move 3 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 4 to   FIYATANA-BUYUK
                           move 0 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 4 to   FIYATANA-BUYUK
                           move 1 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 4 to   FIYATANA-BUYUK
                           move 2 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 5 to   FIYATANA-BUYUK
                           move 0 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 5 to   FIYATANA-BUYUK
                           move 1 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                           move 6 to   FIYATANA-BUYUK
                           move 0 to   FIYATANA-KUCUK 
                           perform   fiyat-satir-at
                   end-perform 
                end-if
              end-read
            end-perform 
          end-start



      
      
        close tacenta mod2asya tmacenta  fiyatana.
*
 fiyat-satir-at.
         
              initialize FIYATANA-ODA-DIZI
          read fiyatana no lock 
             invalid continue
          end-read
          if tmacenta-anlasma = 11 or 
          tmacenta-anlasma = 12 or 
          tmacenta-anlasma = 13 or 
          tmacenta-anlasma = 53 or 
          tmacenta-anlasma = 34 
          if tmacenta-eb > 0 then 
                  move "E"              to FIYATANA-EB-EH
                  move tmacenta-eb      to  FIYATANA-EB-ORAN
                  move tmacenta-ebkusur to  FIYATANA-EB-kusur
                  move "20070331"       to fiyatana-eb-bit-tarih
                  move "20060101"       to fiyatana-eb-bas-tarih
          end-if
          end-if
          move tmacenta-kick   to   FIYATANA-KICK-BACK
          move "MODE" to  FIYATANA-STAF
          if tacenta-chi-yuzde(i) = 0 then 
            move 50 to   tacenta-chi-yuzde(i)
          end-if
          EVALUATE  FIYATANA-BUYUK
            WHEN 1
               compute FIYATANA-ODA-FIYATI(kk)rounded = 
                  ( tacenta-p-p-double(i) ) + tacenta-sing-supp(i) + 
                   ( tacenta-p-p-double(i) *
                   tacenta-chi-yuzde(i) *  FIYATANA-KUCUK / 100)
            when 2
                compute FIYATANA-ODA-FIYATI(kk)rounded = 
                  ( tacenta-p-p-double(i) * 2 ) + 
                   ( tacenta-p-p-double(i) *
                   tacenta-chi-yuzde(i) *  FIYATANA-KUCUK / 100)
            when 3
                compute FIYATANA-ODA-FIYATI(kk)rounded = 
                  ( tacenta-p-p-double(i) * 2 ) +  tacenta-add-bed(i)  +
                   ( tacenta-p-p-double(i) *
                   tacenta-chi-yuzde(i) *  FIYATANA-KUCUK / 100)
            when 4
                compute FIYATANA-ODA-FIYATI(kk)rounded = 
                  ( tacenta-p-p-double(i) * 2 ) +  tacenta-add-bed(i)  + 
                  tacenta-4-pax(i)  +

                   ( tacenta-p-p-double(i) *
                   tacenta-chi-yuzde(i) *  FIYATANA-KUCUK / 100)
          END-EVALUATE
         if  FIYATANA-ODA-FIYATI(kk) not  = 0 then 
           write fiyatana-rec invalid rewrite fiyatana-rec end-write
         end-if.

 rez-al.
      
*      if rez-eskisini-sil = 1 then 
*       open output rez
*       close rez
*       end-if
*         stop " "
         
        open i-o mod-rez 
        open input tmacenta
        open i-o  rez  mod2asya ulke acenta
       initialize mod-rez-rec  fs-mod-acenta rez-rec
*       move  113646 to  mod-rez-anahtar
        move 100000 to rez-no
       start mod-rez key > mod-rez-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read mod-rez next no lock 
              end move "10" to fs-mod-acenta
              not end
                  if mod-rez-gir-tar > "20070101" then exit perform cycle
                  end-if
*                 if mod-rez-anahtar = 113647 then stop " " end-if
                   move 0 to mod-rez-asya-no mod-rez-asya-no2
                   initialize  mod-rez-fff
                   rewrite mod-rez-rec end-rewrite

                   move mod-rez-acenta      to  tmacenta-anahtar
                   read tmacenta no lock invalid 
                         move mod-rez-acenta to  acenta-adi acenta-kodu tmacenta-master 
                         write acenta-rec invalid 
                          continue
                          not invalid
                             string  "Acenta yok--"  delimited by "ggggg"
                                   mod-rez-acenta  delimited by "ggggg"
                                   "----rez-no--"      delimited by "ggggg"
                                   mod-rez-anahtar     delimited by "ggggg"
                                   "---acenta acildi"  delimited by "ggggg" 
                                  into trnot-rec
                                  display trnot-rec
                                   write trnot-rec  end-write
                         end-write
                         
                   end-read
                    move tmacenta-master     to rez-ACENTA
      


          move  mod-rez-anahtar     TO rez-adres1

             move 1 to rez-tipi
             move "I" to rez-durumu
           initialize mod2asya-rec
         move "pazar" to mod2asya-tip
           move mod-rez-market  to mod2asya-mod-kodu
           read mod2asya no lock 
              invalid 
                string  "Pazar Kodu yok--"  delimited by "ggggg"
                       mod-rez-market  delimited by "ggggg"
                       "----rez-no--"      delimited by "ggggg"
                       mod-rez-anahtar     delimited by "ggggg"
                       into trnot-rec
                display trnot-rec
               write trnot-rec  
           end-read
           move mod2asya-asya-kodu  TO REZ-PAZAR
         move mod-rez-adi            TO rez-adi
         move mod-rez-soyadi         to rez-soyadi
            move "01" to rez-banka
            if mod-rez-doviz = 0 then move 99 to mod-rez-doviz end-if
         move MOD-REZ-doviz             to rez-doviz
         if rez-doviz = 0 then move 99 to rez-doviz end-if
         move mod-rez-on-odeme       to rez-on-odeme
         move mod-rez-pansiyon-kodu   to rez-pan-tipi
         initialize mod2asya-rec
         move "odeme" to mod2asya-tip
           move mod-rez-odeme-kodu to mod2asya-mod-kodu
           read mod2asya no lock 
              invalid 
               string  "Odeme Kodu yok--"  delimited by "ggggg"
                       mod-rez-odeme-kodu  delimited by "ggggg"
                       "----rez-no--"      delimited by "ggggg"
                       mod-rez-anahtar     delimited by "ggggg"
                       into trnot-rec
                display trnot-rec
               write trnot-rec  
           end-read
           move mod2asya-asya-kodu(1:2) to  REZ-ODEME-TIPI 

*         02 filler-3 pic xx.
              
         move mod-rez-gir-tar       to rez-gir-tar   
         move mod-rez-gir-zaman     to rez-gel-zaman
         move mod-rez-cik-tar       to rez-cik-tar
         move mod-rez-cik-zaman     to rez-git-zaman
         move mod-rez-kayit-tar     to rez-isl-tar

          move  mod-rez-oda-no      to      rez-odano
*         02 filler-4                  pic 9(05)v99 comp-3.
*         02 mod-rez-grup-master-folio  pic x.
*******************/ Y- master folio evet N- master folio hayir
*         02 mod-rez-grup-kodu          pic x(5).
*         02 mod-rez-kaynak            pic x(20).
*          move  mod-rez-tel                to rez-TELNO
*         02 mod-rez-fly-number               pic x(10).
          move  mod-rez-remarks            to rez-not1
          move  mod-rez-remarks(21:)       to rez-not2
*         
          move  mod-rez-vip-code           to   rez-vip
          initialize mod2asya-rec
          move "ulke" to mod2asya-tip
           move mod-rez-ulke to mod2asya-mod-kodu
           read mod2asya no lock 
               invalid 
                
               initialize mod2asya-rec
                  move "ulke" to mod2asya-tip
                 move mod-rez-ulke to mod2asya-mod-kodu
                  add 1 to bf-ulke
                 move bf-ulke to mod2asya-asya-kodu
                 write mod2asya-rec invalid
                     display message box 
                         "Transfer dosya REWRITE--" new-line
                             mod2asya-rec  
                  end-write
                  initialize ulke-rec
                  move bf-ulke to ulke-anah1
                  move mod-rez-ulke     to ulke-adi
                  write ulke-rec invalid
                       stop " "
                  end-write
                 
           end-read
           move mod2asya-asya-kodu to  REZ-ulke
           move tmacenta-anlasma to rez-anlasma
           
          evaluate rez-anlasma 
             when 11 when 12 when 13
             when 21 when 22 when 23
             when 41 when 42 when 43
             when 51 when 52 when 53
             when 50 when 58  when 34
             when 61 when 62 when 63
              move "E" to rez-eb
              when other 
                 move "H" to rez-eb
          end-evaluate
          evaluate rez-anlasma 
             when   "04"
             when   "53"
             when   "34"
                 move "E" to REZ-AKSIYON-EH
             when other 
                move "H" to REZ-AKSIYON-EH
          end-evaluate
           move  mod-rez-title               to rez-title
*         02 mod-rez-islenme-tarih       pic x(8).
*         02 mod-rez-otel-id             pic X(1).
*         02 filler-7                    pic x(4).
          move  mod-rez-k-kodu         to     rez-staf
*         02 mod-rez-rate-kodu           pic x(4).



          evaluate   mod-rez-durumu  
             when "C"
                 move "I"  to rez-durumu
                 move "K"  to   REZ-K-G-B 
             when "T"
                 move "S"  to rez-durumu
                 move "K"  to   REZ-K-G-B 
             when "W"
             when "w"
                 move "I"  to rez-durumu
                 move "B"  to   REZ-K-G-B 
          end-evaluate
          
          if mod-rez-sil = "-" then 
              move "S"  to rez-durumu
              
          end-if
*****************/ W-Wait C-Confirme T-Ýptal (??????)
          move   mod-rez-voucher-no        to rez-voucher
*        02 mod-rez-kontrattan-al                 pic x.
***************/ Y-yes N-No
*         02 mod-rez-special             pic x.
*         02 mod-rez-e-b                 pic 9.
**         02 filler-8 pic x(2).

         perform varying i from 1 by 1 until i > 4
           perform varying rr  from 1 by 1 until rr > mod-rez-oda-sayi(i)
             add 1 to rez-no  
              if mod-rez-asya-no = 0 then
                 move rez-no to mod-rez-asya-no
              end-if
                move rez-no to mod-rez-asya-no2
              rewrite mod-rez-rec end-rewrite
             if  mod-rez-oda-konumu(i) = "ROH "   then
                   stop " "
             end-if
             initialize mod2asya-rec
             move "konum" to mod2asya-tip
             move mod-rez-oda-konumu(i) to mod2asya-mod-kodu
                     read mod2asya no lock  invalid
**********************************************
****************** charm icin yapildi

                     move "01" to mod2asya-asya-kodu(1:2)                  
                     
*****                     
                          stop " "
                     end-read
             move  mod2asya-asya-kodu(1:2)  to kk
             if tmacenta-single = 1 then
                        
                move 5 to  rez-fiyat-konumu 
                else 
                move kk     to   rez-fiyat-konumu
            end-if
            
             move    kk     to   rez-oda-konumu
             
             compute rez-buyuk =    mod-rez-adult(i)/ mod-rez-oda-sayi(i)
                                         

             if rez-buyuk * mod-rez-oda-sayi(i) not = mod-rez-adult(i)
                then stop " "
              end-if
             evaluate    rez-buyuk     
                 when 1
                 when 2
                 when 3
                 when 4
                    move rez-buyuk to  REZ-S-D-T-G
                  when other
                     move 4 to  REZ-S-D-T-G
             end-evaluate
             move    mod-rez-child(i)       to  rez-kucuk
             move    mod-rez-free(i)        to  rez-free
             move    mod-rez-fiyat(i)       to  rez-fiyati
             move "G" to REZ-KUR-AYGUN 
             write rez-rec invalid stop " " end-write
                display rez-rec
            end-perform   
        end-perform 
             end-read
        end-perform
      end-start
      move rez-no to son-rez
             close  mod-rez 
         tmacenta
        rez  mod2asya ulke acenta.
         
* 
 hiskonuk-al.
       
       open output konuk ozluk
       close konuk         ozluk
       
        open input   odemex
        open input tmacenta  odalar mod-ozluk
        open i-o  konuk  mod2asya ulke acenta  ozluk
                  tygunluk  tgunluk rez mod-rez
       initialize tygunluk-rec tgunluk-rec
          fs-mod-acenta konuk-rec rez-rec  mod-rez-rec
*       move  113646 to  mod-rez-anahtar
         if rez-value not = 1
            initialize rez-rec
            start rez key > rez-anah
              invalid stop " "
            end-start
            perform until fs-rez = "10" 
              read rez next no lock 
                end move "10" to fs-rez
                not end 
                  initialize rez-c-in rez-folio
                  if rez-tipi = 5 then 
                    delete rez end-delete
                    
                    else
                     move "G" to REZ-KUR-AYGUN 
            
                    rewrite rez-rec end-rewrite
                end-if
               end-read
            end-perform
              move rez-no to son-rez
         end-if 
         perform inhouse-al
         
         initialize fs-mod-acenta
       start tygunluk key > tygunluk-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read tygunluk next no lock 
              end move "10" to fs-mod-acenta
              not end
                  initialize tygunluk-r-folio tygunluk-e-folio
*                 if mod-rez-anahtar = 113647 then stop " " end-if
                   add 1 to konuk-folio
                   move "E" to Konuk-Cik-Cikma
                   move tygunluk-company      to  tmacenta-anahtar
*                    move tgunluk-staf to  konuk-staf
                   read tmacenta no lock invalid 
                        
                             string  "TYgunluk Acenta yok--"  delimited by "ggggg"
                                   tygunluk-company  delimited by "ggggg"
                                   "----rez-no--"      delimited by "ggggg"
                                   tygunluk-folio     delimited by "ggggg"
                                   "---acenta acilmadi"  delimited by "ggggg" 
                                  into trnot-rec
                                  display trnot-rec
                                   write trnot-rec  end-write
                        
                         
                   end-read
                    move tmacenta-master     to konuk-ACENTA
                   if  tygunluk-gir-tarih < "20041001"  then 
                   exit perform cycle
                   end-if
                   if tygunluk-rez-no = 0   then 
                        perform  walkcin-yap
                        exit perform cycle 
                   end-if
                   move tygunluk-rez-no to mod-rez-anahtar
                   read mod-rez no lock 
                     invalid 
                         stop " "
                   end-read
                 perform varying rez-no from mod-rez-asya-no by 1 
                       until rez-no > mod-rez-asya-no2
                     read rez no lock invalid 
                        stop " "
                        not invalid
                          if rez-c-in not = "E" and rez-durumu = "I" 
                          and REZ-K-G-B = "K" then 
                            move konuk-folio to rez-folio
                            move rez-no      to konuk-rez-no
                            move "E" to rez-c-in
                            exit perform 
                          end-if 
                       end-read
                 
                 end-perform 
                 if konuk-rez-no = 0 then 
                     string tygunluk-folio delimited by "hhhh"
                            "---- nolu folio da sorun var " delimited by "jhkjhkj"
                            "Rezervasyonu yok"   delimited by "jhkjh"
                            into trnot-rec
                       write trnot-rec
                 end-if
                move tygunluk-oda         to konuk-odano
                move tygunluk-gir-tarih   to konuk-gel-tar
                move tygunluk-cik-tarih   to konuk-git-tar
                move tygunluk-ayril-zaman to konuk-git-zaman
                move tmacenta-master      to konuk-acenta
                if konuk-acenta not = rez-acenta 
                      string  "Register karti ve rez master acentalari farkli--"  delimited by "ggggg" new-line
                                   "Register kart--"  delimited by "ggggg"
                                   tygunluk-folio  delimited by "ggggg"
                                   "----rez-no--"      delimited by "ggggg"
                                   tygunluk-rez-no    delimited by "ggggg"
                                   "---Rezervasyondaki alindi"  delimited by "ggggg" 
                                  into trnot-rec
                                  display trnot-rec
                                   write trnot-rec  end-write
                        
                 move rez-acenta to konuk-acenta
                end-if
                move tygunluk-pansiyon to konuk-pan-tipi
                move tygunluk-pax      to konuk-buyuk
                move tygunluk-chi      to konuk-kucuk
                move tygunluk-free     to konuk-free

                move tygunluk-kur-kodu to konuk-doviz
                if konuk-doviz = 0 then move 99 to konuk-doviz end-if
      
                move "01" to konuk-banka
                if  tygunluk-tl-tutar = 0 then
                   move  tygunluk-dv-tutar  to   tygunluk-tl-tutar
                end-if
                
                
                move tygunluk-tl-tutar to konuk-oda-tutar
               
                move tygunluk-dv-tutar to konuk-dv-degeri
                compute konuk-kur-degeri rounded = 
                     konuk-oda-tutar / konuk-dv-degeri
                     
                move tygunluk-giris-zaman to konuk-gel-zaman
                move tygunluk-voucher   to konuk-voucher
                move rez-not1 to konuk-acik-1   
                move rez-not2 to konuk-acik-2   
                
                initialize mod2asya-rec
                move "odeme" to mod2asya-tip
                   move tygunluk-odeme  to mod2asya-mod-kodu
                   read mod2asya no lock 
                      invalid 
                       stop " "
                   end-read
                   move mod2asya-asya-kodu  TO konuk-odeme-tipi

              initialize mod2asya-rec
                move "pazar" to mod2asya-tip
                   move tygunluk-market  to mod2asya-mod-kodu
                   read mod2asya no lock 
                      invalid 
                       stop " "
                   end-read
                   move mod2asya-asya-kodu  TO konuk-pazar

               move konuk-odano to odalar-anah
               read odalar no lock  invalid 
                  
                   string  "TYgunluk Oda yok--"  delimited by "ggggg"
                                   konuk-odano  delimited by "ggggg"
                                   "----mode folio-no--"      delimited by "ggggg"
                                   tygunluk-folio     delimited by "ggggg"
                                   "---oda acilmadi "  delimited by "ggggg" 
                                  into trnot-rec
                                  display trnot-rec
                                   write trnot-rec  end-write

                                   move 10 to  odalar-konumu

               end-read
               move odalar-konumu to konuk-oda-konumu konuk-fiyat-konumu
               move rez-anlasma to konuk-anlasma
                move rez-adi to konuk-adi
                move rez-soyadi to konuk-soyadi
               move "G" to KONUK-KUR-AYGUN
              evaluate   konuk-buyuk     
                 when 1
                 when 2
                 when 3
                 when 4
                    move konuk-buyuk to  konuk-S-D-T-G
                  when other
                     move 4 to  konuk-S-D-T-G
              end-evaluate
              move rez-vip to konuk-vip 
              move rez-tipi to konuk-rez-tipi
              move rez-ulke to konuk-ulke
              move rez-eb  to konuk-eb
              move "H" to konuk-durumu
              if tygunluk-tip = "R" then 
                move "R" to konuk-fol-kodu 
                perform konuktan-rez
                 move "G" to REZ-KUR-AYGUN 
            
               rewrite rez-rec  invalid stop " " end-rewrite 
              else
                delete rez end-delete
                stop " " 

               move "E" to  konuk-fol-kodu
               if tygunluk-tip = "M" then  
                    move  "E" to  konuk-fol-kodu 
               end-if
              end-if
              if konuk-fol-kodu = "R"  then 
                 move konuk-folio to tygunluk-r-folio
                 move tygunluk-folio to konuk-acik-2(9:)
                 else 
                  move konuk-folio to tygunluk-e-folio
              end-if

              write konuk-rec invalid stop " " end-write
              move konuk-folio to ozluk-folio 
              move konuk-adi to ozluk-adi
              move konuk-soyadi to ozluk-soyadi
              write ozluk-rec invalid stop " " end-write
              perform konuktan-rez
              if konuk-fol-kodu = "R"  then
                 
                  add 1 to konuk-folio
                 move "E" to  Konuk-Cik-Cikma
                   initialize  konuk-rez-no 
                  konuk-kisi  konuk-voucher  konuk-nor-indirim 
                    konuk-cik-cikma 
                    konuk-oda-tutar  konuk-extbed-tutar konuk-kahvalti-tutar 
                    konuk-ogle-tutar  konuk-aksam-tutar konuk-icecek-tutar 
                    konuk-extra-tutar konuk-top-borc konuk-top-alac konuk-kur-degeri 
                     konuk-dv-degeri konuk-dv-degeri konuk-acik konuk-kartno 
/*                     konuk-bos
                   move "E" to konuk-fol-kodu
                   move konuk-folio to tygunluk-e-folio 
                   move tygunluk-odeme to odemex-kodu
                   move konuk-adi to konuk-adi(4:)
                   move "E=>" to  konuk-adi(1:3)
                 read odemex no lock 
                   invalid  stop " " 
                 end-read 
                 evaluate Odemex-Tip
                     when 1 
                     when 2
                     when 3
                        move "01" to konuk-odeme-tipi
                     when 4
                        move "02" to konuk-odeme-tipi
                     when 5
                        move "40" to konuk-odeme-tipi
                     when 6
                     when 7
                        move "20" to konuk-odeme-tipi
 
                 end-evaluate
                 write konuk-rec invalid stop " " end-write
                 move konuk-folio to ozluk-folio 
              move konuk-adi to ozluk-adi
              move konuk-soyadi to ozluk-soyadi
              write ozluk-rec invalid stop " " end-write
              end-if
               rewrite tygunluk-rec invalid stop " " end-rewrite
           
          end-read
          end-perform
         end-start.
         close tygunluk tgunluk
        close tmacenta
        close konuk  mod2asya ulke acenta ozluk 
            odemex mod-ozluk rez mod-rez odalar.

*
 walkcin-yap.
          add 1 to son-rez
          move son-rez to rez-no
          move "I" to rez-durumu
          move konuk-folio to rez-folio
          move rez-no      to konuk-rez-no
          move "E" to rez-c-in
                    
             if konuk-rez-no = 0 then stop " " end-if
            move tygunluk-oda         to konuk-odano
            move tygunluk-gir-tarih   to konuk-gel-tar
            move tygunluk-cik-tarih   to konuk-git-tar
            move tygunluk-ayril-zaman to konuk-git-zaman
            move tmacenta-master      to konuk-acenta
            
             
            move tygunluk-pansiyon to konuk-pan-tipi
            move tygunluk-pax      to konuk-buyuk
            move tygunluk-chi      to konuk-kucuk
            move tygunluk-free     to konuk-free
            move tygunluk-kur-kodu to konuk-doviz
             if konuk-doviz = 0 then move 99 to konuk-doviz end-if
      
            move "01" to konuk-banka
            
                if  tygunluk-tl-tutar = 0 then
                   move  tygunluk-dv-tutar  to   tygunluk-tl-tutar
                end-if
            
            move tygunluk-tl-tutar to konuk-oda-tutar
           
            move tygunluk-dv-tutar to konuk-dv-degeri
            compute konuk-kur-degeri rounded = 
                 konuk-oda-tutar / konuk-dv-degeri
            move tygunluk-giris-zaman to konuk-gel-zaman
            move tygunluk-voucher   to konuk-voucher
           
            initialize mod2asya-rec
            move "odeme" to mod2asya-tip
               move tygunluk-odeme  to mod2asya-mod-kodu
               read mod2asya no lock 
                  invalid 
                   stop " "
               end-read
               move mod2asya-asya-kodu  TO konuk-odeme-tipi

          initialize mod2asya-rec
            move "pazar" to mod2asya-tip
               move tygunluk-market  to mod2asya-mod-kodu
               read mod2asya no lock 
                  invalid 
                   move 14 to mod2asya-asya-kodu
               end-read
               move mod2asya-asya-kodu  TO konuk-pazar

           move konuk-odano to odalar-anah
           read odalar no lock  invalid 
              
               string  "TYgunluk Oda yok--"  delimited by "ggggg"
                               konuk-odano  delimited by "ggggg"
                               "----mode folio-no--"      delimited by "ggggg"
                               tygunluk-folio     delimited by "ggggg"
                               "---oda acilmadi "  delimited by "ggggg" 
                              into trnot-rec
                              display trnot-rec
                               write trnot-rec  end-write
                               move 10 to  odalar-konumu

           end-read
           move odalar-konumu to konuk-oda-konumu konuk-fiyat-konumu
           move "99" to konuk-anlasma
            perform mod-ozluk-al
           move "G" to KONUK-KUR-AYGUN
          evaluate   konuk-buyuk     
             when 1
             when 2
             when 3
             when 4
                move konuk-buyuk to  konuk-S-D-T-G
              when other
                 move 4 to  konuk-S-D-T-G
          end-evaluate
          move rez-vip to konuk-vip 
          move 5  to rez-tipi  konuk-rez-tipi
        
          move "H" to konuk-durumu
          
   
           if tygunluk-tip = "R" then 
             move "R" to konuk-fol-kodu 
              move konuk-folio to tygunluk-r-folio
              move tygunluk-folio to konuk-acik-2(9:)
              perform konuktan-rez
               move "G" to REZ-KUR-AYGUN 
            
              write rez-rec  invalid stop " " end-write 
              else
               move konuk-folio to tygunluk-e-folio
               move tygunluk-folio to konuk-acik-2(9:)
               move "E" to  konuk-fol-kodu
               move konuk-adi to konuk-adi(4:)
               move "E=>" to konuk-adi(1:3)
               initialize konuk-rez-no
               if tygunluk-tip = "M" then  
               move "E" to  konuk-fol-kodu 
               end-if
          end-if
          write konuk-rec invalid stop " " end-write
          move konuk-folio to ozluk-folio 
              move konuk-adi to ozluk-adi
              move konuk-soyadi to ozluk-soyadi
              write ozluk-rec invalid stop " " end-write
          if konuk-fol-kodu = "R"  then
                 
                  add 1 to konuk-folio
                  move "E" to Konuk-Cik-Cikma
                   initialize  konuk-rez-no 
                  konuk-kisi  konuk-voucher  konuk-nor-indirim 
                    konuk-cik-cikma 
                    konuk-oda-tutar  konuk-extbed-tutar konuk-kahvalti-tutar 
                    konuk-ogle-tutar  konuk-aksam-tutar konuk-icecek-tutar 
                    konuk-extra-tutar konuk-top-borc konuk-top-alac konuk-kur-degeri 
                     konuk-dv-degeri konuk-dv-degeri konuk-acik konuk-kartno 
*/                     konuk-bos
                   move "E" to konuk-fol-kodu
                   move konuk-folio to tygunluk-e-folio 
                   move tygunluk-odeme to odemex-kodu
                   move konuk-adi to konuk-adi(4:)
                   move "E=>" to  konuk-adi(1:3)
                 read odemex no lock 
                   invalid  stop " " 
                 end-read 
                 evaluate Odemex-Tip
                     when 1 
                     when 2
                     when 3
                        move "01" to konuk-odeme-tipi
                     when 4
                        move "02" to konuk-odeme-tipi
                     when 5
                        move "40" to konuk-odeme-tipi
                     when 6
                     when 7
                        move "20" to konuk-odeme-tipi
 
                 end-evaluate
                 write konuk-rec invalid stop " " end-write
                 move konuk-folio to ozluk-folio 
              move konuk-adi to ozluk-adi
              move konuk-soyadi to ozluk-soyadi
              write ozluk-rec invalid stop " " end-write
              end-if
          
            rewrite tygunluk-rec invalid stop " " end-rewrite.
          

*
 mod-ozluk-al.
         if  tygunluk-ozluk-1 not = 0 then  
             move 1 to yanrez-sirano
             move tygunluk-ozluk-1 to mod-ozluk-anahtar 
             perform tek-ozluk-al 
             move  mod-ozluk-title to konuk-title 
             move  mod-ozluk-name  to konuk-adi
             move  mod-ozluk-surname to konuk-soyadi  
         end-if .
*
 tek-ozluk-al.
         
          read mod-ozluk no lock 
             invalid stop  " " 
          end-read
            
           move  mod-ozluk-title to konuk-title 
             move  mod-ozluk-name  to konuk-adi
             move  mod-ozluk-surname to konuk-soyadi      
             move  mod-ozluk-adres-1 to      ozluk-adres1
          move  mod-ozluk-adres-2 to      ozluk-adres2
          move  mod-ozluk-sehir      to        OZLUK-IL .
*          02 mod-ozluk-ulke-kodu         OZLUK-ULKE
*          02 mod-ozluk-telefon            OZLUK-TELNO
*          02 filler pic xx.
*          02 mod-ozluk-kimlik-cilt         pic x(5).
*          02 mod-ozluk-kimlik-aile         pic x(5).
*          02 mod-ozluk-kimlik-sira         pic x(5).
*          02 mod-ozluk-kimlik-tipi         OZLUK-KIM-TURU
***************P-Pasaport
*          02 mod-ozluk-medeni-hali         pic x.
*************** B-BEKAR E-EVLI
*          02 mod-ozluk-cinsiyet            pic x.
**************** E-ERKEK K-KADIN
*          02 mod-ozluk-dogum-tarihi         OZLUK-DOGUM-TAR
*          02 mod-ozluk-dogum-yeri          OZLUK-DOGUM-YERI 
*          02 mod-ozluk-baba-adi           pic x(10).
*          02 mod-ozluk-ana-adi             pic x(10).
*          02 mod-ozluk-hotel-karti           pic x(10).
*          02 mod-ozluk-kart-bit-tarih.
*             03 mod-ozluk-kart-bit-ay    pic xx.
*             03 mod-ozluk-kart-bit-yil   pic xxxx.
*          02 mod-ozluk-mail                  OZLUK-E-MAIL 
*          02 mod-ozluk-kimlik-tarih       OZLUK-KIM-TAR
*             
*          02 mod-ozluk-kimlik-no                OZLUK-KIM-NO.
*          02 mod-ozluk-nufusa-kayitli-oldugu-il 
*          02 mod-ozluk-nufusa-kayitli-oldugu-ilce 
*          02 mod-ozluk-meslegi             OZLUK-MESLEK  
*          02 mod-ozluk-sirket-adi 
*          02 mod-ozluk-vergi-daire       pic x(15).
*          02 mod-ozluk-vergi-no            pic x(15).
*          02 mod-ozluk-etiket-ciksinmi     pic x.
****************1 evet
*          02 mod-ozluk-plaka              OZLUK-PLAKA 
*          02 mod-ozluk-tc-kimlik-no               pic x(11).
*          02 mod-ozluk-nufusa-kayitli-oldugu-mah   pic x(09).
*          02 mod-ozluk-rez-no                      pic x(10).
*          02 mod-ozluk-folio-no                    pic x(10).
*          
*
*
 hata-goster.
    call "c$rerr" using extend-stat text-message 1.
    move extend-stat       to fileerr-linkage-hata-no.
    move Secondary-Error   to fileerr-linkage-secondary-hata-no.
    call "c$rerrname" using fileerr-linkage-dosya-adi.
    display message box "DOSYA : ",fileerr-linkage-dosya-adi,
    x"0a0d","errrrror :",fileerr-linkage-hata-no,x"0ad0",
    "error2 :",fileerr-linkage-secondary-hata-no.
    stop " ".
            

*
 konuktan-rez.
       move "I" to rez-durumu
       move "K" to rez-K-G-B
       
       move konuk-gel-tar      to rez-gir-tar.
       move konuk-git-tar      to rez-cik-tar.
       move konuk-dv-degeri    to rez-fiyati.
       move konuk-folio        to rez-folio. 
       move konuk-odano        to rez-odano. 
       move "E"                 to rez-c-in. 
       move konuk-adi          to rez-adi. 
       move konuk-soyadi       to rez-soyadi. 
       move konuk-oda-konumu   to rez-oda-konumu. 
       move konuk-fiyat-konumu to rez-fiyat-konumu. 
       move konuk-odeme-tipi   to rez-odeme-tipi. 
       move konuk-odano        to rez-odano. 
       move konuk-ulke         to rez-ulke. 
       move konuk-buyuk        to rez-buyuk. 
       move konuk-kucuk        to rez-kucuk. 
       move konuk-free         to rez-free. 
       move konuk-bebek        to rez-bebek.
       move konuk-acenta       to rez-acenta. 
       move konuk-grup-no      to rez-grup-no.
       move konuk-gel-saat     to rez-gel-saat.
       move konuk-gel-dakika   to rez-gel-dak.
       move konuk-git-saat     to rez-git-saat.
       move konuk-git-dakika   to rez-git-dak.
       move konuk-fiyat-konumu to rez-fiyat-konumu
       move konuk-voucher      to rez-voucher. 
       move konuk-nor-indirim  to rez-nor-indirim. 
       move konuk-pan-tipi     to rez-pan-tipi. 
       move konuk-banka        to rez-banka. 
       move konuk-doviz        to rez-doviz. 
       move konuk-pazar        to rez-pazar.
       move konuk-eb           to rez-eb
       move konuk-ug-indirimi  to rez-ug-ind
       move konuk-anlasma      to rez-anlasma.
       move konuk-kur-aygun    to rez-kur-aygun. 
       move konuk-vip          to rez-vip. 
       move konuk-title        to rez-title.
       
*

* 
 inhouse-al.
   
       start tgunluk key > tgunluk-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read tgunluk next no lock 
              end move "10" to fs-mod-acenta
              not end
*                 if mod-rez-anahtar = 113647 then stop " " end-if
                    initialize tgunluk-r-folio tgunluk-e-folio
                   add 1 to konuk-folio
                   move "E" to Konuk-Cik-Cikma
                   move tgunluk-company      to  tmacenta-anahtar
                   read tmacenta no lock invalid 
                        
                             string  "tgunluk Acenta yok--"  delimited by "ggggg"
                                   tgunluk-company  delimited by "ggggg"
                                   "----rez-no--"      delimited by "ggggg"
                                   tgunluk-folio     delimited by "ggggg"
                                   "---acenta acilmadi"  delimited by "ggggg" 
                                  into trnot-rec
                                  display trnot-rec
                                   write trnot-rec  end-write
                        
                         
                   end-read
                    move tmacenta-master     to konuk-ACENTA
                   if  tgunluk-gir-tarih < "20051001"  then 
                   exit perform cycle
                   end-if
*                    move tgunluk-staf to  konuk-staf
                   if tgunluk-rez-no = 0   then 
                        perform  walkcin-yap2
                        exit perform cycle 
                   end-if
                   move tgunluk-rez-no to mod-rez-anahtar
                   read mod-rez no lock 
                     invalid 
                         stop " "
                   end-read
                 perform varying rez-no from mod-rez-asya-no by 1 
                       until rez-no > mod-rez-asya-no2
                     read rez no lock invalid 
                        stop " "
                        not invalid
                          if rez-c-in not = "E" and rez-durumu = "I" 
                          and REZ-K-G-B = "K" then 
                            move konuk-folio to rez-folio
                            move rez-no      to konuk-rez-no
                            move "E" to rez-c-in
                            exit perform 
                          end-if 
                       end-read
                 
                 end-perform 
                 if konuk-rez-no = 0 then stop " " end-if
                move tgunluk-oda         to konuk-odano
                move tgunluk-gir-tarih   to konuk-gel-tar
                move tgunluk-cik-tarih   to konuk-git-tar
                move tgunluk-ayril-zaman to konuk-git-zaman
                move tmacenta-master      to konuk-acenta
                if konuk-acenta not = rez-acenta 
                      string  "Register kartý ve rez master acentalari farkli--"  delimited by "ggggg" new-line
                                   "Register kart--"  delimited by "ggggg"
                                   tgunluk-folio  delimited by "ggggg"
                                   "----rez-no--"      delimited by "ggggg"
                                   tgunluk-rez-no    delimited by "ggggg"
                                   "---Rezervasyondaki alindi"  delimited by "ggggg" 
                                  into trnot-rec
                                  display trnot-rec
                                   write trnot-rec  end-write
                        
                 move rez-acenta to konuk-acenta
                end-if
                move tgunluk-pansiyon to konuk-pan-tipi
                move tgunluk-pax      to konuk-buyuk
                move tgunluk-chi      to konuk-kucuk
                move tgunluk-free     to konuk-free

                move tgunluk-kur-kodu to konuk-doviz
                if konuk-doviz = 0 then move 99 to konuk-doviz end-if
      
                move "01" to konuk-banka
                
                
                
                if  tgunluk-tl-tutar = 0 then
                   move  tgunluk-dv-tutar  to   tgunluk-tl-tutar
                end-if
                move tgunluk-dv-tutar to konuk-dv-degeri
                move tgunluk-tl-tutar to konuk-oda-tutar
                compute konuk-kur-degeri rounded = 
                     konuk-oda-tutar / konuk-dv-degeri
                move tgunluk-giris-zaman to konuk-gel-zaman
                move tgunluk-voucher   to konuk-voucher
                move rez-not1 to konuk-acik-1   
                move rez-not2 to konuk-acik-2   
                
                initialize mod2asya-rec
                move "odeme" to mod2asya-tip
                   move tgunluk-odeme  to mod2asya-mod-kodu
                   read mod2asya no lock 
                      invalid 
                       stop " "
                   end-read
                   move mod2asya-asya-kodu  TO konuk-odeme-tipi

              initialize mod2asya-rec
                move "pazar" to mod2asya-tip
                   move tgunluk-market  to mod2asya-mod-kodu
                   read mod2asya no lock 
                      invalid 
                       stop " "
                   end-read
                   move mod2asya-asya-kodu  TO konuk-pazar

               move konuk-odano to odalar-anah
               read odalar no lock  invalid 
                  
                   string  "tgunluk Oda yok--"  delimited by "ggggg"
                                   konuk-odano  delimited by "ggggg"
                                   "----mode folio-no--"      delimited by "ggggg"
                                   tgunluk-folio     delimited by "ggggg"
                                   "---oda acilmadi "  delimited by "ggggg" 
                                  into trnot-rec
                                  display trnot-rec
                                   write trnot-rec  end-write
                                   move 10 to  odalar-konumu

               end-read
               move odalar-konumu to konuk-oda-konumu konuk-fiyat-konumu
               move rez-anlasma to konuk-anlasma
                move rez-adi to konuk-adi
                move rez-soyadi to konuk-soyadi
               move "G" to KONUK-KUR-AYGUN
              evaluate   konuk-buyuk     
                 when 1
                 when 2
                 when 3
                 when 4
                    move konuk-buyuk to  konuk-S-D-T-G
                  when other
                     move 4 to  konuk-S-D-T-G
              end-evaluate
              move rez-vip to konuk-vip 
              move rez-tipi to konuk-rez-tipi
              move rez-ulke to konuk-ulke
              move rez-eb  to konuk-eb
              move "I" to konuk-durumu
              if tgunluk-tip = "R" then 
                move "R" to konuk-fol-kodu 
                perform konuktan-rez
                 move "G" to REZ-KUR-AYGUN 
            
               rewrite rez-rec  invalid stop " " end-rewrite 
              else
                delete rez end-delete
                stop " " 
               initialize konuk-rez-no
               move "E" to  konuk-fol-kodu
               if tgunluk-tip = "M" then  
               move "E" to  konuk-fol-kodu 
               end-if
              end-if
              if konuk-fol-kodu = "R"  then 
                 move konuk-folio to tgunluk-r-folio
                 move tgunluk-folio to konuk-acik-2(9:)
                 else 
                  move konuk-folio to tgunluk-e-folio
              end-if
             
              write konuk-rec invalid stop " " end-write
              move konuk-folio to ozluk-folio 
              move konuk-adi to ozluk-adi
              move konuk-soyadi to ozluk-soyadi
              write ozluk-rec invalid stop " " end-write
              perform konuktan-rez
              if konuk-fol-kodu = "R"  then
                 
                  add 1 to konuk-folio
                  move "E" to Konuk-Cik-Cikma
                   initialize  konuk-rez-no 
                  konuk-kisi  konuk-voucher  konuk-nor-indirim 
                    konuk-cik-cikma 
                    konuk-oda-tutar  konuk-extbed-tutar konuk-kahvalti-tutar 
                    konuk-ogle-tutar  konuk-aksam-tutar konuk-icecek-tutar 
                    konuk-extra-tutar konuk-top-borc konuk-top-alac konuk-kur-degeri 
                     konuk-dv-degeri konuk-dv-degeri konuk-acik konuk-kartno 
*/                     konuk-bos
                   move "E" to konuk-fol-kodu
                   move konuk-folio to tgunluk-e-folio 
                   move tgunluk-odeme to odemex-kodu
                   move konuk-adi to konuk-adi(4:)
                   move "E=>" to  konuk-adi(1:3)
                 read odemex no lock 
                   invalid  stop " " 
                 end-read 
                 evaluate Odemex-Tip
                     when 1 
                     when 2
                     when 3
                        move "01" to konuk-odeme-tipi
                     when 4
                        move "02" to konuk-odeme-tipi
                     when 5
                        move "40" to konuk-odeme-tipi
                     when 6
                     when 7
                        move "20" to konuk-odeme-tipi
 
                 end-evaluate
                 write konuk-rec invalid stop " " end-write
                 move konuk-folio to ozluk-folio 
              move konuk-adi to ozluk-adi
              move konuk-soyadi to ozluk-soyadi
              write ozluk-rec invalid stop " " end-write
              end-if
               rewrite tgunluk-rec invalid stop " " end-rewrite
          end-read
          end-perform
         end-start.
         
        
 
 walkcin-yap2.
          add 1 to son-rez
          move son-rez to rez-no
          move "I" to rez-durumu
          move konuk-folio to rez-folio
          move rez-no      to konuk-rez-no
          move "E" to rez-c-in
                    
             if konuk-rez-no = 0 then stop " " end-if
            move tgunluk-oda         to konuk-odano
            move tgunluk-gir-tarih   to konuk-gel-tar
            move tgunluk-cik-tarih   to konuk-git-tar
            move tgunluk-ayril-zaman to konuk-git-zaman
            move tmacenta-master      to konuk-acenta
            
             
            move tgunluk-pansiyon to konuk-pan-tipi
            move tgunluk-pax      to konuk-buyuk
            move tgunluk-chi      to konuk-kucuk
            move tgunluk-free     to konuk-free
            move tgunluk-kur-kodu to konuk-doviz
             if konuk-doviz = 0 then move 99 to konuk-doviz end-if
      
            move "01" to konuk-banka
            
            if  tgunluk-tl-tutar = 0 then
                   move  tgunluk-dv-tutar  to   tgunluk-tl-tutar
             end-if


            move tgunluk-tl-tutar to konuk-oda-tutar
           
            move tgunluk-dv-tutar to konuk-dv-degeri
            compute konuk-kur-degeri rounded = 
                 konuk-oda-tutar / konuk-dv-degeri
            move tgunluk-giris-zaman to konuk-gel-zaman
            move tgunluk-voucher   to konuk-voucher
           
            initialize mod2asya-rec
            move "odeme" to mod2asya-tip
               move tgunluk-odeme  to mod2asya-mod-kodu
               read mod2asya no lock 
                  invalid 
                   stop " "
               end-read
               move mod2asya-asya-kodu  TO konuk-odeme-tipi

          initialize mod2asya-rec
            move "pazar" to mod2asya-tip
               move tgunluk-market  to mod2asya-mod-kodu
               read mod2asya no lock 
                  invalid 
                   move 14 to mod2asya-asya-kodu
               end-read
               move mod2asya-asya-kodu  TO konuk-pazar

           move konuk-odano to odalar-anah
           read odalar no lock  invalid 
              
               string  "tgunluk Oda yok--"  delimited by "ggggg"
                               konuk-odano  delimited by "ggggg"
                               "----mode folio-no--"      delimited by "ggggg"
                               tgunluk-folio     delimited by "ggggg"
                               "---oda acilmadi "  delimited by "ggggg" 
                              into trnot-rec
                              display trnot-rec
                               write trnot-rec  end-write
                               move 10 to  odalar-konumu

           end-read
           move odalar-konumu to konuk-oda-konumu konuk-fiyat-konumu
           move "99" to konuk-anlasma
            perform mod-ozluk-al2
           move "G" to KONUK-KUR-AYGUN
          evaluate   konuk-buyuk     
             when 1
             when 2
             when 3
             when 4
                move konuk-buyuk to  konuk-S-D-T-G
              when other
                 move 4 to  konuk-S-D-T-G
          end-evaluate
          move rez-vip to konuk-vip 
          move 5  to rez-tipi  konuk-rez-tipi
        
          move "I" to konuk-durumu
          
          if tgunluk-tip = "R" then 
             move "R" to konuk-fol-kodu 
              move konuk-folio to tgunluk-r-folio
              
              move tgunluk-folio to konuk-acik-2(9:)
              perform konuktan-rez
              move "G" to REZ-KUR-AYGUN 
              write rez-rec  invalid stop " " end-write 
              else
               move konuk-folio to tgunluk-e-folio
               move tgunluk-folio to konuk-acik-2(9:)
               move "E" to  konuk-fol-kodu
               move konuk-adi to konuk-adi(4:)
               move "E=>" to konuk-adi(1:3)
               
               if tgunluk-tip = "M" then  
               move "E" to  konuk-fol-kodu 
               end-if
          end-if
          write konuk-rec invalid stop " " end-write
          move konuk-folio to ozluk-folio 
              move konuk-adi to ozluk-adi
              move konuk-soyadi to ozluk-soyadi
              write ozluk-rec invalid stop " " end-write
           
              if konuk-fol-kodu = "R"  then
                 
                  add 1 to konuk-folio
                     move "E" to Konuk-Cik-Cikma
               
                   initialize  konuk-rez-no 
                  konuk-kisi  konuk-voucher  konuk-nor-indirim 
                    konuk-cik-cikma 
                    konuk-oda-tutar  konuk-extbed-tutar konuk-kahvalti-tutar 
                    konuk-ogle-tutar  konuk-aksam-tutar konuk-icecek-tutar 
                    konuk-extra-tutar konuk-top-borc konuk-top-alac konuk-kur-degeri 
                     konuk-dv-degeri konuk-dv-degeri konuk-acik konuk-kartno 
*/                     konuk-bos
                   move "E" to konuk-fol-kodu
                   move konuk-folio to tgunluk-e-folio 
                   move tgunluk-odeme to odemex-kodu
                   move konuk-adi to konuk-adi(4:)
                   move "E=>" to  konuk-adi(1:3)
                 read odemex no lock 
                   invalid  stop " " 
                 end-read 
                 evaluate Odemex-Tip
                     when 1 
                     when 2
                     when 3
                        move "01" to konuk-odeme-tipi
                     when 4
                        move "02" to konuk-odeme-tipi
                     when 5
                        move "40" to konuk-odeme-tipi
                     when 6
                     when 7
                        move "20" to konuk-odeme-tipi
 
                 end-evaluate
                 write konuk-rec invalid stop " " end-write
                 move konuk-folio to ozluk-folio 
              move konuk-adi to ozluk-adi
              move konuk-soyadi to ozluk-soyadi
              write ozluk-rec invalid stop " " end-write
              end-if
          
            rewrite tgunluk-rec invalid stop " " end-rewrite
          
          .

*
 mod-ozluk-al2.
         if  tgunluk-ozluk-1 not = 0 then  
            move 1 to yanrez-sirano
            move tgunluk-ozluk-1 to mod-ozluk-anahtar 
            perform tek-ozluk-al 
             
         end-if .
*
 mod-dep-al.
         open i-o depkod 
         open input mod-depkod
         initialize mod-depkod-rec
         start mod-depkod key > mod-depkod-anahtar
            invalid continue 
            not invalid
            perform until fs-mod-acenta = "10"
            read mod-depkod next no lock 
              end move "10" to fs-mod-acenta
              not end
                 move mod-depkod-anahtar  to  DEPKOD-KODU
                 move mod-depkod-adi      to depkod-adi
                 
                 evaluate mod-depkod-debit-credit 
                   when "D" 
                      move "B" to DEPKOD-BA
                   when "C"
                      move "A" to depkod-BA
                   when other 
                     stop " " 
                  end-evaluate
                 move 18 to DEPKOD-KDV
                 write depkod-rec invalid rewrite depkod-rec end-write
              end-read
           end-perform
        end-start
        close  depkod mod-depkod.
    
*
 hrk-al.
        
       open output romhrk exthrk silhrk
       close romhrk exthrk silhrk
      
        open input tkumfat tygunluk tgunluk mod2asya mod-depkod
        open input tmacenta
        open i-o  romhrk exthrk  silhrk
       initialize tkumfat-rec  fs-mod-acenta  
       start tkumfat key > tkumfat-anahtar
            invalid continue
            not invalid
            perform until fs-mod-acenta = "10"
            read tkumfat next no lock 
              end move "10" to fs-mod-acenta
              not end
                   
                  if tkumfat-tarih < "20050101" then 
                     exit perform cycle
                  end-if
                  move tkumfat-folio to tygunluk-anahtar tgunluk-anahtar
                  move  tkumfat-depart to mod-depkod-anahtar HRKGIR-DEPKOD 
                         
                  move tkumfat-anahtar(3:8) to  HRKGIR-ISLEM   
   
                      read mod-depkod no lock 
                       invalid 
                         stop " " 
                      end-read  
                      evaluate mod-depkod-debit-credit 
                         when "D" 
                            move "B" to HRKGIR-BA
                          when "C"
                            move "A" to HRKGIR-BA
                      end-evaluate
                     read tygunluk 
                        invalid 
                           read tgunluk 
                             invalid 
                                if tkumfat-sil = "-"
                                  
                                  exit perform cycle
                                end-if
                                stop " "
                             not invalid
                                if mod-depkod-filler= "E" then 
                                   move tgunluk-e-folio to  HRKGIR-FOLIO 
                                   else 
                                   move tgunluk-r-folio to  HRKGIR-FOLIO
                                end-if
                                if hrkgir-folio not > 0 then 
                                       move tgunluk-e-folio  to hrkgir-folio
                                        move "E" to mod-depkod-filler 
                                end-if
                                 if hrkgir-folio not > 0 then 
                                       move tgunluk-r-folio   to hrkgir-folio
                                        move "R" to mod-depkod-filler 
                                end-if
                                if hrkgir-folio not > 0 then 
                                       stop " "
                                end-if
                            end-read
                       not invalid
                          if mod-depkod-filler= "E" then 
                              move tygunluk-e-folio to  HRKGIR-FOLIO 
                           else 
                              move tygunluk-r-folio to  HRKGIR-FOLIO
                          end-if
                          if hrkgir-folio not > 0 then 
                                 move tygunluk-e-folio  to hrkgir-folio
                                 move "E" to mod-depkod-filler 
                          end-if
                           if hrkgir-folio not > 0 then 
                                 move tygunluk-r-folio   to hrkgir-folio
                                  move "R" to mod-depkod-filler 
                          end-if
                          if hrkgir-folio not > 0 then 
                                 stop " "
                          end-if
                      end-read
                             move "M" to  HRKGIR-ISLEM-TIPI
                         
                            move tkumfat-tarih    to  HRKGIR-TARIH
                            move tkumfat-hrk      to  HRKGIR-TL-TUTAR HRKGIR-DV-TUTAR 
                            initialize  HRKGIR-CORR-DEPKOD
                       
                        if tkumfat-cor-arti > 0 then 
                          move   tkumfat-cor-arti to HRKGIR-TL-TUTAR 
                           if  tkumfat-hrk > 0 or tkumfat-cor-eksi > 0  then 
                             stop " "
                          end-if
                          if "A" = HRKGIR-BA 
                             move hrkgir-DEPKOD  to HRKGIR-CORR-DEPKOD
                             move 98   to  hrkgir-DEPKOD
                             move "B"  to  HRKGIR-BA
                           else 
                             move hrkgir-DEPKOD  to HRKGIR-CORR-DEPKOD
                             move 99   to  hrkgir-DEPKOD
                             move "A"  to  HRKGIR-BA
                          end-if
                          
                        end-if
                        if tkumfat-cor-eksi > 0 then 
                          move   tkumfat-cor-eksi to HRKGIR-TL-TUTAR 
                           if  tkumfat-hrk > 0 or tkumfat-cor-arti > 0 then 
                             stop " "
                          end-if
                          if "A" = HRKGIR-BA 
                             move hrkgir-DEPKOD  to HRKGIR-CORR-DEPKOD
                             move 99   to  hrkgir-DEPKOD
                             move "A"  to  HRKGIR-BA
                           else 
                             move hrkgir-DEPKOD  to HRKGIR-CORR-DEPKOD
                             move 98   to  hrkgir-DEPKOD
                             move "B"  to  HRKGIR-BA
                          end-if
                        end-if
                           
                            move tkumfat-zaman    to   hrkgir-zaman
                            move tkumfat-kart-no  to  HRKGIR-KART-NO 
                            move tkumfat-cekno    to    HRKGIR-cekNO
                            move tkumfat-staf     to  HRKGIR-STAF 
                            if tkumfat-sil = "-"
                                
                                move hrkgir-rec to silhrk-rec

                                write silhrk-rec invalid stop " " end-write
                                else
                                 if mod-depkod-filler = "E" then 
                                 move hrkgir-rec to exthrk-rec
                                 write exthrk-rec invalid stop " " end-write
                                  else 
                                  move hrkgir-rec to romhrk-rec
                                 write romhrk-rec invalid stop " " end-write
                                 end-if
                            end-if
                  end-read
              end-perform
          end-start.
          close tkumfat tygunluk tgunluk mod2asya mod-depkod
          close tmacenta
          close  romhrk exthrk  silhrk .
*
 kur-al.
        open output kur close kur
        open input tkur
        open i-o kur 
        initialize tkur-rec kur-rec   fs-mod-acenta

        start tkur key > tkur-anahtar
          invalid continue 
          not invalid
          perform until fs-mod-acenta = "10"
            read tkur next 
              end move "10" to fs-mod-acenta
              not end
               move  tkur-tarih   to kur-tarih
               move tkur-staf to DOVIZ-STAF
               perform varying  kk from 1 by 1 until kk > 20
                  if kk = 2 or kk= 3  or kk =4  or kk=5  or kk=6  or kk  = 7  or
                    Kk= 8  or kk=9  or kk=10  or kk=13  or kk= 14  or kk = 15  or 
                    kk = 16  or kk = 18 then 
                    exit perform cycle 
                  end-if
                  move "01" to kur-banka
                   move kk                to KUR-DOVIZ 
                   if kk = 19 then 
                   move 1 to tkur-c-in-tutar(kk)
                   end-if
                   move tkur-c-in-tutar(kk)   to DOVIZ-ALIS 
                   write kur-rec invalid stop " " end-write 
                   move "02" to kur-banka
                   move tkur-f-cash-tutar(kk)   to DOVIZ-ALIS 
                   write kur-rec invalid stop " " end-write 
               end-perform 
                 move "01" to kur-banka
                   move 99                to KUR-DOVIZ 
                   
                   move 1   to DOVIZ-ALIS 
                   write kur-rec invalid stop " " end-write 
                   move "02" to kur-banka
                   move 1   to DOVIZ-ALIS 
                   write kur-rec invalid stop " " end-write 

            end-read     
          end-perform 
        end-start
        close kur tkur .

 ali-cengiz.
       open input konuk.
       open i-o romhrk exthrk.
       start konuk key > konuk-folio
        invalid
         continue
        not invalid
         perform until fs-konuk = "10" 
           read konuk next 
              end move "10" to fs-konuk
              not end
               if konuk-gel-tar < "20050101" then 
                 exit perform cycle
               end-if
               if konuk-durumu = "I"
                 exit perform cycle
               end-if
               compute eski-balans  = KONUK-TOP-BORC -  KONUK-TOP-ALAC 
               if eski-balans = 0 then
                 exit perform cycle 
               end-if
               if konuk-fol-kodu not = "R" then 
                  stop " "
               end-if
               move konuk-folio to eski-konuk
                  read konuk next  
                    end 
                      stop " "
                    not end
                       if konuk-fol-kodu = "R" then 
                       stop " " 
                       end-if

                       compute yeni-balans  = 
                          KONUK-TOP-BORC -  KONUK-TOP-ALAC 
                       if yeni-balans + eski-balans not = 0 then 
                         stop " "
                           else 
                           initialize exthrk-rec
                           move konuk-folio to exthrk-folio
                           start exthrk key > exthrk-anah 
                             invalid
                             continue
                             not invalid
                            perform until fs-exthrk = "10"
                              read exthrk next
                                end 
                                 move "10" to fs-exthrk
                                not end
                                 if exthrk-folio not = konuk-folio
                                  move "10" to fs-exthrk
                                 else 
                                  move exthrk-rec to romhrk-rec 
                                  move eski-konuk to romhrk-folio 
                                  write romhrk-rec invalid stop " " end-write
                                  delete exthrk end-delete
                                  end-if
                              end-read   

                            end-perform
                           end-start
                       end-if
                   end-read
               
           end-read    
         end-perform
       end-start     .
      
        close romhrk exthrk.
       
       .



* 02 KUR-KODU.
*             03 KUR-TARIH.
*                04 KUR-YIL    PIC 9(4).
*                04 KUR-AY     PIC 9(2).
*                04 KUR-GUN    PIC 9(2).
*             03 KUR-BANKA     PIC 9(2).
*             03 KUR-DOVIZ     PIC 9(2).
*          02 DOVIZ-ALIS       PIC 9(9)V9(05) COMP-3.
*          02 DOVIZ-SATIS      PIC 9(9)V9(05) COMP-3.
*          02 EFEKTIF-ALIS     PIC 9(9)V9(05) COMP-3.
*          02 EFEKTIF-SATIS    PIC 9(9)V9(05) COMP-3.
*          02 PARITE           PIC 9(6)V9(05) COMP-3.
*          02 DOVIZ-STAF       PIC X(04).


*       02 tkur-anahtar.
*             03 tkur-tarih        pic x(8).
*          02 tkur-occ occurs 20 times.
*             03 tkur-f-cash-tutar pic 9(5)v9(5) comp-3.
*             03 tkur-c-in-tutar   pic 9(5)v9(5) comp-3.
*          02 tkur-staf            pic xxxx.
*                 


          
*          02 HRKGIR-CORR-DEPKOD   PIC 999.
*          
*          02 HRKGIR-DV-TUTAR      PIC 9(09)V99 COMP-3.
*          
*          02 HRKGIR-POS-KODU      PIC X(02).
*          02 HRKGIR-BOS           PIC X(10).
          
*  02 tkumfat-anahtar.
*            03 tkumfat-islen-no         pic x(10).
*         02 tkumfat-oda             pic x(4).
*         02 tkumfat-folio           pic x(10).
*         02 tkumfat-hrk             pic 9(12)v99 comp-3.
*         02 tkumfat-cor-eksi        pic 9(12)v99 comp-3.
*         02 tkumfat-cor-arti        pic 9(12)v99 comp-3.
*         02 tkumfat-doviz          pic 9(12)v99 comp-3.
*         02 tkumfat-tarih          pic x(8).
*         02 tkumfat-depart         pic x(2).
*         02 tkumfat-cekno          pic x(10).
*         02 tkumfat-zaman          pic x(4).
*         02 tkumfat-kart-no        pic x(7).
*         02 tkumfat-staf          pic x(4).
*         02 tkumfat-aciklama         pic x(16).
*         02 tkumfat-duzeltme-tarih pic x(8).
*         02 tkumfat-duzeltme-zaman  pic x(4).
*         02 tkumfat-duzeltme-staf        pic x(4).
*         02 tkumfat-doviz-kodu      pic x(2).
*         02 tkumfat-correction       pic x.
*         02 hasan    pic   x(22).   
      
* 
 cor-ali.
      open i-o romhrk exthrk
      initialize romhrk-rec exthrk-rec

      start romhrk key > romhrk-anah
        invalid 
        continue
        not invalid
        perform until fs-romhrk = "10"
         read romhrk next 
            end
              move "10" to fs-romhrk
            not end
              if romhrk-depkod not = 98 and
                 romhrk-depkod not = 99  then 
                 initialize romhrk-CORR-DEPKOD
              
              rewrite romhrk-rec end-rewrite
              end-if 
          end-read
        end-perform 
      end-start
       start exthrk key > exthrk-anah
        invalid 
        continue
        not invalid
        perform until fs-exthrk = "10"
         read exthrk next 
            end
              move "10" to fs-exthrk
            not end
              if exthrk-depkod not = 98 and
                 exthrk-depkod not = 99  then 
                 initialize exthrk-CORR-DEPKOD
              
              rewrite exthrk-rec end-rewrite
              end-if 
          end-read
        end-perform 
      end-start
       close exthrk romhrk.    

*
 doviz-duzelt. 
       open i-o rez konuk.
      initialize rez-rec
            start rez key > rez-anah
              invalid stop " "
            end-start
            perform until fs-rez = "10" 
              read rez next no lock 
                end move "10" to fs-rez
                not end 
                  
                  if rez-doviz  = 0 then 
                    move 99 to rez-doviz
                     rewrite rez-rec invalid stop " " end-rewrite
                   
                end-if
               end-read
            end-perform  
             initialize konuk-rec
            start konuk key > konuk-anah
              invalid stop " "
            end-start
            perform until fs-konuk = "10" 
              read konuk next no lock 
                end move "10" to fs-konuk
                not end 
                  
                  if konuk-doviz  = 0 then 
                    move 99 to konuk-doviz
                     rewrite konuk-rec invalid stop " " end-rewrite
                   
                end-if
               end-read
            end-perform . 
            close rez konuk.

*
 odeme-kodlari-duzelt.
      open input mod-rez odemex.   
      open i-o rez.
      initialize rez-rec
            start rez key > rez-anah
              invalid stop " "
            end-start
            perform until fs-rez = "10" 
              read rez next no lock 
                end move "10" to fs-rez
                not end 
                 if rez-gir-tar > "20070404"   then 
                      move rez-adres1(1:10) to mod-rez-anahtar
                      read mod-rez no lock
                         invalid 
                            continue
                             
                         not invalid
                          move mod-rez-odeme-kodu to odemex-kodu
                             read odemex  no lock invalid 
                                 stop " "

                               not invalid

                              evaluate odemex-tip
                                  when "1"
                                      move "01" to rez-odeme-tipi
                                  when "4"
                                  when "2"
                                   move "02" to rez-odeme-tipi
                                 when "3"
                                  when "7"
                                    move "20" to rez-odeme-tipi
                                 when "6"
                                    move "30" to rez-odeme-tipi
                                  when "5"
                                      move "40" to rez-odeme-tipi
                                 when other 
                                      display message box "Beklenmeyen Mod Odeme tipi--" odemex-tip  
                             end-evaluate
                               rewrite rez-rec invalid stop " " end-rewrite 
                            end-read
                  end-if
               end-read
            end-perform . 
            close rez mod-rez odemex.
*
 fiyatlari-duzelt.
          open i-o fiyatana.
          initialize fiyatana-rec
          start fiyatana key > fiyatana-anah
            invalid continue
            not invalid
          perform until fs-fiyatana = "10" 
            read fiyatana next no lock 
               end move "10" to fs-fiyatana
               not end 
                 evaluate FIYATANA-ANLASMA
                    when 11
                    when 12
                    when 13
                    when 14
                    when 21 when 22 when 23
                    when 31 when 32 when 33  when 34
                    when 41 when 42 when 43 when 44
                    when 50 when 51 when 52 when 53
                    when 58 when 61 when 62 when 63
                       move "E" to  FIYATANA-EB-EH
                       move "20070101" to FIYATANA-EB-BAS-TARIH
                       move "20070228" to FIYATANA-EB-BIT-TARIH
                    when other 
                      move "H" to  FIYATANA-EB-EH
                      initialize  FIYATANA-EB-BAS-TARIH
                                  FIYATANA-EB-BIT-TARIH
                                  fiyatana-eb-oran 
                                  fiyatana-eb-kusur

                 end-evaluate
                   
                        rewrite fiyatana-rec invalid stop " " end-rewrite
                  
            end-read
          end-perform 
          end-start.
*
 sildim.

            initialize fiyatana-rec
          start fiyatana key > fiyatana-anah
            invalid continue
            not invalid
          perform until fs-fiyatana = "10" 
            read fiyatana next no lock 
               end move "10" to fs-fiyatana
               not end 
                 evaluate FIYATANA-ANLASMA
                     when 01
                        move 04 to  FIYATANA-ANLASMA 
                        write fiyatana-rec invalid stop " " end-write
                    
                 end-evaluate
                   
            end-read
          end-perform 
          end-start.




          close fiyatana.
* 


@}}

[KEY_STATUS_FIELD_FORMAT]
PIC=9(4)
USAGE=[None]

[KEYSTATUS_CONTENT:KS1]
CONDITION=Exit-Pushed
VALUE=27

[KEYSTATUS_CONTENT:KS2]
CONDITION=Message-Received
VALUE=95

[KEYSTATUS_CONTENT:KS3]
CONDITION=Event-Occurred
VALUE=96

[KEYSTATUS_CONTENT:KS4]
CONDITION=Screen-No-Input-Field
VALUE=97

[CODE_GENERATION_OPTIONS]
FOLLOW_PROJECT_OPTIONS=1
GENERATE_PROGRAM_FILE=1
GENERATE_WORKING_STORAGE=1
GENERATE_EVENT_PARAGRAPH=1
GENERATE_SCREEN_SECTION=1
GENERATE_REPORT_SECTION=1
GENERATE_PROCEDURE_DIVISION=1
GENERATE_MENU_PARAGRAPH=1
GENERATE_LINKAGE_SECTION=1
REPLACE_REMARK_PART=1
EXCLUDE_PROGRAM_VARIABLE=0
EXCLUDE_PROGRAM_PARAGRAPH=0
PROGRAM_EXTENSION=.cbl
WORKINGSTORAGE_EXTENSION=.wrk
EVENT_EXTENSION=.evt
SCREEN_EXTENSION=.scr
REPORT_EXTENSION=.rpt
PROCEDURE_EXTENSION=.prd
MENU_EXTENSION=.mnu
LINKAGE_EXTENSION=.lks
PROGRAM_FILE_READ_ONLY=0
LINK_CLOSE_TO_OPEN=0
COPYBOOK_READ_ONLY=0
GENERATE_COPY_FILES=1
ACCEPT_CONTROL=1
ANSI_DOCUMENT_FORMAT=0