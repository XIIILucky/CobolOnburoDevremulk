; CASEMaker AcuBench Program Structure File, Version 9.2
; WARNING: DO NOT MODIFY THIS FILE!

[PROGRAM_CONTENT]
QUIT_CONFIRM=0
INIT_PROGRAM=1
MAIN_SCREEN_NAME=Form1

{{@DESCRIPTION:

@}}

[WORKING_STORAGE]
m_nType=1
m_strName=Working Storage
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionWK

@}}
[FDITEM0_WK]
m_strName=degiskenler
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_WK

@}}
[FDITEM1_WK]
m_strName=tarih
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_WK

@}}
[FDITEM2_WK]
m_nType=10
m_strName=yil
m_strRawPic=9(4)
m_strPic=9(4)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM2_WK

@}}
[FDITEM3_WK]
m_nType=10
m_strName=ay
m_strRawPic=9(2)
m_strPic=9(2)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM3_WK

@}}
[FDITEM4_WK]
m_nType=10
m_strName=gun
m_strRawPic=9(2)
m_strPic=9(2)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM4_WK

@}}
[FDITEM5_WK]
m_nType=10
m_strName=numara
m_strRawPic=9(6)
m_strPic=9(6)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM5_WK

@}}
[FDITEM6_WK]
m_nType=10
m_strName=ref
m_strRawPic=9(3)
m_strPic=9(3)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM6_WK

@}}
[FDITEM7_WK]
m_strName=fs-kasa-borc-dep
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_fs_borc__2
{{@DataItem_m_strDescriptionFDITEM7_WK

@}}
[FDITEM8_WK]
m_strName=fs-borc-fat
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_fs_borc__2
{{@DataItem_m_strDescriptionFDITEM8_WK

@}}
[FDITEM9_WK]
m_strName=fs-kasa-alac-dep
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_fs_borc__1
{{@DataItem_m_strDescriptionFDITEM9_WK

@}}
[FDITEM10_WK]
m_strName=fs-borc-dep
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM10_WK

@}}
[FDITEM11_WK]
m_strName=fs-alac-dep
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_fs_borc__1
{{@DataItem_m_strDescriptionFDITEM11_WK

@}}
[FDITEM12_WK]
m_strName=fs-takaskar
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_fs_borc__1
{{@DataItem_m_strDescriptionFDITEM12_WK

@}}
[FDITEM13_WK]
m_strName=takaskar-adres
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM13_WK

@}}
[FDITEM14_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=x(20)
m_strDefaultValue="/asya/ytl/liste/tkar"
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM14_WK

@}}
[FDITEM15_WK]
m_strName=takaskar-no
m_strRawPic=x(4)
m_strPic=x(4)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM15_WK

@}}
[FDITEM16_WK]
m_strName=fs-takas-acenta
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_fs_borc__1
{{@DataItem_m_strDescriptionFDITEM16_WK

@}}
[FDITEM17_WK]
m_strName=borc-fat-adres
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM17_WK

@}}
[FDITEM18_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=X(20)
m_strDefaultValue="/asya/ytl/liste/bfad"
m_nItemLevel=3
m_bValue=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM18_WK

@}}
[FDITEM19_WK]
m_strName=borc-fat-no
m_strRawPic=x(4)
m_strPic=X(4)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM19_WK

@}}
[FDITEM20_WK]
m_strName=takasdys-adres
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM20_WK

@}}
[FDITEM21_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=X(20)
m_strDefaultValue="/asya/ytl/liste/hbur"
m_nItemLevel=3
m_bValue=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM21_WK

@}}
[FDITEM22_WK]
m_strName=takasdys-no
m_strRawPic=9(4)
m_strPic=9(4)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM22_WK

@}}
[FDITEM23_WK]
m_strName=kasa-borc-dep-adres
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM23_WK

@}}
[FDITEM24_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=x(20)
m_strDefaultValue="/asya/ytl/liste/bork"
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM24_WK

@}}
[FDITEM25_WK]
m_strName=kasa-borc-dep-no
m_strRawPic=x(4)
m_strPic=x(4)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM25_WK

@}}
[FDITEM26_WK]
m_strName=borc-dep-adres
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM26_WK

@}}
[FDITEM27_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=x(20)
m_strDefaultValue="/asya/ytl/liste/bord"
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__4
{{@DataItem_m_strDescriptionFDITEM27_WK

@}}
[FDITEM28_WK]
m_strName=borc-dep-no
m_strRawPic=x(4)
m_strPic=x(4)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
m_strAlias=borc_dep_no__2
{{@DataItem_m_strDescriptionFDITEM28_WK

@}}
[FDITEM29_WK]
m_strName=kasa-alac-dep-adres
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM29_WK

@}}
[FDITEM30_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=x(20)
m_strDefaultValue="/asya/ytl/liste/alkd"
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__3
{{@DataItem_m_strDescriptionFDITEM30_WK

@}}
[FDITEM31_WK]
m_strName=kasa-alac-dep-no
m_strRawPic=x(4)
m_strPic=x(4)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
m_strAlias=borc_dep_no__1
{{@DataItem_m_strDescriptionFDITEM31_WK

@}}
[FDITEM32_WK]
m_strName=alac-dep-adres
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM32_WK

@}}
[FDITEM33_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=x(20)
m_strDefaultValue="/asya/ytl/liste/alad"
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__3
{{@DataItem_m_strDescriptionFDITEM33_WK

@}}
[FDITEM34_WK]
m_strName=alac-dep-no
m_strRawPic=x(4)
m_strPic=x(4)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
m_strAlias=borc_dep_no__1
{{@DataItem_m_strDescriptionFDITEM34_WK

@}}
[FDITEM35_WK]
m_strName=takas-acenta-adres
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM35_WK

@}}
[FDITEM36_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=x(20)
m_strDefaultValue="/asya/ytl/liste/taka"
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__3
{{@DataItem_m_strDescriptionFDITEM36_WK

@}}
[FDITEM37_WK]
m_strName=takas-acenta-no
m_strRawPic=x(4)
m_strPic=x(4)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
m_strAlias=borc_dep_no__1
{{@DataItem_m_strDescriptionFDITEM37_WK

@}}
[FDITEM38_WK]
m_nType=10
m_strName=vis-1
m_strRawPic=9
m_strPic=9
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM38_WK

@}}
[FDITEM39_WK]
m_strName=gec-gecme
m_strRawPic=9
m_strPic=9
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM39_WK

@}}
[FDITEM40_WK]
m_strName=link-referans
m_strRawPic=x(3)
m_strPic=x(3)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM40_WK

@}}
[FDITEM41_WK]
m_strName=acik-tar
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM41_WK

@}}
[FDITEM42_WK]
m_strName=acik-gun
m_strRawPic=9(2)
m_strPic=9(2)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM42_WK

@}}
[FDITEM43_WK]
m_strName=FILLER
m_strRawPic=x
m_strPic=x
m_strDefaultValue="/"
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__1
{{@DataItem_m_strDescriptionFDITEM43_WK

@}}
[FDITEM44_WK]
m_strName=acik-ay
m_strRawPic=9(2)
m_strPic=9(2)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM44_WK

@}}
[FDITEM45_WK]
m_strName=FILLER
m_strRawPic=x
m_strPic=x
m_strDefaultValue="/"
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__2
{{@DataItem_m_strDescriptionFDITEM45_WK

@}}
[FDITEM46_WK]
m_strName=acik-yil
m_strRawPic=9(4)
m_strPic=9(4)
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM46_WK

@}}
[FDITEM47_WK]
m_strName=borc
m_strRawPic=s9(15)v9(2)
m_strPic=s9(15)v9(2)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM47_WK

@}}
[FDITEM48_WK]
m_strName=carpan
m_strRawPic=s999
m_strPic=s999
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM48_WK

@}}
[FDITEM49_WK]
m_strName=alac
m_strRawPic=s9(15)v9(2)
m_strPic=s9(15)v9(2)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM49_WK

@}}
[FDITEM50_WK]
m_strName=fis-sira-sakla
m_strRawPic=9(6)
m_strPic=9(6)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM50_WK

@}}
[FDITEM51_WK]
m_nType=10
m_strName=enable-1
m_strRawPic=9
m_strPic=9
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM51_WK

@}}
[FDITEM52_WK]
m_nType=10
m_strName=enable-2
m_strRawPic=9
m_strPic=9
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM52_WK

@}}
[FDITEM53_WK]
m_strName=tl-gunluk
m_strRawPic=9(15)v9(2)
m_strPic=9(15)v9(2)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM53_WK

@}}
[FDITEM54_WK]
m_strName=dv-gunluk
m_strRawPic=9(15)v9(2)
m_strPic=9(15)v9(2)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM54_WK

@}}
[FDITEM55_WK]
m_strName=etutar
m_strRawPic=zzzzz,zzz,zzz,zzz.zz
m_strPic=zzzzz,zzz,zzz,zzz.zz
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM55_WK

@}}
[FDITEM56_WK]
m_strName=kdv-olmasigereken
m_strRawPic=s9(12)v99
m_strPic=s9(12)v99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM56_WK

@}}
[FDITEM57_WK]
m_strName=kv-olmasigereken
m_strRawPic=s9(12)v99
m_strPic=s9(12)v99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM57_WK

@}}
[FDITEM58_WK]
m_strName=matrah-olmasigereken
m_strRawPic=s9(12)v99
m_strPic=s9(12)v99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM58_WK

@}}
[FDITEM59_WK]
m_strName=kdv-fark
m_strRawPic=s9(12)v99
m_strPic=s9(12)v99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM59_WK

@}}
[FDITEM60_WK]
m_strName=kv-fark
m_strRawPic=s9(12)v99
m_strPic=s9(12)v99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM60_WK

@}}
[FDITEM61_WK]
m_strName=matrah-fark
m_strRawPic=s9(12)v99
m_strPic=s9(12)v99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM61_WK

@}}
[FDITEM62_WK]
m_strName=gecici-tl-tut
m_strRawPic=9(12)v99
m_strPic=9(12)v99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM62_WK

@}}
[FDITEM63_WK]
m_strName=gecici-dv-tut
m_strRawPic=9(12)v99
m_strPic=9(12)v99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_gecici___1
{{@DataItem_m_strDescriptionFDITEM63_WK

@}}
[FDITEM64_WK]
m_strName=bakiye
m_strRawPic=9(15)v9(2)
m_strPic=9(15)v9(2)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM64_WK

@}}
[FDITEM65_WK]
m_strName=dusulecek
m_strRawPic=9(15)v9(2)
m_strPic=9(15)v9(2)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM65_WK

@}}
[FDITEM66_WK]
m_strName=islem-kuru
m_strRawPic=9(09)v9(05)
m_strPic=9(09)v9(05)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM66_WK

@}}
[FDITEM67_WK]
m_strName=yedek-matrah-olmasigereken
m_strRawPic=s9(12)v99
m_strPic=s9(12)v99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM67_WK

@}}
[FDITEM68_WK]
m_strName=no-kont
m_strRawPic=9(06)
m_strPic=9(06)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM68_WK

@}}
[FDITEM69_WK]
m_strName=kdvli
m_strRawPic=x
m_strPic=x
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM69_WK

@}}
[FDITEM70_WK]
m_strName=kk
m_strRawPic=x
m_strPic=x
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM70_WK

@}}
[FDITEM71_WK]
m_strName=fs-mahsupm
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM71_WK

@}}
[FDITEM72_WK]
m_strName=toplam-tut
m_strRawPic=s9(8)v99
m_strPic=S9(8)V99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM72_WK

@}}
[FDITEM73_WK]
m_strName=kdv-tut
m_strRawPic=s9(8)v99
m_strPic=S9(8)V99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM73_WK

@}}
[FDITEM74_WK]
m_strName=kv-tut
m_strRawPic=s9(8)v99
m_strPic=S9(8)V99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM74_WK

@}}
[FDITEM75_WK]
m_strName=matrah-tut
m_strRawPic=s9(8)v99
m_strPic=S9(8)V99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM75_WK

@}}
[FDITEM76_WK]
m_strName=dep-kdv
m_strRawPic=99
m_strPic=99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM76_WK

@}}
[FDITEM77_WK]
m_strName=depgec-kv-orani
m_strRawPic=99
m_strPic=99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM77_WK

@}}
[FDITEM78_WK]
m_strName=sat-ref
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM78_WK

@}}
[FDITEM79_WK]
m_strName=pen-hata
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM79_WK

@}}
[FDITEM80_WK]
m_strName=cl-ref
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM80_WK

@}}
[FDITEM81_WK]
m_strName=fs-nfatura
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM81_WK

@}}
[FDITEM82_WK]
m_strName=tanimsiz-sayi
m_strRawPic=99
m_strPic=99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM82_WK

@}}
[FDITEM83_WK]
m_strName=ad-soyad
m_strRawPic=x(30)
m_strPic=x(30)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM83_WK

@}}
[FDITEM84_WK]
m_strName=sonuc
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM84_WK

@}}
[FDITEM85_WK]
m_strName=nereden
m_strRawPic=x
m_strPic=x
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM85_WK

@}}
[FDITEM86_WK]
m_strName=debug
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM86_WK

@}}
[FDITEM87_WK]
m_strName=ramco
m_strRawPic=s9999999v99
m_strPic=s9999999v99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM87_WK

@}}
[FDITEM88_WK]
m_strName=gunluk-doviz
m_strRawPic=9(09)v99
m_strPic=9(09)v99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM88_WK

@}}
[FDITEM89_WK]
m_strName=ref-adi2
m_strRawPic=x(30)
m_strPic=x(30)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM89_WK

@}}
[FDITEM90_WK]
m_strName=z-8
m_strRawPic=z(8)
m_strPic=z(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM90_WK

@}}
[FDITEM91_WK]
m_strName=s-6
m_strRawPic=9(6)
m_strPic=9(6)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM91_WK

@}}
[FDITEM92_WK]
m_strName=evet-hayir
m_strRawPic=x
m_strPic=x
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM92_WK

@}}
[FDITEM93_WK]
m_strName=evet
m_nItemLevel=88
m_nSync=-1
m_bFixed=1
m_strTrue="E"
{{@DataItem_m_strDescriptionFDITEM93_WK

@}}
[FDITEM94_WK]
m_strName=hayir
m_nItemLevel=88
m_nSync=-1
m_bFixed=1
m_strTrue="H"
{{@DataItem_m_strDescriptionFDITEM94_WK

@}}
[FDITEM95_WK]
m_nType=10
m_strName=Small-Font
m_nUsage=37
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM95_WK

@}}
[FDITEM96_WK]
m_nType=10
m_strName=Form1-Handle
m_nUsage=24
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM96_WK

@}}
[FDITEM97_WK]
m_nType=10
m_strName=Form1-St-1-Handle
m_nUsage=51
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM97_WK

@}}
[FDITEM98_WK]
m_nType=10
m_strName=Form1-Gd-1-Record
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM98_WK

@}}
[FDITEM99_WK]
m_nType=10
m_strName=Gd-1-Col-1
m_strRawPic=X(15)
m_strPic=X(15)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM99_WK

@}}
[FDITEM100_WK]
m_nType=10
m_strName=Gd-1-Col-2
m_strRawPic=X(40)
m_strPic=X(40)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM100_WK

@}}
[FDITEM101_WK]
m_nType=10
m_strName=Gd-1-Col-3
m_strRawPic=X(40)
m_strPic=X(40)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM101_WK

@}}
[FDITEM102_WK]
m_nType=10
m_strName=Gd-1-Col-5
m_strRawPic=X(20)
m_strPic=X(20)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM102_WK

@}}
[FDITEM103_WK]
m_nType=10
m_strName=Gd-1-Col-6
m_strRawPic=X(20)
m_strPic=X(20)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM103_WK

@}}
[FDITEM104_WK]
m_nType=10
m_strName=Gd-1-Col-4
m_strRawPic=X(07)
m_strPic=X(07)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM104_WK

@}}
[FDITEM105_WK]
m_nType=10
m_strName=Gd-1-Col-7
m_strRawPic=X(20)
m_strPic=X(20)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM105_WK

@}}
[FDITEM106_WK]
m_nType=10
m_strName=Gd-1-Col-8
m_strRawPic=X(5)
m_strPic=X(5)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM106_WK

@}}
[FDITEM107_WK]
m_nType=10
m_strName=Gd-1-Col-9
m_strRawPic=X(08)
m_strPic=X(08)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM107_WK

@}}
[FDITEM108_WK]
m_nType=10
m_strName=Form1-Ef-1-Value
m_strRawPic=X(30)
m_strPic=X(30)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM108_WK

@}}
[FDITEM109_WK]
m_nType=10
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM109_WK

@}}
[FDITEM110_WK]
m_nType=10
m_strName=Form1-Cm-1-Container-Item
m_nItemLevel=3
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM110_WK

@}}
[FDITEM111_WK]
m_nType=10
m_strRawPic=X(21)
m_strPic=X(21)
m_strDefaultValue="D-Dovizli Mahsup Kes"
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM111_WK

@}}
[FDITEM112_WK]
m_nType=10
m_strRawPic=X(21)
m_strPic=X(21)
m_strDefaultValue="T-Dovizsiz Mahsup Kes"
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM112_WK

@}}
[FDITEM113_WK]
m_nType=10
m_strName=Form1-Cm-1-Container-Num
m_strDefaultValue=2
m_nItemLevel=78
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM113_WK

@}}
[FDITEM114_WK]
m_nType=10
m_strName=Form1-Cm-1-Container
m_strRawPic=X(21)
m_strPic=X(21)
m_nItemLevel=3
m_bRedefines=1
m_strRedefines=Form1-Cm-1-Container-Item
m_nSync=-1
m_bOccurs=1
m_bFixed=1
m_strRawSize=2
m_nSize=2
m_bIndexed=1
m_lstIndex=Form1-Cm-1-Container-Idx,
{{@DataItem_m_strDescriptionFDITEM114_WK

@}}
[FDITEM115_WK]
m_nType=10
m_strName=combo-dovizlimi-value
m_strRawPic=X(21)
m_strPic=X(21)
m_strDefaultValue="D-Dovizli Mahsup Kes"
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM115_WK

@}}
[FDITEM116_WK]
m_nType=10
m_strName=uzak-no
m_strRawPic=x(3)
m_strPic=x(3)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM116_WK

@}}
[FDITEM117_WK]
m_strName=ip-no
m_strRawPic=x(20)
m_strPic=x(20)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM117_WK

@}}
[FDITEM118_WK]
m_nType=10
m_strName=ara-bos
m_strRawPic=9
m_strPic=9
m_strDefaultValue=0
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM118_WK

@}}
[FDITEM119_WK]
m_nType=10
m_strName=ref-var
m_strRawPic=9
m_strPic=9
m_strDefaultValue=0
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM119_WK

@}}
[FDITEM120_WK]
m_nType=10
m_strName=mah-birles
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM120_WK

@}}
[FDITEM121_WK]
m_nType=10
m_strName=tahakkuksuz
m_strRawPic=9
m_strPic=9
m_strDefaultValue=0
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM121_WK

@}}
[FDITEM122_WK]
m_strName=zz
m_strRawPic=9z
m_strPic=9z
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM122_WK

@}}
[FDITEM123_WK]
m_strName=link-eski
m_strRawPic=9(6)
m_strPic=9(6)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM123_WK

@}}
[FDITEM124_WK]
m_strName=link-yeni
m_strRawPic=9(6)
m_strPic=9(6)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM124_WK

@}}
[FDITEM125_WK]
m_strName=d
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM125_WK

@}}
[FDITEM126_WK]
m_strName=kont-hat
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM126_WK

@}}
[FDITEM127_WK]
m_strName=alac-dep-aciklama2
m_strRawPic=x(20)
m_strPic=x(20)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM127_WK

@}}
[FDITEM128_WK]
m_strName=MAHSUP-ALINDI
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM128_WK

@}}
[FDITEM129_WK]
m_strName=son-fatura
m_strRawPic=x(50)
m_strPic=x(50)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM129_WK

@}}
[FDITEM130_WK]
m_strName=bulunan-cari
m_strRawPic=x(20)
m_strPic=x(20)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM130_WK

@}}
[FDITEM131_WK]
m_strName=ydk-ger-folio
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM131_WK

@}}
[FDITEM132_WK]
m_strName=salih
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM132_WK

@}}
[FDITEM133_WK]
m_strName=alsat-fatura-buldum
m_strRawPic=9
m_strPic=9
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM133_WK

@}}
[FDITEM134_WK]
m_strName=temp-muha-sirketi
m_strRawPic=x(8)
m_strPic=x(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM134_WK

@}}
[FDITEM135_WK]
m_strName=onb-isyeri-adres
m_strRawPic=x(8)
m_strPic=x(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM135_WK

@}}
[FDITEM136_WK]
m_strName=temp-dys-no
m_strRawPic=9(10)
m_strPic=9(10)
m_strDefaultValue=0
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM136_WK

@}}
[FDITEM137_WK]
m_strName=fs-takasdys
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM137_WK

@}}
[FDITEM138_WK]
m_strName=z8
m_strRawPic=z(8)
m_strPic=z(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM138_WK

@}}
[FDITEM139_WK]
m_strName=dokuz8
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM139_WK

@}}
[FDITEM140_WK]
m_strName=temp-link-dys-to-fis
m_strRawPic=9(10)
m_strPic=9(10)
m_strDefaultValue=0
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM140_WK

@}}
[FDITEM141_WK]
m_strName=i-m
m_strRawPic=99
m_strPic=99
m_strDefaultValue=0
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM141_WK

@}}
[FDITEM142_WK]
m_strName=tip-uzun
m_strRawPic=x(15)
m_strPic=x(15)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM142_WK

@}}
[FDITEM143_WK]
m_strName=linkler
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM143_WK

@}}
[FDITEM144_WK]
m_strName=filler
m_nItemLevel=3
m_nSync=-1
m_bOccurs=1
m_bFixed=1
m_strRawSize=13
m_nSize=13
{{@DataItem_m_strDescriptionFDITEM144_WK

@}}
[FDITEM145_WK]
m_strName=link-ba
m_strRawPic=x
m_strPic=X
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM145_WK

@}}
[FDITEM146_WK]
m_strName=link-aciklama
m_strRawPic=x(50)
m_strPic=X(50)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM146_WK

@}}
[FDITEM147_WK]
m_strName=link-tl
m_strRawPic=9(12)v99
m_strPic=9(12)V99
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM147_WK

@}}
[FDITEM148_WK]
m_strName=link-hesap
m_strRawPic=x(30)
m_strPic=X(30)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM148_WK

@}}
[FDITEM149_WK]
m_strName=devremulk-fat-var
m_strRawPic=9
m_strPic=9
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM149_WK

@}}
[FDITEM150_WK]
m_nType=10
m_strName=mis-no
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM150_WK

@}}
[FDITEM151_WK]
m_nType=10
m_strName=ps1
m_strRawPic=x(8)
m_strPic=x(8)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM151_WK

@}}
[FDITEM152_WK]
m_strName=link2-fol-no
m_strRawPic=9(08)
m_strPic=9(08)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM152_WK

@}}
[FDITEM153_WK]
m_strName=link2-rez
m_strRawPic=9(08)
m_strPic=9(08)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM153_WK

@}}
[FDITEM154_WK]
m_strName=link2-fat
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM154_WK

@}}
[FDITEM155_WK]
m_strName=link2-fat-ref
m_strRawPic=9
m_strPic=9
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM155_WK

@}}
[FDITEM156_WK]
m_strName=link2-fat-dv
m_strRawPic=9(9)v99
m_strPic=9(9)v99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM156_WK

@}}
[FDITEM157_WK]
m_strName=link2-fat-no
m_strRawPic=9(6)
m_strPic=9(6)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM157_WK

@}}
[FDITEM158_WK]
m_strName=link2-fat-tl
m_strRawPic=9(9)v99
m_strPic=9(9)v99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM158_WK

@}}
[FDITEM159_WK]
m_strName=fat-fol-bul-tarih
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM159_WK

@}}
[FDITEM160_WK]
m_strName=fat-fol-bul-fatura
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM160_WK

@}}
[FDITEM161_WK]
m_strName=fat-fol-bul-folio
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM161_WK

@}}
[FDITEM162_WK]
m_strName=fat-fol-bul-gece
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
m_strRawSize=9
m_nSize=9
{{@DataItem_m_strDescriptionFDITEM162_WK

@}}
[FDITEM163_WK]
m_strName=eski-konum-ref
m_strRawPic=9(3)
m_strPic=9(3)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM163_WK

@}}
[FDITEM164_WK]
m_strName=i
m_strRawPic=9(3)
m_strPic=9(3)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM164_WK

@}}
[FDITEM165_WK]
m_strName=fat-fol-bul-ref-dizi
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM165_WK

@}}
[FDITEM166_WK]
m_strName=fat-fol-bul-ref
m_strRawPic=999
m_strPic=999
m_nItemLevel=2
m_nSync=-1
m_bOccurs=1
m_bFixed=1
m_strRawSize=99
m_nSize=99
{{@DataItem_m_strDescriptionFDITEM166_WK

@}}
[FDITEM167_WK]
m_strName=fat-fol-bul-ref-gece-dizi
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM167_WK

@}}
[FDITEM168_WK]
m_strName=fat-fol-bul-ref-gece
m_strRawPic=999
m_strPic=999
m_nItemLevel=2
m_nSync=-1
m_bOccurs=1
m_bFixed=1
m_strRawSize=99
m_nSize=99
{{@DataItem_m_strDescriptionFDITEM168_WK

@}}
[FDITEM169_WK]
m_strName=fat-fol-bul-ref-var
m_strRawPic=9
m_strPic=9
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
m_strRawSize=9
m_nSize=9
{{@DataItem_m_strDescriptionFDITEM169_WK

@}}
[FDITEM170_WK]
m_strName=fat-fol-bul-ref-adet
m_strRawPic=9
m_strPic=9
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
m_strRawSize=9
m_nSize=9
{{@DataItem_m_strDescriptionFDITEM170_WK

@}}
[FDITEM171_WK]
m_strName=fat-gunluk-tutar
m_strRawPic=9(9)v99
m_strPic=9(9)v99
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM171_WK

@}}
[FDITEM172_WK]
m_strName=fat-top-tutar
m_strRawPic=s9(9)v99
m_strPic=s9(9)v99
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM172_WK

@}}
[FDITEM173_WK]
m_strName=fat-ref-top-tutar
m_strRawPic=s9(9)v99
m_strPic=s9(9)v99
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM173_WK

@}}
[FDITEM174_WK]
m_strName=fat-ref-tutar
m_strRawPic=9(9)v99
m_strPic=9(9)v99
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM174_WK

@}}
[FDITEM175_WK]
m_strName=matrahtopic
m_strRawPic=9(9)v99
m_strPic=9(9)v99
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM175_WK

@}}
[FDITEM176_WK]
m_strName=eskifatno
m_strRawPic=x(8)
m_strPic=x(8)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM176_WK

@}}
[FDITEM177_WK]
m_strName=mydk-fat-no
m_strRawPic=x(20)
m_strPic=x(20)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM177_WK

@}}
[FDITEM178_WK]
m_strName=eb-virman-bas-fis-no
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM178_WK

@}}
[FDITEM179_WK]
m_strName=hes-var
m_strRawPic=9
m_strPic=9
m_strDefaultValue=0
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM179_WK

@}}
[FDITEM180_WK]
m_strName=yedek-aciklama
m_strRawPic=x(100)
m_strPic=x(100)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM180_WK

@}}
[FDITEM181_WK]
m_strName=etut
m_strRawPic=zzzz,zzz.zz
m_strPic=zzzz,zzz.zz
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM181_WK

@}}
[FDITEM182_WK]
m_strName=yedek-acenta-adi
m_strRawPic=x(10)
m_strPic=x(10)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM182_WK

@}}
[FDITEM183_WK]
m_strName=yedek-dys-no
m_strRawPic=x(50)
m_strPic=x(50)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM183_WK

@}}


[LINKAGE_SECTION]
m_nType=1
m_strName=Linkage Section
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionLK

@}}


{{@SCREEN:
*   Screen Painter Data
*   Schema 6.0
*
BEGIN-SPDATA

GRAPHICAL-SCREEN

Begin Screen Form1
   PREFIX            = Form1
   LOCK-CONTROL      = FALSE
   (Name)            = Form1
   Absolute Column   = 0
   Absolute Line     = 0
   Action            = (None)
   Auto Minimize     = FALSE
   Auto Resize       = FALSE
   Bind To Thread    = FALSE
   Boxed             = FALSE
   Cell              = TRUE
   Cell Height       = 10
   Cell Measure      = Pixels
   Cell Width        = 10
   Color             = 65793
   Controls Uncropped = FALSE
   Erase Screen      = FALSE
   Font              = Small Font
   Font Variable     = Small-Font
   Handle Variable   = Form1-Handle
   Help ID           = 4001
   Label Offset      = 0
   Layout Manager    = None
   Lines             = 56.00
   Link To Thread    = TRUE
   Max Lines         = 0.00
   Max Size          = 0.00
   Measuring Control = Label
   Measuring Font    = Default Font
   Measuring Style   = [None]
   Min Lines         = 0.00
   Min Size          = 0.00
   Modeless          = FALSE
   No Close          = FALSE
   Resizable         = FALSE
   Scroll            = FALSE
   Size              = 98.00
   System Menu       = TRUE
   Title             = "ONBURO Faturalar Mahsubu ..."
   Title Bar         = TRUE
   Unit              = Cells
   User Gray         = TRUE
   User White        = TRUE
   Visible           = 1:TRUE
   Window Type       = Floating
   Wrap              = FALSE
   Event Procedure   = Form1-Event-Proc
   Exception Procedure = Form1-Exception-Proc
   Other(ex)         = Form1-Ex-Other
   Before Create     = Form1-Bef-Create
   After Initdata    = Form1-Aft-Initdata
   After Routine     = Form1-Aft-Routine
   Begin Status-Bar Form1-St-1
      LOCK-CONTROL      = TRUE
      (Name)            = Form1-St-1
      Font              = Default Font
      Grip              = TRUE
      Handle Variable   = Form1-St-1-Handle
      Tab Order         = 1
   End
   Begin Frame Form1-Fr-1
      SCREEN-COL        = 1.00
      SCREEN-LINE       = 1.00
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Fr-1
      3D Style          = Raised
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 1.00
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 1
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.00
      Lines             = 8.90
      Low Color         = 0
      Size              = 90.50
      Tab Order         = 2
      Thickness         = Default
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Frame Form1-Fr-2
         SCREEN-COL        = 1.50
         SCREEN-LINE       = 1.50
         LOCK-CONTROL      = FALSE
         (Name)            = Form1-Fr-2
         3D Style          = Lowered
         Alternate         = FALSE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 1.50
         Csize             = 0
         Destroy Type      = Automatic
         Font              = Default Font
         Full Height       = FALSE
         Help ID           = 0
         High Color        = 0
         ID                = 2
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 1.50
         Lines             = 7.50
         Low Color         = 0
         Size              = 89.00
         Tab Order         = 1
         Thickness         = Default
         Title Position    = 0:Unaligned
         Visible           = 1:TRUE
         Begin Label Form1-La-1
            SCREEN-COL        = 2.00
            SCREEN-LINE       = 3.40
            LOCK-CONTROL      = TRUE
            (Name)            = Form1-La-1
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 1.50
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 3
            Justification     = Right
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.90
            Lines             = 1.50
            No Key Letter     = FALSE
            Size              = 7.50
            Tab Order         = 1
            Title             = "Tarih :"
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Entry-Field acc-gun
            SCREEN-COL        = 10.50
            SCREEN-LINE       = 2.90
            LOCK-CONTROL      = TRUE
            (Name)            = acc-gun
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 10.00
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Enable Variable   = enable-1
            Font              = Default Font
            Help ID           = 0
            ID                = 4
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.40
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 2
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 2.50
            Style             = Singleline
            Tab Order         = 2
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = gun
            Visible           = 1:TRUE
         End
         Begin Entry-Field acc-ay
            SCREEN-COL        = 13.50
            SCREEN-LINE       = 2.90
            LOCK-CONTROL      = TRUE
            (Name)            = acc-ay
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 13.00
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Enable Variable   = enable-1
            Font              = Default Font
            Help ID           = 0
            ID                = 5
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.40
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 2
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 2.50
            Style             = Singleline
            Tab Order         = 3
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = ay
            Visible           = 1:TRUE
         End
         Begin Entry-Field acc-yil
            SCREEN-COL        = 16.50
            SCREEN-LINE       = 2.90
            LOCK-CONTROL      = TRUE
            (Name)            = acc-yil
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 16.00
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Enable Variable   = enable-1
            Font              = Default Font
            Help ID           = 0
            ID                = 6
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.40
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 4
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 4.00
            Style             = Singleline
            Tab Order         = 4
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = yil
            Visible           = 1:TRUE
            After Procedure   = acc-yil-Aft-Procedure
         End
         Begin Label Form1-La-1aa
            SCREEN-COL        = 2.10
            SCREEN-LINE       = 6.30
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-La-1aa
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 1.60
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 11
            Justification     = Right
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 5.80
            Lines             = 1.50
            No Key Letter     = FALSE
            Size              = 8.00
            Tab Order         = 5
            Title             = "Referans kodu :"
            Transparent       = TRUE
            Visible           = 1:TRUE
            Visible Variable  = vis-1
         End
         Begin Entry-Field acc-ref
            SCREEN-COL        = 10.50
            SCREEN-LINE       = 5.80
            LOCK-CONTROL      = FALSE
            (Name)            = acc-ref
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 10.00
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 0:FALSE
            Enable Variable   = ref-var
            Font              = Default Font
            Help ID           = 0
            ID                = 12
            Justification     = Right
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 5.30
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 3
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 3.50
            Style             = Singleline
            Tab Order         = 6
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = ref
            Visible           = 1:TRUE
            Visible Variable  = vis-1
            Exception Procedure = acc-ref-Exception-Proc
            Other(ex)         = acc-ref-Ex-Other
            Before Procedure  = acc-ref-Bef-Procedure
            After Procedure   = acc-ref-Aft-Procedure
         End
         Begin Combo-Box combo-dovizlimi
            SCREEN-COL        = 36.00
            SCREEN-LINE       = 2.80
            LOCK-CONTROL      = FALSE
            (Name)            = combo-dovizlimi
            Auto load         = 0
            Auto load ReadDirection = next
            Auto load StartDirection = >=
            Auto load StartValue = low-value
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 35.50
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Font              = Default Font
            Help ID           = 0
            ID                = 26
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.30
            Lines             = 11.10
            Mass Update       = 0:Fast-Update
            Max Text          = 0
            No Tab            = FALSE
            Notify DblClick   = FALSE
            Notify SelChange  = TRUE
            Size              = 14.00
            Style             = Drop List
            Tab Order         = 7
            Termination Value = 0
            Unsorted          = TRUE
            Value             = ( "D-Dovizli Mahsup Kes", "T-Dovizsiz Mahsup Kes" )
            Value Container   = Form1-Cm-1-Container
            Value Default     = D-Dovizli Mahsup Kes
            Value Picture     = X(21)
            Value Variable    = combo-dovizlimi-value
            Visible           = 1:TRUE
         End
         Begin Label lb-ref
            SCREEN-COL        = 14.90
            SCREEN-LINE       = 6.00
            LOCK-CONTROL      = FALSE
            (Name)            = lb-ref
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 5
            Column            = 14.40
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 13
            Justification     = Unaligned
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 5.50
            Lines             = 1.80
            No Key Letter     = FALSE
            Size              = 13.90
            Tab Order         = 8
            Title Variable    = referans-adi of referans
            Transparent       = TRUE
            Visible           = 1:TRUE
            Visible Variable  = vis-1
         End
         Begin Label Form1-La-1a
            SCREEN-COL        = 51.00
            SCREEN-LINE       = 3.40
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-La-1a
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 50.50
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 7
            Justification     = Right
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.90
            Lines             = 1.50
            No Key Letter     = FALSE
            Size              = 7.50
            Tab Order         = 9
            Title             = "Mahsup no :"
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Entry-Field acc-numara
            SCREEN-COL        = 59.50
            SCREEN-LINE       = 2.90
            LOCK-CONTROL      = FALSE
            (Name)            = acc-numara
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 59.00
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Enable Variable   = enable-1
            Font              = Default Font
            Help ID           = 0
            ID                = 8
            Justification     = Right
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.40
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 6
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 5.50
            Style             = Singleline
            Tab Order         = 10
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = numara
            Visible           = 1:TRUE
            After Procedure   = acc-numara-Aft-Procedure
         End
         Begin Push-Button Form1-Pb-2
            SCREEN-COL        = 30.40
            SCREEN-LINE       = 6.00
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Pb-2
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 29.90
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Enable Variable   = enable-1
            Exception Value   = 2002
            Flat              = FALSE
            Font              = Default Font
            Help ID           = 0
            ID                = 16
            Is Link           = FALSE
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 5.50
            Lines             = 2.20
            Multiline         = FALSE
            No Auto Default   = FALSE
            No Tab            = FALSE
            Self Act          = FALSE
            Size              = 35.60
            Style             = Other
            Tab Order         = 11
            Termination Value = 0
            Title             = "&Mahsup Hazirla"
            Transparent Color = -1
            Visible           = 1:TRUE
         End
         Begin Label Form1-La-3
            SCREEN-COL        = 26.20
            SCREEN-LINE       = 2.80
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-La-3
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 25.70
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 25
            Justification     = Unaligned
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.30
            Lines             = 1.50
            No Key Letter     = FALSE
            Size              = 8.90
            Tab Order         = 12
            Title             = "Dovizli Mahsup :"
            Transparent       = FALSE
            Visible           = 1:TRUE
         End
         Begin Check-Box Form1-Cb-1
            SCREEN-COL        = 68.00
            SCREEN-LINE       = 2.90
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 67.50
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Default Font
            Help ID           = 0
            ID                = 28
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 2.40
            Lines             = 1.40
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 14.30
            Tab Order         = 13
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Ara Hesaplari Bosaltma"
            Value             = 0:FALSE
            Value Variable    = ara-bos
            Visible           = 0:FALSE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1a
            SCREEN-COL        = 68.00
            SCREEN-LINE       = 4.60
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1a
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 67.50
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 0:FALSE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Default Font
            Help ID           = 0
            ID                = 29
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 4.10
            Lines             = 1.40
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 14.30
            Tab Order         = 14
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Mahsuplari Birlestir"
            Value             = 1:TRUE
            Value Variable    = mah-birles
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box Form1-Cb-1aa
            SCREEN-COL        = 68.10
            SCREEN-LINE       = 6.40
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Cb-1aa
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 67.60
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Default Font
            Help ID           = 0
            ID                = 30
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 5.90
            Lines             = 1.40
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 17.90
            Tab Order         = 15
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Tahakkuk Hesaplari kullanma"
            Value             = 0:FALSE
            Value Variable    = tahakkuksuz
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
      End
   End
   Begin Frame Form1-Fr-3
      SCREEN-COL        = 1.00
      SCREEN-LINE       = 49.50
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Fr-3
      3D Style          = Rimmed
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 1.00
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 9
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 49.50
      Lines             = 5.00
      Low Color         = 0
      Size              = 91.00
      Tab Order         = 3
      Thickness         = Default
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Push-Button Form1-Pb-1
         SCREEN-COL        = 22.80
         SCREEN-LINE       = 51.00
         LOCK-CONTROL      = TRUE
         (Name)            = Form1-Pb-1
         Bitmap Frame      = FALSE
         Bitmap Number     = 1
         Bitmap Square     = TRUE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 22.80
         Copy Resource     = TRUE
         Csize             = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Enable Variable   = enable-2
         Exception Value   = 2001
         Flat              = FALSE
         Font              = Default Font
         Help ID           = 0
         ID                = 10
         Is Link           = FALSE
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.50
         Lines             = 2.50
         Multiline         = FALSE
         No Auto Default   = FALSE
         No Tab            = FALSE
         Self Act          = FALSE
         Size              = 16.80
         Style             = Other
         Tab Order         = 1
         Termination Value = 0
         Title             = "&Muhasebelestir"
         Transparent Color = -1
         Visible           = 1:TRUE
      End
      Begin Push-Button Form1-Pb-1a
         SCREEN-COL        = 47.20
         SCREEN-LINE       = 51.00
         LOCK-CONTROL      = TRUE
         (Name)            = Form1-Pb-1a
         Bitmap Frame      = FALSE
         Bitmap Number     = 1
         Bitmap Square     = TRUE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 47.20
         Copy Resource     = TRUE
         Csize             = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Enable Variable   = enable-2
         Exception Value   = 2003
         Flat              = FALSE
         Font              = Default Font
         Help ID           = 0
         ID                = 24
         Is Link           = FALSE
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.50
         Lines             = 2.50
         Multiline         = FALSE
         No Auto Default   = FALSE
         No Tab            = FALSE
         Self Act          = FALSE
         Size              = 16.80
         Style             = Other
         Tab Order         = 2
         Termination Value = 0
         Title             = "&Vazgec"
         Transparent Color = -1
         Visible           = 1:TRUE
      End
      Begin Label lb-1
         SCREEN-COL        = 3.00
         SCREEN-LINE       = 51.50
         LOCK-CONTROL      = FALSE
         (Name)            = lb-1
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 3.00
         Csize             = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Font              = Default Font
         Help ID           = 0
         ID                = 27
         Justification     = Unaligned
         Label Offset      = 0
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 3.00
         Lines             = 2.00
         No Key Letter     = FALSE
         Size              = 14.50
         Tab Order         = 3
         Transparent       = TRUE
         Visible           = 1:TRUE
      End
   End
   Begin Frame Form1-Fr-4
      SCREEN-COL        = 1.00
      SCREEN-LINE       = 10.00
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Fr-4
      3D Style          = Raised
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 1.00
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 14
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 10.00
      Lines             = 34.60
      Low Color         = 0
      Size              = 97.00
      Tab Order         = 4
      Thickness         = Default
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Grid Form1-Gd-1
         SCREEN-COL        = 1.40
         SCREEN-LINE       = 11.50
         LOCK-CONTROL      = FALSE
         (Name)            = Form1-Gd-1
         Action            = (None)
         Adjustable Columns = TRUE
         Auto load         = 0
         Auto load ReadDirection = next
         Auto load StartDirection = >=
         Auto load StartValue = low-value
         Border            = 3D
         Centered Headings = TRUE
         Color             = 0
         Column            = 1.40
         Column Headings   = TRUE
         Columns' Setting  = ( X = 1, Name = Gd-1-Col-1 )
         Columns' Setting  = ( PIC = "X(15)", ALIGN = "U" )
         Columns' Setting  = ( DISP = 16, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 2, Name = Gd-1-Col-2 )
         Columns' Setting  = ( PIC = "X(40)", ALIGN = "U" )
         Columns' Setting  = ( DISP = 41, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 3, Name = Gd-1-Col-3 )
         Columns' Setting  = ( PIC = "X(40)", ALIGN = "U" )
         Columns' Setting  = ( DISP = 30, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 4, Name = Gd-1-Col-5 )
         Columns' Setting  = ( PIC = "X(20)", ALIGN = "R" )
         Columns' Setting  = ( DISP = 15, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 5, Name = Gd-1-Col-6 )
         Columns' Setting  = ( PIC = "X(20)", ALIGN = "R" )
         Columns' Setting  = ( DISP = 15, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 6, Name = Gd-1-Col-4 )
         Columns' Setting  = ( PIC = "X(07)", TYPE = "x", ALIGN = "U" )
         Columns' Setting  = ( DISP = 8, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 7, Name = Gd-1-Col-7 )
         Columns' Setting  = ( PIC = "X(20)", ALIGN = "R" )
         Columns' Setting  = ( DISP = 10, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 8, Name = Gd-1-Col-8 )
         Columns' Setting  = ( PIC = "X(5)", ALIGN = "L" )
         Columns' Setting  = ( DISP = 8, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 9, Name = Gd-1-Col-9 )
         Columns' Setting  = ( PIC = "X(08)", ALIGN = "U" )
         Columns' Setting  = ( DISP = 8, SEPA = 5, DIVI = 1 )
         Cursor Color      = 480
         Cursor Frame Width = 2
         Cursor X          = 0
         Cursor Y          = 0
         Destroy Type      = Automatic
         Divider Color     = 13
         Drag Color        = 1
         Enable            = 1:TRUE
         Enable Variable   = enable-2
         End Color         = 0
         Font              = Default Font
         Heading Color     = 144
         Heading Divider Color = 1
         Heading Font      = Default Font
         Help ID           = 0
         Hscroll           = FALSE
         ID                = 15
         Last Row          = 0
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.50
         Lines             = 33.10
         No Cell Drag      = FALSE
         No Tab            = FALSE
         Num Column Headings = 1
         Num Columns       = 9
         Num Rows          = 0
         Paged             = FALSE
         Record Data       = Form1-Gd-1-Record
         Row Dividers      = 1
         Row Headings      = FALSE
         Size              = 95.60
         Tab Order         = 1
         Tiled Headings    = TRUE
         Use Tab           = FALSE
         Virtual Width     = 0
         Visible           = 1:TRUE
         Vpadding          = 50
         Vscroll           = TRUE
         Event Procedure   = Form1-Gd-1-Event-Proc
      End
   End
   Begin Frame Form1-Fr-5
      SCREEN-COL        = 3.00
      SCREEN-LINE       = 45.00
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Fr-5
      3D Style          = Raised
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 3.00
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 17
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 45.00
      Lines             = 4.00
      Low Color         = 0
      Size              = 89.00
      Tab Order         = 5
      Thickness         = Default
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Label Form1-La-2
         SCREEN-COL        = 3.50
         SCREEN-LINE       = 46.50
         LOCK-CONTROL      = TRUE
         (Name)            = Form1-La-2
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 2
         Column            = 1.50
         Csize             = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Font              = Default Font
         Help ID           = 0
         ID                = 18
         Justification     = Unaligned
         Label Offset      = 0
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.50
         Lines             = 1.50
         No Key Letter     = FALSE
         Size              = 6.00
         Tab Order         = 1
         Title             = "Borc :"
         Transparent       = TRUE
         Visible           = 1:TRUE
      End
      Begin Entry-Field acc-borc
         SCREEN-COL        = 10.50
         SCREEN-LINE       = 46.20
         LOCK-CONTROL      = TRUE
         (Name)            = acc-borc
         Auto              = FALSE
         Auto Decimal      = 0
         Border            = 3D
         Case              = Mixed
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 481
         Column            = 8.50
         Csize             = 0
         Cursor            = 0
         Cursor Col        = 0
         Cursor Row        = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Font              = Default Font
         Help ID           = 0
         ID                = 19
         Justification     = Right
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.20
         Lines             = 2.00
         Max Lines         = 0
         Max Text          = 0
         Max Value         = 0
         Min Value         = 0
         No AutoSel        = FALSE
         No Tab            = FALSE
         Notify Change     = FALSE
         Numeric           = FALSE
         Read Only         = TRUE
         Required          = FALSE
         Secure            = FALSE
         Size              = 14.50
         Style             = Singleline
         Tab Order         = 2
         Use Return        = FALSE
         Use Tab           = FALSE
         Value Multiple    = FALSE
         Value Picture     = X(30)
         Value Variable    = Form1-Ef-1-Value
         Visible           = 1:TRUE
      End
      Begin Label Form1-La-2a
         SCREEN-COL        = 25.50
         SCREEN-LINE       = 46.70
         LOCK-CONTROL      = TRUE
         (Name)            = Form1-La-2a
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 2
         Column            = 23.50
         Csize             = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Font              = Default Font
         Help ID           = 0
         ID                = 20
         Justification     = Unaligned
         Label Offset      = 0
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.70
         Lines             = 1.50
         No Key Letter     = FALSE
         Size              = 6.00
         Tab Order         = 3
         Title             = "Alacak :"
         Transparent       = TRUE
         Visible           = 1:TRUE
      End
      Begin Entry-Field acc-alac
         SCREEN-COL        = 32.00
         SCREEN-LINE       = 46.20
         LOCK-CONTROL      = TRUE
         (Name)            = acc-alac
         Auto              = FALSE
         Auto Decimal      = 0
         Border            = 3D
         Case              = Mixed
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 481
         Column            = 30.00
         Csize             = 0
         Cursor            = 0
         Cursor Col        = 0
         Cursor Row        = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Font              = Default Font
         Help ID           = 0
         ID                = 21
         Justification     = Right
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.20
         Lines             = 2.00
         Max Lines         = 0
         Max Text          = 0
         Max Value         = 0
         Min Value         = 0
         No AutoSel        = FALSE
         No Tab            = FALSE
         Notify Change     = FALSE
         Numeric           = FALSE
         Read Only         = TRUE
         Required          = FALSE
         Secure            = FALSE
         Size              = 14.50
         Style             = Singleline
         Tab Order         = 4
         Use Return        = FALSE
         Use Tab           = FALSE
         Value Multiple    = FALSE
         Value Variable    = Form1-Ef-1-Value
         Visible           = 1:TRUE
      End
      Begin Label Form1-La-2aa
         SCREEN-COL        = 47.00
         SCREEN-LINE       = 46.50
         LOCK-CONTROL      = TRUE
         (Name)            = Form1-La-2aa
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 2
         Column            = 45.00
         Csize             = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Font              = Default Font
         Help ID           = 0
         ID                = 22
         Justification     = Unaligned
         Label Offset      = 0
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.50
         Lines             = 1.50
         No Key Letter     = FALSE
         Size              = 5.50
         Tab Order         = 5
         Title             = "Bakiye :"
         Transparent       = TRUE
         Visible           = 1:TRUE
      End
      Begin Entry-Field acc-bakiye
         SCREEN-COL        = 53.00
         SCREEN-LINE       = 46.20
         LOCK-CONTROL      = TRUE
         (Name)            = acc-bakiye
         Auto              = FALSE
         Auto Decimal      = 0
         Border            = 3D
         Case              = Mixed
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 481
         Column            = 51.00
         Csize             = 0
         Cursor            = 0
         Cursor Col        = 0
         Cursor Row        = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Font              = Default Font
         Help ID           = 0
         ID                = 23
         Justification     = Right
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.20
         Lines             = 2.00
         Max Lines         = 0
         Max Text          = 0
         Max Value         = 0
         Min Value         = 0
         No AutoSel        = FALSE
         No Tab            = FALSE
         Notify Change     = FALSE
         Numeric           = FALSE
         Read Only         = TRUE
         Required          = FALSE
         Secure            = FALSE
         Size              = 14.50
         Style             = Singleline
         Tab Order         = 6
         Use Return        = FALSE
         Use Tab           = FALSE
         Value Multiple    = FALSE
         Value Variable    = Form1-Ef-1-Value
         Visible           = 1:TRUE
      End
   End
End

END-SPDATA

@}}

{{@REPORT:
*   Report Writer Data
*   Schema 6.0
*
BEGIN-RWDATA-6.0A

END-RWDATA

@}}

{{@PARAGRAPH:
*
  dov-kont.
     initialize hesap-rec
                   move mahsup-hesap-kodu      to   hesap-kodu
                 read hesap no lock invalid continue
                 end-read
                   if not hesap-doviz-li
                     initialize    mahsup-banka-kodu 
                                   mahsup-doviz-kodu 
                                   mahsup-d-e        
                                  mahsup-doviz-kuru  
                                  mahsup-tutar-dv
                   end-if  .
*
 tek-fatura-ok.
      
        move  function numval(efat2onb-muhasebe-fatura-no2)  to link-yeni
        move  function numval(efat2onb-onburo-fatura-no2)    to link-eski

        call "/asya/ytl/obj/otel/fatotele.asy" 
                    using  link-eski link-yeni  
                         on exception 
                     perform callerr-proc
                     exit paragraph
                    not on exception 
                 cancel "/asya/ytl/obj/otel/fatotele.asy"
          end-call
       move "E" to efat2onb-onburo-fatura-durumu
      accept efat2onb-onburo-gtarih  from century-date
      accept efat2onb-onburo-gzaman from time
      move k-kodu-tasi to efat2onb-staf
      rewrite efat2onb-rec invalid continue end-rewrite
     .
*
 fatura-degistimi.
     initialize fatura-rec
     move function numval(efat2onb-onburo-fatura-no2)      to fatura-no
     move 0                    to fatura-sira
     read fatura no lock invalid
         set efat2onb-onburo-fatura-degistirildi to true
         not invalid
     evaluate fatura-durumu
         when "D" 
           set efat2onb-onburo-fatura-degistirilmedi to true
                
       when other
           set efat2onb-onburo-fatura-degistirildi to true
     end-evaluate
     end-read  .

*
 tek-fatura-kaydir.
     initialize fatura-rec
     move function numval(efat2onb-muhasebe-fatura-no2)      to fatura-no
     move 0                    to fatura-sira
     read fatura no lock invalid
        perform tek-fatura-ok       
     not invalid
     evaluate fatura-durumu
         when "D"
           display message box 
                        efat2onb-onburo-fatura-no   " nolu faturayi"  new-line,
                        efat2onb-muhasebe-fatura-no   " nolu fatura olarak onayladiniz. " new-line,
                        " Ancak Bu seri Dolu"  new-line,
                        efat2onb-muhasebe-fatura-no," seri numarali fatura daha once kesilmis !",
                        new-line,
                        new-line,
                        "Kesilmis fatura Bilgileri"
                        new-line,
                        "Fatura Tarihi :",x"09",fatura-gun,"/"fatura-ay,"/",fatura-yil
                        new-line,
                        "Folio :",x"0909",fatura-folio,
                        new-line,
                        fatura-baslik-1, new-line,
                        fatura-baslik-2, new-line,
                        "Adres 1 :", x"09",fatura-adres-1,  new-line,
                        "Adres 2 :", x"09",fatura-adres-2,  new-line,
                        "Il :",      x"09",fatura-il,       new-line,
                        "Ilce :",    x"09",fatura-ilce,     new-line,
                        "Ulke :",    x"09",fatura-ulke,     new-line,
                        "Vergi D.:", x"09",fatura-ver-da,   new-line,
                        "Vergi N. :",x"09",fatura-ver-no    new-line new-line
                
       when other
           perform tek-fatura-ok
     end-evaluate
     end-read  .


*
 efatura-degistir.
        open i-o efat2onb fatura
        initialize efat2onb-rec
        set efat2onb-tipi-onburo to true
        move    ref      to  efat2onb-referans 
        move tarih to  efat2onb-fatura-tarihi
        start efat2onb key >= efat2onb-onb-key invalid continue
            not invalid
            perform until fs-efat2onb = "10"
             read efat2onb next no lock end move "10" to fs-efat2onb
                not end
                   if   efat2onb-tipi-onburo and efat2onb-referans = ref and 
                        efat2onb-fatura-tarihi = tarih
                        perform fatura-degistimi
                        if not   efat2onb-onburo-fatura-degistirildi
                               perform tek-fatura-kaydir
                          end-if
                      else
                      move "10" to fs-efat2onb
                   end-if
            end-read
           end-perform
        end-start
        close efat2onb  fatura    
       .
 acc-yil-Aft-Procedure.
     initialize gec-gecme.
     open input takvim.
     move tarih   to takvim-anah
     read takvim no lock invalid
          move 1 to gec-gecme
     end-read
     close takvim.

     if girilemez-tarih <> zeroes 
        if tarih < girilemez-tarih
         if k-kodu-tasi not = "ASYA" and "X   "
           move 1 to gec-gecme
           display message box
                   girilemez-gun,"/",girilemez-ay,"/",girilemez-yil,
                   " tarihinden onceye mahsup fisi kesilemez ....",
                   icon mb_error_icon
                   title "Hata"
         end-if
        end-if
     end-if.
*
 acc-numara-Aft-Procedure.
       if mahsup-alindi not = 1 then 
       open input islenen
        perform mahsup-no-al
         close islenen
       end-if
        display acc-numara
      
         
       .



*
 mahsup-no-al.
       initialize gec-gecme.
       open i-o genelfis 
        move 1 to genelfis-anahtar
        read genelfis no lock invalid
             display message box
                     "mgenel parametre'de genelfis fis tanimlamalari eksik !!!",new-line,
                     "Lutfen tanimlayiniz ..."
                     icon mb_error_icon
                     title "Hata"
                     move 1 to gec-gecme
                     destroy form1-handle
                     close genelfis
                     goback
        end-read
      
        if mgenel-referans = "E" and genel2-muh-refsiz-onb-refli not = 1
           open i-o referans
             move ref   to referans-kodu
             move "A"   to referans-tipi
             read referans no lock invalid           
                  continue
             end-read
             add 1 to referans-fisno-ekle
             move referans-fisno-ekle   to numara
           
             rewrite referans-rec end-rewrite

             if eb-virman-bas-fis-no not > 0
                  move numara to eb-virman-bas-fis-no
             end-if

           close referans

        else
           add 1 to mahsup-oto 
           move mahsup-oto to numara
           rewrite genelfis-rec end-rewrite
        end-if
        close genelfis
       


     .
     move numara to no-kont
     perform 1 times

     move no-kont to islenen-fis-no
     read islenen no lock invalid
          continue
     not invalid
          move 1 to gec-gecme
          display message box 
                  islenen-fis-no," numarali fis ",islenen-gun,"/",
                  islenen-ay,"/",islenen-yil," tarih kayitli",new-line,
                  "Lutfen kontrol ediniz",
                  icon mb_error_icon
                  title "Hata"
     end-read
   
     end-perform
    
     if gec-gecme not = 1 
      MOVE 1 TO MAHSUP-ALINDI
     end-if.
     
     .
*
 acc-ref-Aft-Procedure.
     initialize gec-gecme.
     if mgenel-referans = "E"
        continue else 
             exit paragraph.
     

     open input referans.
     move ref   to referans-kodu
     move "A"   to referans-tipi
     read referans no lock invalid
         initialize referans-ip
          perform acuserve-adres-aktar

          move 1 to gec-gecme
          move "Tanimsiz ..." to referans-adi
     not invalid
          
             perform acuserve-adres-aktar
         
     end-read
           open input kodlar02
           initialize kodlar02-rec
           move "r"   to kodlar02-tipi
           move ref   to zz
           move zz    to kodlar02-kodu
           read kodlar02 no lock invalid 
               continue 
           not invalid
               if kodlar02-ref not = ref or genel2-muh-refsiz-onb-refli = 1
                     move kodlar02-adi to referans-adi
               end-if 
           end-read 
           close kodlar02
     close referans.
     display lb-ref.
     if referans-fisno-ekle not numeric
        move 0 to referans-fisno-ekle
     end-if.
     if nereden <> "E"
        move 0 to numara
        display acc-numara.     
     .

*
 Form1-Bef-Create.
     perform adresleri-tasi.
     move tarih-tasi     to tarih.
        open input genel
    move 1 to genel-anahtar
    read genel no lock
      invalid
        move 3 to mesaj-no
        perform mesaj-ver
        set exit-pushed to true
      not invalid
        continue
        move muha-sirketi to temp-muha-sirketi
    end-read
    close genel

    open i-o genel2
    move 1 to genel2-anah
    read genel2 no lock invalid
        continue
    end-read
    close genel2

     move muha-sirketi of genel-rec to muhasebe-entegre-sirketi
    move genel-muha-ref to ref
     if ONKPARA-REFERANS-VAR = 1  and genel-muha-ref not > 0  then 
       move 1 to ref-var
       else
       move 0 to ref-var
    end-if


     if genel2-onb-refsiz = 1
         move 0 to ref-var  
         move 0 to genel-mah-mat-ref-dagit
         move 0 to onkpara-referans-var
     end-if

     initialize referans-ip
        perform acuserve-adres-aktar.
     
     open input mgenel.
     move 1 to mgenel-anahtar.
     read mgenel no lock invalid
          display message box 
                  "mgenel parametre tanimsiz ..."
                  icon mb_error_icon
                  title "Hata"
                  close mgenel
                  destroy form1-handle
                  goback
     end-read.
     close mgenel.
     initialize referans-ip
    
      
    if genel2-muh-refsiz-onb-refli = 1
          |move 1 to ONKPARA-REFERANS-VAR || ref
          |move 1 to ref-var ref genel-muha-ref
          move "E" to mgenel-referans
    end-if
     

     if mgenel-referans = "E" 
        move 1 to vis-1
     else
        move 0 to vis-1
     end-if.
     move 1 to enable-1
     move 0 to enable-2.
     open i-o efat2onb close efat2onb
     open i-o odalar2.
     .
*
 Form1-Ex-Other.
    
     if key-status = 2001 or 
        key-status = 2002 or
        key-status = 2003 
        
                open i-o takvim
                move tarih to takvim-anah
                read takvim no lock 
                        invalid 
                           display message box "Takvim tanimli degil" 
                        not invalid
                        if takvim-onbmah2 not = 1 
                              move 1 to sonuc
                           else
                               
                               display message box "Mukerrer Mahsup yapmak uzeresiniz Devam edilsin mi? " title "Mukerrer  Kayit" type 2 giving sonuc
                        end-if
                end-read      
              
                close takvim
                if sonuc = 2 then 
                  exit paragraph
                end-if        
        else 
             exit paragraph
        end-if
           move tarih  to muhasebe-tar
        perform muhasebe-entegre-kontrol
        if  muh-isl-durdur = 1 
          exit paragraph
        end-if
       if key-status = 2002 and 2 = 1 ||/// 16.11.2015 salih.y kaldiridii
           call "/asya/ytl/obj/otel/acfkont.asy" 
                    using  tarih 
                         on exception 
                     perform callerr-proc
                     exit paragraph
                    not on exception 
                 cancel "/asya/ytl/obj/otel/acfkont.asy"
          end-call
      end-if
       
     if key-status = 2001
        perform yaz-boggam
        perform mahsup-dys-yaz
        exit paragraph.

     if key-status = 2003
        move 1 to enable-1 
        move 0 to enable-2
        modify form1-gd-1,reset-grid =1 
        display form1
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
        perform dil-ayarla-proc
*/-----------------------------\*         
        move 4 to accept-control
        move 4 to control-id
        close borc-dep alac-dep kasa-borc-dep kasa-alac-dep takas-acenta takaskar
        delete file borc-dep alac-dep  kasa-borc-dep kasa-alac-dep takas-acenta  takaskar

        exit paragraph.

*       display message box  "geldi".
     perform Acc-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 4 to control-id
        exit paragraph.

     perform Acc-Numara-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 8 to control-id
        exit paragraph.

     move "E" to nereden.
     perform Acc-Ref-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 12 to control-id
        exit paragraph.


     
     open i-o genelfis.
     move 1 to genelfis-anahtar.
     read genelfis no lock invalid move 1 to ekran-fis-1.
      
     add 1 to ekran-fis-1.
     move ekran-fis-1 to borc-dep-no borc-fat-no.
      
     add 1 to ekran-fis-1.
     move ekran-fis-1 to kasa-borc-dep-no.
      
     add 1 to ekran-fis-1.
     move ekran-fis-1 to kasa-alac-dep-no.
     add 1 to ekran-fis-1.
      
     add 1 to ekran-fis-1.
     move ekran-fis-1 to alac-dep-no.
      
     add 1 to ekran-fis-1.
     move ekran-fis-1 to takas-acenta-no takaskar-no.

     rewrite genelfis-rec invalid write genelfis-rec end-write end-rewrite.
     close genelfis.
     
     open output borc-dep   close borc-dep
     open output borc-fat close borc-fat. 
     open i-o borc-dep  with mass-update. 
     open i-o borc-fat  with mass-update.

     open output alac-dep close alac-dep open i-o alac-dep with mass-update.
     open output kasa-borc-dep close kasa-borc-dep open i-o kasa-borc-dep with mass-update.
     open output kasa-alac-dep close kasa-alac-dep open i-o kasa-alac-dep with mass-update.
     open output takas-acenta close takas-acenta open i-o takas-acenta with mass-update.
     open output takaskar close takaskar open i-o takaskar with mass-update.

     initialize kasa-borc-dep-rec kasa-alac-dep-rec borc-dep-rec alac-dep-rec takas-acenta-rec borc alac.

       

****|HAKAN|*** PROGRAMDAK ARIZA YZNDEN BEN URATIRAN
**** DER PROGRAMCI ARKADALARA SESLENYORUZ
*****
*      perform efatura-degistir
    perform fatdetay-oku
***2*********************************************************||/// 16.11.2015 salih.y kaldiridii
****    2. tur
*     close    borc-dep   
*      borc-fat alac-dep       
*      kasa-borc-dep 
*      kasa-alac-dep 
*      takas-acenta   
*      takaskar   .    
*     if key-status = 2002 
*           call "/asya/ytl/obj/otel/acfkont.asy" 
*                    using  tarih 
*                         on exception 
*                     perform callerr-proc
*                     exit paragraph
*                    not on exception 
*                 cancel "/asya/ytl/obj/otel/acfkont.asy"
*          end-call
*      end-if
*
*       open output borc-dep   close borc-dep
*     open output borc-fat close borc-fat. 
*     open i-o borc-dep  with mass-update. 
*     open i-o borc-fat  with mass-update.
*
*     open output alac-dep close alac-dep open i-o alac-dep with mass-update.
*     open output kasa-borc-dep close kasa-borc-dep open i-o kasa-borc-dep with mass-update.
*     open output kasa-alac-dep close kasa-alac-dep open i-o kasa-alac-dep with mass-update.
*     open output takas-acenta close takas-acenta open i-o takas-acenta with mass-update.
*     open output takaskar close takaskar open i-o takaskar with mass-update.
*
*     initialize kasa-borc-dep-rec kasa-alac-dep-rec borc-dep-rec alac-dep-rec takas-acenta-rec borc alac.
*      
*
*        perform fatdetay-oku
*
*
*
*
******************************************************       
     move 0 to enable-1
     move 1 to enable-2
     display form1.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*  
        open input doviz 
     modify form1-gd-1,reset-grid =1,mass-update = 1.
     move "Hesap kodu"       to gd-1-col-1
     move "Hesap adi"        to gd-1-col-2
     move "Aciklama"         to gd-1-col-3
     MOVE "Ref"              to gd-1-col-4
     move "Borc Tutar"       to gd-1-col-5
     move "Alacak Tutar"     to gd-1-col-6
     move "Doviz tutar"      to gd-1-col-7
     move "Doviz"            to gd-1-col-8
     move "Fat no "          to gd-1-col-9
     modify form1-gd-1,record-to-add(form1-gd-1-record).

     open input hesap.
     initialize borc-dep-rec alac-dep-rec kasa-borc-dep-rec kasa-alac-dep-rec borc alac
     start borc-dep key not < borc-dep-anah2 invalid continue
     not invalid
     initialize fs-borc-dep
     perform with test after until fs-borc-dep = "10"
     read borc-dep next no lock end move "10" to fs-borc-dep
     not at end
          if tahakkuksuz = 1 then 
              if function numval(borc-dep-fatura-no) > 0 then 
                continue
                else
                 
                 delete borc-dep invalid stop " "  end-delete
                 exit perform cycle
              end-if
          end-if
          initialize form1-gd-1-record
          move borc-dep-hesap           to gd-1-col-1 hesap-kodu
          read hesap no lock invalid
                 add 1 to tanimsiz-sayi
                 move "Tanimsiz ..."   to hesap-adi
          end-read
          move hesap-adi             to gd-1-col-2
          move borc-dep-aciklama     to gd-1-col-3
          move borc-dep-ref          to gd-1-col-4 
          move borc-dep-fatura-no    to   gd-1-col-9 
          if onkpara-referans-var = 1 then 
                            evaluate onkpara-referans-nerden
                            when 1 
                              move ref-adi(borc-dep-ref)          to gd-1-col-4
                            when 2
                               move ref-adi(borc-dep-ref)          to gd-1-col-4
                            end-evaluate 
            end-if
          
          move borc-dep-tutar        to etutar
          if borc-dep-ba = "B"
             move etutar             to gd-1-col-5
          else
             move etutar             to gd-1-col-6
          end-if
          modify form1-gd-1,record-to-add(form1-gd-1-record)
          if borc-dep-ba = "B"
             add borc-dep-tutar to borc
          else
             add borc-dep-tutar to alac
          end-if
     end-read
     end-perform
     end-start
     initialize borc-dep-rec alac-dep-rec 
     
     start alac-dep key not < alac-dep-anah2 invalid continue
     not invalid
     initialize fs-alac-dep
     perform with test after until fs-alac-dep = "10"
     read alac-dep next no lock end move "10" to fs-alac-dep
     not at end                       
          initialize form1-gd-1-record
           if tahakkuksuz = 1 then 
              if function numval(alac-dep-fatura-no) > 0 or function numval(alac-dep-fatura-no-sanal) > 0 then 
                continue
                else
                 delete alac-dep invalid stop " " end-delete
                   exit perform cycle
              end-if
          end-if  
          
          move alac-dep-hesap           to gd-1-col-1 hesap-kodu
          read hesap no lock invalid
               add 1 to tanimsiz-sayi
               move "Tanimsiz ..."   to hesap-adi
          end-read
          move hesap-adi             to gd-1-col-2
          move alac-dep-aciklama     to gd-1-col-3
          
            move alac-dep-ref          to gd-1-col-4
            
            if onkpara-referans-var = 1 then 
                            evaluate onkpara-referans-nerden
                            when 1 
                              move ref-adi(alac-dep-ref)          to gd-1-col-4
                            when 2
                                move ref-adi(alac-dep-ref)          to gd-1-col-4
                            end-evaluate 
            end-if
          move alac-dep-tutar-tl     to etutar
        
          if alac-dep-ba = "B"
             move etutar             to gd-1-col-5
          else
             move etutar             to gd-1-col-6
          end-if
             move  alac-dep-tutar-dv     to etutar
             move etutar             to gd-1-col-7
               initialize doviz-rec
             move alac-dep-doviz    to doviz-kodu
             read doviz no lock invalid continue
             end-read
             move d-kisa-adi to gd-1-col-8
                move alac-dep-fatura-no    to   gd-1-col-9 
          modify form1-gd-1,record-to-add(form1-gd-1-record)
          if alac-dep-ba = "B"
             add alac-dep-tutar-tl to borc
          else
             add alac-dep-tutar-tl to alac
          end-if
                 
     end-read
     end-perform
     end-start
********************* KASALAR **********************************
     start kasa-borc-dep key not < kasa-borc-dep-anah2 invalid continue
     not invalid
     initialize fs-kasa-borc-dep
     perform with test after until fs-kasa-borc-dep = "10"
     read kasa-borc-dep next no lock end move "10" to fs-kasa-borc-dep
     not at end
           if tahakkuksuz = 1 then 
              if function numval(kasa-borc-dep-fatura-no) > 0 then 
                continue
                else
                 delete kasa-borc-dep invalid stop " " end-delete
                   exit perform cycle
              end-if
          end-if
          initialize form1-gd-1-record
          move kasa-borc-dep-hesap           to gd-1-col-1 hesap-kodu
          read hesap no lock invalid
               add 1 to tanimsiz-sayi
               move "Tanimsiz ..."   to hesap-adi
          end-read
          move hesap-adi             to gd-1-col-2
          move kasa-borc-dep-aciklama     to gd-1-col-3
          move kasa-borc-dep-tutar        to etutar
          move kasa-borc-dep-ref          to gd-1-col-4
           if onkpara-referans-var = 1 then 
                            evaluate onkpara-referans-nerden
                            when 1 
                              move ref-adi(kasa-borc-dep-ref)          to gd-1-col-4
                            when 2
                               move ref-adi(kasa-borc-dep-ref)          to gd-1-col-4
                            end-evaluate 
            end-if
          if kasa-borc-dep-ba = "B"
             move etutar             to gd-1-col-5
          else
             move etutar             to gd-1-col-6
          end-if
             move kasa-borc-dep-fatura-no    to   gd-1-col-9 
          modify form1-gd-1,record-to-add(form1-gd-1-record)
          if kasa-borc-dep-ba = "B"
             add kasa-borc-dep-tutar to borc
          else
             add kasa-borc-dep-tutar to alac
          end-if
     end-read
     end-perform
     end-start
            

     initialize kasa-borc-dep-rec kasa-alac-dep-rec 
     start kasa-alac-dep key not < kasa-alac-dep-anah2 invalid continue
     not invalid
     initialize fs-kasa-alac-dep
     perform with test after until fs-kasa-alac-dep = "10"
     read kasa-alac-dep next no lock end move "10" to fs-kasa-alac-dep
     not at end
           if tahakkuksuz = 1 then 
              if function numval(kasa-alac-dep-fatura-no) > 0 then 
                continue
                else
                 delete kasa-alac-dep invalid stop " " end-delete
                   exit perform cycle
              end-if
          end-if
          initialize form1-gd-1-record
          move kasa-alac-dep-hesap           to gd-1-col-1 hesap-kodu
          read hesap no lock invalid
               add 1 to tanimsiz-sayi
               move "Tanimsiz ..."   to hesap-adi
          end-read
          move hesap-adi             to gd-1-col-2
          move kasa-alac-dep-aciklama     to gd-1-col-3
          move kasa-alac-dep-tutar     to etutar
            move kasa-alac-dep-ref          to gd-1-col-4
             if onkpara-referans-var = 1 then 
                            evaluate onkpara-referans-nerden
                            when 1 
                              move ref-adi(kasa-alac-dep-ref)          to gd-1-col-4
                            when 2
                               move ref-adi(kasa-alac-dep-ref)          to gd-1-col-4
                            end-evaluate 
            end-if
          if kasa-alac-dep-ba = "B"
             move etutar             to gd-1-col-5
          else
             move etutar             to gd-1-col-6
          end-if
             move kasa-alac-dep-fatura-no    to   gd-1-col-9 
          modify form1-gd-1,record-to-add(form1-gd-1-record)
          if kasa-alac-dep-ba = "B"
             add kasa-alac-dep-tutar to borc
          else
             add kasa-alac-dep-tutar to alac
          end-if
     end-read
     end-perform
     end-start
     
     close hesap.
      close borc-fat delete file borc-fat
     modify form1-gd-1,
            mass-update = 0.

     compute bakiye = borc - alac
     move borc   to etutar
     modify acc-borc, value = etutar
     move alac   to etutar
     modify acc-alac, value = etutar
     move bakiye to etutar
     modify acc-bakiye, value = etutar
     if borc <> alac 
        display message box 
                "Borc/Alacak toplami esit degil", new-line 
                "Mahsuplastirirsaniz mutlaka duzeltin"
                icon mb_error_icon
                title "Hata"
                
    end-if.  
    close doviz
    initialize mahsup-alindi.

 yaz-boggam.
     close takas-acenta.
     delete file takas-acenta.
     if combo-dovizlimi-value(1:1)  = "D"
        perform kur-bul thru kur-bul-exit
     end-if
         
     if GENEL-devremulk = 1  
         perform devremulk-mahsup
         open input islenen
            perform mahsup-no-al 
         close islenen
     end-if

     if borc = 0 and alac = 0
        if devremulk-fat-var = 0
           display message box
                "Muhasebelestirilecek kayit bulunamadi ..."
                icon mb_error_icon
                title "Hata"
        end-if
                move 1 to enable-1 
                move 0 to enable-2
                display form1
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
                perform dil-ayarla-proc
*/-----------------------------\*         
                move 4 to accept-control
                move 4 to control-id
                close  borc-dep alac-dep   kasa-borc-dep kasa-alac-dep    takaskar
                delete file borc-dep alac-dep kasa-borc-dep kasa-alac-dep  takaskar
                exit paragraph
      end-if.
*******>Borc Departmanlari Muhasebelesiyor.........

 
     open i-o mahsup  hesap kodlar02 
     open i-o efat2onb.
     if mah-birles = 1 then 
       open output mahsupm
       close mahsupm
       open i-o mahsupm
     end-if
     initialize borc-dep-rec alac-dep-rec fis-sira-sakla
     start borc-dep key not < borc-dep-anah2 invalid
      continue
      not invalid
     initialize fs-borc-dep
     perform with test after until fs-borc-dep = "10"
     read borc-dep next no lock end move "10" to fs-borc-dep
     not at end
      if " " not = borc-dep-corr
         move "10" to fs-borc-dep
         exit perform
       end-if
       if borc-dep-tutar  = 0 
          exit perform cycle 
       end-if
         initialize mahsup-rec 
         move tarih               to mahsup-tarih
         move numara              to mahsup-fis-no
         add  1                   to fis-sira-sakla
         move fis-sira-sakla      to mahsup-fis-sira
         move borc-dep-hesap      to mahsup-hesap-kodu
         move "A"                 to mahsup-tipi
         move borc-dep-ba         to mahsup-b-a 
         move borc-dep-tutar      to mahsup-tutar
         
         move borc-dep-aciklama   to mahsup-aciklama 
         move ref                 to mahsup-referans
         if ref-var = 1 then 
            evaluate onkpara-referans-nerden
            when 1  
            when 2
            initialize kodlar02-rec
            move "r"           to kodlar02-tipi
            move borc-dep-ref to zz
            move zz           to kodlar02-kodu
            read kodlar02 no lock invalid 
                continue 
            not invalid 
                move kodlar02-ref to borc-dep-ref
            end-read              
            move borc-dep-ref to mahsup-referans
            when 2
               continue 
            end-evaluate 
         end-if
         move k-kodu-tasi         to mahsup-staf
         move borc-dep-hesap           to  hesap-kodu
         read hesap no lock invalid
                 continue
         end-read
         
         move HESAP-KDV-ORAN to mahsup-kdv-oran

    
****************************mesut abi iin folioya gonder bul
      if  borc-dep-folio > 0 and borc-dep-doviz-bulma = 0 then 
     
      
     move borc-dep-folio   to link2-fol-no     
     move 0             to link2-rez  link2-fat-tl      
     initialize link2-fat
     move borc-dep-pencere  to link2-fat-ref               
     move function numval(borc-dep-fatura-no) to  link2-fat-no
     call "/asya/ytl/obj/otel/folio.asy" using link2-fol-no link2-rez  link2-fat, link2-fat-no, link2-fat-tl
                  on exception perform callerr-proc
                  not on exception
                  cancel "/asya/ytl/obj/otel/folio.asy" 
             end-call
*        move link2-fat-dv     to e-14 
*        move e-14             to dov-tut
*        display acc-dov-tut


           if link2-fat-tl = borc-dep-tutar and link2-fat-tl not =  link2-fat-dv and link2-fat-dv > 0
              move  link2-fat-dv to  mahsup-tutar-dv
               move mgenel-d-e    to mahsup-d-e 
               compute  mahsup-doviz-kuru rounded = link2-fat-tl /  link2-fat-dv
               move borc-dep-banka-kodu to mahsup-banka-kodu
               move borc-dep-doviz-kodu  to mahsup-doviz-kodu
           end-if

      end-if
********************************                
         if combo-dovizlimi-value(1:1)  = "D" and mahsup-tutar-dv not > 0 and 
            islem-kuru not = 0
            if mahsup-tutar <> zeroes
               move mgenel-banka  to mahsup-banka-kodu
               move mgenel-doviz  to mahsup-doviz-kodu
               move mgenel-d-e    to mahsup-d-e       
               move islem-kuru   to mahsup-doviz-kuru
               compute mahsup-tutar-dv rounded = 
                        mahsup-tutar / islem-kuru
            end-if
         end-if
          perform dov-kont
         move "O"                 to mahsup-nereden
          move borc-dep-fatura-no    to mahsup-BELGE-NO 
          move function numval(mahsup-BELGE-NO) to e-o-fatura
          move ref to e-ref 
          perform efatura-gercek-bul
          if e-m-fatura > spaces then 
              move e-m-fatura to mahsup-BELGE-NO
          end-if
         
          initialize fat-fol-bul-ref-var  fat-fol-bul-ref-adet fat-fol-bul-ref-dizi fat-fol-bul-ref-gece-dizi
          |salihx 25.01.2019
          if borc-dep-hesap(1:3) = "600" and 
             borc-dep-fatura-no <> spaces and 
             ONKPARA-REFERANS-VAR = 1 and
             genel-mah-mat-ref-dagit = 1 
                  move tarih              to fat-fol-bul-tarih
                  move borc-dep-fatura-no to fat-fol-bul-fatura
      
                  perform fatdetay-fat-fol-bul

                  if fat-fol-bul-ref-var = 1 and fat-fol-bul-ref-gece(99) > 0 
                      initialize fat-ref-top-tutar
                      move borc-dep-tutar to fat-top-tutar
                      compute fat-gunluk-tutar rounded = borc-dep-tutar / fat-fol-bul-ref-gece(99)
                      perform varying i from 1 by 1 until i > fat-fol-bul-ref-adet
                            compute borc-dep-tutar = fat-gunluk-tutar * fat-fol-bul-ref-gece(i)
                            add borc-dep-tutar to fat-ref-top-tutar

                            if fat-fol-bul-ref-adet = i
                                   compute borc-dep-tutar = 
                                   borc-dep-tutar +
                                   (fat-top-tutar - fat-ref-top-tutar) 
                            end-if

                            move borc-dep-tutar      to mahsup-tutar
                            move fat-fol-bul-ref(i) to mahsup-referans
                            if genel2-mahsup-matrah-kdv-degistirilsin = 1 move low-values TO MAHSUP-OZEL-ACIKLAMA END-IF
                            if mah-birles = 1 then 
                                move mahsup-rec to mahsupm-rec
                                move borc-dep-kredi to mahsupm-filler
                                write mahsupm-rec invalid stop " " end-write
                            else  
                                write mahsup-rec invalid stop " " end-write 
                            end-if
                    
                            if fat-fol-bul-ref-adet > i
                                    add  1                   to fis-sira-sakla
                                    move fis-sira-sakla      to mahsup-fis-sira
                            end-if
                       end-perform
                  else
                      if fat-fol-bul-ref-var = 0
                         move fat-fol-bul-ref(1)   to  mahsup-referans
                         if mahsup-referans = 0 
                           move borc-dep-ref to mahsup-referans
                         end-if 
                      end-if
                          if genel2-mahsup-matrah-kdv-degistirilsin = 1 move low-values TO MAHSUP-OZEL-ACIKLAMA END-IF
                          if mah-birles = 1 then 
                             move mahsup-rec to mahsupm-rec
                             move borc-dep-kredi to mahsupm-filler
                             write mahsupm-rec invalid stop " " end-write
                          else  
                             write mahsup-rec invalid stop " " end-write 
                          end-if  
                  end-if
          else
                  if genel2-mahsup-matrah-kdv-degistirilsin = 1 move low-values TO MAHSUP-OZEL-ACIKLAMA END-IF
                  if mah-birles = 1 then 
                     move mahsup-rec to mahsupm-rec
                     move borc-dep-kredi to mahsupm-filler
                     write mahsupm-rec invalid stop " " end-write
                  else  
                     write mahsup-rec invalid stop " " end-write 
                  end-if 
          end-if

     end-read
     end-perform
     end-start
     

************************************ kredi kartlari 108ler
     initialize borc-dep-rec alac-dep-rec 
     move "1" to borc-dep-corr

     start borc-dep key not < borc-dep-anah2 invalid
      continue
      not invalid
     initialize fs-borc-dep
     perform with test after until fs-borc-dep = "10"
     read borc-dep next no lock end move "10" to fs-borc-dep
     not at end
       if "1" not = borc-dep-corr
         move "10" to fs-borc-dep
         exit perform
       end-if
        if borc-dep-tutar  = 0 exit perform cycle end-if
         initialize mahsup-rec 
         move tarih               to mahsup-tarih
         move numara              to mahsup-fis-no
         add  1                   to fis-sira-sakla
         move fis-sira-sakla      to mahsup-fis-sira
         move borc-dep-hesap      to mahsup-hesap-kodu
         move "A"                 to mahsup-tipi
         move borc-dep-ba         to mahsup-b-a 
         move borc-dep-tutar      to mahsup-tutar
         move borc-dep-aciklama   to mahsup-aciklama 
         move ref                 to mahsup-referans 
         if ref-var = 1 then 
            evaluate onkpara-referans-nerden
            when 1  when 2
               move borc-dep-ref to mahsup-referans
            when 2
              move borc-dep-ref to mahsup-referans
            end-evaluate  
         end-if
         move k-kodu-tasi         to mahsup-staf 
         move borc-dep-fatura-no    to mahsup-BELGE-NO
         move function numval(mahsup-BELGE-NO) to e-o-fatura
          move ref to e-ref perform efatura-gercek-bul
          if e-m-fatura > spaces then 
              move e-m-fatura to mahsup-BELGE-NO
          end-if
         initialize hesap-rec
         move borc-dep-hesap           to  hesap-kodu
         read hesap no lock invalid
                 continue
         end-read
         
         move HESAP-KDV-ORAN to mahsup-kdv-oran


         if combo-dovizlimi-value(1:1)  = "D" and 
            islem-kuru not = 0
            if mahsup-tutar <> zeroes
               move mgenel-banka  to mahsup-banka-kodu
               move mgenel-doviz  to mahsup-doviz-kodu
               move mgenel-d-e    to mahsup-d-e                                           
               move islem-kuru   to mahsup-doviz-kuru
               compute mahsup-tutar-dv rounded = 
                       mahsup-tutar / islem-kuru
            end-if
         end-if
              perform dov-kont
         move "O"                 to mahsup-nereden

         if genel2-muh-refsiz-onb-refli = 1 
               initialize mahsup-referans
         end-if
          if genel2-mahsup-matrah-kdv-degistirilsin = 1 move low-values TO MAHSUP-OZEL-ACIKLAMA END-IF
          if mah-birles = 1 then 
            move mahsup-rec to mahsupm-rec
             move borc-dep-kredi to mahsupm-filler

            write mahsupm-rec invalid stop " " end-write
            else     

            write mahsup-rec invalid stop " " end-write  
         end-if 
            

     end-read
     end-perform
     end-start.
     
       initialize kasa-borc-dep-rec 
     start kasa-borc-dep key not < kasa-borc-dep-anah2 invalid
              continue
              not invalid
     initialize fs-kasa-borc-dep
     perform with test after until fs-kasa-borc-dep = "10"
     read kasa-borc-dep next no lock end move "10" to fs-kasa-borc-dep
     not at end
      if kasa-borc-dep-tutar  = 0 exit perform cycle end-if
         initialize mahsup-rec 
         move tarih               to mahsup-tarih
         move numara              to mahsup-fis-no
         add  1                   to fis-sira-sakla
         move fis-sira-sakla      to mahsup-fis-sira
         move kasa-borc-dep-hesap      to mahsup-hesap-kodu
         move "B"                 to mahsup-tipi
         move kasa-borc-dep-ba         to mahsup-b-a 
         move kasa-borc-dep-tutar      to mahsup-tutar
         move kasa-borc-dep-aciklama   to mahsup-aciklama 
         move ref                 to mahsup-referans 
         if ref-var = 1 then 
            evaluate onkpara-referans-nerden
            when 1    when 2
               move kasa-borc-dep-ref to mahsup-referans
            when 2
               move kasa-borc-dep-ref to mahsup-referans
            end-evaluate 
         end-if
         move k-kodu-tasi         to mahsup-staf   
         move kasa-borc-dep-fatura-no    to mahsup-BELGE-NO 
         move function numval(mahsup-BELGE-NO) to e-o-fatura
          move ref to e-ref perform efatura-gercek-bul
          if e-m-fatura > spaces then 
              move e-m-fatura to mahsup-BELGE-NO
          end-if
         initialize hesap-rec
         move kasa-borc-dep-hesap           to  hesap-kodu
         read hesap no lock invalid
                 continue
         end-read
         move HESAP-KDV-ORAN to mahsup-kdv-oran

         if combo-dovizlimi-value(1:1)  = "D" and 
            islem-kuru not = 0
            if mahsup-tutar <> zeroes
               move mgenel-banka  to mahsup-banka-kodu
               move mgenel-doviz  to mahsup-doviz-kodu
               move mgenel-d-e    to mahsup-d-e       
               move islem-kuru   to mahsup-doviz-kuru
               compute mahsup-tutar-dv rounded = 
                       mahsup-tutar / islem-kuru
            end-if
         end-if
            perform dov-kont
         move "O"                 to mahsup-nereden

         if genel2-muh-refsiz-onb-refli = 1 
               initialize mahsup-referans
         end-if
          if genel2-mahsup-matrah-kdv-degistirilsin = 1 move low-values TO MAHSUP-OZEL-ACIKLAMA END-IF
          if mah-birles = 1 then 
            move mahsup-rec to mahsupm-rec
             move KASA-borc-dep-kredi to mahsupm-filler

            write mahsupm-rec invalid stop " " end-write
            else  

            write mahsup-rec invalid stop " " end-write 
         end-if 
            
         
     end-read
     end-perform
     end-start


     

    
*******>Alacak Departmanlari Muhasebelesiyor.........
     
  
     close borc-dep kasa-borc-dep
     initialize alac-dep-rec 
     start alac-dep key not < alac-dep-anah2 invalid
      continue
      not invalid
     initialize fs-alac-dep
     perform with test after until fs-alac-dep = "10"
     read alac-dep next no lock end move "10" to fs-alac-dep
     not at end                  
       if alac-dep-corr not = "C" then
         if alac-dep-tutar-tl = 0 then exit perform cycle end-if 
         initialize mahsup-rec 
         move tarih               to mahsup-tarih
         move numara              to mahsup-fis-no
         add  1                   to fis-sira-sakla
         move fis-sira-sakla      to mahsup-fis-sira
         SET MAHSUP-DOVIZ-KILITLI TO TRUE
         move alac-dep-hesap      to mahsup-hesap-kodu
         move "A"                 to mahsup-tipi
         move alac-dep-ba         to mahsup-b-a 
         move alac-dep-tutar-tl   to mahsup-tutar
         move alac-dep-aciklama   to mahsup-aciklama 
         move ref                 to mahsup-referans 
         if ref-var = 1 then
            evaluate onkpara-referans-nerden
            when 1   when 2
            initialize kodlar02-rec
            move "r"           to kodlar02-tipi
            move alac-dep-ref to zz
            move zz           to kodlar02-kodu
            read kodlar02 no lock invalid 
                continue 
            not invalid 
                move kodlar02-ref to alac-dep-ref
            end-read              
            move alac-dep-ref     to mahsup-referans
            when 2
              continue 
            end-evaluate 
         end-if
         move k-kodu-tasi         to mahsup-staf
         initialize hesap-rec
         move alac-dep-hesap           to  hesap-kodu
         read hesap no lock invalid
                 continue
         end-read
         move HESAP-KDV-ORAN to mahsup-kdv-oran
          if alac-dep-acenno not = spaces then
               move alac-dep-banka      to mahsup-banka-kodu
               move alac-dep-doviz      to mahsup-doviz-kodu
               move mgenel-d-e           to mahsup-d-e       
               move alac-dep-tutar-dv   to mahsup-tutar-dv
               move alac-dep-doviz-kuru to mahsup-doviz-kuru
         else
         if combo-dovizlimi-value(1:1)  = "D" and 
            islem-kuru not = 0
            if mahsup-tutar <> zeroes
               move mgenel-banka  to mahsup-banka-kodu
               move mgenel-doviz  to mahsup-doviz-kodu
               move mgenel-d-e    to mahsup-d-e       
               move islem-kuru   to mahsup-doviz-kuru
               compute mahsup-tutar-dv rounded = 
                       mahsup-tutar / islem-kuru
            end-if
         end-if
         if combo-dovizlimi-value(1:1)  = "D" and 
            alac-dep-banka  not = 0 and
            alac-dep-doviz  not = 0
            if mahsup-tutar <> zeroes
               move alac-dep-banka      to mahsup-banka-kodu
               move alac-dep-doviz      to mahsup-doviz-kodu
               move mgenel-d-e           to mahsup-d-e       
               move alac-dep-tutar-dv   to mahsup-tutar-dv
               move alac-dep-doviz-kuru to mahsup-doviz-kuru
            end-if
         end-if
         end-if
                   
         if alac-dep-ara not = "A" or genel-taksilattan-muhasebe = 1 or isyeri-adres-tasi(1:4) = "alba"
             move alac-dep-fatura-no    to mahsup-BELGE-NO 
             move function numval(mahsup-BELGE-NO) to e-o-fatura
          move ref to e-ref perform efatura-gercek-bul
          if e-m-fatura > spaces then 
              move e-m-fatura to mahsup-BELGE-NO
          end-if
         end-if 
               perform dov-kont
         move "O" to mahsup-nereden

         if genel2-muh-refsiz-onb-refli = 1 
               initialize mahsup-referans
         end-if
         if genel2-mahsup-matrah-kdv-degistirilsin = 1 move low-values TO MAHSUP-OZEL-ACIKLAMA END-IF
         if mah-birles = 1 then 
            move mahsup-rec to mahsupm-rec
            move alac-dep-kredi to mahsupm-filler


            write mahsupm-rec invalid stop " " end-write
         
              else

            write mahsup-rec invalid stop " " end-write
         end-if 
                    
         end-if
     end-read
     end-perform
     end-start.

************************** alacak correctionlar
      
    
     initialize alac-dep-rec 
     start alac-dep key not < alac-dep-anah invalid
      continue
      not invalid
     initialize fs-alac-dep
     perform with test after until fs-alac-dep = "10"
     read alac-dep next no lock end move "10" to fs-alac-dep
     not at end
       if alac-dep-corr  = "C" then
          if   alac-dep-tutar-tl  = 0 then exit perform cycle end-if
         initialize mahsup-rec 
         move tarih               to mahsup-tarih
         move numara              to mahsup-fis-no
         add  1                   to fis-sira-sakla
         move fis-sira-sakla      to mahsup-fis-sira
           SET MAHSUP-DOVIZ-KILITLI TO TRUE
        
         move alac-dep-hesap      to mahsup-hesap-kodu
         move "A"                 to mahsup-tipi
         move alac-dep-ba         to mahsup-b-a 
         move alac-dep-tutar-tl   to mahsup-tutar
         move alac-dep-aciklama   to mahsup-aciklama 
         move ref                 to mahsup-referans 
         if ref-var = 1 then 
            evaluate onkpara-referans-nerden
            when 1    when 2
               move alac-dep-ref to mahsup-referans
            when 2
              move alac-dep-ref to mahsup-referans
            end-evaluate 
         end-if
         move k-kodu-tasi         to mahsup-staf
         initialize hesap-rec
         move alac-dep-hesap           to  hesap-kodu
         read hesap no lock invalid
                 continue
         end-read
         move HESAP-KDV-ORAN to mahsup-kdv-oran
         if alac-dep-acenno not = spaces then
               move alac-dep-banka      to mahsup-banka-kodu
               move alac-dep-doviz      to mahsup-doviz-kodu
               move mgenel-d-e          to mahsup-d-e       
               move alac-dep-tutar-dv   to mahsup-tutar-dv
               move alac-dep-doviz-kuru to mahsup-doviz-kuru
         else
         if combo-dovizlimi-value(1:1)  = "D" and 
            islem-kuru not = 0
            if mahsup-tutar <> zeroes
               move mgenel-banka  to mahsup-banka-kodu
               move mgenel-doviz  to mahsup-doviz-kodu
               move mgenel-d-e    to mahsup-d-e       
               move islem-kuru   to mahsup-doviz-kuru
               compute mahsup-tutar-dv rounded = 
                       mahsup-tutar / islem-kuru
            end-if
         end-if
         if combo-dovizlimi-value(1:1)  = "D" and 
            alac-dep-banka  not = 0 and
            alac-dep-doviz  not = 0
            if mahsup-tutar <> zeroes
               move alac-dep-banka      to mahsup-banka-kodu
               move alac-dep-doviz      to mahsup-doviz-kodu
               move mgenel-d-e           to mahsup-d-e       
               move alac-dep-tutar-dv   to mahsup-tutar-dv
               move alac-dep-doviz-kuru to mahsup-doviz-kuru
            end-if
         end-if
         end-if
        move alac-dep-fatura-no    to mahsup-BELGE-NO 
        move function numval(mahsup-BELGE-NO) to e-o-fatura
          move ref to e-ref perform efatura-gercek-bul
          if e-m-fatura > spaces then 
              move e-m-fatura to mahsup-BELGE-NO
          end-if
         move "O" to mahsup-nereden
                perform dov-kont  

         if genel2-muh-refsiz-onb-refli = 1 
               initialize mahsup-referans
         end-if         

           if genel2-mahsup-matrah-kdv-degistirilsin = 1 move low-values TO MAHSUP-OZEL-ACIKLAMA END-IF
           if mah-birles = 1 then 
                    move mahsup-rec to mahsupm-rec
                    move alac-dep-kredi to mahsupm-filler
                    MOVE "A" to mahsupm-filler(2:1)
                    move alac-dep-eb-virman-fat-no to mahsupm-eb-virman-fat-no
                    write mahsupm-rec invalid stop " " end-write
           else
                    write mahsup-rec invalid stop " " end-write
           end-if 
 
                    
         end-if     
     end-read
     end-perform
     end-start.
     
 
    
     if mah-birles = 1 then
        open i-o islenen
        perform Tahakkuklar 
        perform faturalar 
        perform eb-avans-virman-yap
        close islenen  
     end-if
    
  
     close mahsupm
     open i-o takvim
     move tarih to takvim-anah
     read takvim no lock 
        invalid 
           display message box "Takvim tanimli degil" 
        not invalid
        if takvim-onbmah2 not = 1 
            move 1 to takvim-onbmah2
            rewrite takvim-rec invalid write takvim-rec end-rewrite
           else
               display message box "Mukerrer Mahsup yaptiniz kontrol ediniz " title "Mukerrer  Kayit"
        end-if
     end-read      

     close takvim
     
     close hesap
     close alac-dep mahsup kasa-alac-dep kodlar02 takaskar efat2onb.
     delete file alac-dep kasa-alac-dep.
     delete file borc-dep kasa-borc-dep takaskar.



     .
     display message box 
             "Gunluk [ ONBURO  ] Faturalar Olusturulmustur Kontrol Ediniz !!!" new-line
             .
     modify form1-gd-1,reset-grid =1 .
     move 1 to enable-1 
     move 0 to enable-2
     display form1
     move 4 to accept-control
     move 4 to control-id.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
     .
*
 tahakkuklar.
        initialize fis-sira-sakla  mahsupm-rec 
          start mahsupm key >= mahsupm-kredi
                 invalid continue
                 not invalid
            perform until fs-mahsupm = "10"
                 read mahsupm  next 
                   end move "10" to fs-mahsupm
                    not end
                     if mahsupm-filler(1:1) = "K" then 
                          move "10" to fs-mahsupm
                          else
                    if mahsupm-belge-no not = spaces   then 
                       exit perform cycle
                    end-if
                    if fis-sira-sakla = 0 and mahsup-alindi  = 0 then 
                      perform mahsup-no-al
                    end-if
                    move 0 to  mahsup-alindi
                    move mahsupm-rec to mahsup-rec
                  
                     move numara              to mahsup-fis-no
                        add  1                to fis-sira-sakla
                    move fis-sira-sakla       to mahsup-fis-sira
                   write mahsup-rec invalid stop " " end-write
        

                   end-if
                 end-read
            end-perform
         end-start
           perform fatura-isle 
          initialize fis-sira-sakla  mahsupm-rec 
         move "K" to mahsupm-filler(1:1)
          start mahsupm key >= mahsupm-kredi
                 invalid continue
                 not invalid
            perform until fs-mahsupm = "10"
                 read mahsupm  next 
                   end move "10" to fs-mahsupm
                    not end


                    if mahsupm-filler(2:1) = "A"
                      move "10" to fs-mahsupm
                      exit perform cycle
                    end-if
                     if mahsupm-belge-no not = spaces  then 
                       exit perform cycle
                    end-if
                     if fis-sira-sakla = 0 and mahsup-alindi  = 0 then 
                      perform mahsup-no-al
                    end-if
                    move 0 to  mahsup-alindi
                    move mahsupm-rec to mahsup-rec
                     move numara              to mahsup-fis-no
                        add  1                   to fis-sira-sakla
                    move fis-sira-sakla      to mahsup-fis-sira
                   write mahsup-rec invalid stop " " end-write
               
                 end-read
            end-perform
         end-start
           perform fatura-isle
   
            .

* 
 eb-avans-virman-yap.
 
         initialize fis-sira-sakla  mahsupm-rec 
         move "KA" to mahsupm-filler(1:2)
          start mahsupm key >= mahsupm-kredi2
                 invalid continue
                 not invalid
            perform until fs-mahsupm = "10"
                 read mahsupm  next 
                   end move "10" to fs-mahsupm
                    not end


                     if mahsupm-belge-no not = spaces then 
                       exit perform cycle
                    end-if
                     if fis-sira-sakla = 0 and mahsup-alindi  = 0 then 
                      perform mahsup-no-al
                    end-if
                    move 0 to  mahsup-alindi
                    move mahsupm-rec to mahsup-rec
                     move numara              to mahsup-fis-no
                        add  1                   to fis-sira-sakla
                    move fis-sira-sakla      to mahsup-fis-sira
                    move "O" to mahsup-nereden
                   write mahsup-rec invalid stop " " end-write
         

                   || 18.07.2019 DELPHIN VIRMAN ICIN KONULDU
                   if function numval(mahsupm-eb-virman-fat-no) > 0 AND MAHSUPM-B-A = "A"

                        open i-o fatkapat
                        initialize fatkapat-rec
                        move MAHSUP-TARIH    to fatkapat-odeme-tarih
                        move MAHSUP-FIS-NO   to fatkapat-odeme-fis 
                        move MAHSUP-FIS-SIRA to fatkapat-odeme-sira
                        move mahsup-tutar    to fatkapat-odeme-tutar 

                        move mahsupm-eb-virman-fat-no to mydk-fat-no
                        move function numval(mahsupm-eb-virman-fat-no) to e-o-fatura
                        move ref to e-ref perform efatura-gercek-bul
                        if e-m-fatura > spaces then 
                               move e-m-fatura to mydk-fat-no
                        end-if

                        if FUNCTION NUMVAL(mydk-fat-no) not >0 then
                              close fatkapat
                              exit perform cycle
                        end-if
                             

                        initialize mahsup-rec
                        move tarih    to mahsup-tarih
                        start mahsup key not < MAHSUP-YEV invalid 
                            continue 
                        not invalid 
                        perform until fs-mahsup = "10"
                        read mahsup next no lock end move "10"  to fs-mahsup
                        not at end 
                              if mahsup-tarih <> tarih
                                  exit perform 
                              end-if 

                              if mahsup-fis-no not > eb-virman-bas-fis-no
                                   exit perform cycle
                              end-if
                              
                              if mydk-fat-no = mahsup-BELGE-NO AND 
                                 MAHSUP-B-A = "B" AND 
                                 mahsup-nereden(1:1) = "O" THEN
  
                                  move MAHSUP-TARIH    to fatkapat-fatura-tarih
                                  move MAHSUP-FIS-NO   to fatkapat-fatura-fis 
                                  move MAHSUP-FIS-SIRA to fatkapat-fatura-sira
                                  move mahsup-tutar    to fatkapat-fatura-tutar 
                                  move "O"             to fatkapat-from

                                  accept fatkapat-islem-tarih from century-date
                                  accept fatkapat-islem-zaman from time
                                  
                                  write fatkapat-rec invalid
                                          stop "fatkapat yazilamadi kontrol ediniz"
                                  end-write
                                  exit perform 
                              end-if
                        end-read 
                        end-perform
                        end-start
                        close fatkapat
                   end-if
                   |||||||
                 end-read
            end-perform
         end-start
         initialize eb-virman-bas-fis-no
         perform fatura-isle.
*
 fatura-isle.
     if fis-sira-sakla > 0 then 
             move numara      to islenen-fis-no
             move tarih       to islenen-tarih
             move "A"         to islenen-tipi
                move "O" to ISLENEN-NEREDEN
             write islenen-rec invalid 
                   rewrite islenen-rec end-rewrite
             end-write

              initialize fis-sira-sakla mahsup-alindi son-fatura      
         end-if, .    


*
 faturalar.     
        initialize fis-sira-sakla  mahsupm-rec   son-fatura mahsup-alindi
          start mahsupm key >= mahsupm-kredi
                 invalid continue
                 not invalid
            perform until fs-mahsupm = "10"
                 read mahsupm  next 
                   end move "10" to fs-mahsupm
                    not end

                     
                    if mahsupm-belge-no  = spaces     then 
                       exit perform cycle
                    end-if
                    if son-fatura = spaces then 
                        move mahsupm-belge-no  to son-fatura
                   end-if
                    if mahsupm-belge-no not = son-fatura   
                       perform fatura-isle
                       initialize fis-sira-sakla mahsup-alindi
                    end-if
                    if fis-sira-sakla = 0 and mahsup-alindi  = 0 then 
                      perform mahsup-no-al
                    end-if



                     move 0 to  mahsup-alindi
                     move mahsupm-rec to mahsup-rec
                     move "02" to mahsup-edefter-dokuman-tipi
                     move mahsup-tarih to mahsup-edefter-belge-tarihi
                     move k-kodu-tasi to mahsup-edefter-belgeyi-giren-staf
*                     move "Kredi Karti/Nakit "   to mahsup-edefter-odeme-yontemi
                     move numara                 to mahsup-fis-no
                    add  1                       to fis-sira-sakla
                    move fis-sira-sakla          to mahsup-fis-sira

                    
                    |/////HOLIDAY PARK HARUN/////|
                    if MAHSUP-ACIKLAMA(1:12) = "EB Avans Vir"
                       initialize mahsup-edefter-dokuman-tipi  MAHSUP-BELGE-NO
                    end-if
                    |//////13 08 2015////////////|

                   write mahsup-rec invalid stop " " end-write
                  
                 end-read
            end-perform
         end-start
           if fis-sira-sakla > 0 then 
                  perform fatura-isle
                  initialize fis-sira-sakla mahsup-alindi
           end-if,     
        
           
             .
*
 acc-ref-Ex-Other.
     if key-status =  1
        initialize link-referans
        call "/asya/ytl/obj/muha/refara.asy" using link-referans
             on exception 
                perform callerr-proc
        not on exception
             cancel "/asya/ytl/obj/muha/refara.asy"
        end-call
        if link-referans <> spaces
           move link-referans to ref
           display acc-ref
           move 4 to accept-control
           move 12 to control-id
        end-if
     end-if.
*
 kur-bul.
        initialize islem-kuru.
     if combo-dovizlimi-value(1:1)  = "D"
        
               
        open input kur
        initialize islem-kuru
        move tarih         to kur-tarih
        move mgenel-banka   to kur-banka
        move mgenel-doviz   to kur-doviz
        read kur no lock invalid 
         display message box "Gunluk Kur Kaydi Bulunamadi Devam Ederseniz Dovizsiz Mahsup Keser.."
                              new-line,
                              "Islem Tarihi...........:" gun "/" ay "/" yil   
                              new-line,
                              "Banka-Doviz Kodu.......:" mgenel-banka   "-" mgenel-doviz
                              title = " [ Kurlar Tanimsiz ] "
         close kur 
         exit paragraph
        end-read
        move doviz-alis to islem-kuru
        if mgenel-d-e = "D" and mgenel-a-s = "A" 
           move doviz-alis    to islem-kuru
        end-if 
        if mgenel-d-e = "D" and mgenel-a-s = "S" 
           move doviz-satis   to islem-kuru
        end-if 
        if mgenel-d-e = "E" and mgenel-a-s = "A" 
           move efektif-alis  to islem-kuru
        end-if 
        if mgenel-d-e = "E" and mgenel-a-s = "S" 
           move efektif-satis to islem-kuru
        end-if 

        if islem-kuru = 0 
           display message box "Kur Tutari [0] Olamaz, Islem Yapamazsiniz.."
                            new-line,
                            "Islem Tarihi...........:" gun "/" ay "/" yil
                            new-line,
                            "Banka-Doviz Kodu.......:" mgenel-banka   "-" mgenel-doviz
                            title = " [ Kurlar Tanimsiz ] "
          close kur 
          exit paragraph
        end-if
        close kur
     end-if.
 kur-bul-exit.
    exit.

 xx.
    
 
 
      initialize fatdetay-rec .
       move tarih to fatdetay-fat-tar.
   
    start fatdetay key not < fatdetay-anah invalid continue,
        not invalid,
        move spaces to evet-hayir,
        perform with test after until evet,
        read fatdetay next no lock end move "E" to evet-hayir,
            not end,
            
            if fatdetay-fat-tar > tarih,
                 continue
                move "E" to evet-hayir,
            end-if,

            if fatdetay-fat-tar > tarih,
                 continue
                move "E" to evet-hayir,
            end-if,

            if fatdetay-fat-tar = tarih,
               
             
                if fatdetay-depkod not = "C/L" then 

                  if fatdetay-kdv not = 88
                      initialize fatdetayek-rec

                      move fatdetay-anah to fatdetayek-anah
                      read fatdetayek no lock invalid continue end-read


                      initialize fatdetay2-rec
                       move fatdetay-anah to fatdetay2-anah 
                       move 88 to fatdetay2-kdv 
                       move fatdetay-romhrk-exthrk to fatdetay2-tip
                       read fatdetay2 no lock invalid
                          move fatdetay-rec to fatdetay2-rec
                           move 88 to fatdetay2-kdv 
                          move fatdetay-romhrk-exthrk to fatdetay2-tip    
                        not invalid
                          add  fatdetay-fatura-matrah      to    fatdetay2-fatura-matrah      
                          add  fatdetay-fatura-kdv         to    fatdetay2-fatura-kdv    
                          || add  fatdetay-fatura-kv         to    fatdetay2-fatura-kv  
                          add  fatdetay-fatura-toplam      to    fatdetay2-fatura-toplam      
                          add  fatdetay-fatura-toplamdv    to    fatdetay2-fatura-toplamdv    
                          add fatdetay-fatura-matrah18     to    fatdetay2-fatura-matrah18    
                          add  fatdetay-fatura-kdv18       to    fatdetay2-fatura-kdv18
                       end-read

                       initialize fatdetayek2-rec
                       move fatdetayek-anah to fatdetayek2-anah 
                       move 88 to fatdetayek2-kdv 
                     
                       read fatdetayek2 no lock invalid
                          move fatdetay-rec to fatdetayek2-rec
                           move 88 to fatdetayek2-kdv 
                        
                        not invalid
                         
                             add  fatdetayek-kv         to    fatdetayek2-kv  
                         
                       end-read



                          write fatdetayek2-rec invalid rewrite fatdetayek2-rec end-write
                          write fatdetay2-rec invalid rewrite fatdetay2-rec end-write
                          delete fatdetay invalid continue end-delete
                           delete fatdetayek invalid continue end-delete
              end-if
            end-if
            end-if
          end-read
          end-perform
       end-start
                     
                .
 fatdetay-kontffff.
              start fatdetay key not < fatdetay-anah invalid continue,
        not invalid,
        move spaces to evet-hayir,
        perform with test after until evet,
        read fatdetay next no lock end move "E" to evet-hayir,
            not end,
             
**************** **********************
*            initialize fatura-rec
*            move function numval(fatdetay-fat-no)  to fatura-no 
*            
*            read fatura no lock invalid 
*               continue 
*               not invalid 
*               move FATURA-TARIHI to fatdetay-fat-tar
*            end-read
           
*******************
            if fatdetay-fat-tar > tarih,
                 continue
                move "E" to evet-hayir,
            end-if,


                

            if fatdetay-fat-tar = tarih,
               
                initialize depkod-rec depkod2-rec,
                move fatdetay-depkod to depkod-kodu depkod2-kodu,
                 if fatdetay-depkod = "C/L" then 
                      
*                   if function numval (fatdetay-fat-no) =  101799 and k-kodu-tasi = "X   " then 
*                       stop " " 
*                       fatdetay-fatura-toplam
*                    end-if
                    if function numval (fatdetay-islem) >  0 and < 10 
                    if fatdetay-kdv not = 99 
                      initialize fatdetayek-rec
                       move fatdetay-anah to fatdetayek-anah 
                        read fatdetayek no lock invalid continue 
                        end-read

                       initialize fatdetay2-rec
                       move fatdetay-anah to fatdetay2-anah  fatdetayek2-anah 
                       move 99 to fatdetay2-kdv 
                       move fatdetay-romhrk-exthrk to fatdetay2-tip
                       move fatdetay2-anah to fatdetayek2-anah

                        read fatdetayek2 no lock invalid
                          move fatdetayek-rec to fatdetayek2-rec
                           move 99 to fatdetayek2-kdv 
                      
                        not invalid
                          
                          add fatdetayek-kv                  to fatdetayek2-kv

                       end-read 
 




                       read fatdetay2 no lock invalid
                          move fatdetay-rec to fatdetay2-rec
                           move 99 to fatdetay2-kdv 
                          move fatdetay-romhrk-exthrk to fatdetay2-tip    
                        not invalid
                          add  fatdetay-fatura-matrah      to    fatdetay2-fatura-matrah      
                          add  fatdetay-fatura-kdv         to    fatdetay2-fatura-kdv   
                         || add  fatdetay-fatura-kv          to    fatdetay2-fatura-kv  
                          add  fatdetay-fatura-toplam      to    fatdetay2-fatura-toplam      
                          add  fatdetay-fatura-toplamdv    to    fatdetay2-fatura-toplamdv    
                          add  fatdetay-fatura-matrah18    to    fatdetay2-fatura-matrah18    
                          add  fatdetay-fatura-kdv18       to    fatdetay2-fatura-kdv18
                       ||   add fatdetay2-kv                  to fatdetayek2-kv

                       end-read
                          write fatdetay2-rec invalid rewrite fatdetay2-rec end-write
                          write fatdetayek2-rec invalid rewrite fatdetayek2-rec end-write

                          delete fatdetay invalid continue end-delete
                           delete fatdetayek invalid continue end-delete
                     end-if
                        end-if
                  else
*                   if function numval(fatdetay-fat-no) = 309629 and debug = 1 then 
*                      stop" " 
*                   end-if
                  
                   if fatdetay-romhrk-exthrk = "R" then
                        move function numval(fatdetay-islem) to romhrk-islem
                        move fatdetay-folio to romhrk-folio  konuk-folio
                         if ref-var = 1 then
                         read konuk no lock invalid 
                               stop " "
                            end-read
                            perform genel-konuk-ref-ayarla
                            evaluate onkpara-referans-nerden
                            when 1  
                            
                              move xkonum-ref(konuk-fiyat-konumu) to sat-ref
                                         initialize kodlar02-rec
                                         move "r"           to kodlar02-tipi
                                         move xkonum-ref(konuk-oda-konumu) to zz
                                          if isyeri-adres-tasi(1:4) = "long" then 
                                            move xkonum-ref(konuk-fiyat-konumu) to zz
                                         end-if
                                         move zz                           to kodlar02-kodu
                                         read kodlar02 no lock invalid 
                                             continue 
                                         not invalid 
                                             if kodlar02-ref not = ref
                                                exit perform cycle 
                                             end-if 

                                         end-read 
                             when 2
                               MOVE KONUK-ODANO TO  ODALAR-NO
                                  READ ODALAR NO lock invalid
                                     move 1 to odalar-referans
                                     not invalid
                                        if odalar-referans > 0 and  odalar-referans < 9
                                          continue
                                          else
                                          move 1 to odalar-referans
                                       end-if
                                  end-read
                                        if odalar-referans not = ref
                                                exit perform cycle 
                                             end-if 
                                        move ref to sat-ref
                             end-evaluate 
                        end-if
                        read romhrk no lock 
                            invalid exit perform cycle
                              not invalid
                              move romhrk-corr-depkod to  depkod2-kodu
                           if function numval(fatdetay-fat-no) 
                                    not = romhrk-FATURA-NO
                            
                           exit perform cycle
                         end-if
                      end-read
                  else
                       move function numval(fatdetay-islem) to exthrk-islem
                           move fatdetay-folio to exthrk-folio    konuk-folio
                            if ref-var = 1 then
                            read konuk no lock invalid 
                                   stop " "
                                end-read
                            perform genel-konuk-ref-ayarla
                            evaluate onkpara-referans-nerden
                            when 1                                
                                
                                move xkonum-ref(konuk-fiyat-konumu) to sat-ref
                                initialize kodlar02-rec
                                move "r"           to kodlar02-tipi
                                move xkonum-ref(konuk-oda-konumu) to zz
                                 if isyeri-adres-tasi(1:4) = "long" then 
                                            move xkonum-ref(konuk-fiyat-konumu) to zz
                                         end-if
                                move zz                           to kodlar02-kodu
                                read kodlar02 no lock invalid 
                                    continue 
                                not invalid
        
                                    if kodlar02-ref not = ref
                                       exit perform cycle 
                                    end-if 
                                end-read 
                            when 2
                              MOVE KONUK-ODANO TO  ODALAR-NO
                                  READ ODALAR NO lock invalid
                                     move 1 to odalar-referans
                                     not invalid
                                        if odalar-referans > 0 and  odalar-referans < 9
                                          continue
                                          else
                                          move 1 to odalar-referans
                                       end-if
                                  end-read
                                        if odalar-referans not = ref
                                                exit perform cycle 
                                             end-if
                                           move ref to sat-ref
                            end-evaluate 
                        end-if

                        read exthrk no lock 
                          invalid exit perform cycle
                          not invalid 
                          move exthrk-corr-depkod to  depkod2-kodu
                           if function numval(fatdetay-fat-no) not = exthrk-FATURA-NO
                                exit perform cycle
                          end-if
                        end-read


                end-if
         
                

                read depkod no lock invalid continue,
                    not invalid,
                      if  depkod-TURU not = 2 then 
                            move depkod-kodu to depkod2-kodu
                            else
                            move depkod2-kodu to depkod-kodu
                            read depkod no lock invalid
                              continue

                            end-read
                           move 2 to depkod-turu
                      end-if
                      read depkod2 no lock invalid continue
                        not invalid
                        perform depkod2-hesap-ref-ayarla
*                          if depkod2-matrah-hesap(1:3) not = "100"
                                perform takaslara-yaz
*                               else
*                             perform kasa-takaslara-yaz
*                          end-if
                      end-read
                end-read,
              end-if
            end-if,
        end-read,
        end-perform,
    end-start.

 yeni-tip-hesapla.
     | if function numval(fatdetay-fat-no) = 34142 and k-kodu-tasi = "ASYA" then stop " " end-if
            read depkod2 no lock invalid continue end-read
                           if (kv-gecis-tar <= tarih and depkod2-kv-uygula = 1 )
                                compute  depgec-kv-orani = kv-orani
                              else
                                compute depgec-kv-orani = 0
                end-if
         

               compute matrah-tut rounded =  toplam-tut * 100 / (100 + dep-kdv + depgec-kv-orani ) 

               compute kdv-tut  rounded =  matrah-tut / 100 * (dep-kdv  )

               compute kv-tut  rounded =  matrah-tut / 100 * ( depgec-kv-orani )

               compute matrah-tut = toplam-tut - kdv-tut - kv-tut

                .


 fatdetay-oku.
      open input  depkod2 depkod kodlar02 romhrk exthrk fatura konuk yromhrk hrk2 odalar.
      open i-o fatdetay2 fatdetay  fatdetayek fatdetayek2  efat2onb 
         
        perform xx
    
    initialize fatdetay-rec .
    move tarih to fatdetay-fat-tar.
   
        start fatdetay key not < fatdetay-anah invalid continue,
        not invalid,
        move spaces to evet-hayir,
        perform with test after until evet,
        read fatdetay next no lock end move "E" to evet-hayir,
            not end,
              
**************** **********************
*            initialize fatura-rec
*            move function numval(fatdetay-fat-no)  to fatura-no 
*            
*            read fatura no lock invalid 
*               continue 
*               not invalid 
*               move FATURA-TARIHI to fatdetay-fat-tar
*            end-read
           
*******************
            if fatdetay-fat-tar > tarih,
                 continue
                move "E" to evet-hayir,
            end-if,

            if fatdetay-fat-tar = tarih,
                perform fatdetay-kontrol
                if kont-hat = 1 
                if k-kodu-tasi = "ASYA" then   stop " " end-if
                        exit perform cycle
                      end-if

                initialize depkod-rec depkod2-rec,
                move fatdetay-depkod to depkod-kodu depkod2-kodu,
                 if fatdetay-depkod = "C/L" then                                         
                    if function numval (fatdetay-islem) >  0 and < 10 
                    if fatdetay-kdv not = 99 

                       initialize fatdetayek-rec
                       move fatdetay-anah to fatdetayek-anah
                       read fatdetayek no lock invalid continue
                       end-read

                       initialize fatdetay2-rec
                       move fatdetay-anah to fatdetay2-anah 
                       move 99 to fatdetay2-kdv 
                       move fatdetay-romhrk-exthrk to fatdetay2-tip
                       read fatdetay2 no lock invalid
                          move fatdetay-rec to fatdetay2-rec
                           move 99 to fatdetay2-kdv 
                          move fatdetay-romhrk-exthrk to fatdetay2-tip    
                        not invalid
                          add  fatdetay-fatura-matrah      to    fatdetay2-fatura-matrah      
                          add  fatdetay-fatura-kdv         to    fatdetay2-fatura-kdv         
                          add  fatdetay-fatura-toplam      to    fatdetay2-fatura-toplam      
                          add  fatdetay-fatura-toplamdv    to    fatdetay2-fatura-toplamdv    
                          add  fatdetay-fatura-matrah18    to    fatdetay2-fatura-matrah18    
                          add  fatdetay-fatura-kdv18       to    fatdetay2-fatura-kdv18
                       end-read


                         initialize fatdetayek2-rec
                       move fatdetayek-anah to fatdetayek2-anah 
                       move 99 to fatdetayek2-kdv 
                      
                       read fatdetayek2 no lock invalid
                          move fatdetayek-rec to fatdetayek2-rec
                           move 99 to fatdetayek2-kdv 
                       
                        not invalid
                          add  fatdetayek-kv     to    fatdetayek2-kv      
                         
                       end-read

                           write fatdetayek2-rec invalid rewrite fatdetayek2-rec end-write
                          write fatdetay2-rec invalid rewrite fatdetay2-rec end-write
                          delete fatdetay invalid continue end-delete
                           delete fatdetayek invalid continue end-delete
                     end-if
                        end-if
                  else
                      if fatdetay-romhrk-exthrk = "R" 
                             continue
                          else
                               move exthrk-corr-depkod    to  romhrk-corr-depkod  
                          end-if
                      move fatdetay-depkod to depkod-kodu 
                        read depkod  no lock invalid continue
                          not invalid 
                            if depkod-turu = 2 and romhrk-corr-depkod not = spaces and   romhrk-corr-depkod not = zeroes
                                   move romhrk-corr-depkod to depkod-anah
                                       read depkod no lock invalid
                                           continue
                                    end-read 
                                  end-if
                          end-read
                         

                            move depkod-kdv        to  fatdetay-kdv-orani                  
                          if fatdetay-romhrk-exthrk = "R" 
                          move romhrk-tl-tutar    to  fatdetay-fatura-toplam 
                          else
                               move exthrk-tl-tutar    to  fatdetay-fatura-toplam  
                          end-if


                          move fatdetay-anah to fatdetayek-anah
                          initialize fatdetayek-rec 
                          read fatdetayek no lock invalid continue end-read
                          move depkod-kodu to depkod2-anah
                          move depkod-kdv to dep-kdv
                          move fatdetay-fatura-toplam to toplam-tut

                           perform    yeni-tip-hesapla

                          compute fatdetay-fatura-matrah rounded = matrah-tut
                          compute fatdetay-fatura-kdv = kdv-tut
                       
                          compute  fatdetayek-kv = kv-tut 



                                                                                                          
                     move fatdetay-depkod to depkod-kodu depkod2-kodu,
*                   if function numval(fatdetay-fat-no) = 309629 and debug = 1 then 
*                      stop" " 
*                   end-if
*                        if function numval(fatdetay-folio)  = 41802 then stop "C/L degil " end-if
                  
                   if fatdetay-romhrk-exthrk = "R" then
                        move function numval(fatdetay-islem) to romhrk-islem
                        move fatdetay-folio to romhrk-folio  konuk-folio
                         if ref-var = 1 then 
                         read konuk no lock invalid 
                               stop " "
                            end-read
                            perform genel-konuk-ref-ayarla                          
                      
                            evaluate onkpara-referans-nerden
                            when 1 
                            
                              move xkonum-ref(konuk-fiyat-konumu) to sat-ref
                                         initialize kodlar02-rec
                                         move "r"           to kodlar02-tipi
                                         move xkonum-ref(konuk-oda-konumu) to zz
                                          if isyeri-adres-tasi(1:4) = "long" then 
                                            move xkonum-ref(konuk-fiyat-konumu) to zz
                                         end-if
                                         move zz                           to kodlar02-kodu
                                         read kodlar02 no lock invalid 
                                             continue 
                                         not invalid 
                                             if kodlar02-ref not = ref
                                                exit perform cycle 
                                             end-if 
                                         end-read 
                            when 2
                               MOVE KONUK-ODANO TO  ODALAR-NO
                                  READ ODALAR NO lock invalid
                                     move 1 to odalar-referans
                                     not invalid
                                        if odalar-referans > 0 and  odalar-referans < 9
                                          continue
                                          else
                                          move 1 to odalar-referans
                                       end-if
                                  end-read
                                        if odalar-referans not = ref
                                                exit perform cycle 
                                             end-if
                                    move ref to sat-ref          
                             
                               
                            end-evaluate 
                        end-if
                        read romhrk no lock 
                            invalid exit perform cycle
                              not invalid
                              move romhrk-corr-depkod to  depkod2-kodu
                           if function numval(fatdetay-fat-no) 
                                    not = romhrk-FATURA-NO
                            
                           exit perform cycle
                         end-if
                      end-read
                  else
                      
                       move function numval(fatdetay-islem) to exthrk-islem
                           move fatdetay-folio to exthrk-folio    konuk-folio
                            if ref-var = 1 then 
                             read konuk no lock invalid 
                                   stop " "
                                end-read
                            perform genel-konuk-ref-ayarla

                            evaluate onkpara-referans-nerden
                            when 1 
                               
                                move xkonum-ref(konuk-fiyat-konumu) to sat-ref
                                initialize kodlar02-rec
                                move "r"           to kodlar02-tipi
                                move xkonum-ref(konuk-oda-konumu) to zz
                                 if isyeri-adres-tasi(1:4) = "long" then 
                                            move xkonum-ref(konuk-fiyat-konumu) to zz
                                         end-if
                                move zz                           to kodlar02-kodu
                                read kodlar02 no lock invalid 
                                            continue 
                                        not invalid
                                            if kodlar02-ref not = ref
                                               exit perform cycle 
                                            end-if 
                                end-read 
                            when 2
                              MOVE KONUK-ODANO TO  ODALAR-NO
                                  READ ODALAR NO lock invalid
                                     move 1 to odalar-referans
                                     not invalid
                                        if odalar-referans > 0 and  odalar-referans < 9
                                          continue
                                          else
                                          move 1 to odalar-referans
                                       end-if
                                  end-read
                                        if odalar-referans not = ref
                                                exit perform cycle 
                                             end-if 
                                        move ref to sat-ref  
                            end-evaluate 
                        end-if

                        read exthrk no lock 
                          invalid exit perform cycle
                          not invalid 
                          move exthrk-corr-depkod to  depkod2-kodu
                           if function numval(fatdetay-fat-no) not = exthrk-FATURA-NO
                            exit perform cycle
                          end-if
                        end-read


                end-if
                read depkod no lock invalid continue,
                    not invalid,
                      if  depkod-TURU not = 2 then 
                            move depkod-kodu to depkod2-kodu
                            else
                            move depkod2-kodu to depkod-kodu
                            read depkod no lock invalid
                              continue

                            end-read
                           move 2 to depkod-turu
                      end-if
                      read depkod2 no lock invalid continue
                        not invalid
                        perform depkod2-hesap-ref-ayarla
*                          if depkod2-matrah-hesap(1:3) not = "100"
                                perform takaslara-yaz
*                               else
*                             perform kasa-takaslara-yaz
*                          end-if
                      end-read
                end-read,
              end-if
            end-if,
        end-read,
        end-perform,
    end-start.
    open input folref 
    perform folio-karsilik-bul2
    close folref
    perform kredi-bul
     initialize    takaskar-rec     
        start takaskar key > takaskar-anah invalid
          continue
          not invalid 
          perform until fs-takaskar = "10"
               read takaskar next no lock 
                    end move "10" to fs-takaskar
                    not end
                     if takaskar-tutar not = 0 then 
                         display message box takaskar-folio " foliosunda " takaskar-ref "  pencerinden kaynaklanan" new-line
                                              takaskar-fatura " nolu fatura mahsubunda problem var "
                         if k-kodu-tasi = "X   " or "ASYA" then stop " " end-if

                     end-if
                end-read
          end-perform
        end-start
    close fatdetay depkod depkod2 romhrk kodlar02 exthrk fatura konuk fatdetay2 yromhrk efat2onb hrk2 odalar fatdetayek fatdetayek2.

* 
 Takaslara-Yaz.
        | if function numval(fatdetay-fat-no)     = 34142 and k-kodu-tasi = "ASYA" then stop " " end-if
           if ref-var = 1
              evaluate onkpara-referans-nerden
              when 1   when 2
                move xkonum-ref(konuk-fiyat-konumu) to sat-ref
              when 2
                 continue 
              end-evaluate 
           end-if
          

              evaluate true
                    when ( depkod-ba = "B" and depkod-turu not = 3 ) or ( depkod-ba = "A"  and depkod-TURU = 2 )
                         initialize borc-dep-rec,
          if depkod-toplam-hesap not = spaces
                            and  depkod2-toplam-hesap not = spaces
                            move depkod-toplam-hesap   to borc-dep-hesap
                            if depkod-matrah-ba = "A"
                               move "A"   to borc-dep-ba
                            else
                               move "B"   to borc-dep-ba
                            end-if
                            
                            move depkod-toplam-hesap  to borc-dep-hesap
                            if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                             move ref to borc-dep-ref
                            when 2
                               move ref to borc-dep-ref
                            end-evaluate 
                            end-if
                            if isyeri-adres-tasi(1:4) = "long" then 
                                            continue
                            end-if


                            if isyeri-adres-tasi(1:4) = "alba" then 
                              move  function numval(fatdetay-fat-no)    
                                          to borc-dep-fatura-no
                           end-if

                            read borc-dep no lock invalid continue,
                            end-read,
                            if  depkod-TURU= 2


                                  compute borc-dep-tutar rounded = 
                                          borc-dep-tutar - fatdetay-fatura-toplam
                               else
                                  compute borc-dep-tutar rounded = 
                                          borc-dep-tutar + fatdetay-fatura-toplam
                                  move "Gunluk Gelirler Geregi" to borc-dep-aciklama
                             end-if
                               write borc-dep-rec invalid rewrite borc-dep-rec,
                               end-write,
                              
                             initialize borc-dep-rec,

                            move depkod-toplam-hesap   to borc-dep-hesap
                            if depkod-matrah-ba = "B"
                               move "A"   to borc-dep-ba
                            else
                               move "B"   to borc-dep-ba
                            end-if
                            
                            move depkod2-toplam-hesap   to borc-dep-hesap
                            move function numval(fatdetay-fat-no)        to borc-dep-fatura-no

          
                            if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                              
                              move ref to borc-dep-ref
                            when 2
                               move ref to borc-dep-ref
                            end-evaluate 
                            if isyeri-adres-tasi(1:4) = "long" then 
                                            continue
                            end-if
                              if depkod-ref > 0 and < max-ref then
                                move depkod-ref to borc-dep-ref
                              end-if  
                            end-if
                            read borc-dep no lock invalid continue,
                            end-read,
                            if  depkod-TURU= 2
                                  compute borc-dep-tutar rounded = 
                                          borc-dep-tutar - fatdetay-fatura-toplam
                               else
                                 compute borc-dep-tutar rounded = 
                                         borc-dep-tutar + fatdetay-fatura-toplam
                                 move "Gunluk Gelirler Geregi" to borc-dep-aciklama
                            end-if
                            write borc-dep-rec invalid rewrite borc-dep-rec,
                            end-write,
                         end-if
        if (depkod-matrah-hesap not = spaces or ara-bos = 1)
                         and  depkod2-matrah-hesap not = spaces
                             initialize borc-dep-rec,
                            move depkod-matrah-hesap   to borc-dep-hesap
                                    if depkod-matrah-ba = "B"
                                          move "A"   to borc-dep-ba
                                      else
                                          move "B"   to borc-dep-ba
                                    end-if
                            
                            
                            move depkod-matrah-hesap  to borc-dep-hesap
                             if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                             move ref to borc-dep-ref
                            when 2
                              move ref to borc-dep-ref
                            end-evaluate 
                            end-if
                            if isyeri-adres-tasi(1:4) = "long" then 
                                            continue

                            end-if
                            read borc-dep no lock invalid continue,
                            end-read,

         
                                if  depkod-TURU= 2
                                  compute borc-dep-tutar rounded = 
                                          borc-dep-tutar - (fatdetay-fatura-matrah + fatdetayek-kv    )
                               else


                                 compute borc-dep-tutar rounded =
                                         borc-dep-tutar + (fatdetay-fatura-matrah + fatdetayek-kv    )
                                 move "Gunluk Gelirler Geregi" to borc-dep-aciklama
                             end-if
                             
                                 if ara-bos not = 1 
                                    write borc-dep-rec 
                                      invalid 
                                         rewrite borc-dep-rec end-rewrite,
                                    end-write,
                                end-if
                             initialize borc-dep-rec,
                            move depkod2-matrah-hesap   to borc-dep-hesap
                            if depkod-matrah-ba = "A"
                               move "A"   to borc-dep-ba
                            else
                               move "B"   to borc-dep-ba
                            end-if
                            
                            
                            move depkod2-matrah-hesap      to borc-dep-hesap
                            move  function numval(fatdetay-fat-no)    
                                          to borc-dep-fatura-no

 

                            if ref-var = 1
                              evaluate onkpara-referans-nerden
                              when 1                               
                                move ref to borc-dep-ref
                              when 2
                                 move ref to borc-dep-ref
                              end-evaluate 
                              if isyeri-adres-tasi(1:4) = "long" then 
                                            continue
                            end-if
                              if depkod-ref > 0 and < max-ref then
                                 move depkod-ref to borc-dep-ref
                              end-if  
                            end-if
                            |************************************
                       
                           move "F"    to  borc-dep-fat-tip
                           move "M"    to  borc-dep-mat-tipi
                    read borc-dep no lock invalid continue,
                    end-read,
                         move "F"    to  borc-dep-fat-tip
                         move "M"    to  borc-dep-mat-tipi
                          move depkod-kdv to  borc-dep-kdv   
                    | *****************************
                            read borc-dep no lock invalid continue,
                            end-read,

                               move depkod-kdv to  borc-dep-kdv                             
            

                            if  depkod-TURU= 2
                                  compute borc-dep-tutar rounded = 
                                          borc-dep-tutar - fatdetay-fatura-matrah
                               else
                                 compute borc-dep-tutar rounded = borc-dep-tutar + 
                                        fatdetay-fatura-matrah

                                 move function numval(fatdetay-fat-no)    to  z-8
                                 
                                 move z-8 to borc-dep-aciklama 
                                 move function numval(fatdetay-fat-no) to e-o-fatura
                                          move ref to e-ref perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to borc-dep-aciklama
                                          end-if
                               
                                 move "Ft geregi"      to borc-dep-aciklama (22:)
                             end-if
                            write borc-dep-rec invalid rewrite borc-dep-rec,
                            end-write,
                         end-if  
             
***************************************                         
            if (depkod-kdv-hesap not = spaces or ara-bos = 1)

                        

                            and  depkod2-kdv-hesap not = spaces
                             initialize borc-dep-rec,
                            move depkod-kdv-hesap   to borc-dep-hesap
                            if depkod-matrah-ba = "B"
                               move "A"   to borc-dep-ba
                            else
                               move "B"   to borc-dep-ba
                            end-if
                            
                            
                            move depkod-kdv-hesap  to borc-dep-hesap
                            if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1                                 
                                move ref to borc-dep-ref







                            when 2
                              move ref to borc-dep-ref
                            end-evaluate 
                            end-if
                            if isyeri-adres-tasi(1:4) = "long" then 
                                            continue
                            end-if
                            read borc-dep no lock invalid 
                                continue,
                            end-read,
                            if  depkod-TURU= 2
                                  compute borc-dep-tutar rounded = 
                                 borc-dep-tutar - fatdetay-fatura-kdv
                               else
                                 compute borc-dep-tutar rounded = 
                                 borc-dep-tutar + fatdetay-fatura-kdv
                                 move "Gunluk Gelirler Geregi" to borc-dep-aciklama
                            end-if
                                 if ara-bos not = 1 
                                    write borc-dep-rec invalid rewrite borc-dep-rec,
                                    end-write,
                                   end-if
                              initialize borc-dep-rec,
                            move depkod2-kdv-hesap   to borc-dep-hesap
                            if depkod-matrah-ba = "A"
                                 move "A"   to borc-dep-ba
                              else
                                 move "B"   to borc-dep-ba
                            end-if
                            
                           
                            move depkod2-kdv-hesap   to borc-dep-hesap
                            move  function numval(fatdetay-fat-no)     to  z-8
                                 
                                 move z-8    to borc-dep-fatura-no
                            if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                                move ref to borc-dep-ref
                            when 2
                                move ref to borc-dep-ref
                            end-evaluate 
                                if depkod-ref > 0 and < max-ref then
                                    move depkod-ref to borc-dep-ref
                                end-if  
                            end-if
                       |************************************
                       
                           move "F"    to  borc-dep-fat-tip
                           move "K"    to  borc-dep-mat-tipi
                           if isyeri-adres-tasi(1:4) = "long" then 
                                            continue
                            end-if
                    read borc-dep no lock invalid continue,
                    end-read,
                         move "F"    to  borc-dep-fat-tip
                         move "K"    to  borc-dep-mat-tipi
                          move depkod-kdv to  borc-dep-kdv   

                       | ****************************
                            read borc-dep no lock invalid continue,
                            end-read,
                               if  depkod-TURU= 2
                                  compute borc-dep-tutar rounded = 
                                 borc-dep-tutar - fatdetay-fatura-kdv
                               else
                                  
                                 compute borc-dep-tutar rounded = 
                                 borc-dep-tutar + fatdetay-fatura-kdv
                                 move function numval(fatdetay-fat-no)   to  z-8
                                 
                                 move z-8 to borc-dep-aciklama
                                  move function numval(fatdetay-fat-no) to e-o-fatura
                                          move ref to e-ref perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to borc-dep-aciklama
                                          end-if
                                 
                                 move "Ft geregi" to borc-dep-aciklama (22:)
                                 end-if
                            write borc-dep-rec invalid rewrite borc-dep-rec,
                            end-write,
                         end-if


************************
           if   depkod2-kv-hesap not = spaces 
                       |and depkod-matrah-hesap not = spaces
                      | and depkod2-kdv-hesap not = spaces      | sealight icin
                              initialize borc-dep-rec,
                            move depkod2-kv-hesap   to borc-dep-hesap
                            if depkod-matrah-ba = "A"
                                 move "A"   to borc-dep-ba
                              else
                                 move "B"   to borc-dep-ba
                            end-if
                            
                           
                            move depkod2-kv-hesap   to borc-dep-hesap
                            move  function numval(fatdetay-fat-no)     to  z-8
                                 
                                 move z-8    to borc-dep-fatura-no
                            if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                                move ref to borc-dep-ref
                            when 2
                                move ref to borc-dep-ref
                            end-evaluate 
                                if depkod-ref > 0 and < max-ref then
                                    move depkod-ref to borc-dep-ref
                                end-if  
                            end-if
                       |************************************
                       
                           move "F"    to  borc-dep-fat-tip
                           move "V"    to  borc-dep-mat-tipi
                           if isyeri-adres-tasi(1:4) = "long" then 
                                            continue
                            end-if
                   
                         move "F"    to  borc-dep-fat-tip
                         move "V"    to  borc-dep-mat-tipi
                          move depkod-kdv to  borc-dep-kdv   

                       | ****************************
                            read borc-dep no lock invalid continue,
                            end-read,
                               if  depkod-TURU= 2
                                  compute borc-dep-tutar rounded = 
                                 borc-dep-tutar - fatdetayek-kv
                               else
                                  
                                 compute borc-dep-tutar rounded = 
                                 borc-dep-tutar + fatdetayek-kv
                                 move function numval(fatdetay-fat-no)   to  z-8
                                 
                                 move z-8 to borc-dep-aciklama
                                  move function numval(fatdetay-fat-no) to e-o-fatura
                                          move ref to e-ref perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to borc-dep-aciklama
                                          end-if
                                 
                                 move "Ft geregi KV" to borc-dep-aciklama (22:)
                                 end-if
                               
                            write borc-dep-rec invalid rewrite borc-dep-rec,
                            end-write,
               end-if
           
*************************************************




                          if  depkod-TURU= 2
                             move -1 to carpan 
                             else
                             move 1 to carpan
                          end-if
*                         perform karsilik-bul
                         perform karsilik-bul2       


                    end-evaluate,
          
    .   
*
************************************************************ *
*
 karsilik-bul2.
             initialize takaskar-rec
               move function numval(fatdetay-fat-no) to takaskar-fatura 
           if fatdetay-romhrk-exthrk = "R"
               move romhrk-folio to takaskar-folio
               move romhrk-ref   to takaskar-ref
             
                
             else
               move exthrk-folio to takaskar-folio
               move exthrk-ref   to takaskar-ref
          end-if
*           if takaskar-folio = 41802 then stop " " end-if
          read takaskar no lock invalid
              continue
          end-read
*          if takaskar-folio = 138869 and (k-kodu-tasi = "ASYA" or "X   ")
*          stop " "
*          end-if
****            03 fatdetay-fat-no            pic x(10).
****       03 fatdetay-kdv               pic 99v99.
***       03 fatdetay-tip               pic x.
****       03 fatdetay-depkod            pic xxx.
****       03 fatdetay-folio             pic x(8).       
****       03 fatdetay-islem             pic x(8). 




          if fatdetay-romhrk-exthrk = "R"
             
              compute  takaskar-tutar =  takaskar-tutar + (romhrk-tl-tutar * carpan )
             else
              
                compute  takaskar-tutar =  takaskar-tutar + (exthrk-tl-tutar * carpan )
            
          end-if
           write takaskar-rec invalid rewrite takaskar-rec end-write.

 

           .



*
 folio-karsilik-bul2.
        initialize    takaskar-rec    
        open input acenta
        start takaskar key > takaskar-anah invalid
          continue
          not invalid 
          perform until fs-takaskar = "10"
               read takaskar next no lock 
                    end move "10" to fs-takaskar
                    not end
*                      if takaskar-folio = 14172 and (k-kodu-tasi = "ASYA" or "X   ") then 
*                         stop " "
*                       end-if
                           initialize    romhrk-rec exthrk-rec
                             
                             move takaskar-folio to romhrk-folio konuk-folio
                             read konuk no lock invalid stop " " 
                             end-read
                              perform genel-konuk-ref-ayarla
*                             if konuk-folio = 41802 then stop "GIRMEZ " end-if
                             start romhrk key > romhrk-anah invalid continue
                               not invalid
                                perform until fs-romhrk = "10" 
                                       read romhrk next no lock 
                                       end move  "10" to fs-romhrk
                                       not end
                                        if  takaskar-folio not =  romhrk-folio
                                            move "10" to fs-romhrk
                                            else
                                            if romhrk-ref  = takaskar-ref 
                                            and romhrk-fatura-no =
                                             takaskar-fatura
                                              move romhrk-rec to hrkgir-rec
                                              perform fol-kar2
                                               
                                            end-if
                                            end-if
                                       end-read

                                end-perform
                             end-start
                     
                             move takaskar-folio to exthrk-folio
                             start exthrk key > exthrk-anah invalid continue
                               not invalid
                                perform until fs-exthrk = "10" 
                                       read exthrk next no lock 
                                       end move  "10" to fs-exthrk
                                       not end
                                          if  takaskar-folio not =  exthrk-folio
                                            move "10" to fs-exthrk
                                            else
                                            if exthrk-ref  = takaskar-ref 
                                              and exthrk-fatura-no =
                                             takaskar-fatura
                                              move exthrk-rec to hrkgir-rec
                                              perform fol-kar2
                                               
                                            end-if
                                            end-if
                                       end-read
                                end-perform
                             end-start


                    

               end-read
          end-perform
         end-start
         close acenta.
*
 fol-kar2.
           if hrkgir-corr-depkod not = spaces and hrkgir-corr-depkod not = zeroes
                      move -1 to carpan 
                       move hrkgir-corr-depkod to depkod-anah
                  else
                      move 1 to carpan 
                      move hrkgir-depkod to depkod-anah
             end-if
                move depkod-anah to depkod2-anah
               read depkod no lock invalid exit paragraph,
                    not invalid,
                      read depkod2 no lock invalid exit paragraph
                        not invalid
                        perform depkod2-hesap-ref-ayarla
                        continue
                end-read          
             if DEPKOD-FATURA-TAKIP = "E" then
                  exit paragraph
              end-if

              if depkod-ba = "B" then 
                 compute carpan = carpan * -1
              end-if


            perform hareket-isle2

            
            compute takaskar-tutar = takaskar-tutar - ( hrkgir-tl-tutar * carpan )
            rewrite takaskar-rec invalid stop " " end-rewrite
 
            
        .

*
 hareket-isle2.   
        

                  if depkod-ba = "A" and depkod-turu = 4 then 

                        perform folfat-cari-bul


                  end-if

                          initialize borc-dep-rec,
                           if  depkod2-matrah-hesap(1:3)  = "108"
                              move "1" to kk
                           else  
                              move " " to kk
                           end-if
                         if depkod-toplam-hesap not = spaces
                            and depkod2-toplam-hesap not = spaces
                         
                           initialize borc-dep-rec,
                           if depkod2-matrah-hesap(1:3) not = "100"
                                if  depkod2-matrah-hesap(1:3)  = "108"
                                  move "1" to kk
                                else  
                                  move " " to kk
                                end-if
                                move kk to  borc-dep-corr
                                move depkod-toplam-hesap   to borc-dep-hesap
                               if depkod-matrah-ba = "A"
                                  move "A"   to borc-dep-ba
                               else
                                  move "B"   to borc-dep-ba
                               end-if
                               move depkod-toplam-hesap  to borc-dep-hesap
                               if ref-var = 1
                                  evaluate onkpara-referans-nerden
                                  when 1 
                                     move ref to borc-dep-ref
                                  when 2
                                     move ref to borc-dep-ref
                                  end-evaluate 
                               end-if
                               if isyeri-adres-tasi(1:4) = "alba" then 
                                move  hrkgir-FATURA-NO        to borc-dep-fatura-no
                               end-if
                               if isyeri-adres-tasi(1:4) = "long" then 
                                              continue
                                end-if
                               read borc-dep no lock invalid continue,
                                end-read,
                                 compute borc-dep-tutar rounded = 
                                 borc-dep-tutar + (hrkgir-tl-tutar * carpan)

                                 move "Gunluk Tahsilati Geregi" to borc-dep-aciklama
                               write borc-dep-rec invalid rewrite borc-dep-rec,
                               end-write,

                                  initialize borc-dep-rec,
                                  move kk to  borc-dep-corr
                                    if depkod-matrah-ba = "B"
                                       move "A"   to borc-dep-ba
                                    else
                                       move "B"   to borc-dep-ba
                                    end-if
                                    move depkod2-toplam-hesap   to borc-dep-hesap
                                    move  hrkgir-FATURA-NO        to borc-dep-fatura-no


                                    if ref-var = 1
                                       evaluate onkpara-referans-nerden
                                       when 1                             
                                          move ref to borc-dep-ref
                                       when 2
                                          move ref to borc-dep-ref
                                       end-evaluate 
                                       if depkod-ref > 0 and < max-ref
                                            move depkod-ref to borc-dep-ref
                                       end-if
                                    end-if
                                    if isyeri-adres-tasi(1:4) = "long" then 
                                                    continue
                                    end-if
                                    read borc-dep no lock invalid continue,
                                    end-read,
                                         compute borc-dep-tutar rounded = 
                                         borc-dep-tutar + (hrkgir-tl-tutar * carpan)
                                         initialize borc-dep-aciklama
                                         move hrkgir-FATURA-NO       to borc-dep-aciklama
                                          move hrkgir-FATURA-NO to e-o-fatura
                                                  move ref to e-ref perform efatura-gercek-bul
                                                  if e-m-fatura > spaces then 
                                                      move e-m-fatura to borc-dep-aciklama(1:20)
                                                  end-if
                                         move "ft gr tahs-"   to borc-dep-aciklama(22:)
                                         initialize ad-soyad
                                         string konuk-adi delimited by "  "
                                               " " delimited by size
                                                konuk-soyadi delimited by   "  "
                                               into ad-soyad
                                               move ad-soyad to borc-dep-aciklama(38:)
                                    write borc-dep-rec invalid rewrite borc-dep-rec,
                                    end-write,
                            else 
                              
                              if depkod-matrah-ba = "B"
                                initialize kasa-alac-dep-rec,
                                move depkod-toplam-hesap   to KASA-alac-dep-hesap
                                    if depkod-matrah-ba = "A"
                                       move "A"   to KASA-alac-dep-ba
                                    else
                                       move "B"   to KASA-alac-dep-ba
                                    end-if
                                    move depkod-toplam-hesap  to KASA-alac-dep-hesap
                                    if ref-var = 1
                                    evaluate onkpara-referans-nerden
                                    when 1                              
                                       move ref to kasa-alac-dep-ref                               
                                    when 2
                                      move ref to kasa-alac-dep-ref
                                    end-evaluate 
                                    end-if
                                    if isyeri-adres-tasi(1:4) = "alba"
                                        move  hrkgir-fatura-no        to kasa-alac-dep-fatura-no
                                    end-if
                                       move  hrkgir-fatura-no        to kasa-alac-dep-fatura-no
                                    read KASA-alac-dep no lock invalid continue,
                                    end-read,
                                         compute KASA-alac-dep-tutar rounded = 
                                         KASA-alac-dep-tutar +(hrkgir-tl-tutar * carpan)
                                         move "Gunluk iadeler Geregi" to KASA-alac-dep-aciklama
                                    write KASA-alac-dep-rec invalid rewrite KASA-alac-dep-rec,
                                    end-write,
                                            initialize kasa-alac-dep-rec,
                                    if depkod-matrah-ba = "B"
                                       move "A"   to kasa-alac-dep-ba
                                    else
                                       move "B"   to kasa-alac-dep-ba
                                    end-if
                                    move depkod2-toplam-hesap   to kasa-alac-dep-hesap
                                    move  hrkgir-fatura-no        to kasa-alac-dep-fatura-no
                                    if ref-var = 1
                                    evaluate onkpara-referans-nerden
                                    when 1 
                                       move ref to kasa-alac-dep-ref
                                    when 2
                                       move ref to kasa-alac-dep-ref
                                     
                                    end-evaluate 
                                       if depkod-ref > 0 and < max-ref
                                            move depkod-ref to kasa-alac-dep-ref
                                        end-if
                                    end-if
                            
                            
                                    read kasa-alac-dep no lock invalid continue,
                                    end-read,
                                         compute kasa-alac-dep-tutar rounded = 
                                         kasa-alac-dep-tutar + (hrkgir-tl-tutar * carpan)
                                         move  hrkgir-fatura-no        to kasa-alac-dep-aciklama(1:)
                                          move hrkgir-FATURA-NO to e-o-fatura
                                                  move ref to e-ref perform efatura-gercek-bul
                                                  if e-m-fatura > spaces then 
                                                      move e-m-fatura to kasa-alac-dep-aciklama(1:20)
                                                  end-if
                                         move "ft gr. iade-" to kasa-alac-dep-aciklama(22:)
        
*                                         string konuk-adi delimited by "  "
*                                               " " delimited by size
*                                               konuk-soyadi delimited by   "  "
*                                               into ad-soyad
*                                               move ad-soyad to kasa-alac-dep-aciklama(22:)
                                    write kasa-alac-dep-rec invalid rewrite kasa-alac-dep-rec,
                                    end-write,

                              else
                                       initialize kasa-borc-dep-rec,
                                       move depkod-toplam-hesap   to KASA-borc-dep-hesap
                                    if depkod-matrah-ba = "A"
                                       move "A"   to KASA-borc-dep-ba
                                    else
                                       move "B"   to KASA-borc-dep-ba
                                    end-if
                                    move depkod-toplam-hesap  to KASA-borc-dep-hesap
                                    if ref-var = 1
                                    evaluate onkpara-referans-nerden
                                    when 1 
                                       move ref to kasa-borc-dep-ref                               
                                    when 2
                                       move ref to kasa-borc-dep-ref
                                    end-evaluate 
                                    end-if
                                      if isyeri-adres-tasi = "alba" 
                                           move  hrkgir-fatura-no        to kasa-borc-dep-fatura-no
        
                                      end-if
                                    read KASA-borc-dep no lock invalid continue,
                                    end-read,
                                         compute KASA-borc-dep-tutar rounded = 
                                         KASA-borc-dep-tutar + (hrkgir-tl-tutar * carpan)
                                         move "Gunluk Tahsilatlar Geregi" to KASA-borc-dep-aciklama
                                    write KASA-borc-dep-rec invalid rewrite KASA-borc-dep-rec,
                                    end-write,
                                            initialize kasa-borc-dep-rec,
                                    if depkod-matrah-ba = "B"
                                       move "A"   to kasa-borc-dep-ba
                                    else
                                       move "B"   to kasa-borc-dep-ba
                                    end-if
                                    move depkod2-toplam-hesap   to kasa-borc-dep-hesap
                                    move  hrkgir-fatura-no        to kasa-borc-dep-fatura-no
                                    
                                    if ref-var = 1
                                    evaluate onkpara-referans-nerden
                                    when 1 
                                       move ref to kasa-borc-dep-ref
                                    when 2
                                       move ref to kasa-borc-dep-ref
                                    end-evaluate 
                                       if depkod-ref > 0 and < max-ref
                                            move depkod-ref to kasa-borc-dep-ref
                                        end-if
                                    end-if
                                       
                                    read kasa-borc-dep no lock invalid continue,
                                    end-read,
                                         compute kasa-borc-dep-tutar rounded = 
                                         kasa-borc-dep-tutar + (hrkgir-tl-tutar * carpan)
                                         initialize kasa-borc-dep-aciklama
                                         move  hrkgir-fatura-no        to kasa-borc-dep-aciklama(1:)
                                          move hrkgir-FATURA-NO to e-o-fatura
                                                  move ref to e-ref perform efatura-gercek-bul
                                                  if e-m-fatura > spaces then 
                                                      move e-m-fatura to kasa-borc-dep-aciklama(1:20)
                                                  end-if
                                         move "ft gr tahs-" to kasa-borc-dep-aciklama(22:)
                                          initialize ad-soyad
                                         string konuk-adi delimited by "  " 
                                                " " delimited by size
                                                konuk-soyadi delimited by "  "
                                                into ad-soyad
                                               move ad-soyad to kasa-borc-dep-aciklama(21:)
                                    write kasa-borc-dep-rec invalid rewrite kasa-borc-dep-rec,
                                    end-write,
                                 end-if
                         end-if                         
                      end-if



                         initialize borc-dep-rec,
                         if depkod-matrah-hesap not = spaces
                            and  depkod2-matrah-hesap not = spaces
                             if  depkod2-matrah-hesap(1:3) not = "100"
                              

                              initialize borc-dep-rec,
                              move kk to borc-dep-corr
                              move depkod-matrah-hesap   to borc-dep-hesap
                              if depkod-matrah-ba = "B"
                                   move "A"   to borc-dep-ba
                               else
                                  move "B"   to borc-dep-ba
                              end-if
                              move depkod-matrah-hesap  to borc-dep-hesap

                              if ref-var = 1
                               evaluate onkpara-referans-nerden
                                when 1                                  
                                 move ref to borc-dep-ref                             
                                when 2
                                  move ref to borc-dep-ref    
                               end-evaluate 
                              end-if
                              if  genel-taksilattan-muhasebe = 1   or isyeri-adres-tasi(1:4) = "alba"
                                move hrkgir-fatura-no        to borc-dep-fatura-no
                              end-if
                              if isyeri-adres-tasi(1:4) = "long" then 
                                            continue
                            end-if
                              read borc-dep no lock invalid continue,
                               end-read,
                                 compute borc-dep-tutar rounded = 
                                 borc-dep-tutar + (hrkgir-tl-tutar * carpan)
                                 move "Gunluk Tahsilatlar Geregi" to borc-dep-aciklama




                               write borc-dep-rec invalid rewrite borc-dep-rec,
                               end-write,






                                initialize borc-dep-rec,
                                 move kk to borc-dep-corr
                                if depkod-matrah-ba = "A"
                                  move "A"   to borc-dep-ba
                                else
                                  move "B"   to borc-dep-ba
                                end-if

                                move depkod2-matrah-hesap   to borc-dep-hesap
                                move hrkgir-fatura-no        to borc-dep-fatura-no


                                    
                               |||| 06.02.2019 MUKARNAS PERA HAVALE MAILORDER ISLEMI OLAYI
                               if takaskar-folio > 0 and depkod2-havale = 1 and genel2-mah-havale-virman-aktif = 1
                                          
                                          initialize konuk-rec
                                          move takaskar-folio to konuk-folio
                                          read konuk no lock invalid
                                                  continue
                                          end-read
                                          perform genel-konuk-ref-ayarla
  
                                          initialize acenta-rec
                                          move konuk-acenta to ACENTA-KODU
                                          read acenta no lock invalid
                                                 continue
                                          not invalid
                                                 if acenta-muhno2 not = Spaces 
                                                      move acenta-muhno2 to bulunan-cari
                                                 end-if
                                          end-read
                                
                                          move bulunan-cari to borc-dep-hesap depkod-matrah-hesap

                                          move 1 to borc-dep-doviz-bulma
                                                                         
                               end-if
                               |||| 06.02.2019 MUKARNAS PERA HAVALE MAILORDER ISLEMI OLAYI



                              if ref-var = 1
                                evaluate onkpara-referans-nerden
                               when 1 
                                  move ref to borc-dep-ref
                               when 2
                                 move ref to borc-dep-ref
                               end-evaluate 
                               if depkod-ref > 0 and < max-ref
                                    move depkod-ref to borc-dep-ref
                                end-if
                               end-if
                                 if isyeri-adres-tasi(1:4) = "long" then 
                                            continue
                            end-if

                                read borc-dep no lock invalid continue,
                                end-read,
                                 compute borc-dep-tutar rounded = 
                                 borc-dep-tutar + (hrkgir-tl-tutar * carpan)
********************  mesut abiii folio fat dovizli
                                  compute    borc-dep-tutar-dv rounded = 
                                 borc-dep-tutar-dv + (hrkgir-tl-tutar * carpan)
********************  mesut abiii folio fat dovizli


                                 initialize borc-dep-aciklama ad-soyad
                                 move hrkgir-fatura-no        to borc-dep-aciklama(1:)
                                  move hrkgir-FATURA-NO to e-o-fatura
                                          move ref to e-ref perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to borc-dep-aciklama(1:20)
                                          end-if
                                 move "ft gr tahs-" to borc-dep-aciklama(22:)
                                 string konuk-adi delimited by "  " 
                                        " " delimited by size
                                         konuk-soyadi delimited by "  "
                                        into ad-soyad
                                       move ad-soyad to borc-dep-aciklama(38:)
                                 move konuk-folio to borc-dep-folio
                                 move konuk-banka to borc-dep-banka-kodu 
                                 move konuk-doviz to borc-dep-doviz-kodu  
                                 move hrkgir-ref to borc-dep-pencere                                   
                                write borc-dep-rec invalid rewrite borc-dep-rec,
                                  end-write,
                            else 
                                  initialize KASA-borc-dep-rec,
                              move depkod-matrah-hesap   to KASA-borc-dep-hesap
                              if depkod-matrah-ba = "B"
                                   move "A"   to KASA-borc-dep-ba
                               else
                                  move "B"   to KASA-borc-dep-ba
                              end-if
                              move depkod-matrah-hesap  to KASA-borc-dep-hesap
                              
                              if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                                move ref to KASA-borc-dep-ref
                            when 2
                               move ref to KASA-borc-dep-ref
                            end-evaluate 
                              end-if
                                if  genel-taksilattan-muhasebe = 1  or isyeri-adres-tasi(1:4) = "alba"
                                move hrkgir-fatura-no        to kasa-borc-dep-fatura-no
                              end-if
                              read KASA-borc-dep no lock invalid continue,
                               end-read,
                                 compute KASA-borc-dep-tutar rounded = 
                                 KASA-borc-dep-tutar + (hrkgir-tl-tutar * carpan)
                                 move "Gunluk Tahsilatlar Geregi" to KASA-borc-dep-aciklama
                               write KASA-borc-dep-rec invalid rewrite KASA-borc-dep-rec,
                               end-write,
                               
                               initialize kasa-borc-dep-rec,
                                 if depkod-matrah-ba = "A"
                                     move "A"   to kasa-borc-dep-ba
                                    else
                                       move "B"   to kasa-borc-dep-ba
                                  end-if
                             
                                 move depkod2-matrah-hesap   to KASA-borc-dep-hesap
                                 move  hrkgir-fatura-no        to kasa-borc-dep-fatura-no
                              if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                               move ref to KASA-borc-dep-ref
                            when 2
                                move ref to KASA-borc-dep-ref
                            end-evaluate 
                               if depkod-ref > 0 and < max-ref
                                    move depkod-ref to KASA-borc-dep-ref
                                end-if
                               end-if



                                 read kasa-borc-dep no lock invalid continue,
                                 end-read,
                                 initialize   kasa-borc-dep-aciklama  ad-soyad
                                 compute kasa-borc-dep-tutar rounded = 
                                 kasa-borc-dep-tutar + (hrkgir-tl-tutar * carpan)
                                 move hrkgir-fatura-no        to kasa-borc-dep-aciklama(1:)
                                 move hrkgir-FATURA-NO to e-o-fatura
                                          move ref to e-ref perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to kasa-borc-dep-aciklama(1:20)
                                          end-if


                                  move "ft gr tahs-" to kasa-borc-dep-aciklama(22:)
                                 string konuk-adi delimited by "  " 
                                        " " delimited by size
                                        konuk-soyadi delimited by "  "
                                        into ad-soyad
                                       move ad-soyad to kasa-borc-dep-aciklama(35:)
                                 write kasa-borc-dep-rec invalid rewrite kasa-borc-dep-rec,
                              end-write,

                         end-if
                         
                         end-if
        
        .







kacgun-bul.
       open input takvim 
       initialize takvim-rec takas-acenta-gun
        
        move konuk-gel-tar to takvim-anah
        start takvim key > takvim-anah 
            invalid
            not invalid   
             perform until fs-takvim =  "10"  
               read takvim next no lock
                  end move "10" to fs-takvim
                  not end
                  if takvim-anah < konuk-git-tar then
                      add 1 to takas-acenta-gun
                    else
                       add 1 to takas-acenta-gun
                       move "10" to fs-takvim
                  end-if
               end-read
             end-perform
         end-start
         close takvim.

*
 takas-acenta-dovizleri-bul.
        
         open input acenfat
             initialize acenfat-rec  ramco
             move tarih to acenfat-tarih
             start acenfat key > acenfat-anah invalid
                     continue
             not invalid
             perform until fs-acenfat = "10"
             read acenfat next
             end move "10" to fs-acenfat
             not end
                       if tarih not =  acenfat-tarih                          
                               move "10" to fs-acenfat
                       else
                              
                                 | if function numval(fatdetay-fat-no) = 514155  and  acenfat-fat-no = 514155
                                 |            stop " "
                                 | end-if
                        
                                  if acenfat-fat-no = function numval(fatdetay-fat-no) and
                                     acenfat-folio = konuk-folio
                                       
                                           if acenfat-per-geceleme    > 0
                                                     compute tl-gunluk rounded =   
                                                     (ACENFAT-tl-TUTAR / acenfat-per-geceleme )
                                                     compute dv-gunluk rounded =   
                                                     tl-gunluk / (konuk-kur-degeri)
                                                     compute ramco rounded =  
                                                     ramco + ( dv-gunluk  * acenfat-per-geceleme )
                                             else
                
                                                 compute ramco rounded =  
                                                 ramco + acenfat-ger-dv-tutar |( ACENFAT-tl-TUTAR  / konuk-kur-degeri )
                
                                           end-if
                                  end-if 
                        end-if
             end-read
             end-perform
             end-start
         close acenfat.

 kredi-karsilik.
    
       initialize borc-dep-rec,
       if ( depkod-matrah-hesap not = spaces   or ara-bos = 1 )
           and  depkod2-matrah-hesap not = spaces
             if ara-bos not = 1 then
              initialize borc-dep-rec,
              move depkod-matrah-hesap   to borc-dep-hesap
              if depkod-matrah-ba = "B"
                    move "A"   to borc-dep-ba
                  else
                       move "B"   to borc-dep-ba
              end-if
          
              move depkod-matrah-hesap  to borc-dep-hesap
                 if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                             move ref to borc-dep-ref
                            when 2
                               move ref to borc-dep-ref
                            end-evaluate 
                 end-if
                  move "K" to borc-dep-kredi
                  if isyeri-adres-tasi(1:4) = "long" then 
                                            continue
                            end-if
                 read borc-dep no lock invalid continue,
                  end-read,
                       compute borc-dep-tutar rounded = borc-dep-tutar + 
                       ((fatdetay-fatura-matrah + fatdetayek-kv) * carpan )
                       move "Acenta faturalari Geregi" to borc-dep-aciklama
                  write borc-dep-rec invalid rewrite borc-dep-rec,
                  end-write,
              end-if
                   initialize borc-dep-rec,
                  move depkod2-matrah-hesap   to borc-dep-hesap
                  if depkod-matrah-ba = "A"
                     move "A"   to borc-dep-ba
                  else
                     move "B"   to borc-dep-ba
                  end-if
                  move depkod2-matrah-hesap   to borc-dep-hesap
                  move  function numval(fatdetay-fat-no)         to borc-dep-fatura-no
                   if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                             move ref to borc-dep-ref
                            when 2
                              move ref to borc-dep-ref
                            end-evaluate 
                   end-if



 
                         move "K" to borc-dep-kredi
                         move "A"    to  borc-dep-fat-tip
                         move "M"    to  borc-dep-mat-tipi
                         if isyeri-adres-tasi(1:4) = "long" then 
                                         |||| saban butraya duzelt
                                            continue
                            end-if
                  read borc-dep no lock 
                        invalid continue,
                  end-read,
                         move "A"    to  borc-dep-fat-tip
                         move "M"    to  borc-dep-mat-tipi
                         move depkod-kdv to  borc-dep-kdv   
                       compute borc-dep-tutar rounded = borc-dep-tutar + 
                       (fatdetay-fatura-matrah * carpan )
                       move function numval(fatdetay-fat-no)   to   z-8
                                 
                                 move z-8 to borc-dep-aciklama 
                        move function numval(fatdetay-fat-no) to e-o-fatura
                                          move ref to e-ref perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to borc-dep-aciklama(1:20)
                                          end-if
                       move "Ft geregi" to borc-dep-aciklama (22:)
*                      if k-kodu-tasi = "X   " and function numval (fatdetay-fat-no) =  942190 and borc-dep-tutar > 4700
*                       stop " "
*                      end-if 
                  write borc-dep-rec invalid rewrite borc-dep-rec,
                  end-write,
               end-if
                 if ( depkod-kdv-hesap not = spaces or ara-bos = 1 )
                    and  depkod2-kdv-hesap not = spaces
                     if ara-bos not = 1 then
                     initialize borc-dep-rec,
                    move depkod-kdv-hesap   to borc-dep-hesap
                    if depkod-matrah-ba = "B"
                       move "A"   to borc-dep-ba
                    else
                       move "B"   to borc-dep-ba
                    end-if
                    move depkod-kdv-hesap  to borc-dep-hesap
                    if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                             move ref to borc-dep-ref        
                            when 2
                               move ref to borc-dep-ref  
                            end-evaluate 
                   end-if
                     move "K" to borc-dep-kredi
                     if isyeri-adres-tasi(1:4) = "long" then 
                                            continue
                            end-if
                    read borc-dep no lock invalid continue,
                    end-read,
                         compute borc-dep-tutar rounded = 
                         borc-dep-tutar + (fatdetay-fatura-kdv * carpan )
                         move "Gunluk Gelirler Geregi" to borc-dep-aciklama
                    write borc-dep-rec invalid rewrite borc-dep-rec,
                    end-write,
                    end-if
                      initialize borc-dep-rec,
                    move depkod2-kdv-hesap   to borc-dep-hesap
                    if depkod-matrah-ba = "A"
                       move "A"   to borc-dep-ba
                    else
                       move "B"   to borc-dep-ba
                    end-if
                    move depkod2-kdv-hesap   to borc-dep-hesap
                    move  function numval(fatdetay-fat-no)        to borc-dep-fatura-no
                     if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                                 move ref to borc-dep-ref
                            when 2
                               move ref to borc-dep-ref
                            end-evaluate 
                     end-if
                       move "K" to borc-dep-kredi
                           move "A"    to  borc-dep-fat-tip
                           move "K"    to  borc-dep-mat-tipi
                           if isyeri-adres-tasi(1:4) = "long" then 
                           |||| saban butraya duzelt
                                            continue
                            end-if
                              move depkod-kdv to  borc-dep-kdv  
                    read borc-dep no lock invalid continue,
                    end-read,
                         move "A"    to  borc-dep-fat-tip
                         move "K"    to  borc-dep-mat-tipi
                          
                         compute borc-dep-tutar rounded = 
                         borc-dep-tutar + (fatdetay-fatura-kdv * carpan )
                         move function numval(fatdetay-fat-no)   to  z-8
                                 
                                 move z-8 to borc-dep-aciklama 
                           move function numval(fatdetay-fat-no) to e-o-fatura
                                          move ref to e-ref perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to borc-dep-aciklama(1:20)
                                          end-if
                         move "Ft geregi" to borc-dep-aciklama (22:)
*                     if k-kodu-tasi = "X   " and function numval (fatdetay-fat-no) =  942190  and borc-dep-tutar > 375
*                       stop " "
*                      end-if   
                    write borc-dep-rec invalid rewrite borc-dep-rec,
                    end-write,
                 end-if  .




                     if 
                       depkod2-kv-hesap not = spaces 
                    
            
                      initialize borc-dep-rec,
                    move depkod2-kv-hesap   to borc-dep-hesap
                    if depkod-matrah-ba = "A"
                       move "A"   to borc-dep-ba
                    else
                       move "B"   to borc-dep-ba
                    end-if
                    move depkod2-kv-hesap   to borc-dep-hesap
                    move  function numval(fatdetay-fat-no)        to borc-dep-fatura-no
                     if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                                 move ref to borc-dep-ref
                            when 2
                               move ref to borc-dep-ref
                            end-evaluate 
                     end-if
                       move "K" to borc-dep-kredi
                           move "A"    to  borc-dep-fat-tip
                           move "V"    to  borc-dep-mat-tipi
                           if isyeri-adres-tasi(1:4) = "long" then 
                           |||| saban butraya duzelt
                                            continue
                            end-if
                               move depkod-kdv to  borc-dep-kdv  
                    read borc-dep no lock invalid continue,
                    end-read,
                         move "A"    to  borc-dep-fat-tip
                         move "V"    to  borc-dep-mat-tipi
                           move depkod-kdv to  borc-dep-kdv   
                         compute borc-dep-tutar rounded = 
                         borc-dep-tutar + (fatdetayek-kv * carpan )
                         move function numval(fatdetay-fat-no)   to  z-8
                                 
                                 move z-8 to borc-dep-aciklama 
                           move function numval(fatdetay-fat-no) to e-o-fatura
                                          move ref to e-ref perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to borc-dep-aciklama(1:20)
                                          end-if
                         move "Ft geregi KC" to borc-dep-aciklama (22:)
                    
                    write borc-dep-rec invalid rewrite borc-dep-rec,
                    end-write,
                 end-if  .
*
 pencere-bul.
      | if function numval(fatdetay-fat-no) = 34142 and k-kodu-tasi = "ASYA" then stop " " end-if
       move fatdetay-rec to fatdetay2-rec    
      
        
         
      initialize pen-hata
      initialize exthrk-rec romhrk-rec
       if fatdetay-romhrk-exthrk = "E" then
                     initialize exthrk-rec 
                     if fatdetay-ger-fol = 0 
                           move fatdetay-folio to fatdetay-ger-fol
                     end-if
                      move fatdetay-ger-fol    to exthrk-folio
                      start exthrk key > exthrk-anah invalid continue
                          not invalid
                          perform until fs-exthrk = "10" 
                            read exthrk next no lock end move "10" to fs-exthrk
                               not end
                                  if exthrk-folio not = fatdetay-ger-fol
                                        move "10" to fs-exthrk
                                      else
                                        move exthrk-anah to hrk2-anah yromhrk-anah
                                      read hrk2  no lock invalid stop " "
                                      end-read

                                      if  hrk2-kaynak-folio not = function numval ( fatdetay-folio )
                                           exit perform cycle
                                       end-if
                                        if fatdetay-kdv not = 99 or function numval (fatdetay-islem)  not =   extHRK-ref
                                          or not (function numval (fatdetay-islem) > 0 and < 10)
                                          exit perform cycle
                                       end-if   
                                        if extHRK-FATURA-NO  =  function numval (fatdetay-fat-no)
                                             if exthrk-corr-depkod not = spaces and exthrk-corr-depkod not = zeroes
                                                   move -1 to carpan 
                                                    move exthrk-corr-depkod to depkod-anah
                                               else
                                                   move 1 to carpan 
                                                   move exthrk-depkod to depkod-anah
                                              end-if
                                       
                        read depkod  no lock invalid
                          stop " "
                        end-read
                        move depkod-anah to depkod2-anah
                        read depkod2 no lock invalid continue end-read
                        perform depkod2-hesap-ref-ayarla
                          move exthrk-tl-tutar to fatdetay-fatura-toplam  
 

                            move fatdetay-anah to fatdetayek-anah
                          |   if function numval(fatdetay-fat-no) = 34142 and k-kodu-tasi = "ASYA" then stop " " end-if
     initialize fatdetayek-rec 
     read fatdetayek no lock invalid continue end-read
     move depkod-kodu to depkod2-anah
     move depkod-kdv to dep-kdv
     move fatdetay-fatura-toplam to toplam-tut

      perform    yeni-tip-hesapla

     compute fatdetay-fatura-matrah rounded = matrah-tut
     compute fatdetay-fatura-kdv = kdv-tut
  
     compute  fatdetayek-kv = kv-tut 




*
*                            COMPUTE  fatdetay-fatura-matrah ROUNDED =  
*                                     fatdetay-fatura-toplam
*                                      / ((100+ DEPKOD-KDV) / 100 )
*                           COMPUTE   fatdetay-fatura-kdv  = 
*                           fatdetay-fatura-toplam - fatdetay-fatura-matrah
                            


                           PERFORM kredi-karsilik


                                        end-if
                                  end-if
                            end-read
                          end-perform
                      end-start


        
          else
          
                     initialize romhrk-rec 
                      move fatdetay-folio    to romhrk-folio
                      start romhrk key > romhrk-anah invalid continue
                          not invalid
                          perform until fs-romhrk = "10" 
                            read romhrk next no lock end move "10" to fs-romhrk
                               not end
                                  if romhrk-folio not = fatdetay-ger-fol
                                        move "10" to fs-romhrk
                                      else
                                        move romhrk-anah to hrk2-anah yromhrk-anah
                                      read hrk2  no lock invalid stop " "
                                      end-read

                                      if  hrk2-kaynak-folio not = function numval ( fatdetay-folio )
                                           exit perform cycle
                                       end-if
                                      if fatdetay-kdv not = 99 or function numval (fatdetay-islem)  not =   romHRK-ref
                                           or  not (function numval (fatdetay-islem) > 0 and < 10)
                                          exit perform cycle
                                       end-if
                                           if romHRK-FATURA-NO  =  function numval (fatdetay-fat-no)
                                        
                                                  if romhrk-corr-depkod not = spaces and romhrk-corr-depkod not = zeroes
                                                           move -1 to carpan 
                                                            move romhrk-corr-depkod to depkod-anah
                                                 else
                                                           move 1 to carpan 
                                                           move romhrk-depkod to depkod-anah
                                                end-if
                                       
                                           read depkod  no lock invalid
                                            stop " "
                                          end-read
                                           
                                          move depkod-anah to depkod2-anah
                                          read depkod2 no lock invalid continue end-read
                                           perform depkod2-hesap-ref-ayarla
                                           move romhrk-tl-tutar to fatdetay-fatura-toplam 

               | if function numval(fatdetay-fat-no) = 34142 and k-kodu-tasi = "ASYA" then stop " " end-if
                                             move fatdetay-anah to fatdetayek-anah
         initialize fatdetayek-rec 
         read fatdetayek no lock invalid continue end-read
         move depkod-kodu to depkod2-anah
         move depkod-kdv to dep-kdv
         move fatdetay-fatura-toplam to toplam-tut
       
          perform    yeni-tip-hesapla
       


         compute fatdetay-fatura-matrah rounded = matrah-tut
         compute fatdetay-fatura-kdv = kdv-tut
       
         compute  fatdetayek-kv = kv-tut 
       





*                                          COMPUTE  fatdetay-fatura-matrah ROUNDED =   fatdetay-fatura-toplam
*                                              / ((100+ DEPKOD-KDV) / 100 )
*                                         COMPUTE   fatdetay-fatura-kdv  =  fatdetay-fatura-toplam - fatdetay-fatura-matrah
*                                               
                                
                                         PERFORM kredi-karsilik
         




                                            end-if
                                       
                                  end-if
                            end-read
                          end-perform
                      end-start
         
       end-if
             
                 initialize yromhrk-rec 
                      move fatdetay-folio    to yromhrk-folio
                      start yromhrk key > yromhrk-anah invalid continue
                          not invalid
                          perform until fs-yromhrk = "10" 
                            read yromhrk next no lock end move "10" to fs-yromhrk
                               not end
                                  if yromhrk-folio not = fatdetay-folio
                                        move "10" to fs-yromhrk
                                      else
                                      if fatdetay-kdv not = 99 
                                           and (function numval (fatdetay-islem) > 0 and < 10)
                                          exit perform cycle
                                       end-if
                                       
                                       if  yROMHRK-ISLEM-TIPI not = "D" then 
                                             exit perform cycle
                                        end-if
                                        move yromhrk-anah to romhrk-anah
                                       move yromhrk-kaynak-folio to romhrk-folio
                                       read romhrk no lock 
                                           invalid 
                                               exit perform cycle
                                       end-read
                                           if romHRK-FATURA-NO  =  function numval (fatdetay-fat-no)
                                        
                                                  if yromhrk-corr-depkod not = spaces and yromhrk-corr-depkod not = zeroes
                                                           move -1 to carpan 
                                                            move yromhrk-corr-depkod to depkod-anah
                                                 else
                                                           move 1 to carpan 
                                                           move yromhrk-depkod to depkod-anah
                                                end-if
                                       
                                           read depkod  no lock invalid
                                            stop " "
                                          end-read
                                          move depkod-anah to depkod2-anah
                                          read depkod2 no lock invalid continue end-read
                                          perform depkod2-hesap-ref-ayarla
                                           move yromhrk-tl-tutar to fatdetay-fatura-toplam



                                             move fatdetay-anah to fatdetayek-anah
                                          initialize fatdetayek-rec 
                                          read fatdetayek no lock invalid continue end-read
                                          move depkod-kodu to depkod2-anah
                                          move depkod-kdv to dep-kdv
                                          move fatdetay-fatura-toplam to toplam-tut
                
                                           perform    yeni-tip-hesapla
                
                                          compute fatdetay-fatura-matrah rounded = matrah-tut
                                          compute fatdetay-fatura-kdv = kdv-tut
                                       
                                          compute  fatdetayek-kv = kv-tut 

*                                          COMPUTE  fatdetay-fatura-matrah ROUNDED =   fatdetay-fatura-toplam
*                                              / ((100+ DEPKOD-KDV) / 100 )
*                                         COMPUTE   fatdetay-fatura-kdv  =  fatdetay-fatura-toplam - fatdetay-fatura-matrah
                                               
                                
                                
                                         PERFORM kredi-karsilik
         




                                            end-if
                                       
                                  end-if
                            end-read
                          end-perform
                      end-start
             
        


            .
*
 kdv-duzelt.
           

          initialize borc-dep-rec 
          move "A" to borc-dep-fat-tip
          start borc-dep key > borc-dep-duz-anah
             invalid continue
             not invalid
             perform until fs-borc-dep = "10" 
                  read borc-dep next no lock 
                    end move  "10"  to fs-borc-dep
                    not  end
                 
                
                      if borc-dep-fat-tip = "A" or "F" then
                        if function numval(borc-dep-fatura-no) > 0 then 
                             initialize borc-fat-rec
                            

                           move   borc-dep-fatura-no to  borc-fat-fatura-no
                           move   borc-dep-kdv       to  borc-fat-kdvoran
                          read borc-fat no lock invalid continue
                           end-read
                             
                       evaluate borc-dep-mat-tipi 
                          when "M"
                              add 1 to borc-fat-matrah-adet
                               if borc-fat-matrah-adet < 40 
                                 move  borc-dep-tutar   to  borc-fat-matrah(borc-fat-matrah-adet) 
                               end-if 
                                add   borc-dep-tutar  to   borc-fat-matrahtop 
                                if  borc-dep-tutar > borc-fat-matrah-max   then 
                                    move  borc-dep-tutar to  borc-fat-matrah-max
                                     move borc-dep-anah to borc-fat-matrah-anah 
                                end-if
                          when "K" 
                              add 1 to borc-fat-kdv-adet
                               if borc-fat-kdv-adet < 40 
                                 move  borc-dep-tutar   to  borc-fat-kdv(borc-fat-kdv-adet) 
                               end-if 
                                add   borc-dep-tutar  to   borc-fat-kdvtop  
                                  if  borc-dep-tutar > borc-fat-kdv-max   then 
                                    move  borc-dep-tutar to  borc-fat-kdv-max
                                     move borc-dep-anah  to borc-fat-kdv-anah 
                                end-if
                             when "V" 
                                 
                                add   borc-dep-tutar  to   borc-fat-kv  
                                move borc-dep-anah  to borc-fat-kv-anah 

                          when other 
                             stop " "
                       end-evaluate

                          write borc-fat-rec invalid rewrite borc-fat-rec end-write
                      end-if
                      else
                          move  "10"  to fs-borc-dep
                     end-if
                end-read 
             end-perform 
          end-start

 
          initialize acenfat-rec
          move tarih     to acenfat-tarih
          start acenfat key > acenfat-anah  invalid continue
               not invalid 
                 perform until fs-acenfat = "10"
                    read acenfat next  no lock end move "10" to fs-acenfat
                                not end 
                         if acenfat-tarih > tarih 
                            move "10" to fs-acenfat
                            else
                            if acenfat-fat-no > 0 then 
                               move  acenfat-fat-no  to  borc-fat-fatura-no
                               move acenfat-kdv      to  borc-fat-kdvoran
                               read borc-fat no lock invalid continue
                                  not invalid 
                                    add acenfat-kdv8  acenfat-kdv18 to borc-fat-kdv-dogru
                                    add ACENFAT-MATRAH8  ACENFAT-MATRAH18 to   borc-fat-matrah-dogru

                                    rewrite borc-fat-rec invalid continue end-rewrite
                               end-read
                           end-if
                        end-if
                     end-read
                 end-perform
           end-start
           initialize   matrahtopic   eskifatno
           
          open i-o alsat
          initialize borc-fat-rec
          start borc-fat key > borc-fat-anah
             invalid continue
             not invalid 
              perform until fs-borc-fat = "10" 
                read borc-fat next no lock end move "10" to fs-borc-fat
                    not end 
*                            if function numval(borc-fat-fatura-no)         = 34142   and k-kodu-tasi = "ASYA"
*                                stop " " 
*                             end-if
                         if borc-fat-fatura-no not = eskifatno
                           initialize   matrahtopic   eskifatno
                           move   borc-fat-fatura-no to  eskifatno
                           end-if
                          
                        compute matrah-olmasigereken rounded = 
                               ( borc-fat-matrahtop )

      
                   
                        perform alsattan-oku
                         if alsat-fatura-buldum = 1
                              add  matrah-olmasigereken to   matrahtopic
*                        compute   kdv-olmasigereken =  
*                        ( borc-fat-matrahtop +  borc-fat-kdvtop  ) 
*                        - matrah-olmasigereken

                        compute kdv-fark  =   kdv-olmasigereken - borc-fat-kdvtop

                         compute kv-fark  =   kv-olmasigereken - borc-fat-kv

                        compute matrah-fark =  matrah-olmasigereken - borc-fat-matrahtop  
                           
***                        perform alsattan-oku
                        initialize borc-dep-rec
                        move borc-fat-kdv-anah to borc-dep-anah 
                        read borc-dep no lock invalid
                              continue 
                           not invalid
                           if kdv-fark < 5 and kdv-fark > -5
                              add  kdv-fark to borc-dep-tutar
                              rewrite borc-dep-rec invalid stop " " end-rewrite
                           end-if
                        end-read

                         initialize borc-dep-rec
                        move borc-fat-kv-anah to borc-dep-anah 
                        read borc-dep no lock invalid
                              continue 
                           not invalid
*                           if kv-fark not = 0  and k-kodu-tasi = "ASYA"
|                             stop " "
*                           end-if
                           if (kv-fark < 5 and kv-fark > -5)  |or ( kv-fark not = 0 )
                              add  kv-fark to borc-dep-tutar
                              rewrite borc-dep-rec invalid stop " " end-rewrite
                           end-if
                        end-read
*                             if function numval(borc-fat-fatura-no)         = 34142   and k-kodu-tasi = "ASYA"
*                                stop " " 
*                             end-if

                        initialize borc-dep-rec
                        move borc-fat-matrah-anah to borc-dep-anah 
                        read borc-dep no lock invalid
                              continue
                           not invalid

                            if matrah-fark < 1 and matrah-fark > -1
                              add  matrah-fark to borc-dep-tutar
                              rewrite borc-dep-rec invalid stop " " end-rewrite
                               else
                                     compute matrah-fark =  matrahtopic - borc-fat-matrahtop  
                                  if matrah-fark < 1 and matrah-fark > -1
                                      add  matrah-fark to borc-dep-tutar
                                    rewrite borc-dep-rec invalid stop " " end-rewrite

                              end-if
                             end-if
                        end-read
                     
                        end-if

                       
                       
                 end-read
               end-perform
          end-start
          close alsat
            .
*
 alsattan-oku.
        

              initialize yedek-matrah-olmasigereken   kdv-olmasigereken kv-olmasigereken
              move matrah-olmasigereken to yedek-matrah-olmasigereken  
              initialize alsat-rec  matrah-olmasigereken alsat-fatura-buldum

                   move function numval(borc-fat-fatura-no)     to   s-6
                   move s-6          to alsat-belge-no
                   move "S"          to alsat-tipi                       
                   move tarih        to alsat-tarih
            
               

             start alsat key >=  BELGE-NO-ANAHTAR invalid continue
               not invalid
                 perform until fs-alsat = "10"
                   read alsat next no lock end move "10" to fs-alsat
                     not end
                       if "S"          =  alsat-tipi and
                          tarih        = alsat-tarih and

                      function numval(borc-fat-fatura-no)  =
                      function numval(alsat-belge-no)

                                 if  alsat-kaynak-kutuphane  not =
                                 isyeri-adres-tasi 
                                  exit perform cycle 
                                end-if
                                 if  alsat-kaynak  not =  "O" 
                                 exit perform cycle
                                end-if

                           
                            if borc-fat-kdvoran  = alsat-kdv-orani 
                               add alsat-matrah to matrah-olmasigereken
                               add alsat-kdv-tutar to kdv-olmasigereken
                           
                                move 1 to alsat-fatura-buldum
                            end-if
                                add alsat-konaklama-vergisi-tutar   to kv-olmasigereken 
                         else
                         move "10" to fs-alsat
                      end-if
                   end-read
                end-perform
            end-start
            
*            if alsat-fatura-buldum = 0
*                  move yedek-matrah-olmasigereken to matrah-olmasigereken
*            end-if
                 .

*
 fatdetay-kontrol.
      
     
                     
                   |///  move function numval(fatdetay-folio) to konuk-folio  |||// onceki hali  16.11.2015  salih.y
                   move fatdetay-ger-fol to konuk-folio ||//konulduuu 
                       if konuk-folio = 344728 and k-kodu-tasi ="ASYA" then
                         stop " " 
                        end-if
                        read konuk no lock invalid
                            continue
                          not invalid
                          move konuk-fol-kodu to  fatdetay-romhrk-exthrk
                        end-read
                        perform genel-konuk-ref-ayarla
          
                 initialize romhrk-rec exthrk-rec  fatura-rec kont-hat
                 if fatdetay-depkod = "C/L"
                    if fatdetay-ger-fol = 0 
                       move fatdetay-folio to fatdetay-ger-fol
                    end-if
                    move fatdetay-ger-fol to konuk-folio 
                    read konuk no lock invalid
                         continue
                    not invalid
                       move konuk-fol-kodu to  fatdetay-romhrk-exthrk
                    end-read
                     perform genel-konuk-ref-ayarla
                   if fatdetay-ger-fol = 0 
                           move fatdetay-folio to fatdetay-ger-fol
                   end-if

                   move function numval(fatdetay-fat-no)    to zz
                   move fatdetay-ger-fol to romhrk-folio  ydk-ger-folio
                   if fatdetay-romhrk-exthrk = "R"
               start romhrk key >= ROMHRK-ANAH
                                invalid
                                   move 1 to kont-hat
                                not invalid
                              perform until fs-romhrk = "10" 
                                read romhrk  next no lock 
                                    end
                                      move "10" to fs-romhrk
                                not end 

                                  |///************07.12.2015 kaya artesmi casiona faturalar iin 
                                if ydk-ger-folio <> romhrk-folio
                                        move "10" to fs-romhrk
                                        exit perform 
                                end-if
                                ||///***********

                                initialize depkod-rec
                                move romhrk-depkod to depkod-kodu 
                                read depkod no lock invalid
                                        continue
                                end-read
                                if fatdetay-ger-fol not =  romhrk-folio
                                   move 1 to kont-hat
                                   move "10" to fs-romhrk
                                   exit perform 
                                else 
                                  if romhrk-ref = function numval(fatdetay-islem)
                                     if onkpara-city-ledger not =  romhrk-depkod  
                                       if romhrk-ba = "A" and (depkod-turu <> 2 and depkod-turu <> 4)
                                          move 1 to kont-hat
                                          exit perform
                                       end-if
                                     else
                                       if romhrk-fatura-no > 0   
                                         move 1 to kont-hat
                                         exit perform
                                       end-if
                                     end-if
                                   end-if
                              end-if
                             end-read
                             end-perform 
                            end-start
                         else
                                  move romhrk-rec to exthrk-rec
                                   start exthrk key >= exthrk-ANAH  invalid
                                            move 1 to kont-hat
                                              
                                    not invalid
                                   perform until fs-exthrk = "10" 
                                   read exthrk  next no lock 
                                       end
                                         move "10" to fs-exthrk
                                   not end 
                                    
                                  |///************07.12.2015 kaya artesmi casiona faturalar iin 
                                if ydk-ger-folio <> exthrk-folio
                                        move "10" to fs-exthrk
                                        exit perform 
                                end-if
                                ||///***********

                                initialize depkod-rec
                                move exthrk-depkod to depkod-kodu 
                                read depkod no lock invalid
                                        continue
                                end-read

                                if fatdetay-ger-fol not = exthrk-folio
                                      move 1 to kont-hat
                                      move "10" to fs-exthrk
                                      exit perform 
                                else 
                                     if exthrk-ref = function numval(fatdetay-islem)
                                              if onkpara-city-ledger not =  exthrk-depkod  
                                                     if exthrk-ba = "A" and (depkod-turu <> 2 and depkod-turu <> 4)
                                                              move 1 to kont-hat
                                                              exit perform
                                                     end-if
                                               else
                                                     if exthrk-fatura-no > 0   
                                                          move 1 to kont-hat
                                                          exit perform
                                                     end-if
                                               end-if
                                        end-if
                                   END-if 
                              end-read
                             end-perform 
                            end-start
                       end-if
                 move  function numval (fatdetay-fat-no) to fatura-no
                 read fatura no lock invalid 
                    move 1 to kont-hat
                   
                   not invalid 
                    if  FATURA-TARIHI not =  fatdetay-fat-tar 
                        move 1 to kont-hat
                         
                    end-if
                       if fatura-durumu not = "D" then 
                             move 1 to kont-hat
                            
                    end-if
                  end-read
                       exit paragraph
                 end-if

                 

                 move fatdetay-folio to romhrk-folio
                 move function numval(fatdetay-islem) to romhrk-islem 
                if  function numval(fatdetay-islem)  < 10 then 
                    exit paragraph
                end-if
                  move fatdetay-folio to konuk-folio
                   read konuk no lock invalid continue
                   end-read
                   perform genel-konuk-ref-ayarla
                   move konuk-fol-kodu to  fatdetay-romhrk-exthrk
                 if fatdetay-romhrk-exthrk = "R"
                     read romhrk  no lock invalid
                          move 1 to kont-hat
                        
                       not invalid 
                       if romhrk-fatura-no not = function numval (fatdetay-fat-no)
                            move 1 to kont-hat
                            else
                            initialize depkod-rec
                            move romhrk-depkod to depkod-anah
                              read depkod no lock invalid continue end-read
                            if depkod-turu = 2 then 
                              move romhrk-corr-depkod to depkod-anah
                                 read depkod no lock invalid continue end-read

                           end-if 
                           move romhrk-tl-tutar to  fatdetay-fatura-toplam



                                 move fatdetay-anah to fatdetayek-anah
                          initialize fatdetayek-rec 
                          read fatdetayek no lock invalid continue end-read
                          move depkod-kodu to depkod2-anah
                          move depkod-kdv to dep-kdv
                          move fatdetay-fatura-toplam to toplam-tut

                           perform    yeni-tip-hesapla

                          compute fatdetay-fatura-matrah rounded = matrah-tut
                          compute fatdetay-fatura-kdv = kdv-tut
                       
                          compute  fatdetayek-kv = kv-tut 




*                            compute  fatdetay-fatura-matrah   rounded =  
**                                     fatdetay-fatura-toplam / ( 1 + ( depkod-kdv / 100 ) )        
*                            compute fatdetay-fatura-kdv    = 
*                                    fatdetay-fatura-toplam - fatdetay-fatura-matrah 
                             move romhrk-depkod to depkod-anah
                             read depkod no lock invalid continue end-read
                       end-if
                     end-read
                 else
                   move romhrk-rec to exthrk-rec
                   read exthrk  no lock invalid 
                       move 1 to kont-hat
                      
                       not invalid 
                       if exthrk-fatura-no not = function numval (fatdetay-fat-no)
                           move 1 to kont-hat
                           else
                           initialize depkod-rec
                            move exthrk-depkod to depkod-anah
                            read depkod no lock invalid continue end-read
                            if depkod-turu = 2 then 
                              move romhrk-corr-depkod to depkod-anah
                                 read depkod no lock invalid continue end-read

                           end-if 
                           move exthrk-tl-tutar to  fatdetay-fatura-toplam



                           move fatdetay-anah to fatdetayek-anah
                          initialize fatdetayek-rec 
                          read fatdetayek no lock invalid continue end-read
                          move depkod-kodu to depkod2-anah
                          move depkod-kdv to dep-kdv
                          move fatdetay-fatura-toplam to toplam-tut

                           perform    yeni-tip-hesapla

                          compute fatdetay-fatura-matrah rounded = matrah-tut
                          compute fatdetay-fatura-kdv = kdv-tut
                       
                          compute  fatdetayek-kv = kv-tut 




*                           compute  fatdetay-fatura-matrah rounded = 
*                                     fatdetay-fatura-toplam / 
*                                     ( 1 + ( depkod-kdv / 100))        
*                           compute fatdetay-fatura-kdv = 
*                                    fatdetay-fatura-toplam - 
*                                    fatdetay-fatura-matrah    
                           move exthrk-depkod to depkod-anah
                           read depkod no lock invalid 
                                continue 
                           end-read                          
                       end-if
                     end-read
                 end-if
                 move function numval(fatdetay-fat-no) to fatura-no
                 read fatura no lock invalid 
                    move 1 to kont-hat                   
                 not invalid 
                    if FATURA-TARIHI not =  fatdetay-fat-tar 
                        move 1 to kont-hat                         
                    end-if
                    if fatura-durumu not = "D" then 
                        move 1 to kont-hat                            
                    end-if
                 end-read.


*
 fatdetay-havale-virman.
 

 
          initialize konuk-rec
          move fatdetay-folio to konuk-folio
          read konuk no lock invalid
                  continue
          end-read
          perform genel-konuk-ref-ayarla

          initialize acenta-rec
          move konuk-acenta to ACENTA-KODU
          read acenta no lock invalid
                 continue
          not invalid
                 move ACENTA-avano to bulunan-cari
          end-read





          initialize alac-dep-rec
          move "B"   to alac-dep-ba
          move "C" to alac-dep-corr
          initialize  alac-dep-fatura-no  
          move bulunan-cari to alac-dep-hesap
          read alac-dep no lock invalid
              initialize alac-dep-tutar-tl   
               alac-dep-tutar-dv   
               alac-dep-doviz-kuru 
               alac-dep-aciklama   
          end-read


          initialize  alac-dep-aciklama   alac-dep-aciklama2
          move fatdetay-fat-no  to alac-dep-aciklama2
          move fatdetay-fat-no   to e-o-fatura
          move ref to e-ref perform efatura-gercek-bul
          if e-m-fatura > spaces then 
              move e-m-fatura to alac-dep-aciklama2
          end-if


          string  "Avans Vir."  delimited by size   
              alac-dep-aciklama2 delimited by "      "
              " Ft " delimited by size
              acenta-adi delimited by "    "
          into alac-dep-aciklama
 
          compute alac-dep-tutar-tl rounded =  alac-dep-tutar-tl + 
                                   fatdetay-fatura-toplam   
          compute alac-dep-tutar-dv rounded =  alac-dep-tutar-dv + 
                                   fatdetay-fatura-toplam   
       
 
          move  takas-acenta-doviz-kuru to alac-dep-doviz-kuru
 

          if ref-var = 1
              evaluate onkpara-referans-nerden
              when 1                              
                 move ref to alac-dep-ref                               
              when 2
                 move ref to alac-dep-ref
              end-evaluate 
          end-if

          write alac-dep-rec invalid
               rewrite alac-dep-rec end-rewrite
          end-write




          initialize konuk-rec
          move fatdetay-folio to konuk-folio
          read konuk no lock invalid
                  continue
          end-read
          perform genel-konuk-ref-ayarla

          initialize acenta-rec
          move konuk-acenta to ACENTA-KODU
          read acenta no lock invalid
                 continue
          not invalid
                 if acenta-muhno2 not = Spaces 
                      move acenta-muhno2 to bulunan-cari
                 end-if
          end-read



          initialize alac-dep-rec
          move "A"   to alac-dep-ba
          move "C" to alac-dep-corr
          initialize  alac-dep-fatura-no  
          move bulunan-cari to alac-dep-hesap
          read alac-dep no lock invalid
              initialize alac-dep-tutar-tl   
               alac-dep-tutar-dv   
               alac-dep-doviz-kuru 
               alac-dep-aciklama   
          end-read

                          


          initialize  alac-dep-aciklama   alac-dep-aciklama2
          move fatdetay-fat-no  to alac-dep-aciklama2
          move fatdetay-fat-no   to e-o-fatura
          move ref to e-ref perform efatura-gercek-bul
          if e-m-fatura > spaces then 
              move e-m-fatura to alac-dep-aciklama2
          end-if


          string  "Avans Vir."  delimited by size   
              alac-dep-aciklama2 delimited by "      "
              " Ft " delimited by size
              acenta-adi delimited by "    "
          into alac-dep-aciklama

          compute alac-dep-tutar-tl rounded =  alac-dep-tutar-tl + 
                                   fatdetay-fatura-toplam   
          compute alac-dep-tutar-dv rounded =  alac-dep-tutar-dv + 
                                   fatdetay-fatura-toplam   
        
       
 
          move  takas-acenta-doviz-kuru to alac-dep-doviz-kuru
 
          if ref-var = 1
              evaluate onkpara-referans-nerden
              when 1                              
                 move ref to alac-dep-ref                               
              when 2
                 move ref to alac-dep-ref
              end-evaluate 
          end-if

          write alac-dep-rec invalid
               rewrite alac-dep-rec end-rewrite
          end-write



        |||||||||||||| yen ara hesap
                               
 
          initialize alac-dep-rec
          move "B"   to alac-dep-ba
          move "C" to alac-dep-corr
          initialize  alac-dep-fatura-no
          move depkod2-matrah-hesap  to alac-dep-hesap
          read alac-dep no lock invalid
              initialize alac-dep-tutar-tl   
               alac-dep-tutar-dv   
               alac-dep-doviz-kuru 
               alac-dep-aciklama   
          end-read



          

          initialize  alac-dep-aciklama   alac-dep-aciklama2
          move fatdetay-fat-no  to alac-dep-aciklama2
          move fatdetay-fat-no   to e-o-fatura
          move ref to e-ref perform efatura-gercek-bul
          if e-m-fatura > spaces then 
              move e-m-fatura to alac-dep-aciklama2
          end-if


 

          MOVE fatdetay-fat-no TO alac-dep-aciklama
          move "ft gr tahs-" to alac-dep-aciklama(22:)
          initialize ad-soyad
             string konuk-adi delimited by "  " 
                  " " delimited by size
                   konuk-soyadi delimited by "  "
               into ad-soyad
          move ad-soyad to alac-dep-aciklama(38:)


          compute alac-dep-tutar-tl rounded =  alac-dep-tutar-tl + 
                                   fatdetay-fatura-toplam   
         | compute alac-dep-tutar-dv rounded =  alac-dep-tutar-dv + 
         |                         fatdetay-fatura-toplam   
     
 
          move  takas-acenta-doviz-kuru to alac-dep-doviz-kuru
 

          if ref-var = 1
              evaluate onkpara-referans-nerden
              when 1                              
                 move ref to alac-dep-ref                               
              when 2
                 move ref to alac-dep-ref
              end-evaluate 
          end-if


          write alac-dep-rec invalid
               rewrite alac-dep-rec end-rewrite
          end-write



          initialize alac-dep-rec
          move "A"   to alac-dep-ba
          move "C" to alac-dep-corr
             initialize  alac-dep-fatura-no 
          move depkod2k-matrah-hesap  to alac-dep-hesap 
          read alac-dep no lock invalid
              initialize alac-dep-tutar-tl   
               alac-dep-tutar-dv   
               alac-dep-doviz-kuru 
               alac-dep-aciklama   
          end-read

 
          initialize  alac-dep-aciklama   alac-dep-aciklama2
          move fatdetay-fat-no  to alac-dep-aciklama2
          move fatdetay-fat-no   to e-o-fatura
          move ref to e-ref perform efatura-gercek-bul
          if e-m-fatura > spaces then 
              move e-m-fatura to alac-dep-aciklama2
          end-if


          MOVE fatdetay-fat-no TO alac-dep-aciklama
          move "ft gr tahs-" to alac-dep-aciklama(22:)
          initialize ad-soyad
             string konuk-adi delimited by "  " 
                  " " delimited by size
                   konuk-soyadi delimited by "  "
               into ad-soyad
          move ad-soyad to alac-dep-aciklama(38:)


          compute alac-dep-tutar-tl rounded =  alac-dep-tutar-tl + 
                                   fatdetay-fatura-toplam   
          |compute alac-dep-tutar-dv rounded =  alac-dep-tutar-dv + 
          |                         fatdetay-fatura-toplam   

 
          move  takas-acenta-doviz-kuru to alac-dep-doviz-kuru
   

          if ref-var = 1
              evaluate onkpara-referans-nerden
              when 1                              
                 move ref to alac-dep-ref                               
              when 2
                 move ref to alac-dep-ref
              end-evaluate 
          end-if

          write alac-dep-rec invalid
               rewrite alac-dep-rec end-rewrite
          end-write.
        ||||||||||||||


 kredi-bul.
       
******usendim ilk depkod cityledger a kalkan departmandir dedim  
      initialize depkod-rec
      start depkod   key >  depkod-anah
       invalid continue 
       not invalid 
       read depkod  next  no lock
       end-read
      end-start
      move depkod-anah to depkod2-anah
      read depkod2 no lock invalid continue end-read
      perform depkod2-hesap-ref-ayarla
    
****** hurmalar gala baslnca trmalad ugras bakalim
    open i-o  acenta .
    initialize fatdetay-rec.
    move tarih        to fatdetay-fat-tar.
    
    start fatdetay key not < fatdetay-anah invalid continue,
        not invalid,

       
        perform with test after until fs-fatdetay = "10",
            read fatdetay next no lock end move "10" to fs-fatdetay,
                not end,
                if fatdetay-fat-tar > tarih,
                          move "10" to fs-fatdetay
                          exit perform 
                end-if,

                |||| 06.02.2019 MUKARNAS PERA HAVALE MAILORDER ISLEMI OLAYI
                if fatdetay-depkod not = "C/L" and genel2-mah-havale-virman-aktif = 1 then 
                   
                     initialize depkod2-rec
                     move fatdetay-depkod to DEPKOD2-KODU 
                     read depkod2 no lock invalid
                            continue
                     not invalid
                            perform depkod2-hesap-ref-ayarla
                           if depkod2-havale = 1 
                               perform fatdetay-havale-virman    
                           end-if
                     end-read
                end-if
                |||| 06.02.2019 MUKARNAS PERA HAVALE MAILORDER ISLEMI OLAYI

                if fatdetay-depkod = "C/L" then 
           
                      
                      perform fatdetay-kontrol
                      if kont-hat = 1 
                if k-kodu-tasi = "ASYA"  then   stop " " end-if
                      exit perform cycle

                      end-if
                    
 
                   
                      move fatdetay-folio to konuk-folio
                      read konuk no lock invalid 
                           exit perform cycle
                      end-read
                      perform genel-konuk-ref-ayarla
                       
*                      if konuk-folio = 41802 then stop " " end-if 
*                      initialize takas-acenta-rec,
                      
                         
                                if ref-var = 1 then 
                            evaluate onkpara-referans-nerden
                            when 1 
                                         move xkonum-ref(konuk-fiyat-konumu) to sat-ref
                                         initialize kodlar02-rec
                                         move "r"           to kodlar02-tipi
                                         move xkonum-ref(konuk-oda-konumu) to zz
                                         if isyeri-adres-tasi(1:4) = "long" then 
                                            move xkonum-ref(konuk-fiyat-konumu) to zz
                                         end-if

                                         move zz                           to kodlar02-kodu
                                         read kodlar02 no lock invalid 
                                             continue 
                                         not invalid 
                                             if kodlar02-ref not = ref
                                                exit perform cycle 
                                             end-if 
                                         end-read 
                                when 2
                                  MOVE KONUK-ODANO TO  ODALAR-NO
                                  READ ODALAR NO lock invalid
                                     move 1 to odalar-referans
                                     not invalid
                                        if odalar-referans > 0 and  odalar-referans < 9
                                          continue
                                          else
                                          move 1 to odalar-referans
                                       end-if
                                  end-read
                                        if odalar-referans not = ref
                                             
                                                exit perform cycle 
                                             end-if 
                                         move ref to sat-ref
                                end-evaluate 
                                end-if 
                           initialize kur-rec takas-acenta-rec acenta-rec
                           move konuk-acenta    to takas-acenta-kodu 
                           move takas-acenta-kodu   to acenta-kodu

                          read acenta no lock invalid 
                               continue

                          end-read
****                            if konuk-folio = 479 then stop " " end-if
                           move konuk-banka      to  takas-acenta-banka
                           move konuk-doviz      to  takas-acenta-doviz
************************************   EARLY BOOK            
                             move konuk-gel-tar to takas-acenta-gel-tar
                             if konuk-eb = "E" or "1" then 
                                  move konuk-eb      to takas-acenta-eb
                               end-if
*                            move konuk-pazar   to takas-acenta-pazar
************************************ 
                                      
*                           if acenta-detay-mahsup = "E" then
*                               move konuk-odano to takas-acenta-odano
*                           end-if
                            move  function numval(fatdetay-fat-no)  to takas-acenta-fatura-no  
                           if ref-var = 1
                            evaluate onkpara-referans-nerden
                            when 1 
                             move sat-ref to takas-acenta-ref
                            when 2
                              move sat-ref to takas-acenta-ref
                            end-evaluate 
                           end-if
                           read takas-acenta no lock invalid continue
                           end-read
                           if konuk-fat-no > 0 then  
                            move konuk-folio to takas-acenta-folno

                           end-if,
                          
                           compute takas-acenta-tl-tutar rounded =  
                                   takas-acenta-tl-tutar + fatdetay-fatura-toplam
                              if konuk-kur-degeri = 0 then 
                                   move 1 to konuk-kur-degeri  
                               end-if
                               perform kacgun-bul
                               if   fatdetay-fatura-toplamdv = 0 then |||// yildiz vardi  16.11.2015  salih.y
                                
                                  perform takas-acenta-dovizleri-bul
                                  move  ramco to fatdetay-fatura-toplamdv
                               end-if                                   |||// yildiz vardi  16.11.2015  salih.y
                             compute takas-acenta-dv-tutar rounded =  
                                   takas-acenta-dv-tutar + fatdetay-fatura-toplamdv   
                              
                              move konuk-kur-degeri to takas-acenta-doviz-kuru doviz-alis
                         
                           write takas-acenta-rec invalid
                                 rewrite takas-acenta-rec end-rewrite
                           end-write,
                           move 1 to carpan
*                          if function numval(fatdetay-fat-no) = 5 then stop " "
*                          end-if
                      
                           perform pencere-bul


                end-if
            end-read,
        end-perform,
    end-start.
    open input acenfat
     perform kdv-duzelt
     close acenfat
    move spaces to evet-hayir.
    initialize takas-acenta-rec.
       open input  folref musteri
    start takas-acenta key not < takas-acenta-anah invalid continue,
        not invalid,

        move spaces to evet-hayir,
        perform with test after until evet,
            read takas-acenta next no lock end move "E" to evet-hayir,
                not end,
                   initialize alac-dep-rec,
                          modify lb-1, title = takas-acenta-kodu
                   move takas-acenta-kodu   to acenta-kodu
                   read acenta no lock invalid 
              
                               display message box 
                                "Tanimsiz Acenta",
                                icon mb_error_icon
                                title "Hata"
                                move 1 to enable-1 
                                move 0 to enable-2
                                display form1
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
                                perform dil-ayarla-proc
*/-----------------------------\*         



                                move 4 to accept-control
                                move 4 to control-id
                                exit paragraph
                                close kasa-borc-dep kasa-alac-dep borc-dep alac-dep takas-acenta takaskar
                                delete file kasa-borc-dep kasa-alac-dep borc-dep alac-dep takas-acenta   takaskar
                   not invalid

 
                        initialize alac-dep-rec
                         move "A"   to alac-dep-ba
                        move acenta-muhno       to alac-dep-hesap
                        move takas-acenta-banka to alac-dep-banka
                        move takas-acenta-doviz to alac-dep-doviz
                        move takas-acenta-kodu  to alac-dep-acenno    | Ayni hesap noya iki acenta atilirsa - mami
                        if acenta-detay-mahsup = "E" then
                           move takas-acenta-odano to alac-dep-odano
                        end-if
                       
************************************   EARLY BOOK            
                          move takas-acenta-gel-tar to alac-dep-gel-tar
                          move takas-acenta-eb      to alac-dep-eb
                          move takas-acenta-pazar    to alac-dep-pazar

                        if isyeri-adres-tasi(1:4) = "alba"
                            move takas-acenta-fatura-no        to alac-dep-fatura-no
                        end-if


************************************                           
                        move takas-acenta-folno    to konuk-folio,
                           read konuk no lock invalid 
                                move spaces to konuk-adi konuk-soyadi,
                           end-read
                            perform genel-konuk-ref-ayarla

                        |folio iersindeki sadece 1.penceredeki profilin ierisindeki muhasebe hesap kodunu almas iin yapld
                        |sealight grup odalarnda ihtiya oldu duruma gre kaldrabilirsiniz.-----R.AKIN
                         
                        initialize folref-rec
                        move konuk-folio to folref-folio
                        move 1           to folref-ref
                        read folref no lock invalid
                           continue 
                        end-read 
                           if folref-profil-anah not = spaces
                              initialize musteri-rec
*                              move folref-profil-anah to m-profil |firat m-profil bos gorunuyor.. 17/08/2020
                              move folref-profil-sirket to musteri-sirket 
                              move folref-profil-no     to musteri-no
                              read musteri no lock invalid 
                                  continue 
                              not invalid
                                   if musteri-muhasebe-kodu not = spaces  
                                      move musteri-muhasebe-kodu to  acenta-muhno2
                                   end-if 
                              end-read 
                           end-if 
                        |folio iersindeki sadece 1.penceredeki profilin ierisindeki muhasebe hesap kodunu almas iin yapld
                        |sealight grup odalarnda ihtiya oldu duruma gre kaldrabilirsiniz.-----R.AKIN

                        if acenta-muhno2  not = spaces then 
                           move "A" to alac-dep-ara
                        end-if
                       
                        if ref-var = 1 then 
                            evaluate onkpara-referans-nerden
                            when 1 
                            move ref to alac-dep-ref
                            when 2
                              move ref to alac-dep-ref
                            end-evaluate 
                        end-if
                          move "K" to alac-dep-kredi


                        ||12.04.2013 secil hanm cn 181ler fat no attrld
                     if tahakkuksuz = 1 
                          continue
                         else
                          move takas-acenta-fatura-no   to alac-dep-fatura-no
                      end-if
                      if  genel-taksilattan-muhasebe = 1  or isyeri-adres-tasi(1:4) = "alba"
                                move takas-acenta-fatura-no        to alac-dep-fatura-no
                      end-if
                      
                        read alac-dep no lock invalid
                           move alac-dep-fatura-no(3:) to alac-dep-aciklama
                             move function numval(alac-dep-fatura-no) to e-o-fatura
                                          move ref to e-ref perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to alac-dep-aciklama(1:20)
                                          end-if
                           move " Ft"                  to alac-dep-aciklama(22:3) 
                        end-read

                        compute alac-dep-tutar-tl rounded =  
                                alac-dep-tutar-tl + takas-acenta-tl-tutar
                        compute alac-dep-tutar-dv rounded =  
                                alac-dep-tutar-dv + takas-acenta-dv-tutar
                 
                        
                        move takas-acenta-gel-tar(7:2) to alac-dep-aciklama(26:2)                        
                        move "/" to alac-dep-aciklama(28:1)                        
                        move takas-acenta-gel-tar(5:2) to alac-dep-aciklama(29:2)                        
                        move "-" to alac-dep-aciklama(31:01)
                        move gun to alac-dep-aciklama(32:2)
                        move "/" to alac-dep-aciklama(34:1)
                        move ay  to alac-dep-aciklama(35:2)
                        move acenta-adi to alac-dep-aciklama(38:10)

                        if alac-dep-eb = "E" then 
                                move "E/B" to alac-dep-aciklama(50:3)       
                        end-if
                        if acenta-detay-mahsup = "E" then
                                initialize alac-dep-aciklama
                                move gun to alac-dep-aciklama (26:2)
                                move "/" to alac-dep-aciklama(28:1)
                                move ay  to alac-dep-aciklama(29:2)
                                 move "Cikislar-" to alac-dep-aciklama(35:)
                               
                          end-if 
                        move  takas-acenta-doviz-kuru to alac-dep-doviz-kuru
                       
                        if ara-bos not = 1 then
                        write alac-dep-rec invalid
                              rewrite alac-dep-rec end-rewrite  |||
                        end-write,
                        end-if
                        initialize alac-dep-rec
                        move "B"   to alac-dep-ba
                        move acenta-muhno2       to alac-dep-hesap
                        move takas-acenta-banka to alac-dep-banka
                        move takas-acenta-doviz to alac-dep-doviz
                        move takas-acenta-kodu  to alac-dep-acenno    | Ayni hesap noya iki acenta atilirsa - mami

                        if acenta-detay-mahsup = "E" then
                           move takas-acenta-odano to alac-dep-odano
                        end-if

                           move takas-acenta-fatura-no   to alac-dep-fatura-no
************************************   EARLY BOOK            
*                        move takas-acenta-gel-tar to alac-dep-gel-tar
                        move takas-acenta-eb      to alac-dep-eb
*                        move takas-acenta-pazar   to alac-dep-pazar

************************************                           
                        move takas-acenta-folno    to konuk-folio,
                           read konuk no lock invalid 
                                move spaces to konuk-adi konuk-soyadi,
                           end-read
                            perform genel-konuk-ref-ayarla

                        move takas-acenta-fatura-no   to alac-dep-fatura-ACK
                        if ref-var = 1 then
                            evaluate onkpara-referans-nerden
                            when 1 
                            move xkonum-ref(konuk-fiyat-konumu) to sat-ref                       
                            move sat-ref to alac-dep-ref
                            when 2
                                move ref to alac-dep-ref sat-ref
                            end-evaluate 
                                         
                        end-if
                         move "K" to alac-dep-kredi 
                        read alac-dep no lock invalid
*                        
                           move takas-acenta-fatura-no(3:)  to alac-dep-aciklama
                             move function numval(takas-acenta-fatura-no) to e-o-fatura
                                          move ref to e-ref perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to alac-dep-aciklama(1:20)
                                          end-if
                           move " Ft"         to alac-dep-aciklama(22:3) 
                        end-read

                        compute alac-dep-tutar-tl rounded =  
                                alac-dep-tutar-tl + takas-acenta-tl-tutar
                        compute alac-dep-tutar-dv rounded =  
                                alac-dep-tutar-dv + takas-acenta-dv-tutar
                 
                        
                        move takas-acenta-gel-tar(7:2) to alac-dep-aciklama(26:2)                        
                        move "/" to alac-dep-aciklama(28:1)                        
                        move takas-acenta-gel-tar(5:2) to alac-dep-aciklama(29:2)                        
                        move "-" to alac-dep-aciklama(31:01)
                        move gun to alac-dep-aciklama(32:2)
                        move "/" to alac-dep-aciklama(34:1)
                        move ay  to alac-dep-aciklama(35:2)
                        move acenta-adi to alac-dep-aciklama(38:10)
                        if alac-dep-eb = "E" then 
                                move "E/B" to alac-dep-aciklama(50:3)       
                        end-if
                        if acenta-detay-mahsup = "E" then
                        initialize alac-dep-aciklama
                        move gun to alac-dep-aciklama (26:2)
                        move "/" to alac-dep-aciklama(28:1)
                        move ay  to alac-dep-aciklama(29:2)
*                        move "Cikislar-" to alac-dep-aciklama(17:)
                        move acenta-kodu to alac-dep-aciklama(38:4)
                        move takas-acenta-odano to o-kisa 
            perform oda-uzat
            move o-uzun to  alac-dep-aciklama(37:5),
                        move konuk-adi        to alac-dep-aciklama(43:7)
                        move konuk-soyadi     to alac-dep-aciklama(51:)
                          end-if 
                        move  takas-acenta-doviz-kuru to alac-dep-doviz-kuru
                        write alac-dep-rec invalid
                              rewrite alac-dep-rec end-rewrite
                        end-write,
     
 
                        if (takas-acenta-eb = "E" or acenta-coutkuru-kullanma = 1 ) and acenta-av-oran > 0                
                          AND ACENTA-AVANO NOT = SPACES then
                       
                             move "K" to alac-dep-kredi 
                           perform  acenta-avans-yaz
                        end-if
                   end-read,
            end-read,
        end-perform,
    end-start.
    close acenta folref musteri.
    


*
 acenta-avans-yaz.
        
          
          if alac-dep-ba = "B"
              move "A"   to alac-dep-ba
             else
              move "B"   to alac-dep-ba
          end-if
          move "C" to alac-dep-corr
             initialize  alac-dep-fatura-no   |*
          read alac-dep no lock invalid
              initialize alac-dep-tutar-tl   
               alac-dep-tutar-dv   
               alac-dep-doviz-kuru 
               alac-dep-aciklama   
            
         
          end-read
            initialize  alac-dep-aciklama   alac-dep-aciklama2
            move   konuk-fat-no  to alac-dep-aciklama2
             move konuk-fat-no   to e-o-fatura
            move ref to e-ref perform efatura-gercek-bul
            if e-m-fatura > spaces then 
                move e-m-fatura to alac-dep-aciklama2
            end-if

            if acenta-coutkuru-kullanma = 1
               string  
                    "Avans Vir."  delimited by size   
                      alac-dep-aciklama2 delimited by "       "
                      " Ft " delimited by size
                       acenta-adi delimited by "    "
                   into alac-dep-aciklama
            else
               string  
                    "EB Avans Vir."  delimited by size   
                      alac-dep-aciklama2 delimited by "       "
                      " Ft " delimited by size
                       acenta-adi delimited by "    "
                   into alac-dep-aciklama
              
            end-if
          move konuk-fat-no to alac-dep-eb-virman-fat-no
          if acenta-av-oran > 98 then 
             compute alac-dep-tutar-tl rounded =  alac-dep-tutar-tl + 
                                      takas-acenta-tl-tutar 
             compute alac-dep-tutar-dv rounded =  alac-dep-tutar-dv + 
                                      takas-acenta-dv-tutar 
          else
             compute alac-dep-tutar-tl rounded =  alac-dep-tutar-tl + 
                                   ( takas-acenta-tl-tutar * ((acenta-av-oran) / 100))
             compute alac-dep-tutar-dv rounded =  alac-dep-tutar-dv + 
                                   ( takas-acenta-dv-tutar * (( acenta-av-oran) / 100))
          end-if               
*********************************   

                          
      
                      
                        
                       
                        
*                        move alac-dep-pazar        to alac-dep-aciklama(35:2)
*                        if alac-dep-pazar not = spaces

*                                move "Knk" to alac-dep-aciklama(38:) 
*                                else 
*                                move "Extra Harcamalari" to alac-dep-aciklama(22:)       
*                        end-if
*********************************** 
                                 
        move  takas-acenta-doviz-kuru to alac-dep-doviz-kuru
        move konuk-fat-no  to alac-dep-fatura-no-sanal
        if e-m-fatura not = spaces
            move e-m-fatura to  alac-dep-fatura-no-sanal
        end-if    

          write alac-dep-rec invalid
               rewrite alac-dep-rec end-rewrite
         end-write,
          .

          if alac-dep-ba = "B"
              move "A"   to alac-dep-ba
             else
              move "B"   to alac-dep-ba
          end-if
          move acenta-avano       to alac-dep-hesap
           move "C" to alac-dep-corr
          read alac-dep no lock invalid
               initialize alac-dep-tutar-tl   
               alac-dep-tutar-dv   
               alac-dep-doviz-kuru 
               alac-dep-aciklama   
             
             
          end-read
           initialize  alac-dep-aciklama2 alac-dep-aciklama
           move konuk-fat-no to   alac-dep-aciklama2
             move konuk-fat-no to e-o-fatura
                                          move ref to e-ref 
                                          perform efatura-gercek-bul
                                          if e-m-fatura > spaces then 
                                              move e-m-fatura to alac-dep-aciklama2
                                          end-if
                 
          
            if acenta-coutkuru-kullanma = 1
               string  
                     "Avans Vir."  delimited by size   
                       alac-dep-aciklama2 delimited by "      "
                       " Ft " delimited by size
                        acenta-adi delimited by "    "
                    into alac-dep-aciklama
               
            else
               string  
                     "EB Avans Vir."  delimited by size   
                       alac-dep-aciklama2 delimited by "      "
                       " Ft " delimited by size
                        acenta-adi delimited by "    "
                    into alac-dep-aciklama
            end-if
            move konuk-fat-no to alac-dep-eb-virman-fat-no

        if  acenta-av-oran > 98
          compute alac-dep-tutar-tl rounded =  alac-dep-tutar-tl + 
                                 takas-acenta-tl-tutar 
          compute alac-dep-tutar-dv rounded =  alac-dep-tutar-dv + 
                                takas-acenta-dv-tutar 

           else

          compute alac-dep-tutar-tl rounded =  alac-dep-tutar-tl + 
                                ( takas-acenta-tl-tutar * ((acenta-av-oran) / 100))
          compute alac-dep-tutar-dv rounded =  alac-dep-tutar-dv + 
                                ( takas-acenta-dv-tutar * (( acenta-av-oran) / 100))

       end-if                 
*********************************                        
        
                        
*                        move alac-dep-pazar        to alac-dep-aciklama(35:2)
*                        if alac-dep-pazar not = spaces
*                                move "Knk" to alac-dep-aciklama(38:) 
*                                else 
*                                move "Extra Harcamalari" to alac-dep-aciklama(22:)       
*                        end-if
***********************************   
       move konuk-fat-no  to alac-dep-fatura-no-sanal
        if e-m-fatura not = spaces
            move e-m-fatura to  alac-dep-fatura-no-sanal
        end-if                              
        move  takas-acenta-doviz-kuru to alac-dep-doviz-kuru
       
        write alac-dep-rec invalid
               rewrite alac-dep-rec end-rewrite
        end-write,

    .   
*
     .
*
 acc-ref-Bef-Procedure.
    initialize nereden.
*
 acuserve-adres-aktar.
  
    move muhasebe-entegre-sirketi  to CARI-DOSYA-adres         
                         ISLENEN-DOSYA-adres      
                         HESAP-DOSYA-adres        
                         MAHSUP-DOSYA-adres       
                         genelfis-DOSYA-adres     
                         REFERANS-DOSYA-adres     
                         mgenel-DOSYA-adres       
                         genelfis-DOSYA-adres 
                         alsat-dosya-adres
                         efat2onb-dosya-adres
                         FATKAPAT-DOSYA-ADRES
                         move "muha" to genelfis-DOSYA(16:4)
            

    move all low-values to  alsat-acuserve-dosya
                           efat2onb-acuserve-dosya
                           CARI-ACUSERVE-DOSYA       
                           ISLENEN-ACUSERVE-DOSYA    
                           HESAP-ACUSERVE-DOSYA      
                           MAHSUP-ACUSERVE-DOSYA     
                           genelfis-ACUSERVE-DOSYA   
                           REFERANS-ACUSERVE-DOSYA   
                           Mgenel-ACUSERVE-DOSYA   
                           fatkapat-acuserve-dosya
                           genelfis-ACUSERVE-DOSYA  
                           ip-no.


    inspect genel-muha-uzak-ip 
            replacing trailing spaces by low-values.

    if genel-muha-uzak-ip <> low-values
       move all low-values to ip-no
       string ip-no,
              "@" delimited by low-values
              genel-muha-uzak-ip delimited by low-values
              ":" delimited by low-values
              into ip-no
    end-if

    string mgenel-acuserve-dosya,
           ip-no                        delimited by low-values
           mgenel-dosya                    delimited by low-values
           into mgenel-acuserve-dosya.
    string genelfis-acuserve-dosya,
           ip-no                        delimited by low-values
           genelfis-dosya                 delimited by low-values
           into genelfis-acuserve-dosya.

    
    string hesap-acuserve-dosya,



           ip-no                        delimited by low-values
           hesap-dosya                 delimited by low-values
           into hesap-acuserve-dosya.
    string mahsup-acuserve-dosya,
           ip-no                        delimited by low-values
           mahsup-dosya                 delimited by low-values
           into mahsup-acuserve-dosya.
    string cari-acuserve-dosya,
           ip-no                        delimited by low-values
           cari-dosya                 delimited by low-values
           into cari-acuserve-dosya.
    string islenen-acuserve-dosya,
           ip-no                        delimited by low-values
           islenen-dosya               delimited by low-values
           into islenen-acuserve-dosya.
    string referans-acuserve-dosya,
           ip-no                        delimited by low-values
           referans-dosya                delimited by low-values
           into referans-acuserve-dosya.
     string efat2onb-acuserve-dosya,
           ip-no                        delimited by low-values
           efat2onb-dosya                delimited by low-values
           into efat2onb-acuserve-dosya.
     string alsat-acuserve-dosya,
           ip-no                        delimited by low-values
           alsat-dosya                delimited by low-values
           into alsat-acuserve-dosya.
     string fatkapat-acuserve-dosya,
           ip-no                        delimited by low-values
           fatkapat-dosya                delimited by low-values
           into fatkapat-acuserve-dosya.
    
    inspect cari-acuserve-dosya        replacing  all spaces by low-values
     inspect alsat-acuserve-dosya        replacing  all spaces by low-values
     inspect efat2onb-acuserve-dosya        replacing  all spaces by low-values
    inspect islenen-acuserve-dosya     replacing  all spaces by low-values
    inspect hesap-acuserve-dosya       replacing  all spaces by low-values
    inspect mahsup-acuserve-dosya      replacing  all spaces by low-values
    inspect genelfis-acuserve-dosya    replacing  all spaces by low-values
    inspect referans-acuserve-dosya    replacing  all spaces by low-values
    inspect mgenel-acuserve-dosya      replacing  all spaces by low-values
    inspect fatkapat-acuserve-dosya    replacing  all spaces by low-values
    inspect genelfis-acuserve-dosya    replacing  all spaces by low-values.
*
 Form1-Aft-Initdata.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\* 



  
     .

* *
 efatura-gercek-bul.

        if e-o-fatura = zeroes
              initialize e-m-fatura
              exit paragraph
        end-if

        initialize efat2onb-rec  e-m-fatura
        set efat2onb-tipi-onburo to true
        move  e-ref      to  efat2onb-referans 
        initialize kodlar02-rec
            move "r"           to kodlar02-tipi
            move e-ref   to zz
            move zz           to kodlar02-kodu
            read kodlar02 no lock invalid 
                continue 
            not invalid 
                move kodlar02-ref to efat2onb-referans
            end-read              
         | if k-kodu-tasi = "X   " or "ASYA" then

                move  e-ref      to  efat2onb-referans 
        |  end-if
        move tarih to  efat2onb-fatura-tarihi
        move all "0" to   efat2onb-onburo-fatura-no
        move e-o-fatura to efat2onb-onburo-fatura-no2           
          
             read efat2onb  no lock invalid  
              |   if k-kodu-tasi = "X   " or "ASYA" then
                     
                       move 1 to  efat2onb-referans 
                       read efat2onb  no lock invalid  
                              move 3 to  efat2onb-referans 
                           read efat2onb  no lock invalid
                                   move 2 to  efat2onb-referans 
                                   read efat2onb  no lock invalid 
                                      continue                                
                                   not invalid 
                                       if  function numval (efat2onb-muhasebe-fatura-no(8:))  > 0 
                                          move  efat2onb-muhasebe-fatura-no to   e-m-fatura
                                       end-if   
                                   end-read
                                
                             not invalid 
                               if  function numval (efat2onb-muhasebe-fatura-no(8:))  > 0 
                               move  efat2onb-muhasebe-fatura-no to   e-m-fatura
                             end-if   

                           end-read
                         not invalid 
                         if  function numval (efat2onb-muhasebe-fatura-no(8:))  > 0 
                             move  efat2onb-muhasebe-fatura-no to   e-m-fatura
                          end-if   
                     end-read
            |     end-if
             
            
                not invalid 
                if  function numval (efat2onb-muhasebe-fatura-no(8:))  > 0 
                         move  efat2onb-muhasebe-fatura-no to   e-m-fatura

                end-if
                 
            end-read
       .

*
 folfat-cari-bul.
     
*    exit paragraph
****************************
    open input firma  
        initialize bulunan-cari acenta-rec firma-rec 
            move konuk-acenta to acenta-kodu  
            move konuk-firma  to firma-kodu
            read firma no lock invalid
                      continue
            not invalid
                    if firma-muhno2 not = Spaces 
                      move  firma-muhno2 to bulunan-cari
                    end-if
            end-read
*               if bulunan-cari = spaces
*                  initialize folref-rec bulunan-cari
*                  move hrkgir-ref to folref-ref
*                  move konuk-folio to folref-folio
*                  read folref no lock invalid 
*                      continue
*                  not invalid 
*                     if folref-profil-anah not = spaces
*                         initialize musteri-rec 
*                         move folref-profil-anah to m-profil
*                         read musteri no lock invalid 
*                             continue 
*                         not invalid 
*                              move musteri-muhasebe-kodu to bulunan-cari
*                         end-read 
*                     end-if 
*                  end-read 
*               end-if 
  
               if bulunan-cari = spaces
                   read acenta no lock invalid
                      continue
                      not invalid
                    if acenta-muhno2 not = Spaces 
                      move  acenta-muhno2 to bulunan-cari
                    end-if
                  end-read
               end-if
     close firma                   
*     if bulunan-cari not = spaces                 
*         if  depkod2-matrah-hesap = spaces
*               move  bulunan-cari to  depkod2-matrah-hesap depkod-matrah-hesap  
*         end-if
*     end-if
      if bulunan-cari not = spaces                 
        if  depkod2-matrah-hesap not > " 12"
            move  bulunan-cari to  depkod2-matrah-hesap           
        else 
            move  bulunan-cari to  depkod-matrah-hesap
       end-if.
*
 mahsup-dys-yaz.
    open i-o genelfis
    initialize genelfis-rec
    move 1  to genelfis-anahtar
    read genelfis no lock invalid 
         continue 
    not invalid 
         add 1         to ekran-fis-1
         rewrite genelfis-rec end-rewrite 
    end-read 
    close genelfis
    move ekran-fis-1   to takasdys-no
    open output takasdys close takasdys open i-o takasdys
         
    open input fatdetay  kodlar02 efat2onb
    initialize fatdetay-rec
    move tarih   to fatdetay-fat-tar
    start fatdetay key not < fatdetay-anah invalid 
         continue 
    not invalid 
    perform until fs-fatdetay = "10"
    read fatdetay next no lock end move "10"  to fs-fatdetay
    not at end 
         if fatdetay-fat-tar <> tarih
             exit perform 
         end-if      
         initialize takasdys-rec
         move function numval(fatdetay-fat-no) to e-o-fatura 
         move fatdetay-fat-no   to takasdys-fat-no
         move ref               to e-ref 
         perform efatura-gercek-bul
         if e-m-fatura > spaces
            move e-m-fatura       to takasdys-fat-no
         end-if 
         move fatdetay-folio      to takasdys-folio
         read takasdys no lock invalid 
               continue 
         end-read 
         
         write takasdys-rec invalid  
              rewrite takasdys-rec end-rewrite 
         end-write 
    end-read 
    end-perform
    end-start
    close fatdetay 
         
    open input konuk doviz  
    open i-o mahsup
    initialize takasdys-rec
    start takasdys key not < takasdys-anah invalid 
         continue 
    not invalid 
    perform until fs-takasdys = "10"
    read takasdys next no lock end move "10"  to fs-takasdys
    not at end 
            initialize konuk-rec temp-dys-no
            move function numval(takasdys-folio)  to konuk-folio
            read konuk no lock invalid 
                 continue 
            not invalid               
                move konuk-dys-fis  to temp-dys-no
                if temp-dys-no = spaces
                   move  0  to temp-dys-no
                end-if 
            end-read 
            if temp-dys-no > 0     
               perform mahsup-bul
            end-if 
    end-read 
    end-perform
    end-start

    if genel2-mahsup-matrah-kdv-degistirilsin = 1  or genel2-muh-acik-acendov = 1
             
            initialize takasdys-rec yedek-dys-no yedek-dys-no
            start takasdys key not < takasdys-anah invalid 
                 continue 
            not invalid 
            perform until fs-takasdys = "10"
            read takasdys next no lock end move "10"  to fs-takasdys
            not at end       
                   if yedek-dys-no not = takasdys-fat-no
                       perform mahsup-bul-aciklama
                   end-if
                   move takasdys-fat-no to yedek-dys-no
            end-read 
            end-perform
            end-start
    end-if 
   
    close takasdys konuk mahsup efat2onb kodlar02 doviz

    delete file takasdys.

*
 mahsup-bul-aciklama.
         
    initialize mahsup-rec  yedek-aciklama  yedek-acenta-adi
    move takasdys-fat-no                               to mahsup-belge-no
***    move "120"                                         to MAHSUP-HESAP-KODU(1:3)
    start mahsup key not < mahsup-fatura-cari-key invalid 
        continue 
    not invalid 
    perform until fs-mahsup = "10"
    read mahsup next no lock end move "10"  to fs-mahsup
    not at end 
          if mahsup-belge-no <> takasdys-fat-no
              exit perform 
          end-if

          if low-values not = MAHSUP-OZEL-ACIKLAMA
              exit perform cycle 
          end-if
 
          |if "ELA2021000000213" = takasdys-fat-no 
          |      stop yedek-aciklama
          |end-if


          if mahsup-nereden <> "O"
              exit perform cycle 
          end-if 
          if MAHSUP-HESAP-KODU(1:3) <> "120" and 
             MAHSUP-HESAP-KODU(1:3) <> "125"  
                 exit perform cycle 
          end-if 
*          if MAHSUP-TUTAR-DV not > 0 
*             exit perform cycle 
*          end-if

          initialize doviz-rec
          move MAHSUP-DOVIZ-KODU to doviz-kodu
          read doviz no lock invalid 
              move "TL" to  d-kisa-adi
          end-read 

          
          if MAHSUP-TUTAR-DV > 0 
             move MAHSUP-TUTAR-DV to etut  
          else
             move MAHSUP-TUTAR to etut  
          end-if 

          if genel2-muh-refsiz-onb-refli = 1 or genel2-muh-acik-acendov = 1
            initialize yedek-acenta-adi
            move MAHSUP-ACIKLAMA(38:10)  to yedek-acenta-adi
            initialize MAHSUP-ACIKLAMA(18:)

            evaluate mahsup-hesap-kodu(1:3) 
            when "120"
                    move etut          to MAHSUP-ACIKLAMA(20:12)             
                    move d-kisa-adi    to MAHSUP-ACIKLAMA(34:5)
 
*            when "600"
*               move yedek-acenta-adi   to MAHSUP-ACIKLAMA(18:)
*            when "391"
*               move yedek-acenta-adi   to MAHSUP-ACIKLAMA(18:)
            when other 
                    move etut          to MAHSUP-ACIKLAMA(20:12)             
                    move d-kisa-adi    to MAHSUP-ACIKLAMA(34:5)

            end-evaluate 
          else

            move etut          to MAHSUP-ACIKLAMA(60:12)
            move d-kisa-adi    to MAHSUP-ACIKLAMA(73:4)
          end-if

          move MAHSUP-ACIKLAMA to yedek-aciklama 

          exit perform 
    end-read 
    end-perform
    end-start

    if yedek-aciklama <> spaces 

                  |if "LWA2021000000665" = takasdys-fat-no  or 
                  |   "LWA2021000000664" = takasdys-fat-no 
                  |        stop yedek-aciklama
                  |  end-if


            initialize mahsup-rec  
            move takasdys-fat-no                               to mahsup-belge-no
            start mahsup key not < mahsup-fatura-cari-key invalid 
                continue 
            not invalid 
            perform until fs-mahsup = "10"
            read mahsup next no lock end move "10"  to fs-mahsup
            not at end 
                  if mahsup-belge-no <> takasdys-fat-no
                      exit perform 
                  end-if
                  if low-values not = MAHSUP-OZEL-ACIKLAMA
                      exit perform cycle 
                  end-if
                  if mahsup-nereden <> "O"
                      exit perform cycle 
                  end-if 
                  if MAHSUP-HESAP-KODU(1:3) = "120"
                      move yedek-aciklama to MAHSUP-ACIKLAMA 
                      rewrite mahsup-rec invalid continue end-rewrite
                  end-if 
                  if MAHSUP-HESAP-KODU(1:3) = "125"
                      move yedek-aciklama to MAHSUP-ACIKLAMA 
                      rewrite mahsup-rec invalid continue end-rewrite
                  end-if 
      
                  if MAHSUP-HESAP-KODU(1:3) = "600" 
                      if genel2-muh-refsiz-onb-refli = 1 or genel2-muh-acik-acendov  = 1
                        initialize mahsup-aciklama(18:)
                        move yedek-acenta-adi        to MAHSUP-ACIKLAMA(21:)                                                  
                      else
                        move yedek-aciklama to  MAHSUP-ACIKLAMA
                      end-if
                      rewrite mahsup-rec invalid continue end-rewrite
                  end-if
                  if MAHSUP-HESAP-KODU(1:3) = "391"
                      if genel2-muh-refsiz-onb-refli = 1  or genel2-muh-acik-acendov  = 1
                        initialize mahsup-aciklama(18:)
                        move yedek-acenta-adi        to MAHSUP-ACIKLAMA(21:)                                                  
                      else
                        move yedek-aciklama to  MAHSUP-ACIKLAMA
                      end-if                      
                      rewrite mahsup-rec invalid continue end-rewrite
                  end-if
                     
            end-read 
            end-perform
            end-start       
    end-if
    
     initialize mahsup-rec  
     move takasdys-fat-no                               to mahsup-belge-no
     start mahsup key not < mahsup-fatura-cari-key invalid 
         continue 
     not invalid 
     perform until fs-mahsup = "10"
     read mahsup next no lock end move "10"  to fs-mahsup
     not at end 
           if mahsup-belge-no <> takasdys-fat-no
               exit perform 
           end-if
           if low-values = MAHSUP-OZEL-ACIKLAMA
                  initialize MAHSUP-OZEL-ACIKLAMA
                  rewrite mahsup-rec invalid continue end-rewrite
           end-if           
     end-read 
     end-perform
     end-start.
 


*
 mahsup-bul.
    initialize mahsup-rec 
*    move function numval(takasdys-fat-no) to dokuz8
*    move dokuz8                           to z8
*    move z8                               to mahsup-belge-no

 
    move takasdys-fat-no                               to mahsup-belge-no
    start mahsup key not < mahsup-fatura-cari-key invalid 
        continue 
    not invalid 
    perform until fs-mahsup = "10"
    read mahsup next no lock end move "10"  to fs-mahsup
    not at end 
          if mahsup-belge-no <> takasdys-fat-no
              exit perform 
          end-if 
          initialize temp-link-dys-to-fis
          if mahsup-dys-no > 0                
             move mahsup-dys-no  to temp-link-dys-to-fis
          else 
             move zeroes         to temp-link-dys-to-fis
          end-if 

          perform dys-muhasebe-yaz
          if link-dys-to-fis > 0          
             move link-dys-to-fis      to mahsup-dys-no
             rewrite mahsup-rec end-rewrite 
          end-if
 
    end-read 
    end-perform
    end-start.

*
  dys-muhasebe-yaz.
    initialize link-dys
    set link-dys-moduller-arasi-kopya  to true
    set link-dys-belge-tip1-voucher     to true  | yada  set link-dys-anah-tip1-earsiv to true
    move temp-dys-no                   to link-dys-fis |(hangi dys kaydini diger module yazacaksan onun dys fis no's)
    move mahsup-anahtar                to link-dys-from-anahtar |(yani mahsuba yaziyorsan amhsup-anahtar konuka yaziyorsan konuk-folio gibi ..)
    move "otel"                        to link-dys-from-modul |(otel dys'sinden muhasebe dys'sine bilgi gonderirlen)
    move "onbmahfe"                    to link-dys-from-prog |( islemin yaldg programn isi)
    move "mahsup"                      to link-dys-from-dosya |(otel'den mahsuyp dosyasna kayit atilirken)
    move mahsup-tarih                  to link-dys-anahtar-tarih
 
    move "muha"                        to link-dys-to-modul |( hangi moduldeki dys'ye yazacak)
    move muhasebe-entegre-sirketi             to link-dys-to-sirket |(hangi muhasebe sirketine yazacak)
    move isyeri-adres-tasi             to link-dys-from-sirket |(otel'de hangi asirketten alincak bilgiler)
*
    move temp-link-dys-to-fis          to link-dys-to-fis
    if genel-muha-uzak-ip not = spaces 
       move genel-muha-uzak-ip         to link-dys-to-ip
    end-if 
    call "/asya/ytl/obj/otel/dys.asy" using link-dys
    on exception 
         perform callerr-proc
    not on exception
    cancel "/asya/ytl/obj/otel/dys.asy"
    end-call
 
    if link-dys-donus-ok
        continue 
****     display message box link-dys-fis
****     display message box "islem tamamdir ..."
    else
       continue
****     display message box "ariza ..."
    end-if.


***
 devremulk-mahsup.
 
         open input fatura  odemeler musteri  kodlar02 efat2onb
         open i-o islenen mahsup devremulk
         initialize fatura-rec devremulk-fat-var
         move tarih to FATURA-TARIHI
         move "D"  to fatura-durumu
         start fatura key > FATURA-ANAH2 invalid continue
           not invalid 
             perform until fs-fatura = "10"
               read fatura next no lock end move "10" to fs-fatura
                   not end 
                     if tarih <> FATURA-TARIHI
                         exit perform 
                     end-if
                     if fatura-sira = 0 
                     if "D"  <>  fatura-durumu   exit perform end-if




                     if FATURA-TIPI = "Y" | FATURA-TIPI = "D" or   
                         perform tek-fatura
                         move 1 to devremulk-fat-var
                     end-if
                     end-if
                 end-read
               end-perform 
         end-start
        close fatura devremulk odemeler islenen musteri mahsup  kodlar02 efat2onb
        if devremulk-fat-var = 1
            display message box "Devremulk Kayitlari Muhasebelestirildi."
        end-if.
*
 tek-fatura.

     perform mahsup-no-al 
     initialize fis-sira-sakla
      if FATURA-TIPI = "D"
        move " nolu Devremulk "  to   tip-uzun
      else
         move " nolu Aidat "  to   tip-uzun
     end-if
        move fatura-folio to devremulk-no
        read devremulk no lock invalid
          continue
          not invalid


             move devremulk-profil-sirket to ps1
             move devremulk-profil-no     to mis-no
        
 
             initialize musteri-rec  
             move ps1                   to musteri-sirket
             move mis-no                to musteri-no
             read musteri no lock invalid 
                  move "      "         to musteri-adi musteri-soyadi
             end-read 

           | if k-kodu-tasi = "ASYA"    stop " "  end-if
               move FATURA-NO to e-o-fatura
         move ref to e-ref 
         perform efatura-gercek-bul
         if e-m-fatura > spaces then 
             move e-m-fatura to mahsup-BELGE-NO
         end-if



              initialize   linkler

         
          move  FATURA-G-TOPLAM   to  link-tl(1)
          move "B" to link-ba(1)
          string musteri-adi delimited by "    "
                " " delimited by size 
                musteri-soyadi  delimited by "    "
                " " delimited by size 
                  e-m-fatura  delimited by size 
                 tip-uzun  delimited by "   "
                 " Ft geregi " delimited by size 
                    into           link-aciklama(1)   
        move devremulk-hesap-no    to     link-hesap(1) 
     

           move    FATURA-MATRAH  to      link-tl(2)
          move "A" to link-ba(2)
         move     link-aciklama(1)  to  link-aciklama(2)
         if FATURA-TIPI = "D"
             move "600.03.01"   to     link-hesap(2) 
             else
             move "600.03.01"   to     link-hesap(2) 
          end-if

          move  FATURA-KDV      to    link-tl(3)
          move "A" to link-ba(3)
         move     link-aciklama(1)  to  link-aciklama(3)
         if FATURA-TIPI = "D"
             move "391.01.01"   to     link-hesap(3) 
          else
             move "391.01.20"   to     link-hesap(3) 
          end-if

          perform mahsup-yaz
        end-read
 
         .


 mahsup-yaz.
 
       perform varying i-m from 1 by 1 until i-m > 3
  
         initialize mahsup-rec 
         move tarih               to mahsup-tarih
         move numara              to mahsup-fis-no
         add  1                   to fis-sira-sakla
         move fis-sira-sakla      to mahsup-fis-sira
           SET MAHSUP-DOVIZ-KILITLI TO TRUE
        
         move link-hesap(i-m)      to mahsup-hesap-kodu
         move "A"                 to mahsup-tipi
         move link-ba(i-m)         to mahsup-b-a 
         move link-tl(i-m)   to mahsup-tutar
         move link-aciklama(i-m)   to mahsup-aciklama 
        
         
         move k-kodu-tasi         to mahsup-staf
        
         move FATURA-NO    to mahsup-BELGE-NO 
      
         move function numval(mahsup-BELGE-NO) to e-o-fatura
         move ref to e-ref 
         perform efatura-gercek-bul
         if e-m-fatura > spaces then 
             move e-m-fatura to mahsup-BELGE-NO
         end-if


         move "02"         to mahsup-edefter-dokuman-tipi
         move mahsup-tarih to mahsup-edefter-belge-tarihi
         move k-kodu-tasi  to mahsup-edefter-belgeyi-giren-staf
       
         move "OD" to mahsup-nereden
         write mahsup-rec invalid stop " " end-write
     end-perform

       initialize islenen-rec
        move numara      to islenen-fis-no
             move tarih       to islenen-tarih
             move "A"         to islenen-tipi
                move "OD" to ISLENEN-NEREDEN
             write islenen-rec invalid 
                   rewrite islenen-rec end-rewrite
             end-write


           .

*
 Form1-Aft-Routine.
     close odalar2
     .
*
 fatdetay-fat-fol-bul.
        open input fatdetay
        initialize fatdetay-rec fat-fol-bul-folio 
        move fat-fol-bul-tarih to fatdetay-fat-tar
        start fatdetay key not < fatdetay-anah invalid 
                continue
        not invalid
        perform until fs-fatdetay = "10"
        read fatdetay next no lock end move "10" to fs-fatdetay
        not end
            if fatdetay-fat-tar > fat-fol-bul-tarih
                 exit perform
            end-if
            if function numval(fatdetay-fat-no) not = fat-fol-bul-fatura
                 exit perform cycle
            end-if
            if fatdetay-depkod not = "C/L"  
                 exit perform cycle  
            end-if
            move fatdetay-folio to fat-fol-bul-folio
        end-read
        end-perform
        end-start
        close fatdetay
        if fat-fol-bul-folio > 0
             perform folyo-geceleme-bul
        end-if.
*
 folyo-geceleme-bul.
        open input konuk cast konum
        initialize konuk-rec
        move fat-fol-bul-folio to KONUK-FOLIO
        read konuk no lock invalid
              continue
        not invalid
              perform genel-konuk-ref-ayarla
              if KONUK-FOL-KODU not = "R"
                  close konuk cast konum
                  exit paragraph
              end-if

              if konuk-rez-no = zeroes
                  close konuk cast konum
                  exit paragraph
              end-if

              initialize cast-rec  eski-konum-ref i 
              initialize fat-fol-bul-ref-var fat-fol-bul-ref-adet fat-fol-bul-ref-dizi fat-fol-bul-ref-gece-dizi
              move konuk-rez-no to cast-rez-no
              start cast key not < CAST-ANAH1 invalid
                      continue
              not invalid
              perform until fs-cast = "10"
              read cast next no lock end move "10" to fs-cast
              not end
                     if cast-rez-no not = konuk-rez-no
                           exit perform
                     end-if

                     if KONUK-GIT-TAR = cast-tarih
                           exit perform cycle
                     end-if

                     initialize konum-rec 
                     move CAST-ODA-KONUMU to KONUM-ANAHTAR
                     read konum invalid
                             continue
                     not invalid
                           if konum-ref = zeroes
                                exit perform cycle
                           end-if
                           if konum-ref <> eski-konum-ref and eski-konum-ref <> spaces
                                add 1 to i
                                move konum-ref to fat-fol-bul-ref(i)
                           else
                                move konum-ref to fat-fol-bul-ref(i)
                           end-if
                           add 1 to fat-fol-bul-ref-gece(i)
                           add 1 to fat-fol-bul-ref-gece(99)
                           move konum-ref to eski-konum-ref
*                          if i > 1 | long beach tek oda istegi 21.06.2021 s.y freshdesk no 2011
                                 move 1 to fat-fol-bul-ref-var
*                          end-if
                           move i to fat-fol-bul-ref-adet
                     end-read
              end-read
              end-perform 
              end-start
        end-read
        close konuk cast konum.
 


*
 depkod2-hesap-ref-ayarla.
       if ref > 0  and kodlar02-bas-deger > 0 and kodlar02-bit-deger > 0 and kodlar02-kir-deger not = spaces
          if DEPKOD2-MATRAH-HESAP not = spaces and DEPKOD2-MATRAH-HESAP(1:3) = "600"
               move kodlar02-kir-deger to DEPKOD2-MATRAH-HESAP(kodlar02-bas-deger:kodlar02-bit-deger)
          end-if
          |if DEPKOD2-KDV-HESAP not = spaces
          |     move kodlar02-kir-deger to DEPKOD2-KDV-HESAP(kodlar02-bas-deger:kodlar02-bit-deger)
          |end-if
          |if DEPKOD2-TOPLAM-HESAP not = spaces
          |     move kodlar02-kir-deger to DEPKOD2-TOPLAM-HESAP(kodlar02-bas-deger:kodlar02-bit-deger)
          |end-if
       end-if.
*
 genel-konuk-ref-ayarla.
       if genel2-mahsup-fiyat-ref = 1  
          if konuk-fiyat-konumu not = spaces
             move konuk-fiyat-konumu to konuk-oda-konumu
          end-if         
       end-if.


@}}

[KEY_STATUS_FIELD_FORMAT]
PIC=9(4)
USAGE=[None]

[KEYSTATUS_CONTENT:KS1]
CONDITION=Exit-Pushed
VALUE=27

[KEYSTATUS_CONTENT:KS2]
CONDITION=Message-Received
VALUE=95

[KEYSTATUS_CONTENT:KS3]
CONDITION=Event-Occurred
VALUE=96

[KEYSTATUS_CONTENT:KS4]
CONDITION=Screen-No-Input-Field
VALUE=97

[CODE_GENERATION_OPTIONS]
FOLLOW_PROJECT_OPTIONS=1
GENERATE_PROGRAM_FILE=1
GENERATE_WORKING_STORAGE=1
GENERATE_EVENT_PARAGRAPH=1
GENERATE_SCREEN_SECTION=1
GENERATE_REPORT_SECTION=1
GENERATE_PROCEDURE_DIVISION=1
GENERATE_MENU_PARAGRAPH=1
GENERATE_LINKAGE_SECTION=1
REPLACE_REMARK_PART=1
EXCLUDE_PROGRAM_VARIABLE=1
EXCLUDE_PROGRAM_PARAGRAPH=1
PROGRAM_EXTENSION=.cbl
WORKINGSTORAGE_EXTENSION=.wrk
EVENT_EXTENSION=.evt
SCREEN_EXTENSION=.scr
REPORT_EXTENSION=.rpt
PROCEDURE_EXTENSION=.prd
MENU_EXTENSION=.mnu
LINKAGE_EXTENSION=.lks
PROGRAM_FILE_READ_ONLY=0
LINK_CLOSE_TO_OPEN=0
COPYBOOK_READ_ONLY=0
GENERATE_COPY_FILES=1
ACCEPT_CONTROL=1
ANSI_DOCUMENT_FORMAT=1