* rezbulrp.evt
* rezbulrp.evt is generated from C:\Asya\acugt.ytl\otelets\rezbulrp.Psf
* This is a generated file. DO NOT modify this file directly.


 Acu-Form6-Ta-1-Cmd-Tabchanged.
     EVALUATE Event-Type
     WHEN Cmd-Tabchanged
        MOVE Event-Data-1 TO Form6-Ta-1-Valuea
        MOVE 0 TO Form6-Pg-1-Visible, Form6-Pg-2-Visible,
            Form6-Pg-3-Visible
        EVALUATE Event-Data-1
        WHEN 1
           MOVE 1 TO Form6-Pg-1-Visible
        WHEN 2
           MOVE 1 TO Form6-Pg-2-Visible
        WHEN 3
           MOVE 1 TO Form6-Pg-3-Visible
        END-EVALUATE
*       Before-Tabchg-Display
        DISPLAY Form6
*       After-Tabchg-Display
     END-EVALUATE
     .

 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .

 combo-rapor-baslik-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM combo-rapor-baslik-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1a-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1a-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaaaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaaaaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaaaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaaaaaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form2-Event-Proc.
     .

 Form2-Exception-Proc.
     PERFORM Form2-Ex-Other
     .

 combo-toplamlar-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM combo-toplamlar-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 Form3-Event-Proc.
     .

 Form3-Exception-Proc.
     PERFORM Form3-Ex-Other
     .

 Form3-Gd-1-Event-Proc.
     PERFORM Form3-Gd-1-Ev-Other
     .

 Form4-Event-Proc.
     .

 Form4-Gd-1-Event-Proc.
* 
     EVALUATE Event-Type
     WHEN Msg-Begin-Entry
        PERFORM Form4-Gd-1-Ev-Msg-Begin-Entry
     END-EVALUATE
     .

 Form5-Event-Proc.
     .

 Form6-Event-Proc.
     .

 Form6-Exception-Proc.
     PERFORM Form6-Ex-Other
     .

 accept-0601-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Changed
           PERFORM accept-0601-Ex-Ntf-Changed
        END-EVALUATE
     END-IF
     .

 Form6-Gd-1-Event-Proc.
     EVALUATE Event-Control-Id
     WHEN 6
        PERFORM Form6-Gd-1-Ev-Other
     WHEN 10
        PERFORM Form6-Gd-2-Ev-Other
     END-EVALUATE
     .

 Form6-Gd-3-Event-Proc.
     PERFORM Form6-Gd-3-Ev-Other
     .

 Form7-Event-Proc.
     .

 Form7-Exception-Proc.
     PERFORM Form7-Ex-Other
     .
***   start event editor code   ***
* 1-Check box rapordan deger geldigi zaman renk ve
*   disable enable
* 2-duzenle'de silme'de hata var ...
****************************************************
 Form1-Bef-Create.
*************************************
*    move "ASYA"       to k-kodu-tasi.
*    move "wing2005"   to isyeri-adres-tasi.
*    set turkce        to true.
*    move 23           to gun-tasi
*    move 08           to ay-tasi
*    move 2005         to yil-tasi.
*    move 01           to isyeri-no-tasi.
*************************************
    perform adresleri-tasi.
* YAPILACAKLAR
* ----------------------------------------
* RAPOR DUZENLEME PENCERESÝNDEKÝ TABLARDA
* PROBLEM OLUYOR BAZI BAZI KONTROL ET
* 0000 NOLU RAPOR SECILDIGINDE
* GEREKLÝ ÝSLERÝ YAPMIYOR LAVUK
* ----------------------------------------
 def-tarih.
    move tarih-tasi       to bas-islem-tarih
                             bit-islem-tarih
                             bas-cin-tarih
                             bit-cin-tarih
                             bas-cout-tarih
                             bit-cout-tarih.
*
 Form1-Cb-1-Ex-Cmd-Clicked.
     display acc-bas-numara acc-bit-numara.
     if ilk-secilen = zeroes
        move 1 to ilk-secilen
        perform cb-renklendir
     else 
        if numara-eh = 0
           if ilk-secilen = 1
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
*
 Form1-Cb-1a-Ex-Cmd-Clicked.
     display acc-bas-islem-gun acc-bas-islem-ay acc-bas-islem-yil
             acc-bit-islem-gun acc-bit-islem-ay acc-bit-islem-yil.
     if ilk-secilen = zeroes
        move 2 to ilk-secilen
        perform cb-renklendir
     else 
        if islem-tarih-eh = 0
           if ilk-secilen = 2
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aa-Ex-Cmd-Clicked.
     display acc-bas-acenta acc-bit-acenta.
     if ilk-secilen = zeroes
        move 3 to ilk-secilen
        perform cb-renklendir
     else 
        if acenta-eh = 0
           if ilk-secilen = 3
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aaa-Ex-Cmd-Clicked.
     display acc-bas-musteri-adi acc-bit-musteri-adi.
     if ilk-secilen = zeroes
        move 4 to ilk-secilen
        perform cb-renklendir
     else 
        if musteri-adi-eh = 0
           if ilk-secilen = 4
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aaaa-Ex-Cmd-Clicked.
     display acc-bas-musteri-soy acc-bit-musteri-soy.
     if ilk-secilen = zeroes
        move 5 to ilk-secilen
        perform cb-renklendir
     else 
        if musteri-soyadi-eh = 0
           if ilk-secilen = 5
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aaaaa-Ex-Cmd-Clicked.
     display acc-bas-cin-gun acc-bas-cin-ay acc-bas-cin-yil
             acc-bit-cin-gun acc-bit-cin-ay acc-bit-cin-yil.
     if ilk-secilen = zeroes
        move 6 to ilk-secilen
        perform cb-renklendir
     else 
        if c-in-tarih-eh = 0
           if ilk-secilen = 6
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aaaaaa-Ex-Cmd-Clicked.
     display acc-bas-cout-gun acc-bas-cout-ay acc-bas-cout-yil
             acc-bit-cout-gun acc-bit-cout-ay acc-bit-cout-yil.
     if ilk-secilen = zeroes
        move 7 to ilk-secilen
        perform cb-renklendir
     else 
        if c-out-tarih-eh = 0
           if ilk-secilen = 7
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aaaaaaa-Ex-Cmd-Clicked.
     display acc-bas-voucher acc-bit-voucher.
     if ilk-secilen = zeroes
        move 8 to ilk-secilen
        perform cb-renklendir
     else 
        if voucher-eh = 0
           if ilk-secilen = 8
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Ex-Other.
     if key-status = 1
        perform yardimlar
     end-if
     
     if key-status = 2001
        perform acu-form2-routine
        exit paragraph
     end-if.

     if key-status = 2002 or key-status = 2003 or key-status = 2 or key-status = 7 or
        key-status = 2004
        continue
     else
        exit paragraph
     end-if.
     if key-status = 2004
        perform acu-form6-routine
        exit paragraph
     end-if.

     if numara-eh = 0 and islem-tarih-eh = 0 and
        acenta-eh = 0 and musteri-adi-eh = 0 and
        musteri-soyadi-eh = 0 and c-in-tarih-eh = 0 and
        c-out-tarih-eh = 0 and voucher-eh = 0
            display message box 
                    "Raporu alabilmeniz icin ana filtrelerden birini secmek zorundasiniz !!!"
                    icon mb_warning_icon
                    title "Uyari"
                    move 4 to accept-control
                    move 12 to control-id
                    exit paragraph
     end-if.

     perform Acc-Bit-Numara-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 21 to control-id
        exit paragraph.

     perform Acc-Bas-Islem-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 22 to control-id
        exit paragraph.

     perform Acc-Bit-Islem-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 25 to control-id
        exit paragraph.

     perform Acc-Bas-Acenta-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 28 to control-id
        exit paragraph.

     perform Acc-Bit-Acenta-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 29 to control-id
        exit paragraph.

     perform Acc-Bit-Musteri-Adi-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 31 to control-id
        exit paragraph.

     perform Acc-Bit-Musteri-Soy-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 33 to control-id
        exit paragraph.

     perform Acc-Bas-Cin-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 34 to control-id
        exit paragraph.

     perform Acc-Bit-Cin-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 37 to control-id
        exit paragraph.

     perform Acc-Bas-Cout-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 40 to control-id
        exit paragraph.

     perform Acc-Bit-Cout-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 43 to control-id
        exit paragraph.

     perform Acc-Bit-Voucher-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 47 to control-id
        exit paragraph.

     perform Acc-Bas-Banka-Kodu-Aft-Procedure.
     if gec-gecme = 1  
        move 4 to accept-control
        move 54 to control-id
        exit paragraph.

     perform Acc-Bas-Doviz-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 58 to control-id
        exit paragraph.

     perform Acc-Bas-Anlasma-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 62 to control-id
        exit paragraph.

     perform Acc-Bas-Odeme-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 66 to control-id
        exit paragraph.

     perform Acc-Bas-Ulke-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 74 to control-id
        exit paragraph.

     perform Acc-Bas-Pazar-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 82 to control-id
        exit paragraph.

     perform Acc-Bas-Pansiyon-Kodu-Aft-Procedure.
     if gec-gecme = 1
        move 0 to gayriresmi
        move 4 to accept-control
        move 70 to control-id
        exit paragraph.

     if key-status = 2 or key-status = 7 then 
        move 2002 to rapor-sekil 
        if key-status = 7 then 
               move 1 to gayriresmi 
           else
               move 0 to gayriresmi
        end-if
     else
        move key-status to rapor-sekil
     end-if.
     if dokumere-yolla 
        perform dokumer-islem
     else
        perform duzenle-islem
     end-if.
     initialize esleme-i.

     exit paragraph.
*
 Form1-Aft-Initdata.
     perform form1-rapor-adlari-yukle.
     perform load-def-screen.

*
 load-def-detay-degerler.
     perform varying i 
             from 1 
             by 1 
             until i > max-det-adlari
                   set rapor-detaylar-ciksin(i) to true
                   move i                       to rapor-detaylar-sira(i)
                   move det-adlari-def-au(i)    to rapor-detaylar-au(i)
     end-perform.


 load-def-screen.
     perform varying i from 1 by 1 until i > 15
             move 0 to rapor-anah-secim(i)
             move 1 to rapor-anah-gorunsunmu(i)
     end-perform
     perform varying i from 1 by 1 until i > 50
             move 1 to rapor-yrd-gorunsunmu(i)
     end-perform
     perform flt-ana-scr-loc-yerlestir.
     perform flt-yrd-scr-loc-yerlestir.

     initialize degiskenler degiskenler-1.
     perform degerler-def.
     perform def-tarih.
     perform load-def-detay-degerler.
     display form1.

*
 degerler-def.
     modify combo-rezervasyon-turu, reset-list = 1
                                    mass-update = 1
     modify combo-musteri-turu,     reset-list = 1
                                    mass-update = 1
     modify combo-rezervasyon-durumu, reset-list = 1
                                      mass-update = 1
     modify combo-kur-tipi,         reset-list = 1
                                    mass-update = 1

                           
     modify combo-rezervasyon-turu,
     item-to-add("0-Hepsi","1-Alotment","2-It","3-Fit","4-Grup")
     modify combo-rezervasyon-turu,
     item-to-add("5-Munferit","6-Walk-in","7-Sirket/Firma","8-Ozel")
     move "0-Hepsi" to combo-rezervasyon-turu-value

     modify combo-musteri-turu,
     item-to-add("N-Normal","V-Vip","T-Top Vip","H-Hepsi")
     move "N-Normal" to combo-musteri-turu-value

     modify combo-rezervasyon-durumu,
     item-to-add("I-Icerdeki","S-Silinmis ")
     move "I-Icerdeki" to combo-rezervasyon-durumu-value.

     modify combo-kur-tipi,
     item-to-add("H-Hepsi","G-Gunluk","A-Aybasi")
     move "H-Hepsi" to combo-kur-tipi-value

*/ form2 => degiskenleri
     move "0-Hepsi"      to combo-oda-tipi-value
     move "0-Hepsi"      to combo-oda-konumu-value
     move "O-Oda Konumu" to combo-oda-konumu-kaynagi-value
     move "0-Dahil"      to aksiyon-uygulama-eh
     move "0-Dahil"      to bilboard-dus-eh
     move "0-Degistirme" to combo-oda-konumu-value-a
     move "H-Hepsi"      to combo-rezervasyon-k-w-value
     move "Hepsi"        to combo-kullanici-kodu-value
     move 1              to cin-rezler-ciksin 
     move 0              to eb-rezler-ciksin
     move 0              to peryot-hesaplansinmi
     move "0-Dahil"      to fix-fiyat-ciksin
     move 0              to eb-de-aksiyon-hesaplama
     move "A-Toplamsiz"  to combo-toplamlar-value

*/ Raporlarin isimleri aliniyor ...

     modify combo-rezervasyon-turu, mass-update = 0
                                    value combo-rezervasyon-turu-value
     modify combo-musteri-turu,     mass-update = 0
                                    value combo-musteri-turu-value
     modify combo-rezervasyon-durumu,mass-update = 0 
                                    value combo-rezervasyon-durumu-value
     modify combo-kur-tipi,         mass-update = 0
                                    value combo-kur-tipi-value.
     modify combo-oda-tipi,         mass-update = 0
                                    value combo-oda-tipi-value.

*
 form1-rapor-adlari-yukle.
     modify combo-rapor-baslik      reset-list = 1 
                                    mass-update = 1
     move "0000-"                         to combo-rapor-baslik-value
     move "Rezervasyon Filtreleme Raporu" to combo-rapor-baslik-value(6:)
     move combo-rapor-baslik-value        to gecici-rapor-baslik.
     modify combo-rapor-baslik,
            item-to-add(combo-rapor-baslik-value)
     open input rapor.
     initialize rapor-rec
     move "R"         to rapor-tipi
     start rapor key not < rapor-anahtar invalid
           continue
     not invalid
     initialize fs-rapor i
     perform with test after until fs-rapor = "10"
     read rapor next no lock end move "10" to fs-rapor
     not at end
          if rapor-tipi = "R" 
             initialize combo-rapor-baslik-value
             move rapor-no       to combo-rapor-baslik-value
             move "-"            to combo-rapor-baslik-value(5:)
             move rapor-adi      to combo-rapor-baslik-value(6:)
             modify combo-rapor-baslik,
                    item-to-add(combo-rapor-baslik-value)
          else
             move "10" to fs-rapor
             exit perform
          end-if
     end-read
     end-perform
     end-start
     close rapor.
     move gecici-rapor-baslik       to combo-rapor-baslik-value.
     modify combo-rapor-baslik      mass-update = 0
                                    value gecici-rapor-baslik.

*
 acc-bit-numara-Aft-Procedure.
     initialize gec-gecme
     if numara-eh = 0 
        exit paragraph.
     if bas-numara <> 0 and bit-numara <> 0
        if bas-numara > bit-numara 
           move 1 to gec-gecme
           exit paragraph
        end-if
     end-if.
     .
*
 acc-bas-islem-yil-Aft-Procedure.
     initialize gec-gecme.
     if islem-tarih-eh = 0
        exit paragraph.
     if bas-islem-tarih <> 0
        open input takvim
        move bas-islem-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.
*
 acc-bit-islem-yil-Aft-Procedure.
     initialize gec-gecme.
     if islem-tarih-eh = 0
        exit paragraph.
     if bit-islem-tarih <> 0
        open input takvim
        move bit-islem-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.

     if bas-islem-tarih <> 0 and bit-islem-tarih <> 0
        if bas-islem-tarih > bit-islem-tarih
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-acenta-Aft-Procedure.
     initialize gec-gecme.
     if acenta-eh = 0
        exit paragraph.

     if bas-acenta <> spaces
        open input acenta 
        move bas-acenta  to acenta-kodu
        read acenta no lock invalid 
             move "Tanimsiz" to acenta-adi
             move 1 to gec-gecme
        end-read
        close acenta
     else
        move "Tumu ... " to acenta-adi
     end-if.
     display lb-bas-acenta-adi.
*
 acc-bit-acenta-Aft-Procedure.
     initialize gec-gecme.
     if acenta-eh = 0
        exit paragraph.

     if bit-acenta = spaces
        move "Tumu ..." to acenta-adi
        display lb-bit-acenta-adi
        exit paragraph.

     open input acenta
     move bit-acenta to acenta-kodu
     read acenta no lock invalid
          move "Tanimsiz ..."  to acenta-adi
          move 1 to gec-gecme
     end-read
     close acenta.
     display lb-bit-acenta-adi.

     if bas-acenta <> spaces and bit-acenta <> spaces
        if bas-acenta > bit-acenta
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-degis-acenta-Aft-Procedure.
     if degis-acenta <> spaces
        open input acenta 
        move degis-acenta  to acenta-kodu
        read acenta no lock invalid 
             move "Tanimsiz" to acenta-adi
             move 4 to accept-control
             move 28 to control-id
             display lb-degis-acenta-adi
        end-read
        close acenta
     else
        move "Degistirme ... " to acenta-adi
     end-if.
     display lb-degis-acenta-adi.
*
 acc-bit-musteri-adi-Aft-Procedure.
     initialize gec-gecme.
     if musteri-adi-eh = 0
        exit paragraph.
     if bas-musteri-adi <> spaces and bit-musteri-adi <> spaces
        if bas-musteri-adi > bit-musteri-adi
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bit-musteri-soy-Aft-Procedure.
     initialize gec-gecme.
     if musteri-soyadi-eh = 0 
        exit paragraph.
     if bas-musteri-soy <> spaces and bit-musteri-soy <> spaces
        if bas-musteri-soy > bit-musteri-soy
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-cin-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-in-tarih-eh = 0
        exit paragraph.
     if bas-cin-tarih <> 0
        open input takvim
        move bas-cin-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.
*
 acc-bit-cin-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-in-tarih-eh = 0
        exit paragraph.
     if bit-cin-tarih <> 0
        open input takvim
        move bit-cin-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.

     if bas-cin-tarih <> 0 and bas-cin-tarih <> 0
        if bas-cin-tarih > bit-cin-tarih
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-cout-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-out-tarih-eh = 0
        exit paragraph.
     if bas-cout-tarih <> 0
        open input takvim
        move bas-cout-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.
*
 acc-bit-cout-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-out-tarih-eh = 0
        exit paragraph.
     if bit-cout-tarih <> 0
        open input takvim
        move bit-cout-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.

     if bas-cout-tarih <> 0 and bas-cout-tarih <> 0
        if bas-cout-tarih > bit-cout-tarih
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bit-voucher-Aft-Procedure.
     initialize gec-gecme.
     if voucher-eh = 0 
        exit paragraph.
     if bas-voucher <> 0 and bit-voucher <> 0
        if bas-voucher > bit-voucher
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-banka-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-banka-kodu <> 0
        open input banka
        move bas-banka-kodu   to banka-kodu
        read banka no lock invalid
             move 1 to gec-gecme
             move "Tanimsiz ..." to banka-adi
        end-read
        close banka
     else
        move "Tumu ..."  to banka-adi
     end-if.
     display lb-banka-adi.
*
 acc-bas-doviz-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-doviz-kodu <> 0
        open input doviz
        move bas-doviz-kodu   to doviz-kodu
        read doviz no lock invalid
             move 1 to gec-gecme
             move "Tanimsiz ..."  to d-adi-1
        end-read
        close doviz
     else
        move "Tumu ..." to d-adi-1
     end-if.
     display lb-doviz-adi.
*
 acc-bas-anlasma-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-anlasma-kodu <> spaces
        open input kodlar02
        move "D"              to kodlar02-tipi
        move bas-anlasma-kodu to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-anlasma-adi.
*
 acc-bas-odeme-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-odeme-kodu <> spaces
        open input kodlar02
        move "B"              to kodlar02-tipi
        move bas-odeme-kodu   to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-odeme-adi.
*
 acc-bas-ulke-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-ulke-kodu <> spaces
        open input ulke
        move bas-ulke-kodu   to ulke-anah
        read ulke no lock invalid
             move "Tanimsiz ..." to ulke-adi
             move 1 to gec-gecme
        end-read
        close ulke
     else
        move "Tumu ..." to ulke-adi
     end-if.
     display lb-ulke-adi.
*
 acc-bas-pazar-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-pazar-kodu <> spaces 
        open input kodlar02
        move "E"              to kodlar02-tipi
        move bas-pazar-kodu   to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-pazar-adi.
*
 acc-bas-pansiyon-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-pansiyon-kodu <> spaces
        open input kodlar02
        move "A"                 to kodlar02-tipi
        move bas-pansiyon-kodu   to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-pansiyon-adi.
     .
*
 Form2-Aft-Initdata.
     modify combo-oda-tipi,          reset-list = 1 mass-update = 1.
     modify combo-oda-konumu,        reset-list = 1 mass-update = 1.
     modify combo-aksiyon-uygula     reset-list = 1 mass-update = 1.
     modify combo-bilboard-dus       reset-list = 1 mass-update = 1.
     modify combo-oda-konumu-kaynagi reset-list = 1 mass-update = 1.
     modify combo-rezervasyon-e-b,   reset-list = 1 mass-update = 1.
     modify combo-fix-fiyat      ,   reset-list = 1 mass-update = 1.
     modify combo-rezervasyon-k-w,   reset-list = 1 mass-update = 1.
     modify combo-kullanici-kodu,    reset-list = 1 mass-update = 1.
     modify combo-toplamlar,         reset-list = 1 mass-update = 1.
     modify combo-oda-tipi,
     item-to-add("0-Hepsi","1-Single","2-Double","3-Double","4-Triple")
     modify combo-oda-konumu,
     item-to-add("0-Hepsi")
     modify combo-aksiyon-uygula,
     item-to-add("0-Dahil","1-Sadece","2-Cikmasin")
     modify combo-bilboard-dus,
     item-to-add("0-Dahil","1-Sadece","2-Cikmasin")
     modify combo-oda-konumu-kaynagi,
     item-to-add("O-Oda Konumu","F-Fiyat Konumu")
     modify combo-rezervasyon-e-b,
     item-to-add("0-Dahil","1-Sadece","2-Cikmasin")
     modify combo-fix-fiyat,
     item-to-add("0-Dahil","1-Sadece","2-Cikmasin")
     modify combo-rezervasyon-k-w,
     item-to-add("H-Hepsi","K-Konfirme","B-Beklemede","G-Gecici")
     modify combo-kullanici-kodu,
     item-to-add("Hepsi").
     modify combo-toplamlar,
     item-to-add("A-Toplamsiz","B-Pazar","C-Pansiyon","D-Ulke","E-Anlasma")
     modify combo-toplamlar,
     item-to-add("F-Oda tipi","G-Oda konumu","H-Odeme kodu","I-Doviz kodu")
     modify combo-toplamlar,
     item-to-add("J-Erken rezervasyon","K-Acenta")

     open input konum
     initialize konum-rec
     start konum key not < konum-anahtar invalid
           continue
     not invalid
     initialize fs-konum
     perform with test after until fs-konum = "10"
     read konum next no lock end move "10" to fs-konum
     not at end
          initialize temp-x
          move konum-anahtar to temp-x
          move "-"           to temp-x(2:)
          move konum-adi     to temp-x(3:)
          modify combo-oda-konumu,
                 item-to-add(temp-x)
     end-read
     end-perform
     end-start
     close konum.

     move combo-kullanici-kodu-value to temp-x-50
     open input kllnc
     initialize kllnc-rec
     start kllnc key not < k-kodu invalid
           continue
     not invalid
     initialize fs-kllnc
     perform with test after until fs-kllnc = "10"
     read kllnc next no lock end move "10" to fs-kllnc
     not at end
          initialize combo-kullanici-kodu-value
          string k-adi delimited by space
                 " "   delimited by size 
                 k-soyadi delimited by size 
                 into combo-kullanici-adi
          move k-kodu          to combo-kullanici-no
          modify combo-kullanici-kodu,
                 item-to-add(combo-kullanici-kodu-value)
     end-read
     end-perform
     end-start
     close kllnc.
     move temp-x-50  to combo-kullanici-kodu-value

     modify combo-oda-tipi,             mass-update = 0
                                        value combo-oda-tipi-value.
     modify combo-oda-konumu,           mass-update = 0
                                        value combo-oda-konumu-value.
     modify combo-aksiyon-uygula,       mass-update = 0
                                        value aksiyon-uygulama-eh.
     modify combo-bilboard-dus,         mass-update = 0
                                        value bilboard-dus-eh.
     modify combo-oda-konumu-kaynagi,   mass-update = 0
                                        value combo-oda-konumu-kaynagi-value.
     modify combo-rezervasyon-k-w,      mass-update = 0
                                        value combo-rezervasyon-k-w-value.
     modify combo-rezervasyon-e-b,      mass-update = 0
                                        value eb-rezler-ciksin
     modify combo-fix-fiyat,            mass-update = 0
                                        value fix-fiyat-ciksin
     modify combo-kullanici-kodu,       mass-update = 0
                                        value combo-kullanici-kodu-value.
     modify combo-toplamlar     ,       mass-update = 0
                                        value combo-toplamlar-value.

     if combo-toplamlar-value(1:1) = "A"
        modify form2-pb-2,enabled = false
     else
        modify form2-pb-2,enabled = true
     end-if.

 dokumer-islem.
     open i-o genelfis.
     move 1 to genelfis-anahtar.
     read genelfis no lock invalid
          accept print-no from time
     end-read
     add 1 to print-no
     rewrite genelfis-rec invalid continue end-rewrite
     close genelfis.
**************************
     initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya

     set  dokumer-asya-set to true
     move print-no         to dokumer-dosya-adi
     open output dokumer
*/WINDOW TITLE
     initialize dokumer-rec detay
     move "W"            to det-dokumer-20(1:)
     move rapor-baslik   to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR
     initialize dokumer-rec detay
     move "1"            to det-dokumer-20(10:1)
     move "B"            to det-dokumer-20(1:1)
     move rapor-adi      to det-filler
     write dokumer-rec from detay


     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:1)
     write dokumer-rec from detay


*/ DOKUMER OZELLIKLER-REC
     initialize dokumer-rec detay
     move "O" to det-dokumer-20(1:)
     move "E" to dokumer-oto-sayfa-basi
     move 56  to dokumer-oto-sayfa-satir
     move "|" to dokumer-detay-kolon-ayirici
     perform det-yerler-ayarla
*     move "RLLRRRRRRLLLLLLLLRRRLLLLLLLLL" to dokumer-align-occ
     move dokumer-ozellikler-rec     to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR  

     initialize dokumer-rec detay 
     move "1"          to det-dokumer-20(10:1)
     move "D1"         to det-dokumer-20(1:2)
     if dokumere-yolla
        perform detay-baslik-ayarla
        move det-belirsiz       to det-filler
     else
        move "Rez.no"           to det-1
        move "Adi"              to det-2
        move "Soyadi"           to det-3
        move "Pax"              to det-4
        move "Chi"              to det-5
        move "Free"             to det-6
        move "Beb."             to det-66
        move "C/in"             to det-7
        move "C/out"            to det-8
        move "Rez.T"            to det-9
        move "Odeme"            to det-10
        move "Acenta"           to det-11
        move "Ulke"             to det-12
        move "Voucher"          to det-13
        move "Anlas"            to det-14
        move "Bn"               to det-15
        move "Dv"               to det-16
        move "Rez.Fiyati"       to det-17
        move "Gun"              to det-18
        move "Toplam Rez.Fiyati" to det-19
        move "Pazar"            to det-20
        move "X"                to det-21
        move "Pk"               to det-22
        move "K"                to det-23
        move "Konum"            to det-24
        move "Tip"              to det-25
        move "Oda"              to det-26
        move "Grup"             to det-27
        move "IO"               to det-28
        move "KO"               to det-29
        move "Staff"            to det-30
        move "|" to fil-1 fil-2 fil-3 fil-4
        fil-5 fil-6 fil-66 fil-7 fil-8 fil-9 fil-10 fil-11
        fil-12 fil-13 fil-14 fil-15 fil-16 fil-17
        fil-18 fil-19 fil-20 fil-21 fil-22 fil-23
        fil-24 fil-25 fil-26 fil-27 fil-28 fil-29
        fil-30
     end-if
     write dokumer-rec from detay

     initialize dokumer-rec detay
     move "D2"           to det-dokumer-20(1:2)
     move "-"            to det-dokumer-20(5:1)
     if dokumere-yolla
        perform detay-baslik-cizgi-ayarla
        move det-belirsiz       to det-filler
     else
        move all "-" to det-1 det-2 det-3 det-4
        det-5 det-6 det-66 det-7 det-8 det-9 det-10 det-11
        det-12 det-13 det-14 det-15 det-16 det-17
        det-18 det-19 det-20 det-21 det-22 det-23
        det-24 det-25 det-26 det-27 det-28 det-29
        det-30
     end-if
     write dokumer-rec from detay
*********************************
     perform islem.
     close dokumer takas veritabani
     call dokumer-prog on exception
          perform callerr-proc
     not on exception
          cancel dokumer-prog
     end-call
     delete file dokumer takas veritabani.
*
 duzenle-islem.
     perform acu-form3-routine.
     close takas veritabani
     delete file takas veritabani.

 islem.
     initialize toplam detay-toplam-degiskenler
     open i-o genelfis.
     move 1 to genelfis-anahtar
     read genelfis no lock invalid
          move 1 to ekran-fis-1
     end-read
     add 1 to ekran-fis-1
     move ekran-fis-1     to takas-no veritabani-no
     rewrite genelfis-rec invalid
             write genelfis-rec end-write
     end-rewrite
     close genelfis.
     open output takas close takas open i-o takas with mass-update.
     open output veritabani close veritabani open i-o veritabani with mass-update.

     open input rez kodlar02 acenta ulke konum kllnc
                fiyat fiyatana aksiyhrk.
     initialize rez-rec fs-rez
     move combo-rezervasyon-durumu-value(1:1)  to rez-durumu
     evaluate true
          when ilk-secilen = 1
               move bas-numara to rez-anah
               start rez key not < rez-anah invalid
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 2
               move bas-islem-tarih   to rez-isl-tar
               start rez key not < rez-isl invalid
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 3 
               move bas-acenta to rez-acenta 
               start rez key not < rez-acen invalid
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 4
               move bas-musteri-adi to rez-adi
               start rez key not < rez-ad invalid 
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 5
               move bas-musteri-soy to rez-soyadi
               start rez key not < rez-soy invalid 
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 6
               move bas-cin-tarih to rez-gir-tar
               start rez key not < rez-gir invalid 
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 7
               move bas-cout-tarih to rez-cik-tar
               start rez key not < rez-cik invalid 
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 8
               move bas-voucher    to rez-voucher
               start rez key not < rez-vouc invalid 
                     move "89" to fs-rez
               end-start
     end-evaluate.

     if fs-rez = "89"
           display message box
                   "Kayit bulunamadi ..."
           close rez kodlar02 acenta ulke konum kllnc takas
                 fiyat fiyatana aksiyhrk veritabani
           delete file takas veritabani
           exit paragraph.

     initialize fs-rez
     perform with test after until fs-rez = "10"
     read rez next no lock end move "10" to fs-rez
     not at end
          if ilk-secilen not = 01 
             if combo-rezervasyon-durumu-value(1:1) <> rez-durumu
                move "10" to fs-rez
                exit perform
             end-if
          end-if 
          if ilk-secilen = 01 and bit-numara not = 0
             if rez-anah > bit-numara 
                move "10" to fs-rez
                exit perform
             end-if
          end-if
          if ilk-secilen = 02 and bit-islem-tarih not = 0
             if rez-isl-tar > bit-islem-tarih
                move "10" to fs-rez
                exit perform
             end-if
          end-if
          if ilk-secilen = 03 and bit-acenta not = spaces
             if rez-acenta > bit-acenta
                move "10" to fs-rez
                exit perform 
             end-if
          end-if
          if ilk-secilen = 04 and bit-musteri-adi not = spaces
             if rez-adi > bit-musteri-adi
                move "10" to fs-rez
                exit perform
             end-if
          end-if
          if ilk-secilen = 05 and bit-musteri-soy not = spaces
             if rez-soyadi > bit-musteri-soy
                move "10" to fs-rez
                exit perform
             end-if
          end-if
          if ilk-secilen = 06 and bit-cin-tarih not = 0
             if rez-gir-tar > bit-cin-tarih
                move "10" to fs-rez
                exit perform
             end-if
          end-if
          if ilk-secilen = 07 and bit-cout-tarih not = 0
             if rez-cik-tar > bit-cout-tarih
                move "10" to fs-rez
                exit perform
             end-if
          end-if
          if ilk-secilen = 08 and bit-voucher not = spaces
             if rez-voucher > bit-voucher
                move "10" to fs-rez
                exit perform
             end-if
          end-if
*/ ana filtreler tekrar sorgulaniyor ...
*-------------------------------------------------------
          if numara-eh > 0
             if (bas-numara <> 0 and rez-anah < bas-numara) or
                (bit-numara <> 0 and rez-anah > bit-numara)
                     exit perform cycle
             end-if
          end-if
          if islem-tarih-eh > 0
             if (bas-islem-tarih <> 0 and rez-isl-tar < bas-islem-tarih) or
                (bit-islem-tarih <> 0 and rez-isl-tar > bit-islem-tarih)
                   exit perform cycle
             end-if
          end-if
          if acenta-eh > 0
             if (bas-acenta <> spaces and rez-acenta < bas-acenta) or 
                (bit-acenta <> spaces and rez-acenta > bit-acenta)
                   exit perform cycle
             end-if
          end-if
          if musteri-adi-eh > 0
             if (bas-musteri-adi <> spaces and rez-adi < bas-musteri-adi) or
                (bit-musteri-adi <> spaces and rez-adi > bit-musteri-adi)   
                     exit perform cycle
             end-if
          end-if
          if musteri-soyadi-eh > 0
             if (bas-musteri-soy <> spaces and rez-soyadi < bas-musteri-soy) or
                (bit-musteri-soy <> spaces and rez-soyadi > bit-musteri-soy)   
                     exit perform cycle
             end-if
          end-if
          if c-in-tarih-eh > 0
             if (bas-cin-tarih <> 0 and rez-gir-tar < bas-cin-tarih) or
                (bit-cin-tarih <> 0 and rez-gir-tar > bit-cin-tarih)
                     exit perform cycle
             end-if
          end-if
          if c-out-tarih-eh > 0
             if (bas-cout-tarih <> 0 and rez-cik-tar < bas-cout-tarih) or
                (bit-cout-tarih <> 0 and rez-cik-tar > bit-cout-tarih)
                     exit perform cycle
             end-if
          end-if
          if voucher-eh > 0
             if (bas-voucher <> spaces and rez-voucher < bas-voucher) or 
                (bit-voucher <> spaces and rez-voucher > bit-voucher)
                     exit perform cycle                 
             end-if
          end-if
*/ yardimci filtreler sorgulaniyor ... 
*-------------------------------------------------------
          if combo-rezervasyon-turu-value(1:1) <> 0
             if combo-rezervasyon-turu-value(1:1) <> rez-tipi
                exit perform cycle
             end-if
          end-if
          if bas-grup-kodu <> spaces
             if bas-grup-kodu <> rez-grup-no
                exit perform cycle
             end-if
          end-if
          if combo-kur-tipi-value(1:1) <> "H"
             if combo-kur-tipi-value(1:1) <> rez-kur-aygun
                exit perform cycle
             end-if
          end-if
          if bas-banka-kodu <> 0
             if bas-banka-kodu > rez-banka or 
                bas-banka-kodu < rez-banka
                    exit perform cycle
             end-if
          end-if
          if bas-doviz-kodu <> 0
             if bas-doviz-kodu > rez-doviz or 
                bas-doviz-kodu < rez-doviz
                    exit perform cycle
             end-if
          end-if
          if bas-anlasma-kodu <> spaces
             if bas-anlasma-kodu > rez-anlasma or 
                bas-anlasma-kodu < rez-anlasma
                     exit perform cycle
             end-if
          end-if
          if bas-odeme-kodu <> spaces
             if bas-odeme-kodu > rez-odeme-tipi or 
                bas-odeme-kodu < rez-odeme-tipi
                     exit perform cycle
             end-if
          end-if
          if bas-ulke-kodu <> spaces
             if bas-ulke-kodu > rez-ulke or 
                bas-ulke-kodu < rez-ulke
                     exit perform cycle
             end-if
          end-if
          if bas-pazar-kodu <> spaces
             if bas-pazar-kodu > rez-pazar or 
                bas-pazar-kodu < rez-pazar
                     exit perform cycle
             end-if
          end-if
          if bas-pansiyon-kodu <> spaces
             if bas-pansiyon-kodu > rez-pan-tipi or 
                bas-pansiyon-kodu < rez-pan-tipi
                     exit perform cycle
             end-if
          end-if
          if combo-musteri-turu-value(1:1) = "N" or 
             combo-musteri-turu-value(1:1) = rez-vip
             continue
          else 
             exit perform cycle
          end-if
*/ gelismis filtreler sorgulaniyor
*-------------------------------------------------------
          if combo-oda-tipi-value(1:1) <> "0" 
             if combo-oda-tipi-value(1:1) <> rez-s-d-t-g
                exit perform cycle
             end-if
          end-if
          if combo-oda-konumu-value(1:1) <> "0"
             if combo-oda-konumu-kaynagi-value = "O"
                if combo-oda-konumu-value(1:1) <> rez-oda-konumu
                   exit perform cycle
                end-if
             else
                if rez-fiyat-konumu > 0 and 
                   rez-fiyat-konumu <= 9 
                       if rez-fiyat-konumu <> combo-oda-konumu-value(1:1)
                          exit perform cycle
                       end-if
                else
                   if combo-oda-konumu-value(1:1) <> rez-oda-konumu
                      exit perform cycle
                   end-if
                end-if
             end-if
          end-if
          if combo-kullanici-no <> spaces 
             if combo-kullanici-no <> rez-staf
                exit perform cycle
             end-if
          end-if
          if combo-rezervasyon-k-w-value(1:1) <> "H"
             if combo-rezervasyon-k-w-value(1:1) <> rez-k-g-b
                exit perform cycle
             end-if
          end-if
          if cin-rezler-ciksin = 0
             if rez-c-in = "E"
                exit perform cycle
             end-if
          end-if
* aksiyon uygulanacakmi tIkIrcagzI olanlar
          evaluate aksiyon-uygulama-eh(1:1)
          when "1"
               if rez-aksiyon-eh <> "E"
                  exit perform cycle
               end-if
          when 2
               if rez-aksiyon-eh = "E"
                  exit perform cycle
               end-if
          end-evaluate
*/ sadece ebler cikiyor
          evaluate eb-rezler-ciksin
          when 1
               if rez-eb <> "E"
                  exit perform cycle
               end-if
*/ ebler cikmasin
          when 2
               if rez-eb = "E"
                  exit perform cycle
               end-if
          end-evaluate
*/ Fix fiyatlar cýksýn cýkmasýn
          evaluate fix-fiyat-ciksin(1:1)
          when "1"
               if rez-fiyat-fix <> "E"
                  exit perform cycle
               end-if
          when "2"
               if rez-fiyat-fix = "E"
                  exit perform cycle
               end-if
          end-evaluate
*Bilboarddan düs check box
          evaluate bilboard-dus-eh(1:1)
          when "1"
               if rez-bilbord-eh <> "E"
                  exit perform cycle
               end-if
          when 2
               if rez-bilbord-eh = "E"
                  exit perform cycle
               end-if
          end-evaluate
          if buyuk-sayi <> 0
             if buyuk-sayi <> rez-buyuk
                exit perform cycle
             end-if
          end-if
          if kucuk-sayi <> 0
             if kucuk-sayi <> rez-kucuk
                exit perform cycle
             end-if
          end-if
          if bebek-sayi <> 0
             if bebek-sayi <> rez-bebek
                exit perform cycle
             end-if
          end-if
          if free-sayi <> 0
             if free-sayi <> rez-free
                exit perform cycle
             end-if
          end-if
          if komisyon-orani <> 0
             if komisyon-orani <> rez-komisyon
                exit perform cycle
             end-if
          end-if
          if indirim-orani <> 0
             if indirim-orani <> rez-nor-indirim
                exit perform cycle
             end-if
          end-if
             
*-------------------------------------------------------
          perform detay-ata
     end-read
     end-perform.
     if dokumere-yolla 
        perform liste-toplam
     end-if
     if not rapor-icmal-sekil-detay
        perform veritabani-raporla
     end-if

     close rez kodlar02 acenta ulke konum kllnc
           fiyat fiyatana aksiyhrk.

 veritabani-raporla.
     initialize veritabani-rec
     start veritabani key not < veritabani-anah
           invalid continue
     not invalid
     initialize fs-veritabani
     perform with test after until fs-veritabani = "10"
     read veritabani next no lock end move "10" to fs-veritabani
     not at end
          perform veritabani-detay-ata
     end-read
     end-perform
     end-start.
*
 veritabani-detay-ata.
     initialize dokumer-rec det-belirsiz
* Anahtar 1-1
     if rapor-icmal-anah11 > zeroes and 
        rapor-icmal-anah11 not > max-det-adlari
           if rapor-detaylar-ciksin(rapor-icmal-anah11)
              if veritabani-goster-1 = "E"
                 initialize 20-hane str-func-degiskenler
                 move veritabani-anah11              to 20-hane
                 move rapor-icmal-anah11             to str-func-index
                 perform veritabani-anah-to-aciklama
                 move 20-hane                        to str-func-alan
                 move "L"                            to str-func-align
                 move det-yerler-au(str-func-index)  to str-func-au
                 perform str-func
                 perform str-func-to-det-belirsiz
              end-if
           end-if
     end-if    

* Anahtar 1-2
     if rapor-icmal-anah12 > zeroes and 
        rapor-icmal-anah12 not > max-det-adlari
           if rapor-detaylar-ciksin(rapor-icmal-anah12)
              if veritabani-goster-1 = "E"
                 initialize str-func-degiskenler 20-hane
                 move veritabani-anah12              to 20-hane
                 move rapor-icmal-anah12             to str-func-index
                 perform veritabani-anah-to-aciklama
                 move 20-hane                        to str-func-alan
                 move "L"                            to str-func-align
                 move det-yerler-au(str-func-index)  to str-func-au
                 perform str-func
                 perform str-func-to-det-belirsiz
              end-if
           end-if
     end-if    

* Anahtar 2-1
     if rapor-icmal-anah21 > zeroes and 
        rapor-icmal-anah21 not > max-det-adlari
           if rapor-detaylar-ciksin(rapor-icmal-anah21)
              if veritabani-goster-2 = "E"
                 initialize str-func-degiskenler 20-hane
                 move rapor-icmal-anah21             to str-func-index
                 move veritabani-anah21              to 20-hane
                 perform veritabani-anah-to-aciklama
                 move 20-hane                        to str-func-alan
                 move "L"                            to str-func-align
                 move det-yerler-au(str-func-index)  to str-func-au
                 perform str-func
                 perform str-func-to-det-belirsiz
              end-if
           end-if
     end-if    
     
* Anahtar 2-2
     if rapor-icmal-anah22 > zeroes and 
        rapor-icmal-anah22 not > max-det-adlari
           if rapor-detaylar-ciksin(rapor-icmal-anah22)
              if veritabani-goster-2 = "E"
                 initialize str-func-degiskenler 20-hane
                 move rapor-icmal-anah22             to str-func-index
                 move veritabani-anah22              to 20-hane
                 perform veritabani-anah-to-aciklama
                 move 20-hane                        to str-func-alan
                 move "L"                            to str-func-align
                 move det-yerler-au(str-func-index)  to str-func-au
                 perform str-func
                 perform str-func-to-det-belirsiz
              end-if
           end-if
     end-if    

* Anahtar 3-1
     if rapor-icmal-anah31 > zeroes and 
        rapor-icmal-anah31 not > max-det-adlari
           if rapor-detaylar-ciksin(rapor-icmal-anah31)
              if veritabani-goster-3 = "E"
                 initialize str-func-degiskenler 20-hane
                 move rapor-icmal-anah31             to str-func-index
                 move veritabani-anah31              to 20-hane
                 perform veritabani-anah-to-aciklama
                 move 20-hane                        to str-func-alan
                 move "L"                            to str-func-align
                 move det-yerler-au(str-func-index)  to str-func-au
                 perform str-func
                 perform str-func-to-det-belirsiz
              end-if
           end-if
     end-if    

* Anahtar 3-2
     if rapor-icmal-anah32 > zeroes and 
        rapor-icmal-anah32 not > max-det-adlari
           if rapor-detaylar-ciksin(rapor-icmal-anah32)
              if veritabani-goster-3 = "E"
                 initialize str-func-degiskenler 20-hane
                 move rapor-icmal-anah32             to str-func-index
                 move veritabani-anah32              to 20-hane
                 perform veritabani-anah-to-aciklama
                 move 20-hane                        to str-func-alan
                 move "L"                            to str-func-align
                 move det-yerler-au(str-func-index)  to str-func-au
                 perform str-func
                 perform str-func-to-det-belirsiz
              end-if
           end-if
     end-if
    
* genel toplam satiri kontrolu
     if veritabani-anah = high-values
        initialize str-func-degiskenler
        if rapor-detaylar-ciksin(rapor-icmal-anah11)
           move rapor-icmal-anah11                to str-func-index
        else
           if rapor-detaylar-ciksin(rapor-icmal-anah12)
              move rapor-icmal-anah12             to str-func-index
           else
              if rapor-detaylar-ciksin(rapor-icmal-anah21)
                 move rapor-icmal-anah21          to str-func-index
              else
                 if rapor-detaylar-ciksin(rapor-icmal-anah22)
                    move rapor-icmal-anah22       to str-func-index
                 else
                    if rapor-detaylar-ciksin(rapor-icmal-anah31)
                       move rapor-icmal-anah31    to str-func-index
                    else
                       if rapor-detaylar-ciksin(rapor-icmal-anah32)
                          move rapor-icmal-anah32 to str-func-index
                       end-if
                    end-if
                 end-if
              end-if
           end-if
        end-if
        if str-func-index > zeroes and
           str-func-index not > max-det-adlari
               move "Toplam"                       to str-func-alan
               move "L"                            to str-func-align
               move det-yerler-au(str-func-index)  to str-func-au
               perform str-func
               perform str-func-to-det-belirsiz
        end-if
     end-if

* toplam detaylari aktariliyor
     perform varying veritabani-i 
             from 1 
             by 1 
             until veritabani-i > max-det-adlari
             if rapor-detaylar-ciksin(veritabani-i)
                if veritabani-deger(veritabani-i) > zeroes
                   if (veritabani-i = rapor-icmal-anah11) or
                      (veritabani-i = rapor-icmal-anah12) or
                      (veritabani-i = rapor-icmal-anah21) or
                      (veritabani-i = rapor-icmal-anah22) or
                      (veritabani-i = rapor-icmal-anah31) or
                      (veritabani-i = rapor-icmal-anah32)
                          exit perform cycle
                   else

                       initialize str-func-degiskenler
                       move veritabani-i                   to str-func-index
                       if rapor-icmal-detaylar-say(str-func-index)
                          move veritabani-deger(veritabani-i) to 15-z-kurussuz
                          move 15-z-kurussuz                  to str-func-alan
                       else
                          move veritabani-deger(veritabani-i) to 15-z
                          move 15-z                           to str-func-alan
                       end-if
                       move "R"                            to str-func-align
                       move det-yerler-au(str-func-index)  to str-func-au
                       perform str-func
                       perform str-func-to-det-belirsiz

                   end-if
                end-if
             end-if
     end-perform
     
     move det-belirsiz     to det-filler
     write dokumer-rec from detay.
*
 veritabani-anah-to-aciklama.
* veritabanindaki kodlar aciklamalarina 
* cevriliyor ... orn. 0001 -> AQUASUN gibi
*
     evaluate str-func-index
     when 1
     when 2
     when 3
     when 4
     when 5
     when 6
     when 7
          continue
     when 8
     when 9
          move 20-hane(1:2)               to egun
          move 20-hane(3:2)               to eay
          move 20-hane(5:4)               to eyil
          move eyil                       to 20-hane
     when 10
          evaluate 20-hane(1:1)
          when "1" move "Alotment"        to 20-hane
          when "2" move "It"              to 20-hane 
          when "3" move "Fit"             to 20-hane
          when "4" move "Grup"            to 20-hane
          when "5" move "Munferit"        to 20-hane
          when "6" move "Walk/in"         to 20-hane
          when "7" move "Sirket"          to 20-hane
          when "8" move "Ozel"            to 20-hane
          when other
               move "-Tanimsiz Kod"       to 20-hane(2:)
          end-evaluate
     when 11
          move 20-hane(1:2)               to kodlar02-kodu
          move "B"                        to kodlar02-tipi
          read kodlar02 no lock invalid
               move "Tanimsiz"  to kodlar02-adi
          end-read
          move kodlar02-adi               to 20-hane
     when 12
          move 20-hane(1:4)               to acenta-kodu
          read acenta no lock invalid
               move "Tanimsiz..."         to acenta-adi
          end-read
          move acenta-adi                 to 20-hane
     when 13
          move 20-hane(1:3)               to ulke-anah
          read ulke no lock invalid
               move "Tanimsiz..."         to ulke-adi
          end-read
          move ulke-adi                   to 20-hane
     when 14
          continue
     when 15
          move 20-hane(1:2)               to kodlar02-kodu
          move "D"                        to kodlar02-tipi
          read kodlar02 no lock invalid
               move "Tanimsiz"            to kodlar02-adi
          end-read
          move kodlar02-adi               to 20-hane
     when 16
          move 20-hane(1:2)               to banka-kodu
          read banka no lock invalid
               move "Tanimsiz..."         to banka-adi
          end-read
          move banka-adi                  to 20-hane
     when 17
          move 20-hane(1:2)               to doviz-kodu
          read doviz no lock invalid
               move "Tanimsiz..."         to d-adi-1
          end-read
          move d-adi-1                    to 20-hane
     when 18
     when 19
     when 20
          continue
     when 21
          move 20-hane(1:2)               to kodlar02-kodu
          move "E"                        to kodlar02-tipi
          read kodlar02 no lock invalid
               move "Tanimsiz"            to kodlar02-adi
          end-read
          move kodlar02-adi               to 20-hane
     when 22
          if 20-hane(1:2) = "E"
             move "=E.Book."              to 20-hane
          else
             move "<>E.Book."             to 20-hane
          end-if
     when 23
          continue
     when 24
          evaluate 20-hane(1:2)
          when "A" move "Aylik Kur"       to 20-hane
          when "G" move "Gunluk Kur"      to 20-hane
          when "O" move "Ort. Kur"        to 20-hane
          when other
               move "Tanimsiz ..."        to 20-hane
          end-evaluate
     when 25
          move 20-hane(1:1)               to konum-anahtar
          read konum no lock invalid
               move "Tanimsiz..."         to konum-adi
          end-read
          move konum-adi                  to 20-hane
     when 26
          evaluate 20-hane(1:1)
          when "S" move "Single"          to 20-hane
          when "D" move "Double"          to 20-hane
          when "T" move "Triple"          to 20-hane
          when "G" move "Group"           to 20-hane
          when other
               move "Tanimsiz..."         to 20-hane
          end-evaluate
     when 27
     when 28
     when 29
     when 30
          continue
     when 31
          move rez-staf                   to k-kodu
          read kllnc no lock invalid
               move "Tanimsiz..."         to k-adi
          end-read
          move k-adi                      to 20-hane
     end-evaluate.
*
 detay-ata.
     if dokumere-yolla
        initialize dokumer-rec detay det-belirsiz
        if rapor-detaylar-ciksin(1)
           initialize str-func-degiskenler
           move 1                                 to str-func-index
           move rez-anah                          to str-func-alan
           move "R"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           if not rapor-icmal-detaylar-yok(1)
              add 1 to detay-toplam(1)
           end-if
        end-if

        if rapor-detaylar-ciksin(2)
           initialize str-func-degiskenler
           move 2                                 to str-func-index
           move rez-adi                           to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           if not rapor-icmal-detaylar-yok(2)
              add 1 to detay-toplam(2)
           end-if
        end-if


        if rapor-detaylar-ciksin(3)
           initialize str-func-degiskenler
           move 3                                 to str-func-index
           move rez-soyadi                        to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           if not rapor-icmal-detaylar-yok(3)
              add 1 to detay-toplam(3)
           end-if
        end-if

        if rapor-detaylar-ciksin(4)
           initialize str-func-degiskenler
           move 4                                 to str-func-index
           move rez-buyuk                         to 4-z
           move 4-z                               to str-func-alan
           move "R"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(4)
                add 1 to detay-toplam(4)
           when rapor-icmal-detaylar-topla(4)
                add rez-buyuk to detay-toplam(4)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(5)
           initialize str-func-degiskenler
           move 5                                 to str-func-index
           move rez-kucuk                         to 4-z
           move 4-z                               to str-func-alan
           move "R"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(5)
                add 1 to detay-toplam(5)
           when rapor-icmal-detaylar-topla(5)
                add rez-kucuk to detay-toplam(5)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(6)
           initialize str-func-degiskenler
           move 6                                 to str-func-index
           move rez-free                          to 4-z
           move 4-z                               to str-func-alan
           move "R"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(6)
                add 1 to detay-toplam(6)
           when rapor-icmal-detaylar-topla(6)
                add rez-free to detay-toplam(6)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(7)
           initialize str-func-degiskenler
           move 7                                 to str-func-index
           move rez-bebek                         to 4-z
           move 4-z                               to str-func-alan
           move "R"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(7)
                add 1 to detay-toplam(7)
           when rapor-icmal-detaylar-topla(7)
                add rez-bebek to detay-toplam(7)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(8)
           initialize str-func-degiskenler
           move 8                                 to str-func-index
           move rez-gir-gun                       to egun
           move rez-gir-ay                        to eay 
           move rez-gir-yil                       to eyil
           move etarih                            to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(8)
           when rapor-icmal-detaylar-topla(8)
                add 1 to detay-toplam(8)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(9)
           initialize str-func-degiskenler
           move 9                                 to str-func-index
           move rez-cik-gun                       to egun
           move rez-cik-ay                        to eay 
           move rez-cik-yil                       to eyil
           move etarih                            to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(9)
           when rapor-icmal-detaylar-topla(9)
                add 1 to detay-toplam(9)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(10)
           initialize str-func-degiskenler
           move 10                                to str-func-index
           evaluate rez-tipi
             when 1  move "Alotment" to str-func-alan
             when 2  move "It"       to str-func-alan
             when 3  move "Fit"      to str-func-alan
             when 4  move "Grup"     to str-func-alan
             when 5  move "Munferit" to str-func-alan
             when 6  move "Walk/in"  to str-func-alan
             when 7  move "Sirket"   to str-func-alan
             when 8  move "Ozel"     to str-func-alan
           end-evaluate
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(10)
           when rapor-icmal-detaylar-topla(10)
                add 1 to detay-toplam(10)
           end-evaluate
        end-if


        move rez-odeme-tipi          to kodlar02-kodu
        move "B"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"  to kodlar02-adi
        end-read


        if rapor-detaylar-ciksin(11)
           initialize str-func-degiskenler
           move 11                                to str-func-index
           move kodlar02-adi                      to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(11)
           when rapor-icmal-detaylar-topla(11)
                add 1 to detay-toplam(11)
           end-evaluate
        end-if



        move rez-acenta              to acenta-anahtar
        read acenta no lock invalid             move "Tanimsiz"   to acenta-adi
        end-read

        if rapor-detaylar-ciksin(12)
           initialize str-func-degiskenler
           move 12                                to str-func-index
           move acenta-adi                        to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(12)
           when rapor-icmal-detaylar-topla(12)
                add 1 to detay-toplam(12)
           end-evaluate
        end-if



        move rez-ulke                to ulke-anah
        read ulke no lock invalid 
             move "Tanimsiz"         to ulke-adi
        end-read


        if rapor-detaylar-ciksin(13)
           initialize str-func-degiskenler
           move 13                                to str-func-index
           move ulke-adi                          to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(13)
           when rapor-icmal-detaylar-topla(13)
                add 1 to detay-toplam(13)
           end-evaluate
        end-if


        if rapor-detaylar-ciksin(14)
           initialize str-func-degiskenler
           move 14                                to str-func-index
           move rez-voucher                       to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(14)
           when rapor-icmal-detaylar-topla(14)
                add 1 to detay-toplam(14)
           end-evaluate
        end-if


        move rez-anlasma             to kodlar02-kodu
        move "D"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"     to kodlar02-adi
        end-read

        if rapor-detaylar-ciksin(15)
           initialize str-func-degiskenler
           move 15                                to str-func-index
           move kodlar02-adi                      to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(15)
           when rapor-icmal-detaylar-topla(15)
                add 1 to detay-toplam(15)
           end-evaluate
        end-if


        if rapor-detaylar-ciksin(16)
           initialize str-func-degiskenler
           move 16                                to str-func-index
           move rez-banka                         to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(16)
           when rapor-icmal-detaylar-topla(16)
                add 1 to detay-toplam(16)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(17)
           initialize str-func-degiskenler
           move 17                                to str-func-index
           move rez-doviz                         to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(17)
           when rapor-icmal-detaylar-topla(17)
                add 1 to detay-toplam(17)
           end-evaluate
        end-if


        if rapor-detaylar-ciksin(18)
           initialize str-func-degiskenler
           move 18                                to str-func-index
           move rez-fiyati                        to 15-z
           move 15-z                              to str-func-alan
           move "R"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(18)
                add 1 to detay-toplam(18)
           when rapor-icmal-detaylar-topla(18)
                add rez-fiyati to detay-toplam(18)
           end-evaluate
        end-if


        move rez-gir-tar             to g-bul-ilk-tarih
        move rez-cik-tar             to g-bul-son-tarih
        perform g-bul thru g-bul-exit


        if rapor-detaylar-ciksin(19)
           initialize str-func-degiskenler
           move 19                                to str-func-index
           move g-bul-gun-sayisi                  to 4-z 
           move 4-z                               to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(19)
                add 1 to detay-toplam(19)
           when rapor-icmal-detaylar-topla(19)
                add g-bul-gun-sayisi to detay-toplam(19)
           end-evaluate
        end-if


        if gayriresmi = 1 then 
           add 1 to ilk
           move rez-acenta to buffer-acenta acenta-kodu
           move "AL" to acenta-kodu(1:2)
           read acenta no lock invalid
                if ilk not = 1 then
                   move 1 to ilk
                  display message box "Bu acentanin alternatifi yok"
                end-if
              not invalid
                move acenta-kodu   to  rez-acenta
           end-read
        end-if

* peryot-hesaplansinmi 1=> hesaplama yok
*                      0=> hesaplama var
* DIGGGATTTTTT !!! 
        if peryot-hesaplansinmi = 0
           perform peryot-fiyat-bul
        else
           initialize top-rez-fiyati
        end-if

        if gayriresmi = 1 then 
           move buffer-acenta to rez-acenta
        end-if
        
        if top-rez-fiyati <> zeroes
           move top-rez-fiyati    to temp-sayi
        else
           compute temp-sayi = g-bul-gun-sayisi * rez-fiyati
        end-if
        compute t-tutar   = t-tutar + temp-sayi


        if rapor-detaylar-ciksin(20)
           initialize str-func-degiskenler
           move 20                                to str-func-index
           move temp-sayi                         to 15-z
           move 15-z                              to str-func-alan
           move "R"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(20)
                add 1 to detay-toplam(20)
           when rapor-icmal-detaylar-topla(20)
                add temp-sayi to detay-toplam(20)
           end-evaluate
        end-if


        move rez-pazar               to kodlar02-kodu
        move "E"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"         to kodlar02-adi
        end-read

        if rapor-detaylar-ciksin(21)
           initialize str-func-degiskenler
           move 21                                to str-func-index
           move kodlar02-adi                      to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(21)
           when rapor-icmal-detaylar-topla(21)
                add 1 to detay-toplam(21)
           end-evaluate
        end-if


        if rapor-detaylar-ciksin(22)
           initialize str-func-degiskenler
           move 22                                to str-func-index
           move rez-eb                            to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(22)
           when rapor-icmal-detaylar-topla(22)
                add 1 to detay-toplam(22)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(23)
           initialize str-func-degiskenler
           move 23                                to str-func-index
           move rez-pan-tipi                      to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(23)
           when rapor-icmal-detaylar-topla(23)
                add 1 to detay-toplam(23)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(24)
           initialize str-func-degiskenler
           move 24                                to str-func-index
           move rez-kur-aygun                     to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(24)
           when rapor-icmal-detaylar-topla(24)
                add 1 to detay-toplam(24)
           end-evaluate
        end-if


        move rez-oda-konumu          to konum-anahtar
        read konum no lock invalid
             move "Tanimsiz" to konum-adi
        end-read

        if rapor-detaylar-ciksin(25)
           initialize str-func-degiskenler
           move 25                                to str-func-index
           move konum-adi                         to str-func-alan
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(25)
           when rapor-icmal-detaylar-topla(25)
                add 1 to detay-toplam(25)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(26)
           initialize str-func-degiskenler
           move 26                                to str-func-index
           evaluate rez-s-d-t-g
             when 1 move "Single"    to str-func-alan
             when 2 move "Double"    to str-func-alan
             when 3 move "Triple"    to str-func-alan
             when 4 move "Grup"      to str-func-alan
           end-evaluate
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(26)
           when rapor-icmal-detaylar-topla(26)
                add 1 to detay-toplam(26)
           end-evaluate
        end-if

        if rapor-detaylar-ciksin(27)
           initialize str-func-degiskenler
           move rez-odano                         to str-func-alan
           move 27                                to str-func-index
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(27)
           when rapor-icmal-detaylar-topla(27)
                add 1 to detay-toplam(27)
           end-evaluate
        end-if


        if rapor-detaylar-ciksin(28)
           initialize str-func-degiskenler
           move rez-grup-no                       to str-func-alan
           move 28                                to str-func-index
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(28)
           when rapor-icmal-detaylar-topla(28)
                add 1 to detay-toplam(28)
           end-evaluate
        end-if


        if rapor-detaylar-ciksin(29)
           initialize str-func-degiskenler
           move rez-nor-indirim                   to 2-z
           move 2-z                               to str-func-alan
           move 29                                to str-func-index
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(29)
           when rapor-icmal-detaylar-topla(29)
                add 1 to detay-toplam(29)
           end-evaluate
        end-if


        if rapor-detaylar-ciksin(30)
           initialize str-func-degiskenler
           move rez-komisyon                      to 2-z
           move 2-z                               to str-func-alan
           move 30                                to str-func-index
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(30)
           when rapor-icmal-detaylar-topla(30)
                add 1 to detay-toplam(30)
           end-evaluate
        end-if

        move rez-staf                to k-kodu
        read kllnc no lock invalid
             move "Tanimsiz"     to k-adi
        end-read

        if rapor-detaylar-ciksin(31)
           initialize str-func-degiskenler
           move k-adi                             to str-func-alan
           move 31                                to str-func-index
           move "L"                               to str-func-align
           move det-yerler-au(str-func-index)     to str-func-au
           perform str-func
           perform str-func-to-det-belirsiz
           evaluate true
           when rapor-icmal-detaylar-say(31)
           when rapor-icmal-detaylar-topla(31)
                add 1 to detay-toplam(31)
           end-evaluate
        end-if

        compute t-oda   = t-oda   + 1
        compute t-pax   = t-pax   + rez-buyuk
        compute t-chi   = t-chi   + rez-kucuk
        compute t-fre   = t-fre   + rez-free
        compute t-beb   = t-beb   + rez-bebek
        if not rapor-icmal-sekil-icmal
           move det-belirsiz     to det-filler
           write dokumer-rec from detay
        end-if
        if not rapor-icmal-sekil-detay
           perform veritabani-kaydet
        end-if
        perform takas-kaydet
     else
        initialize form3-gd-1-record
        move rez-anah                to gd-1-col-1
        move rez-adi                 to gd-1-col-2
        move rez-soyadi              to gd-1-col-3
        move rez-buyuk               to 4-z
        move 4-z                     to gd-1-col-4
        move rez-kucuk               to 4-z
        move 4-z                     to gd-1-col-5
        move rez-free                to 4-z
        move 4-z                     to gd-1-col-6
        move rez-bebek               to 4-z
        move 4-z                     to gd-1-col-66
        move rez-gir-gun             to egun
        move rez-gir-ay              to eay
        move rez-gir-yil             to eyil
        move etarih                  to gd-1-col-7
        move rez-cik-gun             to egun
        move rez-cik-ay              to eay
        move rez-cik-yil             to eyil
        move etarih                  to gd-1-col-8
        evaluate rez-tipi
             when 1  move "Alotment" to gd-1-col-9
             when 2  move "It"       to gd-1-col-9
             when 3  move "Fit"      to gd-1-col-9
             when 4  move "Grup"     to gd-1-col-9
             when 5  move "Munferit" to gd-1-col-9
             when 6  move "Walk/in"  to gd-1-col-9
             when 7  move "Sirket"   to gd-1-col-9
             when 8  move "Ozel"     to gd-1-col-9
        end-evaluate
        move rez-odeme-tipi          to kodlar02-kodu
        move "B"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"  to kodlar02-adi
        end-read
        move kodlar02-adi            to gd-1-col-10
        move rez-acenta              to acenta-anahtar
        read acenta no lock invalid
             move "Tanimsiz"   to acenta-adi
        end-read
        move acenta-adi              to gd-1-col-11
        move rez-ulke                to ulke-anah
        read ulke no lock invalid 
             move "Tanimsiz"         to ulke-adi
        end-read
        move ulke-adi                to gd-1-col-12
        move rez-voucher             to gd-1-col-13
        move rez-anlasma             to kodlar02-kodu
        move "D"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"     to kodlar02-adi
        end-read
        move kodlar02-adi            to gd-1-col-14
        move rez-banka               to gd-1-col-15
        move rez-doviz               to gd-1-col-16
        move rez-fiyati              to 15-z
        move 15-z                    to gd-1-col-17
        move rez-gir-tar             to g-bul-ilk-tarih
        move rez-cik-tar             to g-bul-son-tarih
        perform g-bul thru g-bul-exit
        move g-bul-gun-sayisi        to 4-z
        move 4-z                     to gd-1-col-18
* peryot-hesaplansinmi 1=> hesaplama yok
*                      0=> hesaplama var
* DIGGGATTTTTT !!! 
        if peryot-hesaplansinmi = 0
           perform peryot-fiyat-bul
        else
           initialize top-rez-fiyati
        end-if
        if top-rez-fiyati <> zeroes
           move top-rez-fiyati    to temp-sayi
        else
           compute temp-sayi = g-bul-gun-sayisi * rez-fiyati
        end-if
        move temp-sayi               to 15-z
        move 15-z                    to gd-1-col-19
        move rez-pazar               to kodlar02-kodu
        move "E"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"      to kodlar02-adi
        end-read
        move kodlar02-adi            to gd-1-col-20
        move rez-eb                  to gd-1-col-21
        move rez-pan-tipi            to gd-1-col-22
        move rez-kur-aygun           to gd-1-col-23
        move rez-oda-konumu          to konum-anahtar
        read konum no lock invalid
             move "Tanimsiz" to konum-adi
        end-read
        move konum-adi               to gd-1-col-24
        evaluate rez-s-d-t-g
             when 1 move "Single"    to gd-1-col-25
             when 2 move "Double"    to gd-1-col-25
             when 3 move "Triple"    to gd-1-col-25
             when 4 move "Grup"      to gd-1-col-25
        end-evaluate
        move rez-odano               to gd-1-col-26
        move rez-grup-no             to gd-1-col-27
        move rez-nor-indirim         to 2-z
        move 2-z                     to gd-1-col-28
        move rez-komisyon            to gd-1-col-29
        move rez-staf                to k-kodu
        read kllnc no lock invalid
             move "Tanimsiz"     to k-adi
        end-read
        move k-adi                   to gd-1-col-30

        modify form3-gd-1,
               record-to-add(form3-gd-1-record)
        perform takas-kaydet

     end-if.
 takas-kaydet.
     initialize takas-rec
     if combo-toplamlar-value(1:1) <> "A"
        evaluate combo-toplamlar-value(1:1)
            when "B"  move rez-pazar        to takas-anahtar1
            when "C"  move rez-pan-tipi     to takas-anahtar1
            when "D"  move rez-ulke         to takas-anahtar1
            when "E"  move rez-anlasma      to takas-anahtar1
            when "F"  move rez-s-d-t-g      to takas-anahtar1
            when "G"  move rez-oda-konumu   to takas-anahtar1
            when "H"  move rez-odeme-tipi   to takas-anahtar1
            when "I"  move rez-doviz        to takas-anahtar1
            when "J"  move rez-eb           to takas-anahtar1
            when "K"  move rez-acenta       to takas-anahtar1
        end-evaluate
        move low-values                     to takas-anahtar2
        read takas no lock invalid 
             continue
        end-read
        add rez-buyuk         to takas-pax
        add rez-kucuk         to takas-child
        add rez-free          to takas-free
        add rez-bebek         to takas-bebek
        add temp-sayi         to takas-fiyat 
        add 1                 to takas-adet
        write takas-rec invalid
              rewrite takas-rec end-rewrite
        end-write
        if esleme-i > 0
           initialize takas-rec
           evaluate combo-toplamlar-value(1:1)
               when "B"  move rez-pazar        to takas-anahtar1
               when "C"  move rez-pan-tipi     to takas-anahtar1
               when "D"  move rez-ulke         to takas-anahtar1
               when "E"  move rez-anlasma      to takas-anahtar1
               when "F"  move rez-s-d-t-g      to takas-anahtar1
               when "G"  move rez-oda-konumu   to takas-anahtar1
               when "H"  move rez-odeme-tipi   to takas-anahtar1
               when "I"  move rez-doviz        to takas-anahtar1
               when "J"  move rez-eb           to takas-anahtar1
               when "K"  move rez-acenta       to takas-anahtar1
           end-evaluate

           evaluate esleme-i
               when 01 move rez-acenta       to takas-anahtar2
               when 02 move rez-pan-tipi     to takas-anahtar2
               when 03 move rez-anlasma      to takas-anahtar2
               when 04 move rez-oda-konumu   to takas-anahtar2
               when 05 move rez-doviz        to takas-anahtar2
               when 06 move rez-pazar        to takas-anahtar2
               when 07 move rez-ulke         to takas-anahtar2
               when 08 move rez-s-d-t-g      to takas-anahtar2
               when 09 move rez-odeme-tipi   to takas-anahtar2
               when 10 move rez-eb           to takas-anahtar2
           end-evaluate
           read takas no lock invalid 
                continue
           end-read
           add rez-buyuk         to takas-pax
           add rez-kucuk         to takas-child
           add rez-free          to takas-free
           add rez-bebek         to takas-bebek
           add temp-sayi         to takas-fiyat 
           add 1                 to takas-adet
           write takas-rec invalid
                 rewrite takas-rec end-rewrite
           end-write
        end-if
     end-if.
 veritabani-kaydet.
     initialize veritabani-rec
* kayýt yapisi
* 1. duzey     1.ci anah fill
*              2.ci anah low
*              3.cu anah low
*
* 2.duzay      1.ci anah fill
*              2.ci anah fill
*              3.cu anah low
*
* 3.duzey      1.ci 2.ci 3.cu anah fill
*


* 1. duzey kaydi**********************************************
     if (rapor-icmal-anah11 > 0 and 
         rapor-icmal-anah11 not > max-det-adlari) or
        (rapor-icmal-anah12 > 0 and 
         rapor-icmal-anah12 not > max-det-adlari)
         move 1                     to veritabani-duzey
         move rapor-icmal-anah11    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah11
         move rapor-icmal-anah12    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah12
     
         move low-values            to veritabani-anah21
                                       veritabani-anah22
                                       veritabani-anah31
                                       veritabani-anah32

         read veritabani no lock invalid  
              continue
         end-read

         perform veritabani-sahalar-move

         move "E"              to veritabani-goster-1
         move "H"              to veritabani-goster-2
         move "H"              to veritabani-goster-3
         write veritabani-rec invalid
               rewrite veritabani-rec invalid
                       continue
               end-rewrite
         end-write
     end-if.

* 2. duzey kaydi**********************************************
     if (rapor-icmal-anah21 > 0 and 
         rapor-icmal-anah21 not > max-det-adlari) or
        (rapor-icmal-anah22 > 0 and 
         rapor-icmal-anah22 not > max-det-adlari)
         initialize veritabani-rec
         move 2                     to veritabani-duzey
         move rapor-icmal-anah11    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah11
         move rapor-icmal-anah12    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah12
    
         move rapor-icmal-anah21    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah21
         move rapor-icmal-anah22    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah22
    

         move low-values            to veritabani-anah31
                                       veritabani-anah32

         read veritabani no lock invalid  
              continue
         end-read

         perform veritabani-sahalar-move
         move "H"              to veritabani-goster-1
         move "E"              to veritabani-goster-2
         move "H"              to veritabani-goster-3
         write veritabani-rec invalid
               rewrite veritabani-rec invalid
                       continue
               end-rewrite
         end-write
     end-if.
* 3. duzey kaydi**********************************************
     if (rapor-icmal-anah31 > 0 and 
         rapor-icmal-anah31 not > max-det-adlari) or
        (rapor-icmal-anah32 > 0 and 
         rapor-icmal-anah32 not > max-det-adlari)
         initialize veritabani-rec
         move 3                     to veritabani-duzey
         move rapor-icmal-anah11    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah11
         move rapor-icmal-anah12    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah12

         move rapor-icmal-anah21    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah21
         move rapor-icmal-anah22    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah22

         move rapor-icmal-anah31    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah31
         move rapor-icmal-anah32    to veritabani-anah-no
         perform veritabani-anah-move
         move 20-hane               to veritabani-anah32

         read veritabani no lock invalid  
              continue
         end-read

         perform veritabani-sahalar-move
         move "H"              to veritabani-goster-1
         move "H"              to veritabani-goster-2
         move "E"              to veritabani-goster-3
         write veritabani-rec invalid
               rewrite veritabani-rec invalid
                       continue
               end-rewrite
         end-write
     end-if.

* genel toplam satiri high values ataniyor ...
     initialize veritabani-rec
     move all high-values to veritabani-anah
     read veritabani no lock invalid  
          continue
     end-read
     perform veritabani-sahalar-move
     move "H"              to veritabani-goster-1
     move "H"              to veritabani-goster-2
     move "H"              to veritabani-goster-3
     write veritabani-rec invalid
           rewrite veritabani-rec invalid
                   continue
           end-rewrite
     end-write.

 veritabani-sahalar-move.
     perform varying veritabani-i
             from 1
             by 1
             until veritabani-i > max-det-adlari
             evaluate true
             when rapor-icmal-detaylar-say(veritabani-i)
                  add 1 to veritabani-deger(veritabani-i)
             when rapor-icmal-detaylar-topla(veritabani-i)
             evaluate veritabani-i
             when 1
             when 2
             when 3
                  add 1                 to veritabani-deger(veritabani-i)
             when 4
                  add rez-buyuk         to veritabani-deger(veritabani-i)
             when 5
                  add rez-kucuk         to veritabani-deger(veritabani-i)
             when 6
                  add rez-free          to veritabani-deger(veritabani-i)
             when 7 
                  add rez-bebek         to veritabani-deger(veritabani-i)
             when 8
             when 9
             when 10
             when 11
             when 12
             when 13
             when 14
             when 15
             when 16
             when 17
                  add 1                 to veritabani-deger(veritabani-i)
             when 18
                  add rez-fiyati        to veritabani-deger(veritabani-i)
             when 19
                  add g-bul-gun-sayisi  to veritabani-deger(veritabani-i)
             when 20
                  add temp-sayi         to veritabani-deger(veritabani-i)
             when 21
             when 22
             when 23
             when 24
             when 25
             when 26
             when 27
             when 28
                  add 1                 to veritabani-deger(veritabani-i)
             when 29
                  add rez-nor-indirim   to veritabani-deger(veritabani-i)
             when 30
                  add rez-komisyon      to veritabani-deger(veritabani-i)
             when 31
                  add 1                 to veritabani-deger(veritabani-i)

             end-evaluate
             end-evaluate
     end-perform.
*
 veritabani-anah-move.
     initialize 20-hane
     evaluate veritabani-anah-no
     when 01
          move rez-no           to 20-hane
     when 02
          move rez-adi          to 20-hane
     when 03
          move rez-soyadi       to 20-hane
     when 04
          move rez-buyuk        to 20-hane
     when 05 
          move rez-kucuk        to 20-hane
     when 06   
          move rez-free         to 20-hane
     when 07
          move rez-bebek        to 20-hane
     when 08
          move rez-gir-tar      to 20-hane
     when 09
          move rez-cik-tar      to 20-hane
     when 10
          move rez-tipi         to 20-hane
     when 11
          move rez-odeme-tipi   to 20-hane
     when 12
          move rez-acenta       to 20-hane
     when 13
          move rez-ulke         to 20-hane
     when 14 
          move rez-voucher      to 20-hane
     when 15 
          move rez-anlasma      to 20-hane
     when 16
          move rez-banka        to 20-hane
     when 17 
          move rez-doviz        to 20-hane
     when 18 
          move rez-fiyati       to 15-z
          move 15-z             to 20-hane
     when 19
          move g-bul-gun-sayisi to 4-z
          move 4-z              to 20-hane
     when 20
          move temp-sayi        to 15-z
          move 15-z             to 20-hane
     when 21
          move rez-pazar        to 20-hane
     when 22
          move rez-eb           to 20-hane
     when 23
          move rez-pan-tipi     to 20-hane
     when 24 
          move rez-kur-aygun    to 20-hane
     when 25 
          move rez-oda-konumu   to 20-hane
     when 26 
          move rez-s-d-t-g      to 20-hane
     when 27 
          move rez-odano        to 20-hane
     when 28 
          move rez-grup-no      to 20-hane
     when 29
          move rez-nor-indirim  to 2-z
          move 2-z              to 20-hane
     when 30
          move rez-komisyon     to 20-hane
     when 31 
          move rez-staf         to 20-hane
     end-evaluate.
*
 liste-toplam.
     perform varying i
             from 1
             by 1
             until i > max-det-adlari
             if rapor-detaylar-ciksin(i)
                initialize str-func-degiskenler
                move i                              to str-func-index
                if rapor-icmal-detaylar-say(str-func-index)
                   move detay-toplam(i)  to 15-z-kurussuz
                   move 15-z-kurussuz    to str-func-alan
                else
                   move detay-toplam(i)  to 15-z
                   move 15-z             to str-func-alan
                end-if
                move "R"                 to str-func-align
                move det-yerler-au(i)    to str-func-au
                perform str-func
                perform str-func-to-det-belirsiz
             end-if
     end-perform.
     move det-belirsiz     to det-filler
     write dokumer-rec from detay.

*
 Form3-Aft-Initdata.
     if combo-toplamlar-value(1:1) = "A"
        modify button-toplamlar,enabled = false
     else
        modify button-toplamlar,enabled = true
     end-if.
     modify form3-gd-1,
            reset-grid  = 1 
            mass-update = 1
     initialize form3-gd-1-record
     move "Rez.no"           to gd-1-col-1
     move "Adi"              to gd-1-col-2
     move "Soyadi"           to gd-1-col-3
     move "Pax"              to gd-1-col-4
     move "Chi"              to gd-1-col-5
     move "Free"             to gd-1-col-6
     move "Beb."             to gd-1-col-66
     move "C/in"             to gd-1-col-7
     move "C/out"            to gd-1-col-8
     move "Rez.T"            to gd-1-col-9
     move "Odeme"            to gd-1-col-10
     move "Acenta"           to gd-1-col-11
     move "Ulke"             to gd-1-col-12
     move "Voucher"          to gd-1-col-13
     move "Anlas"            to gd-1-col-14
     move "Bn"               to gd-1-col-15
     move "Dv"               to gd-1-col-16
     move "Rez.Fiyati"       to gd-1-col-17
     move "Gun"              to gd-1-col-18
     move "Toplam Rez.Fiyati" to gd-1-col-19
     move "Pazar"            to gd-1-col-20
     move "X"                to gd-1-col-21
     move "Pk"               to gd-1-col-22
     move "K"                to gd-1-col-23
     move "Konum"            to gd-1-col-24
     move "Tip"              to gd-1-col-25
     move "Oda"              to gd-1-col-26
     move "Grup"             to gd-1-col-27
     move "IO"               to gd-1-col-28
     move "KO"               to gd-1-col-29
     move "Staff"            to gd-1-col-30.
     modify form3-gd-1,
            record-to-add(form3-gd-1-record).

     perform islem.

     modify form3-gd-1,
            mass-update = 0.
*
 Form3-Gd-1-Ev-Other.
    evaluate event-type
        when msg-begin-entry
             move event-action-fail to event-action
             exit paragraph
        when msg-goto-cell
        when msg-goto-cell-mouse
        when msg-begin-drag
        when msg-end-drag
        when msg-goto-cell-drag
             inquire form3-gd-1,y in yeni-y
             if yeni-y < 2
                move 2 to yeni-y eski-y
             end-if
             if eski-y > zeroes 
                modify form3-gd-1(eski-y),
                       x = 2
                       row-color = 0
                       cell-color = 0
             end-if
             modify form3-gd-1,
                    y = yeni-y,
                    x = 2,
                    row-color = 480
                    cell-color = 480
             move yeni-y to eski-y
    end-evaluate.
*
 Form4-Aft-Initdata.
    open input acenta ulke kodlar02 konum doviz.
    modify form4-gd-1,reset-grid = 1 mass-update = 1 
    initialize form4-gd-1-record
    move "Kodu"       to gd-4-col-1
    move "Adi"        to gd-4-col-2
    move "Pax"        to gd-4-col-3
    move "Child"      to gd-4-col-4
    move "Free"       to gd-4-col-5
    move "Beb."       to gd-4-col-55
    move "Rez.Fiyati" to gd-4-col-6
    modify form4-gd-1,
           record-to-add(form4-gd-1-record)
    initialize takas-rec
    start takas key not < takas-anahtar invalid
          continue
    not invalid
    initialize fs-takas esleme-kayit-sayi
    perform with test after until fs-takas = "10"
    read takas next no lock end move "10" to fs-takas
    not at end
         initialize form4-gd-1-record
         move takas-anahtar1      to gd-4-col-1
         evaluate combo-toplamlar-value(1:1)
              when "B"
                   move takas-anahtar1 to kodlar02-kodu
                   move "E"           to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi  to gd-4-col-2
              when "C"
                   move takas-anahtar1 to kodlar02-kodu
                   move "A"           to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi     to gd-4-col-2
              when "D"
                   move takas-anahtar1    to ulke-anah
                   read ulke no lock invalid
                        move "Tanimsiz"  to ulke-adi
                   end-read
                   move ulke-adi         to gd-4-col-2
              when "E"
                   move takas-anahtar1    to kodlar02-kodu
                   move "D"              to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi     to gd-4-col-2
              when "F"
                   evaluate takas-anahtar1(1:1)
                       when "1" move "Single"   to gd-4-col-2
                       when "2" move "Double"   to gd-4-col-2
                       when "3" move "Triple"   to gd-4-col-2
                       when "4" move "Grup"     to gd-4-col-2
                   end-evaluate
              when "G"
                   move takas-anahtar1           to konum-anahtar
                   read konum no lock invalid
                        move "Tanimsiz"         to konum-adi
                   end-read
                   move konum-adi               to gd-4-col-2
              when "H"
                   move takas-anahtar1           to kodlar02-kodu
                   move "B"                     to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"         to kodlar02-adi
                   end-read
                   move kodlar02-adi            to gd-4-col-2
              when "I"
                   move takas-anahtar1           to doviz-kodu
                   read doviz no lock invalid
                        move "Tanimsiz"         to d-adi-1
                   end-read
                   move d-adi-1                 to gd-4-col-2
              when "J"
                   evaluate takas-anahtar1(1:1)
                       when "E" move "Erken  Rezervasyon"   to gd-4-col-2
                       when "H" move "Normal Rezervasyon"   to gd-4-col-2
                       when other move "Normal Rezervasyon"   to gd-4-col-2
                   end-evaluate
              when "K"
                   move takas-anahtar1           to acenta-kodu
                   read acenta no lock invalid
                        move "Tanimsiz"         to acenta-adi
                   end-read
                   move acenta-adi              to gd-4-col-2
         end-evaluate

         if takas-anahtar2 <> low-values and esleme-i <> 0
            initialize form4-gd-1-record
            evaluate esleme-i
                when 01
                   move takas-anahtar2           to acenta-kodu
                   read acenta no lock invalid
                        move "Tanimsiz"          to acenta-adi
                   end-read
                   move acenta-adi                to gd-4-col-2
                when 02
                   move takas-anahtar2 to kodlar02-kodu
                   move "A"           to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi     to gd-4-col-2
                when 03
                   move takas-anahtar2    to kodlar02-kodu
                   move "D"              to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi     to gd-4-col-2
                when 04
                   move takas-anahtar2           to konum-anahtar
                   read konum no lock invalid
                        move "Tanimsiz"         to konum-adi
                   end-read
                   move konum-adi               to gd-4-col-2
                when 05
                   move takas-anahtar2           to doviz-kodu
                   read doviz no lock invalid
                        move "Tanimsiz"         to d-adi-1
                   end-read
                   move d-adi-1                 to gd-4-col-2
                when 06
                   move takas-anahtar2 to kodlar02-kodu
                   move "E"           to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi  to gd-4-col-2
                when 07
                   move takas-anahtar2    to ulke-anah
                   read ulke no lock invalid
                        move "Tanimsiz"  to ulke-adi
                   end-read
                   move ulke-adi         to gd-4-col-2
                when 08
                   evaluate takas-anahtar2(1:1)
                       when "1" move "Single"   to gd-4-col-2
                       when "2" move "Double"   to gd-4-col-2
                       when "3" move "Triple"   to gd-4-col-2
                       when "4" move "Grup"     to gd-4-col-2
                   end-evaluate
                when 09
                   move takas-anahtar2           to kodlar02-kodu
                   move "B"                     to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"         to kodlar02-adi
                   end-read
                   move kodlar02-adi            to gd-4-col-2
                when 10
                   evaluate takas-anahtar2(1:1)
                       when "E" move "Erken  Rezervasyon"   to gd-4-col-2
                       when "H" move "Normal Rezervasyon"   to gd-4-col-2
                       when other move "Normal Rezervasyon"   to gd-4-col-2
                   end-evaluate
            end-evaluate
         end-if
         move takas-pax          to 5-z
         move 5-z                to gd-4-col-3
         move takas-child        to 5-z
         move 5-z                to gd-4-col-4
         move takas-free         to 5-z
         move 5-z                to gd-4-col-5
         move takas-bebek        to 5-z
         move 5-z                to gd-4-col-55
         move takas-fiyat        to 15-z
         move 15-z               to gd-4-col-6
         add 1 to esleme-kayit-sayi
         modify form4-gd-1,
                record-to-add(form4-gd-1-record)
         if esleme-i <> 0
            if takas-anahtar2 <> low-values
                modify form4-gd-1(esleme-kayit-sayi + 1)
                       x = 3
                       row-color = 480
                       cell-color = 480
            end-if
         end-if
    end-read
    end-perform
    end-start
    modify form4-gd-1,
           mass-update = 0.
    close acenta ulke kodlar02 konum doviz.
*
 Form3-Ex-Other.
    if key-status = 1 or 2 or 3 or 4 or 5 or 6 or 8
       continue
    else 
       exit paragraph
    end-if.

    evaluate key-status
       when 1 
            inquire form3-gd-1,cursor-y in form3-gd-y
            inquire form3-gd-1(form3-gd-y,1),
                    record-data in form3-gd-1-record
                    hidden-data in dummy
            if dummy <> "E"
               open input rez
               move gd-1-col-1      to rez-anah
               read rez no lock invalid
                    continue
               not invalid
               if rez-c-in <> "E"
                  modify form3-gd-1(form3-gd-y,1)
                         hidden-data = "E"
                         bitmap = check-bmp
                         bitmap-number = 2 
                         bitmap-width = 16
                         bitmap-trailing = 1
               end-if
               end-read
               close rez
            else
               modify form3-gd-1(form3-gd-y,1),
                      bitmap = null
                      hidden-data = "H"
            end-if
       when 2 
            inquire form3-gd-1,
                    last-row in esleme-kayit-sayi
            if esleme-kayit-sayi = 1 
               exit paragraph
            end-if
            open input rez
            initialize frame-degiskenler
            move esleme-kayit-sayi to frame-kayit-sayi
            move 20                to frame-win-line
            move 20                to frame-win-pos
            move "Bekleyiniz..."   to frame-title
            perform frame-ac
            perform varying form3-gd-y from 2 by 1 until form3-gd-y > esleme-kayit-sayi
                    perform frame-goster
                    inquire form3-gd-1(form3-gd-y,1),
                            record-data in form3-gd-1-record
                            hidden-data in dummy
                    evaluate dummy
                        when "E"
                             modify form3-gd-1(form3-gd-y,1),
                                    hidden-data = "H"
                                    bitmap = null
                        when other
                             move gd-1-col-1 to rez-anah
                             read rez no lock invalid
                                  continue
                             not invalid
                             if rez-c-in <> "E"
                                modify form3-gd-1(form3-gd-y,1),
                                       hidden-data = "E"
                                       bitmap = check-bmp
                                       bitmap-number = 2 
                                       bitmap-width = 16
                                       bitmap-trailing = 1 
                             end-if
                             end-read
                    end-evaluate
            end-perform
            perform frame-kapat
            close rez
       when 3
            open i-o rez takvim acenhrk cast
            inquire form3-gd-1,
                    last-row in sil-son
            initialize frame-degiskenler
            move sil-son           to frame-kayit-sayi
            move 20                to frame-win-line
            move 20                to frame-win-pos
            move "Siliniyor ..."   to frame-title
            perform frame-ac

            perform varying sil-i from 2 by 1 until sil-i > sil-son
                    perform frame-goster
                    initialize sil-eh
                    inquire form3-gd-1(sil-i,1),
                            hidden-data in sil-eh
                    if sil-eh <> "E"
                       exit perform cycle
                    end-if
                    inquire form3-gd-1(sil-i,2),
                            cell-data in rez-anah
                    read rez no lock invalid
                         exit perform cycle
                    end-read
                    evaluate rez-durumu
                       when "I"
                            perform acenhrk-takvim-sil
                            move "S"            to rez-durumu
                            move k-kodu-tasi    to rez-staf
                            accept rez-isl-tar  from century-date
                            rewrite rez-rec invalid continue
                            end-rewrite
                            perform log-operation-rez
                       when "S"
                            perform cast-iptal
                            delete rez invalid continue 
                            end-delete
                            perform log-operation-rez
                    end-evaluate
            end-perform
            close rez takvim acenhrk cast
            perform frame-kapat
            set exit-pushed to true
       when 5
            if combo-toplamlar-value(1:1) <> "A"
               perform acu-form4-routine
            end-if
       when 6
            open i-o rez 
            open input aksiyhrk fiyat fiyatana
            inquire form3-gd-1,
                    last-row in sil-son
            initialize frame-degiskenler
            move sil-son           to frame-kayit-sayi
            move 20                to frame-win-line
            move 20                to frame-win-pos
            move "Hesaplaniyor."   to frame-title
            perform frame-ac

            perform varying sil-i from 2 by 1 until sil-i > sil-son
                    perform frame-goster
                    initialize sil-eh
                    inquire form3-gd-1(sil-i,1),
                            hidden-data in sil-eh
                    if sil-eh <> "E"
                       exit perform cycle
                    end-if
                    inquire form3-gd-1(sil-i,2),
                            cell-data in rez-anah
                    read rez no lock invalid
                         exit perform cycle
                    end-read
                        perform peryot-fiyat-bul-1 

                        move ilk-rez-fiyati to rez-fiyati
                        move k-kodu-tasi    to rez-staf
                        rewrite rez-rec invalid continue
                        end-rewrite
                        perform log-operation-rez
            end-perform
            close rez aksiyhrk fiyat fiyatana
            perform frame-kapat
            set exit-pushed to true
*       when 8 
*        perform acu-form7-routine
*        exit paragraph
    end-evaluate.
*
 Form2-Ex-Other.
    if key-status = 5001
       perform acu-form5-routine
    end-if.
*
 combo-toplamlar-Ex-Ntf-Selchange.
    if combo-toplamlar-value(1:1) = "A"
       modify form2-pb-2,enabled = false
    else
       modify form2-pb-2,enabled = true
    end-if.
*
 Form4-Gd-1-Ev-Msg-Begin-Entry.
    move event-action-fail to event-action.
*
 cb-renklendir.
    evaluate ilk-secilen
         when 01  modify cb-numara,color = 5 
                  move 2 to numara-eh
         when 02  modify cb-islem-tarihi,color = 5 
                  move 2 to islem-tarih-eh
         when 03  modify cb-acenta,color = 5 
                  move 2 to acenta-eh
         when 04  modify cb-musteri-adi,color = 5 
                  move 2 to musteri-adi-eh
         when 05  modify cb-musteri-soyadi,color = 5 
                  move 2 to musteri-soyadi-eh
         when 06  modify cb-cin-tarihi,color = 5 
                  move 2 to c-in-tarih-eh
         when 07  modify cb-cout-tarihi,color = 5 
                  move 2 to c-out-tarih-eh
         when 08  modify cb-voucher,color = 5 
                  move 2 to voucher-eh
         when 98
         when 99
                if ilk-secilen = 99
                  if numara-eh = 1 
                     move 01 to ilk-secilen
                  else
                  if islem-tarih-eh = 1 
                     move 02 to ilk-secilen
                  else
                  if acenta-eh = 1 
                     move 03 to ilk-secilen
                  else
                  if musteri-adi-eh = 1 

                     move 04 to ilk-secilen
                  else
                  if musteri-soyadi-eh = 1 
                     move 05 to ilk-secilen
                  else
                  if c-in-tarih-eh = 1
                     move 06 to ilk-secilen
                  else
                  if c-out-tarih-eh = 1 
                     move 07 to ilk-secilen
                  else
                  if voucher-eh = 1 
                     move 08 to ilk-secilen
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                end-if
                modify cb-numara,        color = 2 
                modify cb-islem-tarihi,  color  = 2
                modify cb-acenta      ,  color  = 2
                modify cb-musteri-adi ,  color  = 2
                modify cb-musteri-soyadi,color  = 2
                modify cb-cin-tarihi,    color  = 2
                modify cb-cout-tarihi,   color  = 2
                modify cb-voucher    ,   color  = 2
                if ilk-secilen = 99
                   move 0 to ilk-secilen
                end-if
                if ilk-secilen <> 0 and ilk-secilen not = 98 
                   perform cb-renklendir
                end-if
         when other
              exit paragraph
    end-evaluate.

*
 combo-rapor-baslik-Ex-Ntf-Selchange.
    move combo-rapor-baslik-value(1:4) to rapor-no
    if rapor-no <= "9999"
       continue
    else
       exit paragraph
    end-if.

    perform rapor-olus-adim-1.

 rapor-olus-adim-1.
* standart rapor gelecekse tum degerler 
* def degerlere aktariliyor
    if rapor-no = "0000"
       perform load-def-screen
       move 98 to ilk-secilen
       perform cb-renklendir
       move 0 to ilk-secilen
       exit paragraph
    else 
       open input rapor
       move "R" to rapor-tipi
       read rapor no lock invalid
            display message box
                    "Tanimsiz rapor ...."
                    title "Uyari"
                    icon mb_error_icon
            close rapor
            exit paragraph
       end-read
       close rapor
    end-if.

    initialize degiskenler degiskenler-1
    perform degerler-def.
    display form1.
    perform form2-aft-initdata.

    perform flt-ana-scr-loc-yerlestir.
    perform flt-yrd-scr-loc-yerlestir.

* bas-numara  bit-numara
    move 1 to i
    if rapor-anah-visible(i)
       move 1                              to numara-eh
       move rapor-anah-fltler-bas-deger(i) to bas-numara
       move rapor-anah-fltler-bit-deger(i) to bit-numara
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-numara
       end-if
       if rapor-anah-bit-flt-degisken(i)
          initialize bit-numara
       end-if
    end-if


* bas-islem-tarih bit-islem-tarih
    move 2 to i
    if rapor-anah-visible(i)
       move 1                                   to islem-tarih-eh
       move rapor-anah-fltler-bas-deger(i)(1:2) to bas-islem-gun
       move rapor-anah-fltler-bas-deger(i)(3:2) to bas-islem-ay 
       move rapor-anah-fltler-bas-deger(i)(5:4) to bas-islem-yil
       move rapor-anah-fltler-bit-deger(i)(1:2) to bit-islem-gun
       move rapor-anah-fltler-bit-deger(i)(3:2) to bit-islem-ay 
       move rapor-anah-fltler-bit-deger(i)(5:4) to bit-islem-yil
       evaluate true
         when rapor-anah-bas-flt-degisken(i)
              initialize bas-islem-tarih
         when rapor-anah-bas-flt-gune-bagli(i)
              move gun-tasi to bas-islem-gun
              move  ay-tasi to bas-islem-ay 
              move yil-tasi to bas-islem-yil
       end-evaluate

       evaluate true
         when rapor-anah-bit-flt-degisken(i)
              initialize bit-islem-tarih
         when rapor-anah-bit-flt-gune-bagli(i)
              move gun-tasi to bit-islem-gun
              move  ay-tasi to bit-islem-ay 
              move yil-tasi to bit-islem-yil
       end-evaluate
    end-if

* bas-acenta bit-acenta
    move 3 to i
    if rapor-anah-visible(i)
       move 1                              to acenta-eh
       move rapor-anah-fltler-bas-deger(i) to bas-acenta
       move rapor-anah-fltler-bit-deger(i) to bit-acenta
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-acenta
       end-if
       if rapor-anah-bit-flt-degisken(i)
          initialize bit-acenta
       end-if
    end-if
    
* bas-musteri adi bit musteri-adi
    move 4 to i
    if rapor-anah-visible(i)
       move 1                              to musteri-adi-eh
       move rapor-anah-fltler-bas-deger(i) to bas-musteri-adi
       move rapor-anah-fltler-bit-deger(i) to bit-musteri-adi
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-musteri-adi
       end-if
       if rapor-anah-bit-flt-degisken(i)
          initialize bit-musteri-adi
       end-if
    end-if

* bas-musteri soy bit musteri-soy
    move 5 to i
    if rapor-anah-visible(i)
       move 1                              to musteri-soyadi-eh
       move rapor-anah-fltler-bas-deger(i) to bas-musteri-soy
       move rapor-anah-fltler-bit-deger(i) to bit-musteri-soy
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-musteri-soy
       end-if
       if rapor-anah-bit-flt-degisken(i)
          initialize bit-musteri-soy
       end-if
    end-if

* bas-cin-tarih ve bit-cin-tarih
    move 6 to i
    if rapor-anah-visible(i)
       move 1                                   to c-in-tarih-eh
       move rapor-anah-fltler-bas-deger(i)(1:2) to bas-cin-gun
       move rapor-anah-fltler-bas-deger(i)(3:2) to bas-cin-ay 
       move rapor-anah-fltler-bas-deger(i)(5:4) to bas-cin-yil
       move rapor-anah-fltler-bit-deger(i)(1:2) to bit-cin-gun
       move rapor-anah-fltler-bit-deger(i)(3:2) to bit-cin-ay
       move rapor-anah-fltler-bit-deger(i)(5:4) to bit-cin-yil
       evaluate true
         when rapor-anah-bas-flt-degisken(i)
              initialize bas-cin-tarih
         when rapor-anah-bas-flt-gune-bagli(i)
              move gun-tasi to bas-cin-gun
              move  ay-tasi to bas-cin-ay 
              move yil-tasi to bas-cin-yil
       end-evaluate

       evaluate true
         when rapor-anah-bit-flt-degisken(i)
              initialize bit-cin-tarih
         when rapor-anah-bit-flt-gune-bagli(i)
              move gun-tasi to bit-cin-gun
              move  ay-tasi to bit-cin-ay 
              move yil-tasi to bit-cin-yil
       end-evaluate

    end-if

* bas-cout-tarih ve bit-cout-tarih
    move 7 to i
    if rapor-anah-visible(i)
       move 1                                   to c-out-tarih-eh
       move rapor-anah-fltler-bas-deger(i)(1:2) to bas-cout-gun
       move rapor-anah-fltler-bas-deger(i)(3:2) to bas-cout-ay 
       move rapor-anah-fltler-bas-deger(i)(5:4) to bas-cout-yil
       move rapor-anah-fltler-bit-deger(i)(1:2) to bit-cout-gun
       move rapor-anah-fltler-bit-deger(i)(3:2) to bit-cout-ay 
       move rapor-anah-fltler-bit-deger(i)(5:4) to bit-cout-yil
       evaluate true
         when rapor-anah-bas-flt-degisken(i)
              initialize bas-cout-tarih
         when rapor-anah-bas-flt-gune-bagli(i)
              move gun-tasi to bas-cout-gun
              move  ay-tasi to bas-cout-ay 
              move yil-tasi to bas-cout-yil
       end-evaluate

       evaluate true
         when rapor-anah-bit-flt-degisken(i)
              initialize bit-cout-tarih
         when rapor-anah-bit-flt-gune-bagli(i)
              move gun-tasi to bit-cout-gun
              move  ay-tasi to bit-cout-ay 
              move yil-tasi to bit-cout-yil
       end-evaluate       
    end-if

* voucher
    move 8 to i
    if rapor-anah-visible(i)
       move 1                              to voucher-eh
       move rapor-anah-fltler-bas-deger(i) to bas-voucher
       move rapor-anah-fltler-bit-deger(i) to bit-voucher
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-voucher
       end-if
       if rapor-anah-bit-flt-degisken(i)
          initialize bit-voucher
       end-if
    end-if

* rezervasyon turu
    move 1 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to combo-rezervasyon-turu-value
    end-if

* rezervasyon durumu
    move 2 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to combo-rezervasyon-durumu-value
    end-if

* grup-kodu
    move 3 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to bas-grup-kodu
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-grup-kodu
       end-if
    end-if

* banka kodu
    move 4 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to bas-banka-kodu
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-banka-kodu
       end-if
    end-if

* dovz kodu
    move 5 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to bas-doviz-kodu
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-doviz-kodu
       end-if
    end-if

* anlasma-kodu
    move 6 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to bas-anlasma-kodu
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-anlasma-kodu
       end-if
    end-if

* odeme kodu
    move 7 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to bas-odeme-kodu
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-odeme-kodu
       end-if
    end-if

* kur tipi
    move 8 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to combo-kur-tipi-value
    end-if

* ulke-kodu
    move 9 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to bas-ulke-kodu
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-ulke-kodu
       end-if
    end-if

* pazar-kodu
    move 10 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to bas-pazar-kodu
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-pazar-kodu
       end-if
    end-if

* pansiyon kodu
    move 11 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to bas-pansiyon-kodu
       if rapor-anah-bas-flt-degisken(i)
          initialize bas-pansiyon-kodu
       end-if
    end-if

* musteri turu
    move 12 to i
    if rapor-yrd-visible(i)
       move rapor-yrd-fltler-bas-deger(i)  to combo-musteri-turu-value
    end-if

    display form1.

    move 98 to ilk-secilen
    perform cb-renklendir.
    perform varying i from 1 by 1 until i > 15
            if rapor-anah-secim(i) <> 0
               move i    to ilk-secilen
               exit perform
            end-if
    end-perform.
    perform cb-renklendir.
*    move rapor-cb-1          to numara-eh
*    move rapor-cb-2          to islem-tarih-eh
*    move rapor-cb-3          to acenta-eh
*    move rapor-cb-4          to musteri-adi-eh
*    move rapor-cb-5          to musteri-soyadi-eh
*    move rapor-cb-6          to c-in-tarih-eh
*    move rapor-cb-7          to c-out-tarih-eh
*    move rapor-cb-8          to voucher-eh
*    close rapor.

*    display cb-numara cb-islem-tarihi cb-acenta
*    cb-musteri-adi cb-musteri-soyadi cb-cin-tarihi
*    cb-cout-tarihi cb-voucher.
 acenhrk-takvim-sil.
     if rez-k-g-b <> "K"
        exit paragraph
     end-if
     initialize takvim-rec
     move rez-gir-tar to takvim-anah
     start takvim key not < takvim-anah invalid
           continue
     not invalid
     initialize fs-takvim
     perform with test after until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end
          if takvim-anah = rez-cik-tar or 
             takvim-anah > rez-cik-tar
                 move "10" to fs-takvim
                 exit perform
          end-if
          compute takvim-sat-oda(rez-oda-konumu,rez-s-d-t-g)   =
                  takvim-sat-oda(rez-oda-konumu,rez-s-d-t-g)   - 1
          compute takvim-sat-buyuk(rez-oda-konumu,rez-s-d-t-g) =
                  takvim-sat-buyuk(rez-oda-konumu,rez-s-d-t-g) - rez-buyuk
          compute takvim-sat-kucuk(rez-oda-konumu,rez-s-d-t-g) =
                  takvim-sat-kucuk(rez-oda-konumu,rez-s-d-t-g) - rez-kucuk
          compute takvim-sat-free(rez-oda-konumu,rez-s-d-t-g)  =
                  takvim-sat-free(rez-oda-konumu,rez-s-d-t-g)  - rez-free
          compute takvim-sat-free(rez-oda-konumu,rez-s-d-t-g)  =
                  takvim-sat-free(rez-oda-konumu,rez-s-d-t-g)  - rez-bebek
          rewrite takvim-rec invalid continue end-rewrite

          move rez-acenta       to acenhrk-acenta
          move takvim-anah      to acenhrk-tarih
          move rez-oda-konumu   to acenhrk-oda-konumu
          move rez-s-d-t-g      to acenhrk-s-d-t-g
          read acenhrk invalid 
               exit perform cycle
          end-read
          compute acenhrk-sat-oda   = acenhrk-sat-oda   - 1
          compute acenhrk-sat-buyuk = acenhrk-sat-buyuk - rez-buyuk
          compute acenhrk-sat-kucuk = acenhrk-sat-kucuk - rez-kucuk
          compute acenhrk-sat-free  = acenhrk-sat-free  - rez-free
          compute acenhrk-sat-free  = acenhrk-sat-free  - rez-bebek
          rewrite acenhrk-rec invalid continue end-rewrite
     end-read
     end-perform
     end-start.

 cast-iptal.
     initialize cast-rec
     move rez-no          to cast-rez-no
     start cast key not < cast-anah1 invalid
           continue
     not invalid
     initialize fs-cast
     perform with test after until fs-cast = "10"
     read cast next no lock end move "10" to fs-cast
     not at end
          if cast-rez-no > rez-no
             move "10" to fs-cast
             exit perform
          end-if
          if cast-rez-no <> rez-no
             exit perform cycle
          end-if
          delete cast end-delete
     end-read
     end-perform
     end-start.

 peryot-fiyat-bul.
     open input takvim
     initialize aksiyhrk-rec aksiyon-durumu
     move "A"              to aksiyhrk-tipi
     move rez-acenta       to aksiyhrk-acenta
     move rez-gir-tar      to aksiyhrk-tarih
     move rez-pan-tipi     to aksiyhrk-pan-tipi
     move g-bul-gun-sayisi to aksiyhrk-gecele
     read aksiyhrk no lock invalid
          continue
     not invalid
          set aksiyon-var to true
     end-read

     move rez-fiyati    to ilk-rez-fiyati

     initialize g-bul-gun-sayisi
                takvim-rec top-rez-fiyati
     move rez-gir-tar   to takvim-anah
     start takvim key not < takvim-anah
           invalid
                move 1 to g-bul-gun-sayisi
     not invalid
     initialize fs-takvim
     perform with test after until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end
          if takvim-anah = rez-cik-tar
             move "10" to fs-takvim
             exit perform cycle
          end-if
          if takvim-anah not > rez-cik-tar
             perform fiyat-bul thru fiyat-bul-exit
             add 1 to g-bul-gun-sayisi
             compute top-rez-fiyati = 
                     top-rez-fiyati + ilk-rez-fiyati
          else
             move "10" to fs-takvim
          end-if
     end-read
     end-perform.

     close takvim.

 peryot-fiyat-bul-1.
     open input takvim
     move rez-fiyati    to ilk-rez-fiyati

     initialize g-bul-gun-sayisi
                takvim-rec top-rez-fiyati
     move rez-gir-tar   to takvim-anah
     start takvim key not < takvim-anah
           invalid
                move 1 to g-bul-gun-sayisi
     not invalid
     initialize fs-takvim
     perform with test after until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end
          if takvim-anah = rez-cik-tar
             move "10" to fs-takvim
             exit perform cycle
          end-if
          if takvim-anah not > rez-cik-tar
             add 1 to g-bul-gun-sayisi
          else
             move "10" to fs-takvim
          end-if
     end-read
     end-perform.

     close takvim.
     initialize aksiyhrk-rec aksiyon-durumu
     move "A"              to aksiyhrk-tipi
     move rez-acenta       to aksiyhrk-acenta
     move rez-gir-tar      to aksiyhrk-tarih
     move rez-pan-tipi     to aksiyhrk-pan-tipi
     move g-bul-gun-sayisi to aksiyhrk-gecele
     read aksiyhrk no lock invalid
          continue
     not invalid
          set aksiyon-var to true
     end-read.
*****>Ayni yer perform edildigi icin giris tarihindeki fiyati bulmasi icin konuldu
     move rez-gir-tar   to takvim-anah.
*****>Ayni yer perform edildigi icin giris tarihindeki fiyati bulmasi icin konuldu
     perform fiyat-bul thru fiyat-bul-exit.

 fiyat-bul.
    if rez-fiyat-fix = "E"
       go fiyat-bulundu
    end-if.

     move 0 to oda-fiyati. 
     move rez-acenta        to fiyat-acenta. 
     move takvim-anah       to fiyat-tarih. 
     move rez-tipi          to fiyat-rez-tipi. 
     move rez-pan-tipi      to fiyat-pan-tipi. 
     move rez-banka         to fiyat-banka. 
     move rez-doviz         to fiyat-doviz. 
     move rez-anlasma       to fiyat-anlasma. 
     move rez-buyuk         to fiyat-buyuk.
     move rez-kucuk         to fiyat-kucuk.
     read fiyat no lock invalid
          go fiyat-bulundu.
     move fiyat-acenta    to fiyatana-acenta. 
     move fiyat-bas-tarih to fiyatana-ilk-tarih.
     move fiyat-bit-tarih to fiyatana-son-tarih.
     move fiyat-rez-tipi  to fiyatana-rez-tipi. 
     move fiyat-pan-tipi  to fiyatana-pan-tipi. 
     move fiyat-banka     to fiyatana-banka. 
     move fiyat-doviz     to fiyatana-doviz. 
     move fiyat-anlasma   to fiyatana-anlasma. 
     move fiyat-buyuk     to fiyatana-buyuk.
     move fiyat-kucuk     to fiyatana-kucuk.
     read fiyatana no lock invalid 
          go fiyat-bulundu.

     move fiyatana-oda-fiyati(rez-oda-konumu) to oda-fiyati. 

     if rez-fiyat-konumu not = spaces and
        rez-fiyat-konumu not = zeroes
        move fiyatana-oda-fiyati(rez-fiyat-konumu) to oda-fiyati 
     end-if

*/********* 
       if rez-nor-indirim not = 0 
       compute oda-fiyati = 
              (((oda-fiyati * rez-nor-indirim) / 100) - oda-fiyati)
       end-if.
*/Early booking orani var ve early booking uygulanacak ise 
     if rez-eb = "E" and fiyatana-eb-oran not = 0 
     compute oda-fiyati = 
            (((oda-fiyati *(fiyatana-eb-oran +( fiyatana-eb-kusur / 100) )) / 100) - oda-fiyati)
     end-if. 
*/Kick back
     if fiyatana-kick-back not = 0 
     compute oda-fiyati = 
            (((oda-fiyati * fiyatana-kick-back) / 1000) - oda-fiyati)
     end-if. 

 aksiyonlu-uyar. 
*     if rez-eb = "E" and fiyatana-eb-oran not = 0 
*        and eb-de-aksiyon-hesaplama = 1
*        set aksiyon-yok to true
*     end-if

     if rez-aksiyon-eh = "H" 
        set aksiyon-yok to true
     else
        if rez-eb = "E" and fiyatana-eb-oran not = 0 
           and eb-de-aksiyon-hesaplama = 1
           set aksiyon-yok to true
        end-if
     end-if

     if aksiyon-var
     compute oda-fiyati = ((oda-fiyati * aksiyhrk-ode) / aksiyhrk-gecele). 
*****if oda-fiyati <> rez-fiyati 
        move oda-fiyati  to ilk-rez-fiyati.
 aksiyonlu-uyar-exit. 
     exit. 

 fiyat-bulundu. 
 fiyat-bul-exit. 
     exit.
*
 Form7-Ex-Other.
    evaluate key-status
       when 2010 
            open i-o rez 
            inquire form3-gd-1,
                    last-row in sil-son
            initialize frame-degiskenler
            move sil-son           to frame-kayit-sayi
            move 20                to frame-win-line
            move 20                to frame-win-pos
            move "Hesaplaniyor."   to frame-title
            perform frame-ac

            perform varying sil-i from 2 by 1 until sil-i > sil-son
                    perform frame-goster
                    initialize sil-eh
                    inquire form3-gd-1(sil-i,1),
                            hidden-data in sil-eh
                    if sil-eh <> "E"
                       exit perform cycle
                    end-if
                    inquire form3-gd-1(sil-i,2),
                            cell-data in rez-anah
                    read rez no lock invalid
                         exit perform cycle
                    end-read
                        initialize acen-degis yeni-konum
                        if degis-acenta not = spaces
                           move degis-acenta to rez-acenta
                           move 1 to acen-degis
                        end-if

                        inquire combo-oda-konumu-a value in yeni-konum
                        if yeni-konum not = 0 
                           move yeni-konum to rez-oda-konumu
                           move 2 to acen-degis
                        end-if
                        if acen-degis not = 0
                           rewrite rez-rec invalid continue
                           end-rewrite
                           perform log-operation-rez
                        end-if
            end-perform
            close rez 
            perform frame-kapat
            set exit-pushed to true
       when 2009 
            set exit-pushed to true
     .
*
 Form7-Aft-Initdata.
     modify combo-oda-konumu,        reset-list = 1 mass-update = 1.
     modify combo-oda-konumu-a,
     item-to-add("0-Degistirme")

     open input konum
     initialize konum-rec
     start konum key not < konum-anahtar invalid
           continue
     not invalid
     initialize fs-konum
     perform with test after until fs-konum = "10"
     read konum next no lock end move "10" to fs-konum
     not at end
          initialize temp-x
          move konum-anahtar to temp-x
          move "-"           to temp-x(2:)
          move konum-adi     to temp-x(3:)
          modify combo-oda-konumu-a,
                 item-to-add(temp-x)
     end-read
     end-perform
     end-start
     close konum.
     modify combo-oda-konumu-a,   mass-update = 0
                                value combo-oda-konumu-value-a.
     
     .
*
 yardimlar.
     evaluate control-id
       when 28
       when 48 perform ilk-acenta-ara
       when 29
       when 49 perform son-acenta-ara
       when 54
       when 55 perform banka-ara
       when 58
       when 59 perform doviz-ara
       when 62
       when 63 perform anlasma-ara
       when 66
       when 67 perform odeme-ara
       when 74
       when 75 perform ulke-ara
       when 82
       when 83 perform pazar-ara
       when 70
       when 71 perform pansiyon-ara
     end-evaluate
     .
*
 ilk-acenta-ara.
     perform acenta-ara
     move acenta-cagir to bas-acenta
     display acc-bas-acenta
     .
*
 son-acenta-ara.
     perform acenta-ara
     move acenta-cagir to bit-acenta
     display acc-bit-acenta
     .
*
 acenta-ara.
     initialize acenta-cagir
     call "/asya/ytl/obj/otel/acenara.asy" 
       using acenta-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/acenara.asy"
     end-call
     .
*
 banka-ara.
     call "/asya/ytl/obj/otel/bankaara.asy" 
       using bas-banka-kodu  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/bankaara.asy"
     end-call
     display acc-bas-banka-kodu
     .
*
 doviz-ara.
     call "/asya/ytl/obj/otel/dovizara.asy" 
       using bas-doviz-kodu  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/dovizara.asy"
     end-call
     display acc-bas-doviz-kodu
     .
*
 anlasma-ara.
     move "D" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/infoxara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/infoxara.asy"
     end-call
     move infox-kodu-cagir to bas-anlasma-kodu
     display acc-bas-anlasma-kodu
     .
*
 odeme-ara.
     move "B" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/odemeara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/odemeara.asy"
     end-call
     move infox-kodu-cagir to bas-odeme-kodu
     display acc-bas-odeme-kodu
     .
*
 ulke-ara.
     call "/asya/ytl/obj/otel/ulkeara.asy" 
       using bas-ulke-kodu  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/ulkeara.asy"
     end-call
     display acc-bas-ulke-kodu
     .
*
 pazar-ara.
     move "E" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/pazarara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/pazarara.asy"
     end-call
     move infox-kodu-cagir to bas-pazar-kodu
     display acc-bas-pazar-kodu
     .
*
 pansiyon-ara.
     move "A" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/panara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/panara.asy"
     end-call
     move infox-kodu-cagir to bas-pansiyon-kodu
     display acc-bas-pansiyon-kodu
     .
*********************************************
*  O muhtesem bolum varya burasi olacakti
*  sona baktimki platform bozuk kardesim !
*  Skerm dedim bunu yaptim - KOMENDO
*********************************************
 Form6-Bef-Create.
     move 1 to form6-enable-1
     move 0 to form6-enable-2.
     .
*
 accept-0601-Ex-Ntf-Changed.
     if rapor-no > zeroes and <= 9999
        perform form6-rapor-goster
     end-if.
 form6-rapor-goster.
     open input rapor
     move "R"       to rapor-tipi.
     read rapor no lock invalid
          move "H"     to form6-kayit-durum
          initialize rapor-rec(function length(rapor-anahtar) + 1:)
* Anahtar ve yrd degerler defaultlaniyor .....
          perform varying lbl-i from 1 by 1 until lbl-i > 15
              set rapor-anah-bas-flt-sabit(lbl-i)     to true
              set rapor-anah-bit-flt-sabit(lbl-i)     to true
              set rapor-anah-fltler-esit(lbl-i)       to true
          end-perform
          if ilk-secilen <> zeroes
             move 1            to rapor-anah-secim(ilk-secilen)
          end-if

          move numara-eh          to rapor-anah-gorunsunmu(1)
          move islem-tarih-eh     to rapor-anah-gorunsunmu(2)
          move acenta-eh          to rapor-anah-gorunsunmu(3)
          move musteri-adi-eh     to rapor-anah-gorunsunmu(4)
          move musteri-soyadi-eh  to rapor-anah-gorunsunmu(5)
          move c-in-tarih-eh      to rapor-anah-gorunsunmu(6)
          move c-out-tarih-eh     to rapor-anah-gorunsunmu(7)
          move voucher-eh         to rapor-anah-gorunsunmu(8)

          move bas-numara         to rapor-anah-fltler-bas-deger(1)
          move bit-numara         to rapor-anah-fltler-bit-deger(1)
          move bas-islem-gun      to rapor-anah-fltler-bas-deger(2)(1:2)
          move bas-islem-ay       to rapor-anah-fltler-bas-deger(2)(3:2)
          move bas-islem-yil      to rapor-anah-fltler-bas-deger(2)(5:4)
          move bit-islem-gun      to rapor-anah-fltler-bit-deger(2)(1:2)
          move bit-islem-ay       to rapor-anah-fltler-bit-deger(2)(3:2)
          move bit-islem-yil      to rapor-anah-fltler-bit-deger(2)(5:4)
          move bas-acenta         to rapor-anah-fltler-bas-deger(3)
          move bit-acenta         to rapor-anah-fltler-bit-deger(3)
          move bas-musteri-adi    to rapor-anah-fltler-bas-deger(4)
          move bit-musteri-adi    to rapor-anah-fltler-bit-deger(4)
          move bas-musteri-soy    to rapor-anah-fltler-bas-deger(5)
          move bit-musteri-soy    to rapor-anah-fltler-bit-deger(5)
          move bas-cin-gun        to rapor-anah-fltler-bas-deger(6)(1:2)
          move bas-cin-ay         to rapor-anah-fltler-bas-deger(6)(3:2)
          move bas-cin-yil        to rapor-anah-fltler-bas-deger(6)(5:4)
          move bit-cin-gun        to rapor-anah-fltler-bit-deger(6)(1:2)
          move bit-cin-ay         to rapor-anah-fltler-bit-deger(6)(3:2)
          move bit-cin-yil        to rapor-anah-fltler-bit-deger(6)(5:4)
          move bas-cout-gun       to rapor-anah-fltler-bas-deger(7)(1:2)
          move bas-cout-ay        to rapor-anah-fltler-bas-deger(7)(3:2)
          move bas-cout-yil       to rapor-anah-fltler-bas-deger(7)(5:4)
          move bit-cout-gun       to rapor-anah-fltler-bit-deger(7)(1:2)
          move bit-cout-ay        to rapor-anah-fltler-bit-deger(7)(3:2)
          move bit-cout-yil       to rapor-anah-fltler-bit-deger(7)(5:4)
          move bas-voucher        to rapor-anah-fltler-bas-deger(8)
          move bit-voucher        to rapor-anah-fltler-bit-deger(8)

          perform varying lbl-i from 1 by 1 until lbl-i > 32
              set rapor-yrd-visible(lbl-i)        to true
              set rapor-yrd-bas-flt-sabit(lbl-i)  to true
          end-perform
          move combo-rezervasyon-turu-value       to rapor-yrd-fltler-bas-deger(1)
          move combo-rezervasyon-durumu-value     to rapor-yrd-fltler-bas-deger(2)
          move bas-grup-kodu                      to rapor-yrd-fltler-bas-deger(3)
          move bas-banka-kodu                     to rapor-yrd-fltler-bas-deger(4)
          move bas-doviz-kodu                     to rapor-yrd-fltler-bas-deger(5)
          move bas-anlasma-kodu                   to rapor-yrd-fltler-bas-deger(6)
          move bas-odeme-kodu                     to rapor-yrd-fltler-bas-deger(7)
          move combo-kur-tipi-value               to rapor-yrd-fltler-bas-deger(8)
          move bas-ulke-kodu                      to rapor-yrd-fltler-bas-deger(9)
          move bas-pazar-kodu                     to rapor-yrd-fltler-bas-deger(10)
          move bas-pansiyon-kodu                  to rapor-yrd-fltler-bas-deger(11)
          move combo-musteri-turu-value           to rapor-yrd-fltler-bas-deger(12)
          move combo-oda-tipi-value               to rapor-yrd-fltler-bas-deger(13)
          move combo-oda-konumu-kaynagi-value     to rapor-yrd-fltler-bas-deger(14)
          move combo-oda-konumu-value             to rapor-yrd-fltler-bas-deger(15)
          move combo-kullanici-kodu-value         to rapor-yrd-fltler-bas-deger(16)
          move combo-rezervasyon-k-w-value        to rapor-yrd-fltler-bas-deger(17)
          move eb-rezler-ciksin                   to rapor-yrd-fltler-bas-deger(18)
          move fix-fiyat-ciksin                   to rapor-yrd-fltler-bas-deger(19)
          move aksiyon-uygulama-eh                to rapor-yrd-fltler-bas-deger(20)
          move bilboard-dus-eh                    to rapor-yrd-fltler-bas-deger(21)
          move buyuk-sayi                         to rapor-yrd-fltler-bas-deger(22)
          move kucuk-sayi                         to rapor-yrd-fltler-bas-deger(23)
          move bebek-sayi                         to rapor-yrd-fltler-bas-deger(24)
          move free-sayi                          to rapor-yrd-fltler-bas-deger(25)
          move komisyon-orani                     to rapor-yrd-fltler-bas-deger(26)
*********************
***
***   Illegal recevier type indirim-orani
***   Geri tasindiginde dogru aktarýyormu test edilecek
***
*********************
          move indirim-orani(1:4)                 to rapor-yrd-fltler-bas-deger(27)
          move combo-toplamlar-value              to rapor-yrd-fltler-bas-deger(28)
          move cin-rezler-ciksin                  to rapor-yrd-fltler-bas-deger(29)
          move eb-de-aksiyon-hesaplama            to rapor-yrd-fltler-bas-deger(30)
          move peryot-hesaplasinmi                to rapor-yrd-fltler-bas-deger(31)
* kos kos kuntepti aga detaylar defaultlaniye
          perform varying det-adlari-i
                          from 1 
                          by 1 
                          until det-adlari-i > max-det-adlari
                  set rapor-detaylar-ciksin(det-adlari-i) to true
                  move det-adlari-i                       to rapor-detaylar-sira(det-adlari-i)
                  move det-adlari-def-au(det-adlari-i)    to rapor-detaylar-au(det-adlari-i)
          end-perform
          initialize rapor-icmal
          move 1 to rapor-icmal-sekil
     not invalid
          move "E"     to form6-kayit-durum
     end-read.
     close rapor.
     display accept-0602.
     perform form6-grid-1-doldur.
     perform form6-grid-2-doldur.
     perform form6-grid-3-doldur.
     perform form6-combolar-doldur.
 form6-grid-1-doldur.
     modify form6-gd-1,
            reset-grid = 1
            mass-update = 1
     initialize form6-gd-1-record
     move "SN"                to gd-6-col-0
     move "Filtre Adi"        to gd-6-col-1
     move "A"                 to gd-6-col-2
     move "Bas.Flt.Tip"       to gd-6-col-3
     move "Bit.Flt.Tip"       to gd-6-col-4
     move "Flt1=Flt2"         to gd-6-col-5
     move "Gorunum"           to gd-6-col-6
     move "Bas.Flt.Icerigi"   to gd-6-col-7
     move "Bit.Flt.Icerigi"   to gd-6-col-8
     modify form6-gd-1,
            record-to-add(form6-gd-1-record)
     initialize lbl-ii
     perform varying lbl-i from 1 by 1 until lbl-i > max-lbl
             initialize form6-gd-1-record
             move lbl-i                  to gd-6-col-0
             move lbl-dizi(lbl-i)        to gd-6-col-1
* Ilk 8 kayit anah kismi sonasi yrd kismi
             if lbl-i < 9
                move lbl-i   to form6-i
                perform rapor-anah-bas-flt-tipi-to-grid
                perform rapor-anah-bit-flt-tipi-to-grid
                move rapor-anah-fltler-bas-deger(lbl-i) to gd-6-col-7
                move rapor-anah-fltler-bit-deger(lbl-i) to gd-6-col-8
                modify form6-gd-1,
                       record-to-add(form6-gd-1-record)
                move 10 to bmp-no-1 bmp-no-2 bmp-no-3
                if rapor-anah-secim(lbl-i) = 1
                   move 4 to bmp-no-1
                end-if
                if rapor-anah-fltler-esit(lbl-i)
                   move 4 to bmp-no-2
                end-if
                if rapor-anah-visible(lbl-i) 
                   move 4 to bmp-no-3
                end-if

                modify form6-gd-1(lbl-i + 1),
                       x               = 2
                       cell-color      = 128
                       x               = 3
                       hidden-data     = rapor-anah-secim(lbl-i)
                       bitmap          = artieksi-bmp
                       bitmap-number   = bmp-no-1
                       bitmap-width    = 16
                       bitmap-trailing = 1
                       x               = 6
                       hidden-data     = rapor-anah-fltler-esitmi(lbl-i)
                       bitmap          = artieksi-bmp
                       bitmap-number   = bmp-no-2
                       bitmap-width    = 16
                       bitmap-trailing = 1
                       x               = 7
                       hidden-data     = rapor-anah-gorunsunmu(lbl-i)
                       bitmap          = artieksi-bmp
                       bitmap-number   = bmp-no-3
                       bitmap-width    = 16
                       bitmap-trailing = 1
             else
                add 1 to lbl-ii
                move lbl-ii                   to form6-i
                perform rapor-yrd-bas-flt-tipi-to-grid
                move rapor-yrd-fltler-bas-deger(lbl-ii) to gd-6-col-7
                modify form6-gd-1,
                       record-to-add(form6-gd-1-record)
                move 10 to bmp-no-1 bmp-no-2 bmp-no-3
                if rapor-yrd-visible(lbl-ii) 
                   move 4 to bmp-no-3
                end-if

                modify form6-gd-1(lbl-i + 1),
                       x               = 3
                       hidden-data     = null
                       bitmap          = artieksi-bmp
                       bitmap-number   = bmp-no-1
                       bitmap-width    = 16
                       bitmap-trailing = 1
                       x               = 6
                       hidden-data     = null
                       bitmap          = artieksi-bmp
                       bitmap-number   = bmp-no-2
                       bitmap-width    = 16
                       bitmap-trailing = 1
                       x               = 7
                       hidden-data     = rapor-yrd-gorunsunmu(lbl-ii)
                       bitmap          = artieksi-bmp
                       bitmap-number   = bmp-no-3
                       bitmap-width    = 16
                       bitmap-trailing = 1
             end-if
     end-perform.
     modify form6-gd-1,
            mass-update = 0.
*
 form6-grid-2-doldur.
     modify form6-gd-2,
            reset-grid  = 1
            mass-update = 1
     initialize form6-gd-2-record
     move "SN"               to gd-7-col-1
     move "Detay Adi"        to gd-7-col-2
     move "Max.Uzun."        to gd-7-col-3
     move "Uzunluk"          to gd-7-col-4
     move "Gorunsun"         to gd-7-col-5
     move "Sira"             to gd-7-col-6
     modify form6-gd-2,
            record-to-add(form6-gd-2-record)
     perform varying det-adlari-i 
                     from 1
                     by 1
                     until det-adlari-i > max-det-adlari
             initialize form6-gd-2-record
             move det-adlari-i                      to gd-7-col-1
             move det-adlari(det-adlari-i)          to gd-7-col-2
             move det-adlari-max-au(det-adlari-i)   to gd-7-col-3
             move rapor-detaylar-au(det-adlari-i)   to gd-7-col-4
             move rapor-detaylar-sira(det-adlari-i) to gd-7-col-6
             modify form6-gd-2,
                    record-to-add(form6-gd-2-record)
             move 10 to bmp-no-1
             if rapor-detaylar-ciksin(det-adlari-i)
                move 4 to bmp-no-1
             end-if
             modify form6-gd-2(det-adlari-i + 1),
                    x = 5
                    hidden-data     = rapor-detaylar-e-h(det-adlari-i)
                    bitmap          = artieksi-bmp
                    bitmap-number   = bmp-no-1
                    bitmap-width    = 16
                    bitmap-trailing = 1
     end-perform.
     modify form6-gd-2,
            mass-update = 0.
*
 form6-grid-3-doldur.
     modify form6-gd-3,
            reset-grid = 1
            mass-update = 1
     initialize form6-gd-3-record form6-esleme-ii
     move "Sr"             to gd-8-col-0
     move "Alan Adi"       to gd-8-col-1
     move "Islem"          to gd-8-col-2
     modify form6-gd-3,
            record-to-add(form6-gd-3-record)

     perform varying form6-esleme-i
             from 1
             by 1
             until form6-esleme-i > max-det-adlari
             initialize form6-gd-3-record
             move form6-esleme-i             to iki-hane
             move iki-hane                   to gd-8-col-0
             move det-adlari(form6-esleme-i) to gd-8-col-1
             evaluate true
             when rapor-icmal-detaylar-say(form6-esleme-i)
                  move "Say"                 to gd-8-col-2
             when rapor-icmal-detaylar-topla(form6-esleme-i)
                  move "Topla"               to gd-8-col-2
             when other 
                  move "Yok"                 to gd-8-col-2
             end-evaluate
             
             modify form6-gd-3,
                    record-to-add(form6-gd-3-record)
             modify form6-gd-3(form6-esleme-i + 1),
                    x = 3
                    hidden-data = rapor-icmal-detaylar-gorev(form6-esleme-i)
     end-perform.

     modify form6-gd-3,
            mass-update = 0. 
*
 form6-combolar-doldur.
* rapor-icmal-anahlar ilk kayýtta space olursa...
     inspect rapor-icmal-anahlar 
             replacing all spaces 
             by zeroes.

     modify form6-cm-11,
            reset-list = 1
            mass-update = 1,
            item-to-add("00-Alan seciniz ...")
     modify form6-cm-12,
            reset-list = 1
            mass-update = 1
            item-to-add("00-Alan seciniz ...")
     modify form6-cm-21,
            reset-list = 1
            mass-update = 1
            item-to-add("00-Alan seciniz ...")
     modify form6-cm-22,
            reset-list = 1
            mass-update = 1
            item-to-add("00-Alan seciniz ...")
     modify form6-cm-31,
            reset-list = 1
            mass-update = 1
            item-to-add("00-Alan seciniz ...")
     modify form6-cm-32,
            reset-list = 1
            mass-update = 1
            item-to-add("00-Alan seciniz ...")

     perform varying form6-esleme-i
             from 1
             by 1
             until form6-esleme-i > max-det-adlari
             move form6-esleme-i              to iki-hane
             move iki-hane                    to form6-cm-11-value
                                                 form6-cm-12-value
                                                 form6-cm-21-value
                                                 form6-cm-22-value
                                                 form6-cm-31-value
                                                 form6-cm-32-value
             move "-"                         to form6-cm-11-value(3:)
                                                 form6-cm-12-value(3:)
                                                 form6-cm-21-value(3:)
                                                 form6-cm-22-value(3:)
                                                 form6-cm-31-value(3:)
                                                 form6-cm-32-value(3:)
             move det-adlari(form6-esleme-i)  to form6-cm-11-value(4:)
                                                 form6-cm-12-value(4:)
                                                 form6-cm-21-value(4:)
                                                 form6-cm-22-value(4:)
                                                 form6-cm-31-value(4:)
                                                 form6-cm-32-value(4:)

             modify form6-cm-11,item-to-add(form6-cm-11-value)
             modify form6-cm-12,item-to-add(form6-cm-12-value)
             modify form6-cm-21,item-to-add(form6-cm-21-value)
             modify form6-cm-22,item-to-add(form6-cm-22-value)
             modify form6-cm-31,item-to-add(form6-cm-31-value)
             modify form6-cm-32,item-to-add(form6-cm-32-value)
     end-perform.

     move rapor-icmal-anah11           to form6-cm-11-value
     move "-"                          to form6-cm-11-value(3:)
     move rapor-icmal-anah12           to form6-cm-12-value
     move "-"                          to form6-cm-12-value(3:)
     move rapor-icmal-anah21           to form6-cm-21-value
     move "-"                          to form6-cm-21-value(3:)
     move rapor-icmal-anah22           to form6-cm-22-value
     move "-"                          to form6-cm-22-value(3:)
     move rapor-icmal-anah31           to form6-cm-31-value
     move "-"                          to form6-cm-31-value(3:)
     move rapor-icmal-anah32           to form6-cm-32-value
     move "-"                          to form6-cm-32-value(3:)

     modify form6-cm-11,mass-update = 0
                        value = form6-cm-11-value
     modify form6-cm-12,mass-update = 0
                        value = form6-cm-12-value
     modify form6-cm-21,mass-update = 0
                        value = form6-cm-21-value
     modify form6-cm-22,mass-update = 0
                        value = form6-cm-22-value
     modify form6-cm-31,mass-update = 0
                        value = form6-cm-31-value
     modify form6-cm-32,mass-update = 0
                        value = form6-cm-32-value.
*
 Form6-Ex-Other.
     evaluate key-status
     when 2
          if form6-enable-1 = 1
             exit paragraph
          end-if
          if rapor-adi = spaces
             display omitted beep
             move 4 to accept-control
             move 5 to control-id
             exit paragraph
          end-if
          initialize soru-donus
          perform kaydet-soru
          if soru-donus <> 1
             exit paragraph
          end-if
* kayit kontrol anahtarlar icin
          initialize lbl-i lbl-ii dummy
          perform varying lbl-i 
                  from 1 
                  by 1 
                  until lbl-i > 15
                  add rapor-anah-secim(lbl-i)  to lbl-ii
          end-perform
          if lbl-ii = zeroes
             display message box 
                     "Raporu Kaydedebilmeniz Icin Ana ",
                     "Filtrelerden birini secmek zorundasiniz !!!"
                     title "Uyari"
                     icon mb_error_icon
             move 1 to form6-ta-1-valuea,
             move 1 to Form6-Pg-1-Visible
             move 0 to Form6-Pg-2-Visible
             move 0 to Form6-Pg-3-Visible
             display form6-pg-1 form6-pg-2 form6-pg-3 form6-ta-1
             modify form6-gd-1,
                    cursor-y = 2
                    cursor-x = 3
             move 4 to accept-control
             move 6 to control-id
             exit paragraph
          end-if
* kayit kontrol siralamalar icin
          perform varying lbl-i 
                  from 1 
                  by 1 
                  until lbl-i > max-det-adlari
                  if rapor-detaylar-ciksin(lbl-i)
                     if rapor-detaylar-sira(lbl-i) = 0
                        move "E" to dummy
                        exit perform
                     end-if
                  end-if
          end-perform
          if dummy = "E"
             display message box
                     "Gorunum sekmesi secili alanin siralamasi",new-line,
                     "0 verilemez !"
                     icon mb_error_icon
                     title "Uyari"
             move 2 to form6-ta-1-valuea,
             move 0 to Form6-Pg-1-Visible
             move 1 to Form6-Pg-2-Visible
             move 0 to Form6-Pg-3-visible
             display form6-pg-1 form6-pg-2 form6-pg-3 form6-ta-1
             modify form6-gd-2,
                    cursor-y = lbl-i + 1
                    cursor-x = 5
             move 4 to accept-control
             move 6 to control-id
             exit paragraph
          end-if
* esleme page kontrolu
          inquire form6-cm-11,
                  value in rapor-icmal-anah11
          inquire form6-cm-12,
                  value in rapor-icmal-anah12
          inquire form6-cm-21,
                  value in rapor-icmal-anah21
          inquire form6-cm-22,
                  value in rapor-icmal-anah22
          inquire form6-cm-31,
                  value in rapor-icmal-anah31
          inquire form6-cm-32,
                  value in rapor-icmal-anah32
          open i-o rapor
          move "R"        to rapor-tipi
          write rapor-rec invalid 
                rewrite rapor-rec end-rewrite
          end-write
          close rapor
          perform form6-ekran-temizle
     when 3
          if form6-enable-1 = 1
             exit paragraph
          end-if
          perform sil-soru
          if soru-donus <> 1
             exit paragraph
          end-if
          open i-o rapor
          delete rapor invalid
                 continue
          end-delete
          close rapor
          perform form6-ekran-temizle
     when 6001 
          if rapor-no > zeroes and <= 9999
             move 0 to form6-enable-1
             move 1 to form6-enable-2
             display form6
             perform form6-rapor-goster
          else
             move 4 to accept-control
             move 4 to control-id
             exit paragraph
          end-if
     end-evaluate.
*
 form6-ekran-temizle.
     initialize rapor-rec
     move 1 to form6-enable-1
     move 0 to form6-enable-2
     move 1 to form6-ta-1-valuea,
     move 1 to Form6-Pg-1-Visible
     move 0 to Form6-Pg-2-Visible
     move 0 to Form6-Pg-3-Visible
     display form6
     perform form6-rapor-goster
     move 4 to accept-control
     move 4 to control-id.

*
 Form6-Gd-1-Ev-Other.
     evaluate event-type
     when msg-begin-entry
          move event-action-fail  to event-action
          inquire form6-gd-1, 
                  cursor-x in form6-cursor-x
                  cursor-y in form6-cursor-y
          evaluate form6-cursor-x
* Anah kismi
          when 3
          if (form6-cursor-y - 1) < 9
               initialize form6-sayi
               perform varying lbl-i from 1 by 1 until lbl-i > 15
                       add rapor-anah-secim(lbl-i)  to form6-sayi
               end-perform
* Birden fazla anahtar secildiyse once sifirla
               if form6-sayi > 0
                  perform varying lbl-i from 1 by 1 until lbl-i > 8
                          if lbl-i <> (form6-cursor-y - 1)
                              modify form6-gd-1(lbl-i + 1),
                                     x               = 3,
                                     hidden-data     = 0,
                                     bitmap          = artieksi-bmp,
                                     bitmap-number   = 10,
                                     bitmap-width    = 16,
                                     bitmap-trailing = 1
                              move 0 to rapor-anah-secim(lbl-i)
                          end-if
                  end-perform
               end-if
               move 10 to bmp-no-1
               if rapor-anah-secim(form6-cursor-y - 1) = 1
                  move 0 to rapor-anah-secim(form6-cursor-y - 1)
               else
                  move 1 to rapor-anah-secim(form6-cursor-y - 1)
                  move 1 to rapor-anah-gorunsunmu(form6-cursor-y - 1)
                  move 4 to bmp-no-1
               end-if
               modify form6-gd-1(form6-cursor-y),
                      x               = 3
                      hidden-data     = rapor-anah-secim(form6-cursor-y - 1)
                      bitmap          = artieksi-bmp
                      bitmap-number   = bmp-no-1
                      bitmap-width    = 16
                      bitmap-trailing = 1
                      x               = 7
                      hidden-data     = rapor-anah-gorunsunmu(form6-cursor-y - 1)
                      bitmap          = artieksi-bmp
                      bitmap-number   = bmp-no-1
                      bitmap-width    = 16
                      bitmap-trailing = 1
          end-if
* yrd ile ilgigi bolumlerde form6-cursor-y den  9
* cýkarilmasinin sebebi
* ilk heading satir + 8 satir anah sahalar
* gridden bilgi alýrken 9 uncu satir ama
* yrd elemanlarin dizisinde 1.nci bilgi datada
* o yüzden
* öbür taraftan sinyal aliyorum onun icin yaziyom
* bu kadar aciklamayi
          when 4
               if (form6-cursor-y - 1) < 9
                  evaluate rapor-anah-bas-flt-tipi(form6-cursor-y - 1)
                  when "S" move "D" to rapor-anah-bas-flt-tipi(form6-cursor-y - 1)
                  when "D" move "G" to rapor-anah-bas-flt-tipi(form6-cursor-y - 1)
                  when "G" move "S" to rapor-anah-bas-flt-tipi(form6-cursor-y - 1)
                  when other
                  move "S"          to rapor-anah-bas-flt-tipi(form6-cursor-y - 1)
                  end-evaluate
                  compute form6-i = form6-cursor-y - 1
                  perform rapor-anah-bas-flt-tipi-to-grid
                  modify form6-gd-1(form6-cursor-y),
                         x               = 4
                         hidden-data     = rapor-anah-bas-flt-tipi(form6-cursor-y - 1)
                         cell-data       = gd-6-col-3
               else
* Yrd bas tipi
                  evaluate rapor-yrd-bas-flt-tipi(form6-cursor-y - 9)
                  when "S" move "D"   to rapor-yrd-bas-flt-tipi(form6-cursor-y - 9)
                  when "D" move "G"   to rapor-yrd-bas-flt-tipi(form6-cursor-y - 9)
                  when "G" move "S"   to rapor-yrd-bas-flt-tipi(form6-cursor-y - 9)
                  when other 
                           move "S"   to rapor-yrd-bas-flt-tipi(form6-cursor-y - 9)
                  end-evaluate
                  compute form6-i = form6-cursor-y - 1
                  perform rapor-yrd-bas-flt-tipi-to-grid
                  modify form6-gd-1(form6-cursor-y),
                         x               = 4
                         hidden-data     = rapor-yrd-bas-flt-tipi(form6-cursor-y - 9)
                         cell-data       = gd-6-col-3
               end-if
* Anah veya yrd bas tipi
          when 5
               if (form6-cursor-y - 1) < 9
                  evaluate rapor-anah-bit-flt-tipi(form6-cursor-y - 1)
                  when "S" move "D" to rapor-anah-bit-flt-tipi(form6-cursor-y - 1)
                  when "D" move "G" to rapor-anah-bit-flt-tipi(form6-cursor-y - 1)
                  when "G" move "S" to rapor-anah-bit-flt-tipi(form6-cursor-y - 1)
                  when other
                  move "S"          to rapor-anah-bit-flt-tipi(form6-cursor-y - 1)
                  end-evaluate
                  compute form6-i = form6-cursor-y - 1
                  perform rapor-anah-bit-flt-tipi-to-grid
                  modify form6-gd-1(form6-cursor-y),
                         x               = 5
                         hidden-data     = rapor-anah-bit-flt-tipi(form6-cursor-y - 1)
                         cell-data       = gd-6-col-4
               end-if
*filtreler esitse 
          when 6
          if (form6-cursor-y - 1) < 9
               move 10 to bmp-no-1
               if rapor-anah-fltler-esitmi(form6-cursor-y - 1) = "E"
                  move "H" to rapor-anah-fltler-esitmi(form6-cursor-y - 1)
               else
                  move "E" to rapor-anah-fltler-esitmi(form6-cursor-y - 1)
                  move 4 to bmp-no-1
               end-if
               modify form6-gd-1(form6-cursor-y),
                      x               = 6
                      hidden-data     = rapor-anah-fltler-esitmi(form6-cursor-y - 1)
                      bitmap          = artieksi-bmp
                      bitmap-number   = bmp-no-1
                      bitmap-width    = 16
                      bitmap-trailing = 1
          end-if
          when 7
          if (form6-cursor-y - 1) < 9
               move 10 to bmp-no-1
               if rapor-anah-gorunsunmu(form6-cursor-y - 1) = 1
                  move 0 to rapor-anah-gorunsunmu(form6-cursor-y - 1)
               else
                  move 1 to rapor-anah-gorunsunmu(form6-cursor-y - 1)
                  move 4 to bmp-no-1
               end-if
               modify form6-gd-1(form6-cursor-y),
                      x               = 7
                      hidden-data     = rapor-anah-gorunsunmu(form6-cursor-y - 1)
                      bitmap          = artieksi-bmp
                      bitmap-number   = bmp-no-1
                      bitmap-width    = 16
                      bitmap-trailing = 1
          else 
               move 10 to bmp-no-1
               if rapor-yrd-gorunsunmu(form6-cursor-y - 9) = 1
                  move 0 to rapor-yrd-gorunsunmu(form6-cursor-y - 9)
               else
                  move 1 to rapor-yrd-gorunsunmu(form6-cursor-y - 9)
                  move 4 to bmp-no-1
               end-if
               modify form6-gd-1(form6-cursor-y),
                      x               = 7
                      hidden-data     = rapor-yrd-gorunsunmu(form6-cursor-y - 9)
                      bitmap          = artieksi-bmp
                      bitmap-number   = bmp-no-1
                      bitmap-width    = 16
                      bitmap-trailing = 1
          end-if
          end-evaluate
     end-evaluate.
 rapor-anah-bas-flt-tipi-to-grid.
     evaluate rapor-anah-bas-flt-tipi(form6-i)
     when "S" move "S-Sabit"       to gd-6-col-3
     when "D" move "D-Degisken"    to gd-6-col-3
     when "G" move "G-Gun Tarihi"  to gd-6-col-3
     when other 
          move "S-Sabit"           to gd-6-col-3
     end-evaluate.
 rapor-anah-bit-flt-tipi-to-grid.
     evaluate rapor-anah-bit-flt-tipi(form6-i)
     when "S" move "S-Sabit"       to gd-6-col-4
     when "D" move "D-Degisken"    to gd-6-col-4
     when "G" move "G-Gun Tarihi"  to gd-6-col-4
     when other 
          move "S-Sabit"           to gd-6-col-4
     end-evaluate.
 rapor-yrd-bas-flt-tipi-to-grid.
     evaluate rapor-yrd-bas-flt-tipi(form6-i)
     when "S" move "S-Sabit"       to gd-6-col-3
     when "D" move "D-Degisken"    to gd-6-col-3
     when "G" move "G-Gun Tarihi"  to gd-6-col-3
     when other 
          move "S-Sabit"           to gd-6-col-3
     end-evaluate.
*
 Form6-Gd-2-Ev-Other.
     evaluate event-type
     when msg-begin-entry
          inquire form6-gd-2,
                  cursor-y    in form6-cursor-y
                  cursor-x    in form6-cursor-x
          evaluate form6-cursor-x
          when 1
          when 2
          when 3
               move event-action-fail   to event-action
          when 5
               move event-action-fail   to event-action
               move 10 to bmp-no-1
               if rapor-detaylar-ciksin(form6-cursor-y - 1)
                  move "H"              to rapor-detaylar-e-h(form6-cursor-y - 1)
               else
                  set rapor-detaylar-ciksin(form6-cursor-y - 1) to true
                  move 4                                        to bmp-no-1
               end-if
               modify form6-gd-2(form6-cursor-y),
                      x               = 5
                      hidden-data     = rapor-detaylar-e-h(form6-cursor-y - 1)
                      bitmap          = artieksi-bmp
                      bitmap-number   = bmp-no-1
                      bitmap-width    = 16
                      bitmap-trailing = 1
          end-evaluate
     when msg-finish-entry
          evaluate form6-cursor-x
          when 4 
               inquire form6-gd-2(form6-cursor-y,form6-cursor-x),
                       cell-data in det-adlari-ii
* gelen bilgi max. au fazlaysa uyar ve hödöle
               if det-adlari-ii > det-adlari-max-au(form6-cursor-y - 1) or
                  det-adlari-ii < 1
                  initialize mesaj-kaygisi
                  string  "Sectiginiz [",
                          det-adlari(form6-cursor-y - 1) delimited by size
                          into mesaj-kaygisi
                  inspect mesaj-kaygisi replacing trailing spaces by low-values
                  string mesaj-kaygisi,
                          "] isimli alan" delimited by low-values,
                          new-line delimited by size,
                          "Min. 01, " delimited by size,
                          "Max. " delimited by size
                          det-adlari-max-au(form6-cursor-y - 1) delimited by size,
                          " karakter uzunlugunda olabilir" delimited by size
                          into mesaj-kaygisi
                  display message box mesaj-kaygisi
                          title "Uyari"
                          icon mb_Error_icon
                  modify form6-gd-2(form6-cursor-y,form6-cursor-x),
                         cell-data = rapor-detaylar-au(form6-cursor-y - 1)
               else
                  move det-adlari-ii     to rapor-detaylar-au(form6-cursor-y - 1)
               end-if
          when 6 
               inquire form6-gd-2(form6-cursor-y,form6-cursor-x),
                       cell-data in det-adlari-ii
* gelen bilgi max. siradan fazlaysa uyar ve hödöle
               if det-adlari-ii > max-det-adlari or
                  det-adlari-ii < 1
                  display message box
                          "Siralama araligi : 1-", max-det-adlari," arasi olabilir"
                          title "Uyari"
                          icon mb_Error_icon
                  modify form6-gd-2(form6-cursor-y,form6-cursor-x),
                         cell-data = rapor-detaylar-sira(form6-cursor-y - 1)
               else
* eski hali ii ye aktarýldý 
* girilen deger ile dizideki yeri degýstýrýlecek
                  move rapor-detaylar-sira(form6-cursor-y - 1)   to iki-hane
                  move det-adlari-ii                             to rapor-detaylar-sira(form6-cursor-y - 1)
                  modify form6-gd-2(form6-cursor-y,form6-cursor-x),
                         cell-data = det-adlari-ii
                  perform varying i
                          from 1
                          by 1
                          until i > max-det-adlari
                          if i <> (form6-cursor-y - 1)
                             if rapor-detaylar-sira(i) = det-adlari-ii
                                move iki-hane         to  rapor-detaylar-sira(i)
                                modify form6-gd-2(i + 1,form6-cursor-x),
                                       cell-data = iki-hane
                             end-if
                          end-if
                  end-perform
               end-if
          end-evaluate
     end-evaluate.
* filrelerin screen loceysinlarini defaultluyor
 flt-ana-scr-loc-def.
     perform varying flt-scr-loc-i 
             from 1
             by 1
             until flt-scr-loc-i > 8
             move def-flt-anah-loc-line(flt-scr-loc-i) to 
                  flt-anah-scr-loc-line(flt-scr-loc-i)
     end-perform.

 flt-ana-scr-loc-yerlestir.
     initialize flt-scr-loc-ii
     perform varying flt-scr-loc-i 
             from 1
             by 1
             until flt-scr-loc-i > 8
             if rapor-anah-visible(flt-scr-loc-i)
                add 1 to flt-scr-loc-ii
                move def-flt-anah-loc-line(flt-scr-loc-ii) to 
                     flt-anah-scr-loc-line(flt-scr-loc-i)
             end-if
     end-perform.

 flt-yrd-scr-loc-def.
     perform varying flt-scr-loc-i
             from 1
             by 1
             until flt-scr-loc-i > 9
             move def-flt-yrd-loc-line(flt-scr-loc-i) to 
                  flt-yrd-scr-loc-line(flt-scr-loc-i)
             move def-flt-yrd-loc-col-1(flt-scr-loc-i) to
                  flt-yrd-scr-loc-col-1(flt-scr-loc-i)
             move def-flt-yrd-loc-col-2(flt-scr-loc-i) to
                  flt-yrd-scr-loc-col-2(flt-scr-loc-i)
             move def-flt-yrd-loc-col-3(flt-scr-loc-i) to
                  flt-yrd-scr-loc-col-3(flt-scr-loc-i)
             move def-flt-yrd-loc-col-4(flt-scr-loc-i) to
                  flt-yrd-scr-loc-col-4(flt-scr-loc-i)
     end-perform.

 flt-yrd-scr-loc-yerlestir.
* rezervasyon durumu, grup kodu ve rez.turu
* bastan 3 diziyi yediði için visiblesine + 3 ekliyoruz
     initialize flt-scr-loc-ii
     perform varying flt-scr-loc-i 
             from 1
             by 1
             until flt-scr-loc-i > 9
             if rapor-yrd-visible(flt-scr-loc-i + 3)
                add 1 to flt-scr-loc-ii
                move def-flt-yrd-loc-line(flt-scr-loc-ii) to 
                     flt-yrd-scr-loc-line(flt-scr-loc-i)
                move def-flt-yrd-loc-col-1(flt-scr-loc-ii) to 
                     flt-yrd-scr-loc-col-1(flt-scr-loc-i)
                move def-flt-yrd-loc-col-2(flt-scr-loc-ii) to 
                     flt-yrd-scr-loc-col-2(flt-scr-loc-i)
                move def-flt-yrd-loc-col-3(flt-scr-loc-ii) to 
                     flt-yrd-scr-loc-col-3(flt-scr-loc-i)
                move def-flt-yrd-loc-col-4(flt-scr-loc-ii) to 
                     flt-yrd-scr-loc-col-4(flt-scr-loc-i)
             end-if
     end-perform.
*
 det-yerler-ayarla.
* detay siralamasina gore yerlestir
     initialize det-yerler det-yed-yerler
                det-yerler-i det-yerler-ii
                dokumer-align-occ

     perform varying det-yerler-i
             from 1
             by 1
             until det-yerler-i > max-det-adlari
             move rapor-detaylar-sira(det-yerler-i) 
                  to det-yerler-iii
             move det-yerler-i  
                  to det-yed-yerler-index(det-yerler-iii)
             move rapor-detaylar-au(det-yerler-i)
                  to det-yed-yerler-au(det-yerler-iii)
     end-perform.

* detay sýralandý bp au bul ve det-yerlere yerlestir

     move 1 to yerler-bp
     initialize det-yerler-ii
     perform varying det-yerler-i
             from 1
             by 1
             until det-yerler-i > max-det-adlari
             move det-yed-yerler-index(det-yerler-i)
                  to det-yerler-iii
             move det-yed-yerler-au(det-yerler-i)
                  to det-yerler-au(det-yerler-iii)
             move yerler-bp
                  to det-yerler-bp(det-yerler-iii)
             if rapor-detaylar-ciksin(det-yerler-iii)
                add  det-yed-yerler-au(det-yerler-i)
                     to yerler-bp
                add 1 to yerler-bp
                add 1 to det-yerler-ii
                move det-adlari-justify(det-yerler-iii) 
                     to dokumer-align-occ(det-yerler-ii:1)                     
             end-if
     end-perform.
*
 detay-baslik-ayarla.
     perform varying det-yerler-i
             from 1 
             by 1
             until det-yerler-i > max-det-adlari
                   if rapor-detaylar-ciksin(det-yerler-i)
                      initialize str-func-degiskenler
                      move det-yerler-i                 to str-func-index    
                      move det-adlari(det-yerler-i)     to str-func-alan
                      move "L"                          to str-func-align
                      move det-yerler-au(det-yerler-i)  to str-func-au
                      perform str-func
                      perform str-func-to-det-belirsiz
                   end-if
     end-perform.

*
 detay-baslik-cizgi-ayarla.
     perform varying det-yerler-i
             from 1 
             by 1
             until det-yerler-i > max-det-adlari
                   if rapor-detaylar-ciksin(det-yerler-i)
                      initialize str-func-degiskenler
                      move det-yerler-i                 to str-func-index    
                      move all "-"                      to str-func-alan(1:det-yerler-au(det-yerler-i))
                      move "L"                          to str-func-align
                      move det-yerler-au(det-yerler-i)  to str-func-au
                      perform str-func
                      perform str-func-to-det-belirsiz
                   end-if
     end-perform.

*
 str-func.
     inspect str-func-alan 
             replacing trailing spaces
             by low-values.
     inspect str-func-alan 
             tallying str-func-i
             for all low-values.

     if str-func-i = function length(str-func-alan) 
        move function length(str-func-alan) to str-func-i
     else
        compute str-func-i = (function length(str-func-alan)) -
                             str-func-i
     end-if.


     evaluate str-func-align
     when "C"
          move str-func-alan(1:str-func-au)
               to str-func-temp-alan-1
          call "C$JUSTIFY" using str-func-temp-alan-1(1:str-func-au),"C"
          move str-func-temp-alan-1 to str-func-alan
     when "R"
          move str-func-alan(str-func-i - str-func-au + 1:str-func-au)
          to str-func-temp-alan-1
          call "C$JUSTIFY" using str-func-temp-alan-1(1:str-func-au),"R"
          move str-func-temp-alan-1(1:str-func-au) to str-func-alan
     when "L" 
          move str-func-alan(1:str-func-au)
          to str-func-temp-alan-1
          move str-func-temp-alan-1 to str-func-alan
     end-evaluate.
     inspect str-func-alan
             replacing all low-values
             by spaces.
*
 str-func-to-det-belirsiz.
     move det-yerler-bp(str-func-index)  to str-func-bp
     move det-yerler-au(str-func-index)  to str-func-au
     move str-func-alan(1:str-func-au) to
          det-belirsiz(str-func-bp:str-func-au)
     move "|" to
     det-belirsiz(str-func-bp + str-func-au:1).
*
 Form6-Gd-3-Ev-Other.
     evaluate event-type
     when msg-begin-entry
          move event-action-fail to event-action
          inquire form6-gd-3,
                  cursor-y in form6-esleme-i
          if form6-esleme-i < 2
             exit paragraph
          end-if
          evaluate true
          when rapor-icmal-detaylar-yok(form6-esleme-i - 1)
               set rapor-icmal-detaylar-say(form6-esleme-i - 1) to true
               modify form6-gd-3(form6-esleme-i),
                      x = 3
                      cell-data = "Say"
                      hidden-data = rapor-icmal-detaylar-gorev(form6-esleme-i - 1)
          when rapor-icmal-detaylar-say(form6-esleme-i - 1)
               set rapor-icmal-detaylar-topla(form6-esleme-i - 1) to true
               modify form6-gd-3(form6-esleme-i),
                      x = 3
                      cell-data = "Topla"
                      hidden-data = rapor-icmal-detaylar-gorev(form6-esleme-i - 1)
          when other
               set rapor-icmal-detaylar-yok(form6-esleme-i - 1) to true
               modify form6-gd-3(form6-esleme-i),
                      x = 3
                      cell-data = "Yok"
                      hidden-data = rapor-icmal-detaylar-gorev(form6-esleme-i - 1)
          end-evaluate

     end-evaluate.
 
