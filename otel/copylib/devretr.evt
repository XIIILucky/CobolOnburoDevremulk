* devretr.evt
* devretr.evt is generated from D:\asya\acugt.ytl\otel\devretr.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .
***   start event editor code   ***
*
 Form1-Aft-Create.
      perform adresleri-tasi
            open input genel
      initialize genel-rec 
      move 1        to genel-anahtar
      read genel no lock invalid 
           display message box "Genel Parametreler Tanimsiz..."
                           title "Uyari"
                           icon 1
                 close genel
                 exit paragraph           
      end-read 
      close genel
      move muha-sirketi to hesap-dosya-adres cari-dosya-adres .
      perform  acuserve-adres-aktar
     
  
      open input genelfis
      initialize genelfis-rec 
      move 1        to genelfis-anahtar
      read genelfis no lock invalid 
               continue
      not invalid
           add 1 to EKRAN-FIS-1
           move EKRAN-FIS-1 to takastc-no
      end-read 
      close genelfis
      open output takastc close takastc
     .
*
 Form1-Ex-Other.
     evaluate key-status
         when 999
            perform islem
     end-evaluate
     .
*
 islem.
    if cekleri-al = 1 then
       perform banka-txt-al
       perform cekleri-txt-al
    end-if
    if sozlesme-al = 1 then
       perform sozlesme-txt-al
    end-if
    if taksit-al = 1 then
       perform kasa-txt-al
    end-if
    if odeme-al = 1 then
       perform gelirgider-txt-al
    end-if
    if gorev-al = 1 then
       perform gorev-txt-al
    end-if
    if prim-al = 1 then
       perform prim-txt-al
       perform primhrk-txt-al
    end-if
    if danisman-al = 1 then
       perform danisman-txt-al
    end-if
    if mesajal = 1 then
       perform mesaj-al
    end-if
    if aracal = 1 then
          perform arac-al
          perform arac-liste-al
    end-if
    if danis-guncelle = 1 then
          perform danisman-guncelle
    end-if
    if haftalari-al = 1 then
       perform hafta-islem
    end-if
    if ilgaz-uye-al = 1 then     
       stop " "
       open i-o takvim kur
       initialize kur-rec  
       move 20180101 to kur-tarih
       move 3        to kur-banka
       move 2        to kur-doviz
       read kur no lock invalid
            stop " "
       not invalid
           initialize takvim-rec 
           move kur-tarih to takvim-anah
           start takvim key not < takvim-anah invalid
                 continue
           not invalid
           perform with test after until fs-takvim = "10"
           read takvim next no lock end move "10" to fs-takvim
           not at end 
               if takvim-anah > 20231231
                  exit perform 
               end-if
               move takvim-anah to kur-tarih
               write kur-rec invalid
                     rewrite kur-rec end-rewrite 
               end-write 
           end-read
           end-perform 
           end-start
       end-read  
       close takvim kur 
  
*       if ode-yaz-gun not = zero or ode-yaz-ay not = zero
*          perform ilgaz-uye-al-txt
*       else
*          display message box "Kýrmýzý alanlara odeme gun ve ay yazilmalidir." new-line 
*                              "Ýslemlere devam edilmeyecektir.."
*       end-if


    end-if
    modify Form1-La-1 , title "TRANSFER TAMAM !"

    if stone-mail-al = 1 then
       perform stone-mail-islem
    end-if

    
    display message box "TRANSFER TAMAM !"
      .
*
 stone-mail-islem.
         initialize sayac  
         move 1 to u-sayac
         move 8000000 to m-sayac
         move "/asya/ytl/stonemail.txt"      to txtdevre-adi
         open input txtdevre      
         open i-o genelfis musteri 
         perform until fs-txtdevre = "10"
         initialize txtdevre-rec    
         read txtdevre next no lock end move "10" to fs-txtdevre 
         not at end
         move 1 to sayac
             initialize dizitext-rec
             perform varying k from 1 by 1 until k > 100
             unstring txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
             end-perform
             if dizitext-det(1)  = spaces then
                exit perform cycle
             end-if
             initialize musteri-rec buldum
             move dizitext-det(3) to musteri-e-mail
             start musteri key not <  musteri-e-mail invalid
                   continue
             not invalid
             perform with test after until fs-musteri = "10"
             read musteri next no lock end move "10" to fs-musteri
             not at end 
                  if  musteri-e-mail <> dizitext-det(3)
                      initialize buldum
                      exit perform 
                  end-if
                  move 1 to buldum
                  exit perform 

             end-read
             end-perform 
             end-start
             if buldum = 1
                if xiii-stop = 13 stop " " end-if
                exit perform cycle
             else
                initialize musteri-rec buldum
                inspect dizitext-det(1) converting  x"DDD0DCC7D6DE" to
                                                    x"494755434F53" 
              
                inspect dizitext-det(2) converting  x"DDD0DCC7D6DE" to
                                                    x"494755434F53"             
                move dizitext-det(1)   to musteri-adi
                move dizitext-det(2)   to musteri-soyadi
                move dizitext-det(3)   to musteri-e-mail
                move dizitext-det(4)   to musteri-d-tarihi
                move dizitext-det(5)   to musteri-tel1
                move dizitext-det(6)   to musteri-adres1
                move isyeri-adres-tasi to musteri-sirket     
                 add 1 to m-sayac
                move m-sayac to musteri-no
                write musteri-rec invalid
                      continue
                end-write
                add 1 to u-sayac
             end-if
         end-read              
         end-perform
         display message box "Mail Aktarimi Bittiii"
         close genelfis musteri 
         display message box u-sayac
      .
*
 ilgaz-uye-al-txt.
         initialize sayac  
         move 1 to u-sayac
         move 100000 to m-sayac
         move "/asya/ytl/uyeler.txt"      to txtdevre-adi
         move "/asya/ytl/eslestirme.txt"  to txteslestirme-adi
         open output devremulk donhrk odemeler close devremulk donhrk odemeler
         open input txtdevre      
         open i-o   donem  donem2 genelfis devremulk musteri konum donhrk odemeler kur odalar odalar2
         perform until fs-txtdevre = "10"
         initialize txtdevre-rec    
         read txtdevre next no lock end move "10" to fs-txtdevre 
         not at end
         move 1 to sayac
             initialize dizitext-rec
             perform varying k from 1 by 1 until k > 100
             unstring txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
             end-perform
             if function numval(dizitext-det(3))  = zeroes then
                exit perform cycle
             end-if
             
             initialize devremulk-rec musteri-rec
*******************************************************************************dizitext-det(3),uye-no dev-no          
             move u-sayac         to devremulk-no
             move dizitext-det(3) to devremulk-sozlesme-no
*******************************************************************************dizitext-det(4),(5) dev-musteri-profil          
             inspect dizitext-det(4) converting  x"DDD0DCC7D6DE" to
                                                 x"494755434F53" 
            
             inspect dizitext-det(5) converting  x"DDD0DCC7D6DE" to
                                                 x"494755434F53"             

             move dizitext-det(4) to musteri-adi
             move dizitext-det(5) to musteri-soyadi
             read musteri no lock key musteri-ilk invalid
                  move isyeri-adres-tasi to musteri-sirket     
                   add 1 to m-sayac
                  move m-sayac to musteri-no
                  write musteri-rec invalid
                        continue
                  end-write
                  move m-profil to devremulk-profil-anah
             not invalid
                  move m-profil to devremulk-profil-anah
             end-read
*******************************************************************************dizitext-det(6) dev-donem             
             initialize donem2-rec
             if function numval (dizitext-det(6)) < 10
                move "A00"            to devremulk-devre-donem(1:3)
                move dizitext-det(6) to devremulk-devre-donem(4:1)
             else 
                move "A0"            to devremulk-devre-donem(1:2)
                move dizitext-det(6) to devremulk-devre-donem(3:2)
             end-if
             move devremulk-devre-donem to donem2-kodu
             read donem2 no lock invalid 
                  stop " " 
             end-read
*******************************************************************************dizitext-det(9) dev-konum            
             inspect dizitext-det(9) converting  x"DDD0DCC7D6DE" to
                                                 x"494755434F53" 

             initialize konum-rec konum-var
             start konum key not < konum-anahtar invalid
                   continue
             not invalid
             perform with test after until fs-konum = "10"
             read konum next no lock end move "10" to fs-konum
             not at end 
                 if konum-adi(1:2) = dizitext-det(9)(1:2)
                    move 1 to konum-var
                    exit perform 
                 end-if
             end-read
             end-perform                     
             end-start
             evaluate konum-var
                 when 0
                      add 1 to k-sayac
                      initialize konum-rec
                      move k-sayac to konum-anahtar devremulk-oda-konumu
                      read konum no lock invalid
                           continue
                      end-read
                      move dizitext-det(9) to konum-adi
                      write konum-rec invalid
                            stop " "
                      end-write
                 when 1           
                      move konum-anahtar to devremulk-oda-konumu
             end-evaluate
*******************************************************************************dizitext-det(7) dev-odano  

*             if firt = 1 stop " " end-if
             open input txteslestirme
             perform until fs-txteslestirme = "10" 
             initialize txteslestirme-rec
             read txteslestirme next no lock end move "10" to fs-txteslestirme
             not at end    

                 unstring txteslestirme-rec delimited by x"09" into
                          dts-oda
                          fid-oda
*                 if dts-oda = "002L8" stop " " end-if
*                 if dizitext-det(7) = "2L8" and dts-oda = "002L8" stop " " end-if
                 
                 inspect dts-oda replacing leading "0" by spaces 
                 inspect fid-oda replacing leading "0" by spaces


                 call "c$justify" using dts-oda  "L"
                 call "c$justify" using fid-oda  "L"

                 if dizitext-det(7) = dts-oda                      
                    move fid-oda        to dizitext-det(7)
                    exit perform
                 end-if

             end-read
             end-perform
             close txteslestirme


             initialize kadir
             perform varying kadir
             from 1
             by 1
             until kadir > 6

                if dizitext-det(7)(kadir:1) = spaces
                   exit perform
                end-if

             end-perform



             evaluate kadir - 1
             when 3
                initialize odalar-anah
                move dizitext-det(7)   to odalar-anah 
                call "c$justify" using odalar-anah           "R"
                move "0"               to odalar-anah(1:1)
                move odalar-anah       to devremulk-oda-no
                read odalar no lock invalid
                     stop " "
                not invalid
                    move "A"           to odalar-devre
                    rewrite odalar-rec end-rewrite
                end-read

             when 4
                initialize odalar-anah
                move dizitext-det(7)   to odalar-anah devremulk-oda-no
                read odalar no lock invalid
                     stop " "
                not invalid
                    move "A"           to odalar-devre
                    rewrite odalar-rec end-rewrite
                end-read
             when 5
                initialize odalar2-rec
                move dizitext-det(7)   to odalar2-anah
                read odalar2 no lock invalid
                     stop " "
                not invalid
                    initialize odalar-rec
                    move odalar2-no        to odalar-anah devremulk-oda-no
                    read odalar no lock invalid
                         stop " "
                    not invalid
                        move "A"           to odalar-devre
                        rewrite odalar-rec end-rewrite
                    end-read
                end-read                

             end-evaluate



********************************************************************************dizitext-det(8)  dev-sat-tar  
             unstring dizitext-det(8) delimited by "." or " "
            into devremulk-satis-gun devremulk-satis-ay devremulk-satis-yil


*******************************************************************************dizitext-det(10) dev-ref
             initialize devremulk-referans
             if dizitext-det(10)(1:10) = "REFERANSLI"
                move "01" to devremulk-ozel-kod             
             end-if
*******************************************************************************dizitext-det(11) dev-fix-aid
             initialize devremulk-fix-aidat
             if dizitext-det(11)(1:3) = "SAB"
                move 1 to devremulk-fix-aidat
             end-if
*******************************************************************************dizitext-det(12) dev-dur
             initialize devremulk-durumu
             evaluate dizitext-det(12)(1:1)
                 when "B"
                      move "S" to devremulk-durumu
                 when "G"
                      move "Y" to devremulk-durumu 
             end-evaluate
*******************************************************************************dizitext-det(13) dev-dur
             initialize devremulk-aidat-tutar devremulk-aidat-doviz-kodu xiii
             perform güncel-aidat-kontrol
             if devremulk-aidat-tutar = zero
                move dizitext-det(34)(1:3) to devremulk-aidat-tutar
             end-if

             move "02"                  to devremulk-aidat-doviz-kodu
             move devremulk-satis-yil   to devremulk-baslama-yil
             move 2047                  to devremulk-bitis-yil 
             move "01"                  to devremulk-satan-danisman
             move "01"                  to devremulk-prim-kodu 
             move "02"                  to devremulk-sabit-prim-kodu
             write devremulk-rec not invalid
                   add 1 to u-sayac
             end-write
             perform donhrk-yaz
             move 0 to artik-yazma

             if function numval(dizitext-det(13)) = zeroes and 
                function numval(dizitext-det(14)) = zeroes and
                function numval(dizitext-det(15)) = zeroes 
                   exit perform cycle 
             end-if 

*             perform a-tahakkuk-yaz
             perform aidat-tahakkuk

         end-read              
         end-perform
         display message box "Uye Aktarimi Bittiii"
         close donem donem2 genelfis devremulk musteri konum odalar2 odalar donhrk odemeler kur 
      .
*
 hafta-islem.
         move "/asya/ytl/haftalar.txt"  to txtdevre-adi
        initialize sayac 
         open output donem donem2  close donem  donem2
         open input txtdevre  
         open i-o   donem  donem2 genelfis 

            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock end move "10" to fs-txtdevre 
            not at end
            add 1 to sayac
                   perform varying sayac-2 
                              from 1 
                                by 1
                             until sayac-2 > 100
                           compute sutun-bas   = ((sayac-2 - 1) * 11) + 1
                           compute sutun-bas-2 = (sayac-2  * 11) + 1
                           move txtdevre-rec(sutun-bas:10) to text-tarih-1
                           if text-tarih-1(1:1) = space
                              exit perform
                           end-if
                           initialize donem-rec
                           compute donem-bas-yil = 2000 + sayac-2
                           move donem-bas-yil to donem-yili
                           move "A"           to donem-kodu(1:1)
                           move sayac(4:3)        to donem-kodu(2:3)
                           move text-tarih-1(1:2) to donem-bas-gun
                           move text-tarih-1(4:2) to donem-bas-ay
                           move text-tarih-1(7:4) to donem-bas-yil
                           move donem-bas-tar to tar9
                           compute tar9 = function date-of-integer(function integer-of-date(tar9) + 7)
                           move tar9 to donem-bit-tar
                           write donem-rec invalid
                                 stop "  "
                           end-write
                           initialize donem2-rec
                           move donem-kodu        to donem2-kodu
                           move "KLASIK"          to donem2-adi
                           move donem-kodu(2:3)   to donem2-adi(10:3)
                           move ". HAFTA"         to donem2-adi(15:)
                           move 7                 to donem2-gun
                           write donem2-rec invalid
                                 continue
                           end-write
                   end-perform
            end-read
            end-perform
            display message box "danisman bakim Bittiii"
            close    donem donem2 genelfis
      .

*
 güncel-aidat-kontrol.
          |   if debug = 0
          |      stop " "
          |   end-if

             move 32 to xiii                                                                       
             if function numval-c(dizitext-det(xiii)) not < 2                                      |
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           |
                exit paragraph
             else                                                                                  | det-32
                compute xiii = xiii - 1                                                            |
             end-if                                                                                |

             if function numval-c(dizitext-det(xiii)) not < 2                                      |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           |        
                exit paragraph
             else                                                                                  | det-31 
                compute xiii = xiii - 1                                                            |        
             end-if                                                                                |        

             if function numval-c(dizitext-det(xiii)) not < 2                                      |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           |        
                exit paragraph
             else                                                                                  | det-30 
                compute xiii = xiii - 1                                                            |        
             end-if                                                                                |        

                                                                                                   |        
             if function numval-c(dizitext-det(xiii)) not < 2                                       |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           | det-29 
                exit paragraph
             else                                                                                  |        
                compute xiii = xiii - 1                                                            |        
             end-if
                                                                                                   |        
             if function numval-c(dizitext-det(xiii)) not < 2                                      |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           | det-28 
                exit paragraph
             else                                                                                  |        
                compute xiii = xiii - 1                                                            |        
             end-if
                                                                                                   |        
             if function numval-c(dizitext-det(xiii)) not < 2                                      |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           | det-27 
                exit paragraph
             else                                                                                  |        
                compute xiii = xiii - 1                                                            |        
             end-if
                                                                                                   |        
             if function numval-c(dizitext-det(xiii)) not < 2                                     |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           | det-26 
                exit paragraph
             else                                                                                  |        
                compute xiii = xiii - 1                                                            |        
             end-if

             if function numval-c(dizitext-det(xiii)) not < 2                                  |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           |        
                exit paragraph
             else                                                                                  | det-25 
                compute xiii = xiii - 1                                                            |        
             end-if                                                                                |        

             if function numval-c(dizitext-det(xiii)) not < 2                                  |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           |        
                exit paragraph
             else                                                                                  | det-24 
                compute xiii = xiii - 1                                                            |        
             end-if                                                                                |        

             if function numval-c(dizitext-det(xiii)) not < 2                                      |
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           |
                exit paragraph
             else                                                                                  | det-23
                compute xiii = xiii - 1                                                            |
             end-if                                                                                |

             if function numval-c(dizitext-det(xiii)) not < 2                                      |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           |        
                exit paragraph
             else                                                                                  | det-22 
                compute xiii = xiii - 1                                                            |        
             end-if                                                                                |        

             if function numval-c(dizitext-det(xiii)) not < 2                                      |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           |        
                exit paragraph
             else                                                                                  | det-21 
                compute xiii = xiii - 1                                                            |        
             end-if                                                                                |        

                                                                                                   |        
             if function numval-c(dizitext-det(xiii)) not < 2                                      |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           | det-20 
                exit paragraph
             else                                                                                  |        
                compute xiii = xiii - 1                                                            |        
             end-if
                                                                                                   |        
             if function numval-c(dizitext-det(xiii)) not < 2                                      |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           | det-19 
                exit paragraph
             else                                                                                  |        
                compute xiii = xiii - 1                                                            |        
             end-if
                                                                                                   |        
             if function numval-c(dizitext-det(xiii)) not < 2                                     |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           | det-18 
                exit paragraph
             else                                                                                  |        
                compute xiii = xiii - 1                                                            |        
             end-if
                                                                                                   |        
             if function numval-c(dizitext-det(xiii)) not < 2                                     |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           | det-17 
                exit paragraph
             else                                                                                  |        
                compute xiii = xiii - 1                                                            |        
             end-if

             if function numval-c(dizitext-det(xiii)) not < 2                                    |        
                move function numval-c(dizitext-det(xiii)(1:3)) to devremulk-aidat-tutar           |        
                exit paragraph
             else                                                                                  | det-16 
                compute xiii = xiii - 1                                                            |        
             end-if                                                                                |    
      .
*
 donhrk-yaz.
      initialize l13
      perform varying l13 
         from devremulk-baslama-yil 
           by 1 
        until l13 > devremulk-bitis-yil

              initialize donhrk-rec
              move devremulk-oda-no      to donhrk-oda
              move devremulk-devre-donem to donhrk-kodu
              move l13                   to donhrk-yili 
              move devremulk-no          to donhrk-devremulk-no
              read donhrk no lock invalid 
                   continue
              end-read
              move donhrk-kodu to donem-kodu
              move l13         to donem-yili
              read donem no lock invalid 
                   continue
              end-read
              move donem-bas-tar to donhrk-bas-tar
              move donem-bit-tar to donhrk-bit-tar
              move "Y"           to donhrk-durumu
              move k-kodu-tasi   to donhrk-staf
              write donhrk-rec invalid 
                    rewrite donhrk-rec end-rewrite
              end-write

      end-perform
      .
*
 a-tahakkuk-yaz.      
      initialize l13 tah-top yaz-ode-top
      move function numval-c(dizitext-det(14)) to ode-top
      perform varying l13 from 16 by 1 until l13 > 32
              if dizitext-det(l13)  = spaces and l13 < 32 
                  exit perform cycle
              end-if 
                 initialize odemeler-rec son-sira 
                 move devremulk-no     to odemeler-devremulk-no
                 move high-values      to odemeler-sira 
                 start odemeler key < odemeler-anah invalid 
                       move 1 to son-sira
                 not invalid 
                 perform with test after until fs-odemeler = "10"
                 read odemeler previous no lock end move "10"   to fs-odemeler
                 not at end 
                     if odemeler-devremulk-no <> devremulk-no
                        move 1 to son-sira
                        exit perform 
                     end-if
                     if odemeler-sira is not numeric 
                         initialize odemeler-sira 
                     end-if 
                     move odemeler-sira     to son-sira
                     add 1 to son-sira
                     exit perform 
                 end-read 
                 end-perform
                 end-start    
                 initialize odemeler-rec 
                 move devremulk-no     to odemeler-devremulk-no
                 move son-sira         to odemeler-sira
                 read odemeler no lock invalid
                      continue
                 end-read
                 move ode-yaz-gun to odemeler-tarih-gun
                 move ode-yaz-ay  to odemeler-tarih-ay
                 evaluate l13
                     when 16
                          move 2001 to odemeler-tarih-yil odemeler-donem-yili
                     when 17
                          move 2002 to odemeler-tarih-yil odemeler-donem-yili
                     when 18
                          move 2003 to odemeler-tarih-yil odemeler-donem-yili
                     when 19
                          move 2004 to odemeler-tarih-yil odemeler-donem-yili
                     when 20
                          move 2005 to odemeler-tarih-yil odemeler-donem-yili
                     when 21
                          move 2006 to odemeler-tarih-yil odemeler-donem-yili
                     when 22
                          move 2007 to odemeler-tarih-yil odemeler-donem-yili
                     when 23
                          move 2008 to odemeler-tarih-yil odemeler-donem-yili
                     when 24
                          move 2009 to odemeler-tarih-yil odemeler-donem-yili
                     when 25
                          move 2010 to odemeler-tarih-yil odemeler-donem-yili
                     when 26
                          move 2011 to odemeler-tarih-yil odemeler-donem-yili
                     when 27
                          move 2012 to odemeler-tarih-yil odemeler-donem-yili
                     when 28
                          move 2013 to odemeler-tarih-yil odemeler-donem-yili
                     when 29
                          move 2014 to odemeler-tarih-yil odemeler-donem-yili
                     when 30
                          move 2015 to odemeler-tarih-yil odemeler-donem-yili
                     when 31
                          move 2016 to odemeler-tarih-yil odemeler-donem-yili

                     when 32
                          move 2017 to odemeler-tarih-yil odemeler-donem-yili
                 end-evaluate 
                 move "B" to odemeler-hareket-turu
                 move "AI" to odemeler-islem-turu
                 initialize kur-rec
                 move odemeler-tarih             to kur-tarih
                 move "01"                       to kur-banka
                 move devremulk-aidat-doviz-kodu to kur-doviz
                 read kur no lock invalid
                      move 3 to doviz-alis
                      continue |display message box kur-tarih "tarihinde kur kaydi bulunamadi.."
                 not invalid
                     if function numval-c(dizitext-det(l13)) = zeroes  and l13 = 32
                       move devremulk-aidat-tutar to odemeler-tutar-dv
                       compute odemeler-tutar = odemeler-tutar-dv * doviz-alis
                     else
                       move function numval-c(dizitext-det(l13)) to odemeler-tutar-dv
                       compute odemeler-tutar = odemeler-tutar-dv * doviz-alis
                     end-if 
                 end-read
                 move "TR"      to odemeler-odeme-turu
                 move kur-doviz to odemeler-doviz-kodu
                 move "ASYA"    to odemeler-staf
                 add odemeler-tutar-dv to tah-top
                 if devremulk-satis-yil = 2017
                    initialize odemeler-tutar-dv odemeler-tutar
                 end-if 
                 write odemeler-rec invalid
                       rewrite odemeler-rec end-rewrite
                 end-write
                 if artik-yazma <> 1
                    if function numval(dizitext-det(13)) = zeroes and 
                       function numval(dizitext-det(14)) = zeroes and
                       function numval(dizitext-det(15)) = zeroes 
                          exit perform cycle 
                    end-if 
                    perform alacak-yaz
                 end-if
               
      end-perform           
      .     
*
 aidat-tahakkuk.     
      if debug = 5 and k-kodu-tasi = "X" stop "xiii" end-if
      initialize l13 tah-top yaz-ode-top
      move function numval-c(dizitext-det(15)) to ode-top
      if ode-top = 0
         exit paragraph
      end-if
      perform varying l13 from 16 by 1 until l13 > 32
              move function numval-c(dizitext-det(l13)) to x-tutar
              evaluate x-tutar
                  when 0
                       initialize odemeler-rec son-sira 
                       move devremulk-no     to odemeler-devremulk-no
                       move high-values      to odemeler-sira 
                       start odemeler key < odemeler-anah invalid 
                             move 1 to son-sira
                       not invalid 
                       perform with test after until fs-odemeler = "10"
                       read odemeler previous no lock end move "10"   to fs-odemeler
                       not at end 
                           if odemeler-devremulk-no <> devremulk-no
                              move 1 to son-sira
                              exit perform 
                           end-if
                           if odemeler-sira is not numeric 
                               initialize odemeler-sira 
                           end-if 
                           move odemeler-sira     to son-sira
                           add 1 to son-sira
                           exit perform 
                       end-read 
                       end-perform
                       end-start    
                       initialize odemeler-rec 
                       move devremulk-no     to odemeler-devremulk-no
                       move son-sira         to odemeler-sira
                       read odemeler no lock invalid
                            continue
                       end-read
                       move ode-yaz-gun to odemeler-tarih-gun
                       move ode-yaz-ay  to odemeler-tarih-ay
                       evaluate l13
                           when 16
                                move 2001 to odemeler-tarih-yil odemeler-donem-yili
                           when 17
                                move 2002 to odemeler-tarih-yil odemeler-donem-yili
                           when 18
                                move 2003 to odemeler-tarih-yil odemeler-donem-yili
                           when 19
                                move 2004 to odemeler-tarih-yil odemeler-donem-yili
                           when 20
                                move 2005 to odemeler-tarih-yil odemeler-donem-yili
                           when 21
                                move 2006 to odemeler-tarih-yil odemeler-donem-yili
                           when 22
                                move 2007 to odemeler-tarih-yil odemeler-donem-yili
                           when 23
                                move 2008 to odemeler-tarih-yil odemeler-donem-yili
                           when 24
                                move 2009 to odemeler-tarih-yil odemeler-donem-yili
                           when 25
                                move 2010 to odemeler-tarih-yil odemeler-donem-yili
                           when 26
                                move 2011 to odemeler-tarih-yil odemeler-donem-yili
                           when 27
                                move 2012 to odemeler-tarih-yil odemeler-donem-yili
                           when 28
                                move 2013 to odemeler-tarih-yil odemeler-donem-yili
                           when 29
                                move 2014 to odemeler-tarih-yil odemeler-donem-yili
                           when 30
                                move 2015 to odemeler-tarih-yil odemeler-donem-yili
                           when 31
                                move 2016 to odemeler-tarih-yil odemeler-donem-yili
                           when 32
                                move 2017 to odemeler-tarih-yil odemeler-donem-yili
                       end-evaluate 
                       if odemeler-tarih-yil not > devremulk-satis-yil
                          exit perform cycle
                       end-if
                       move "B" to odemeler-hareket-turu
                       move "AI" to odemeler-islem-turu
                       initialize kur-rec
                       move odemeler-tarih             to kur-tarih
                       move "01"                       to kur-banka
                       move devremulk-aidat-doviz-kodu to kur-doviz
                       read kur no lock invalid
                            move 3 to doviz-alis  |display message box kur-tarih "tarihinde kur kaydi bulunamadi.."
                            move yedek-aidat-dv   to odemeler-tutar-dv
                            compute odemeler-tutar = odemeler-tutar-dv * doviz-alis
                       not invalid    
                             move yedek-aidat-dv   to odemeler-tutar-dv
                             compute odemeler-tutar = odemeler-tutar-dv * doviz-alis
                       end-read
                       move "TR"      to odemeler-odeme-turu
                       move kur-doviz to odemeler-doviz-kodu
                       move "ASYA"    to odemeler-staf
                       add odemeler-tutar-dv to tah-top
                       if devremulk-satis-yil = 2017
                          initialize odemeler-tutar-dv odemeler-tutar
                       end-if 
                       write odemeler-rec invalid
                             rewrite odemeler-rec end-rewrite
                       end-write
                  when 1
                       exit perform cycle
                  when other
                       initialize odemeler-rec son-sira 
                       move devremulk-no     to odemeler-devremulk-no
                       move high-values      to odemeler-sira 
                       start odemeler key < odemeler-anah invalid 
                             move 1 to son-sira
                       not invalid 
                       perform with test after until fs-odemeler = "10"
                       read odemeler previous no lock end move "10"   to fs-odemeler
                       not at end 
                           if odemeler-devremulk-no <> devremulk-no
                              move 1 to son-sira
                              exit perform 
                           end-if
                           if odemeler-sira is not numeric 
                               initialize odemeler-sira 
                           end-if 
                           move odemeler-sira     to son-sira
                           add 1 to son-sira
                           exit perform 
                       end-read 
                       end-perform
                       end-start    
                       initialize odemeler-rec 
                       move devremulk-no     to odemeler-devremulk-no
                       move son-sira         to odemeler-sira
                       read odemeler no lock invalid
                            continue
                       end-read
                       move ode-yaz-gun to odemeler-tarih-gun
                       move ode-yaz-ay  to odemeler-tarih-ay
                       evaluate l13
                           when 16
                                move 2001 to odemeler-tarih-yil odemeler-donem-yili
                           when 17
                                move 2002 to odemeler-tarih-yil odemeler-donem-yili
                           when 18
                                move 2003 to odemeler-tarih-yil odemeler-donem-yili
                           when 19
                                move 2004 to odemeler-tarih-yil odemeler-donem-yili
                           when 20
                                move 2005 to odemeler-tarih-yil odemeler-donem-yili
                           when 21
                                move 2006 to odemeler-tarih-yil odemeler-donem-yili
                           when 22
                                move 2007 to odemeler-tarih-yil odemeler-donem-yili
                           when 23
                                move 2008 to odemeler-tarih-yil odemeler-donem-yili
                           when 24
                                move 2009 to odemeler-tarih-yil odemeler-donem-yili
                           when 25
                                move 2010 to odemeler-tarih-yil odemeler-donem-yili
                           when 26
                                move 2011 to odemeler-tarih-yil odemeler-donem-yili
                           when 27
                                move 2012 to odemeler-tarih-yil odemeler-donem-yili
                           when 28
                                move 2013 to odemeler-tarih-yil odemeler-donem-yili
                           when 29
                                move 2014 to odemeler-tarih-yil odemeler-donem-yili
                           when 30
                                move 2015 to odemeler-tarih-yil odemeler-donem-yili
                           when 31
                                move 2016 to odemeler-tarih-yil odemeler-donem-yili
                           when 32
                                move 2017 to odemeler-tarih-yil odemeler-donem-yili
                       end-evaluate 
                       move "B" to odemeler-hareket-turu
                       move "AI" to odemeler-islem-turu
                       initialize kur-rec
                       move odemeler-tarih             to kur-tarih
                       move "01"                       to kur-banka
                       move devremulk-aidat-doviz-kodu to kur-doviz
                       read kur no lock invalid
                            move 3 to doviz-alis
                            |display message box kur-tarih "tarihinde kur kaydi bulunamadi.."
                            if function numval-c(dizitext-det(l13)) = zeroes  and l13 = 32
                               move devremulk-aidat-tutar to odemeler-tutar-dv
                               compute odemeler-tutar = odemeler-tutar-dv * doviz-alis
                            else
                               move function numval-c(dizitext-det(l13)) to odemeler-tutar-dv
                               compute odemeler-tutar = odemeler-tutar-dv * doviz-alis
                            end-if 
                       not invalid
                           if function numval-c(dizitext-det(l13)) = zeroes  and l13 = 32
                              move devremulk-aidat-tutar to odemeler-tutar-dv
                              compute odemeler-tutar = odemeler-tutar-dv * doviz-alis
                           else
                              move function numval-c(dizitext-det(l13)) to odemeler-tutar-dv
                              compute odemeler-tutar = odemeler-tutar-dv * doviz-alis
                           end-if 
                       end-read
                       move "TR"      to odemeler-odeme-turu
                       move kur-doviz to odemeler-doviz-kodu
                       move "ASYA"    to odemeler-staf
                       add odemeler-tutar-dv to tah-top
                       if devremulk-satis-yil = 2017
                          initialize odemeler-tutar-dv odemeler-tutar
                       end-if 
                       write odemeler-rec invalid
                             rewrite odemeler-rec end-rewrite
                       end-write
                       move odemeler-tutar    to yedek-aidat
                       move odemeler-tutar-dv to yedek-aidat-dv
                       perform odemesini-kaydet
              end-evaluate
      end-perform           
      .
*
 odemesini-kaydet.
       add 1 to son-sira
       move son-sira to  odemeler-sira 
       move "A"      to odemeler-hareket-turu
       move "AO"     to odemeler-islem-turu
       write odemeler-rec invalid
          rewrite odemeler-rec end-rewrite 
       end-write
      .
*
 alacak-yaz.
       move function numval-c(dizitext-det(14)) to odenecek-top
       initialize odemeler-rec
       add 1 to son-sira
       move son-sira to odemeler-sira
       move devremulk-no to odemeler-devremulk-no
       read odemeler no lock invalid
            continue
       end-read
       move ode-yaz-gun to odemeler-tarih-gun
       move ode-yaz-ay  to odemeler-tarih-ay
       evaluate l13
           when 16
                move 2001 to odemeler-tarih-yil odemeler-donem-yili
           when 17
                move 2002 to odemeler-tarih-yil odemeler-donem-yili
           when 18
                move 2003 to odemeler-tarih-yil odemeler-donem-yili
           when 19
                move 2004 to odemeler-tarih-yil odemeler-donem-yili
           when 20
                move 2005 to odemeler-tarih-yil odemeler-donem-yili
           when 21
                move 2006 to odemeler-tarih-yil odemeler-donem-yili
           when 22
                move 2007 to odemeler-tarih-yil odemeler-donem-yili
           when 23
                move 2008 to odemeler-tarih-yil odemeler-donem-yili
           when 24
                move 2009 to odemeler-tarih-yil odemeler-donem-yili
           when 25
                move 2010 to odemeler-tarih-yil odemeler-donem-yili
           when 26
                move 2011 to odemeler-tarih-yil odemeler-donem-yili
           when 27
                move 2012 to odemeler-tarih-yil odemeler-donem-yili
           when 28
                move 2013 to odemeler-tarih-yil odemeler-donem-yili
           when 29
                move 2014 to odemeler-tarih-yil odemeler-donem-yili
           when 30
                move 2015 to odemeler-tarih-yil odemeler-donem-yili
           when 31
                move 2016 to odemeler-tarih-yil odemeler-donem-yili
           when 32
                move 2017 to odemeler-tarih-yil odemeler-donem-yili
       end-evaluate
 
       initialize kur-rec
       move odemeler-tarih             to kur-tarih
       move "01"                       to kur-banka
       move devremulk-aidat-doviz-kodu to kur-doviz
       read kur no lock invalid
            move 3 to doviz-alis

            |display message box kur-tarih "tarihinde kur kaydi bulunamadi.."
       not invalid

           add function numval-c(dizitext-det(l13))     to yaz-ode-top
           evaluate true 
           when function numval-c(dizitext-det(14)) > yaz-ode-top
              if function numval-c(dizitext-det(15)) = yaz-ode-top
                 initialize kalan-deger
                 compute kalan-deger = 
                         function numval-c(dizitext-det(14)) - 
                         function numval-c(dizitext-det(15))
                 compute odemeler-tutar-dv = kalan-deger + function numval-c(dizitext-det(l13))
                 compute odemeler-tutar = odemeler-tutar-dv * doviz-alis
                 move 1 to artik-yazma
              else
                if function numval-c(dizitext-det(l13)) = zeroes 
                  move function numval-c(dizitext-det(14)) to odemeler-tutar-dv
                  compute odemeler-tutar = odemeler-tutar-dv * doviz-alis   
                else
                  move function numval-c(dizitext-det(l13)) to odemeler-tutar-dv
                  compute odemeler-tutar = odemeler-tutar-dv * doviz-alis   
                end-if 
              end-if           
           when function numval-c(dizitext-det(14)) = yaz-ode-top
                if function numval-c(dizitext-det(l13)) = zeroes 
                  move function numval-c(dizitext-det(14)) to odemeler-tutar-dv
                  compute odemeler-tutar = odemeler-tutar-dv * doviz-alis   
                else
                  move function numval-c(dizitext-det(l13)) to odemeler-tutar-dv
                  compute odemeler-tutar = odemeler-tutar-dv * doviz-alis   
                end-if 
                move 1  to artik-yazma
           when function numval-c(dizitext-det(14)) < yaz-ode-top
                 compute toplam-hesap = 
                         function numval-c(dizitext-det(13)) + yaz-ode-top
                 if toplam-hesap > function numval-c(dizitext-det(15))
                    compute fark-hesap = toplam-hesap - function numval-c(dizitext-det(15))
                    compute gercek-hesap = function numval-c(dizitext-det(l13)) - fark-hesap
                    compute odemeler-tutar-dv = odemeler-tutar-dv + gercek-hesap
                    compute odemeler-tutar = odemeler-tutar-dv * doviz-alis  
                    move 1 to artik-yazma
                 end-if 
           end-evaluate  
                       
       end-read
       move "TR"      to odemeler-odeme-turu
       move kur-doviz to odemeler-doviz-kodu
       move "ASYA"    to odemeler-staf
       write odemeler-rec invalid
             stop " "
       end-write.
*
 danisman-guncelle.
 
         move "danisman.txt"  to txtdevre-adi
         move "danisman2.txt" to dizitext-adi

          open  i-o   dizitext close dizitext  
         open output dizitext   close dizitext  
         open input txtdevre  
         open i-o   dizitext  danisman  musteri  genelfis

            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 8
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform
                 
                   if function numval(dizitext-det(01))  = zeroes then
                         exit perform cycle
                   end-if

                   move function numval(dizitext-det(01)) to danisman-kodu
                   read danisman no lock invalid
                           continue
                   not invalid
                         move 1 to genelfis-anahtar 
                         read genelfis no lock invalid
                                 continue
                         not invalid
                                 add 1 to profile-oto
                                 rewrite genelfis-rec invalid
                                         continue
                                 end-rewrite
                         end-read

                         initialize musteri-rec
                         move profile-oto       to danisman-prof-no     musteri-no 
                         move isyeri-adres-tasi to danisman-prof-sirket musteri-sirket
                        
                         move danisman-adi    to musteri-adi
                         move danisman-soyadi to musteri-soyadi

                         move dizitext-det(05) to  musteri-tel1 
                         move dizitext-det(07) to  musteri-tel2 
                         move dizitext-det(08) to  musteri-tel3 
                         move dizitext-det(06) to   musteri-gsm

                         write musteri-rec invalid
                                 stop " "
                         end-write

                         rewrite danisman-rec invalid
                                 continue
                         end-rewrite
                   end-read
            end-read
            end-perform
            display message box "danisman bakim Bittiii"
            close    dizitext danisman  musteri genelfis



         .
*
 mesaj-al.

         move "sozlesmenot.txt"  to txtdevre-adi
         move "sozlesmenot2.txt" to dizitext-adi

         open output dizitext nt close dizitext nt
         open input txtdevre fsozlesme  
         open i-o   dizitext   devremulk kllnc nt
            initialize sira eodemeler-devremulk-no cek-islem-no not-sirak
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 8
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform
                  if not-sirak > 10 then
                     move 0  to not-sirak
                  end-if

                  add 1 to  not-sirak
                 if  dizitext-det(3) = spaces then  exit perform cycle end-if

                 initialize devremulk-rec
                 move dizitext-det(3)(1:12) to devremulk-sozlesme-no
                 start devremulk key not < devremulk-sozlesme-no invalid
                         exit perform cycle
                         continue
                 not invalid
                 perform until fs-devremulk = "10" 
                 read devremulk next no lock end move "10" to fs-devremulk
                 not end
                   initialize NOT-REC
                       if devremulk-sozlesme-no = dizitext-det(3)(1:12)  then
                              move 1               to NOT-devremulk 
                              move "DEV"           to NOT-DOS 
                              move devremulk-no    to NOT-DOS-ANAH(1:8)
                              move not-sirak       to NOT-SIrA
                              move dizitext-det(6) to NOT1

                                   call "c$justify" using dizitext-det(5) ,"L"
                                   unstring dizitext-det(5)   delimited by "/" or "." or "   " 
                                   into   NOT-Giris-gun  NOT-Giris-ay NOT-Giris-YIL 

                                  move "N" to NOT-TIP

                                 move function numval(dizitext-det(4))  to k-1
                                 move function numval(dizitext-det(4))  to k-2

                                 move kullanici-kkkk to NOT-Giris-STAF  
 
                                 accept not-giris-zaman from time

                                 write not-rec invalid 
                                      add 1 to not-sirak
                                      rewrite not-rec invalid
                                      stop " "
                                       end-rewrite
                                 end-write
   

                       else
                             exit perform
                       end-if

                 end-read
                 end-perform
                 end-start

            end-read
            end-perform
            display message box "Bittiii"
            close    dizitext  devremulk  kllnc  nt

         .
*
 arac-al.

         move "araclar.txt"  to txtdevre-adi
         move "araclar2.txt" to dizitext-adi
         initialize arac-sirak
        
         open output dizitext devarac close dizitext devarac
         open input txtdevre   
         open i-o   dizitext devarac 
            initialize sira eodemeler-devremulk-no cek-islem-no not-sirak
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 30
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform
                 initialize devarac-rec
                 add 1 to arac-sirak
                 move arac-sirak to devarac-sira-no
                 if  dizitext-det(5) = spaces then  exit perform cycle end-if
                 move dizitext-det(5)(1:12) to devarac-arac-plaka

                  call "c$justify" using dizitext-det(2) ,"L"
                          unstring dizitext-det(2)   delimited by "/" or "." or "   " 
                      into   devarac-gun  devarac-ay devarac-yil   

               
           
                evaluate dizitext-det(7)(1:10)
                  when "MIDIBUS"
                      move "02"  to devarac-arac-tur 
                  when "MINIBUS"
                      move "01"  to devarac-arac-tur 
                  when "OTOBUS 2"
                     move "05"  to devarac-arac-tur 
                  when "OTOBUS"
                     move "03"  to devarac-arac-tur 
                  when "OTOBUS 1"
                     move "04"  to devarac-arac-tur 
                end-evaluate
                  
                  inspect dizitext-det(8) replacing  all "." by ","
                  move  function numval(dizitext-det(8)) to devarac-tutar

                  move dizitext-det(14)(1:20)   to devarac-gelis-yeri 
             
                  move dizitext-det(16)(1:20)   to devarac-sofor    
                        
                  move function numval (dizitext-det(17)) to devarac-yolcu

                  write devarac-rec invalid
                          stop " "
                  end-write
                

            end-read
            end-perform
            display message box "Bittiii"
            close    dizitext  devarac txtdevre 

         .
*
 arac-liste-al.
   
         move "musteritakip.txt"  to txtdevre-adi
         move "musteritakip2.txt" to dizitext-adi
         initialize arac-sirak  fs-txtdevre
   
         open output dizitext  devaracl close dizitext devaracl 
         open input txtdevre   
         open i-o   dizitext devarac  devaracl
            initialize arac-sirak fs-txtdevre
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 30
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform
                 initialize devaracl-rec
                 add 1 to arac-sirak
                 move arac-sirak to devarac-sira-no

                 if  dizitext-det(5)(1:12) = spaces then  exit perform cycle end-if
                 move dizitext-det(3)(1:15) to devaracl-ad 
                 move dizitext-det(4)(1:15) to devaracl-soyad
              

       
                   initialize arac-tarihh
                   call "c$justify" using dizitext-det(6) ,"L"
                    unstring dizitext-det(6)   delimited by "/" or "." or "   " 
                    into   gunn  ayy yill   

          
                 initialize devarac-rec
                 move dizitext-det(5)(1:12) to devarac-arac-plaka
                 start devarac key not < devarac-arac-plaka invalid
                         continue
                 not invalid
                 perform until fs-devarac = "10"
                 read devarac next no lock end move "10" to fs-devarac
                 not end

                      if  dizitext-det(5)(1:12) = devarac-arac-plaka

                        if arac-tarihh = devarac-tarih then
                            move devarac-sira-no    to devaracl-sira-no
                            move arac-sirak         to devaracl-sira
                            move devarac-arac-plaka to devaracl-arac-plaka
                       end-if

                      else
                            exit perform 

                      end-if


                 end-read
                 end-perform
                 end-start
           
      

                move dizitext-det(9)(1:15)  to devaracl-cep
                move function numval(dizitext-det(8))   to devaracl-danisman
                move dizitext-det(10)(1:15)             to devaracl-gelis-yeri

                display devaracl-rec
                  write devaracl-rec invalid
                       continue
                  end-write
                

            end-read
            end-perform
            display message box "Bittiii"
            close    dizitext devarac  devaracl

         .
*
 gelirgider-txt-al.
         move "gelirgider.txt"  to txtdevre-adi
         move "gelirgider2.txt" to dizitext-adi

         open output dizitext odemeler close dizitext odemeler
         open input txtdevre fsozlesme  
         open i-o banka  dizitext odemeler cek devremulk
            initialize sira eodemeler-devremulk-no cek-islem-no 
            move 1000 to cek-islem-no
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 100
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform

               initialize odemeler-rec
               add 1 to cek-islem-no

               if dizitext-det(2) not = spaces or zeroes then

                   initialize fsozlesme-rec
                   move  dizitext-det(2)(1:12) to  fsozlesme-fide-kodu
                   read fsozlesme no lock invalid
                         exit perform cycle
                   end-read
                   move fsozlesme-asya-kodu to odemeler-devremulk-no

                   if odemeler-devremulk-no = 0 or spaces or zeroes then 
                        exit perform cycle 
                   end-if

                    if odemeler-devremulk-no not = eodemeler-devremulk-no  then
                         move 1 to sira
                    else
                         add  1 to sira
                    end-if

                    move sira to odemeler-sira

                else 
                     exit perform cycle 
                end-if

  
               if dizitext-det(3) not = spaces then
                      call "c$justify" using dizitext-det(3) ,"L"
                          unstring dizitext-det(3)   delimited by "/" or "." or "   " 
                      into   odemeler-tarih-gun  odemeler-tarih-ay odemeler-tarih-yil   
               end-if

                 if dizitext-det(4) not = spaces then
                   if dizitext-det(4) = "GELIR" then
                      move "A" to odemeler-hareket-turu 
                   else
                      move "B" to odemeler-hareket-turu 
                   end-if
               end-if
                 if dizitext-det(5) not = spaces then
                     move function numval(dizitext-det(5)) to odemeler-danisman-kodu  
                 end-if

                ||||||||BURADA KALDIM 14 12 2012 
                if dizitext-det(7) not = spaces then
                     inspect dizitext-det(7) replacing  all "." by ","
                   move  function numval(dizitext-det(7)) to odemeler-tutar

               end-if
               
               |if fsozlesme-fide-kodu = 'E3855' then stop "hopss" end-if

                if dizitext-det(6) not = spaces then
                   evaluate dizitext-det(6)
                   when "SATIS ODEMESI"
                       move  "SO" to odemeler-islem-turu 
                   when "IPTAL ODEMESI"
                       move  "IO" to odemeler-islem-turu 
                        |||
                       perform odemeyi-eksile-ter-cevir
                       ||
                   when "SABIT PRIM ODEMESI"
                       move  "SP" to odemeler-islem-turu 
                        |||
                       perform odemeyi-eksile-ter-cevir
                       ||
                   when "PRIM ODEMESI"
                       move  "NP" to odemeler-islem-turu
                       |||
                       perform odemeyi-eksile-ter-cevir
                       ||
                   when "PERSONEL MAAS PRIMLERI"
                       move  "PM" to odemeler-islem-turu 
                   when "FATURA ODEMESI"
                       move  "FO" to odemeler-islem-turu 
                       |||
                       perform odemeyi-eksile-ter-cevir
                       ||
                   when "AVANS"
                       move  "AV" to odemeler-islem-turu 
                   when "PARA IADESI"
                       move  "PI" to odemeler-islem-turu
                       |||
                       perform odemeyi-eksile-ter-cevir
                       ||
                   when "AVANS GERI ODEMESI"
                       move  "AG" to odemeler-islem-turu
                       |||
                   
                       ||
                   when "DIGER PRIM ODEMELERI"
                       move  "DP" to odemeler-islem-turu 
                         |||
                       perform odemeyi-eksile-ter-cevir
                       ||

                   when "SABIT PRIM GERI ODEMESI"
                       move  "GS" to odemeler-islem-turu 
                       |||
                   
                       ||
                   when "PRIM GERI ODEMESI"
                       move  "GN" to odemeler-islem-turu 
                       |||
                       
                       ||
                   WHEN OTHER 
                       move  "DD" to odemeler-islem-turu 
                       |BOS OLAN KAYITLAR VARRRRRRRRRRRR
                   end-evaluate
               end-if

               if dizitext-det(8) not = spaces then
                   evaluate dizitext-det(8) 
                   when "NAKIT"
                           move  "NA" to odemeler-odeme-turu 
                   when "KK"
                           move  "KK" to odemeler-odeme-turu 
                   when "BANKA"
                           move  "BN" to odemeler-odeme-turu
                   when "POS"
                           move  "PO" to odemeler-odeme-turu 
                   when "MAIL ORDER"
                           move  "MO" to odemeler-odeme-turu
                   when "MERKEZ KASA"
                           move  "MK" to odemeler-odeme-turu
                   when "PTT"
                           move  "PT" to odemeler-odeme-turu 
                   when "IADE FATURASI"
                           move  "IF" to odemeler-odeme-turu
                   when "BARTER"
                           move  "BR" to odemeler-odeme-turu 
                   when "SENET"
                           move  "SE" to odemeler-odeme-turu 
                   when "CEK"
                           move  "CE" to odemeler-odeme-turu
                   when other
                           move  "  " to odemeler-odeme-turu 
                   end-evaluate
               end-if
                if dizitext-det(11) not = spaces then
                 evaluate dizitext-det(11) 
                     when "PESINAT ODEMESI"
                          move  "P" to taksit-sekli 
                     when "NORMAL TAKSIT ODEMESI"
                          move  "N" to taksit-sekli 
                 end-evaluate
               end-if
                
               if dizitext-det(9) not = spaces then
                   move  dizitext-det(9)(1:1) to   odemeler-islem-id
               end-if
               if dizitext-det(10) not = spaces then
                   move  dizitext-det(10)(1:1) to   odemeler-islem-durumu
               end-if
               if dizitext-det(15) not = spaces then
                   move  dizitext-det(15)(1:8) to   odemeler-evrak-no
               end-if
               if dizitext-det(16) not = spaces then
                   move  dizitext-det(61)(1:8) to   odemeler-kocan-no
               end-if
               if dizitext-det(17) not = spaces then
                   initialize banka-rec
                   start banka key not < banka-kodu invalid
                           continue
                   not invalid
                   perform until fs-banka = "10" 
                   read banka next no lock end move "10" to fs-banka
                   not end
                         if dizitext-det(17) = banka-adi then
                              move banka-kodu to odemeler-banka-kodu
                              exit perform 
                         end-if
                   end-read
                   end-perform
                   end-start

               end-if
             
               if dizitext-det(20) not = spaces then
                   move   dizitext-det(20)(1:1) to  odemeler-tapu
               end-if
               if dizitext-det(22) not = spaces then
                   move   dizitext-det(22)      to  odemeler-cekno
               end-if
               |||ODEMEYI CEK DATASINA YAZDIR
               if odemeler-cekno not = spaces  then
                       initialize cek-anah cek-varmi
                       move odemeler-cekno to cek-no
                       move function numval(odemeler-banka-kodu) to cek-banka
                       start cek key not < CEK-ANAH2 invalid
                               continue
                       not invalid
                       perform until fs-cek = "10" 
                       read cek next no lock end move "10" to fs-cek
                       not end
                       ||  if odemeler-cekno  = 'Z9074789' then
                       |        stop " "
                       |  end-if
                          if odemeler-cekno not = cek-no or function numval(odemeler-banka-kodu) not = cek-banka then
                               display message box  odemeler-devremulk-no"NOLU DEVREMULKTE  CEK SILINMIS CEKNO:" odemeler-cekno 


                                    initialize cek-rec

                                    move cek-islem-no to CEK-ISL-NO  odemeler-cek-isl-no
                                    MOVE odemeler-cekno TO CEK-NO
                                    move "CE" to cek-tipi
                                    move "A"  to CEK-A-V
                                    move "E"  to CEK-MUHASEBE-EH
                                    move "T"  to CEK-DOVIZLIMI
                                    move odemeler-tarih-yil  to CEK-ISL-yil  CEK-VADE-YIL   CEK-VALOR-YIL     
                                    move odemeler-tarih-ay   to CEK-ISL-ay   CEK-VADE-ay    CEK-VALOR-ay  
                                    move odemeler-tarih-gun  to CEK-ISL-gun  CEK-VADE-gun   CEK-VALOR-gun
                                    move odemeler-banka-kodu to CEK-BANKA 
                                    move odemeler-tutar to CEK-TUTAR
                                    write cek-rec invalid
                                            stop " "
                                    end-write

                               exit perform


                               
                          else
                               move CEK-ISL-NO to odemeler-cek-isl-no
                               
                               exit perform
                          end-if
                       end-read
                       end-perform
                       end-start
               else
                      if odemeler-islem-turu = "SO" then
                              perform nakit-ceke-yaz
                      end-if
               end-if
               |||
               if dizitext-det(28) not = spaces then
                   move   dizitext-det(28)      to  odemeler-kuserid
               end-if

               write odemeler-rec invalid
                     stop " "
               end-write

             
                evaluate odemeler-islem-turu
                   when "SP" 
                       MOVE "SS"  TO odemeler-islem-turu
                       compute odemeler-tutar = odemeler-tutar * -1
                       add  1 to sira
                       move sira to odemeler-sira
                       write odemeler-rec invalid
                             stop " "
                       end-write
                       initialize devremulk-no
                       move odemeler-devremulk-no to devremulk-no
                       read devremulk no lock invalid 
                               continue
                       not invalid
                           move 1 to devremulk-prim-atandi
                           rewrite devremulk-rec invalid
                                  stop " "
                           end-rewrite
                       end-read

                   when "NP"
                       MOVE "PP"  TO odemeler-islem-turu
                       compute odemeler-tutar = odemeler-tutar * -1 
                       add  1 to sira
                       move sira to odemeler-sira
                       write odemeler-rec invalid
                           stop " "
                      end-write

                       initialize devremulk-no
                       move odemeler-devremulk-no to devremulk-no
                       read devremulk no lock invalid 
                               continue
                       not invalid
                           move 1 to devremulk-prim-atandi
                           rewrite devremulk-rec invalid
                                  stop " "
                           end-rewrite
                       end-read

                END-EVALUATE

            

            move odemeler-devremulk-no to eodemeler-devremulk-no

            end-read
            end-perform
            modify Form1-La-1 , title "ODEMELER ALINDI !" 
         close banka txtdevre  dizitext odemeler fsozlesme cek  devremulk

         .
*
 nakit-ceke-yaz.
            initialize cek-rec

            move cek-islem-no to CEK-ISL-NO  odemeler-cek-isl-no
            move odemeler-odeme-turu to cek-tipi
            move "A"  to CEK-A-V
            move "E"  to CEK-MUHASEBE-EH
            move "T"  to CEK-DOVIZLIMI
            move odemeler-tarih-yil  to CEK-ISL-yil  CEK-VADE-YIL   CEK-VALOR-YIL     
            move odemeler-tarih-ay   to CEK-ISL-ay   CEK-VADE-ay    CEK-VALOR-ay  
            move odemeler-tarih-gun  to CEK-ISL-gun  CEK-VADE-gun   CEK-VALOR-gun
            move odemeler-banka-kodu to CEK-BANKA 
            move odemeler-tutar to CEK-TUTAR
            write cek-rec invalid
                    stop " "
            end-write
            .
*
 odemeyi-eksile-ter-cevir.

             compute odemeler-tutar = odemeler-tutar * -1
             if odemeler-hareket-turu = "A" then
                move "B" to odemeler-hareket-turu
             else
                move "A" to odemeler-hareket-turu
             end-if .
*
 sozlesme-txt-al.
           move "sozlesme.txt"  to txtdevre-adi
           move "sozlesme2.txt" to dizitext-adi
           open output fsozlesme close fsozlesme
           open i-o fsozlesme
           initialize y-musteri-anah 
           open output dizitext close dizitext

           open input genelfis
           initialize genelfis-rec  
              move 1        to genelfis-anahtar
              read genelfis no lock invalid 
              not invalid
                  move profile-oto to y-musteri-prof
                  move isyeri-adres-tasi to y-musteri-sirket
              end-read 
            close genelfis
        
            open output musteri devremulk close musteri devremulk
            open input txtdevre  odalar
            open i-o  devremulk dizitext musteri  takastc
            initialize txtdevre-rec
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 100
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform
               initialize devremulk-rec

               |sozlesme Id
               if dizitext-det(1) not = spaces then
                  move  FUNCTION NUMVAL(dizitext-det(1)(1:8)) to devremulk-no
               end-if

               |dosya no
               if dizitext-det(2) not = spaces then
                  move  dizitext-det(2)(1:10) to devremulk-dosya-no
               end-if
               |sozlesme no
               if dizitext-det(3) not = spaces then
                  move  dizitext-det(3)(1:12) to devremulk-sozlesme-no

                  move devremulk-no              to fsozlesme-asya-kodu
                  move devremulk-sozlesme-no     to fsozlesme-fide-kodu
                  write fsozlesme-rec  invalid
                       stop " "
                  end-write

               end-if

               |hoppa gangam stylllllllll profilll acicaðzzzzzzzzzz

               perform musteri-prof-yaz

               |||dýptýss
             
               if dizitext-det(7) not = spaces then

                   call "c$justify" using dizitext-det(7) ,"L"
                   unstring dizitext-det(7)   delimited by "/" or "." or "   "
                   into   devremulk-satis-gun  devremulk-satis-ay devremulk-satis-yil    

              |    display message box tarih-dizi(1)(3:2)   "/" tarih-dizi(2)(3:2) "/"  tarih-dizi(3)(1:4)

               end-if

               if dizitext-det(10) not = spaces then
                    move  function numval (dizitext-det(10)(1:5)) to        devremulk-satan-danisman
               end-if
               if dizitext-det(11) not = spaces then
                     inspect dizitext-det(11) replacing  all "." by ","
                   move  function numval(dizitext-det(11)) to devremulk-satis-tutari
               end-if  
               if dizitext-det(12) not = spaces then
                    move  dizitext-det(12)(1:20) to  devremulk-durum
               end-if 

               |||||prim dagýlýmlarýýýý
               if dizitext-det(15) not = spaces then
                    move  function numval(dizitext-det(15)(1:5)) to  devremulk-p-asistan
               end-if 
               if dizitext-det(16) not = spaces then
                    move  function numval(dizitext-det(16)(1:5)) to  devremulk-p-danisman
               end-if 
               if dizitext-det(17) not = spaces then
                    move  function numval(dizitext-det(17)(1:5)) to  devremulk-p-liddanisman 
               end-if 
               if dizitext-det(18) not = spaces then
                    move  function numval(dizitext-det(18)(1:5)) to  devremulk-p-yondanisman
               end-if 
               if dizitext-det(19) not = spaces then
                    move  function numval(dizitext-det(19)(1:5)) to  devremulk-p-ilsatmud
               end-if 
               if dizitext-det(20) not = spaces then
                    move  function numval(dizitext-det(20)(1:5)) to  devremulk-p-bolgemud 
               end-if 
               if dizitext-det(21) not = spaces then
                    move  function numval(dizitext-det(21)(1:5)) to  devremulk-p-bolgekor 
               end-if 
               if dizitext-det(22) not = spaces then
                    move  function numval(dizitext-det(22)(1:5)) to  devremulk-p-kor 
               end-if 
               if dizitext-det(23) not = spaces then
                    move  function numval(dizitext-det(23)(1:5)) to  devremulk-p-gkor 
               end-if 
               if dizitext-det(64) not = spaces then
                    move  function numval(dizitext-det(64)(1:5)) to  devremulk-p-yrdkor 
               end-if 
               if dizitext-det(65) not = spaces then
                    move  function numval(dizitext-det(65)(1:5)) to  devremulk-p-prokor 
               end-if 
               if dizitext-det(66) not = spaces then
                    move  function numval(dizitext-det(66)(1:5)) to  devremulk-p-yonkur 
               end-if 
               ||||||prim dagýlýmlarýýýý

               if dizitext-det(29) not = spaces then
                    move  function numval(dizitext-det(29)(1:5)) to  devremulk-ekleyen 
               end-if 
               
               if dizitext-det(43) not = spaces then
                    move  function numval(dizitext-det(43)(1:4)) to oda-z
                    move  oda-z                 to devremulk-oda-no
                    initialize odalar-rec
                    move devremulk-oda-no to odalar-anah
                    read odalar no lock invalid 
                            continue
                    not invalid
                        move ODALAR-KONUMU to devremulk-oda-konumu
                    end-read
               end-if
 
               if dizitext-det(37) not = spaces then
                    move  dizitext-det(37)(1:1) to  devremulk-odeme-turu  
               end-if 
               if dizitext-det(44) not = spaces then
                    move  dizitext-det(44)(1:1) to  devremulk-vekalet  
               end-if 

               if dizitext-det(45) not = spaces then
                    move  function numval(dizitext-det(45)(1:5)) to  devremulk-vekalet-no   
               end-if 

               if dizitext-det(46) not = spaces then
                    move  function numval(dizitext-det(46)(1:5)) to  devremulk-tapu-ekleyen   
               end-if
               if dizitext-det(47) not = spaces then
                    move  dizitext-det(47)(1:10) to  devremulk-parsel-no   
               end-if 
               
               if dizitext-det(48) not = spaces then
                    move  dizitext-det(48)(1:1) to  devremulk-hasarli    
               end-if 
               if dizitext-det(54) not = spaces then
                    move  function numval(dizitext-det(54)) to  devremulk-iptal  
                    if devremulk-iptal = 1 then
                         move "S" to devremulk-durumu
                    else
                         move "Y" to devremulk-durumu
                    end-if
               end-if 
               if dizitext-det(55) not = spaces then
                    move  dizitext-det(55)(1:50) to  devremulk-tapu    
               end-if 

               if dizitext-det(56) not = spaces then  ||bu hep 2000 ne ayaksa programin icinde 2000 den <= diye sabit bir where kosulu var :S
                     inspect dizitext-det(56) replacing  all "." by ","
                   move  function numval(dizitext-det(56)) to devremulk-prim
               end-if 

               if dizitext-det(57) not = spaces then  
                      inspect dizitext-det(57) replacing  all "." by ","
                   move  function numval(dizitext-det(57)) to devremulk-pesinat
 
               end-if 

               if dizitext-det(58) not = spaces then  
                    move  function numval(dizitext-det(58)(1:5)) to devremulk-prim-kodu
               end-if 
               if dizitext-det(59) not = spaces then  
                    move  dizitext-det(59)(1:1) to devremulk-kilit
               end-if 
               if dizitext-det(60) not = spaces then  
                    move  dizitext-det(60)(1:1) to devremulk-mail-order
               end-if
               if dizitext-det(61) not = spaces then  
                    move  dizitext-det(61)(1:15) to devremulk-arac
               end-if
               if dizitext-det(67) not = spaces then  
                    move  function numval(dizitext-det(67)(1:5))  to devremulk-sabit-prim-kodu 
               end-if
               if dizitext-det(68) not = spaces then  
                      call "c$justify" using dizitext-det(68) ,"L"
                          unstring dizitext-det(68)   delimited by "/" or "." or "   "
                      into  devremulk-tapu-ver-gun  devremulk-tapu-ver-ay devremulk-tapu-ver-yil
               end-if
               if dizitext-det(69) not = spaces then  
                   move function numval(dizitext-det(69)(1:5)) to devremulk-kampanya-kodu
               end-if
               if dizitext-det(70) not = spaces then  
                   move dizitext-det(70)(1:1) to devremulk-onay
               end-if
               |||simdilik koyuyoruzzz

                 move 2013 to devremulk-baslama-yil
                 move 2062 to devremulk-bitis-yil
               ||
               write devremulk-rec invalid
                       stop "ayni devremulk var !"
               end-write

            end-read 
            end-perform

         |||profilin son id sini kaydett
            open i-o genelfis
              initialize genelfis-rec 
              move 1        to genelfis-anahtar
              read genelfis no lock invalid 
              not invalid
                 move y-musteri-prof to profile-oto 
                 rewrite genelfis-rec
                 end-rewrite
              end-read 
            close genelfis
          |||||

            modify Form1-La-1 , title "SOZLESMELER ALINDI !"
            close txtdevre  devremulk dizitext  musteri odalar fsozlesme takastc
            
         .
*
 musteri-prof-yaz.
                initialize musteri-rec
                move y-musteri-anah to m-profil

                if dizitext-det(4) not = spaces then
                  move  dizitext-det(4)(1:25)  to musteri-adi
                end-if
                if dizitext-det(5) not = spaces then
                  move  dizitext-det(5)(1:25)  to musteri-soyadi
                end-if
                if dizitext-det(6) not = spaces then
                  move  dizitext-det(6)(1:15)  to musteri-tel1 
                end-if
                if dizitext-det(8) not = spaces then
                  move  function numval(dizitext-det(8)) to musteri-kim-tcno 
                end-if
                if dizitext-det(9) not = spaces then
                  move  dizitext-det(9)(1:50)  to musteri-kis-adrs
                  move  dizitext-det(9)(50:50) to musteri-kis-adrs1
                end-if
                if dizitext-det(32) not = spaces then
                  move  dizitext-det(32)(1:15)  to musteri-gsm
                end-if
                if dizitext-det(33) not = spaces then
                  move  dizitext-det(33)(1:15) to musteri-tel2
                end-if
                if dizitext-det(34) not = spaces then
                  move  dizitext-det(34)(1:40) to musteri-web-adresi  
                end-if



           |     initialize takastc-rec
           |     move musteri-kim-tcno to takastc-anah
           |     read takastc no lock invalid
            |
           |         if musteri-kim-tcno not = zeroes then
           |                initialize takastc-rec
           |                move musteri-kim-tcno to takastc-tc
           ||                move y-musteri-sirket to takastc-prof-sirket
           |                move y-musteri-prof   to takastc-prof-no
            |               write takastc-rec  invalid
            |                       stop "takasta var"
            |               end-write 
            |         end-if
            |
           |         write musteri-rec  invalid
           |             stop "ayni kayit var !"
           |         end-write
           |         move y-musteri-anah      to devremulk-profil-anah
           |         continue
           |     not invalid
           |         move takastc-prof-sirket to devremulk-profil-Sirket
           |         MOVE takastc-prof-no     TO devremulk-profil-no
           |     end-read

               write musteri-rec  invalid
                        stop "ayni kayit var !"
               end-write
               move y-musteri-anah      to devremulk-profil-anah
               add 1 to y-musteri-prof
                .

*
 cekleri-txt-al.
         perform acuserve-adres-aktar
         move "cekkasasi.txt"  to txtdevre-adi
         move "cekkasasi2.txt" to dizitext-adi
         open output dizitext cek close dizitext cek

        
         open input txtdevre banka 
         open i-o  cek dizitext
            initialize txtdevre-rec
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 100
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform
               initialize cek-rec
     


               if dizitext-det(1) not = spaces then
                   move  function numval(dizitext-det(1)(1:10)) to CEK-ISL-NO
               end-if
               if dizitext-det(3) not = spaces then
                   move  dizitext-det(3)(1:15) to CEK-NO
               end-if

             |   if cek-no = '6945686' then stop " " end-if

               if dizitext-det(4) not = spaces then
                    initialize banka-rec
                    start banka  key not < banka-kodu invalid
                            continue
                    not invalid
                    perform until fs-banka = "10" 
                    read banka next no lock end move "10" to fs-banka
                    not end
                         if banka-adi = dizitext-det(4) then
                              move banka-kodu to CEK-BANKA
                              exit perform
                         end-if
                    end-read
                    end-perform
                    end-start
               end-if
               if dizitext-det(5) not = spaces then
                   move dizitext-det(5) to CEK-BANKA-SUBE

               end-if

                if dizitext-det(6) not = spaces then
                      call "c$justify" using dizitext-det(6) ,"L"
                          unstring dizitext-det(6)   delimited by "/" or "." or "   "
                      into  CEK-VADE-GUN  CEK-VADE-ay CEK-VADE-yil   
               end-if

               if dizitext-det(7) not = spaces then
                      inspect dizitext-det(7) replacing  all "." by ","
                   move  function numval(dizitext-det(7)) to cek-tutar

 
               end-if
              
          |     if dizitext-det(8) not = spaces then
          |        |cek ünvai alaný yokkkkkkkkk
          |     end-if
          |      if dizitext-det(9) not = spaces then
                 | durum yok :/
          |     end-if

               if dizitext-det(10) not = spaces then
                      call "c$justify" using dizitext-det(10) ,"L"
                          unstring dizitext-det(10)   delimited by "/" or "." or "   "
                      into  CEK-ISL-GUN  CEK-ISL-ay CEK-ISL-yil   
               end-if

               if dizitext-det(12) not = spaces then
                    if  dizitext-det(11)(1:1) = "1" then
                        move "X"  to   CEK-DURUMU 
                     else
                        initialize CEK-DURUMU
                    end-if
               end-if

              if dizitext-det(10) not = spaces then 
                 move dizitext-det(10) to CEK-ACIKLAMA
              end-if

              if dizitext-det(10) not = spaces then 
                 move dizitext-det(10) to CEK-ACIKLAMA
              end-if

             |  if dizitext-det(12) not = spaces then
                    | idaee ?  bosssssss
             |  end-if
       
                move "E"              to CEK-MUHASEBE-EH
                set cek-tl            to true 
                move "CE"              to CEK-TIPI
                move "A"              to cek-a-v 

                initialize CEK-VALOR 
                initialize CEK-HESAP-NO 
                initialize CEK-ILK-CARI


               write CEK-rec invalid
                       rewrite CEK-rec end-rewrite
               end-write

            end-read
            end-perform
         
           modify Form1-La-1 , title "CEKLER ALINDI"
         
         close cek txtdevre  dizitext banka
         .
*
 gorev-txt-al.
         
         move "gorevler.txt"  to txtdevre-adi
         move "gorevler2.txt" to dizitext-adi

         open output dizitext gorev close dizitext gorev
         open input txtdevre 
         open i-o gorev  dizitext
            initialize banka-rec
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 100
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform

               initialize gorev-rec
               if dizitext-det(1) not = spaces then
                   move  function numval(dizitext-det(1)(1:3)) to gorev-kodu
               end-if
  
               if dizitext-det(2) not = spaces then
                   move  dizitext-det(2) to gorev-adi
               end-if
               if dizitext-det(3) not = spaces then
                   move  dizitext-det(3)(1:1) to gorev-tur
               end-if
               if dizitext-det(4) not = spaces then
                   move  function numval(dizitext-det(4)) to gorev-sira
               end-if
               write gorev-rec invalid
                       rewrite gorev-rec end-rewrite
               end-write
            end-read
            end-perform
            modify Form1-La-1 , title "GOREV KODLARI ALINDI !"
         close gorev txtdevre  dizitext
         .
*
 prim-txt-al.

         move "primkategori.txt"  to txtdevre-adi
         move "primkategori2.txt" to dizitext-adi

         open output dizitext prim close dizitext prim
         open input txtdevre 
         open i-o prim  dizitext
            initialize banka-rec
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 100
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform

               initialize prim-rec
               if dizitext-det(1) not = spaces then
                   move  function numval(dizitext-det(1)(1:3)) to prim-kodu
               end-if
               if dizitext-det(2) not = spaces then
                   move  dizitext-det(2) to prim-adi
               end-if
               if dizitext-det(3) not = spaces then
                   move  dizitext-det(3)(1:1) to prim-aktif
               end-if
               if dizitext-det(4) not = spaces then
                   move  dizitext-det(4)(1:1) to prim-ozel
               end-if
               if dizitext-det(5) not = spaces then
                   move  dizitext-det(5)(1:1) to prim-sabit
               end-if

               write prim-rec invalid
                   stop " "
               end-write

            end-read
            end-perform
            modify Form1-La-1 , title "PRIM KODLARI ALINDI !"
         close prim txtdevre  dizitext
         .
*
 primhrk-txt-al.

         move "primodemeleri.txt"  to txtdevre-adi
         move "primodemeleri2.txt" to dizitext-adi

         open output dizitext primhrk close dizitext primhrk
         open input txtdevre 
         open i-o primhrk  dizitext
            initialize banka-rec
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 100
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform

               initialize primhrk-rec
               if dizitext-det(3) not = spaces then
                   move  function numval(dizitext-det(3)(1:3)) to primhrk-gorev-kodu
               end-if
               if dizitext-det(4) not = spaces then
                   inspect dizitext-det(4) replacing  all "." by ","
                   move  function numval(dizitext-det(4)) to primhrk-primi
               end-if
               if dizitext-det(5) not = spaces then
                   inspect dizitext-det(5) replacing  all "." by ","
                   move  function numval(dizitext-det(5)) to primhrk-prim-sinir
               end-if
               if dizitext-det(6) not = spaces then
                   move  function numval(dizitext-det(6)(1:3)) to primhrk-kodu
               end-if
               if dizitext-det(7) not = spaces then
                   move  dizitext-det(7)(1:1) to primhrk-turu 
               end-if

               write primhrk-rec invalid
                   stop " "
               end-write

            end-read
            end-perform
            modify Form1-La-1 , title "PRIM HRK ALINDI !"
         close primhrk txtdevre  dizitext
         .
*
 danisman-txt-al.

         move "personel.txt"  to txtdevre-adi
         move "personel2.txt" to dizitext-adi
         initialize y-musteri-anah
         open input genelfis
           initialize genelfis-rec  
              move 1        to genelfis-anahtar
              read genelfis no lock invalid 
              not invalid
                  move profile-oto to y-musteri-prof
                  move isyeri-adres-tasi to y-musteri-sirket
              end-read 
            close genelfis


         open output dizitext danisman close dizitext danisman
         open input txtdevre 
         open i-o danisman  dizitext musteri
            initialize banka-rec
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 100
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform

               initialize danisman-rec



               if dizitext-det(36) not = spaces then
                   move  function numval(dizitext-det(36)(1:5)) to danisman-kodu
               end-if
               if dizitext-det(2) not = spaces then
                   move  dizitext-det(2)(1:20) to danisman-adi
                   
               end-if
               if dizitext-det(3) not = spaces then
                   move  dizitext-det(3)(1:20) to danisman-soyadi
               end-if
               |||duptýs profilll acýlacakkkk

               perform danisman-prof-yaz

               if dizitext-det(10) not = spaces then
                   move  dizitext-det(10)(1:11) to danisman-tc
               end-if

               if dizitext-det(37) not = spaces then
                   move  function numval(dizitext-det(37)(1:5)) to danisman-bagli-kodu
               end-if
               if dizitext-det(52) not = spaces then
                   move  dizitext-det(52)(1:1) to danisman-birim
               end-if
               if dizitext-det(53) not = spaces then
                   move  dizitext-det(53)(1:1) to danisman-pasif
                   if danisman-pasif = 1 then
                       move 0 to danisman-pasif
                   else
                       move 1 to danisman-pasif
                   end-if
               else
                       move 0 to danisman-pasif
               end-if
               if dizitext-det(54) not = spaces then
                   move  dizitext-det(54)(1:1) to danisman-onay
               end-if
               if dizitext-det(58) not = spaces then
                   move  dizitext-det(58)(1:9) to danisman-puani
               end-if
               if dizitext-det(64) not = spaces then
                   move  dizitext-det(64)(1:1) to danisman-sabit-prim
               end-if
               if dizitext-det(38) not = spaces then
                   move  function numval(dizitext-det(38)) to danisman-gorev-kodu
               end-if
               if dizitext-det(55) not = spaces then
                   call "c$justify" using dizitext-det(55) ,"L"
                          unstring dizitext-det(55)   delimited by "/" or "." or "   "
                      into  danisman-kayit-gun  danisman-kayit-ay danisman-kayit-yil   
               end-if

               write danisman-rec invalid
                   stop " "
               end-write

            end-read
            end-perform
            modify Form1-La-1 , title "DANISMAN KODLARI ALINDI !"
         close danisman txtdevre  dizitext musteri
         .
*
 danisman-prof-yaz.
                initialize musteri-rec
                move y-musteri-anah to m-profil

                if dizitext-det(2) not = spaces then
                   move  dizitext-det(2)(1:20) to musteri-adi
               end-if
               if dizitext-det(3) not = spaces then
                   move  dizitext-det(3)(1:20) to musteri-soyadi
               end-if

               if dizitext-det(10) not = spaces then
                   move  dizitext-det(10)(1:11) to musteri-kim-tcno
               end-if

               ||| move "" to musteri-tip
                write musteri-rec  invalid
                     stop "ayni kayit var !"
                end-write

                move y-musteri-anah to danisman-prof-anah
                add 1 to y-musteri-prof
                .
*
 banka-txt-al.
         
         move "kasabanka.txt"  to txtdevre-adi
         move "kasabanka2.txt" to dizitext-adi
         open output dizitext close dizitext
         open input txtdevre 
         open i-o banka  dizitext
            initialize banka-rec k  txtdevre-rec
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec
            perform varying k from 1 by 1 until k > 100
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform
            
               initialize banka-rec
               if dizitext-det(1) not = spaces then
                   move  dizitext-det(1) to banka-kodu
               end-if
  
               if dizitext-det(2) not = spaces then
                   move  dizitext-det(2) to banka-adi
               end-if
               write banka-rec invalid
                       rewrite banka-rec end-rewrite
               end-write
            end-read
            end-perform
            modify Form1-La-1 , title "BANKA KODLARI ALINDI !"
         close banka txtdevre  dizitext
         .

*
 kasa-txt-al.
         
         move "kasa.txt"  to txtdevre-adi
         move "kasa2.txt" to dizitext-adi

         open output dizitext taksit close dizitext taksit
         open input txtdevre fsozlesme devremulk
         open i-o taksit dizitext
            initialize banka-rec etaksit-devremulk-no sira
            perform until fs-txtdevre = "10"
            initialize txtdevre-rec    
            read txtdevre next no lock
            end 
            not end
            move 1 to sayac
            initialize dizitext-rec   
            perform varying k from 1 by 1 until k > 15
            unstring    txtdevre-rec delimited by x"09"
                 into dizitext-det(k)   pointer sayac
            end-perform
 
               initialize taksit-rec

               if dizitext-det(2) not = spaces or zeroes then

                   initialize fsozlesme-rec
                   move  dizitext-det(2)(1:12) to  fsozlesme-fide-kodu
                   read fsozlesme no lock invalid
                         initialize taksit-sira etaksit-devremulk-no
                         exit perform cycle
                   end-read
                   move fsozlesme-asya-kodu to taksit-devremulk-no

                   if taksit-devremulk-no = 0 or spaces or zeroes then 
                        initialize taksit-sira etaksit-devremulk-no
                        exit perform cycle 
                   end-if

              | stop " "
                    if taksit-devremulk-no not = etaksit-devremulk-no  then
                         move 1 to sira
                    else
                         add  1 to sira
                    end-if
                    move sira to taksit-sira
        
                   else 
                        initialize taksit-sira etaksit-devremulk-no
                        exit perform cycle 
                   end-if

   

               if dizitext-det(3) not = spaces then
                      call "c$justify" using dizitext-det(3) ,"L"
                          unstring dizitext-det(3)   delimited by "/" or "." or "   "
                      into   taksit-tarih-gun  taksit-tarih-ay taksit-tarih-yil   
               end-if
                if dizitext-det(4) not = spaces then
                   if dizitext-det(4) = "GELIR" then
                   move "A" to taksit-hareket-turu 
                   end-if
               end-if
                if dizitext-det(6) not = spaces then
                   if dizitext-det(6) = "SATIS ODEMESI"
                   move  "SO" to taksit-islem-turu 
                   end-if
               end-if
                if dizitext-det(7) not = spaces then
                   inspect dizitext-det(7) replacing  all "." by ","
                   move  function numval(dizitext-det(7)) to taksit-tutar
                 
               end-if
               if dizitext-det(8) not = spaces then
                   evaluate dizitext-det(8) 
                   when "NAKIT"
                           move  "NA" to taksit-odeme-turu 
                   when "KK"
                           move  "KK" to taksit-odeme-turu 
                   when "CEK"
                           move  "CE" to taksit-odeme-turu 
                   WHEN OTHER
                           move  "  " to taksit-odeme-turu    
                   end-evaluate
               end-if
                if dizitext-det(11) not = spaces then
                 evaluate dizitext-det(11) 
                   when "PESINAT ODEMESI"
                           move  "P" to taksit-sekli 
                   when "NORMAL TAKSIT ODEMESI"
                           move  "N" to taksit-sekli 
                   end-evaluate
                  
               end-if
               initialize taksit-odenen 
               if dizitext-det(15) not = spaces then
                     inspect dizitext-det(15) replacing  all "." by ","
                     move  function numval(dizitext-det(15)) to taksit-odenen  
               end-if

               if dizitext-det(12) not = spaces then
                      call "c$justify" using dizitext-det(12) ,"L"
                          unstring dizitext-det(12)   delimited by "/" or "." or "   "
                      into  taksit-odeme-gun  taksit-odeme-ay taksit-odeme-yil   
               end-if

               initialize devremulk-rec
               move taksit-devremulk-no to devremulk-no
               read devremulk no lock invalid 
                       continue
               end-read
               if devremulk-durumu not = "Y" then
                    move 1 to taksit-iptal
               else
                    move 0 to taksit-iptal
               end-if

              | if dizitext-det(14) not = spaces then
              |     move   function numval(dizitext-det(14)(1:1)) to  taksit-iptal
              | end-if

                move  taksit-devremulk-no to etaksit-devremulk-no
              | call "c$sleep" using 0.01
               write taksit-rec invalid
                     display message box taksit-devremulk-no "  sira:" taksit-sira  "fide kod" fsozlesme-fide-kodu
                     stop fsozlesme-fide-kodu
               end-write

             |  display message box taksit-devremulk-no "  sira:" taksit-sira
            end-read
            end-perform
           modify Form1-La-1 , title "TAKSITLER ALINDI !"
         close taksit txtdevre  dizitext fsozlesme  devremulk
         .

*
 cek-fis-al.
        open i-o mgenelfis
        move 1 to mgenelfis-anahtar
        read mgenelfis no lock invalid
             initialize mgenelfis-rec
             add 1 to mcek-oto
             write mgenelfis-rec invalid
                   rewrite mgenelfis-rec end-rewrite
             end-write

        not invalid
             compute mcek-oto = mcek-oto + 1
             rewrite mgenelfis-rec end-rewrite
        end-read
        close mgenelfis
     .
*
 acuserve-adres-aktar.
    move muha-sirketi of genel-rec to CARI-DOSYA-adres         
                         ISLENEN-DOSYA-adres      
                         HESAP-DOSYA-adres        
                         MAHSUP-DOSYA-adres       
                         
                         REFERANS-DOSYA-adres     
                         mgenel-DOSYA-adres       

    move all low-values to      
                           CARI-ACUSERVE-DOSYA       
                           ISLENEN-ACUSERVE-DOSYA    
                           HESAP-ACUSERVE-DOSYA      
                           MAHSUP-ACUSERVE-DOSYA     
                           genelfis-ACUSERVE-DOSYA   
                           REFERANS-ACUSERVE-DOSYA   
                           Mgenel-ACUSERVE-DOSYA     
                           genelfis-ACUSERVE-DOSYA
                           cek-acuserve-dosya
                           ip-no.

    inspect genel-muha-uzak-ip 
            replacing trailing spaces by low-values.

    if genel-muha-uzak-ip <> low-values
       move all low-values to ip-no
       string ip-no,
              "@" delimited by low-values
              genel-muha-uzak-ip delimited by low-values
              ":" delimited by low-values
              into ip-no
    end-if

    string mgenel-acuserve-dosya,
           ip-no                        delimited by low-values
           mgenel-dosya                    delimited by low-values
           into mgenel-acuserve-dosya.


  
    
    string hesap-acuserve-dosya,
           ip-no                        delimited by low-values
           hesap-dosya                 delimited by low-values
           into hesap-acuserve-dosya.
    string mahsup-acuserve-dosya,
           ip-no                        delimited by low-values
           mahsup-dosya                 delimited by low-values
           into mahsup-acuserve-dosya.
    string cari-acuserve-dosya,
           ip-no                        delimited by low-values
           cari-dosya                 delimited by low-values
           into cari-acuserve-dosya.
    string islenen-acuserve-dosya,
           ip-no                        delimited by low-values
           islenen-dosya               delimited by low-values
           into islenen-acuserve-dosya.
    string referans-acuserve-dosya,
           ip-no                        delimited by low-values
           referans-dosya                delimited by low-values
           into referans-acuserve-dosya.
    

    inspect CARI-ACUSERVE-DOSYA        replacing  all spaces by low-values
    inspect ISLENEN-ACUSERVE-DOSYA     replacing  all spaces by low-values
    inspect HESAP-ACUSERVE-DOSYA       replacing  all spaces by low-values
    inspect MAHSUP-ACUSERVE-DOSYA      replacing  all spaces by low-values
    inspect REFERANS-ACUSERVE-DOSYA    replacing  all spaces by low-values
    inspect mgenel-ACUSERVE-DOSYA      replacing  all spaces by low-values
    inspect cek-ACUSERVE-DOSYA         replacing  all spaces by low-values
    . 



 
