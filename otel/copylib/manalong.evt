* manalong.evt
* manalong.evt is generated from D:\asya\acugt.ytl\otel\manalong.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .
***   start event editor code   ***
*
 Form1-Bef-Create.
    perform adresleri-tasi.
    open input genel
    move 1 to genel-anahtar
    read genel no lock invalid continue
         not invalid continue
    end-read
    close genel.


    open input genel2
    move 1 to genel2-anah
    read genel2 no lock invalid continue
         not invalid continue
    end-read
    close genel2.

    move ONKPARA-DOVIZ to butce-cev-doviz .
    move 1 to reel-gecmis
    open input kllnc
    initialize kllnc-rec
    move k-kodu-tasi  to k-kodu
    read kllnc no lock invalid 
         continue 
    end-read 
    close kllnc
    open i-o genelfis     
    move 1 to genelfis-anahtar
    read genelfis no lock
      invalid
        accept print-no from time
      not invalid
        add 1 to print-no
        rewrite genelfis-rec end-rewrite
    end-read
    close genelfis

    move print-no         to rapor-no
 
     .
*              
 Form1-Aft-Initdata.
    move tarih-tasi to ilk-tarih son-tarih.
    move "01" to ilk-ay ilk-gun
    move "N" to rap-tip.
    display acc-01 acc-02 acc-03 acc-04 acc-05 acc-06 .
    perform Form1-Ef-1-Aft-Procedure 
    perform Form1-Ef-2-Aft-Procedure
    move 2 to xx
    move 28 to sut-yer sutun(xx)
    move 1 to reel-gecmis
    perform varying i from 1 by 1 until i > 7
         add 1 to xx      add 7  to sut-yer    move sut-yer to sutun(xx)
         add 1 to xx      add 5  to sut-yer    move sut-yer to sutun(xx)
         add 1 to xx      add 9  to sut-yer    move sut-yer to sutun(xx)
         add 1 to xx      add 7  to sut-yer    move sut-yer to sutun(xx)
         add 1 to xx      add 9  to sut-yer    move sut-yer to sutun(xx)
         add 1 to xx      add 14 to sut-yer    move sut-yer to sutun(xx)
    end-perform.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
    perform dil-ayarla-proc.
*/-----------------------------\*         
*
 Form1-Ex-Other.
    evaluate key-status
       when 33 
            call "/asya/ytl/obj/otel/rezfilt.asy" 
                  using filtre-tasi  
                  on exception 
                     perform callerr-proc
                  not on exception
                     continue
             end-call
             display l-filtre
       when 2
            perform raporla
    end-evaluate
     .
*
 raporla.
    move son-tarih to orjinal-tarih

    open i-o genelfis
    move 1 to genelfis-anahtar
    read genelfis no lock invalid 
         move 1 to ekran-fis-1
    end-read
    
    add 1 to ekran-fis-1
    
    move ekran-fis-1(2:) to  takas7-no takasfiyat-no takas6-no
    rewrite genelfis-rec invalid 
            write genelfis-rec invalid continue
            end-write
    end-rewrite
    close genelfis
    
    open output takas6 close takas6
    open output takas7 close takas7
    open output takasfiyat close takasfiyat
    open i-o takas6 with mass-update
    open i-o takas7 with mass-update
    open i-o takasfiyat

    initialize tum-data-rec alt-toplam-dizi rez-adet
    move son-yil to ilk-yil
    open input isyeri
    open i-o genelfis
    move 1 to genelfis-anahtar
    read genelfis no lock invalid
         accept print-no from time
    not invalid
         add 1 to print-no
         rewrite genelfis-rec end-rewrite
    end-read
    close genelfis
**************************
    initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya
*****      display message box rez-adet " adet rezervasyon tarandi"
    set  dokumer-asya-set to true
    move print-no         to dokumer-dosya-adi
    open output dokumer
*/WINDOW TITLE
    initialize dokumer-rec detay
    move "W"                  to det-dokumer-20(1:)
*    move "YONETIM RAPORU "to det-filler
    move " MANAGEMENT REPORT  "to det-filler
    write dokumer-rec from detay
*/ BASLIKLAR
    initialize dokumer-rec detay
    move "1"          to det-dokumer-20(10:1)
    move "B"                  to det-dokumer-20(1:1)
    move "Otel Yonetim Raporu"   to det-filler
    move "Tarih..:"     to det-filler(41:10)
    move ilk-gun        to det-filler(51:02)
    move "/"            to det-filler(53:01)
    move ilk-ay         to det-filler(54:02)
    move "/"            to det-filler(56:01)
    move ilk-yil        to det-filler(57:04)
    move "-"            to det-filler(61:01)
    move son-gun        to det-filler(62:02)
    move "/"            to det-filler(64:01)
    move son-ay         to det-filler(65:02)
    move "/"            to det-filler(67:01)
    move son-yil        to det-filler(68:04)
    write dokumer-rec from detay

    initialize dokumer-rec detay
    move "1"          to det-dokumer-20(10:1)
    move "B"                  to det-dokumer-20(1:1)
    move "Rapor Tipi..:"          to det-filler(01:15)

    
    
    write dokumer-rec from detay
    if onkpara-referans-var = 1 then 
       initialize dokumer-rec detay
       move "1"            to det-dokumer-20(10:1)
       move "B"            to det-dokumer-20(1:1)
       if oda-ref = 0 then 
          move "TUM KOMPLEX " TO DET-FILLER
       else
          MOVE ref-adi(oda-ref)to det-filler
          move "OTEL "  to det-filler(16:)
          move "KONAKLAMALARI" to det-filler(25:)
       end-if
       if fiyat-ref not = 0 
          MOVE ref-adi(fiyat-ref)to det-filler(40:)
          move "OTEL "  to det-filler(50:)
          move "SATISLARI" to det-filler(58:)
       end-if
       write dokumer-rec from detay
    end-if
    initialize dokumer-rec detay
    move "B"                  to det-dokumer-20(1:)
    write dokumer-rec from detay


*/ DOKUMER OZELLIKLER-REC
    initialize dokumer-rec detay
    move "O" to det-dokumer-20(1:)
    move "E" to dokumer-oto-sayfa-basi
    move 56  to dokumer-oto-sayfa-satir
    move "|" to dokumer-detay-kolon-ayirici
    move "LRRRRRRRRRRRRRRRRRRRRRRRRRR" to dokumer-align-occ
    move "2"  to dokumer-align-occ(50:1)
    move dokumer-ozellikler-rec     to det-filler
    write dokumer-rec from detay
*/ BASLIKLAR  
    initialize gecen-sene
    compute gecen-sene = son-yil - 1
    initialize dokumer-rec detay   
*/******************************************************************************  SATIRALARA BASLA
|| XIIIlucky-rap-satir 1  
    move "D1"         to det-dokumer-20(1:2)
    move "DOLULUK "  to det11-baslik 

    move "Resort"    to det11-rbugun   
    move "Doluluk "  to det11-rbuay    
    move son-yil     to det11-rbuyil   

    move "Resort "   to det11-gecen-rbugun 
    move "Doluluk "  to det11-gecen-rbuay  
    move gecen-sene  to det11-gecen-rbuyil 

    move "Harmony "  to det11-hbugun
    move "Doluluk "  to det11-hbuay 
    move son-yil     to det11-hbuyil

    move "Harmony  " to det11-gecen-hbugun 
    move "Doluluk "  to det11-gecen-hbuay  
    move gecen-sene  to det11-gecen-hbuyil 

    move "Toplam "   to det11-tbugun  
    move "Doluluk "  to det11-tbuay  
    move son-yil     to det11-tbuyil 
                                           
    move "Toplam "   to det11-gecen-tbugun 
    move "Doluluk "  to det11-gecen-tbuay  
    move gecen-sene  to det11-gecen-tbuyil 

    perform fil-bass

    
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 2  
    initialize dokumer-rec detay  
    move "D2"           to det-dokumer-20(1:2)
    move "DOLULUK"  to det11-baslik
    
    move "BuGun"  to det11-rbugun  
    move "BuAy "  to det11-rbuay  
    move "BuYil " to det11-rbuyil 

    move "BuGun"  to det11-gecen-rbugun  
    move "BuAy "  to det11-gecen-rbuay  
    move "BuYil " to det11-gecen-rbuyil 

    move "BuGun"  to det11-hbugun  
    move "BuAy "  to det11-hbuay  
    move "BuYil " to det11-hbuyil 

    move "BuGun"  to det11-gecen-hbugun 
    move "BuAy "  to det11-gecen-hbuay  
    move "BuYil " to det11-gecen-hbuyil 

    move "BuGun"  to det11-tbugun  
    move "BuAy "  to det11-tbuay  
    move "BuYil " to det11-tbuyil 

    move "BuGun"  to det11-gecen-tbugun 
    move "BuAy "  to det11-gecen-tbuay  
    move "BuYil " to det11-gecen-tbuyil 
    
    perform fil-bass

    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

    initialize dokumer-rec detay
    move "D3"           to det-dokumer-20(1:2)
    move "-"            to det-dokumer-20(5:1)
    
    move all "-" to det-1(01:223)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 3  
    move 3 to tmp-satir
    initialize det-11-rec tmp-rec 
    initialize dokumer-rec detay
    perform fil-bass

    perform satisa-hazir-oda-bul
    perform tmp-aktar
    perform tmp-to-z 
 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 4  
    add 1 to tmp-satir
    initialize det-11-rec tmp-anah(tmp-satir)
    initialize dokumer-rec detay
    perform fil-bass
    move 0 to sira-comp
    perform satilan-bul
    perform tmp-aktar
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 5 
    add 1 to tmp-satir
    initialize det-11-rec tmp-anah(tmp-satir)
    initialize dokumer-rec detay
    perform fil-bass
    move 1 to sira-comp
    perform satilan-bul 
    perform tmp-aktar
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 6 
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Toplam Oda"  to det11-baslik
    perform toplam-oda-topla
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 7  
    add 1 to tmp-satir
    initialize det-11-rec tmp-anah(tmp-satir)
    initialize dokumer-rec detay
    perform fil-bass
    perform oda-doluluk-yuzde 
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 525          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 8  
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Satisa Hazir Yatak"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 9  
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "S.Yatak (Yetiskin)"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 10  
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "S.Yatak (Ucretli Coc.)"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 11  
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "S.Yatak (Ucretsiz Coc.)"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 12  
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Complimentary(Yetiskin)"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 13  
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Complimentary(U.Coc.)"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 14  
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Complimentary(U.siz Coc.)"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 15
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    compute tmp-satir = tmp-satir + 1   
    perform yatak-doluluk-yuzde 
    compute tmp-satir = tmp-satir - 1   
    initialize det-11-rec 
    move "TOPLAM GECELEME"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec    to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 16  
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Yatak Doluluk %"  to det11-baslik
    perform yatak-doluluk-yuzde 
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 525          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 17 
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Toplam Ucretli Geceleme"  to det11-baslik
    perform toplam-geceleme-hesapla
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 18  
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Doviz Kuru (Euro)"  to det11-baslik
    perform doviz-kuru-dagit
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 19  
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass    
    move "GELIR (EURO)"  to det11-baslik

    move son-yil     to det11-rbugun   
    move son-yil     to det11-rbuay    
    move son-yil     to det11-rbuyil   

    move gecen-sene  to det11-gecen-rbugun 
    move gecen-sene  to det11-gecen-rbuay  
    move gecen-sene  to det11-gecen-rbuyil 

    move son-yil     to det11-hbugun
    move son-yil     to det11-hbuay 
    move son-yil     to det11-hbuyil

    move gecen-sene  to det11-gecen-hbugun 
    move gecen-sene  to det11-gecen-hbuay  
    move gecen-sene  to det11-gecen-hbuyil 

    move son-yil     to det11-tbugun  
    move son-yil     to det11-tbuay  
    move son-yil     to det11-tbuyil 
                                           
    move gecen-sene  to det11-gecen-tbugun 
    move gecen-sene  to det11-gecen-tbuay  
    move gecen-sene  to det11-gecen-tbuyil 

    move det-11-rec    to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 20  
    add 1 to tmp-satir
    initialize dokumer-rec detay det-11-rec    

    move "Depatman/Kisi Basi"  to det11-baslik 

    move "Resort"    to det11-rbugun   
    move son-yil     to det11-rbuay    
    move "Resort"    to det11-rbuyil   

    move "Resort"    to det11-gecen-rbugun 
    move gecen-sene  to det11-gecen-rbuay  
    move "Resort"    to det11-gecen-rbuyil 

    move "Harmony"   to det11-hbugun
    move son-yil     to det11-hbuay 
    move "Harmony"   to det11-hbuyil

    move "Harmony"   to det11-gecen-hbugun 
    move gecen-sene  to det11-gecen-hbuay  
    move "Harmony"   to det11-gecen-hbuyil 

    move "Konsolide" to det11-tbugun  
    move son-yil     to det11-tbuay  
    move "Konsolide" to det11-tbuyil 
                                           
    move "Konsolide" to det11-gecen-tbugun 
    move gecen-sene  to det11-gecen-tbuay  
    move "Konsolide" to det11-gecen-tbuyil 

    perform fil-bass

    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 21  
    add 1 to tmp-satir
    initialize dokumer-rec detay det-11-rec 
    move "Depatman/Kisi Basi"  to det11-baslik
    
    move "BuGun"  to det11-rbugun  
    move "BuAy "  to det11-rbuay  
    move "BuYil " to det11-rbuyil 

    move "BuGun"  to det11-gecen-rbugun  
    move "BuAy "  to det11-gecen-rbuay  
    move "BuYil " to det11-gecen-rbuyil 

    move "BuGun"  to det11-hbugun  
    move "BuAy "  to det11-hbuay  
    move "BuYil " to det11-hbuyil 

    move "BuGun"  to det11-gecen-hbugun 
    move "BuAy "  to det11-gecen-hbuay  
    move "BuYil " to det11-gecen-hbuyil 

    move "BuGun"  to det11-tbugun  
    move "BuAy "  to det11-tbuay  
    move "BuYil " to det11-tbuyil 

    move "BuGun"  to det11-gecen-tbugun 
    move "BuAy "  to det11-gecen-tbuay  
    move "BuYil " to det11-gecen-tbuyil 
    
    perform fil-bass

    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay
*/******************************************************************************
|| XIIIlucky-rap-satir 22  
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    perform onkasar-gez
    move "Oda Pansiyon"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 23
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Extra Yiyecek"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 24
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Extra Icecek" to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 25
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Diger Extra Gelirler" to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 26
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "TOPLAM"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 525          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 27
    add 1 to tmp-satir
    initialize dokumer-rec detay det-11-rec    

    move "Depatman/Euro"  to det11-baslik 

    move "Resort"    to det11-rbugun   
    move son-yil     to det11-rbuay    
    move "Resort"    to det11-rbuyil   

    move "Resort"    to det11-gecen-rbugun 
    move gecen-sene  to det11-gecen-rbuay  
    move "Resort"    to det11-gecen-rbuyil 

    move "Harmony"   to det11-hbugun
    move son-yil     to det11-hbuay 
    move "Harmony"   to det11-hbuyil

    move "Harmony"   to det11-gecen-hbugun 
    move gecen-sene  to det11-gecen-hbuay  
    move "Harmony"   to det11-gecen-hbuyil 

    move "Konsolide" to det11-tbugun  
    move son-yil     to det11-tbuay  
    move "Konsolide" to det11-tbuyil 
                                           
    move "Konsolide" to det11-gecen-tbugun 
    move gecen-sene  to det11-gecen-tbuay  
    move "Konsolide" to det11-gecen-tbuyil 

    perform fil-bass

    
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 28
    add 1 to tmp-satir
    initialize dokumer-rec detay det-11-rec 
    move "Depatman/ Euro"  to det11-baslik
    
    move "BuGun"  to det11-rbugun  
    move "BuAy "  to det11-rbuay  
    move "BuYil " to det11-rbuyil 

    move "BuGun"  to det11-gecen-rbugun  
    move "BuAy "  to det11-gecen-rbuay  
    move "BuYil " to det11-gecen-rbuyil 

    move "BuGun"  to det11-hbugun  
    move "BuAy "  to det11-hbuay  
    move "BuYil " to det11-hbuyil 

    move "BuGun"  to det11-gecen-hbugun 
    move "BuAy "  to det11-gecen-hbuay  
    move "BuYil " to det11-gecen-hbuyil 

    move "BuGun"  to det11-tbugun  
    move "BuAy "  to det11-tbuay  
    move "BuYil " to det11-tbuyil 

    move "BuGun"  to det11-gecen-tbugun 
    move "BuAy "  to det11-gecen-tbuay  
    move "BuYil " to det11-gecen-tbuyil 
    
    perform fil-bass

    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay
*/******************************************************************************
|| XIIIlucky-rap-satir 29
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Oda Pansiyon"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 30
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "No-Show Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 31
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Deniz Farki Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 32
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Oda Upgrade Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 33
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Late C-out Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 34
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Extra Yiyecek"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 35
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Extra Icecek"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 36
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Day Use Kullanimi"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 37
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Camasirhane"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 38
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Gazebo"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 39
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Hasar Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 40
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Stroller Kullanim"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 41
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass    
    move "Bagaj Kaplama Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 42
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Aktivite ve Diger Gelirler"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 43
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "TOPLAM"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 525          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 44
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass    
    move "KISI DAGILIMI"  to det11-baslik  
    perform det-cizgi-at 
    move det-11-rec    to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 45
    add 1 to tmp-satir
    initialize dokumer-rec detay det-11-rec    

    move "Gun"       to det11-baslik 

    move "Resort"    to det11-rbugun   
    move "Kisi  "    to det11-rbuay    
    move son-yil     to det11-rbuyil   

    move "Resort "   to det11-gecen-rbugun 
    move "Kisi  "    to det11-gecen-rbuay  
    move son-yil  to det11-gecen-rbuyil 

    move "Harmony "  to det11-hbugun
    move "Kisi  "    to det11-hbuay 
    move son-yil     to det11-hbuyil

    move "Harmony  " to det11-gecen-hbugun 
    move "Kisi  "    to det11-gecen-hbuay  
    move son-yil  to det11-gecen-hbuyil 

    move "Toplam "   to det11-tbugun  
    move "Kisi  "    to det11-tbuay  
    move son-yil     to det11-tbuyil 
                                           
    move "Toplam "   to det11-gecen-tbugun 
    move "Kisi  "    to det11-gecen-tbuay  
    move son-yil  to det11-gecen-tbuyil 

    perform fil-bass

    
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 46
    add 1 to tmp-satir
    initialize dokumer-rec detay det-11-rec    

    move "Gun"       to det11-baslik 

    move "Gunluk"    to det11-rbugun   
    move "(%)"       to det11-rbuay    
    move "Aylik"     to det11-rbuyil   

    move "(%)"       to det11-gecen-rbugun 
    move "Yillik"    to det11-gecen-rbuay  
    move "(%)"       to det11-gecen-rbuyil 

    move "Gunluk"    to det11-hbugun
    move "(%)"       to det11-hbuay 
    move "Aylik"     to det11-hbuyil

    move "(%)"       to det11-gecen-hbugun 
    move "Yillik"    to det11-gecen-hbuay  
    move "(%)"       to det11-gecen-hbuyil 

    move "Gunluk"    to det11-tbugun  
    move "(%)"       to det11-tbuay  
    move "Aylik"     to det11-tbuyil 
                                           
    move "(%)"       to det11-gecen-tbugun 
    move "Aylik"     to det11-gecen-tbuay  
    move "(%)"       to det11-gecen-tbuyil 

    perform fil-bass

    
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 47
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass 
    perform kisi-dagit-dayicim
    move "Single"      to det11-baslik
    perform tmp-to-z 
    move det-11-rec    to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 48
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass    
    move "Double"      to det11-baslik
    perform tmp-to-z 
    move det-11-rec    to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 49
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass    
    move "Triple"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec    to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 50 
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass    
    move "Toplam Oda"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec    to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 51
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass    
    move "Toplam Pax"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec    to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 52
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass    
    move "Double Occ." to det11-baslik
    perform tmp-to-z 
    move det-11-rec    to det-1
    move "A"          to det-dokumer-20(3:1)
    move 525          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 53
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass    
    move "FORECAST"  to det11-baslik 
    perform det-cizgi-at 
    move det-11-rec    to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 54
    add 1 to tmp-satir
    initialize dokumer-rec detay det-11-rec    

    move "Gun"       to det11-baslik 

    move "Resort"    to det11-rbugun   
    move "Oda  "    to det11-rbuay    
    move son-yil     to det11-rbuyil   

    move "Resort "   to det11-gecen-rbugun 
    move "Oda   "    to det11-gecen-rbuay  
    move son-yil  to det11-gecen-rbuyil 

    move "Harmony "  to det11-hbugun
    move "Oda   "    to det11-hbuay 
    move son-yil     to det11-hbuyil

    move "Harmony  " to det11-gecen-hbugun 
    move "Oda   "    to det11-gecen-hbuay  
    move son-yil  to det11-gecen-hbuyil 

    move "Toplam "   to det11-tbugun  
    move "Oda   "    to det11-tbuay  
    move son-yil     to det11-tbuyil 
                                           
    move "Toplam "   to det11-gecen-tbugun 
    move "Oda   "    to det11-gecen-tbuay  
    move son-yil  to det11-gecen-tbuyil 

    perform fil-bass

    
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 55
    add 1 to tmp-satir
    initialize dokumer-rec detay det-11-rec 
    move "Gun"     to det11-baslik
    
    move "Oda"      to det11-rbugun  
    move "Pax"      to det11-rbuay  
    move "Child"    to det11-rbuyil 

    move "Free C."  to det11-gecen-rbugun  
    move "Toplam"   to det11-gecen-rbuay  
    move "%"        to det11-gecen-rbuyil 
                   
    move "Oda"      to det11-hbugun  
    move "Pax"      to det11-hbuay  
    move "Child"    to det11-hbuyil 

    move "Free C."  to det11-gecen-hbugun 
    move "Toplam"   to det11-gecen-hbuay  
    move "%"        to det11-gecen-hbuyil 

    move "Oda"      to det11-tbugun  
    move "Pax"      to det11-tbuay  
    move "Child"    to det11-tbuyil 

    move "Free C."  to det11-gecen-tbugun 
    move "Toplam"   to det11-gecen-tbuay  
    move "%"        to det11-gecen-tbuyil 
    
    perform fil-bass

    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 56-57-58-59-60-61-62
    open i-o takvim cast konum rez kodlar02 odalar konuk
    initialize takvim-rec for-i deg-i
    move 1         to deg-i
    move son-tarih to takvim-anah
    start takvim key not < takvim-anah invalid
          continue
    not invalid
    perform with test after until fs-takvim > "10"
    read takvim next no lock end move "10" to fs-takvim
    not at end 
        if deg-i = 1 
           move 13 to deg-i
           exit perform cycle
        end-if
        add 1 to for-i
        compute for-ii = for-i + 55
        if for-i > 7 
           exit perform 
        end-if
        move takvim-anah to xtar
        add 1 to tmp-satir
        initialize det-11-rec  
        initialize dokumer-rec detay
        perform fil-bass
        move xgun      to det11-baslik(1:)
        move "/"       to det11-baslik(3:)
        move xay       to det11-baslik(4:)
        move "/"       to det11-baslik(6:)
        move xyil      to det11-baslik(7:)
        initialize takas3-rec   
        move 1 to oda-ref fiyat-ref
        perform cast-oku
        initialize takas3-rec   
        move 2 to oda-ref fiyat-ref
        perform cast-oku
        initialize oda-ref fiyat-ref
        perform tmp-to-z 
        move det-11-rec  to det-1                                   
        write dokumer-rec from detay

    end-read
    end-perform 
    end-start
    close takvim cast konum rez kodlar02 odalar konuk

*/******************************************************************************
|| XIIIlucky-rap-satir 63
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass    
    move "ON KASA BALANS/MAIN CURANTE"  to det11-baslik
    perform det-cizgi-at 
    move det-11-rec    to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 64
    add 1 to tmp-satir
    initialize dokumer-rec detay det-11-rec    

    move "Departman"  to det11-baslik 

    move "Resort"    to det11-rbugun   
    move "Bal/Main"    to det11-rbuay    
    move son-yil     to det11-rbuyil   

    move "Resort"    to det11-gecen-rbugun 
    move "Bal/Main"    to det11-gecen-rbuay  
    move gecen-sene  to det11-gecen-rbuyil 

    move "Harmony"   to det11-hbugun
    move "Bal/Main"    to det11-hbuay 
    move son-yil     to det11-hbuyil

    move "Harmony  " to det11-gecen-hbugun 
    move "Bal/Main"    to det11-gecen-hbuay  
    move gecen-sene  to det11-gecen-hbuyil 

    move "Toplam "   to det11-tbugun  
    move "Bal/Main"    to det11-tbuay  
    move son-yil     to det11-tbuyil 
                                           
    move "Toplam "   to det11-gecen-tbugun 
    move "Bal/Main"    to det11-gecen-tbuay  
    move gecen-sene  to det11-gecen-tbuyil 

    perform fil-bass

    move det-11-rec  to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 65
    add 1 to tmp-satir
    initialize dokumer-rec detay det-11-rec 
    move "Departman"  to det11-baslik
    
    move "BuGun"  to det11-rbugun  
    move "BuAy "  to det11-rbuay  
    move "BuYil " to det11-rbuyil 

    move "BuGun"  to det11-gecen-rbugun  
    move "BuAy "  to det11-gecen-rbuay  
    move "BuYil " to det11-gecen-rbuyil 

    move "BuGun"  to det11-hbugun  
    move "BuAy "  to det11-hbuay  
    move "BuYil " to det11-hbuyil 

    move "BuGun"  to det11-gecen-hbugun 
    move "BuAy "  to det11-gecen-hbuay  
    move "BuYil " to det11-gecen-hbuyil 

    move "BuGun"  to det11-tbugun  
    move "BuAy "  to det11-tbuay  
    move "BuYil " to det11-tbuyil 

    move "BuGun"  to det11-gecen-tbugun 
    move "BuAy "  to det11-gecen-tbuay  
    move "BuYil " to det11-gecen-tbuyil 
    
    perform fil-bass

    move det-11-rec   to det-1
    move "A"          to det-dokumer-20(3:1)
    move 257          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 66
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Oda Pansiyon"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec      to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 67
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "No-Show Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 68
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Deniz Farki Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 69
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Oda Upgrade Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 70
    add 1 to tmp-satir
    initialize det-11-rec 
    initialize dokumer-rec detay
    perform fil-bass
    move "Late C-out Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 71
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Extra Yiyecek"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 72
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Extra Icecek"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 73
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Day Use Kullanimi"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 74
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Camasirhane"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 75
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Gazebo"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 76
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Hasar Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 77
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Stroller Kullanim"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 78
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass    
    move "Bagaj Kaplama Geliri"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 79
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Aktivite ve Diger Gelirler"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 80
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass  
    perform balans-toplam-al
    move "TOPLAM"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 81 
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay                                 
    perform fil-bass
    move "GELIRLER TOPLAMI"  to det11-baslik
    subtract 1 from tmp-satir
    perform tmp-to-z 
    add 1 to tmp-satir
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 525          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 82  
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Kdv (% 8)"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 83 
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Kdv (% 18)"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 84
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    perform toplam-gel-hesapla
    move "TOPLAM GELIR"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 525          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 85
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    perform dun-dev-hes
    move "DUNDEN DEVIR"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 86 
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    perform genel-top-hes
    move "GENEL TOPLAM"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 525          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 87
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Nakit Tahsilat"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 88
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Kredi Kartlari"  to det11-baslik
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 89
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "City Ledger"  to det11-baslik                 
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 90
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Guest Refund - Paid Out"  to det11-baslik      
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 91
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    move "Discount- Correction"  to det11-baslik                 
    perform tmp-to-z 
    move det-11-rec to det-1
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 92
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    perform toplam-tah-hes
    move "TOPLAM TAHSILAT"  to det11-baslik                 
    perform tmp-to-z 
    move det-11-rec to det-1
    move "A"          to det-dokumer-20(3:1)
    move 525          to det-renk1
    move "1"          to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
|| XIIIlucky-rap-satir 93
    add 1 to tmp-satir
    initialize det-11-rec  
    initialize dokumer-rec detay
    perform fil-bass
    perform maincur-hes
    move "MAIN CURANTE"  to det11-baslik                 
    perform tmp-to-z 
    move det-11-rec to det-1
    move "A"           to det-dokumer-20(3:1)
    move 432           to det-renk1
    move "1"           to det-dokumer-20(10:1)
    write dokumer-rec from detay

*/******************************************************************************
*    initialize dokumer-rec detay
*    move "A"          to det-dokumer-20(3:1)
*    move 481          to det-1(200:3)
*    move "1"          to det-dokumer-20(10:1)
*    inspect det-1(12:) replacing all space by high-values
*    write dokumer-rec from detay
    initialize dokumer-rec detay
    move "-"            to det-dokumer-20(5:1)
    move all "-"   to det-1(1:223),
    write dokumer-rec from detay

    close isyeri dokumer takas6 takas7 takasfiyat
    
    
    call dokumer-prog on exception
         perform callerr-proc
    not on exception
         cancel dokumer-prog
    end-call
    delete file dokumer takas7 takas6 takasfiyat.
*
 toplam-geceleme-hesapla. |17
     compute tmp-rs-gun(tmp-satir) rounded = 
             tmp-rs-gun(tmp-satir - 8)  + (tmp-rs-gun(tmp-satir - 7)  / 2) + 
             tmp-rs-gun(tmp-satir - 5) + (tmp-rs-gun(tmp-satir - 4) / 2) 

     compute tmp-rs-ay(tmp-satir)  rounded = 
             tmp-rs-ay(tmp-satir - 8)  + (tmp-rs-ay(tmp-satir - 7)  / 2) + 
             tmp-rs-ay(tmp-satir - 5) + (tmp-rs-ay(tmp-satir - 4) / 2)   

     compute tmp-rs-yil(tmp-satir) rounded = 
             tmp-rs-yil(tmp-satir - 8)  + (tmp-rs-yil(tmp-satir - 7)  / 2) + 
             tmp-rs-yil(tmp-satir - 5) + (tmp-rs-yil(tmp-satir - 4) / 2) 

     compute tmp-hs-gun(tmp-satir) rounded = 
             tmp-hs-gun(tmp-satir - 8)  + (tmp-hs-gun(tmp-satir - 7)  / 2) + 
             tmp-hs-gun(tmp-satir - 5) + (tmp-hs-gun(tmp-satir - 4) / 2) 

     compute tmp-hs-ay(tmp-satir)  rounded = 
             tmp-hs-ay(tmp-satir - 8)  + (tmp-hs-ay(tmp-satir - 7)  / 2) + 
             tmp-hs-ay(tmp-satir - 5) + (tmp-hs-ay(tmp-satir - 4) / 2) 

     compute tmp-hs-yil(tmp-satir) rounded = 
             tmp-hs-yil(tmp-satir - 8)  + (tmp-hs-yil(tmp-satir - 7)  / 2) + 
             tmp-hs-yil(tmp-satir - 5) + (tmp-hs-yil(tmp-satir - 4) / 2) 

     compute tmp-ts-gun(tmp-satir) rounded = 
             tmp-ts-gun(tmp-satir - 8)  + (tmp-ts-gun(tmp-satir - 7)  / 2) + 
             tmp-ts-gun(tmp-satir - 5) + (tmp-ts-gun(tmp-satir - 4) / 2) 

     compute tmp-ts-ay(tmp-satir)  rounded = 
             tmp-ts-ay(tmp-satir - 8)  + (tmp-ts-ay(tmp-satir - 7)  / 2) + 
             tmp-ts-ay(tmp-satir - 5) + (tmp-ts-ay(tmp-satir - 4) / 2) 

     compute tmp-ts-yil(tmp-satir) rounded = 
             tmp-ts-yil(tmp-satir - 8)  + (tmp-ts-yil(tmp-satir - 7)  / 2) + 
             tmp-ts-yil(tmp-satir - 5) + (tmp-ts-yil(tmp-satir - 4) / 2) 

     compute tmp-rg-gun(tmp-satir) rounded = 
             tmp-rg-gun(tmp-satir - 8)  + (tmp-rg-gun(tmp-satir - 7)  / 2) + 
             tmp-rg-gun(tmp-satir - 5) + (tmp-rg-gun(tmp-satir - 4) / 2)

     compute tmp-rg-ay(tmp-satir)  rounded =
             tmp-rg-ay(tmp-satir - 8)  + (tmp-rg-ay(tmp-satir - 7)  / 2) + 
             tmp-rg-ay(tmp-satir - 5) + (tmp-rg-ay(tmp-satir - 4) / 2) 

     compute tmp-rg-yil(tmp-satir) rounded = 
             tmp-rg-yil(tmp-satir - 8)  + (tmp-rg-yil(tmp-satir - 7) / 2) + 
             tmp-rg-yil(tmp-satir - 5) + (tmp-rg-yil(tmp-satir - 4) / 2) 

     compute tmp-hg-gun(tmp-satir) rounded = 
             tmp-hg-gun(tmp-satir - 8)  + (tmp-hg-gun(tmp-satir - 7)  / 2) + 
             tmp-hg-gun(tmp-satir - 5) + (tmp-hg-gun(tmp-satir - 4) / 2) 

     compute tmp-hg-ay(tmp-satir)  rounded = 
             tmp-hg-ay(tmp-satir - 8)  + (tmp-hg-ay(tmp-satir - 7)  / 2) + 
             tmp-hg-ay(tmp-satir - 5) + (tmp-hg-ay(tmp-satir - 4) / 2) 

     compute tmp-hg-yil(tmp-satir) rounded = 
             tmp-hg-yil(tmp-satir - 8)  + (tmp-hg-yil(tmp-satir - 7)  / 2) + 
             tmp-hg-yil(tmp-satir - 5) + (tmp-hg-yil(tmp-satir - 4) / 2) 

     compute tmp-tg-gun(tmp-satir) rounded = 
             tmp-tg-gun(tmp-satir - 8)  + (tmp-tg-gun(tmp-satir - 7)  / 2) + 
             tmp-tg-gun(tmp-satir - 5) + (tmp-tg-gun(tmp-satir - 4) / 2) 

     compute tmp-tg-ay(tmp-satir)  rounded = 
             tmp-tg-ay(tmp-satir - 8)  + (tmp-tg-ay(tmp-satir - 7)  / 2) + 
             tmp-tg-ay(tmp-satir - 5) + (tmp-tg-ay(tmp-satir - 4) / 2) 

     compute tmp-tg-yil(tmp-satir) rounded = 
             tmp-tg-yil(tmp-satir - 8)  + (tmp-tg-yil(tmp-satir - 7)  / 2) + 
             tmp-tg-yil(tmp-satir - 5) + (tmp-tg-yil(tmp-satir - 4) / 2) 
     .

*
 balans-toplam-al.
    perform varying xii from 66 by 1 until xii > 79

         add tmp-rs-gun(xii) to tmp-rs-gun(81)
                                tmp-rs-gun(80)
         add tmp-rs-ay(xii)  to tmp-rs-ay(81)
                                tmp-rs-ay(80)
         add tmp-rs-yil(xii) to tmp-rs-yil(81)
                                tmp-rs-yil(80)
         add tmp-hs-gun(xii) to tmp-hs-gun(81)
                                tmp-hs-gun(80)
         add tmp-hs-ay(xii)  to tmp-hs-ay(81)
                                tmp-hs-ay(80)
         add tmp-hs-yil(xii) to tmp-hs-yil(81)
                                tmp-hs-yil(80)
         add tmp-ts-gun(xii) to tmp-ts-gun(81)
                                tmp-ts-gun(80)
         add tmp-ts-ay(xii)  to tmp-ts-ay(81)
                                tmp-ts-ay(80)
         add tmp-ts-yil(xii) to tmp-ts-yil(81)
                                tmp-ts-yil(80)

         add tmp-rg-gun(xii) to tmp-rg-gun(81)
                                tmp-rg-gun(80)
         add tmp-rg-ay(xii)  to tmp-rg-ay(81)
                                tmp-rg-ay(80)
         add tmp-rg-yil(xii) to tmp-rg-yil(81)
                                tmp-rg-yil(80)
         add tmp-hg-gun(xii) to tmp-hg-gun(81)
                                tmp-hg-gun(80)
         add tmp-hg-ay(xii)  to tmp-hg-ay(81)
                                tmp-hg-ay(80)
         add tmp-hg-yil(xii) to tmp-hg-yil(81)
                                tmp-hg-yil(80)
         add tmp-tg-gun(xii) to tmp-tg-gun(81)
                                tmp-tg-gun(80)
         add tmp-tg-ay(xii)  to tmp-tg-ay(81)
                                tmp-tg-ay(80)
         add tmp-tg-yil(xii) to tmp-tg-yil(81)
                                tmp-tg-yil(80)

    end-perform 
    .
*
 toplam-gel-hesapla.
    perform varying xii from 81 by 1 until xii > 83

         add tmp-rs-gun(xii) to tmp-rs-gun(tmp-satir)
         add tmp-rs-ay(xii)  to tmp-rs-ay(tmp-satir)
         add tmp-rs-yil(xii) to tmp-rs-yil(tmp-satir)
         add tmp-hs-gun(xii) to tmp-hs-gun(tmp-satir)
         add tmp-hs-ay(xii)  to tmp-hs-ay(tmp-satir)
         add tmp-hs-yil(xii) to tmp-hs-yil(tmp-satir)
         add tmp-ts-gun(xii) to tmp-ts-gun(tmp-satir)
         add tmp-ts-ay(xii)  to tmp-ts-ay(tmp-satir)
         add tmp-ts-yil(xii) to tmp-ts-yil(tmp-satir)

         add tmp-rg-gun(xii) to tmp-rg-gun(tmp-satir)
         add tmp-rg-ay(xii)  to tmp-rg-ay(tmp-satir)
         add tmp-rg-yil(xii) to tmp-rg-yil(tmp-satir)
         add tmp-hg-gun(xii) to tmp-hg-gun(tmp-satir)
         add tmp-hg-ay(xii)  to tmp-hg-ay(tmp-satir)
         add tmp-hg-yil(xii) to tmp-hg-yil(tmp-satir)
         add tmp-tg-gun(xii) to tmp-tg-gun(tmp-satir)
         add tmp-tg-ay(xii)  to tmp-tg-ay(tmp-satir)
         add tmp-tg-yil(xii) to tmp-tg-yil(tmp-satir)

    end-perform 
    .
*
 dun-dev-hes.
    move son-tarih  to xtar ytar ztar ttar
    move gecen-sene to xyil yyil
    move orj-yil    to zyil tyil
    move 1          to xgun xay zgun zay
    open input onkasar takvim
*******************************************************Bugun Buyl
    initialize onkasar-rec  
    move 1     to onkasar-ref
    move ttar  to onkasar-tarih
    move "888" to onkasar-dep
    read onkasar no lock invalid
         continue
    end-read 
    add onkasar-tutar-tl to tmp-rs-gun(tmp-satir) tmp-ts-gun(tmp-satir)

    move 2               to onkasar-ref 
    read onkasar no lock invalid
         continue
    end-read 
    add onkasar-tutar-tl to tmp-hs-gun(tmp-satir) tmp-ts-gun(tmp-satir)

    move 1 to onkr-gun
    read onkasar no lock invalid
         continue
    end-read 
    add onkasar-tutar-tl to tmp-hs-ay(tmp-satir) tmp-ts-ay(tmp-satir)

    move 1 to onkasar-ref 
    read onkasar no lock invalid
         continue
    end-read 
    add onkasar-tutar-tl to tmp-rs-ay(tmp-satir) tmp-ts-ay(tmp-satir)
    close onkasar takvim
    .
*
 genel-top-hes.
    compute tmp-rs-gun(tmp-satir) = tmp-rs-gun(tmp-satir - 1) + tmp-rs-gun(tmp-satir - 2)
    compute tmp-rs-ay(tmp-satir)  = tmp-rs-ay(tmp-satir - 1)  + tmp-rs-ay(tmp-satir - 2)
    compute tmp-rs-yil(tmp-satir) = tmp-rs-yil(tmp-satir - 1) + tmp-rs-yil(tmp-satir - 2)
    compute tmp-hs-gun(tmp-satir) = tmp-hs-gun(tmp-satir - 1) + tmp-hs-gun(tmp-satir - 2)
    compute tmp-hs-ay(tmp-satir)  = tmp-hs-ay(tmp-satir - 1)  + tmp-hs-ay(tmp-satir - 2)
    compute tmp-hs-yil(tmp-satir) = tmp-hs-yil(tmp-satir - 1) + tmp-hs-yil(tmp-satir - 2)
    compute tmp-ts-gun(tmp-satir) = tmp-ts-gun(tmp-satir - 1) + tmp-ts-gun(tmp-satir - 2)
    compute tmp-ts-ay(tmp-satir)  = tmp-ts-ay(tmp-satir - 1)  + tmp-ts-ay(tmp-satir - 2)
    compute tmp-ts-yil(tmp-satir) = tmp-ts-yil(tmp-satir - 1) + tmp-ts-yil(tmp-satir - 2)

    compute tmp-rg-gun(tmp-satir) = tmp-rg-gun(tmp-satir - 1) + tmp-rg-gun(tmp-satir - 2)
    compute tmp-rg-ay(tmp-satir)  = tmp-rg-ay(tmp-satir - 1)  + tmp-rg-ay(tmp-satir - 2) 
    compute tmp-rg-yil(tmp-satir) = tmp-rg-yil(tmp-satir - 1) + tmp-rg-yil(tmp-satir - 2)
    compute tmp-hg-gun(tmp-satir) = tmp-hg-gun(tmp-satir - 1) + tmp-hg-gun(tmp-satir - 2)
    compute tmp-hg-ay(tmp-satir)  = tmp-hg-ay(tmp-satir - 1)  + tmp-hg-ay(tmp-satir - 2) 
    compute tmp-hg-yil(tmp-satir) = tmp-hg-yil(tmp-satir - 1) + tmp-hg-yil(tmp-satir - 2)
    compute tmp-tg-gun(tmp-satir) = tmp-tg-gun(tmp-satir - 1) + tmp-tg-gun(tmp-satir - 2)
    compute tmp-tg-ay(tmp-satir)  = tmp-tg-ay(tmp-satir - 1)  + tmp-tg-ay(tmp-satir - 2) 
    compute tmp-tg-yil(tmp-satir) = tmp-tg-yil(tmp-satir - 1) + tmp-tg-yil(tmp-satir - 2)
    .
*
 toplam-tah-hes.
    compute tmp-rs-gun(tmp-satir) = tmp-rs-gun(tmp-satir - 5) + tmp-rs-gun(tmp-satir - 4) + tmp-rs-gun(tmp-satir - 3)
    compute tmp-rs-ay(tmp-satir)  = tmp-rs-ay(tmp-satir - 5)  + tmp-rs-ay(tmp-satir - 4)  + tmp-rs-ay(tmp-satir - 3) 
    compute tmp-rs-yil(tmp-satir) = tmp-rs-yil(tmp-satir - 5) + tmp-rs-yil(tmp-satir - 4) + tmp-rs-yil(tmp-satir - 3)
    compute tmp-hs-gun(tmp-satir) = tmp-hs-gun(tmp-satir - 5) + tmp-hs-gun(tmp-satir - 4) + tmp-hs-gun(tmp-satir - 3)
    compute tmp-hs-ay(tmp-satir)  = tmp-hs-ay(tmp-satir - 5)  + tmp-hs-ay(tmp-satir - 4)  + tmp-hs-ay(tmp-satir - 3) 
    compute tmp-hs-yil(tmp-satir) = tmp-hs-yil(tmp-satir - 5) + tmp-hs-yil(tmp-satir - 4) + tmp-hs-yil(tmp-satir - 3)
    compute tmp-ts-gun(tmp-satir) = tmp-ts-gun(tmp-satir - 5) + tmp-ts-gun(tmp-satir - 4) + tmp-ts-gun(tmp-satir - 3)
    compute tmp-ts-ay(tmp-satir)  = tmp-ts-ay(tmp-satir - 5)  + tmp-ts-ay(tmp-satir - 4)  + tmp-ts-ay(tmp-satir - 3) 
    compute tmp-ts-yil(tmp-satir) = tmp-ts-yil(tmp-satir - 5) + tmp-ts-yil(tmp-satir - 4) + tmp-ts-yil(tmp-satir - 3)
                                                                                                                     
    compute tmp-rg-gun(tmp-satir) = tmp-rg-gun(tmp-satir - 5) + tmp-rg-gun(tmp-satir - 4) + tmp-rg-gun(tmp-satir - 3)
    compute tmp-rg-ay(tmp-satir)  = tmp-rg-ay(tmp-satir - 5)  + tmp-rg-ay(tmp-satir - 4)  + tmp-rg-ay(tmp-satir - 3) 
    compute tmp-rg-yil(tmp-satir) = tmp-rg-yil(tmp-satir - 5) + tmp-rg-yil(tmp-satir - 4) + tmp-rg-yil(tmp-satir - 3)
    compute tmp-hg-gun(tmp-satir) = tmp-hg-gun(tmp-satir - 5) + tmp-hg-gun(tmp-satir - 4) + tmp-hg-gun(tmp-satir - 3)
    compute tmp-hg-ay(tmp-satir)  = tmp-hg-ay(tmp-satir - 5)  + tmp-hg-ay(tmp-satir - 4)  + tmp-hg-ay(tmp-satir - 3) 
    compute tmp-hg-yil(tmp-satir) = tmp-hg-yil(tmp-satir - 5) + tmp-hg-yil(tmp-satir - 4) + tmp-hg-yil(tmp-satir - 3)
    compute tmp-tg-gun(tmp-satir) = tmp-tg-gun(tmp-satir - 5) + tmp-tg-gun(tmp-satir - 4) + tmp-tg-gun(tmp-satir - 3)
    compute tmp-tg-ay(tmp-satir)  = tmp-tg-ay(tmp-satir - 5)  + tmp-tg-ay(tmp-satir - 4)  + tmp-tg-ay(tmp-satir - 3) 
    compute tmp-tg-yil(tmp-satir) = tmp-tg-yil(tmp-satir - 5) + tmp-tg-yil(tmp-satir - 4) + tmp-tg-yil(tmp-satir - 3)
    .
*
 maincur-hes.
    compute tmp-rs-gun(tmp-satir) = tmp-rs-gun(tmp-satir - 7) - tmp-rs-gun(tmp-satir - 1)
    compute tmp-rs-ay(tmp-satir)  = tmp-rs-ay(tmp-satir - 7)  - tmp-rs-ay(tmp-satir - 1)
    compute tmp-rs-yil(tmp-satir) = tmp-rs-yil(tmp-satir - 7) - tmp-rs-yil(tmp-satir - 1)
    compute tmp-hs-gun(tmp-satir) = tmp-hs-gun(tmp-satir - 7) - tmp-hs-gun(tmp-satir - 1)
    compute tmp-hs-ay(tmp-satir)  = tmp-hs-ay(tmp-satir - 7)  - tmp-hs-ay(tmp-satir - 1)
    compute tmp-hs-yil(tmp-satir) = tmp-hs-yil(tmp-satir - 7) - tmp-hs-yil(tmp-satir - 1)
    compute tmp-ts-gun(tmp-satir) = tmp-ts-gun(tmp-satir - 7) - tmp-ts-gun(tmp-satir - 1)
    compute tmp-ts-ay(tmp-satir)  = tmp-ts-ay(tmp-satir - 7)  - tmp-ts-ay(tmp-satir - 1)
    compute tmp-ts-yil(tmp-satir) = tmp-ts-yil(tmp-satir - 7) - tmp-ts-yil(tmp-satir - 1)

    compute tmp-rg-gun(tmp-satir) = tmp-rg-gun(tmp-satir - 7) - tmp-rg-gun(tmp-satir - 1)
    compute tmp-rg-ay(tmp-satir)  = tmp-rg-ay(tmp-satir - 7)  - tmp-rg-ay(tmp-satir - 1)
    compute tmp-rg-yil(tmp-satir) = tmp-rg-yil(tmp-satir - 7) - tmp-rg-yil(tmp-satir - 1)
    compute tmp-hg-gun(tmp-satir) = tmp-hg-gun(tmp-satir - 7) - tmp-hg-gun(tmp-satir - 1)
    compute tmp-hg-ay(tmp-satir)  = tmp-hg-ay(tmp-satir - 7)  - tmp-hg-ay(tmp-satir - 1)
    compute tmp-hg-yil(tmp-satir) = tmp-hg-yil(tmp-satir - 7) - tmp-hg-yil(tmp-satir - 1)
    compute tmp-tg-gun(tmp-satir) = tmp-tg-gun(tmp-satir - 7) - tmp-tg-gun(tmp-satir - 1)
    compute tmp-tg-ay(tmp-satir)  = tmp-tg-ay(tmp-satir - 7)  - tmp-tg-ay(tmp-satir - 1)
    compute tmp-tg-yil(tmp-satir) = tmp-tg-yil(tmp-satir - 7) - tmp-tg-yil(tmp-satir - 1)
    .
*
 doviz-kuru-dagit.
*   xtar gecen sene baslangic
*   ytar gecen sene son
*   ztar busene baslangic
*   ttar busene son
    move son-tarih  to xtar ytar ztar ttar
    move gecen-sene to xyil yyil
    move orj-yil    to zyil tyil
    move 1          to xgun xay zgun zay
    open i-o takvim kur  
*******************************************************Buyl Bugun
    initialize kur-rec
    move ttar          to kur-tarih
    move onkpara-banka to kur-banka
    move onkpara-doviz to kur-doviz 
    read kur no lock invalid
         display message box "Buyil bugun icin kur girilmemis."
    not invalid
        move doviz-alis to tmp4-ts-gun(tmp-satir) 
    end-read
*******************************************************Buyl Buay
    initialize takvim-rec kur-say hata-say
    move ttar to takvim-anah
    move 1    to takvim-gun
    start takvim key not < takvim-anah invalid
          continue
    not invalid
    perform with test after until fs-takvim = "10"
    read takvim next no lock end move "10" to fs-takvim 
    not at end
        if takvim-anah > ttar
           exit perform 
        end-if
        initialize kur-rec
        move takvim-anah   to kur-tarih
        move onkpara-banka to kur-banka
        move onkpara-doviz to kur-doviz 
        read kur no lock invalid
             if hata-say < 1 
                display message box "Buyil buay icin kur girilmemis." new-line
                                    "Tarih : " takvim-gun "/" takvim-ay "/" takvim-yil
                add 1 to hata-say
             end-if
        not invalid
            add doviz-alis to tmp4-ts-ay(tmp-satir)
            add 1          to kur-say
        end-read

    end-read 
    end-perform 
    end-start
    compute tmp4-ts-ay(tmp-satir) = tmp4-ts-ay(tmp-satir) / kur-say
*******************************************************Buyl Buyil
    initialize takvim-rec kur-say hata-say
    move ttar to takvim-anah
    move 1    to takvim-gun takvim-ay
    start takvim key not < takvim-anah invalid
          continue
    not invalid
    perform with test after until fs-takvim = "10"
    read takvim next no lock end move "10" to fs-takvim 
    not at end
        if takvim-anah > ttar
           exit perform 
        end-if
        initialize kur-rec
        move takvim-anah   to kur-tarih
        move onkpara-banka to kur-banka
        move onkpara-doviz to kur-doviz 
        read kur no lock invalid
             if hata-say < 1 
                display message box "Buyil buyil icin kur girilmemis." new-line
                                    "Tarih : " takvim-gun "/" takvim-ay "/" takvim-yil
                add 1 to hata-say
             end-if
        not invalid
            add doviz-alis to tmp4-ts-yil(tmp-satir)
            add 1          to kur-say
        end-read

    end-read 
    end-perform 
    end-start
    compute tmp4-ts-yil(tmp-satir) = tmp4-ts-yil(tmp-satir) / kur-say
*******************************************************Gecenyl Bugun
    initialize kur-rec
    move ytar          to kur-tarih
    move onkpara-banka to kur-banka
    move onkpara-doviz to kur-doviz 
    read kur no lock invalid
         display message box "Gecenyil bugun icin kur girilmemis."
    not invalid
        move doviz-alis to tmp4-tg-gun(tmp-satir)
    end-read
*******************************************************Gecenyl Buay
    initialize takvim-rec kur-say hata-say
    move ytar to takvim-anah
    move 1    to takvim-gun
    start takvim key not < takvim-anah invalid
          continue
    not invalid
    perform with test after until fs-takvim = "10"
    read takvim next no lock end move "10" to fs-takvim 
    not at end
        if takvim-anah > ytar
           exit perform 
        end-if
        initialize kur-rec
        move takvim-anah   to kur-tarih
        move onkpara-banka to kur-banka
        move onkpara-doviz to kur-doviz 
        read kur no lock invalid
             if hata-say < 1 
                display message box "Gecenyil buay icin kur girilmemis." new-line
                                    "Tarih : " takvim-gun "/" takvim-ay "/" takvim-yil
                add 1 to hata-say
             end-if
        not invalid
            add doviz-alis to tmp4-tg-ay(tmp-satir)
            add 1          to kur-say
        end-read

    end-read 
    end-perform 
    end-start
    compute tmp4-tg-ay(tmp-satir) = tmp4-tg-ay(tmp-satir) / kur-say
*******************************************************Gecenyl Buyil
    initialize takvim-rec kur-say hata-say
    move ytar to takvim-anah
    move 1    to takvim-gun takvim-ay
    start takvim key not < takvim-anah invalid
          continue
    not invalid
    perform with test after until fs-takvim = "10"
    read takvim next no lock end move "10" to fs-takvim 
    not at end
        if takvim-anah > ytar
           exit perform 
        end-if
        initialize kur-rec
        move takvim-anah   to kur-tarih
        move onkpara-banka to kur-banka
        move onkpara-doviz to kur-doviz 
        read kur no lock invalid
             if hata-say < 1 
                display message box "Gecenyil buyil icin kur girilmemis." new-line
                                    "Tarih : " takvim-gun "/" takvim-ay "/" takvim-yil
                add 1 to hata-say
             end-if
        not invalid
            add doviz-alis to tmp4-tg-yil(tmp-satir)
            add 1          to kur-say
        end-read

    end-read 
    end-perform 
    end-start
    compute tmp4-tg-yil(tmp-satir) = tmp4-tg-yil(tmp-satir) / kur-say
    close takvim kur
    .
*
 onkasar-gez.
 
    move son-tarih  to xtar ytar ztar ttar
    move gecen-sene to xyil yyil
    move orj-yil    to zyil tyil
    move 1          to xgun xay zgun zay

    open i-o onkasar depkod depkod2
    initialize onkasar-rec                               
    move 1        to onkasar-ref
    move 1        to onkasar-dep
    move xtar     to onkasar-tarih
    start onkasar key not > onkasar-anah invalid
          continue
    not invalid
    perform with test after until fs-onkasar = "10" 
    read onkasar next no lock end move "10" to fs-onkasar
    not at end
        if onkasar-tarih > ttar 
           if onkasar-ref > 1
              exit perform  
           else
              exit perform cycle
           end-if
        end-if


 

        initialize depkod-rec depkod2-rec
        move onkasar-dep to depkod-kodu depkod2-kodu
        read depkod  invalid continue end-read
        read depkod2 invalid continue end-read

        compute ekle-tutar-tl = onkasar-tutar-tl

        compute ekle-tutar-tl-mat rounded =
                (onkasar-tutar-tl - onkasar-corr-tutar-tl) / ((100 + depkod-kdv) / 100)  
                

        compute ekle-tutar-tl-kdv = ekle-tutar-tl - onkasar-corr-tutar-tl - 
                                    ekle-tutar-tl-mat


        initialize ekle-tutar-kdv-18 ekle-tutar-kdv-8
        evaluate depkod-kdv 
            when 18
                 move ekle-tutar-tl-kdv to ekle-tutar-kdv-18
            when 8
                 move ekle-tutar-tl-kdv to ekle-tutar-kdv-8
        end-evaluate

        evaluate depkod2-alt-kate   
            when "01"
                 compute k = tmp-satir 
                 perform Onkasar-Dagit                 

            when "02"
                 compute k = tmp-satir + 1
                 perform Onkasar-Dagit


            when "03"
                 compute k = tmp-satir + 2
                 perform Onkasar-Dagit


            when "04"
                 compute k = tmp-satir + 3
                 perform Onkasar-Dagit

        end-evaluate
        perform depertmanlara-ayir

    end-read 
    end-perform 
    end-start
    perform varying xi from 29 by 1 until xi > 42
            compute xii = xi + 37

            compute tmp-rs-gun(xi) = tmp-rs-gun(xii) / tmp4-ts-gun(18)
            compute tmp-rs-ay(xi)  = tmp-rs-ay(xii)  / tmp4-ts-ay(18)
            compute tmp-rs-yil(xi) = tmp-rs-yil(xii) / tmp4-ts-yil(18)
            compute tmp-hs-gun(xi) = tmp-hs-gun(xii) / tmp4-ts-gun(18)
            compute tmp-hs-ay(xi)  = tmp-hs-ay(xii)  / tmp4-ts-ay(18)
            compute tmp-hs-yil(xi) = tmp-hs-yil(xii) / tmp4-ts-yil(18)
            compute tmp-ts-gun(xi) = tmp-ts-gun(xii) / tmp4-ts-gun(18)
            compute tmp-ts-ay(xi)  = tmp-ts-ay(xii)  / tmp4-ts-ay(18)
            compute tmp-ts-yil(xi) = tmp-ts-yil(xii) / tmp4-ts-yil(18)
        
            compute tmp-rg-gun(xi) = tmp-rg-gun(xii) / tmp4-tg-gun(18)
            compute tmp-rg-ay(xi)  = tmp-rg-ay(xii)  / tmp4-tg-ay(18)
            compute tmp-rg-yil(xi) = tmp-rg-yil(xii) / tmp4-tg-yil(18)
            compute tmp-hg-gun(xi) = tmp-hg-gun(xii) / tmp4-tg-gun(18)                          
            compute tmp-hg-ay(xi)  = tmp-hg-ay(xii)  / tmp4-tg-ay(18)
            compute tmp-hg-yil(xi) = tmp-hg-yil(xii) / tmp4-tg-yil(18)
            compute tmp-tg-gun(xi) = tmp-tg-gun(xii) / tmp4-tg-gun(18)
            compute tmp-tg-ay(xi)  = tmp-tg-ay(xii)  / tmp4-tg-ay(18)        
            compute tmp-tg-yil(xi) = tmp-tg-yil(xii) / tmp4-tg-yil(18)

            evaluate xi
                when 29
                     move 22 to x-i
                when 34
                     move 23 to x-i
                when 35
                     move 24 to x-i
                when other
                     move 25 to x-i
            end-evaluate 
            add tmp-rs-gun(xi) to tmp-rs-gun(x-i)
            add tmp-rs-ay(xi)  to tmp-rs-ay(x-i) 
            add tmp-rs-yil(xi) to tmp-rs-yil(x-i)
            add tmp-hs-gun(xi) to tmp-hs-gun(x-i)
            add tmp-hs-ay(xi)  to tmp-hs-ay(x-i) 
            add tmp-hs-yil(xi) to tmp-hs-yil(x-i)
            add tmp-ts-gun(xi) to tmp-ts-gun(x-i)
            add tmp-ts-ay(xi)  to tmp-ts-ay(x-i) 
            add tmp-ts-yil(xi) to tmp-ts-yil(x-i)
            
            add tmp-rg-gun(xi) to tmp-rg-gun(x-i)
            add tmp-rg-ay(xi)  to tmp-rg-ay(x-i) 
            add tmp-rg-yil(xi) to tmp-rg-yil(x-i)
            add tmp-hg-gun(xi) to tmp-hg-gun(x-i)                       
            add tmp-hg-ay(xi)  to tmp-hg-ay(x-i) 
            add tmp-hg-yil(xi) to tmp-hg-yil(x-i)
            add tmp-tg-gun(xi) to tmp-tg-gun(x-i)
            add tmp-tg-ay(xi)  to tmp-tg-ay(x-i)     
            add tmp-tg-yil(xi) to tmp-tg-yil(x-i)

    end-perform
 
    perform varying xi from 22 by 1 until xi > 25
            compute tmp-rs-gun(xi) = tmp-rs-gun(xi) / tmp-rs-gun(17)
            compute tmp-rs-ay(xi)  = tmp-rs-ay(xi)  / tmp-rs-ay(17)
            compute tmp-rs-yil(xi) = tmp-rs-yil(xi) / tmp-rs-yil(17)
            compute tmp-hs-gun(xi) = tmp-hs-gun(xi) / tmp-hs-gun(17)
            compute tmp-hs-ay(xi)  = tmp-hs-ay(xi)  / tmp-hs-ay(17)
            compute tmp-hs-yil(xi) = tmp-hs-yil(xi) / tmp-hs-yil(17)
            compute tmp-ts-gun(xi) = tmp-ts-gun(xi) / tmp-ts-gun(17)
            compute tmp-ts-ay(xi)  = tmp-ts-ay(xi)  / tmp-ts-ay(17)
            compute tmp-ts-yil(xi) = tmp-ts-yil(xi) / tmp-ts-yil(17)
        
            compute tmp-rg-gun(xi) = tmp-rg-gun(xi) / tmp-rg-gun(17)
            compute tmp-rg-ay(xi)  = tmp-rg-ay(xi)  / tmp-rg-ay(17)
            compute tmp-rg-yil(xi) = tmp-rg-yil(xi) / tmp-rg-yil(17)
            compute tmp-hg-gun(xi) = tmp-hg-gun(xi) / tmp-hg-gun(17)
            compute tmp-hg-ay(xi)  = tmp-hg-ay(xi)  / tmp-hg-ay(17)
            compute tmp-hg-yil(xi) = tmp-hg-yil(xi) / tmp-hg-yil(17)
            compute tmp-tg-gun(xi) = tmp-tg-gun(xi) / tmp-tg-gun(17)
            compute tmp-tg-ay(xi)  = tmp-tg-ay(xi)  / tmp-tg-ay(17)
            compute tmp-tg-yil(xi) = tmp-tg-yil(xi) / tmp-tg-yil(17)

            add tmp-rs-gun(xi) to tmp-rs-gun(26) 
            add tmp-rs-ay(xi)  to tmp-rs-ay(26) 
            add tmp-rs-yil(xi) to tmp-rs-yil(26) 
            add tmp-hs-gun(xi) to tmp-hs-gun(26) 
            add tmp-hs-ay(xi)  to tmp-hs-ay(26) 
            add tmp-hs-yil(xi) to tmp-hs-yil(26) 
            add tmp-ts-gun(xi) to tmp-ts-gun(26) 
            add tmp-ts-ay(xi)  to tmp-ts-ay(26) 
            add tmp-ts-yil(xi) to tmp-ts-yil(26) 
        
            add tmp-rg-gun(xi) to tmp-rg-gun(26) 
            add tmp-rg-ay(xi)  to tmp-rg-ay(26) 
            add tmp-rg-yil(xi) to tmp-rg-yil(26) 
            add tmp-hg-gun(xi) to tmp-hg-gun(26) 
            add tmp-hg-ay(xi)  to tmp-hg-ay(26) 
            add tmp-hg-yil(xi) to tmp-hg-yil(26) 
            add tmp-tg-gun(xi) to tmp-tg-gun(26) 
            add tmp-tg-ay(xi)  to tmp-tg-ay(26) 
            add tmp-tg-yil(xi) to tmp-tg-yil(26) 
        
    end-perform 
    perform varying xi from 29 by 1 until xi > 42 

            add tmp-rs-gun(xi) to tmp-rs-gun(43) 
            add tmp-rs-ay(xi)  to tmp-rs-ay(43) 
            add tmp-rs-yil(xi) to tmp-rs-yil(43) 
            add tmp-hs-gun(xi) to tmp-hs-gun(43) 
            add tmp-hs-ay(xi)  to tmp-hs-ay(43) 
            add tmp-hs-yil(xi) to tmp-hs-yil(43) 
            add tmp-ts-gun(xi) to tmp-ts-gun(43) 
            add tmp-ts-ay(xi)  to tmp-ts-ay(43) 
            add tmp-ts-yil(xi) to tmp-ts-yil(43) 
        
            add tmp-rg-gun(xi) to tmp-rg-gun(43) 
            add tmp-rg-ay(xi)  to tmp-rg-ay(43) 
            add tmp-rg-yil(xi) to tmp-rg-yil(43) 
            add tmp-hg-gun(xi) to tmp-hg-gun(43) 
            add tmp-hg-ay(xi)  to tmp-hg-ay(43) 
            add tmp-hg-yil(xi) to tmp-hg-yil(43) 
            add tmp-tg-gun(xi) to tmp-tg-gun(43) 
            add tmp-tg-ay(xi)  to tmp-tg-ay(43) 
            add tmp-tg-yil(xi) to tmp-tg-yil(43) 
        
    end-perform 
    close onkasar depkod depkod2.
*
 onkasar-dagit.
    if onkr-yil = orj-yil 
       if onkr-ay = yay     
          if onkr-gun = ygun  
             if onkasar-ref = 1  
                add ekle-tutar-dv to tmp-rs-gun(k)
                add ekle-tutar-dv to tmp-rs-ay(k)
                add ekle-tutar-dv to tmp-rs-yil(k)
             else                                       
                add ekle-tutar-dv to tmp-hs-gun(k)
                add ekle-tutar-dv to tmp-hs-ay(k)
                add ekle-tutar-dv to tmp-hs-yil(k)  
             end-if     
             add ekle-tutar-dv to tmp-ts-gun(k)
          else       
             if onkasar-ref = 1                      
                add ekle-tutar-dv to tmp-rs-ay(k)
                add ekle-tutar-dv to tmp-rs-yil(k) 
             else                                         
                add ekle-tutar-dv to tmp-hs-ay(k)
                add ekle-tutar-dv to tmp-hs-yil(k)    
             end-if  
          end-if     
          add ekle-tutar-dv to tmp-ts-ay(k)
       else
          if onkasar-ref = 1
             add ekle-tutar-dv to tmp-rs-yil(k)
          else
             add ekle-tutar-dv to tmp-hs-yil(k)
          end-if
       end-if
       add ekle-tutar-dv to tmp-ts-yil(k)
    else
       if onkr-ay = yay     
          if onkr-gun = ygun  
             if onkasar-ref = 1  
                add ekle-tutar-dv to tmp-rg-gun(k)
                add ekle-tutar-dv to tmp-rg-ay(k)
                add ekle-tutar-dv to tmp-rg-yil(k)
             else                                       
                add ekle-tutar-dv to tmp-hg-gun(k)
                add ekle-tutar-dv to tmp-hg-ay(k)
                add ekle-tutar-dv to tmp-hg-yil(k)  
             end-if     
             add ekle-tutar-dv to tmp-tg-gun(k)
          else       
             if onkasar-ref = 1                      
                add ekle-tutar-dv to tmp-rg-ay(k)
                add ekle-tutar-dv to tmp-rg-yil(k) 
             else                                         
                add ekle-tutar-dv to tmp-hg-ay(k)
                add ekle-tutar-dv to tmp-hg-yil(k)    
             end-if  
          end-if     
          add ekle-tutar-dv to tmp-tg-ay(k)
       else
          if onkasar-ref = 1
             add ekle-tutar-dv to tmp-rg-yil(k)
          else
             add ekle-tutar-dv to tmp-hg-yil(k)
          end-if
       end-if
       add ekle-tutar-dv to tmp-tg-yil(k)
    end-if.

*
 depertmanlara-ayir.
      evaluate onkasar-dep
          when 1 when 48 when 49          | Oda Pansiyon
               compute xii = tmp-satir + 44 | move 66 to xii
               perform xii-dagit

          when 2  when 21                 | No-Show Geliri
               compute xii = tmp-satir + 45 | move 67 to xii
               perform xii-dagit

          when 62                         | Deniz Farki Geliri
               compute xii = tmp-satir + 46 | move 68 to xii
               perform xii-dagit

          when 63                         | Oda Upgrade Geliri
               compute xii = tmp-satir + 47 | move 69 to xii
               perform xii-dagit

          when 64                         | Late C-out Geliri
               compute xii = tmp-satir + 48 | move 70 to xii
               perform xii-dagit

          when 4  when 9  when 10 when 12 | Extra Yiyecek
          when 14 when 18 when 22 when 31                    
          when 33 when 35 when 37 when 40                         
          when 41 when 43                                 
               compute xii = tmp-satir + 49 | move 71 to xii
               perform xii-dagit

          when 5  when 6  when 7  when 8  | Extra Icecek
          when 11 when 13 when 15 when 19                    
          when 20 when 23 when 32 when 34 
          when 36 when 38 when 39 when 42 
          when 44                                       
               compute xii = tmp-satir + 50 | move 72 to xii
               perform xii-dagit

          when 26                         | Day Use Kullanim
               compute xii = tmp-satir + 51 | move 73 to xii
               perform xii-dagit

          when 16                         | Camasirhane Gelirleri
               compute xii = tmp-satir + 52 | move 74 to xii
               perform xii-dagit

          when 60                         | Gazebo Kullanim Geliri
               compute xii = tmp-satir + 53 | move 75 to xii
               perform xii-dagit

          when 54                         | Hasar Geliri
               compute xii = tmp-satir + 54 | move 76 to xii
               perform xii-dagit

          when 70                         | Stroller Kullanim
               compute xii = tmp-satir + 55 | move 77 to xii
               perform xii-dagit

          when 66                         | Bagaj Kaplama Gelirleri
               compute xii = tmp-satir + 56 | move 78 to xii
               perform xii-dagit

          when 3  when 17 when 24 when 25 | Aktivite ve Diger Gelirler
          when 28 when 30 when 44 when 45 
          when 46 when 65 when 71                                        
               compute xii = tmp-satir + 57 | move 79 to xii
               perform xii-dagit


          when 50                          ||| paralar....$$$$$$
               compute xii = tmp-satir + 65 | move 87 to xii
               perform xii-dagit
          when 52 when 56 when 57 when 58
          when 59 when 61 when 72
               compute xii = tmp-satir + 66 | move 88 to xii
               perform xii-dagit
          when 51 
               compute xii = tmp-satir + 67 | move 89 to xii
               perform xii-dagit
      end-evaluate
      .
*
 xii-dagit.
      if onkr-yil = orj-yil 
         if onkr-ay = yay     
            if onkr-gun = ygun  
               if onkasar-ref = 1  
                  add ekle-tutar-tl-mat to tmp-rs-gun(xii)
                  add ekle-tutar-kdv-8  to tmp-rs-gun(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-rs-gun(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-rs-ay(xii)
                  add ekle-tutar-kdv-8  to tmp-rs-ay(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-rs-ay(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-rs-yil(xii)
                  add ekle-tutar-kdv-8  to tmp-rs-yil(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-rs-yil(tmp-satir + 61)
               else                                       
                  add ekle-tutar-tl-mat to tmp-hs-gun(xii)
                  add ekle-tutar-kdv-8  to tmp-hs-gun(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-hs-gun(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-hs-ay(xii)
                  add ekle-tutar-kdv-8  to tmp-hs-ay(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-hs-ay(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-hs-yil(xii)  
                  add ekle-tutar-kdv-8  to tmp-hs-yil(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-hs-yil(tmp-satir + 61)
               end-if     
               add ekle-tutar-tl-mat to tmp-ts-gun(xii)
               add ekle-tutar-kdv-8  to tmp-ts-gun(tmp-satir + 60)
               add ekle-tutar-kdv-18 to tmp-ts-gun(tmp-satir + 61)
               add ekle-tutar-tl-mat to tmp-ts-ay(xii)
               add ekle-tutar-kdv-8  to tmp-ts-ay(tmp-satir + 60)
               add ekle-tutar-kdv-18 to tmp-ts-ay(tmp-satir + 61)
               add ekle-tutar-tl-mat to tmp-ts-yil(xii)
               add ekle-tutar-kdv-8  to tmp-ts-yil(tmp-satir + 60)
               add ekle-tutar-kdv-18 to tmp-ts-yil(tmp-satir + 61)
               exit paragraph
            else       
               if onkasar-ref = 1                      
                  add ekle-tutar-tl-mat to tmp-rs-ay(xii)
                  add ekle-tutar-kdv-8  to tmp-rs-ay(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-rs-ay(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-rs-yil(xii) 
                  add ekle-tutar-kdv-8  to tmp-rs-yil(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-rs-yil(tmp-satir + 61)
               else                                         
                  add ekle-tutar-tl-mat to tmp-hs-ay(xii)
                  add ekle-tutar-kdv-8  to tmp-hs-ay(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-hs-ay(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-hs-yil(xii)
                  add ekle-tutar-kdv-8  to tmp-hs-yil(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-hs-yil(tmp-satir + 61)
               end-if  
            end-if     
            add ekle-tutar-tl-mat to tmp-ts-ay(xii)
            add ekle-tutar-kdv-8  to tmp-ts-ay(tmp-satir + 60)
            add ekle-tutar-kdv-18 to tmp-ts-ay(tmp-satir + 61)
            add ekle-tutar-tl-mat to tmp-ts-yil(xii)
            add ekle-tutar-kdv-8  to tmp-ts-yil(tmp-satir + 60)
            add ekle-tutar-kdv-18 to tmp-ts-yil(tmp-satir + 61)
            exit paragraph
         else
            if onkasar-ref = 1
               add ekle-tutar-tl-mat to tmp-rs-yil(xii)
               add ekle-tutar-kdv-8  to tmp-rs-yil(tmp-satir + 60)
               add ekle-tutar-kdv-18 to tmp-rs-yil(tmp-satir + 61)
            else
               add ekle-tutar-tl-mat to tmp-hs-yil(xii)
               add ekle-tutar-kdv-8  to tmp-hs-yil(tmp-satir + 60)
               add ekle-tutar-kdv-18 to tmp-hs-yil(tmp-satir + 61)
            end-if
         end-if
         add ekle-tutar-tl-mat to tmp-ts-yil(xii)
         add ekle-tutar-kdv-8  to tmp-ts-yil(tmp-satir + 60)
         add ekle-tutar-kdv-18 to tmp-ts-yil(tmp-satir + 61)
         exit paragraph
      else
         if onkr-ay = yay     
            if onkr-gun = ygun  
               if onkasar-ref = 1  
                  add ekle-tutar-tl-mat to tmp-rg-gun(xii)
                  add ekle-tutar-kdv-8  to tmp-rg-gun(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-rg-gun(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-rg-ay(xii)
                  add ekle-tutar-kdv-8  to tmp-rg-ay(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-rg-ay(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-rg-yil(xii)
                  add ekle-tutar-kdv-8  to tmp-rg-yil(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-rg-yil(tmp-satir + 61)
               else                                       
                  add ekle-tutar-tl-mat to tmp-hg-gun(xii)
                  add ekle-tutar-kdv-8  to tmp-hg-gun(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-hg-gun(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-hg-ay(xii)
                  add ekle-tutar-kdv-8  to tmp-hg-ay(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-hg-ay(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-hg-yil(xii)  
                  add ekle-tutar-kdv-8  to tmp-hg-yil(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-hg-yil(tmp-satir + 61)
               end-if     
               add ekle-tutar-tl-mat to tmp-tg-gun(xii)
               add ekle-tutar-kdv-8  to tmp-tg-gun(tmp-satir + 60)
               add ekle-tutar-kdv-18 to tmp-tg-gun(tmp-satir + 61)
               add ekle-tutar-tl-mat to tmp-tg-ay(xii)
               add ekle-tutar-kdv-8  to tmp-tg-ay(tmp-satir + 60)
               add ekle-tutar-kdv-18 to tmp-tg-ay(tmp-satir + 61)
               add ekle-tutar-tl-mat to tmp-tg-yil(xii)
               add ekle-tutar-kdv-8  to tmp-tg-yil(tmp-satir + 60)
               add ekle-tutar-kdv-18 to tmp-tg-yil(tmp-satir + 61)
               exit paragraph
            else       
               if onkasar-ref = 1                      
                  add ekle-tutar-tl-mat to tmp-rg-ay(xii)
                  add ekle-tutar-kdv-8  to tmp-rg-ay(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-rg-ay(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-rg-yil(xii) 
                  add ekle-tutar-kdv-8  to tmp-rg-yil(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-rg-yil(tmp-satir + 61)
               else                                         
                  add ekle-tutar-tl-mat to tmp-hg-ay(xii)
                  add ekle-tutar-kdv-8  to tmp-hg-ay(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-hg-ay(tmp-satir + 61)
                  add ekle-tutar-tl-mat to tmp-hg-yil(xii)    
                  add ekle-tutar-kdv-8  to tmp-hg-yil(tmp-satir + 60)
                  add ekle-tutar-kdv-18 to tmp-hg-yil(tmp-satir + 61)
               end-if  
            end-if     
            add ekle-tutar-tl-mat to tmp-tg-ay(xii)
            add ekle-tutar-kdv-8  to tmp-tg-ay(tmp-satir + 60)
            add ekle-tutar-kdv-18 to tmp-tg-ay(tmp-satir + 61)
            add ekle-tutar-tl-mat to tmp-tg-yil(xii)
            add ekle-tutar-kdv-8  to tmp-tg-yil(tmp-satir + 60)
            add ekle-tutar-kdv-18 to tmp-tg-yil(tmp-satir + 61)
            exit paragraph
         else
            if onkasar-ref = 1
               add ekle-tutar-tl-mat to tmp-rg-yil(xii)
               add ekle-tutar-kdv-8  to tmp-rg-yil(tmp-satir + 60)
               add ekle-tutar-kdv-18 to tmp-rg-yil(tmp-satir + 61)
            else
               add ekle-tutar-tl-mat to tmp-hg-yil(xii)
               add ekle-tutar-kdv-8  to tmp-hg-yil(tmp-satir + 60)
               add ekle-tutar-kdv-18 to tmp-hg-yil(tmp-satir + 61)
            end-if
         end-if
         add ekle-tutar-tl-mat to tmp-tg-yil(xii)
         add ekle-tutar-kdv-8  to tmp-tg-yil(tmp-satir + 60)
         add ekle-tutar-kdv-18 to tmp-tg-yil(tmp-satir + 61)
         exit paragraph
      end-if
        .
         
*
 tmp-aktar.
      move function numval(det11-rbugun)       to tmp-rs-gun(tmp-satir)        
      move function numval(det11-rbuay)        to tmp-rs-ay(tmp-satir)   
      move function numval(det11-rbuyil)       to tmp-rs-yil(tmp-satir)   
      move function numval(det11-gecen-rbugun) to tmp-rg-gun(tmp-satir)   
      move function numval(det11-gecen-rbuay)  to tmp-rg-ay(tmp-satir)    
      move function numval(det11-gecen-rbuyil) to tmp-rg-yil(tmp-satir)   
      move function numval(det11-hbugun)       to tmp-hs-gun(tmp-satir)       
      move function numval(det11-hbuay)        to tmp-hs-ay(tmp-satir)        
      move function numval(det11-hbuyil)       to tmp-hs-yil(tmp-satir)       
      move function numval(det11-gecen-hbugun) to tmp-hg-gun(tmp-satir)       
      move function numval(det11-gecen-hbuay)  to tmp-hg-ay(tmp-satir)        
      move function numval(det11-gecen-hbuyil) to tmp-hg-yil(tmp-satir) 
      move function numval(det11-tbugun)       to tmp-ts-gun(tmp-satir) 
      move function numval(det11-tbuay)        to tmp-ts-ay(tmp-satir)  
      move function numval(det11-tbuyil)       to tmp-ts-yil(tmp-satir) 
      move function numval(det11-gecen-tbugun) to tmp-tg-gun(tmp-satir) 
      move function numval(det11-gecen-tbuay)  to tmp-tg-ay(tmp-satir)  
      move function numval(det11-gecen-tbuyil) to tmp-tg-yil(tmp-satir)   
    .
*
 fil-bass.
*****(-_-)   (-_-) (-_-) (-_-) (-_-) (-_-)  (-_-) (-_-) (-_-)
*     BURAYI PERFROM YAP BENCE

      move "|"  TO fil11-baslik fil11-rbugun fil11-rbuay fil11-rbuyil fil11-gecen-rbugun fil11-gecen-rbuay fil11-gecen-rbuyil
                                fil11-hbugun fil11-hbuay fil11-hbuyil fil11-gecen-hbugun fil11-gecen-hbuay fil11-gecen-hbuyil
                                fil11-tbugun fil11-tbuay fil11-tbuyil fil11-gecen-tbugun fil11-gecen-tbuay fil11-gecen-tbuyil
*     BURAYI PERFROM YAP BENCE
*****(-_-)  (-_-) (-_-) (-_-) (-_-) (-_-) (-_-)
      .
*
 det-cizgi-at.
     move all "-" to det11-rbugun det11-hbugun det11-rbuay det11-hbuay det11-rbuyil det11-hbuyil
                     det11-gecen-rbugun det11-gecen-hbugun det11-gecen-rbuay det11-gecen-hbuay
                     det11-gecen-rbuyil det11-gecen-hbuyil det11-tbugun det11-tbuay det11-tbuyil
                     det11-gecen-tbugun det11-gecen-tbuay det11-gecen-tbuyil.

*
 tmp-to-z.
     evaluate tmp-satir  
         when 3  when 4  when 5  when 6   
         when 8  when 9  when 10 when 11 
         when 12 when 13 when 14 when 15 when 17
         when 47 when 48 when 49 when 50 
         when 51 when 56 when 57 when 58 
         when 59 when 60 when 61 when 62
              if tmp-satir = 56 or 57 or 58 or 
                             59 or 60 or 61 or 62
                 compute tmp-ts-yil(tmp-satir) = (tmp-rs-yil(tmp-satir) + tmp-hs-yil(tmp-satir)) / 2 
                 compute tmp-tg-yil(tmp-satir) = (tmp-rg-yil(tmp-satir) + tmp-hg-yil(tmp-satir)) / 2 
              else
                 compute tmp-ts-yil(tmp-satir) = tmp-rs-yil(tmp-satir) + tmp-hs-yil(tmp-satir) 
                 compute tmp-tg-yil(tmp-satir) = tmp-rg-yil(tmp-satir) + tmp-hg-yil(tmp-satir) 
              end-if
              move tmp-rs-gun(tmp-satir)   to z-oda3
              move z-oda3                  to det11-rbugun  
              
              move tmp-hs-gun(tmp-satir)   to z-oda3
              move z-oda3                  to det11-hbugun 
 
              move tmp-rs-ay(tmp-satir)    to z-oda3
              move z-oda3                  to det11-rbuay 
              
              move tmp-hs-ay(tmp-satir)    to z-oda3
              move z-oda3                  to det11-hbuay 
                        
              move tmp-rs-yil(tmp-satir)   to z-oda3  
              move z-oda3                  to det11-rbuyil 
              
              move tmp-hs-yil(tmp-satir)   to z-oda3  
              move z-oda3                  to det11-hbuyil 
              
              compute tmp-ts-gun(tmp-satir) = tmp-rs-gun(tmp-satir) + tmp-hs-gun(tmp-satir) 
              compute tmp-ts-ay(tmp-satir)  = tmp-rs-ay(tmp-satir)  + tmp-hs-ay(tmp-satir) 
              
**************************************gecen sene*******************************
              
              move tmp-rg-gun(tmp-satir) to z-oda3  
              move z-oda3                to det11-gecen-rbugun  
              
              move tmp-hg-gun(tmp-satir) to z-oda3  
              move z-oda3                to det11-gecen-hbugun  
              
              move tmp-rg-ay(tmp-satir)  to z-oda3  
              move z-oda3                to det11-gecen-rbuay 
              
              move tmp-hg-ay(tmp-satir)  to z-oda3  
              move z-oda3                to det11-gecen-hbuay 
                        
              move tmp-rg-yil(tmp-satir) to z-oda3  
              move z-oda3                to det11-gecen-rbuyil 
              
              move tmp-hg-yil(tmp-satir) to z-oda3  
              move z-oda3                to det11-gecen-hbuyil 
              
              compute tmp-tg-gun(tmp-satir) = tmp-rg-gun(tmp-satir) + tmp-hg-gun(tmp-satir) 
              compute tmp-tg-ay(tmp-satir)  = tmp-rg-ay(tmp-satir)  + tmp-hg-ay(tmp-satir) 
              
              move tmp-ts-gun(tmp-satir) to z-oda3  
              move z-oda3                to det11-tbugun 
              move tmp-ts-ay(tmp-satir)  to z-oda3  
              move z-oda3                to det11-tbuay 
              move tmp-ts-yil(tmp-satir) to z-oda3  
              move z-oda3                to det11-tbuyil 
              
              move tmp-tg-gun(tmp-satir) to z-oda3  
              move z-oda3                to det11-gecen-tbugun 
              move tmp-tg-ay(tmp-satir)  to z-oda3  
              move z-oda3                to det11-gecen-tbuay 
              move tmp-tg-yil(tmp-satir) to z-oda3  
              move z-oda3                to det11-gecen-tbuyil 

              if tmp-satir = 47 or 48 or 49 or 50 or 51                   
                                        
                 move tmp-rs-ay(tmp-satir)  to z-oda-ort
                 move z-oda-ort             to det11-rbuay 
              
                 move tmp-hs-ay(tmp-satir)  to z-oda-ort
                 move z-oda-ort             to det11-hbuay 
              
                 move tmp-rg-gun(tmp-satir) to z-oda-ort  
                 move z-oda-ort             to det11-gecen-rbugun  
                 
                 move tmp-hg-gun(tmp-satir) to z-oda-ort  
                 move z-oda-ort             to det11-gecen-hbugun  
        
                 move tmp-rg-yil(tmp-satir) to z-oda-ort  
                 move z-oda-ort             to det11-gecen-rbuyil 
                 
                 move tmp-hg-yil(tmp-satir) to z-oda-ort  
                 move z-oda-ort             to det11-gecen-hbuyil 
                      
                 move tmp-ts-ay(tmp-satir)  to z-oda-ort  
                 move z-oda-ort             to det11-tbuay 

                 move tmp-tg-gun(tmp-satir) to z-oda-ort  
                 move z-oda-ort             to det11-gecen-tbugun 
        
                 move tmp-tg-yil(tmp-satir) to z-oda-ort  
                 move z-oda-ort             to det11-gecen-tbuyil 

              end-if                                                
         when 18
              move tmp4-ts-gun(tmp-satir) to z-kur
              move z-kur                  to det11-rbugun  
                                             det11-hbugun
                                             det11-tbugun
        
              move tmp4-ts-ay(tmp-satir)  to z-kur
              move z-kur                  to det11-rbuay 
                                             det11-hbuay
                                             det11-tbuay
        
              move tmp4-ts-yil(tmp-satir) to z-kur
              move z-kur                  to det11-rbuyil 
                                             det11-hbuyil
                                             det11-tbuyil
        
              move tmp4-ts-gun(tmp-satir) to z-kur
              move z-kur                  to det11-gecen-rbugun  
                                             det11-gecen-hbugun
                                             det11-gecen-tbugun
        
              move tmp4-ts-ay(tmp-satir)  to z-kur   
              move z-kur                  to det11-gecen-rbuay 
                                             det11-gecen-hbuay
                                             det11-gecen-tbuay
        
              move tmp4-ts-yil(tmp-satir) to z-kur   
              move z-kur                  to det11-gecen-rbuyil 
                                             det11-gecen-hbuyil
                                             det11-gecen-tbuyil
        
         when other
              move tmp-rs-gun(tmp-satir) to z-tutar4
              move z-tutar4              to det11-rbugun  
              
              move tmp-hs-gun(tmp-satir) to z-tutar4
              move z-tutar4              to det11-hbugun  
              
              move tmp-rs-ay(tmp-satir)  to z-tutar4
              move z-tutar4              to det11-rbuay 
              
              move tmp-hs-ay(tmp-satir)  to z-tutar4
              move z-tutar4              to det11-hbuay 
                        
              move tmp-rs-yil(tmp-satir) to z-tutar4
              move z-tutar4              to det11-rbuyil 
              
              move tmp-hs-yil(tmp-satir) to z-tutar4
              move z-tutar4              to det11-hbuyil 
              
              compute tmp-ts-gun(tmp-satir) = tmp-rs-gun(tmp-satir) + tmp-hs-gun(tmp-satir) 
              compute tmp-ts-ay(tmp-satir)  = tmp-rs-ay(tmp-satir)  + tmp-hs-ay(tmp-satir) 
              compute tmp-ts-yil(tmp-satir) = tmp-rs-yil(tmp-satir) + tmp-hs-yil(tmp-satir) 
              
**************************************gecen sene*******************************
              
              move tmp-rg-gun(tmp-satir) to z-tutar4
              move z-tutar4              to det11-gecen-rbugun  
              
              move tmp-hg-gun(tmp-satir) to z-tutar4
              move z-tutar4              to det11-gecen-hbugun  
              
              move tmp-rg-ay(tmp-satir)  to z-tutar4
              move z-tutar4              to det11-gecen-rbuay 
              
              move tmp-hg-ay(tmp-satir)  to z-tutar4
              move z-tutar4              to det11-gecen-hbuay 
                        
              move tmp-rg-yil(tmp-satir) to z-tutar4
              move z-tutar4              to det11-gecen-rbuyil 
              
              move tmp-hg-yil(tmp-satir) to z-tutar4
              move z-tutar4              to det11-gecen-hbuyil 
              
              compute tmp-tg-gun(tmp-satir) = tmp-rg-gun(tmp-satir) + tmp-hg-gun(tmp-satir) 
              compute tmp-tg-ay(tmp-satir)  = tmp-rg-ay(tmp-satir)  + tmp-hg-ay(tmp-satir) 
              compute tmp-tg-yil(tmp-satir) = tmp-rg-yil(tmp-satir) + tmp-hg-yil(tmp-satir) 
              
              move tmp-ts-gun(tmp-satir) to z-tutar4
              move z-tutar4              to det11-tbugun 
              move tmp-ts-ay(tmp-satir)  to z-tutar4
              move z-tutar4              to det11-tbuay 
              move tmp-ts-yil(tmp-satir) to z-tutar4
              move z-tutar4              to det11-tbuyil 
              
              move tmp-tg-gun(tmp-satir) to z-tutar4
              move z-tutar4              to det11-gecen-tbugun 
              move tmp-tg-ay(tmp-satir)  to z-tutar4
              move z-tutar4              to det11-gecen-tbuay 
              move tmp-tg-yil(tmp-satir) to z-tutar4
              move z-tutar4              to det11-gecen-tbuyil 
     end-evaluate 
    .
*
 tum-bas-bul.
    initialize gelist-rec
    move ilk-tarih to gelist-tarih    
    start gelist key not < gelist-anah invalid 
           continue
    not invalid,           
          perform with test after until fs-gelist = "10",
              read gelist next no lock end move "10" to fs-gelist,
                   not end,
                   if gelist-tarih > son-tarih,
                      move "10" to fs-gelist
                   else
                         move gelist-folio to konuk-folio
                         read konuk no lock invalid
                            continue
                         not invalid 
                              move konuk-odeme-tipi to kodlar02-kodu
                              move "B" to kodlar02-tipi
                              read kodlar02 no lock invalid 
                                 continue
                              end-read  
                         end-read
                            initialize rez-rec
                            if konuk-fol-kodu = "R"
                               move konuk-rez-no  to rez-no
                            else
                               move konuk-extra-rez-no to rez-no
                            end-if 
                            read rez no lock invalid 
                                 continue 
                            not invalid
                                    if filtre-var = 1 then 
                                       perform filtre
                                       if filtre-gecti not = 1 then 
                                             exit perform cycle 
                                       end-if
                                    end-if                                
                            end-read 

                         initialize cast-rec
                         move gelist-tarih to cast-tarih
                         move rez-no       to cast-rez-no
                         read cast no lock invalid 
                              move rez-fiyat-konumu to cast-fiyat-konumu
                             move rez-oda-konumu to cast-oda-konumu
                         not invalid 
                             move cast-oda-no to rez-odano
                             move cast-fiyat-konumu to rez-fiyat-konumu
                             move cast-oda-konumu to rez-oda-konumu
                         end-read 
                          if ONKPARA-REFERANS-VAR = 1
                          perform  sifir-coz
                                        if xkonum-ref(cast-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(cast-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         exit perform cycle
                          end-if
                          end-if
                         if ikinci-sirkete-gecildi = 1
                            initialize odalar-rec
                            move rez-odano  to odalar-anah
                            read odalar no lock invalid 
                                 exit perform cycle 
                            not invalid 
                                if odalar-hayali not = "H" 
                                     exit perform cycle  
                                end-if 
                            end-read 
                         end-if 

                         if rez-odano not = spaces and 
                               ( hayali-haric = 1 or dis-haric = 1 ) then 
                                      move rez-odano to odalar-anah
                                      read odalar no lock invalid 
                                          continue
                                      not invalid
                                      if ( odalar-hayali = "H" and hayali-haric = 1 )  then
                                               move 0 to eklenecek-oda
                                      end-if
                                       if ( dis-haric = 1 and odalar-dis = 1 )  then
                                               exit perform cycle
                                      end-if 
                                      end-read
                         end-if  

                         move "01" to kur-banka
                         move butce-cev-doviz  to kur-doviz
                         move gelist-tarih     to kur-tarih
                         read kur no lock invalid 
                             move 1 to doviz-alis
                         end-read
                         move doviz-alis to cev1


                         move butce-cev-doviz2 to kur-doviz
                         read kur no lock invalid 
                                 move 1 to doviz-alis
                         end-read
                         move doviz-alis to cev2
   
                         if kdv-haric = 1

                            move gelist-tarih to kdv-rap-tarih
                            perform genel2-cinkdv-ayarla
                            compute gelist-oda rounded = gelist-oda / ((100 + CINPARA-MUS-KDV) / 100)
                            |compute gelist-oda rounded = gelist-oda / 1.08
                            compute gelist-yiy rounded = gelist-yiy / 1.18
                            compute gelist-ice rounded = gelist-ice / 1.18
                            compute gelist-dig rounded = gelist-dig / 1.18
                         end-if 

                         if gelist-tarih = son-tarih
                            evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-tutar-1(1) rounded = 
                                                 takas3-hous-tutar-1(1)  + gelist-oda
                                    compute takas3-hous-tutar-2(1) rounded = 
                                                 takas3-hous-tutar-2(1)  + ( gelist-oda /cev1)
                                    compute takas3-hous-tutar-3(1) rounded = 
                                                 takas3-hous-tutar-3(1)  + ( gelist-oda /cev2)
                                 when "C"    
                                 when "D"
                                 when "O"
                                    compute takas3-comp-tutar-1(1) rounded = 
                                                 takas3-comp-tutar-1(1)  + gelist-oda
                                    compute takas3-comp-tutar-2(1) rounded = 
                                                 takas3-comp-tutar-2(1)  + ( gelist-oda /cev1)
                                    compute takas3-comp-tutar-3(1) rounded = 
                                                 takas3-comp-tutar-3(1)  + ( gelist-oda /cev2)
                                    
                                 when other
                                    compute takas3-ucr-tutar-1(1) rounded = 
                                                 takas3-ucr-tutar-1(1)  + gelist-oda
                                    compute takas3-ucr-tutar-2(1) rounded = 
                                                 takas3-ucr-tutar-2(1)  + ( gelist-oda / cev1 )
                                    compute takas3-ucr-tutar-3(1) rounded = 
                                                 takas3-ucr-tutar-3(1)  + ( gelist-oda / cev2 )
                            end-evaluate      
                            compute takas3-oda-tutar-1(1) rounded = 
                                                 takas3-oda-tutar-1(1)  + gelist-oda
                            compute takas3-oda-tutar-2(1) rounded = 
                                                 takas3-oda-tutar-2(1)  + ( gelist-oda / cev1 )
                            compute takas3-oda-tutar-3(1) rounded = 
                                                 takas3-oda-tutar-3(1)  + ( gelist-oda / cev2 )
                            if ikinci-sirkete-gecildi not = 1
                            compute takas3-yiy-tutar-1(1) rounded = 
                                                 takas3-yiy-tutar-1(1)  + gelist-yiy
                            compute takas3-yiy-tutar-2(1) rounded = 
                                                 takas3-yiy-tutar-2(1)  + (gelist-yiy / cev1 )
                            compute takas3-yiy-tutar-3(1) rounded = 
                                                 takas3-yiy-tutar-3(1)  + (gelist-yiy / cev2 )
                                                 
                                                 
                             compute takas3-ice-tutar-1(1) rounded = 
                                                 takas3-ice-tutar-1(1)  + gelist-ice
                             compute takas3-ice-tutar-2(1) rounded = 
                                                 takas3-ice-tutar-2(1)  + (gelist-ice / cev1 )
                            compute takas3-ice-tutar-3(1) rounded = 
                                                 takas3-ice-tutar-3(1)  + (gelist-ice / cev2 )

                             compute takas3-dig-tutar-1(1) rounded = 
                                                 takas3-dig-tutar-1(1)  + gelist-dig
                            compute takas3-dig-tutar-2(1) rounded = 
                                                 takas3-dig-tutar-2(1)  + (gelist-dig / cev1 )
                            compute takas3-dig-tutar-3(1) rounded = 
                                                 takas3-dig-tutar-3(1)  + (gelist-dig / cev2 ) 
                            end-if  
                         end-if
********************************AYLIK

                          if gelist-ay = son-ay and gelist-yil = son-yil then
                                evaluate ode-tipi
                                when "F"
                                    compute takas3-hous-tutar-1(2) rounded = 
                                                 takas3-hous-tutar-1(2)  + gelist-oda
                                    compute takas3-hous-tutar-2(2) rounded = 
                                                 takas3-hous-tutar-2(2)  + ( gelist-oda /cev1)
                                    compute takas3-hous-tutar-3(2) rounded = 
                                                 takas3-hous-tutar-3(2)  + ( gelist-oda /cev2)
                                 when "C"  
                                 when "D"
                                 when "O"
                                    compute takas3-comp-tutar-1(2) rounded = 
                                                 takas3-comp-tutar-1(2)  + gelist-oda
                                    compute takas3-comp-tutar-2(2) rounded = 
                                                 takas3-comp-tutar-2(2)  + ( gelist-oda /cev1)
                                    compute takas3-comp-tutar-3(2) rounded = 
                                                 takas3-comp-tutar-3(2)  + ( gelist-oda /cev2)
                                    
                                 when other
                                    compute takas3-ucr-tutar-1(2) rounded = 
                                                 takas3-ucr-tutar-1(2)  + gelist-oda
                                    compute takas3-ucr-tutar-2(2) rounded = 
                                                 takas3-ucr-tutar-2(2)  + ( gelist-oda / cev1 )
                                    compute takas3-ucr-tutar-3(2) rounded = 
                                                 takas3-ucr-tutar-3(2)  + ( gelist-oda / cev2 )
                            end-evaluate

                            compute takas3-oda-tutar-1(2) rounded = 
                                                 takas3-oda-tutar-1(2)  + gelist-oda
                            compute takas3-oda-tutar-2(2) rounded = 
                                                 takas3-oda-tutar-2(2)  + ( gelist-oda / cev1 )
                            compute takas3-oda-tutar-3(2) rounded = 
                                                 takas3-oda-tutar-3(2)  + ( gelist-oda / cev2 )

                            if ikinci-sirkete-gecildi not = 1
                            compute takas3-yiy-tutar-1(2) rounded = 
                                                 takas3-yiy-tutar-1(2)  + gelist-yiy
                            compute takas3-yiy-tutar-2(2) rounded = 
                                                 takas3-yiy-tutar-2(2)  + (gelist-yiy / cev1 )
                            compute takas3-yiy-tutar-3(2) rounded = 
                                                 takas3-yiy-tutar-3(2)  + (gelist-yiy / cev2 )
                                                 
                                                 
                             compute takas3-ice-tutar-1(2) rounded = 
                                                 takas3-ice-tutar-1(2)  + gelist-ice
                             compute takas3-ice-tutar-2(2) rounded = 
                                                 takas3-ice-tutar-2(2)  + (gelist-ice / cev1 )
                             compute takas3-ice-tutar-3(2) rounded = 
                                                 takas3-ice-tutar-3(2)  + (gelist-ice / cev2 )

                             compute takas3-dig-tutar-1(2) rounded = 
                                                 takas3-dig-tutar-1(2)  + gelist-dig
                             compute takas3-dig-tutar-2(2) rounded = 
                                                 takas3-dig-tutar-2(2)  + (gelist-dig / cev1 )
                             compute takas3-dig-tutar-3(2) rounded = 
                                                 takas3-dig-tutar-3(2)  + (gelist-dig / cev2 )
                             end-if 
                          end-if
                          if  gelist-yil = son-yil then
                                evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-tutar-1(3) rounded = 
                                                 takas3-hous-tutar-1(3)  + gelist-oda
                                    compute takas3-hous-tutar-2(3) rounded = 
                                                 takas3-hous-tutar-2(3)  + ( gelist-oda /cev1)
                                    compute takas3-hous-tutar-3(3) rounded = 
                                                 takas3-hous-tutar-3(3)  + ( gelist-oda /cev2)
                                 when "C"  
                                 when "D"
                                 when "O"
                                    compute takas3-comp-tutar-1(3) rounded = 
                                                 takas3-comp-tutar-1(3)  + gelist-oda
                                    compute takas3-comp-tutar-2(3) rounded = 
                                                 takas3-comp-tutar-2(3)  + ( gelist-oda /cev1)
                                    compute takas3-comp-tutar-3(3) rounded = 
                                                 takas3-comp-tutar-3(3)  + ( gelist-oda /cev2)
                                    
                                 when other
                                    compute takas3-ucr-tutar-1(3) rounded = 
                                                 takas3-ucr-tutar-1(3)  + gelist-oda
                                    compute takas3-ucr-tutar-2(3) rounded = 
                                                 takas3-ucr-tutar-2(3)  + ( gelist-oda / cev1 )
                                    compute takas3-ucr-tutar-3(3) rounded = 
                                                 takas3-ucr-tutar-3(3)  + ( gelist-oda / cev2 )
                            end-evaluate
                            compute takas3-oda-tutar-1(3) rounded = 
                                                 takas3-oda-tutar-1(3)  + gelist-oda
                            compute takas3-oda-tutar-2(3) rounded = 
                                                 takas3-oda-tutar-2(3)  + ( gelist-oda / cev1 )
                            compute takas3-oda-tutar-3(3) rounded = 
                                                 takas3-oda-tutar-3(3)  + ( gelist-oda / cev2 )
                            if ikinci-sirkete-gecildi not = 1
                            compute takas3-yiy-tutar-1(3) rounded = 
                                                 takas3-yiy-tutar-1(3)  + gelist-yiy
                            compute takas3-yiy-tutar-2(3) rounded = 
                                                 takas3-yiy-tutar-2(3)  + (gelist-yiy / cev1 )
                            compute takas3-yiy-tutar-3(3) rounded = 
                                                 takas3-yiy-tutar-3(3)  + (gelist-yiy / cev2 )
                                                 
                                                 
                             compute takas3-ice-tutar-1(3) rounded = 
                                                 takas3-ice-tutar-1(3)  + gelist-ice
                             compute takas3-ice-tutar-2(3) rounded = 
                                                 takas3-ice-tutar-2(3)  + (gelist-ice / cev1 )
                             compute takas3-ice-tutar-3(3) rounded = 
                                                 takas3-ice-tutar-3(3)  + (gelist-ice / cev2 )

                             compute takas3-dig-tutar-1(3) rounded = 
                                                 takas3-dig-tutar-1(3)  + gelist-dig
                             compute takas3-dig-tutar-2(3) rounded = 
                                                 takas3-dig-tutar-2(3)  + (gelist-dig / cev1 )
                             compute takas3-dig-tutar-3(3) rounded = 
                                                 takas3-dig-tutar-3(3)  + (gelist-dig / cev2 ) 
                             end-if 
                          end-if
                          
                   end-if
              end-read
          end-perform,
    end-start.
*
 kaydet.
    rewrite takas6-rec invalid 
            write takas6-rec invalid continue
            end-write
    end-rewrite.
*
 takas7-doldur.
       perform peryot-fiyat-bul.

*
 gun-sayisi-bul.
      initialize g-bul-gun-sayisi
                takvim2-rec 
     move rez-gir-tar   to takvim2-anah
     start takvim2 key not < takvim2-anah
           invalid
                move 1 to g-bul-gun-sayisi
     not invalid
     initialize fs-takvim2
     perform with test after until fs-takvim2 = "10"
     read takvim2 next no lock end move "10" to fs-takvim2
     not at end
          if takvim2-anah = rez-cik-tar
             move "10" to fs-takvim2
             exit perform cycle
          end-if
          if takvim2-anah not > rez-cik-tar
             add 1 to g-bul-gun-sayisi
          else
             move "10" to fs-takvim2
          end-if
     end-read
     end-perform
     end-start.

*
 Form2-Ex-Other.
       evaluate key-status
          when 2 
            set exit-pushed to true
       end-evaluate
     .
*
 Form2-Bef-Create.
     .
*
 Form1-Ef-1-Aft-Procedure.
          open input kur doviz 
         move butce-cev-doviz to DOVIZ-KODU
         read doviz no lock invalid
            display message box  "Tanimsiz Doviz Girdiniz"
            move "Tanimsiz " to d-kisa-adi
         end-read
         move  d-kisa-adi to kur-adi

        move ilk-tarih to kur-tarih
        move "87" to kur-banka
        move doviz-kodu to kur-doviz
           read kur no lock invalid
                move 1 to merkez
                display Form1-Cb-1
                move "01" to kur-banka
                read kur no lock invalid
                  move 1 to doviz-alis
                end-read
            end-read
           move doviz-alis to cevrim-kuru
         display kdov adov 
        close kur doviz
     .

*
 Form1-Ef-2-Aft-Procedure.
          open input kur doviz 
         move butce-cev-doviz2 to DOVIZ-KODU
         read doviz no lock invalid
            display message box  "Tanimsiz Doviz Girdiniz"
            move "Tanimsiz " to d-kisa-adi
         end-read
         move  d-kisa-adi to kur-adi2

        move ilk-tarih to kur-tarih
        move "87" to kur-banka
        move doviz-kodu to kur-doviz
           read kur no lock invalid
                move 1 to merkez
                display Form1-Cb-1
                move "01" to kur-banka
                read kur no lock invalid
                  move 1 to doviz-alis
                end-read
            end-read
           move doviz-alis to cevrim-kuru
         display kdova adova 
        close kur doviz
     .


 forecast-bul.
*      open output trnot
      initialize ilerisi
      move ilk-tarih to takvim-anah
      start takvim key >= takvim-anah invalid 
             continue
      not invalid
          perform until fs-takvim = "10"
              read takvim next no lock 
                 end move "10" to fs-takvim
                 not end
                   if takvim-anah < son-tarih
                             if takvim-anah = son-tarih
                              add  TAKVIM-HAZIR-ODA  to takas3-hazir(1)
                              add takvim-hazir-yatak to takas3-hazir-yatak(1)
                             end-if
                           if takvim-ay = son-ay   and takvim-yil = son-yil
                             add  TAKVIM-HAZIR-ODA  to takas3-hazir(2)
                                   add takvim-hazir-yatak   to takas3-hazir-yatak(2)
                       
                           end-if
                           if takvim-yil = son-yil   
                             add  TAKVIM-HAZIR-ODA  to takas3-hazir(3)
                             add takvim-hazir-yatak   to takas3-hazir-yatak(3)                       
                           end-if
                     perform gece-bul
                   else
****************************ileriya dogru
                       if ilerisi = 0
                             if takvim-anah = son-tarih
                              add  TAKVIM-HAZIR-ODA  to takas3-hazir(1)
                              add takvim-hazir-yatak to takas3-hazir-yatak(1)
                             end-if
                           if takvim-ay = son-ay   and takvim-yil = son-yil
                             add  TAKVIM-HAZIR-ODA  to takas3-hazir(2)
                                   add takvim-hazir-yatak   to takas3-hazir-yatak(2)
                       
                           end-if
                           if takvim-yil = son-yil   
                             add  TAKVIM-HAZIR-ODA  to takas3-hazir(3)
                             add takvim-hazir-yatak   to takas3-hazir-yatak(3)                       
                           end-if
                           perform gece-bul
                       end-if 

                       add 1 to ilerisi
                       if ilerisi < 8 then
                          perform bilbord-al
                          move takvim-ay  to e-ay
                          move takvim-yil to e-yil
                          move takvim-gun to e-gun
                          move e-tarih    to for-tarih(ilerisi)
                          move takvim-hazir-oda to for-hazir(ilerisi)
                           perform igece-bul
                           compute for-doluluk(ilerisi) = for-oda(ilerisi) + for-forecast(ilerisi)
                           compute for-yuzde(ilerisi) rounded  =  for-doluluk(ilerisi) / for-hazir(ilerisi) * 100
                           compute for-netdolu(ilerisi) = for-doluluk(ilerisi)  - for-birles(ilerisi)
                           compute for-netyuzde(ilerisi) rounded  =  for-netdolu(ilerisi) / for-hazir(ilerisi) * 100
                          





                           else
                          move "10" to fs-takvim
                        end-if


                      
                   end-if

                end-read
          end-perform
     end-start   .
*     close trnot.
*****************************************
 bilbord-al.
    initialize bilbord-rec son-acenta acenta-bilb
    move takvim-anah to bilbord-tarih 
    start bilbord key > bilbord-anah2 invalid continue
      not invalid
       perform until fs-bilbord = "10"
           read bilbord next no lock
             end move "10" to fs-bilbord
              not end
                if son-acenta  = spaces 
                   move bilbord-acenta to son-acenta 
                end-if
                if  son-acenta not = bilbord-acenta
                   if acenta-bilb > 0 then
                       compute for-forecast(ilerisi) = 
                          for-forecast(ilerisi) + acenta-bilb

                    end-if
                    initialize acenta-bilb
                    move bilbord-acenta to son-acenta
                end-if
              if bilbord-tarih  = takvim-anah 
               if  bilbord-oda not = bilbord-sat-oda
              compute acenta-bilb =  acenta-bilb +
                 bilbord-oda - bilbord-sat-oda
               end-if
                else
                move "10" to fs-bilbord
               end-if 
           end-read
       end-perform
    end-start
              if  son-acenta not = bilbord-acenta
                   if acenta-bilb > 0 then
                       compute for-forecast(ilerisi) = 
                          for-forecast(ilerisi) + acenta-bilb

                    end-if
                    initialize acenta-bilb
                    move bilbord-acenta to son-acenta
                end-if


    .

 gece-bul.
     initialize cast-rec var-yok.
    move takvim-anah to cast-tarih.
    start cast key not < cast-tarih invalid continue
      not invalid
        perform with test after until var
          read cast next no lock end move "V" to var-yok
            not end
              if cast-tarih > takvim-anah
                        move "V" to var-yok
               else
                        initialize rez-rec
                        move cast-rez-no to rez-no
                        read rez no lock invalid continue
                          not invalid
                                if rez-durumu not = "I"
                                     exit perform cycle,
                                 end-if
                            if filtre-var = 1 then 
                               perform filtre
                               if filtre-gecti not = 1 then 
                                     exit perform cycle 
                               end-if
                            end-if
                                 if ONKPARA-REFERANS-VAR = 1
                                       perform  sifir-coz
                                        if xkonum-ref(cast-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(cast-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         continue
                                 else
                                        perform gece-bul2
                                 end-if
                             else
                                 perform gece-bul2
                            end-if
                        end-read
              end-if
          end-read
        end-perform
    end-start.
 
*
 gece-bul2.
        
     
           
        
          move "B" to kodlar02-tipi
          move rez-odeme-tipi to kodlar02-kodu
          read kodlar02 no lock invalid 
              move spaces to kodlar02-adi
          end-read

*** Grup Filtresi
   
     move 1 to eklenecek-oda
    if rezpara-trace = 1
      move cast-oda-no to rez-odano
      move cast-fiyat-konumu to rez-fiyat-konumu
      move cast-oda-konumu to rez-oda-konumu
       if rez-kisi not = cast-kisi
          move cast-kisi to rez-kisi
       
       end-if
          move cast-share to rez-share
       if rez-share = 1 then 
             move 0 to eklenecek-oda 
            else
              move 1 to eklenecek-oda
       end-if
      else 
          move 1 to eklenecek-oda
    end-if
    if rez-odano not = spaces and 
       ( hayali-haric = 1 or dis-haric = 1 ) then 
              move rez-odano to odalar-anah
              read odalar no lock invalid continue
              not invalid
              if ( odalar-hayali = "H" and hayali-haric = 1 )  then
                       move 0 to eklenecek-oda
              end-if
               if ( dis-haric = 1 and odalar-dis = 1 )  then
                           exit paragraph
              end-if 
              end-read
    end-if  

     if cast-tarih = rez-cik-tar  and
          cast-tarih = son-tarih then 
           add eklenecek-oda to bugun-cout-oda
            



           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               bugun-cout-kisi

          if cast-tarih = rez-gir-tar then
           
               add eklenecek-oda to bugun-dayuse-oda

               add rez-buyuk rez-kucuk rez-free rez-bebek  to bugun-dayuse-kisi
          end-if

    end-if
    if cast-tarih >= rez-cik-tar
          exit paragraph
    end-if
      if cast-tarih = rez-gir-tar  and
          cast-tarih = son-tarih then 
           add eklenecek-oda to bugun-cin-oda 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               bugun-cin-kisi
    end-if
    
    
     
     evaluate ychild(1:1)
       when 0
        compute geceleme = rez-buyuk
       when 1 
        compute geceleme = rez-buyuk + ( rez-kucuk / 2 )
            initialize rez-kucuk     
       when 2 
           compute geceleme = rez-buyuk +  rez-kucuk  + rez-free
           initialize rez-kucuk   rez-free  
       when 3
         compute geceleme = rez-buyuk +  rez-kucuk  + rez-free + rez-bebek
          initialize rez-kucuk   rez-free  rez-bebek
       when 4
          compute geceleme = rez-buyuk +  rez-kucuk
           initialize rez-kucuk
       when other
            compute geceleme = rez-buyuk + ( rez-kucuk / 2 ) 
            initialize rez-kucuk
      end-evaluate


      

          if cast-tarih = son-tarih
                   if eklenecek-oda = 1 
                     evaluate rez-buyuk
                         when 1
                             add 1 to t-single(1)
                         when 2
                             add 1 to t-double(1)
                         when 3 when 4   when 5 when 6  when 7 when 8    when 9
                             add 1 to t-triple(1)

                     end-evaluate
                    end-if
                    
                            evaluate ode-tipi

                                 when "F"
                                    compute takas3-hous-oda(1) rounded = 
                                                 takas3-hous-oda(1)  + eklenecek-oda
                                    compute takas3-hous-pax(1) rounded = 
                                                 takas3-hous-pax(1)  + geceleme

                                    compute takas3-hous-chi(1) rounded = 
                                                 takas3-hous-chi(1)  + rez-kucuk
                                    compute takas3-hous-free(1) rounded = 
                                                 takas3-hous-free(1)  + rez-free
                                    compute takas3-hous-bebek(1) rounded = 
                                                 takas3-hous-bebek(1)  + rez-bebek
                                    
                                 when "C"      
                                 when "D"
                                 when "O"
                                    compute takas3-comp-oda(1) rounded = 
                                                 takas3-comp-oda(1)  + eklenecek-oda
                                    compute takas3-comp-pax(1) rounded = 
                                                 takas3-comp-pax(1)  + geceleme

                                    compute takas3-comp-chi(1) rounded = 
                                                 takas3-comp-chi(1)  + rez-kucuk
                                    compute takas3-comp-free(1) rounded = 
                                                 takas3-comp-free(1)  + rez-free
                                    compute takas3-comp-bebek(1) rounded = 
                                                 takas3-comp-bebek(1)  + rez-bebek

                                    
                                 when other
                                     compute takas3-ucr-oda(1) rounded = 
                                                 takas3-ucr-oda(1)  + eklenecek-oda
                                    compute takas3-ucr-pax(1) rounded = 
                                                 takas3-ucr-pax(1)  + geceleme
                                    compute takas3-ucr-chi(1) rounded = 
                                                 takas3-ucr-chi(1)  + rez-kucuk
                                    compute takas3-ucr-free(1) rounded = 
                                                 takas3-ucr-free(1)  + rez-free
                                    compute takas3-ucr-bebek(1) rounded = 
                                                 takas3-ucr-bebek(1)  + rez-bebek

                            end-evaluate
                            compute takas3-oda(1) rounded = 
                                                 takas3-oda(1)  + eklenecek-oda
                            
                            compute takas3-pax(1) rounded = 
                                                 takas3-pax(1)  + geceleme
                            
                            compute takas3-chi(1) rounded = 
                                                 takas3-chi(1)  + rez-kucuk
                            compute takas3-fre(1) rounded = 
                                                 takas3-fre(1)  + rez-free 
                                                 
                            compute takas3-bebek(1) rounded = 
                                                 takas3-bebek(1)  + rez-bebek 

                                                 

                             if rez-vip  not = " " and rez-vip  not = "N"
                               add 1        to takas3-vip-oda(1)
                               add geceleme to takas3-vip-pax(1)
                             end-if
                          end-if
********************************AYLIK

                          if cast-ay = son-ay and cast-yil = son-yil then
                          if eklenecek-oda = 1 
                     
                     
                     evaluate rez-buyuk
                         when 1
                             add 1 to t-single(2)
                         when 2
                             add 1 to t-double(2)
                         when 3 when 4   when 5 when 6  when 7 when 8    when 9
                             add 1 to t-triple(2)

                     end-evaluate
                    end-if


                                 evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-oda(2) rounded = 
                                                 takas3-hous-oda(2)  + eklenecek-oda
                                    compute takas3-hous-pax(2) rounded = 
                                                 takas3-hous-pax(2)  + geceleme 

                                    compute takas3-hous-chi(2) rounded = 
                                                 takas3-hous-chi(2)  + rez-kucuk
                                    compute takas3-hous-free(2) rounded = 
                                                 takas3-hous-free(2)  + rez-free 
                                    compute takas3-hous-bebek(2) rounded = 
                                                 takas3-hous-bebek(2)  + rez-bebek 
                                    
                                 when "C"   when "D"
                                 when "O"
                                    compute takas3-comp-oda(2) rounded = 
                                                 takas3-comp-oda(2)  + eklenecek-oda
                                    compute takas3-comp-pax(2) rounded = 
                                                 takas3-comp-pax(2)  + geceleme
                                    
                                    compute takas3-comp-chi(2) rounded = 
                                                 takas3-comp-chi(2)  + rez-kucuk
                                    compute takas3-comp-free(2) rounded = 
                                                 takas3-comp-free(2)  + rez-free
                                    compute takas3-comp-bebek(2) rounded = 
                                                 takas3-comp-bebek(2)  + rez-bebek

                                 when other
                                     compute takas3-ucr-oda(2) rounded = 
                                                 takas3-ucr-oda(2)  + eklenecek-oda
                                    compute takas3-ucr-pax(2) rounded = 
                                                 takas3-ucr-pax(2)  + geceleme
                                    compute takas3-ucr-chi(2) rounded = 
                                                 takas3-ucr-chi(2)  + rez-kucuk
                                    compute takas3-ucr-free(2) rounded = 
                                                 takas3-ucr-free(2)  + rez-free
                                    compute takas3-ucr-bebek(2) rounded = 
                                                 takas3-ucr-bebek(2)  + rez-bebek

                            end-evaluate
                            compute takas3-oda(2) rounded = 
                                                 takas3-oda(2)  + eklenecek-oda
                            
                            compute takas3-pax(2) rounded = 
                                                 takas3-pax(2)  + geceleme
                            
                            compute takas3-chi(2) rounded = 
                                                 takas3-chi(2)  + rez-kucuk
                            compute takas3-fre(2) rounded = 
                                                 takas3-fre(2)  + rez-free 
                                                 
                            compute takas3-bebek(2) rounded = 
                                                 takas3-bebek(2)  + rez-bebek 
                                                 
                                                 

                            if rez-vip not = " " and rez-vip  not = "N"
                               add 1        to takas3-vip-oda(2)
                               add geceleme to takas3-vip-pax(2)
                             end-if

                          end-if
                          if  cast-yil = son-yil then
                                if eklenecek-oda = 1 
                     evaluate rez-buyuk
                         when 1
                             add 1 to t-single(3)
                         when 2
                             add 1 to t-double(3)
                         when 3 when 4   when 5 when 6  when 7 when 8    when 9
                             add 1 to t-triple(3)

                     end-evaluate
                    end-if
                                       evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-oda(3) rounded = 
                                                 takas3-hous-oda(3)  + eklenecek-oda
                                    compute takas3-hous-pax(3) rounded = 
                                                 takas3-hous-pax(3)  + geceleme
                                    

                                    compute takas3-hous-chi(3) rounded = 
                                                 takas3-hous-chi(3)  + rez-kucuk
                                    compute takas3-hous-free(3) rounded = 
                                                 takas3-hous-free(3)  + rez-free
                                    compute takas3-hous-bebek(3) rounded = 
                                                 takas3-hous-bebek(3)  + rez-bebek
                                 when "C"      when "D"
                                 when "O"
                                    compute takas3-comp-oda(3) rounded = 
                                                 takas3-comp-oda(3)  + eklenecek-oda
                                    compute takas3-comp-pax(3) rounded = 
                                                 takas3-comp-pax(3)  + geceleme
                                    
                                    compute takas3-comp-chi(3) rounded = 
                                                 takas3-comp-chi(3)  + rez-kucuk
                                    compute takas3-comp-free(3) rounded = 
                                                 takas3-comp-free(3)  + rez-free
                                    compute takas3-comp-bebek(3) rounded = 
                                                 takas3-comp-bebek(3)  + rez-bebek

                                 when other
                                     compute takas3-ucr-oda(3) rounded = 
                                                 takas3-ucr-oda(3)  + eklenecek-oda
                                    compute takas3-ucr-pax(3) rounded = 
                                                 takas3-ucr-pax(3)  + geceleme

                                    compute takas3-ucr-chi(3) rounded = 
                                                 takas3-ucr-chi(3)  + rez-kucuk
                                    compute takas3-ucr-free(3) rounded = 
                                                 takas3-ucr-free(3)  + rez-free
                                    compute takas3-ucr-bebek(3) rounded = 
                                                 takas3-ucr-bebek(3)  + rez-bebek

                            end-evaluate
                            compute takas3-oda(3) rounded = 
                                                 takas3-oda(3)  + eklenecek-oda
*                                  if takvim-anah = "20100425" then 
*                                  initialize trnot-rec
*                                     move rez-no to trnot-rec
*                                     move rez-buyuk to   trnot-rec(15:)
*                                     write trnot-rec end-write
*                                  end-if
 
                            compute takas3-pax(3) rounded = 
                                                 takas3-pax(3)  + geceleme
                            
                             compute takas3-chi(3) rounded = 
                                                 takas3-chi(3)  + rez-kucuk
                            compute takas3-fre(3) rounded = 
                                                 takas3-fre(3)  + rez-free  
                                                 
                            compute takas3-bebek(3) rounded = 
                                                 takas3-bebek(3)  + rez-bebek  
                                                 
                                                 

                            if rez-vip not = " " and rez-vip  not = "N"
                               add 1        to takas3-vip-oda(3)
                               add geceleme to takas3-vip-pax(3)
                             end-if
                          end-if

              .
   
*****************************************
 igece-bul.
     
    initialize cast-rec var-yok.
    move takvim-anah to cast-tarih.
    start cast key not < cast-tarih invalid continue
      not invalid
        perform with test after until var
          read cast next no lock end move "V" to var-yok
            not end
              if cast-tarih > takvim-anah
                move "V" to var-yok
               else
                initialize rez-rec
                move cast-rez-no to rez-no
                read rez no lock invalid continue
                  not invalid
                          if rez-durumu not = "I"
                             exit perform cycle,         
                          end-if

                            if filtre-var = 1 then 
                               perform filtre
                               if filtre-gecti not = 1 then 
                                     exit perform cycle 
                               end-if
                            end-if

                            
                             if ONKPARA-REFERANS-VAR = 1
                                       perform  sifir-coz
                                        if xkonum-ref(cast-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(cast-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         continue
                                 else
                                perform igece-bul2
                             end-if
                            else
                                 perform igece-bul2
                         end-if

                    
                end-read
              end-if
          end-read
        end-perform
    end-start.
 
*
 igece-bul2.
        
     move 1 to eklenecek-oda
    if rezpara-trace = 1
      move cast-oda-no to rez-odano
      move cast-fiyat-konumu to rez-fiyat-konumu
      move cast-oda-konumu to rez-oda-konumu

       if rez-kisi not = cast-kisi
          move cast-kisi to rez-kisi
     
       end-if
            move cast-share to  rez-share
       if rez-share = 1 then 
             move 0 to eklenecek-oda 
            else

              move 1 to eklenecek-oda
          end-if
      else 
          move 1 to eklenecek-oda
    end-if

     if rez-odano not = spaces and 
       ( hayali-haric = 1 or dis-haric = 1 ) then 
              move rez-odano to odalar-anah
              read odalar no lock invalid continue
              not invalid
              if ( odalar-hayali = "H" and hayali-haric = 1 )  then
                       move 0 to eklenecek-oda
              end-if
               if ( dis-haric = 1 and odalar-dis = 1 )  then
                         exit paragraph
              end-if 
              end-read
    end-if  

     if cast-tarih = rez-cik-tar  
          then 
           add eklenecek-oda to for-coutoda(ilerisi) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               for-coutpax(ilerisi)
    end-if
    if cast-tarih >= rez-cik-tar
          exit paragraph
    end-if
      if cast-tarih = rez-gir-tar 
           then 
           add eklenecek-oda to for-cinoda(ilerisi) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               for-cinpax(ilerisi)
    end-if
    
        add eklenecek-oda to for-oda(ilerisi)
        add rez-buyuk  to for-pax(ilerisi)
        add rez-kucuk  to for-chi(ilerisi)
        add rez-free   to for-fre(ilerisi)
        add rez-bebek  to for-beb(ilerisi)
       move cast-oda-no to odalar-anah
        read odalar no lock invalid
          continue
          not invalid
          if odalar-hayali = "H" then
            add eklenecek-oda  to for-birles(ilerisi)
          end-if
       end-read
            .
*
  sifir-coz.
       if rez-oda-konumu = 0 then move 1 to rez-oda-konumu end-if
       if konuk-oda-konumu = 0 then move  rez-oda-konumu to konuk-oda-konumu end-if
       if konuk-oda-konumu = 0 then move 1 to konuk-oda-konumu end-if

        if cast-oda-konumu = 0 then move  rez-oda-konumu to cast-oda-konumu end-if
       if cast-oda-konumu  = 0 then move 1 to cast-oda-konumu end-if

        if rez-fiyat-konumu = 0 then move 1 to rez-fiyat-konumu end-if
       if konuk-fiyat-konumu = 0 then move  rez-fiyat-konumu to konuk-fiyat-konumu end-if
       if konuk-fiyat-konumu = 0 then move 1 to konuk-fiyat-konumu end-if

       if cast-fiyat-konumu = 0 then move  rez-fiyat-konumu to cast-fiyat-konumu end-if
       if cast-fiyat-konumu  = 0 then move 1 to cast-fiyat-konumu end-if

        .
 

*/**************************************************************************************************
*
 satisa-hazir-oda-bul.
     initialize xy 
     compute xy = tmp-satir + 5

     move "Satisa Hazir Oda"  to det11-baslik
     open input takvim

     initialize takvim-rec  tum-sayisal 
     move son-tarih to takvim-anah
     start takvim key not < takvim-anah invalid 
          continue 
     not invalid 
     perform until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end 
         if takvim-anah <> son-tarih
            exit perform 
         end-if 
         if takvim-anah = son-tarih
             add takvim-ref-hazir-yatak(1) to tmp-rs-gun(xy) tmp-ts-gun(xy)
             add takvim-ref-hazir-oda(1)   to tr-hazir-oda-bugun
            move takvim-ref-hazir-oda(1)   to zhazir-oda
            move zhazir-oda                to det11-rbugun  

             add takvim-ref-hazir-yatak(2) to tmp-hs-gun(xy) tmp-ts-gun(xy)
             add takvim-ref-hazir-oda(2)   to th-hazir-oda-bugun 
            move takvim-ref-hazir-oda(2)   to zhazir-oda
            move zhazir-oda                to det11-hbugun  
         end-if 
     end-read 
     end-perform
     end-start

     initialize takvim-rec 
     move son-tarih to takvim-anah
     move 1         to takvim-gun
     start takvim key not < takvim-anah invalid 
          continue 
     not invalid 
     perform until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end 
         if takvim-anah > son-tarih
            exit perform 
         end-if 
         add takvim-ref-hazir-yatak(1) to tmp-rs-ay(xy) tmp-ts-ay(xy)
         add takvim-ref-hazir-oda(1)   to tr-hazir-oda  tr-hazir-oda-buay
         move tr-hazir-oda-buay        to zhazir-oda
         move zhazir-oda               to det11-rbuay 
 
         add takvim-ref-hazir-yatak(2) to tmp-hs-ay(xy) tmp-ts-ay(xy)
         add takvim-ref-hazir-oda(2)   to th-hazir-oda th-hazir-oda-buay
         move th-hazir-oda-buay         to zhazir-oda
         move zhazir-oda               to det11-hbuay 
               
     end-read 
     end-perform
     end-start

     initialize takvim-rec  tr-hazir-oda th-hazir-oda
     move son-tarih to takvim-anah
     move 1         to takvim-gun
     move 1         to takvim-ay
     start takvim key not < takvim-anah invalid 
          continue 
     not invalid 
     perform until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end 
         if takvim-anah > son-tarih
            exit perform 
         end-if 
         add takvim-ref-hazir-yatak(1) to tmp-rs-yil(xy) tmp-ts-yil(xy)
         add takvim-ref-hazir-oda(1)   to tr-hazir-oda  tr-hazir-oda-buyil
         move tr-hazir-oda-buyil       to zhazir-oda
         move zhazir-oda               to det11-rbuyil 
 
         add takvim-ref-hazir-yatak(2) to tmp-hs-yil(xy) tmp-ts-yil(xy)
         add takvim-ref-hazir-oda(2)   to th-hazir-oda  th-hazir-oda-buyil
         move th-hazir-oda-buyil       to zhazir-oda
         move zhazir-oda               to det11-hbuyil 
         
     end-read 
     end-perform
     end-start
     compute tt-hazir-oda-bugun = tr-hazir-oda-bugun + th-hazir-oda-bugun 
     compute tt-hazir-oda-buay  = tr-hazir-oda-buay  + th-hazir-oda-buay 
     compute tt-hazir-oda-buyil = tr-hazir-oda-buyil + th-hazir-oda-buyil 
     
*/*****************************************gecen sene*******************************

     move gecen-sene to son-yil

     initialize takvim-rec  
     move son-tarih  to takvim-anah
    
     start takvim key not < takvim-anah invalid 
          continue 
     not invalid 
     perform until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end 
         if takvim-anah <> son-tarih
            exit perform 
         end-if 
         if takvim-anah = son-tarih
             add takvim-ref-hazir-yatak(1) to tmp-rg-gun(xy) tmp-tg-gun(xy)
             add takvim-ref-hazir-oda(1)   to tr-hazir-oda-gecen-bugun
            move takvim-ref-hazir-oda(1)   to zhazir-oda  
            move zhazir-oda                to det11-gecen-rbugun  

            add takvim-ref-hazir-yatak(2) to tmp-hg-gun(xy) tmp-tg-gun(xy)
            add takvim-ref-hazir-oda(2)   to th-hazir-oda-gecen-bugun
            move takvim-ref-hazir-oda(2)  to zhazir-oda  
            move zhazir-oda               to det11-gecen-hbugun  
         end-if 
     end-read 
     end-perform
     end-start

     initialize takvim-rec 
     move son-tarih to takvim-anah
     move 1         to takvim-gun
     

     start takvim key not < takvim-anah invalid 
          continue 
     not invalid 
     perform until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end 
         if takvim-anah > son-tarih
            exit perform 
         end-if 
          add takvim-ref-hazir-yatak(1) to tmp-rg-ay(xy) tmp-tg-ay(xy)
          add takvim-ref-hazir-oda(1)   to tr-hazir-oda  tr-hazir-oda-gecen-buay
         move tr-hazir-oda-gecen-buay   to zhazir-oda
         move zhazir-oda                to det11-gecen-rbuay 
 
          add takvim-ref-hazir-yatak(2) to tmp-hg-ay(xy) tmp-tg-ay(xy)
          add takvim-ref-hazir-oda(2)   to th-hazir-oda  th-hazir-oda-gecen-buay
         move th-hazir-oda-gecen-buay   to zhazir-oda
         move zhazir-oda                to det11-gecen-hbuay 
               
     end-read 
     end-perform
     end-start

     initialize takvim-rec  tr-hazir-oda th-hazir-oda
     move son-tarih to takvim-anah
     move 1         to takvim-gun
     move 1         to takvim-ay
    

     start takvim key not < takvim-anah invalid 
          continue 
     not invalid 
     perform until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end 
         if takvim-anah > son-tarih
            exit perform 
         end-if 
         add takvim-ref-hazir-yatak(1) to tmp-rg-yil(xy) tmp-tg-yil(xy)
         add takvim-ref-hazir-oda(1)   to tr-hazir-oda  tr-hazir-oda-gecen-buyil
         move tr-hazir-oda-gecen-buyil to zhazir-oda
         move zhazir-oda               to det11-gecen-rbuyil 
 
         add takvim-ref-hazir-yatak(2) to tmp-hg-yil(xy) tmp-tg-yil(xy)
         add takvim-ref-hazir-oda(2)   to th-hazir-oda   th-hazir-oda-gecen-buyil
         move th-hazir-oda-gecen-buyil to zhazir-oda
         move zhazir-oda               to det11-gecen-hbuyil 
            
     end-read 
     end-perform
     end-start

     move orj-yil to son-yil
     close takvim

     compute tt-hazir-oda-gecen-bugun = tr-hazir-oda-gecen-bugun + th-hazir-oda-gecen-bugun 
     compute tt-hazir-oda-gecen-buay  = tr-hazir-oda-gecen-buay  + th-hazir-oda-gecen-buay 
     compute tt-hazir-oda-gecen-buyil = tr-hazir-oda-gecen-buyil + th-hazir-oda-gecen-buyil
     
     move tt-hazir-oda-bugun to zhazir-oda
     move zhazir-oda   to det11-tbugun 
     move tt-hazir-oda-buay to zhazir-oda
     move zhazir-oda   to det11-tbuay 
     move tt-hazir-oda-buyil to zhazir-oda
     move zhazir-oda   to det11-tbuyil 
     
     move tt-hazir-oda-gecen-bugun to zhazir-oda
     move zhazir-oda   to det11-gecen-tbugun 
     move tt-hazir-oda-gecen-buay to zhazir-oda
     move zhazir-oda   to det11-gecen-tbuay 
     move tt-hazir-oda-gecen-buyil to zhazir-oda
     move zhazir-oda   to det11-gecen-tbuyil 
     
     . 


*
 satilan-bul.
*********************************************************
      
     move 1 to birikiuc
     move son-tarih to ara-tarih
     perform dolu-oda-bul

     move tr-satilan-oda to z6 
     move z6           to det11-rbugun

     move th-satilan-oda to z6 
     move z6           to det11-hbugun

     move tt-satilan-oda to z6 
     move z6           to det11-tbugun

    
********************************************************
     move 1 to ara-gun
     move 2 to birikiuc
     perform dolu-oda-bul

     move tr-satilan-oda to z6 
     move z6           to det11-rbuay

     move th-satilan-oda to z6 
     move z6           to det11-hbuay

     move tt-satilan-oda to z6 
     move z6           to det11-tbuay
     
************************************************************
     move 1 to ara-gun
     move 1 to ara-ay
     move 3 to birikiuc
     perform dolu-oda-bul
     
     move tr-satilan-oda to z6 
     move z6           to det11-rbuyil

     move th-satilan-oda to z6 
     move z6           to det11-hbuyil

     move tt-satilan-oda to z6 
     move z6           to det11-tbuyil
     
*********************************************************
     move 1 to birikiuc
     move gecen-sene to son-yil
     move son-tarih to ara-tarih
     perform dolu-oda-bul

     move tr-satilan-oda to z6 
     move z6           to det11-gecen-rbugun

     move th-satilan-oda to z6 
     move z6           to det11-gecen-hbugun

     move tt-satilan-oda to z6 
     move z6           to det11-gecen-tbugun

    
********************************************************
     move 1 to ara-gun
     move 2 to birikiuc
     perform dolu-oda-bul

     move tr-satilan-oda to z6 
     move z6           to det11-gecen-rbuay

     move th-satilan-oda to z6 
     move z6           to det11-gecen-hbuay

     move tt-satilan-oda to z6 
     move z6           to det11-gecen-tbuay
     
************************************************************
     move 1 to ara-gun
     move 1 to ara-ay
     move 3 to birikiuc
     perform dolu-oda-bul
     
     move tr-satilan-oda to z6 
     move z6           to det11-gecen-rbuyil

     move th-satilan-oda to z6 
     move z6           to det11-gecen-hbuyil

     move tt-satilan-oda to z6 
     move z6           to det11-gecen-tbuyil
     
     
     move orj-yil to son-yil
     .
     
*
 oda-doluluk-yuzde.
     initialize xz xy 

     compute xz = tmp-satir - 4
     compute xy = tmp-satir - 2

     move "Oda Doluluk %"  to det11-baslik

     if tmp-rs-gun(xz) > 0
        compute tmp-rs-gun(xy) = tmp-rs-gun(xy - 1) + tmp-rs-gun(xy - 2) 
        compute tmp-rs-gun(xy) = tmp-rs-gun(xy) * 100 
        compute tmp-rs-gun(xy) = tmp-rs-gun(xy) / tmp-rs-gun(xz) 
        move tmp-rs-gun(xy)         to z-yuzde 
        move z-yuzde               to det11-rbugun
     else
        initialize tmp-rs-gun(xy) 
        move tmp-rs-gun(xy)         to z-yuzde 
        move z-yuzde               to det11-rbugun
     end-if

     if tmp-hs-gun(xz) > 0
        compute tmp-hs-gun(xy) = tmp-hs-gun(xy - 1) + tmp-hs-gun(xy - 2) 
        compute tmp-hs-gun(xy) = tmp-hs-gun(xy) * 100 
        compute tmp-hs-gun(xy) = tmp-hs-gun(xy) / tmp-hs-gun(xz) 
        move tmp-rs-gun(xy)         to z-yuzde 
        move z-yuzde               to det11-hbugun
     else
        initialize tmp-hs-gun(xy) 
        move tmp-hs-gun(xy)         to z-yuzde 
        move z-yuzde               to det11-hbugun
     end-if

     if tmp-ts-gun(xz) > 0
        compute tmp-ts-gun(xy) = tmp-ts-gun(xy - 1) + tmp-ts-gun(xy - 2) 
        compute tmp-ts-gun(xy) = tmp-ts-gun(xy) * 100 
        compute tmp-ts-gun(xy) = tmp-ts-gun(xy) / tmp-ts-gun(xz) 
        move tmp-ts-gun(xy)         to z-yuzde 
        move z-yuzde               to det11-tbugun
     else
        initialize tmp-ts-gun(xy) 
        move tmp-ts-gun(xy)         to z-yuzde 
        move z-yuzde               to det11-tbugun
     end-if

    
********************************************************

     if tmp-rs-ay(xz) > 0
        compute tmp-rs-ay(xy) = tmp-rs-ay(xy - 1) + tmp-rs-ay(xy - 2) 
        compute tmp-rs-ay(xy) = tmp-rs-ay(xy) * 100 
        compute tmp-rs-ay(xy) = tmp-rs-ay(xy) / tmp-rs-ay(xz) 
        move tmp-rs-ay(xy)         to z-yuzde 
        move z-yuzde              to det11-rbuay
     else
        initialize tmp-ts-gun(xy) 
        move tmp-rs-ay(xy)          to z-yuzde 
        move z-yuzde               to det11-rbuay
     end-if
     if tmp-hs-ay(xz) > 0
        compute tmp-hs-ay(xy) = tmp-hs-ay(xy - 1) + tmp-hs-ay(xy - 2) 
        compute tmp-hs-ay(xy) = tmp-hs-ay(xy) * 100 
        compute tmp-hs-ay(xy) = tmp-hs-ay(xy) / tmp-hs-ay(xz) 
        move tmp-hs-ay(xy)         to z-yuzde 
        move z-yuzde              to det11-hbuay
     else
        initialize tmp-hs-ay(xy) 
        move tmp-hs-ay(xy)         to z-yuzde 
        move z-yuzde              to det11-hbuay
     end-if

     if tmp-ts-ay(xz) > 0
        compute tmp-ts-ay(xy) = tmp-ts-ay(xy - 1) + tmp-ts-ay(xy - 2) 
        compute tmp-ts-ay(xy) = tmp-ts-ay(xy) * 100 
        compute tmp-ts-ay(xy) = tmp-ts-ay(xy) / tmp-ts-ay(xz) 
        move tmp-ts-ay(xy)         to z-yuzde 
        move z-yuzde              to det11-tbuay
     else
        initialize tmp-ts-ay(xy) 
        move tmp-ts-ay(xy)         to z-yuzde 
        move z-yuzde              to det11-tbuay
     end-if
     
************************************************************
     
     if tmp-rs-yil(xz) > 0
        compute tmp-rs-yil(xy) = tmp-rs-yil(xy - 1) + tmp-rs-yil(xy - 2) 
        compute tmp-rs-yil(xy) = tmp-rs-yil(xy) * 100 
        compute tmp-rs-yil(xy) = tmp-rs-yil(xy) / tmp-rs-yil(xz) 
        move tmp-rs-yil(xy)         to z-yuzde 
        move z-yuzde               to det11-rbuyil
     else
        initialize tmp-rs-yil(xy) 
        move tmp-rs-yil(xy)         to z-yuzde 
        move z-yuzde               to det11-rbuyil
     end-if

     if tmp-hs-yil(xz) > 0
        compute tmp-hs-yil(xy) = tmp-hs-yil(xy - 1) + tmp-hs-yil(xy - 2) 
        compute tmp-hs-yil(xy) = tmp-hs-yil(xy) * 100 
        compute tmp-hs-yil(xy) = tmp-hs-yil(xy) / tmp-hs-yil(xz) 
        move tmp-hs-yil(xy)         to z-yuzde 
        move z-yuzde               to det11-hbuyil
     else
        initialize tmp-hs-yil(xy) 
        move tmp-hs-yil(xy)         to z-yuzde 
        move z-yuzde               to det11-hbuyil
     end-if

     if tmp-ts-yil(xz) > 0
        compute tmp-ts-yil(xy) = tmp-ts-yil(xy - 1) + tmp-ts-yil(xy - 2) 
        compute tmp-ts-yil(xy) = tmp-ts-yil(xy) * 100 
        compute tmp-ts-yil(xy) = tmp-ts-yil(xy) / tmp-ts-yil(xz) 
        move tmp-ts-yil(xy)         to z-yuzde 
        move z-yuzde               to det11-tbuyil
     else
        initialize tmp-ts-yil(xy) 
        move tmp-ts-yil(xy)         to z-yuzde 
        move z-yuzde               to det11-tbuyil
     end-if
************************************************************
************************************************************
     if tmp-rg-gun(xz) > 0
        compute tmp-rg-gun(xy) = tmp-rg-gun(xy - 1) + tmp-rg-gun(xy - 2) 
        compute tmp-rg-gun(xy) = tmp-rg-gun(xy) * 100 
        compute tmp-rg-gun(xy) = tmp-rg-gun(xy) / tmp-rg-gun(xz) 
        move tmp-rg-gun(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-rbugun
     else
        initialize tmp-rg-gun(xy) 
        move tmp-rg-gun(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-rbugun
     end-if

     if tmp-hg-gun(xz) > 0
        compute tmp-hg-gun(xy) = tmp-hg-gun(xy - 1) + tmp-hg-gun(xy - 2) 
        compute tmp-hg-gun(xy) = tmp-hg-gun(xy) * 100 
        compute tmp-hg-gun(xy) = tmp-hg-gun(xy) / tmp-hg-gun(xz) 
        move tmp-hg-gun(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-hbugun
     else
        initialize tmp-hg-gun(xy) 
        move tmp-hg-gun(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-hbugun
     end-if

     if tmp-tg-gun(xz) > 0
        compute tmp-tg-gun(xy) = tmp-tg-gun(xy - 1) + tmp-tg-gun(xy - 2) 
        compute tmp-tg-gun(xy) = tmp-tg-gun(xy) * 100 
        compute tmp-tg-gun(xy) = tmp-tg-gun(xy) / tmp-tg-gun(xz) 
        move tmp-tg-gun(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-tbugun
     else
        initialize tmp-tg-gun(xy) 
        move tmp-tg-gun(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-tbugun
     end-if

    
********************************************************

     if tmp-rg-ay(xz) > 0
        compute tmp-rg-ay(xy) = tmp-rg-ay(xy - 1) + tmp-rg-ay(xy - 2) 
        compute tmp-rg-ay(xy) = tmp-rg-ay(xy) * 100 
        compute tmp-rg-ay(xy) = tmp-rg-ay(xy) / tmp-rg-ay(xz) 
        move tmp-rg-ay(xy)         to z-yuzde 
        move z-yuzde              to det11-gecen-rbuay
     else
        initialize tmp-rg-ay(xy) 
        move tmp-rg-ay(xy)          to z-yuzde 
        move z-yuzde               to det11-gecen-rbuay
     end-if

     if tmp-hg-ay(xz) > 0
        compute tmp-hg-ay(xy) = tmp-hg-ay(xy - 1) + tmp-hg-ay(xy - 2) 
        compute tmp-hg-ay(xy) = tmp-hg-ay(xy) * 100 
        compute tmp-hg-ay(xy) = tmp-hg-ay(xy) / tmp-hg-ay(xz) 
        move tmp-hg-ay(xy)         to z-yuzde 
        move z-yuzde              to det11-gecen-hbuay
     else
        initialize tmp-hg-ay(xy) 
        move tmp-hg-ay(xy)         to z-yuzde 
        move z-yuzde              to det11-gecen-hbuay
     end-if

     if tmp-tg-ay(xz) > 0
        compute tmp-tg-ay(xy) = tmp-tg-ay(xy - 1) + tmp-tg-ay(xy - 2) 
        compute tmp-tg-ay(xy) = tmp-tg-ay(xy) * 100 
        compute tmp-tg-ay(xy) = tmp-tg-ay(xy) / tmp-tg-ay(xz) 
        move tmp-tg-ay(xy)         to z-yuzde 
        move z-yuzde              to det11-gecen-tbuay
     else
        initialize tmp-tg-ay(xy) 
        move tmp-tg-ay(xy)         to z-yuzde 
        move z-yuzde              to det11-gecen-tbuay
     end-if
     
************************************************************
     
     if tmp-rg-yil(xz) > 0
        compute tmp-rg-yil(xy) = tmp-rg-yil(xy - 1) + tmp-rg-yil(xy - 2) 
        compute tmp-rg-yil(xy) = tmp-rg-yil(xy) * 100 
        compute tmp-rg-yil(xy) = tmp-rg-yil(xy) / tmp-rg-yil(xz) 
        move tmp-rg-yil(xy)         to z-yuzde 
        move z-yuzde               to det11-gecen-rbuyil
     else
        initialize tmp-rg-yil(xy) 
        move tmp-rg-yil(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-rbuyil
     end-if

     if tmp-hg-yil(xz) > 0
        compute tmp-hg-yil(xy) = tmp-hg-yil(xy - 1) + tmp-hg-yil(xy - 2) 
        compute tmp-hg-yil(xy) = tmp-hg-yil(xy) * 100 
        compute tmp-hg-yil(xy) = tmp-hg-yil(xy) / tmp-hg-yil(xz) 
        move tmp-hg-yil(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-hbuyil
     else
        initialize tmp-hg-yil(xy) 
        move tmp-hg-yil(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-hbuyil
     end-if

     if tmp-tg-yil(xz) > 0
        compute tmp-tg-yil(xy) = tmp-tg-yil(xy - 1) + tmp-tg-yil(xy - 2) 
        compute tmp-tg-yil(xy) = tmp-tg-yil(xy) * 100 
        compute tmp-tg-yil(xy) = tmp-tg-yil(xy) / tmp-tg-yil(xz) 
        move tmp-tg-yil(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-tbuyil
     else
        initialize tmp-tg-yil(xy) 
        move tmp-tg-yil(xy)         to z-yuzde 
        move z-yuzde                    to det11-gecen-tbuyil
     end-if
      .
*
 yatak-doluluk-yuzde.
     initialize xy
     compute xy = tmp-satir - 7
     compute tmp-rs-gun(tmp-satir - 1) = tmp-rs-gun(tmp-satir - 2) + tmp-rs-gun(tmp-satir - 3) + 
                                         tmp-rs-gun(tmp-satir - 4) + tmp-rs-gun(tmp-satir - 5) + 
                                         tmp-rs-gun(tmp-satir - 6) + tmp-rs-gun(tmp-satir - 7)
     if tmp-rs-gun(xy) > 0
        compute tmp-rs-gun(tmp-satir) = tmp-rs-gun(tmp-satir - 1) * 100 
        compute tmp-rs-gun(tmp-satir) = tmp-rs-gun(tmp-satir) / tmp-rs-gun(xy) 
        move tmp-rs-gun(tmp-satir)        to z-yuzde 
        move z-yuzde                    to det11-rbugun
     else
        initialize tmp-rs-gun(tmp-satir) 
        move tmp-rs-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-rbugun
     end-if

     compute tmp-hs-gun(tmp-satir - 1) = tmp-hs-gun(tmp-satir - 2) + tmp-hs-gun(tmp-satir - 3) + 
                                         tmp-hs-gun(tmp-satir - 4) + tmp-hs-gun(tmp-satir - 5) + 
                                         tmp-hs-gun(tmp-satir - 6) + tmp-hs-gun(tmp-satir - 7)
     if tmp-hs-gun(xy) > 0
        compute tmp-hs-gun(tmp-satir) = tmp-hs-gun(tmp-satir - 1) * 100 
        compute tmp-hs-gun(tmp-satir) = tmp-hs-gun(tmp-satir) / tmp-hs-gun(xy) 
        move tmp-rs-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-hbugun
     else
        initialize tmp-hs-gun(tmp-satir) 
        move tmp-hs-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-hbugun
     end-if

     compute tmp-ts-gun(tmp-satir - 1) = tmp-ts-gun(tmp-satir - 2) + tmp-ts-gun(tmp-satir - 3) + 
                                         tmp-ts-gun(tmp-satir - 4) + tmp-ts-gun(tmp-satir - 5) + 
                                         tmp-ts-gun(tmp-satir - 6) + tmp-ts-gun(tmp-satir - 7)
     if tmp-ts-gun(xy) > 0
        compute tmp-ts-gun(tmp-satir) = tmp-ts-gun(tmp-satir - 1) * 100 
        compute tmp-ts-gun(tmp-satir) = tmp-ts-gun(tmp-satir) / tmp-ts-gun(xy) 
        move tmp-ts-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-tbugun
     else
        initialize tmp-ts-gun(tmp-satir) 
        move tmp-ts-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-tbugun
     end-if

    
********************************************************
     compute tmp-rs-ay(tmp-satir - 1) = tmp-rs-ay(tmp-satir - 2) + tmp-rs-ay(tmp-satir - 3) + 
                                        tmp-rs-ay(tmp-satir - 4) + tmp-rs-ay(tmp-satir - 5) + 
                                        tmp-rs-ay(tmp-satir - 6) + tmp-rs-ay(tmp-satir - 7)
     if tmp-rs-ay(xy) > 0
        compute tmp-rs-ay(tmp-satir) = tmp-rs-ay(tmp-satir - 1) * 100 
        compute tmp-rs-ay(tmp-satir) = tmp-rs-ay(tmp-satir) / tmp-rs-ay(xy) 
        move tmp-rs-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-rbuay
     else
        initialize tmp-ts-gun(tmp-satir) 
        move tmp-rs-ay(tmp-satir)          to z-yuzde 
        move z-yuzde                     to det11-rbuay
     end-if

     compute tmp-hs-ay(tmp-satir - 1) = tmp-hs-ay(tmp-satir - 2) + tmp-hs-ay(tmp-satir - 3) + 
                                        tmp-hs-ay(tmp-satir - 4) + tmp-hs-ay(tmp-satir - 5) + 
                                        tmp-hs-ay(tmp-satir - 6) + tmp-hs-ay(tmp-satir - 7)
     if tmp-hs-ay(xy) > 0
        compute tmp-hs-ay(tmp-satir) = tmp-hs-ay(tmp-satir - 1) * 100 
        compute tmp-hs-ay(tmp-satir) = tmp-hs-ay(tmp-satir) / tmp-hs-ay(xy) 
        move tmp-hs-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-hbuay
     else
        initialize tmp-hs-ay(tmp-satir) 
        move tmp-hs-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-hbuay
     end-if

     compute tmp-ts-ay(tmp-satir - 1) = tmp-ts-ay(tmp-satir - 2) + tmp-ts-ay(tmp-satir - 3) + 
                                        tmp-ts-ay(tmp-satir - 4) + tmp-ts-ay(tmp-satir - 5) + 
                                        tmp-ts-ay(tmp-satir - 6) + tmp-ts-ay(tmp-satir - 7)
     if tmp-ts-ay(xy) > 0
        compute tmp-ts-ay(tmp-satir) = tmp-ts-ay(tmp-satir - 1) * 100 
        compute tmp-ts-ay(tmp-satir) = tmp-ts-ay(tmp-satir) / tmp-ts-ay(xy) 
        move tmp-ts-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-tbuay
     else
        initialize tmp-ts-ay(tmp-satir) 
        move tmp-ts-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-tbuay
     end-if
     
************************************************************
     
     compute tmp-rs-yil(tmp-satir - 1) = tmp-rs-yil(tmp-satir - 2) + tmp-rs-yil(tmp-satir - 3) + 
                                         tmp-rs-yil(tmp-satir - 4) + tmp-rs-yil(tmp-satir - 5) + 
                                         tmp-rs-yil(tmp-satir - 6) + tmp-rs-yil(tmp-satir - 7)
     if tmp-rs-yil(xy) > 0
        compute tmp-rs-yil(tmp-satir) = tmp-rs-yil(tmp-satir - 1) * 100 
        compute tmp-rs-yil(tmp-satir) = tmp-rs-yil(tmp-satir) / tmp-rs-yil(xy) 
        move tmp-rs-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-rbuyil
     else
        initialize tmp-rs-yil(tmp-satir) 
        move tmp-rs-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-rbuyil
     end-if

     compute tmp-hs-yil(tmp-satir - 1) = tmp-hs-yil(tmp-satir - 2) + tmp-hs-yil(tmp-satir - 3) + 
                                         tmp-hs-yil(tmp-satir - 4) + tmp-hs-yil(tmp-satir - 5) + 
                                         tmp-hs-yil(tmp-satir - 6) + tmp-hs-yil(tmp-satir - 7)
     if tmp-hs-yil(xy) > 0
        compute tmp-hs-yil(tmp-satir) = tmp-hs-yil(tmp-satir - 1) * 100 
        compute tmp-hs-yil(tmp-satir) = tmp-hs-yil(tmp-satir) / tmp-hs-yil(xy) 
        move tmp-hs-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-hbuyil
     else
        initialize tmp-hs-yil(tmp-satir) 
        move tmp-hs-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-hbuyil
     end-if

     compute tmp-ts-yil(tmp-satir - 1) = tmp-ts-yil(tmp-satir - 2) + tmp-ts-yil(tmp-satir - 3) + 
                                         tmp-ts-yil(tmp-satir - 4) + tmp-ts-yil(tmp-satir - 5) + 
                                         tmp-ts-yil(tmp-satir - 6) + tmp-ts-yil(tmp-satir - 7)
     if tmp-ts-yil(xy) > 0
        compute tmp-ts-yil(tmp-satir) = tmp-ts-yil(tmp-satir - 1) * 100 
        compute tmp-ts-yil(tmp-satir) = tmp-ts-yil(tmp-satir) / tmp-ts-yil(xy) 
        move tmp-ts-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-tbuyil
     else
        initialize tmp-ts-yil(tmp-satir) 
        move tmp-ts-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-tbuyil
     end-if
************************************************************
************************************************************
     compute tmp-rg-gun(tmp-satir - 1) = tmp-rg-gun(tmp-satir - 2) + tmp-rg-gun(tmp-satir - 3) + 
                                         tmp-rg-gun(tmp-satir - 4) + tmp-rg-gun(tmp-satir - 5) + 
                                         tmp-rg-gun(tmp-satir - 6) + tmp-rg-gun(tmp-satir - 7)
     if tmp-rg-gun(xy) > 0
        compute tmp-rg-gun(tmp-satir) = tmp-rg-gun(tmp-satir - 1) * 100 
        compute tmp-rg-gun(tmp-satir) = tmp-rg-gun(tmp-satir) / tmp-rg-gun(xy) 
        move tmp-rg-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-rbugun
     else
        initialize tmp-rg-gun(tmp-satir) 
        move tmp-rg-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-rbugun
     end-if

     compute tmp-hg-gun(tmp-satir - 1) = tmp-hg-gun(tmp-satir - 2) + tmp-hg-gun(tmp-satir - 3) + 
                                         tmp-hg-gun(tmp-satir - 4) + tmp-hg-gun(tmp-satir - 5) + 
                                         tmp-hg-gun(tmp-satir - 6) + tmp-hg-gun(tmp-satir - 7)
     if tmp-hg-gun(xy) > 0
        compute tmp-hg-gun(tmp-satir) = tmp-hg-gun(tmp-satir - 1) * 100 
        compute tmp-hg-gun(tmp-satir) = tmp-hg-gun(tmp-satir) / tmp-hg-gun(xy) 
        move tmp-hg-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-hbugun
     else
        initialize tmp-hg-gun(tmp-satir) 
        move tmp-hg-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-hbugun
     end-if

     compute tmp-tg-gun(tmp-satir - 1) = tmp-tg-gun(tmp-satir - 2) + tmp-tg-gun(tmp-satir - 3) + 
                                         tmp-tg-gun(tmp-satir - 4) + tmp-tg-gun(tmp-satir - 5) + 
                                         tmp-tg-gun(tmp-satir - 6) + tmp-tg-gun(tmp-satir - 7)
     if tmp-tg-gun(xy) > 0
        compute tmp-tg-gun(tmp-satir) = tmp-tg-gun(tmp-satir - 1) * 100 
        compute tmp-tg-gun(tmp-satir) = tmp-tg-gun(tmp-satir) / tmp-tg-gun(xy) 
        move tmp-tg-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-tbugun
     else
        initialize tmp-tg-gun(tmp-satir) 
        move tmp-tg-gun(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-tbugun
     end-if

    
********************************************************

     compute tmp-rg-ay(tmp-satir - 1) = tmp-rg-ay(tmp-satir - 2) + tmp-rg-ay(tmp-satir - 3) + 
                                        tmp-rg-ay(tmp-satir - 4) + tmp-rg-ay(tmp-satir - 5) + 
                                        tmp-rg-ay(tmp-satir - 6) + tmp-rg-ay(tmp-satir - 7)
     if tmp-rg-ay(xy) > 0
        compute tmp-rg-ay(tmp-satir) = tmp-rg-ay(tmp-satir - 1) * 100 
        compute tmp-rg-ay(tmp-satir) = tmp-rg-ay(tmp-satir) / tmp-rg-ay(xy) 
        move tmp-rg-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-gecen-rbuay
     else
        initialize tmp-rg-ay(tmp-satir) 
        move tmp-rg-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-gecen-rbuay
     end-if

     compute tmp-hg-ay(tmp-satir - 1) = tmp-hg-ay(tmp-satir - 2) + tmp-hg-ay(tmp-satir - 3) + 
                                        tmp-hg-ay(tmp-satir - 4) + tmp-hg-ay(tmp-satir - 5) + 
                                        tmp-hg-ay(tmp-satir - 6) + tmp-hg-ay(tmp-satir - 7)
     if tmp-hg-ay(xy) > 0
        compute tmp-hg-ay(tmp-satir) = tmp-hg-ay(tmp-satir - 1) * 100 
        compute tmp-hg-ay(tmp-satir) = tmp-hg-ay(tmp-satir) / tmp-hg-ay(xy) 
        move tmp-hg-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-gecen-hbuay
     else
        initialize tmp-hg-ay(tmp-satir) 
        move tmp-hg-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-gecen-hbuay
     end-if

     compute tmp-tg-ay(tmp-satir - 1) = tmp-tg-ay(tmp-satir - 2) + tmp-tg-ay(tmp-satir - 3) + 
                                        tmp-tg-ay(tmp-satir - 4) + tmp-tg-ay(tmp-satir - 5) + 
                                        tmp-tg-ay(tmp-satir - 6) + tmp-tg-ay(tmp-satir - 7)
     if tmp-tg-ay(xy) > 0
        compute tmp-tg-ay(tmp-satir) = tmp-tg-ay(tmp-satir - 1) * 100 
        compute tmp-tg-ay(tmp-satir) = tmp-tg-ay(tmp-satir) / tmp-tg-ay(xy) 
        move tmp-tg-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-gecen-tbuay
     else
        initialize tmp-tg-ay(tmp-satir) 
        move tmp-tg-ay(tmp-satir)         to z-yuzde 
        move z-yuzde                    to det11-gecen-tbuay
     end-if
     
************************************************************
     
     compute tmp-rg-yil(tmp-satir - 1) = tmp-rg-yil(tmp-satir - 2) + tmp-rg-yil(tmp-satir - 3) + 
                                         tmp-rg-yil(tmp-satir - 4) + tmp-rg-yil(tmp-satir - 5) + 
                                         tmp-rg-yil(tmp-satir - 6) + tmp-rg-yil(tmp-satir - 7)
     if tmp-rg-yil(xy) > 0   
        compute tmp-rg-yil(tmp-satir) = tmp-rg-yil(tmp-satir - 1) * 100 
        compute tmp-rg-yil(tmp-satir) = tmp-rg-yil(tmp-satir) / tmp-rg-yil(xy) 
        move tmp-rg-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-rbuyil
     else
        initialize tmp-rg-yil(tmp-satir) 
        move tmp-rg-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-rbuyil
     end-if

     compute tmp-hg-yil(tmp-satir - 1) = tmp-hg-yil(tmp-satir - 2) + tmp-hg-yil(tmp-satir - 3) + 
                                         tmp-hg-yil(tmp-satir - 4) + tmp-hg-yil(tmp-satir - 5) + 
                                         tmp-hg-yil(tmp-satir - 6) + tmp-hg-yil(tmp-satir - 7)
     if tmp-hg-yil(xy) > 0
        compute tmp-hg-yil(tmp-satir) = tmp-hg-yil(tmp-satir - 1) * 100 
        compute tmp-hg-yil(tmp-satir) = tmp-hg-yil(tmp-satir) / tmp-hg-yil(xy) 
        move tmp-hg-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-hbuyil
     else
        initialize tmp-hg-yil(tmp-satir) 
        move tmp-hg-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-hbuyil
     end-if

     compute tmp-tg-yil(tmp-satir - 1) = tmp-tg-yil(tmp-satir - 2) + tmp-tg-yil(tmp-satir - 3) + 
                                         tmp-tg-yil(tmp-satir - 4) + tmp-tg-yil(tmp-satir - 5) + 
                                         tmp-tg-yil(tmp-satir - 6) + tmp-tg-yil(tmp-satir - 7)
     if tmp-tg-yil(xy) > 0
        compute tmp-tg-yil(tmp-satir) = tmp-tg-yil(tmp-satir - 1) * 100 
        compute tmp-tg-yil(tmp-satir) = tmp-tg-yil(tmp-satir) / tmp-tg-yil(xy) 
        move tmp-tg-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-tbuyil
     else
        initialize tmp-tg-yil(tmp-satir) 
        move tmp-tg-yil(tmp-satir)         to z-yuzde 
        move z-yuzde                     to det11-gecen-tbuyil
     end-if
      .
*
 dolu-oda-bul. 
     initialize xy 
     if sira-comp not = 1
        move "Satilan Oda"  to det11-baslik
        compute xy = tmp-satir + 5
     else
        move "Complimentary Oda" to det11-baslik
        compute xy = tmp-satir + 7
     end-if 

     initialize eklenecek-oda 
                tr-satilan-oda th-satilan-oda tt-satilan-oda

     open input cast rez odalar konum kodlar02
     initialize cast-rec 
     move ara-tarih           to cast-tarih
     start cast key not < CAST-ANAH invalid 
         continue 
     not invalid
     perform until fs-cast = "10"
     read cast next no lock end move "10"  to fs-cast
     not at end 
             evaluate birikiuc
             when   1
               if cast-tarih <> son-tarih
                 exit perform 
               end-if
             when   2
               if cast-tarih > son-tarih
                 exit perform 
               end-if 
             when   3
               if cast-tarih > son-tarih
                 exit perform 
               end-if
             end-evaluate 
 
             initialize rez-rec
             move cast-rez-no to rez-no
             read rez no lock invalid 
                continue 
             not invalid 
                 if rez-durumu = "S"
                    exit perform cycle 
                 end-if 
                 if rez-k-g-b <> "K"
                    exit perform cycle
                 end-if
                 if rez-cik-tar = cast-tarih
                     exit perform cycle 
                 end-if 
                 if cast-share = 1 then                  
                    move 0 to eklenecek-oda 
                 else
                     move 1 to eklenecek-oda
                 end-if
                  if filtre-var = 1 then 
                    perform filtre
                    if filtre-gecti not = 1 then 
                          exit perform cycle 
                    end-if
                  end-if                    
                 if cast-oda-no not = spaces and 
                   (hayali-haric = 1 or dis-haric = 1 ) then 
                      move cast-oda-no to odalar-anah
                      read odalar no lock invalid 
                          continue
                      not invalid
                      if ( odalar-hayali = "H" and hayali-haric = 1 )  then
                               move 0 to eklenecek-oda
                      end-if
                       if ( dis-haric = 1 and odalar-dis = 1 )  then
                                  exit perform cycle 
                      end-if 
                      end-read
                 end-if

                 initialize kodlar02-rec
                 move "B"                to kodlar02-tipi
                 move rez-odeme-tipi    to kodlar02-kodu
                 read kodlar02         no lock invalid 
                     exit perform cycle 
                 end-read
                 if sira-comp not = 1
                   if ode-tipi not = "D"           
                      initialize konum-rec
                      move cast-oda-konumu  to konum-anahtar
                      read konum no lock invalid 
                           continue 
                      not invalid 
                         evaluate konum-ref 
                         when 1
                             add eklenecek-oda to tr-satilan-oda 
                             if gecen-sene <> son-yil
                                evaluate birikiuc
                                    when 1
                                     add cast-buyuk to tmp-rs-gun(xy)
                                     add cast-kucuk to tmp-rs-gun(xy + 1)
                                     add cast-free  to tmp-rs-gun(xy + 2)
                                    when 2
                                     add cast-buyuk to tmp-rs-ay(xy)
                                     add cast-kucuk to tmp-rs-ay(xy + 1)
                                     add cast-free  to tmp-rs-ay(xy + 2)
                                    when 3
                                     add cast-buyuk to tmp-rs-yil(xy)
                                     add cast-kucuk to tmp-rs-yil(xy + 1)
                                     add cast-free  to tmp-rs-yil(xy + 2)
                                end-evaluate
                                evaluate cast-buyuk
                                    when 1
                                         add 1 to t-single(birikiuc)
                                    when 2
                                         add 1 to t-double(birikiuc)
                                    when 3 when 4 when 5 
                                    when 6 when 7 when 8 
                                    when 9
                                         add 1 to t-triple(birikiuc)
                                end-evaluate
                             else
                                evaluate birikiuc
                                    when 1
                                     add cast-buyuk to tmp-rg-gun(xy)
                                     add cast-kucuk to tmp-rg-gun(xy + 1)
                                     add cast-free  to tmp-rg-gun(xy + 2)
                                    when 2
                                     add cast-buyuk to tmp-rg-ay(xy)
                                     add cast-kucuk to tmp-rg-ay(xy + 1)
                                     add cast-free  to tmp-rg-ay(xy + 2)
                                    when 3
                                     add cast-buyuk to tmp-rg-yil(xy)
                                     add cast-kucuk to tmp-rg-yil(xy + 1)
                                     add cast-free  to tmp-rg-yil(xy + 2)
                                end-evaluate
                             end-if
                         when 2
                             add eklenecek-oda to th-satilan-oda                       
                             if gecen-sene <> son-yil
                                evaluate birikiuc
                                    when 1
                                     add cast-buyuk to tmp-hs-gun(xy)
                                     add cast-kucuk to tmp-hs-gun(xy + 1)
                                     add cast-free  to tmp-hs-gun(xy + 2)
                                    when 2
                                     add cast-buyuk to tmp-hs-ay(xy)
                                     add cast-kucuk to tmp-hs-ay(xy + 1)
                                     add cast-free  to tmp-hs-ay(xy + 2)
                                    when 3
                                     add cast-buyuk to tmp-hs-yil(xy)
                                     add cast-kucuk to tmp-hs-yil(xy + 1)
                                     add cast-free  to tmp-hs-yil(xy + 2)
                                end-evaluate
                                evaluate cast-buyuk
                                    when 1
                                         add 1 to t-single-2(birikiuc)
                                    when 2
                                         add 1 to t-double-2(birikiuc)
                                    when 3 when 4 when 5 
                                    when 6 when 7 when 8 
                                    when 9
                                         add 1 to t-triple-2(birikiuc)
                                end-evaluate
                             else
                                evaluate birikiuc
                                    when 1
                                     add cast-buyuk to tmp-hg-gun(xy)
                                     add cast-kucuk to tmp-hg-gun(xy + 1)
                                     add cast-free  to tmp-hg-gun(xy + 2)
                                    when 2
                                     add cast-buyuk to tmp-hg-ay(xy)
                                     add cast-kucuk to tmp-hg-ay(xy + 1)
                                     add cast-free  to tmp-hg-ay(xy + 2)
                                    when 3
                                     add cast-buyuk to tmp-hg-yil(xy)
                                     add cast-kucuk to tmp-hg-yil(xy + 1)
                                     add cast-free  to tmp-hg-yil(xy + 2)
                                end-evaluate
                             end-if
                         end-evaluate
                             add eklenecek-oda to tt-satilan-oda
                      end-read                  
                   end-if 
                 else
                  if ode-tipi = "D"                              
                     initialize konum-rec
                     move cast-oda-konumu  to konum-anahtar
                     read konum no lock invalid 
                          continue 
                     not invalid 
                         evaluate konum-ref 
                         when 1
                             add eklenecek-oda to tr-satilan-oda
                             if gecen-sene <> son-yil
                                evaluate birikiuc
                                    when 1
                                     add cast-buyuk to tmp-rs-gun(xy)
                                     add cast-kucuk to tmp-rs-gun(xy + 1)
                                     add cast-free  to tmp-rs-gun(xy + 2)
                                    when 2
                                     add cast-buyuk to tmp-rs-ay(xy)
                                     add cast-kucuk to tmp-rs-ay(xy + 1)
                                     add cast-free  to tmp-rs-ay(xy + 2)
                                    when 3
                                     add cast-buyuk to tmp-rs-yil(xy)
                                     add cast-kucuk to tmp-rs-yil(xy + 1)
                                     add cast-free  to tmp-rs-yil(xy + 2)
                                end-evaluate
                                evaluate cast-buyuk
                                    when 1
                                         add 1 to t-single(birikiuc)
                                    when 2
                                         add 1 to t-double(birikiuc)
                                    when 3 when 4 when 5 
                                    when 6 when 7 when 8 
                                    when 9
                                         add 1 to t-triple(birikiuc)
                                end-evaluate
                             else
                                evaluate birikiuc
                                    when 1
                                     add cast-buyuk to tmp-rg-gun(xy)
                                     add cast-kucuk to tmp-rg-gun(xy + 1)
                                     add cast-free  to tmp-rg-gun(xy + 2)
                                    when 2
                                     add cast-buyuk to tmp-rg-ay(xy)
                                     add cast-kucuk to tmp-rg-ay(xy + 1)
                                     add cast-free  to tmp-rg-ay(xy + 2)
                                    when 3
                                     add cast-buyuk to tmp-rg-yil(xy)
                                     add cast-kucuk to tmp-rg-yil(xy + 1)
                                     add cast-free  to tmp-rg-yil(xy + 2)
                                end-evaluate

                             end-if
                         when 2
                             add eklenecek-oda to th-satilan-oda                       
                             if gecen-sene <> son-yil
                                evaluate birikiuc
                                    when 1
                                     add cast-buyuk to tmp-hs-gun(xy)
                                     add cast-kucuk to tmp-hs-gun(xy + 1)
                                     add cast-free  to tmp-hs-gun(xy + 2)
                                    when 2                  
                                     add cast-buyuk to tmp-hs-ay(xy)
                                     add cast-kucuk to tmp-hs-ay(xy + 1)
                                     add cast-free  to tmp-hs-ay(xy + 2)
                                    when 3                  
                                     add cast-buyuk to tmp-hs-yil(xy)
                                     add cast-kucuk to tmp-hs-yil(xy + 1)
                                     add cast-free  to tmp-hs-yil(xy + 2)
                                end-evaluate
                                evaluate cast-buyuk
                                    when 1
                                         add 1 to t-single-2(birikiuc)
                                    when 2
                                         add 1 to t-double-2(birikiuc)
                                    when 3 when 4 when 5 
                                    when 6 when 7 when 8 
                                    when 9
                                         add 1 to t-triple-2(birikiuc)
                                end-evaluate
                             else
                                evaluate birikiuc
                                    when 1
                                     add cast-buyuk to tmp-hg-gun(xy)
                                     add cast-kucuk to tmp-hg-gun(xy + 1)
                                     add cast-free  to tmp-hg-gun(xy + 2)
                                    when 2                  
                                     add cast-buyuk to tmp-hg-ay(xy)
                                     add cast-kucuk to tmp-hg-ay(xy + 1)
                                     add cast-free  to tmp-hg-ay(xy + 2)
                                    when 3                  
                                     add cast-buyuk to tmp-hg-yil(xy)
                                     add cast-kucuk to tmp-hg-yil(xy + 1)
                                     add cast-free  to tmp-hg-yil(xy + 2)
                                end-evaluate
                             end-if
                         end-evaluate
                         add eklenecek-oda to tt-satilan-oda
                      end-read                                                           
                  end-if 
                 end-if
             end-read 


     end-read 
     end-perform
     end-start
     
     close cast rez odalar konum kodlar02.
*
 kisi-dagit-dayicim.
      add t-single(1) to tmp-rs-gun(47)  |resort bugun
                         tmp-rs-gun(50)
                         tmp-ts-gun(47)
                         tmp-ts-gun(50)

      add t-double(1) to tmp-rs-gun(48)
                         tmp-rs-gun(50)
                         tmp-ts-gun(48)
                         tmp-ts-gun(50)

      add t-triple(1) to tmp-rs-gun(49)
                         tmp-rs-gun(50)
                         tmp-ts-gun(49)
                         tmp-ts-gun(50)

      compute yuzde rounded = t-single(1)  / tmp-rs-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rs-ay(47)

      compute yuzde rounded = t-double(1)  / tmp-rs-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rs-ay(48)

      compute yuzde rounded = t-triple(1)  / tmp-rs-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rs-ay(49)

      add t-single(2) to tmp-rs-yil(47) |resort buay
                         tmp-rs-yil(50)
                         tmp-ts-yil(47)
                         tmp-ts-yil(50)
                                      
      add t-double(2) to tmp-rs-yil(48)
                         tmp-rs-yil(50)
                         tmp-ts-yil(48)
                         tmp-ts-yil(50)
                                      
      add t-triple(2) to tmp-rs-yil(49)
                         tmp-rs-yil(50)
                         tmp-ts-yil(49)
                         tmp-ts-yil(50)

      compute yuzde rounded = t-single(2)  / tmp-rs-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rg-gun(47)

      compute yuzde rounded = t-double(2)  / tmp-rs-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rg-gun(48)

      compute yuzde rounded = t-triple(2)  / tmp-rs-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rg-gun(49)

      add t-single(3) to tmp-rg-ay(47) |resort buyil
                         tmp-rg-ay(50)
                         tmp-tg-ay(47) 
                         tmp-tg-ay(50)
                                     
      add t-double(3) to tmp-rg-ay(48)
                         tmp-rg-ay(50)
                         tmp-tg-ay(48) 
                         tmp-tg-ay(50)
                                     
      add t-triple(3) to tmp-rg-ay(49)
                         tmp-rg-ay(50)
                         tmp-tg-ay(49) 
                         tmp-tg-ay(50)

      compute yuzde rounded = t-single(3)  / tmp-rs-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rg-yil(47)

      compute yuzde rounded = t-double(3)  / tmp-rs-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rg-yil(48)

      compute yuzde rounded = t-triple(3)  / tmp-rs-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rg-yil(49)

      add t-single-2(1) to tmp-hs-gun(47) |harmony bugun
                           tmp-hs-gun(50)
                           tmp-ts-gun(47)
                           tmp-ts-gun(50)
                                        
      add t-double-2(1) to tmp-hs-gun(48)
                           tmp-hs-gun(50)
                           tmp-ts-gun(48)
                           tmp-ts-gun(50)
                                        
      add t-triple-2(1) to tmp-hs-gun(49)
                           tmp-hs-gun(50)
                           tmp-ts-gun(49)
                           tmp-ts-gun(50)

      compute yuzde rounded = t-single-2(1)  / tmp-hs-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hs-ay(47)

      compute yuzde rounded = t-double-2(1)  / tmp-hs-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hs-ay(48)

      compute yuzde rounded = t-triple-2(1)  / tmp-hs-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hs-ay(49)
      || Toplam gn Yzde Hesaplama
      compute yuzde rounded = tmp-ts-gun(47)  / tmp-ts-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-ts-ay(47)

      compute yuzde rounded = tmp-ts-gun(48)  / tmp-ts-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-ts-ay(48)

      compute yuzde rounded = tmp-ts-gun(49)  / tmp-ts-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-ts-ay(49)
      
      ||
      add t-single-2(2) to tmp-hs-yil(47) |harmony buay
                           tmp-hs-yil(50)
                           tmp-ts-yil(47)
                           tmp-ts-yil(50)
                                        
      add t-double-2(2) to tmp-hs-yil(48)
                           tmp-hs-yil(50)
                           tmp-ts-yil(48)
                           tmp-ts-yil(50)
                                        
      add t-triple-2(2) to tmp-hs-yil(49)
                           tmp-hs-yil(50)
                           tmp-ts-yil(49)
                           tmp-ts-yil(50)

      compute yuzde rounded = t-single-2(2)  / tmp-hs-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hg-gun(46)

      compute yuzde rounded = t-double-2(2)  / tmp-hs-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hg-gun(47)

      compute yuzde rounded = t-triple-2(2)  / tmp-hs-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hg-gun(48)
      || Toplam ay yuzde Hesaplama
      compute yuzde rounded = tmp-ts-yil(47)  / tmp-ts-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-tg-gun(47)

      compute yuzde rounded = tmp-ts-yil(48)  / tmp-ts-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-tg-gun(48)

      compute yuzde rounded = tmp-ts-yil(49)  / tmp-ts-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-tg-gun(49)
      
      ||
      add t-single-2(3) to tmp-hg-ay(47) |harmony buyil
                           tmp-hg-ay(50)
                           tmp-tg-ay(47)
                           tmp-tg-ay(50)
                                       
      add t-double-2(3) to tmp-hg-ay(48)
                           tmp-hg-ay(50)
                           tmp-tg-ay(48)
                           tmp-tg-ay(50)
                                       
      add t-triple-2(3) to tmp-hg-ay(49)
                           tmp-hg-ay(50)
                           tmp-tg-ay(49)
                           tmp-tg-ay(50)

      compute yuzde rounded = t-single-2(3)  / tmp-hs-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hg-yil(47)

      compute yuzde rounded = t-double-2(3)  / tmp-hs-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hg-yil(48)

      compute yuzde rounded = t-triple-2(3)  / tmp-hs-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hg-yil(49)
      || Toplam yil yuzde Hesaplama
      compute yuzde rounded = tmp-tg-ay(47)  / tmp-ts-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-tg-yil(47)

      compute yuzde rounded = tmp-tg-ay(48)  / tmp-ts-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-tg-yil(48)

      compute yuzde rounded = tmp-tg-ay(49)  / tmp-ts-yil(3) * 100
      move yuzde     to z-doluluk    
      move z-doluluk to tmp-tg-yil(49)
      
      ||

      compute yuzde rounded = tmp-rs-gun(50)  / tmp-rs-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rs-ay(50)

      compute yuzde rounded = tmp-rs-yil(50)  / tmp-rs-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rg-gun(50)

      compute yuzde rounded = tmp-rg-ay(50)  / tmp-rs-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-rg-yil(50)

      compute yuzde rounded = tmp-hs-gun(50)  / tmp-hs-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hs-ay(50)

      compute yuzde rounded = tmp-hs-yil(50)  / tmp-hs-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hg-gun(50)

      compute yuzde rounded = tmp-hg-ay(50)  / tmp-hs-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-hg-yil(50)

      compute yuzde rounded = tmp-ts-gun(50)  / tmp-ts-gun(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-ts-ay(50)

      compute yuzde rounded = tmp-ts-yil(50)  / tmp-ts-ay(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-tg-gun(50)

      compute yuzde rounded = tmp-tg-ay(50)  / tmp-ts-yil(3) * 100
      move yuzde     to z-doluluk
      move z-doluluk to tmp-tg-yil(50)
      
      || Toplam pax ek
      move tmp-rs-gun(9) to tmp-rs-gun(51)
      move tmp-rs-ay(9)  to tmp-rs-yil(51)
      move tmp-rs-yil(9) to tmp-rg-ay(51)

      move tmp-hs-gun(9) to tmp-hs-gun(51)
      move tmp-hs-ay(9)  to tmp-hs-yil(51)
      move tmp-hs-yil(9) to tmp-hg-ay(51)

      move tmp-ts-gun(9) to tmp-ts-gun(51)
      move tmp-ts-ay(9)  to tmp-ts-yil(51)
      move tmp-ts-yil(9) to tmp-tg-ay(51)
      || Double Occ Bul
      compute tmp-rs-gun(52) = tmp-rs-gun(51) / tmp-rs-gun(50)
      compute tmp-rs-yil(52) = tmp-rs-yil(51) / tmp-rs-yil(50)
      compute tmp-rg-ay(52)  = tmp-rg-ay(51) / tmp-rg-ay(50)

      compute tmp-hs-gun(52) = tmp-hs-gun(51) / tmp-hs-gun(50)
      compute tmp-hs-yil(52) = tmp-hs-yil(51) / tmp-hs-yil(50)
      compute tmp-hg-ay(52)  = tmp-hg-ay(51) / tmp-hg-ay(50)

      compute tmp-ts-gun(52) = tmp-ts-gun(51) / tmp-ts-gun(50)
      compute tmp-ts-yil(52) = tmp-ts-yil(51) / tmp-ts-yil(50)
      compute tmp-tg-ay(52)  = tmp-tg-ay(51) / tmp-tg-ay(50)
      ||

     .
*
 gun-forecast-al.
    initialize cast-rec for-ii
    compute for-ii = 52 + for-i
    move takvim-anah to cast-tarih
    start cast key not < cast-tarih invalid 
          continue
    not invalid
    perform with test after until fs-cast = "10"
    read cast next no lock end move "10" to fs-cast
    not at end
        if cast-tarih > takvim-anah 
           exit perform
        end-if

        initialize rez-rec
        move cast-rez-no to rez-no
        read rez no lock invalid 
             continue
        not invalid
            if filtre-var = 1 then 
               perform filtre
               if filtre-gecti not = 1 then 
                     exit perform cycle 
               end-if
            end-if
*            if ONKPARA-REFERANS-VAR = 1
*               perform sifir-coz
*               if xkonum-ref(cast-oda-konumu) not = oda-ref and oda-ref > 0  
*                  or XKONUM-ref(cast-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
*                  exit perform cycle
*               end-if
*            end-if
            move cast-oda-no       to rez-odano
            move cast-fiyat-konumu to rez-fiyat-konumu
            move cast-oda-konumu   to rez-oda-konumu
            if rez-kisi not = cast-kisi
               move cast-kisi to rez-kisi
            end-if
            initialize konum-rec 
            move cast-oda-konumu to konum-anahtar 
            read konum no lock invalid
                 continue
            not invalid
                evaluate konum-ref 
                    when 1
                         add 1             to tmp-rs-gun(for-ii)
                                              tmp-ts-gun(for-ii)

                         add cast-buyuk    to tmp-rs-ay (for-ii)
                                              tmp-rg-ay(for-ii)
                                              tmp-ts-ay (for-ii)
                                              tmp-tg-ay(for-ii)

                         add cast-kucuk    to tmp-rs-yil(for-ii)
                                              tmp-rg-ay(for-ii)
                                              tmp-ts-yil(for-ii)
                                              tmp-tg-ay(for-ii)

                         add cast-free     to tmp-rg-gun(for-ii)
                                              tmp-rg-ay(for-ii)
                                              tmp-tg-gun(for-ii)
                                              tmp-tg-ay(for-ii) 

                    when 2
                         add 1             to tmp-hs-gun(for-ii)
                                              tmp-ts-gun(for-ii)

                         add cast-buyuk    to tmp-hs-ay (for-ii)
                                              tmp-hg-ay(for-ii)
                                              tmp-ts-ay (for-ii)
                                              tmp-tg-ay(for-ii)

                         add cast-kucuk    to tmp-hs-yil(for-ii)
                                              tmp-hg-ay(for-ii)
                                              tmp-ts-yil(for-ii)
                                              tmp-tg-ay(for-ii)

                         add cast-free     to tmp-hg-gun(for-ii)
                                              tmp-hg-ay(for-ii)
                                              tmp-tg-gun(for-ii)
                                              tmp-tg-ay(for-ii) 

*                         compute oda-yuzde = (tmp-rs-gun(52 + for-i) * 100) / takvim-ref-hazir-oda(1)
*                         move oda-yuzde    to z-yuzde
*                         move z-yuzde      to tmp-rg-yil(52 + for-i)

                end-evaluate
            end-read       
        end-read
    end-read
    end-perform
    end-start.
     .
* 
 cast-oku.
    initialize cast-rec var-yok bebek-say ref-haz-oda-top
    move takvim-anah to cast-tarih.
    start cast key not < cast-tarih invalid continue
      not invalid
        perform with test after until var
          read cast next no lock end move "V" to var-yok
            not end
              if cast-tarih > takvim-anah
                move "V" to var-yok
               else
                initialize rez-rec
                move cast-rez-no to rez-no
                read rez no lock invalid  if k-kodu-tasi = "ASYA" then stop " " end-if
                  not invalid
                    if filtre-var = 1 then 
                        perform filtre
                        if filtre-gecti = 1 then
                           
                           perform takas-kaydet thru takas-kaydet-exit
                        end-if
                      else
                           perform takas-kaydet thru takas-kaydet-exit 
                    end-if                    
                end-read
              end-if
          end-read
        end-perform
    end-start
    if oda-ref = 1 
       initialize ref-haz-oda-top
       move g-takas3-oda    to tmp-rs-gun(for-ii)
       move g-takas3-pax    to tmp-rs-ay(for-ii)
       move g-takas3-child  to tmp-rs-yil(for-ii)
       move g-takas3-free   to tmp-rg-gun(for-ii)
       compute bebek-say = g-takas3-bebek + bebek-say
       compute tkisi = g-takas3-pax  + g-takas3-child + 
                            g-takas3-free + g-takas3-bebek
       move tkisi to tmp-rg-ay(for-ii)
       
       initialize top5 oda-yuzde
       move takas3-hazir-oda to top5-top
       move top5-top         to z-mevcut
       
       compute ref-haz-oda-top = ref-haz-oda-top + takas3-hazir-oda
       
       compute oda-yuzde = (g-takas3-oda * 100) / ref-haz-oda-top
       move oda-yuzde        to tmp-rg-yil(for-ii)
    else
       move g-takas3-oda    to tmp-hs-gun(for-ii)
       move g-takas3-pax    to tmp-hs-ay(for-ii)
       move g-takas3-child  to tmp-hs-yil(for-ii)
       move g-takas3-free   to tmp-hg-gun(for-ii)
       compute bebek-say = g-takas3-bebek + bebek-say
       compute tkisi = g-takas3-pax  + g-takas3-child + 
                            g-takas3-free + g-takas3-bebek
       move tkisi to tmp-hg-ay(for-ii)
       
       initialize top5 oda-yuzde
       move takas3-hazir-oda to top5-top
       move top5-top         to z-mevcut
       
       compute ref-haz-oda-top = ref-haz-oda-top + takas3-hazir-oda
       
       compute oda-yuzde = (g-takas3-oda * 100) / ref-haz-oda-top
       move oda-yuzde        to tmp-hg-yil(for-ii)
    end-if
    .
 cast-oku-exit.
    exit.
*
 takas-kaydet.
    evaluate true
    when rap-tip = "N"
          if rez-durumu not = "I"
                       go takas-kaydet-exit,
         end-if,
         if rez-k-g-b  not = "K" and  not = "O"
               go takas-kaydet-exit,
         end-if,
         if rez-k-g-b   = "O" |and info-dahil = 0
                go takas-kaydet-exit,
         end-if
        
    when rap-tip = "W"
         if rez-durumu not = "I"
                       go takas-kaydet-exit,
         end-if,
         if rez-k-g-b      = "K"
                       go takas-kaydet-exit,
         end-if,
    when rap-tip = "S"
         if rez-durumu not = "S"
                       go takas-kaydet-exit,
         end-if.
    if acn-kod not = spaces and 
       rez-acenta not = acn-kod
         go takas-kaydet-exit.

*** Grup Filtresi

    if acn-grup-kod not = spaces
      initialize grup-rec
      set grup-acenta to true
      move acn-grup-kod to grup-kodu
      move rez-acenta   to grup-alt
      read grup no lock
        invalid
          go takas-kaydet-exit
      end-read
    end-if

*** Grup Filtresi
    move 1 to tumu
    if tumu > 1 then
          
          move "B" to kodlar02-tipi
          move rez-odeme-tipi to kodlar02-kodu
          read kodlar02 no lock invalid 
              move spaces to kodlar02-adi
          end-read
          if ( ode-tipi = "D" or  ode-tipi = "F" or  ode-tipi = "O")   and tumu = 2 then
              go takas-kaydet-exit
          end-if
          if ( ode-tipi not = "D" and ode-tipi not = "F" and ode-tipi not = "O") and tumu = 3 then
             go takas-kaydet-exit
          end-if

    
    end-if
       move 1 to eklenecek-oda
   
*   TRACE Uygulamasi Acik ise kisi sayilari cast'tan alinacak
   
    if rezpara-trace = 1
       if rez-kisi not = cast-kisi
          move cast-kisi        to rez-kisi
       end-if
         move cast-share        to rez-share
         move cast-oda-no       to rez-odano
         move cast-fiyat-konumu to rez-fiyat-konumu
         move cast-oda-konumu   to rez-oda-konumu


       if rez-share = 1 then 
             move 0 to eklenecek-oda 
            else
              move 1 to eklenecek-oda
          end-if
      else 
          move 1 to eklenecek-oda
    end-if

    if onkpara-referans-var = 1 then 
       perform ref-filtre
       if  not ref-gecti then 
           exit paragraph
       end-if
    end-if

    if rez-odano not = spaces and  ( hayali-haric = 1 or dis-haric = 1 ) then 
       move rez-odano to odalar-anah
       read odalar no lock invalid continue
       not invalid
       if ( odalar-hayali = "H" and hayali-haric = 1 )  then
                move 0 to eklenecek-oda 
       end-if
        if ( dis-haric = 1 and odalar-dis = 1 )  then
                   go takas-kaydet-exit
       end-if 
       end-read
    end-if  

    if REZ-FOLIO > zeroes
         initialize konuk-rec
         move rez-folio to konuk-folio
         read konuk no lock invalid
                 continue
         not invalid
               if konuk-duzeltme = 1
                   go takas-kaydet-exit
               end-if
         end-read
    end-if

      if fiyat-cik = 1
***************************************
             move rez-no  to takasfiyat-rez-no
             move takvim-anah to takasfiyat-tarih
             read takasfiyat no lock 
                invalid
               
                   perform  peryot-fiyat-bul
                   
                    initialize cevrilmis-tl  cevrilmis-deger         
              perform varying jj from 1 by 1 until  jj > 399 
                if fiyatt-tar(jj) = takvim-anah
                
                  if gercek-cin-kuru = 1 then 
                      
                       compute cevrilmis-tl rounded =  fiyatt-fiy(jj) * 
                       fiyatt-kur(jj)
                   
                         if rez-doviz = butce-cev-doviz  then 
                                move  fiyatt-fiy(jj) to cevrilmis-deger
                           else
                              compute cevrilmis-deger rounded =  fiyatt-fiy(jj) * 
                                  fiyatt-kur(jj) / fiyatt-kurcev(jj)

                         end-if
                         
                    else
                       
                       compute cevrilmis-tl rounded =  fiyatt-fiy(jj) * 
                                    fiyatt-kur(jj)  
                      
                         if rez-doviz = butce-cev-doviz  then 
                             move  fiyatt-fiy(jj) to cevrilmis-deger
                           else
                              compute cevrilmis-deger rounded =  fiyatt-fiy(jj) * 
                                   fiyatt-kur(jj) / fiyatt-kurcev(jj)

                         end-if
                       
                  end-if
                     move fiyatt-fiy(jj) to  takasfiyat-fiyat
                  
                end-if
              end-perform  
             
              
              not invalid 
                   if gercek-cin-kuru = 1 then 
                      compute cevrilmis-deger rounded =  takasfiyat-fiyat * 
                       takasfiyat-kur / takasfiyat-kurcev 
                       compute cevrilmis-tl rounded =  takasfiyat-fiyat * 
                       takasfiyat-kur
                     
                         if rez-doviz = butce-cev-doviz 
                           move  takasfiyat-fiyat to cevrilmis-deger
                           else
                          compute cevrilmis-deger rounded =  takasfiyat-fiyat * 
                             takasfiyat-kur / takasfiyat-kurcev 

                         end-if

                
                    else
                       
                       compute cevrilmis-deger =  takasfiyat-fiyat *  
                       takasfiyat-kur / takasfiyat-kurcev 
                       compute cevrilmis-tl rounded =  takasfiyat-fiyat *  
                          takasfiyat-kur
                      
                         if rez-doviz = butce-cev-doviz
                           move  takasfiyat-fiyat to cevrilmis-deger
                           else
                          compute cevrilmis-deger rounded =  takasfiyat-fiyat * 
                             takasfiyat-kur / takasfiyat-kurcev 

                         end-if

                   
                  end-if
                    
             end-read
           end-if 

*
****evaluate true
****when takvim-anah = rez-gir-tar,
    if   takvim-anah = rez-gir-tar 
         compute d-takas3-oda   = d-takas3-oda   + eklenecek-oda 
         compute d-takas3-pax   = d-takas3-pax   + rez-buyuk 
         compute d-takas3-child = d-takas3-child + rez-kucuk 
         compute d-takas3-free  = d-takas3-free  + rez-free 
         compute d-takas3-bebek = d-takas3-bebek + rez-bebek 
    end-if
****when takvim-anah = rez-cik-tar
    if   takvim-anah = rez-cik-tar
         compute t-takas3-oda   = t-takas3-oda   + eklenecek-oda 
         compute t-takas3-pax   = t-takas3-pax   + rez-buyuk 
         compute t-takas3-child = t-takas3-child + rez-kucuk 
         compute t-takas3-free  = t-takas3-free  + rez-free 
         compute t-takas3-bebek = t-takas3-bebek + rez-bebek 
    end-if

    if   takvim-anah = rez-cik-tar and
         takvim-anah not = rez-gir-tar 
         compute s-takas3-oda   = s-takas3-oda   + eklenecek-oda 
         compute s-takas3-pax   = s-takas3-pax   + rez-buyuk 
         compute s-takas3-child = s-takas3-child + rez-kucuk 
         compute s-takas3-free  = s-takas3-free  + rez-free 
         compute s-takas3-bebek = s-takas3-bebek + rez-bebek 
    end-if
****when other 
    if   takvim-anah not = rez-gir-tar and 
         takvim-anah not = rez-cik-tar 
         compute s-takas3-oda   = s-takas3-oda   + eklenecek-oda 
         compute s-takas3-pax   = s-takas3-pax   + rez-buyuk 
         compute s-takas3-child = s-takas3-child + rez-kucuk 
         compute s-takas3-free  = s-takas3-free  + rez-free 
         compute s-takas3-bebek = s-takas3-bebek + rez-bebek 
    end-if
    
    compute g-takas3-oda   = ((s-takas3-oda   + d-takas3-oda)   - t-takas3-oda)
    compute g-takas3-pax   = ((s-takas3-pax   + d-takas3-pax)   - t-takas3-pax)
    compute g-takas3-child = ((s-takas3-child + d-takas3-child) - t-takas3-child)
    compute g-takas3-free  = ((s-takas3-free  + d-takas3-free)  - t-takas3-free)
    compute g-takas3-bebek = ((s-takas3-bebek + d-takas3-bebek) - t-takas3-bebek)
    compute g-takas3-tutar =  g-takas3-tutar +  cevrilmis-deger.
*
 xiii-TAKAS-KAYDET.
    evaluate true
    when rap-tip = "N"
          if rez-durumu not = "I"
                       go takas-kaydet-exit,
         end-if,
         if rez-k-g-b  not = "K" and  not = "O"
               go takas-kaydet-exit,
         end-if,
         if rez-k-g-b   = "O" |and info-dahil = 0
                go takas-kaydet-exit,
         end-if
        
    when rap-tip = "W"
         if rez-durumu not = "I"
                       go takas-kaydet-exit,
         end-if,
         if rez-k-g-b      = "K"
                       go takas-kaydet-exit,
         end-if,
    when rap-tip = "S"
         if rez-durumu not = "S"
                       go takas-kaydet-exit,
         end-if.
    if acn-kod not = spaces and 
       rez-acenta not = acn-kod
         go takas-kaydet-exit.

*** Grup Filtresi

    if acn-grup-kod not = spaces
      initialize grup-rec
      set grup-acenta to true
      move acn-grup-kod to grup-kodu
      move rez-acenta   to grup-alt
      read grup no lock
        invalid
          go takas-kaydet-exit
      end-read
    end-if

*** Grup Filtresi
    move 3 to tumu
    if tumu > 1 then
          
          move "B" to kodlar02-tipi
          move rez-odeme-tipi to kodlar02-kodu
          read kodlar02 no lock invalid 
              move spaces to kodlar02-adi
          end-read
          if ( ode-tipi = "D" or  ode-tipi = "F" or  ode-tipi = "O")   and tumu = 2 then
              go takas-kaydet-exit
          end-if
          if ( ode-tipi not = "D" and ode-tipi not = "F" and ode-tipi not = "O") and tumu = 3 then
             go takas-kaydet-exit
          end-if

    
    end-if
       move 1 to eklenecek-oda
   
*   TRACE Uygulamasi Acik ise kisi sayilari cast'tan alinacak
   
    if rezpara-trace = 1
       if rez-kisi not = cast-kisi
          move cast-kisi        to rez-kisi
       end-if
         move cast-share        to rez-share
         move cast-oda-no       to rez-odano
         move cast-fiyat-konumu to rez-fiyat-konumu
         move cast-oda-konumu   to rez-oda-konumu


       if rez-share = 1 then 
             move 0 to eklenecek-oda 
            else
              move 1 to eklenecek-oda
          end-if
      else 
          move 1 to eklenecek-oda
    end-if

    if onkpara-referans-var = 1 then 
       perform ref-filtre
       if  not ref-gecti then 
           exit paragraph
       end-if
    end-if

    if rez-odano not = spaces and  ( hayali-haric = 1 or dis-haric = 1 ) then 
              move rez-odano to odalar-anah
              read odalar no lock invalid continue
              not invalid
              if ( odalar-hayali = "H" and hayali-haric = 1 )  then
                       move 0 to eklenecek-oda 
              end-if
               if ( dis-haric = 1 and odalar-dis = 1 )  then
                          go takas-kaydet-exit
              end-if 
              end-read
    end-if  

    if REZ-FOLIO > zeroes
         initialize konuk-rec
         move rez-folio to konuk-folio
         read konuk no lock invalid
                 continue
         not invalid
               if konuk-duzeltme = 1
                   go takas-kaydet-exit
               end-if
         end-read
    end-if
    initialize konum-rec 
    move cast-oda-konumu to konum-anahtar 
    read konum no lock invalid
         continue
    end-read 


*   
****evaluate true
****when takvim-anah = rez-gir-tar,
    if   takvim-anah = rez-gir-tar,
         if konum-ref = 1 
            compute tmp-rs-gun(for-ii) = tmp-rs-gun(for-ii) + eklenecek-oda,
            compute tmp-rs-ay(for-ii)  = tmp-rs-ay(for-ii)  + rez-buyuk,
            compute tmp-rs-yil(for-ii) = tmp-rs-yil(for-ii) + rez-kucuk,
            compute tmp-rg-gun(for-ii) = tmp-rg-gun(for-ii) + rez-free,
            compute d-takas3-bebek     = d-takas3-bebek     + rez-bebek,
            compute tmp-rg-ay(for-ii)  = tmp-rs-gun(for-ii) +
                                         tmp-rs-ay(for-ii)  +
                                         tmp-rs-yil(for-ii) +
                                         tmp-rg-gun(for-ii) +
                                         d-takas3-bebek

         else
            compute tmp-hs-gun(for-ii) = tmp-hs-gun(for-ii) + eklenecek-oda,
            compute tmp-hs-ay(for-ii)  = tmp-hs-ay(for-ii)  + rez-buyuk,
            compute tmp-hs-yil(for-ii) = tmp-hs-yil(for-ii) + rez-kucuk,
            compute tmp-hg-gun(for-ii) = tmp-hg-gun(for-ii) + rez-free,
            compute d-takas3-bebek2    = d-takas3-bebek2    + rez-bebek,
            compute tmp-hg-ay(for-ii)  = tmp-hs-gun(for-ii) +
                                         tmp-hs-ay(for-ii)  +
                                         tmp-hs-yil(for-ii) +
                                         tmp-hg-gun(for-ii) +
                                         d-takas3-bebek2
         end-if
    end-if.
****when takvim-anah = rez-cik-tar
    if   takvim-anah = rez-cik-tar
         if konum-ref = 1 
            compute tmp-rs-gun(for-ii) = tmp-rs-gun(for-ii) - eklenecek-oda,
            compute tmp-rs-ay(for-ii)  = tmp-rs-ay(for-ii)  - rez-buyuk,
            compute tmp-rs-yil(for-ii) = tmp-rs-yil(for-ii) - rez-kucuk,
            compute tmp-rg-gun(for-ii) = tmp-rg-gun(for-ii) - rez-free,
            compute d-takas3-bebek     = d-takas3-bebek     - rez-bebek,
            compute tmp-rg-ay(for-ii)  = tmp-rs-gun(for-ii) +
                                         tmp-rs-ay(for-ii)  +
                                         tmp-rs-yil(for-ii) +
                                         tmp-rg-gun(for-ii) +
                                         d-takas3-bebek

         else
            compute tmp-hs-gun(for-ii) = tmp-hs-gun(for-ii) - eklenecek-oda,
            compute tmp-hs-ay(for-ii)  = tmp-hs-ay(for-ii)  - rez-buyuk,
            compute tmp-hs-yil(for-ii) = tmp-hs-yil(for-ii) - rez-kucuk,
            compute tmp-hg-gun(for-ii) = tmp-hg-gun(for-ii) - rez-free,
            compute d-takas3-bebek2    = d-takas3-bebek2    - rez-bebek,
            compute tmp-hg-ay(for-ii)  = tmp-hs-gun(for-ii) +
                                         tmp-hs-ay(for-ii)  +
                                         tmp-hs-yil(for-ii) +
                                         tmp-hg-gun(for-ii) +
                                         d-takas3-bebek2
         end-if
    end-if.

    if   takvim-anah = rez-cik-tar and
         takvim-anah not = rez-gir-tar 
         if konum-ref = 1 
            compute tmp-rs-gun(for-ii) = tmp-rs-gun(for-ii) + eklenecek-oda,
            compute tmp-rs-ay(for-ii)  = tmp-rs-ay(for-ii)  + rez-buyuk,
            compute tmp-rs-yil(for-ii) = tmp-rs-yil(for-ii) + rez-kucuk,
            compute tmp-rg-gun(for-ii) = tmp-rg-gun(for-ii) + rez-free,
            compute d-takas3-bebek     = d-takas3-bebek     + rez-bebek,
            compute tmp-rg-ay(for-ii)  = tmp-rs-gun(for-ii) +
                                         tmp-rs-ay(for-ii)  +
                                         tmp-rs-yil(for-ii) +
                                         tmp-rg-gun(for-ii) +
                                         d-takas3-bebek

         else
            compute tmp-hs-gun(for-ii) = tmp-hs-gun(for-ii) + eklenecek-oda,
            compute tmp-hs-ay(for-ii)  = tmp-hs-ay(for-ii)  + rez-buyuk,
            compute tmp-hs-yil(for-ii) = tmp-hs-yil(for-ii) + rez-kucuk,
            compute tmp-hg-gun(for-ii) = tmp-hg-gun(for-ii) + rez-free,
            compute d-takas3-bebek2    = d-takas3-bebek2 + rez-bebek,
            compute tmp-hg-ay(for-ii)  = tmp-hs-gun(for-ii) +
                                         tmp-hs-ay(for-ii)  +
                                         tmp-hs-yil(for-ii) +
                                         tmp-hg-gun(for-ii) +
                                         d-takas3-bebek2
         end-if
    end-if.
****when other,
    if   takvim-anah not = rez-gir-tar and 
         takvim-anah not = rez-cik-tar 
         if konum-ref = 1 
            compute tmp-rs-gun(for-ii) = tmp-rs-gun(for-ii) + eklenecek-oda,
            compute tmp-rs-ay(for-ii)  = tmp-rs-ay(for-ii)  + rez-buyuk,
            compute tmp-rs-yil(for-ii) = tmp-rs-yil(for-ii) + rez-kucuk,
            compute tmp-rg-gun(for-ii) = tmp-rg-gun(for-ii) + rez-free,
            compute d-takas3-bebek     = d-takas3-bebek     + rez-bebek,
            compute tmp-rg-ay(for-ii)  = tmp-rs-gun(for-ii) +
                                         tmp-rs-ay(for-ii)  +
                                         tmp-rs-yil(for-ii) +
                                         tmp-rg-gun(for-ii) +
                                         d-takas3-bebek

         else
            compute tmp-hs-gun(for-ii) = tmp-hs-gun(for-ii) + eklenecek-oda,
            compute tmp-hs-ay(for-ii)  = tmp-hs-ay(for-ii)  + rez-buyuk,
            compute tmp-hs-yil(for-ii) = tmp-hs-yil(for-ii) + rez-kucuk,
            compute tmp-hg-gun(for-ii) = tmp-hg-gun(for-ii) + rez-free,
            compute d-takas3-bebek2    = d-takas3-bebek2 + rez-bebek,
            compute tmp-hg-ay(for-ii)  = tmp-hs-gun(for-ii) +
                                         tmp-hs-ay(for-ii)  +
                                         tmp-hs-yil(for-ii) +
                                         tmp-hg-gun(for-ii) +
                                         d-takas3-bebek2
         end-if
    end-if.
    
    compute g-takas3-oda   = ((s-takas3-oda   + d-takas3-oda)   - t-takas3-oda)
    compute g-takas3-pax   = ((s-takas3-pax   + d-takas3-pax)   - t-takas3-pax)
    compute g-takas3-child = ((s-takas3-child + d-takas3-child) - t-takas3-child)
    compute g-takas3-free  = ((s-takas3-free  + d-takas3-free)  - t-takas3-free)
    compute g-takas3-bebek = ((s-takas3-bebek + d-takas3-bebek) - t-takas3-bebek).
    compute g-takas3-tutar =  g-takas3-tutar +  cevrilmis-deger
    .
    
*
* denemememememe-111.
*
*    initialize konum-rec 
*    move cast-oda-konumu to konum-anahtar 
*    read konum no lock invalid
*         continue
*    not invalid
*        evaluate konum-ref 
*            when 1
*                 compute tmp-rs-gun(for-ii) = tmp-rs-gun(for-ii) + eklenecek-oda 
*                 compute tmp-rs-ay (for-ii) = tmp-rs-ay (for-ii) + rez-buyuk
*                 compute tmp-rs-yil(for-ii) = tmp-rs-yil(for-ii) + rez-kucuk
*                 compute tmp-rg-gun(for-ii) = tmp-rg-gun(for-ii) + rez-free
*                 compute tmp-rg-ay (for-ii) = tmp-rs-ay (for-ii) + tmp-rs-yil(for-ii) 
*                                            + tmp-rg-gun (for-ii) + g-takas3-bebek
*                 compute tmp-rg-yil(for-ii) = (tmp-rs-gun(for-ii) * 100) / takvim-ref-hazir-oda(1)
*
*            when 2
*                 compute tmp-hs-gun(for-ii) = tmp-hs-gun(for-ii) + eklenecek-oda 
*                 compute tmp-hs-ay (for-ii) = tmp-hs-ay (for-ii) + rez-buyuk     
*                 compute tmp-hs-yil(for-ii) = tmp-hs-yil(for-ii) + rez-kucuk     
*                 compute tmp-hg-gun(for-ii) = tmp-hg-gun(for-ii) + rez-free      
*                 compute tmp-hg-ay (for-ii) = tmp-hs-ay (for-ii) + tmp-hs-yil (for-ii) 
*                                            + tmp-hg-gun (for-ii) + g-takas3-bebek
*                 compute tmp-hg-yil(for-ii) = (tmp-hs-gun(for-ii) * 100) / takvim-ref-hazir-oda(2)
*        end-evaluate
*        compute t-hazir-oda        = takvim-ref-hazir-oda(1) + takvim-ref-hazir-oda(2)
*        compute tmp-ts-gun(for-ii) = tmp-rs-gun(for-ii) + tmp-hs-gun(for-ii)
*        compute tmp-ts-ay (for-ii) = tmp-rs-ay (for-ii) + tmp-hs-ay (for-ii)
*        compute tmp-ts-yil(for-ii) = tmp-rs-yil(for-ii) + tmp-hs-yil(for-ii)
*        compute tmp-tg-gun(for-ii) = tmp-rg-gun(for-ii) + tmp-hg-gun(for-ii)
*        compute tmp-tg-ay (for-ii) = tmp-ts-ay (for-ii) + tmp-ts-ay (for-ii) 
*                                   + tmp-ts-ay (for-ii) + g-takas3-tutar
*        compute tmp-tg-yil(for-ii) = (tmp-ts-gun(for-ii) * 100) / t-hazir-oda
*    end-read       
*
**                 compute oda-yuzde = (tmp-rs-gun(52 + for-i) * 100) / takvim-ref-hazir-oda(1)
**                 move oda-yuzde    to z-yuzde
**                 move z-yuzde      to tmp-rg-yil(52 + for-i)
*   .
* 
 takas-kaydet-exit.
                if fiyat-ref > 0 then 
                     move takvim-ref-hazir-oda (fiyat-ref) to  takvim-hazir-oda
                     
                      move takvim-ref-hazir-yatak (fiyat-ref) to  takvim-hazir-yatak
                  end-if
                  if oda-ref > 0 then 
                      move takvim-ref-hazir-oda (oda-ref) to  takvim-hazir-oda  
                      move takvim-ref-hazir-yatak (oda-ref) to  takvim-hazir-yatak
                  end-if
     move takvim-hazir-oda to takas3-hazir-oda.
*
 toplam-oda-topla.
     initialize xz xy 
     compute xz = tmp-satir - 1 
     compute xy = tmp-satir - 2
     compute tmp-rs-gun(tmp-satir) = tmp-rs-gun(xz) + tmp-rs-gun(xy)
     compute tmp-rs-ay(tmp-satir)  = tmp-rs-ay(xz)  + tmp-rs-ay(xy)
     compute tmp-rs-yil(tmp-satir) = tmp-rs-yil(xz) + tmp-rs-yil(xy)
     compute tmp-rg-gun(tmp-satir) = tmp-rg-gun(xz) + tmp-rg-gun(xy)
     compute tmp-rg-ay(tmp-satir)  = tmp-rg-ay(xz)  + tmp-rg-ay(xy)
     compute tmp-rg-yil(tmp-satir) = tmp-rg-yil(xz) + tmp-rg-yil(xy)

     compute tmp-hs-gun(tmp-satir) = tmp-hs-gun(xz) + tmp-hs-gun(xy)
     compute tmp-hs-ay(tmp-satir)  = tmp-hs-ay(xz)  + tmp-hs-ay(xy)
     compute tmp-hs-yil(tmp-satir) = tmp-hs-yil(xz) + tmp-hs-yil(xy)
     compute tmp-hg-gun(tmp-satir) = tmp-hg-gun(xz) + tmp-hg-gun(xy)
     compute tmp-hg-ay(tmp-satir)  = tmp-hg-ay(xz)  + tmp-hg-ay(xy)
     compute tmp-hg-yil(tmp-satir) = tmp-hg-yil(xz) + tmp-hg-yil(xy)

     compute tmp-ts-gun(tmp-satir) = tmp-ts-gun(xz) + tmp-ts-gun(xy)
     compute tmp-ts-ay(tmp-satir)  = tmp-ts-ay(xz)  + tmp-ts-ay(xy)
     compute tmp-ts-yil(tmp-satir) = tmp-ts-yil(xz) + tmp-ts-yil(xy)
     compute tmp-tg-gun(tmp-satir) = tmp-tg-gun(xz) + tmp-tg-gun(xy)
     compute tmp-tg-ay(tmp-satir)  = tmp-tg-ay(xz)  + tmp-tg-ay(xy)
     compute tmp-tg-yil(tmp-satir) = tmp-tg-yil(xz) + tmp-tg-yil(xy)
    .

*
 genel2-cinkdv-ayarla. 
     if genel2-kdv-gecerlilik-tar not = spaces and genel2-kdv-gecerlilik-tar not = zeroes
*             if kdv-rap-tarih < genel2-kdv-gecerlilik-tar or kdv-rap-tarih > 20201231  |firat 15/12/2020 dzeltme
*             if kdv-rap-tarih < genel2-kdv-gecerlilik-tar or kdv-rap-tarih >= 20210601 |firat 26/04/2021 dzeltme
*             if kdv-rap-tarih < genel2-kdv-gecerlilik-tar or kdv-rap-tarih >= 20210630
            if genel2-kdv-bit-tar = spaces or genel2-kdv-bit-tar = zeroes then
                   move 20210731 to genel2-kdv-bit-tar
            end-if
            if kdv-rap-tarih < genel2-kdv-gecerlilik-tar or kdv-rap-tarih >= genel2-kdv-bit-tar 
                  move 8 to CINPARA-MUS-KDV
             else
                  move 1 to CINPARA-MUS-KDV
             end-if
      end-if.
      if  kdv-rap-tarih >= 20230710
                   move 10 to CINPARA-MUS-KDV
                
                end-if.

 
