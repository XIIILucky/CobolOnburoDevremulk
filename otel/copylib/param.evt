* param.evt
* param.evt is generated from D:\asya\acugt.ytl\otel\param.Psf
* This is a generated file. DO NOT modify this file directly.


 Acu-tab-1-Cmd-Tabchanged.
     EVALUATE Event-Type
     WHEN Cmd-Tabchanged
        MOVE Event-Data-1 TO tab-1-value
        MOVE 0 TO Form1-Pg-1-Visible, Form1-Pg-2-Visible,
            Form1-Pg-3-Visible, Form1-Pg-4-Visible, Form1-Pg-5-Visible,
            Form1-Pg-6-Visible, Form1-Pg-7-Visible, Form1-Pg-8-Visible
        EVALUATE Event-Data-1
        WHEN 1
           MOVE 1 TO Form1-Pg-1-Visible
        WHEN 2
           MOVE 1 TO Form1-Pg-2-Visible
        WHEN 3
           MOVE 1 TO Form1-Pg-3-Visible
        WHEN 4
           MOVE 1 TO Form1-Pg-4-Visible
        WHEN 5
           MOVE 1 TO Form1-Pg-5-Visible
        WHEN 6
           MOVE 1 TO Form1-Pg-6-Visible
        WHEN 7
           MOVE 1 TO Form1-Pg-7-Visible
        WHEN 8
           MOVE 1 TO Form1-Pg-8-Visible
        END-EVALUATE
*       Before-Tabchg-Display
        DISPLAY Form1
*       After-Tabchg-Display
     END-EVALUATE
     .

 Form1-Exception-Proc.
     PERFORM exception-procedure
     .

 Form1-Ta-1-Event-Proc.
* 
     EVALUATE Event-Type
     WHEN Cmd-Tabchanged
        PERFORM Form1-Ta-1-Ev-Cmd-Tabchanged
     END-EVALUATE
     .

 combo-kbs-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM combo-kbs-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 accept-0104-Exception-Proc.
     PERFORM accept-0104-Ex-Other
     .

 cb-0301-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 combo-dil-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM combo-dil-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 cmb-comp-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM cmb-comp-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 Form1-Pg-1-Cm-2-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM Form1-Pg-1-Cm-2-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 cb-0201-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0202-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0203-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0204-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0205-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0206-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0207-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0208-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0209-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0210-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0211-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0212-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0213-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0214-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0215-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0216-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0217-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 combo-0301-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM combo-0301-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 Form1-Cb-2l-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0501-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0502-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0503-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0504-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0505-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1a-Event-Proc.
     .

 Form1-Cb-1a-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1a-Ev-Other
        END-EVALUATE
     END-IF
     .

 cb-0506-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 rb-0501-Exception-Proc.
     PERFORM rb-0501-Ex-Other
     .

 rb-0502-Exception-Proc.
     PERFORM rb-0501-Ex-Other
     .

 rb-0503-Exception-Proc.
     PERFORM rb-0501-Ex-Other
     .

 rb-0504-Exception-Proc.
     PERFORM rb-0501-Ex-Other
     .

 lb-0501-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM lb-0501-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 cb-0701-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Tab-2-Checkbox-Notify
        END-EVALUATE
     END-IF
     .

 cb-0705-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM tab-2-checkbox-notify
        END-EVALUATE
     END-IF
     .

 Form1-Pb-9-Exception-Proc.
     PERFORM Form1-Pb-9-Ex-Other
     .

 cb-0706-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM tab-2-checkbox-notify
        END-EVALUATE
     END-IF
     .

 cb-0707-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM tab-2-checkbox-notify
        END-EVALUATE
     END-IF
     .

 Form2-Event-Proc.
     .

 Form2-Exception-Proc.
     PERFORM Form2-Ex-Other
     .

 Form3-Event-Proc.
     .

 Form3-Exception-Proc.
     PERFORM Form3-Ex-Other
     .

 Form3-Cm-1-Exception-Proc.
     PERFORM Form3-Cm-1-Ex-Other
     .

 Form3-Gd-1-Event-Proc.
     .

 form4-Exception-Proc.
     PERFORM form4-Ex-Other
     .
***   start event editor code   ***
*
 tablo1-before.
     initialize statusbar1-text.
     evaluate control-id
         when 07 
              evaluate true
                  when turkce     move "Donem Basi Tarihini Giriniz"        to statusbar1-text
                  when almanca    move "Hello ....................."        to statusbar1-text
                  when ingilizce  move "Hello ....................."        to statusbar1-text
              end-evaluate
         when 08
              evaluate true             
                  when turkce     move "Donem Sonu Tarihini Giriniz"        to statusbar1-text
                  when almanca    move "Donem Sonu Tarihini Giriniz"        to statusbar1-text
                  when ingilizce  move "Donem Sonu Tarihini Giriniz"        to statusbar1-text
              end-evaluate
         when 16 
              evaluate true
                  when turkce     move "Muhasebe Entegre Sirketini Giriniz" to statusbar1-text
                  when almanca    move "Muhasebe Entegre Sirketini Giriniz" to statusbar1-text
                  when ingilizce  move "Muhasebe Entegre Sirketini Giriniz" to statusbar1-text
              end-evaluate
         when 17 
              evaluate true
                  when turkce     move "Stok Entegre Sirketini Giriniz    " to statusbar1-text
                  when almanca    move "Stok Entegre Sirketini Giriniz    " to statusbar1-text
                  when ingilizce  move "Stok Entegre Sirketini Giriniz    " to statusbar1-text
              end-evaluate
         when 18 
              evaluate true
                  when turkce     move "Cost Entegre Sirketini Giriniz    " to statusbar1-text
                  when almanca    move "Cost Entegre Sirketini Giriniz    " to statusbar1-text
                  when ingilizce  move "Cost Entegre Sirketini Giriniz    " to statusbar1-text
              end-evaluate
         when 19 
              evaluate true
                  when turkce     move "Personel Entegre Sirketini Giriniz" to statusbar1-text
                  when almanca    move "Personel Entegre Sirketini Giriniz" to statusbar1-text
                  when ingilizce  move "Personel Entegre Sirketini Giriniz" to statusbar1-text
              end-evaluate
         when 20 
              evaluate true
                  when turkce     move "P.o.s. Entegre Sirketini Giriniz  " to statusbar1-text
                  when almanca    move "P.o.s. Entegre Sirketini Giriniz  " to statusbar1-text
                  when ingilizce  move "P.o.s. Entegre Sirketini Giriniz  " to statusbar1-text
              end-evaluate
         when 23 
              evaluate true
                  when turkce     move "Diger Entegre Sirketini Giriniz   " to statusbar1-text
                  when almanca    move "Diger Entegre Sirketini Giriniz   " to statusbar1-text
                  when ingilizce  move "Diger Entegre Sirketini Giriniz   " to statusbar1-text
              end-evaluate
         when 24 
              evaluate true
                  when turkce     move "Diger Entegre Sirketini Giriniz   " to statusbar1-text
                  when almanca    move "Diger Entegre Sirketini Giriniz   " to statusbar1-text
                  when ingilizce  move "Diger Entegre Sirketini Giriniz   " to statusbar1-text
              end-evaluate
         when 26 
              evaluate true
                  when turkce     move "Rapor Dosya Adresini Giriniz      " to statusbar1-text
                  when almanca    move "Rapor Dosya Adresini Giriniz      " to statusbar1-text
                  when ingilizce  move "Rapor Dosya Adresini Giriniz      " to statusbar1-text
              end-evaluate
     end-evaluate.
     modify statusbar1-handle,
             panel-index = 2
             style       = 1
             panel-text  = statusbar1-text.
     
     .
*
 default-ata.
          move "E" to GENEL-OTO-PERYOT
       move 1 to REZPARA-TRACE
      if rezpara-aygun             = spaces move "G" to rezpara-aygun.
      if rezpara-k-g-b             = spaces move "K" to rezpara-k-g-b.
      if rezpara-adi-bosgec        = spaces move "E" to rezpara-adi-bosgec.
      if rezpara-soyadi-bosgec     = spaces move "E" to rezpara-soyadi-bosgec.
      if rezpara-short-uyari       = spaces move "H" to rezpara-short-uyari.
      if rezpara-short-gecsin      = spaces move "E" to rezpara-short-gecsin.
      if rezpara-stops-uyari       = spaces move "H" to rezpara-stops-uyari.
      if rezpara-stops-gecsin      = spaces move "E" to rezpara-stops-gecsin.
      if rezpara-eskimus-ara       = spaces move "H" to rezpara-eskimus-ara.
      if rezpara-mukerrer-ara      = spaces move "H" to rezpara-mukerrer-ara.
      if rezpara-mukerrer-nasil    = spaces move "I" to rezpara-mukerrer-nasil.
      if rezpara-mukerrer-gecsin   = spaces move "E" to rezpara-mukerrer-gecsin.
      if rezpara-detay-alsin       = spaces move "E" to rezpara-detay-alsin.
      if rezpara-blokaj            = spaces move "E" to rezpara-blokaj.
      if rezpara-fis-sor           = spaces move "E" to rezpara-fis-sor.
      if rezpara-duz-fis           = spaces move "E" to rezpara-duz-fis.
      if rezpara-blokaj-farkli     = spaces move "E" to rezpara-blokaj-farkli.
      if rezpara-cifte-blokaj      = spaces move "E" to rezpara-cifte-blokaj.
      if rezpara-kont-uyari        = spaces move "E" to rezpara-kont-uyari.
      if rezpara-kont-gecsin       = spaces move "E" to rezpara-kont-gecsin.
      if rezpara-kont-tipi         = zeroes move  0  to rezpara-kont-tipi.
      if cinpara-ext-fol-aygun     = spaces move "G" to cinpara-ext-fol-aygun.
  
      if cinpara-breakdown         = spaces move "H" to cinpara-breakdown.
      if cinpara-breakdown-cik     = spaces move "E" to cinpara-breakdown-cik.
      if cinpara-dolu-odaya        = spaces move "H" to cinpara-dolu-odaya.
      if cinpara-musteri-kodu      = spaces move "E" to cinpara-musteri-kodu.
      if cinpara-farkli-konuma-cin = spaces move "E" to cinpara-farkli-konuma-cin.
      if cinpara-oto-slip          = spaces move "H" to cinpara-oto-slip.
      if cinpara-dolu-oda-chg      = spaces move "E" to cinpara-dolu-oda-chg.
      if cinpara-farkli-konum-chg  = spaces move "E" to cinpara-farkli-konum-chg.
      if cinpara-shortta-uzat      = spaces move "E" to cinpara-shortta-uzat.
      if cinpara-tumtar-uzat       = spaces move "E" to cinpara-tumtar-uzat.
      if cinpara-kur-duzelt        = spaces move "H" to cinpara-kur-duzelt.
      if cinpara-peryot-kuru       = spaces move "H" to cinpara-peryot-kuru.
      if cinpara-reg-varmi         = spaces move "H" to cinpara-reg-varmi.
      if cinpara-reg-fis           = spaces move "H" to cinpara-reg-fis.
      if cinpara-pax-degis         = spaces move "E" to cinpara-pax-degis.
      if cinpara-bos-odalar-ciksin = spaces move "E" to cinpara-bos-odalar-ciksin.
      if cinpara-dag-komisyondan   = spaces move "H" to cinpara-dag-komisyondan.
      if onkpara-reopen            = spaces move "E" to onkpara-reopen.
      if onkpara-ipt-post-yaz      = spaces move "H" to onkpara-ipt-post-yaz.
      if onkpara-kart-odenmez-yarat = spaces move "H" to onkpara-kart-odenmez-yarat.
      if onkpara-dov-boz-tlden     = spaces move "H" to onkpara-dov-boz-tlden.
      if onkpara-folio-dep-toplam  = spaces move "H" to onkpara-folio-dep-toplam.
      if telpara-fol-tipi          = spaces move "E" to telpara-fol-tipi.
      if genel-log                 = spaces move 1   to genel-log.
      if genel-log-seviye          = spaces or zeroes move 1 to genel-log-seviye.
                   

*
 Form1-Bef-Create.   
     perform adresleri-tasi. 
     open i-o genel genel2.
     initialize genel-rec.
     move 1 to genel-anahtar.
     read genel no lock invalid
          perform default-ata
          initialize mesaj-link
          move 03 to mesaj-no
          perform mesaj-ver
          not invalid
           continue
     end-read

     initialize genel2-rec.
     move 1 to genel2-anah.
     read genel2 no lock invalid
          continue
     end-read

     move genel-plaka to yedek-plaka
     move "E" to GENEL-OTO-PERYOT
       move 1 to REZPARA-TRACE
     close genel genel2.
     move 2 to rezpara-trace
     open i-o genelfis.
     move 2 to genelfis-anahtar.
     read genelfis no lock invalid
          initialize mesaj-link
          move 03 to mesaj-no
          perform mesaj-ver
          move 2 to genelfis-anahtar
          move 1 to acc-acenta-no acc-firma-no acc-share-no
         write genelfis-rec end-write
     end-read
     move acenta-no      to acc-acenta-no
     move firma-no       to acc-firma-no
     move share-no       to acc-share-no
     
     close genelfis.     

     open i-o genelfis.
     move 1 to genelfis-anahtar.
     read genelfis no lock invalid
          initialize mesaj-link
          move 03 to mesaj-no
          perform mesaj-ver
          move 1 to genelfis-anahtar
          move 1 to rez-oto folio-oto cekgir-oto
                     dov-boz-oto
                    print-no ekran-fis-1
                    genelfis-log-no tel-fis-oto
                    hk-tk-servis-no pos-oto-odenmez-no profile-oto
          move 1 to fihrist-oto of genelfis-rec
          write genelfis-rec end-write
     end-read
     close genelfis.

     .
*
 Form1-Aft-Initdata.
    
*---------------[1.TAB]----------------    
*---------------[2.TAB]---------------- 
                 if onkpara-dovboz-komisyon-bas = 1 then 
                            perform dep-kontrol
                 end-if   
     modify combo-0201,
            reset-list  = 1
            mass-update = 1
     modify combo-0202,
            reset-list  = 1
            mass-update = 1
     modify combo-0203,
            reset-list  = 1
            mass-update = 1
     modify combo-0204,
            reset-list  = 1
            mass-update = 1


     modify combo-0301,
            reset-list  = 1
            mass-update = 1
     modify combo-0701,
            reset-list  = 1
            mass-update = 1
   
     if genel-oto-peryot = "E"
        move 1 to cb-oto-peryot-value
     else
        move 0 to cb-oto-peryot-value
     end-if 
    
     if cinpara-ext-fol-aygun = "A" move 2 to rb-degisken-1
        else                        move 1 to rb-degisken-1
     end-if.
     modify form1-rb-1,  GROUP-VALUE = rb-degisken-1.

     if cinpara-peryot-kuru = "R" move 1 to rb-degisken-2
        else                      move 2 to rb-degisken-2
     end-if.
     modify form1-rb-2,  GROUP-VALUE = rb-degisken-2.

     move 1 to rb-degisken-3.
     evaluate onkpara-d-e
        when "D" 
          if onkpara-a-s = "A" move 1 to rb-degisken-3
          else                 move 2 to rb-degisken-3
          end-if
        when "E" 
          if onkpara-a-s = "A" move 3 to rb-degisken-3
          else                 move 4 to rb-degisken-3
          end-if
     end-evaluate.
     modify rb-0501,  GROUP-VALUE = rb-degisken-3.

     if genel-turkce
        move "T-Turkce"             to combo-dil-value
     else
        move genel-dil              to combo-dil-value
     end-if
     evaluate genel-kbs-bolgesi 
         when "J"
              move "J-Jandarma"           to combo-kbs-value
         when "P"
              move "P-Polis"              to combo-kbs-value
     end-evaluate

     move genel2-rapor-comp-durumu        to combo-comp-durumu
     move genel2-kolayrez-dys-tip         to cmb-kolayrez-dys-tip

     display combo-dil combo-kbs cmb-comp Form1-Pg-1-Cm-2

     evaluate true
         when turkce
              modify combo-0201,
                     item-to-add("G-Gunluk","A-Aybasi")
              modify combo-0202,
                     item-to-add("K-Konfirme","G-Gecici","B-Beklemede")
              modify combo-0203,
                     item-to-add("I-Isim","V-Voucher","T-Isim+Voucher")
              modify combo-0204,
                     item-to-add("0-Ayri ayri","1-Single","2-Double","3-Triple","4-Grup")
              modify combo-0301,
                     item-to-add("E-Extra Folio","T-Telefon Foliosu")
              modify combo-0701,
                     item-to-add("R-Room","E-Extra","T-Telefon","G-Grup")
     end-evaluate.
 
     modify combo-0201,
         value = "G"
         mass-update = 0.


     modify combo-0202,
         value = "K"
         mass-update = 0.

     modify combo-0203,
         value = "I"
         mass-update = 0.

     modify combo-0204,
         value = "0"
         mass-update = 0.

     move rezpara-aygun          to combo-0201-value.
     move rezpara-k-g-b          to combo-0202-value. 
     move rezpara-mukerrer-nasil to combo-0203-value.
     move rezpara-kont-tipi      to combo-0204-value. 
      
     modify combo-0201,
         mass-update = 0.
     modify combo-0202,
         mass-update = 0.
     modify combo-0203,
         mass-update = 0.
     modify combo-0204,
         mass-update = 0.

     modify combo-0301,
         value = "E"
         mass-update = 0.

     modify combo-0701,
         value = "E"
         mass-update = 0.
      
*---------------[3.TAB]----------------    
     initialize tek-hane
     if cinpara-ext-fol-ac = "E" move 1 to tek-hane end-if
     modify cb-0301, value tek-hane
     initialize tek-hane
     if cinpara-breakdown = "E" move 1 to tek-hane end-if
     modify cb-0302, value tek-hane
     initialize tek-hane
     if cinpara-breakdown-cik = "E" move 1 to tek-hane end-if
     modify cb-0303, value tek-hane
     initialize tek-hane
     if cinpara-dolu-odaya = "E" move 1 to tek-hane end-if
     modify cb-0304, value tek-hane
     initialize tek-hane
     if cinpara-musteri-kodu = "E" move 1 to tek-hane end-if
     modify cb-0305, value tek-hane
     initialize tek-hane
     if cinpara-farkli-konuma-cin = "E" move 1 to tek-hane end-if
     modify cb-0306, value tek-hane
     initialize tek-hane
     if cinpara-oto-slip = "E" move 1 to tek-hane end-if
     modify cb-0307, value tek-hane
     initialize tek-hane
     if cinpara-dolu-oda-chg = "E" move 1 to tek-hane end-if
     modify cb-0308, value tek-hane
     initialize tek-hane
     if cinpara-farkli-konum-chg = "E" move 1 to tek-hane end-if
     modify cb-0309, value tek-hane
     initialize tek-hane
     if cinpara-shortta-uzat = "E" move 1 to tek-hane end-if
     modify cb-0310, value tek-hane
     initialize tek-hane
     if cinpara-tumtar-uzat = "E" move 1 to tek-hane end-if
     modify cb-0311, value tek-hane
     initialize tek-hane
     if cinpara-kur-duzelt = "E" move 1 to tek-hane end-if
     modify cb-0312, value tek-hane
     initialize tek-hane
     if cinpara-reg-varmi = "E" move 1 to tek-hane end-if
     modify cb-0313, value tek-hane
     initialize tek-hane
     if cinpara-reg-fis = "E" move 1 to tek-hane end-if
     modify cb-0314, value tek-hane.
     initialize tek-hane
     if cinpara-pax-degis = "E" move 1 to tek-hane end-if
     modify cb-0315, value tek-hane.
     initialize tek-hane
     if cinpara-bos-odalar-ciksin = "E" move 1 to tek-hane end-if
     modify cb-0316, value tek-hane.
     initialize tek-hane
     if cinpara-dag-komisyondan = "E" move 1 to tek-hane end-if
     modify cb-0317, value tek-hane.
*---------------[4.TAB]----------------    
*---------------[5.TAB]----------------    
    modify lb-0501,
           reset-list = 1
           mass-update = 1
    evaluate  true
        when turkce
             modify lb-0501,item-to-add("01-(+) Corr.Departmani")
             modify lb-0501,item-to-add("02-(-) Corr.Departmani")
             modify lb-0501,item-to-add("03-Paid Out Departmani")
             modify lb-0501,item-to-add("04-Guest Refund Departmani")
             modify lb-0501,item-to-add("05-Outlet Cash Departmani")
             modify lb-0501,item-to-add("06-Depozit Departmani")
             modify lb-0501,item-to-add("07-Discount Departmani")
             modify lb-0501,item-to-add("08-Muhtelif Departmani")
             modify lb-0501,item-to-add("09-Kredi Karti Departmani")
             modify lb-0501,item-to-add("10-City Ledger Departmani")
             modify lb-0501,item-to-add("11-Ticket Departmani")
             modify lb-0501,item-to-add("12-Outlet Kredi Karti")
        when almanca
             modify lb-0501,item-to-add("01-(+) Corr.Departmani")
             modify lb-0501,item-to-add("02-(-) Corr.Departmani")
             modify lb-0501,item-to-add("03-Paid Out Departmani")
             modify lb-0501,item-to-add("04-Guest Refund Departmani")
             modify lb-0501,item-to-add("05-Outlet Cash Departmani")
             modify lb-0501,item-to-add("06-Depozit Departmani")
             modify lb-0501,item-to-add("07-Discount Departmani")
             modify lb-0501,item-to-add("08-Muhtelif Departmani")
             modify lb-0501,item-to-add("09-Kredi Karti Departmani")
             modify lb-0501,item-to-add("10-City Ledger Departmani")
             modify lb-0501,item-to-add("11-Diger-1")
             modify lb-0501,item-to-add("12-Diger-2")
        when ingilizce
             modify lb-0501,item-to-add("01-(+) Corr.Departmani")
             modify lb-0501,item-to-add("02-(-) Corr.Departmani")
             modify lb-0501,item-to-add("03-Paid Out Departmani")
             modify lb-0501,item-to-add("04-Guest Refund Departmani")
             modify lb-0501,item-to-add("05-Outlet Cash Departmani")
             modify lb-0501,item-to-add("06-Depozit Departmani")
             modify lb-0501,item-to-add("07-Discount Departmani")
             modify lb-0501,item-to-add("08-Muhtelif Departmani")
             modify lb-0501,item-to-add("09-Kredi Karti Departmani")
             modify lb-0501,item-to-add("10-City Ledger Departmani")
             modify lb-0501,item-to-add("11-Diger-1")
             modify lb-0501,item-to-add("12-Diger-2")
    end-evaluate
    modify lb-0501,
             mass-update = 1.
     display  form1-cm-1
*---------------[1.TAB]----------------    
*---------------[1.TAB]----------------    
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*              
     .
*
 exception-procedure.
     evaluate key-status 
          when 5
              perform acu-form4-routine
         when 17 
             move genel-dosya         to link-logview-dosya-adi
             set link-logview-pointer  to address of genel-rec
             set link-logview-rec-size to size of genel-rec
             perform logview-call
             initialize key-status

           when 5001
                inquire lb-0501, selection-index in i
                if i not > zeroes
                   display omitted beep
                   exit paragraph
                end-if
                inquire accept-0501, value in accept-0501-value
                if accept-0501-value = spaces 
                   move 4 to accept-control
                   move 170 to control-id
                   exit paragraph
                end-if
                open input depkod
                move accept-0501-value to depkod-anah
                read depkod no lock invalid
                     move all "*" to depkod-adi
                     display omitted beep
                     close depkod
                     move 4 to accept-control
                     move 170 to control-id
                     exit paragraph
                not invalid
                     modify lb-0501,query-index = i 
                     inquire lb-0501,
                             item-value = lb-0501-value
                     move depkod-anah to lb-1-col-2
                     move depkod-adi  to lb-1-col-3
                     modify lb-0501,  item-to-delete(i)
                     modify lb-0501,  
                             mass-update = 1 
                             insertion-index = i 
                             item-to-add(lb-0501-value)
                             selection-index = i
                             mass-update = 0
                     close depkod
                     modify accept-0501,value " "
                     modify accept-0502,value = " "
                end-read
           when 002
                initialize mesaj-link
                move 01 to mesaj-no
                perform mesaj-ver
                if mesaj-evet
                        open i-o genelfis
                        move 1 to genelfis-anahtar
                        rewrite genelfis-rec end-rewrite
*                                perform log-operation-genelfis
                        close genelfis

                        open i-o genelfis
                        move 2 to genelfis-anahtar
                        read genelfis no lock invalid
                            continue
                        end-read
                        move acc-acenta-no      to acenta-no
                        move acc-firma-no       to firma-no
                        move acc-share-no       to share-no
                        rewrite genelfis-rec end-rewrite
*                                perform log-operation-genelfis
                        close genelfis
                         if onkpara-dovboz-komisyon-bas = 1 then 
                            perform dep-kontrol
                         end-if
                        

                        if genel-log-seviye  = spaces or zeroes 
                           move 1 to genel-log-seviye
                        end-if
                        open i-o genel genel2
*                        move 1 to genel-anahtar
                        move k-kodu-tasi       to genel-staf
                        move combo-kbs-value   to genel-kbs-bolgesi
                        move combo-comp-durumu(1:1) to genel2-rapor-comp-durumu
                        move cmb-kolayrez-dys-tip(1:1)   to genel2-kolayrez-dys-tip
                        rewrite genel-rec invalid 
                                write genel-rec invalid continue
                                end-write
                        end-rewrite
                        rewrite genel2-rec invalid 
                                write genel2-rec invalid continue
                                end-write
                        end-rewrite


                            perform log-operation-genel
                        close genel genel2
                        if  genel-plaka = 1 and  yedek-plaka = 0
                          
                            open input ozluk
                            open i-o plaka
                              initialize plaka-rec ozluk-rec
                                start ozluk key > ozluk-folio  invalid continue
                                        not invalid 
                                        perform until fs-ozluk = "10" 
                                          read ozluk next no lock end move "10" to fs-ozluk
                                             not end
                                                 if ozluk-plaka > spaces
                                                      move 1 to plaka-sira
                                                      move  ozluk-folio  to   plaka-folio
                                                      move  ozluk-plaka  to   plaka-text
                                                      write plaka-rec invalid continue end-write
                                                 end-if
                                          end-read
                                          end-perform
                                  end-start
                            close plaka ozluk   
                        end-if
                end-if
           when 001
                evaluate true
                    when control-id = 212 or 213 or 216 or 217 or 220 or
                                      221 or 224 or 225 or 228 or 229 or
                                      232 or 233 or 236 or 237 or 240 or
                                      241 or 244 or 245 or 248 or 249

                    initialize durum-cagir
                    move "C"  to durum-tipi-cagir
                    call "/asya/ytl/obj/otel/durumara.asy" using durum-cagir
                         on exception perform callerr-proc
                         not on exception
                    cancel "/asya/ytl/obj/otel/durumara.asy" 
                    end-call
                              initialize key-status
                              if durum-kodu-cagir not = spaces
                              evaluate true
                                    when control-id = 212 or 213 move durum-kodu-cagir to house-bt
                                                                 display accept-0801 move 212 to control-id
                                    when control-id = 216 or 217 move durum-kodu-cagir to house-bk
                                                                 display accept-0802 move 216 to control-id
                                    when control-id = 220 or 221 move durum-kodu-cagir to house-dt
                                                                 display accept-0803 move 220 to control-id
                                    when control-id = 224 or 225 move durum-kodu-cagir to house-dk
                                                                 display accept-0804 move 224 to control-id
                                    when control-id = 228 or 229 move durum-kodu-cagir to house-ci
                                                                 display accept-0805 move 228 to control-id
                                    when control-id = 232 or 233 move durum-kodu-cagir to house-co
                                                                 display accept-0806 move 232 to control-id
                                    when control-id = 236 or 237 move durum-kodu-cagir to house-ao
                                                                 display accept-0807 move 236 to control-id
                                    when control-id = 240 or 241 move durum-kodu-cagir to house-re
                                                                 display accept-0808 move 240 to control-id
                                    when control-id = 244 or 245 move durum-kodu-cagir to house-ps
                                                                 display accept-0809 move 244 to control-id
                                    when control-id = 248 or 249 move durum-kodu-cagir to house-so
                                                                 display accept-0810 move 248 to control-id
                                 end-evaluate
                                 perform tab-2-after
                                 end-if

                         move 4 to accept-control

                    when control-id =  40 or 123 or 260 or 262 or
                                      287 or 288 or 131 or 132

                         initialize banka-cagir
                         call "/asya/ytl/obj/otel/bankaara.asy" using banka-cagir
                              on exception perform callerr-proc
                              not on exception
                         cancel "/asya/ytl/obj/otel/bankaara.asy" 
                         end-call
                              initialize key-status
                              if banka-cagir not = spaces
                              evaluate true
                                    when control-id =  40 or 123 move banka-cagir to rezpara-banka
                                                                 display accept-0201 move  40 to control-id
                                    when control-id = 260 or 262 move banka-cagir to cinpara-ext-fol-banka
                                                                 display accept-0803 move 262 to control-id
                                    when control-id = 287 or 288 move banka-cagir to cinpara-banka
                                                                 display accept-0308 move 288 to control-id
                                    when control-id = 131 or 132 move banka-cagir to onkpara-banka
                                                                 display accept-0503 move 131 to control-id
                                 end-evaluate
                                 perform tab-2-after
                                 end-if

                         move 4 to accept-control

                end-evaluate
     end-evaluate.
     
     .
*
 Form1-Ta-1-Ev-Cmd-Tabchanged.
*/ tab menu degisitigi zaman 
     inquire tab-1,value in tab-1-value.
     evaluate tab-1-value
          when 1 
               move 04 to accept-control
               move 07 to control-id
         
          when 2 
               open input banka
               move rezpara-banka   to banka-kodu
               read banka no lock invalid
                    move all "*" to banka-adi
               end-read
               close banka
               modify label-0201,title = banka-adi

               open input doviz
               move rezpara-doviz   to doviz-kodu
               read doviz no lock invalid
                    move all "*" to d-adi-1
               end-read
               close doviz
               modify label-0202, title = d-adi-1

               open input kodlar02
               move "A"               to kodlar02-tipi
               move rezpara-pan-tipi  to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0203, title = kodlar02-adi
               move "B"                to kodlar02-tipi
               move rezpara-odeme-tipi to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0204, title = kodlar02-adi
               move "D"                to kodlar02-tipi
               move rezpara-anlasma    to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
***               modify label-0206,title = kodlar02-adi

               move "E"               to kodlar02-tipi
               move rezpara-pazar     to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0207, title = kodlar02-adi

               close kodlar02

               open input ulke
               move rezpara-ulke to ulke-anah
               read ulke no lock invalid
                    move all "*" to ulke-adi
               end-read
               modify label-0205, title = ulke-adi
               close ulke

               evaluate rezpara-aygun
                   when "G" modify combo-0201,value = "G"
                   when "A" modify combo-0201,value = "A"
                   when other
                            modify combo-0201,value = "G"
               end-evaluate

               evaluate rezpara-k-g-b
                   when "K" modify combo-0202,value = "K"
                   when "G" modify combo-0202,value = "G"
                   when "B" modify combo-0202,value = "B"
                   when other 
                        modify combo-0202,value = "K"
               end-evaluate


               initialize tek-hane
               if rezpara-adi-bosgec = "E" 
                  move 1 to tek-hane
               end-if
               modify cb-0201,value = tek-hane

               initialize tek-hane
               if rezpara-soyadi-bosgec = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0202,value = tek-hane

               initialize tek-hane
               if rezpara-short-uyari = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0203,value = tek-hane

               initialize tek-hane
               if rezpara-short-gecsin = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0204,value = tek-hane

               initialize tek-hane
               if rezpara-stops-uyari = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0205,value = tek-hane

               initialize tek-hane
               if rezpara-stops-gecsin = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0206,value = tek-hane

               initialize tek-hane
               if rezpara-eskimus-ara = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0207,value = tek-hane

               initialize tek-hane
               if rezpara-mukerrer-ara = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0208,value = tek-hane

               if rezpara-mukerrer-nasil = "V"
                  modify combo-0203,value = "V"
               else 
                  modify combo-0203,value = "I"
               end-if

               initialize tek-hane
               if rezpara-mukerrer-gecsin = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0209,value = tek-hane

               initialize tek-hane
               if rezpara-detay-alsin = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0210,value = tek-hane

               initialize tek-hane
               if rezpara-blokaj = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0211,value = tek-hane

               initialize tek-hane
               if rezpara-fis-sor = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0212,value = tek-hane

               initialize tek-hane
               if rezpara-duz-fis = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0213,value = tek-hane

               initialize tek-hane
               if rezpara-blokaj-farkli = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0214,value = tek-hane

               initialize tek-hane
               if rezpara-cifte-blokaj = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0215,value = tek-hane

               initialize tek-hane
               if rezpara-kont-uyari = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0216,value = tek-hane

               initialize tek-hane
               if rezpara-kont-gecsin = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0217,value = tek-hane

               modify combo-0204,value = rezpara-kont-tipi

               move 04 to accept-control
               move 40 to control-id
          when 3
               move 04 to accept-control
               move 254 to control-id

               initialize tek-hane
               if cinpara-ext-fol-ac = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0301,value = tek-hane

               initialize tek-hane
               if cinpara-breakdown = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0302,value = tek-hane

               initialize tek-hane
               if cinpara-breakdown-cik = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0303,value = tek-hane

               initialize tek-hane
               if cinpara-dolu-odaya = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0304,value = tek-hane

               initialize tek-hane
               if cinpara-musteri-kodu = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0305,value = tek-hane

               initialize tek-hane
               if cinpara-farkli-konuma-cin = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0306,value = tek-hane

               initialize tek-hane
               if cinpara-oto-slip = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0307,value = tek-hane

               initialize tek-hane
               if cinpara-dolu-oda-chg = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0308,value = tek-hane

               initialize tek-hane
               if cinpara-farkli-konum-chg = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0309,value = tek-hane

               initialize tek-hane
               if cinpara-shortta-uzat = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0310,value = tek-hane

               initialize tek-hane
               if cinpara-tumtar-uzat = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0311,value = tek-hane

               initialize tek-hane
               if cinpara-kur-duzelt = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0312,value = tek-hane

               initialize tek-hane
               if cinpara-reg-varmi = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0313,value = tek-hane

               initialize tek-hane
               if cinpara-reg-fis = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0314,value = tek-hane

               initialize tek-hane
               if cinpara-pax-degis = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0315,value = tek-hane

               initialize tek-hane
               if cinpara-bos-odalar-ciksin = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0316,value = tek-hane

               initialize tek-hane
               if cinpara-dag-komisyondan = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0317,value = tek-hane

          when 4
               move 04 to accept-control
               move 53 to control-id

          when 5 
               open input banka
               move onkpara-banka  to banka-kodu
               read banka no lock invalid
                    move all "*" to banka-adi
               end-read
               
               close banka

               open input doviz
               move onkpara-doviz  to doviz-kodu
               read doviz no lock invalid
                    move all "*" to d-adi-1
               end-read
                
               move onkpara-mail-dov to doviz-kodu
               read doviz no lock invalid
                    move all "*" to d-adi-1
               end-read
*               modify label-0505,title = d-adi-1
               close doviz

               open input kodlar02
               move "C"                to kodlar02-tipi
               move onkpara-cot-house  to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               
               close kodlar02

               evaluate true
                   when onkpara-d-e = "D" and onkpara-a-s = "A"
                        modify rb-0501, value = 1
                   when onkpara-d-e = "D" and onkpara-a-s = "S"
                        modify rb-0502, value = 2
                   when onkpara-d-e = "E" and onkpara-a-s = "A"
                        modify rb-0503, value = 3
                   when onkpara-d-e = "E" and onkpara-a-s = "S"
                        modify rb-0504, value = 4
               end-evaluate

               initialize tek-hane
               if onkpara-reopen = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0501, value = tek-hane

               initialize tek-hane
               if onkpara-ipt-post-yaz = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0502, value = tek-hane

               initialize tek-hane
               if onkpara-kart-odenmez-yarat = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0503, value = tek-hane
               initialize tek-hane

               if onkpara-dov-boz-tlden = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0504, value = tek-hane
               initialize tek-hane

               if onkpara-folio-dep-toplam = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0505, value = tek-hane

               initialize tek-hane
               if onkpara-mail-fis = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0506, value = tek-hane

*/ departman kodlari
               modify lb-0501,mass-update = 1
               open input depkod
               perform varying i from 1 by 1 until i > 12
                       modify lb-0501,query-index = i
                       inquire lb-0501,item-value in lb-0501-value
                       evaluate i
                          when 01 move onkpara-corr-arti     to depkod-anah
                          when 02 move onkpara-corr-eksi     to depkod-anah
                          when 03 move onkpara-paid-out      to depkod-anah
                          when 04 move onkpara-guest-refund  to depkod-anah
                          when 05 move onkpara-outlet-cash   to depkod-anah
                          when 06 move onkpara-depozit       to depkod-anah
                          when 07 move onkpara-discount      to depkod-anah
                          when 08 move onkpara-muhtelif      to depkod-anah
                          when 09 move onkpara-kredi-karti   to depkod-anah
                          when 10 move onkpara-city-ledger   to depkod-anah
                          when 11 move onkpara-diger1        to depkod-anah
                          when 12 move onkpara-diger2        to depkod-anah
                       end-evaluate
                       read depkod no lock invalid
                            move all "*" to depkod-adi
                       end-read
                       move depkod-anah   to lb-1-col-2
                       move depkod-adi    to lb-1-col-3
                       modify lb-0501,
                              item-to-delete(i)
                              insertion-index = i
                              item-to-add(lb-0501-value)
               end-perform
               close depkod
               modify lb-0501,mass-update = 0
               modify accept-0501,value = " "
               modify accept-0502,value = " "

               move 04 to accept-control
               move 131 to control-id
          when 7
               open input depkod
               move telpara-depkod to depkod-anah
               read depkod no lock invalid
                    move all "*" to depkod-adi
               end-read
               modify label-0701,title = depkod-adi
               close depkod

               initialize tek-hane
               if telpara-fis = "E"
                  move 1 to tek-hane
               end-if
               modify cb-0701,value = tek-hane

               initialize tek-hane cb-0705-value
               if telpara-oda-okey-eh = "E"
                  move 1 to tek-hane cb-0705-value
               end-if
               display cb-0705

*               evaluate telpara-fol-tipi
*                  when "R" move 1 to tek-hane
*                  when "E" move 2 to tek-hane
*                  when "T" move 3 to tek-hane
*                  when "G" move 4 to tek-hane
*               end-evaluate
               modify combo-0701,value = telpara-fol-tipi

               initialize cb-0706-value
               if genel-MINIBAR-devrede = "E"
                  move 1 to cb-0706-value
               end-if
               display cb-0706

               initialize cb-0707-value
               if genel-MINIBAR-doviz-tl = "D"
                  move 1 to cb-0707-value
               end-if
               display cb-0707


               move 04 to accept-control
               move 106 to control-id
          when 8
               open input kodlar02
               move "C"             to kodlar02-tipi
               move house-bt        to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0801,title = kodlar02-adi
               move "C"             to kodlar02-tipi
               move house-bk        to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0802,title = kodlar02-adi
               move "C"             to kodlar02-tipi
               move house-dt        to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0803,title = kodlar02-adi
               move "C"             to kodlar02-tipi
               move house-dk        to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0804,title = kodlar02-adi
               move "C"             to kodlar02-tipi
               move house-ci        to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0805,title = kodlar02-adi
               move "C"             to kodlar02-tipi
               move house-co        to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0806,title = kodlar02-adi
               move "C"             to kodlar02-tipi
               move house-ao        to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0807,title = kodlar02-adi
               move "C"             to kodlar02-tipi
               move house-re        to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0808,title = kodlar02-adi
               move "C"             to kodlar02-tipi
               move house-ps        to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0809,title = kodlar02-adi
               move "C"             to kodlar02-tipi
               move house-so        to kodlar02-kodu
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               modify label-0810,title = kodlar02-adi
               close kodlar02

               move 04 to accept-control
               move 212 to control-id
     end-evaluate
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*    
     .
*
 lb-0501-Ex-Ntf-Selchange.
     inquire lb-0501,value in lb-0501-value
     open input depkod.
     modify accept-0501, value lb-1-col-2 
     move lb-1-col-2     to depkod-anah.
     read depkod no lock invalid
          move all "*" to depkod-adi
     end-read
     modify accept-0502,value = depkod-adi
     close depkod.
     .
*
 tab-2-after.
     evaluate control-id
         when 1
         when 40
              open input banka
              move rezpara-banka to banka-kodu
              read banka no lock invalid
                   move all "*" to banka-adi



                   display omitted beep
                   move 04 to accept-control
                   move 40 to control-id
              end-read
              modify label-0201,title = banka-adi
              close banka
         when 41
              open input doviz
              move rezpara-doviz to doviz-kodu
              read doviz no lock invalid
                   move all "*" to d-adi-1
                   display omitted beep
                   move 04 to accept-control
                   move 41 to control-id
              end-read
              modify label-0202,title = d-adi-1
              close doviz
         when 42
            if  rezpara-pan-tipi = spaces
                  modify label-0203,title = spaces

                else
              open input kodlar02
              move "A"              to kodlar02-tipi
              move rezpara-pan-tipi to kodlar02-kodu
              read kodlar02 no lock invalid
                   move all "*" to kodlar02-adi
                   display omitted beep
                   move 04 to accept-control
                   move 42 to control-id
              end-read
              modify label-0203,title = kodlar02-adi
              close kodlar02
            end-if
         when 43
              open input kodlar02
              move "B"               to kodlar02-tipi
              move rezpara-odeme-tipi to kodlar02-kodu
              read kodlar02 no lock invalid
                   move all "*" to kodlar02-adi
                   display omitted beep
                   move 04 to accept-control
                   move 43 to control-id
              end-read
              modify label-0204,title = kodlar02-adi
              close kodlar02

         when 49
              open input ulke
              move rezpara-ulke to ulke-anah
              read ulke no lock invalid
                   move all "*" to ulke-adi
                   display omitted beep
                  
              end-read
              modify label-0205,title = ulke-adi
              close ulke
         when 490
              open input kodlar02
              move "E"              to kodlar02-tipi
              move rezpara-pazar    to kodlar02-kodu
              read kodlar02 no lock invalid
                   move all "*" to kodlar02-adi
                   display omitted beep
                   move 04 to accept-control
                   move 490 to control-id
              end-read
              modify label-0207,title = kodlar02-adi
              close kodlar02

         when 78
              open input kodlar02
              move "D"             to kodlar02-tipi
              move rezpara-anlasma to kodlar02-kodu
              read kodlar02 no lock invalid
                   move all "*" to kodlar02-adi
***                   display omitted beep
***                   move 04 to accept-control
****                   move 78 to control-id
              end-read
****              modify label-0206, title = kodlar02-adi
              close kodlar02
         when 131
              open input banka
              move onkpara-banka to banka-kodu
              read banka no lock invalid
                   move all "*" to banka-adi
                   display omitted beep
                   move 04  to accept-control
                   move 131 to control-id
              end-read
               
              close banka
         when 336
              open input banka
              move onkpara-merkez-banka-kodu to banka-kodu
              read banka no lock invalid
                   move all "*" to banka-adi
                   display omitted beep
                   move 04  to accept-control
                   move 336 to control-id
              end-read
               
              close banka
         when 562
              open input banka
              move genel2-dovboz-banka to banka-kodu
              read banka no lock invalid
                   move all "*" to banka-adi
                   display omitted beep
              end-read
               
              close banka
         when 135
              open input doviz
              move onkpara-doviz to doviz-kodu
              read doviz no lock invalid
                   move all "*" to d-adi-1
                   display omitted beep
                   move 04 to accept-control
                   move 135 to control-id
              end-read
               
              close doviz
         when 148
              open input kodlar02
              move "C"               to kodlar02-tipi
              move onkpara-cot-house to kodlar02-kodu
              read kodlar02 no lock invalid
                   move all "*" to d-adi-1
                   display omitted beep
                   move 04 to accept-control
                   move 148 to control-id
              end-read
              
              close kodlar02
         when 153
              open input depkod
              move onkpara-mail-dep to depkod-anah
              read depkod no lock invalid
                   move all "*" to depkod-adi
                   display omitted beep
                   move 04 to accept-control
                   move 153 to control-id
              end-read
*              modify label-0504,title = depkod-adi
              close depkod

         when 161
              open input doviz
              move onkpara-mail-dov to doviz-kodu
              read doviz no lock invalid
                   move all "*" to d-adi-1
                   display omitted beep
                   move 04  to accept-control
                   move 161 to control-id
              end-read
*              modify label-0505,title = d-adi-1
              close doviz

         when 170
              open input depkod
              move accept-0501-value to depkod-anah
              read depkod no lock invalid
                   move all "*" to depkod-adi display omitted beep
                   move 04  to accept-control
                   move 170 to control-id
              end-read
***********>Secilen departman duruma uygun degilse kaydetme....
              inquire lb-0501, selection-index in i
              evaluate i
                when 01 
                     if depkod-ba not = "B"
                        display message box "Borc Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 02 
                     if depkod-ba not = "A"
                        display message box "Alacak Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 03 
                     if depkod-ba not = "B"
                        display message box "Borc Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 04 
                     if depkod-ba not = "B"
                        display message box "Borc Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 05 
                     if depkod-ba not = "A"
                        display message box "Alacak Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 06 
                     if depkod-ba not = "A"
                        display message box "Alacak Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 07 
                     if depkod-ba not = "A"
                        display message box "Alacak Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 08 
                     if depkod-ba not = "B"
                        display message box "Borc Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 09 
                     if depkod-ba not = "A"
                        display message box "Alacak Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 10 
                     if depkod-ba not = "A"
                        display message box "Alacak Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 11 
                     if depkod-ba not = "A"
                        display message box "Alacak Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
                when 12 
                     if depkod-ba not = "A"
                        display message box "Alacak Departmani Seciniz.."
                        move 04  to accept-control
                        move 170 to control-id
                     end-if
               end-evaluate 
***********>Secilen departman duruma uygun degilse kaydetme....


              modify accept-0502,value = depkod-adi
              close depkod
              inquire lb-0501, selection-index in i
              evaluate i
                when 01 move depkod-anah to  onkpara-corr-arti
                when 02 move depkod-anah to  onkpara-corr-eksi
                when 03 move depkod-anah to  onkpara-paid-out 
                when 04 move depkod-anah to  onkpara-guest-refund
                when 05 move depkod-anah to  onkpara-outlet-cash
                when 06 move depkod-anah to  onkpara-depozit    
                when 07 move depkod-anah to  onkpara-discount   
                when 08 move depkod-anah to  onkpara-muhtelif   
                when 09 move depkod-anah to  onkpara-kredi-karti
                when 10 move depkod-anah to  onkpara-city-ledger
                when 11 move depkod-anah to  onkpara-diger1     
                when 12 move depkod-anah to  onkpara-diger2     
               end-evaluate 

         when 110
              open input depkod
              move telpara-depkod to depkod-anah
              read depkod no lock invalid
                   move all "*" to depkod-adi
                   display omitted  beep
                   move 04 to accept-control
                   move 110 to control-id
              end-read
              if depkod-ba not = "B"
                 display message box "Borc Departmani Seciniz.."
                 move 04  to accept-control
                 move 110 to control-id
              end-if
              modify label-0701, title = depkod-adi
              close depkod
         when 212
         when 216
         when 220
         when 224
         when 228 
         when 232
         when 236
         when 240 
         when 244
         when 248
              open input kodlar02
              evaluate control-id
                 when 212 move house-bt    to kodlar02-kodu
                 when 216 move house-bk    to kodlar02-kodu
                 when 220 move house-dt    to kodlar02-kodu
                 when 224 move house-dk    to kodlar02-kodu
                 when 228 move house-ci    to kodlar02-kodu
                 when 232 move house-co    to kodlar02-kodu
                 when 236 move house-ao    to kodlar02-kodu
                 when 240 move house-re    to kodlar02-kodu
                 when 244 move house-ps    to kodlar02-kodu
                 when 248 move house-so    to kodlar02-kodu
              end-evaluate
              move "C"          to kodlar02-tipi
              read kodlar02 no lock invalid
                   move all "*" to kodlar02-adi
                   display omitted beep
                   move 4 to accept-control
              end-read

              evaluate control-id
                 when 212 modify label-0801, title = kodlar02-adi
                 when 216 modify label-0802, title = kodlar02-adi
                 when 220 modify label-0803, title = kodlar02-adi
                 when 224 modify label-0804, title = kodlar02-adi
                 when 228 modify label-0805, title = kodlar02-adi
                 when 232 modify label-0806, title = kodlar02-adi
                 when 236 modify label-0807, title = kodlar02-adi
                 when 240 modify label-0808, title = kodlar02-adi
                 when 244 modify label-0809, title = kodlar02-adi
                 when 248 modify label-0810, title = kodlar02-adi
              end-evaluate
              close kodlar02



     end-evaluate.
     
     .
*
 combo-0301-Ex-Ntf-Selchange.
*     inquire combo-0301, value in tek-hane.
*     display message box tek-hane.
     
     .
*
 tab-2-checkbox-notify.
     evaluate control-id
         when 60
              inquire cb-0201, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-adi-bosgec
              else move "H" to rezpara-adi-bosgec end-if
         when 61
              inquire cb-0202, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-soyadi-bosgec
              else move "H" to rezpara-soyadi-bosgec end-if
         when 62
              inquire cb-0203, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-short-uyari 
              else move "H" to rezpara-short-uyari end-if
         when 63
              inquire cb-0204, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-short-gecsin
              else move "H" to rezpara-short-gecsin end-if
         when 64
              inquire cb-0205, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-stops-uyari
              else move "H" to rezpara-stops-uyari end-if
         when 65
              inquire cb-0206, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-stops-gecsin
              else move "H" to rezpara-stops-gecsin end-if
         when 66
              inquire cb-0207, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-eskimus-ara
              else move "H" to rezpara-eskimus-ara end-if
         when 67
              inquire cb-0208, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-mukerrer-ara
              else move "H" to rezpara-mukerrer-ara end-if
         when 70
              inquire cb-0209, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-mukerrer-gecsin
              else move "H" to rezpara-mukerrer-gecsin end-if
         when 71
              inquire cb-0210, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-detay-alsin
              else move "H" to rezpara-detay-alsin end-if
         when 72
              inquire cb-0211, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-blokaj
              else move "H" to rezpara-blokaj end-if
         when 73
              inquire cb-0212, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-fis-sor
              else move "H" to rezpara-fis-sor end-if
         when 74
              inquire cb-0213, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-duz-fis
              else move "H" to rezpara-duz-fis end-if
         when 75
              inquire cb-0214, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-blokaj-farkli
              else move "H" to rezpara-blokaj-farkli end-if
         when 76
              inquire cb-0215, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-cifte-blokaj
              else move "H" to rezpara-cifte-blokaj end-if
         when 81
              inquire cb-0216, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-kont-uyari
              else move "H" to rezpara-kont-uyari end-if
         when 82
              inquire cb-0217, value in tek-hane
              if tek-hane = 1 move "E" to rezpara-kont-gecsin
              else move "H" to rezpara-kont-gecsin end-if
         when 256
              inquire cb-0301, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-ext-fol-ac
              else move "H" to cinpara-ext-fol-ac end-if
         when 294
              inquire cb-0302, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-breakdown
              else move "H" to cinpara-breakdown end-if
         when 295
              inquire cb-0303, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-breakdown-cik
              else move "H" to cinpara-breakdown-cik end-if
         when 296
              inquire cb-0304, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-dolu-odaya 
              else move "H" to cinpara-dolu-odaya end-if
         when 297
              inquire cb-0305, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-musteri-kodu
              else move "H" to cinpara-musteri-kodu end-if
         when 298
              inquire cb-0306, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-farkli-konuma-cin
              else move "H" to cinpara-farkli-konuma-cin end-if
         when 299
              inquire cb-0307, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-oto-slip 
              else move "H" to cinpara-oto-slip end-if
         when 300
              inquire cb-0308, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-dolu-oda-chg
              else move "H" to cinpara-dolu-oda-chg end-if
         when 301
              inquire cb-0309, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-farkli-konum-chg
              else move "H" to cinpara-farkli-konum-chg end-if
         when 302
              inquire cb-0310, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-shortta-uzat
              else move "H" to cinpara-shortta-uzat end-if
         when 303
              inquire cb-0311, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-tumtar-uzat
              else move "H" to cinpara-tumtar-uzat end-if
         when 304
              inquire cb-0312, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-kur-duzelt
              else move "H" to cinpara-kur-duzelt end-if
         when 305
              inquire cb-0313, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-reg-varmi
              else move "H" to cinpara-reg-varmi end-if
         when 306
              inquire cb-0314, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-reg-fis
              else move "H" to cinpara-reg-fis end-if
         when 3061
              inquire cb-0315, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-pax-degis
              else move "H" to cinpara-pax-degis end-if
         when 3062
              inquire cb-0316, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-bos-odalar-ciksin
              else move "H" to cinpara-bos-odalar-ciksin end-if
         when 3063
              inquire cb-0317, value in tek-hane
              if tek-hane = 1 move "E" to cinpara-dag-komisyondan
              else move "H" to cinpara-dag-komisyondan end-if
         when 144
              inquire cb-0501, value in tek-hane
              if tek-hane = 1 move "E" to onkpara-reopen
              else move "H" to onkpara-reopen end-if
         when 145
              inquire cb-0502, value in tek-hane
              if tek-hane = 1 move "E" to onkpara-ipt-post-yaz
              else move "H" to onkpara-ipt-post-yaz end-if
         when 146
              inquire cb-0503, value in tek-hane
              if tek-hane = 1 move "E" to onkpara-kart-odenmez-yarat
              else move "H" to onkpara-kart-odenmez-yarat end-if
         when 1461
              inquire cb-0504, value in tek-hane
              if tek-hane = 1 move "E" to onkpara-dov-boz-tlden
              else move "H" to onkpara-dov-boz-tlden end-if
         when 1462
              inquire cb-0505, value in tek-hane
              if tek-hane = 1 move "E" to onkpara-folio-dep-toplam
              else move "H" to onkpara-folio-dep-toplam end-if
         when 165
              inquire cb-0506, value in tek-hane
              if tek-hane = 1 move "E" to onkpara-mail-fis
              else move "H" to onkpara-mail-fis end-if
         when 120
              inquire cb-0701, value in tek-hane
              if tek-hane = 1 move "E" to telpara-fis
              else move "H" to telpara-fis end-if
         when 117
              inquire cb-0705, value in tek-hane
              if tek-hane = 1 


                 move "E" to telpara-oda-okey-eh
              else 
                 move "H" to telpara-oda-okey-eh 
              end-if
              display accept-0721 accept-0722 accept-0723 accept-0724
                      accept-0725 accept-0726 accept-0727 accept-0728
                      accept-0729
         when 408
              inquire cb-0706 value in tek-hane
              if tek-hane = 1
                 move "E" to GENEL-MINIBAR-DEVREDE
              else
                 move "H" to GENEL-MINIBAR-DEVREDE
              end-if
              display accept-0821 accept-0822 accept-0823 accept-0824 accept-0825
                      accept-0826 accept-0827 accept-0828 accept-0829 accept-0830
                      cb-0707



         when 432
              inquire cb-0707 value in tek-hane
              if tek-hane = 1
                 move "D" to GENEL-MINIBAR-DOVIZ-TL
              else
                 move " " to GENEL-MINIBAR-DOVIZ-TL
              end-if
     end-evaluate.
*
 combo-after.

    evaluate control-id
         when 57
              move combo-0201-value to rezpara-aygun
         when 59
              move combo-0202-value to rezpara-k-g-b
         when 69
              move combo-0203-value to rezpara-mukerrer-nasil
         when 84
              move combo-0204-value(1:1) to rezpara-kont-tipi
         when 113
              move combo-0701-value to telpara-fol-tipi
     end-evaluate.
         

     
*
 accept-0603-Ex-Other.
       display message box key-status.
     
     .
*
 Form1-Rb-1-Aft-Procedure.
     if rb-degisken-1 = "1" 
        move "G" to cinpara-ext-fol-aygun
     else
        move "A" to cinpara-ext-fol-aygun
     end-if.
     modify form1-rb-1,  GROUP-VALUE = rb-degisken-1.
     .
*
 Form1-Rb-2-Aft-Procedure.
     if rb-degisken-2 = "1" 
        move "R" to cinpara-peryot-kuru
     else
        move "K" to cinpara-peryot-kuru
     end-if.
     modify form1-rb-2,  GROUP-VALUE = rb-degisken-2.
     
     .
*
 rb-0501-Aft-Procedure.
     evaluate rb-degisken-3
        when "1" 
          move "D" to onkpara-d-e 
          move "A" to onkpara-a-s 
        when "2" 
          move "D" to onkpara-d-e 
          move "S" to onkpara-a-s 
        when "3" 
          move "E" to onkpara-d-e 
          move "A" to onkpara-a-s 
        when "4" 
          move "E" to onkpara-d-e 
          move "S" to onkpara-a-s 
        when other
          move "D" to onkpara-d-e 
          move "A" to onkpara-a-s 
     end-evaluate.
     .
*
 rb-0501-Ex-Other.
     evaluate control-id
        when 139 
          move 1 to rb-degisken-3
          move "D" to onkpara-d-e 
          move "A" to onkpara-a-s 
        when 140 
          move 2 to rb-degisken-3
          move "D" to onkpara-d-e 
          move "S" to onkpara-a-s 
        when 141 
          move 3 to rb-degisken-3
          move "E" to onkpara-d-e 
          move "A" to onkpara-a-s 
        when 142
          move 4 to rb-degisken-3
          move "E" to onkpara-d-e 
          move "S" to onkpara-a-s 
        when other
          move 1 to rb-degisken-3
          move "D" to onkpara-d-e 
          move "A" to onkpara-a-s 
     end-evaluate.
     .
*
 Form1-Pb-2-Link.
         .
     
     
     .
*
 Form1-Pb-2a-Link.
     
     .
*
 Form2-Ex-Other.
     if key-status <> 2001
        set exit-pushed to true
        exit paragraph
     end-if.
     if form2-ef-1-value <> "RIMBAW" 
        set exit-pushed to true
        exit paragraph
     end-if.
     initialize form2-ef-1-value
     display form2-ef-1
     perform acu-form3-routine.
     set exit-pushed to true.
       
     
     .
*
 accept-0104-Ex-Other.
     if key-status <> 15
        exit paragraph.
     perform acu-form2-routine.
     set exit-pushed to true.


*
 grid-reset.
      modify form3-gd-1,
             reset-grid = 1
             mass-update = 1
      initialize form3-gd-1-record
      move "*"     to gd-1-col-1
      if Form3-Cm-1-Value(1:1) = "W"
         move "Source"     to gd-1-col-2
         move "Target"     to gd-1-col-3
      else
         move "Source"     to gd-1-col-3
         move "Target"     to gd-1-col-2
      end-if
      modify form3-gd-1,
             record-to-add(form3-gd-1-record).
      modify form3-gd-1,
             mass-update = 0.
         
     
     .
*
 Form3-Aft-Initdata.
      perform grid-reset.

     
     .
*
 Form3-Ex-Other.
      evaluate key-status
      when 2002
           inquire form3-gd-1,
                   last-row in ii
           if ii = 1
              exit paragraph
           end-if
           perform varying ii
                   from ii
                   by -1
                   until ii = 1
                   initialize from-dosya to-dosya dummy-x
                   inquire form3-gd-1(ii),
                           record-data in form3-gd-1-record
                   move gd-1-col-2 to from-dosya
                   move gd-1-col-3 to to-dosya
                   move "@[DISPLAY]:"    to dummy-x
                   inspect dummy-x replacing trailing spaces by low-values
                   string dummy-x 
                          from-dosya delimited by low-values
                          into dummy-x
                   move dummy-x to from-dosya
                   if Form3-Cm-1-Value(1:1) = "W"
                      call "c$copy" using from-dosya to-dosya
                      giving return-code
                   else
                      call "c$copy" using from-dosya to-dosya
                      giving return-code
                   end-if
                   inspect from-dosya replacing all low-values by spaces
                   inspect to-dosya replacing all low-values by spaces
                   if return-code = 1
                      display message box  
                      "Source file : ",from-dosya,new-line
                      "Target file : ",to-dosya,new-line,
                      "Copy Failed !"
                   else
                      modify form3-gd-1,
                             record-to-delete(ii)
                   end-if

           end-perform
           perform grid-reset
           move 4 to accept-control
           move 4 to control-id
           exit paragraph
      when 2004
             initialize opensave-data
             move "Lutfen dosya adresini giriniz ..."
                   to opnsav-title
             move "Calistirilabilir dosyalar "
                   to opnsav-filters
             move "*.*" to opnsav-default-ext
             call "c$opensavebox" using
                  opensave-open-box
                  opensave-data
                  giving opensave-status
             end-call
             if opensave-status <> 1
                exit paragraph
             end-if
             move opnsav-filename    to acc-file-value
             display acc-file
      when 2001
           if acc-file-value = spaces
              move 4 to accept-control
              move 4 to control-id
              exit paragraph
           end-if

           initialize acc-file-value-1
           perform varying ii
                   from 100
                   by -1
                   until ii = 0
                   if acc-file-value(ii:1) = "/" or "\"
                      move acc-file-value(ii + 1:) to acc-file-value-1
                      display acc-file-1
                      exit perform
                   end-if
           end-perform

           if acc-file-value-1 = spaces 
              move 4 to accept-control
              move 4 to control-id
              exit paragraph
           end-if

           initialize form3-gd-1-record
           move acc-file-value   to gd-1-col-2
           move Form3-Cm-2-Value to from-dosya
           inspect from-dosya replacing trailing spaces by low-values
           string from-dosya 
                  acc-file-value-1 delimited by low-values
                  into from-dosya
           inspect from-dosya replacing all low-values by spaces
           move from-dosya to gd-1-col-3
           modify form3-gd-1,mass-update 1
           modify form3-gd-1,
                  record-to-add(Form3-gd-1-record)
           modify form3-gd-1,mass-update 0
           initialize acc-file-value acc-file-value-1
           display acc-file acc-file-1
           move 4 to accept-control
           move 4 to control-id
           
      end-evaluate.
     
     .
*
 Form3-Mn-1-MI-Delete-Link.
      inquire form3-gd-1, cursor-y in ii
      if ii > 1
         modify form3-gd-1,record-to-delete(ii).
     
     .
*
 Form3-Cm-1-Ex-Other.
      perform grid-reset.
     
     .
*
 Form1-Pb-9-Ex-Other.


      if key-status = 111
        display message box "Tum Fihrist KAyitlari Is Gorusmesi olarak eklenecek" new-line
                            "Bu islemin Geri Almasi Yoktur" new-line
                            "Devam Etmek Istediginize Emin misiniz?" title "DIKKAT"
                             type mb_yes_no
                             default 2
                             icon mb_warning_icon
                             returning sonuc-2

          if sonuc-2 = 1 then 
             open input fihrist
             open i-o telkim
             initialize fihrist-rec
             start fihrist key > fihrist-anahtar
                invalid
                  continue
                 not invalid
                  perform until fs-fihrist = "10"
                    read fihrist next
                     end
                       move "10" to fs-fihrist
                     not end
                       
                       perform varying m from 1 by 1 until m > 10
                         perform varying n from 1 by 1 until n > 10
                          if fihrist-telefon(m:1) = spaces 
                             move fihrist-telefon(m + 1 :) to fihrist-telefon(m :)
                          else      
                             move 10 to n
                          end-if
                         end-perform 
                       end-perform
                       if fihrist-telefon(6:1) not = zeroes or 
                          fihrist-telefon(6:1) not = spaces then
                          initialize telkim-rec
                          move fihrist-telefon to telkim-telno
                          read telkim no lock 
                             invalid
                              move "I" to  telkim-tipi     
                              move fihrist-adi    to  telkim-adi telkim-aciklama(1:9)        
                              move fihrist-soyadi to  telkim-soy telkim-aciklama(11:)
                              move k-kodu-tasi    to telkim-staf
                              write telkim-rec  end-write
                           end-read
                       end-if
                   end-read
                  end-perform
            end-if
                              .
*
 cb-oto-peryot-Ex-Cmd-Clicked.
    
     if cb-oto-peryot-value = 1
        move "E"      to genel-oto-peryot
     else
        move "H"      to genel-oto-peryot
     end-if.
     
     .
*
 ref-after.
     open i-o genel.
    
     move 1 to genel-anahtar.
      if ref-kodu < 6 and ref-kodu > 0 then 
         add  ref-kodu   to genel-anahtar  
      else
         move 0 to ref-kodu 
        display ac-ref
     end-if
     read genel no lock invalid
*          perform default-ata
          initialize mesaj-link
          move 03 to mesaj-no
          perform mesaj-ver
     end-read
     move genel-plaka to yedek-plaka
     move 1 to REZPARA-TRACE
     move "E"  to GENEL-OTO-PERYOT
     close genel.
     
      perform Form1-Aft-Initdata.
      display form1.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*    

     .
*
 combo-dil-Ex-Ntf-Selchange.
     move combo-dil-value(1:1)       to genel-dil.
     
     .
*
 Form1-Cb-1a-Ev-Other.
       
        display Form1-Cb-1a Form1-Ef-2a Form1-Ef-2aA Form1-La-32a Form1-La-32aa

     .   
 DEP-KONTROL.
        OPEN INPUT depkod
        initialize depkod-rec
        move onkpara-dovboz-kom-dep to depkod-anah
        read depkod no lock invalid
           display message box "Lutfen Komisyon Departmani Giriniz" title "HATAAA"
           not invalid
           move depkod-adi to kom-dep-adi
           if depkod-ba = "A" then 
                 display message box "Borc Departmani olmalidir" title "HATAAA"
           end-if
        end-read
        initialize depkod-rec
        move onkpara-dovboz-kom-tah-dep to depkod-anah
        read depkod no lock invalid
           display message box "Lutfen Komisyon Tahsilat Departmani Giriniz" title "HATAAA"
           not invalid
              move depkod-adi to kom-tah-dep-adi
           if depkod-ba = "B" then 
                  display message box "Nakit  Departmani olmalidir" title "HATAAA"
               ELSE
                IF DEPKOD-TURU NOT = 3 
                    display message box "Nakit  Departmani olmalidir" title "HATAAA"
                end-if
           end-if
        end-read
       
        close depkod.
*
 screen1-Aft-Initdata.
       open i-o genel.
       move genel-rec to yedek-rec
       initialize genel-rec
       move   9 to genel-anahtar
        read genel no lock invalid
        
             initialize mail-not
          not invalid
           move genel-rec(5:) to mail-not
        end-read
          if mail-not(1:8) = "00000000" then 
            initialize mail-not
          end-if


**      move genel-rec to yedek-rec
       initialize genel-rec
       move   8 to genel-anahtar
        read genel no lock invalid
        
             initialize mail-not2
          not invalid
           move genel-rec(5:) to mail-not2
        end-read
          if mail-not(1:8) = "00000000" then 
            initialize mail-not2
          end-if


        display fom4  fom4a
        close genel
     .
*
 form4-Aft-Routine.
         move yedek-rec to genel-rec
         display form1
     .
*
 form4-Ex-Other.
     if key-status = 2 then 
         open i-o genel
          move  mail-not to  genel-rec(5:) 
          move 9 to genel-anahtar
          write genel-rec invalid rewrite genel-rec end-write
         close genel

         open i-o genel
         initialize genel-rec
          move  mail-not2 to  genel-rec(5:) 
          move 8 to genel-anahtar
          write genel-rec invalid rewrite genel-rec end-write
         close genel


         set exit-pushed to true
     end-if
     .
*
 accept-0306a-Aft-Procedure.
     open input odalar
     initialize odalar-rec
     move genel-onodeme-odano of genel  to odalar-anah
     read odalar no lock invalid 
          display message box "Oda Numarasi Bulunamadi..."
                          title "Uyari"
                          icon 1
              initialize genel-onodeme-odano of genel
              display accept-0306a
              move 4 to accept-control
              move 277 to control-id

           close odalar
           exit paragraph
     end-read 
           if odalar-hayali = "G"
              display message box "Lutfen Hayali Oda Giriniz."
                              title "Uyari"
                              icon 1
              initialize genel-onodeme-odano of genel
              display accept-0306a
              move 4 to accept-control
              move 277 to control-id
           end-if 
     close odalar.
*
 combo-kbs-Ex-Ntf-Selchange.
     move combo-kbs-value(1:1)       to genel-kbs-bolgesi
     .
*
 cmb-comp-Ex-Ntf-Selchange.
     move combo-comp-durumu(1:1)     to genel2-rapor-comp-durumu
     .
*
 Form1-Pg-1-Cm-2-Ex-Ntf-Selchange.
     move cmb-kolayrez-dys-tip(1:1)     to genel2-kolayrez-dys-tip
     .

 
