* katgorrp.evt
* katgorrp.evt is generated from D:\asya\acugt.ytl\otel\katgorrp.Psf
* This is a generated file. DO NOT modify this file directly.


 Screen1-Event-Proc.
     .

 Screen1-Exception-Proc.
     PERFORM Screen1-Ex-Other
     .

 Form1-Cb-1a-Event-Proc.
     .
***   start event editor code   ***
*
 Screen1-Bef-Create.
*     move "smelia17" to isyeri-adres-tasi
*     move isyeri-adres-tasi to konuk-dosya-adres odalar-dosya-adres
    perform  adresleri-tasi.

        call "c$myfile" using called-program
     end-call.
     
*
 Screen1-Pb-1-Link.

*
 osuttur.
    move 1 to rapor-satiri
    initialize winprint-selection
    call "Win$printer" using winprint-setup-old
         returning lsr-donus
    end-call

    if lsr-donus = WPRTERR-CANCELLED | Cancel secilmis .....
       exit paragraph
    end-if



    call "win$printer" using winprint-get-current-info
                             winprint-selection
    end-call

    call "win$printer" using winprint-set-printer
                             winprint-selection
    end-call
     .


    perform win-prt-font-al
    perform set-font-normal
*/ Sayfa ozellikleri
    initialize winprint-data
    call "win$printer" using winprint-get-page-layout
                             winprint-data 
                             returning lsr-donus
    move wprtdata-columns-per-page to lsr-sayfa-sutun
    move wprtdata-lines-per-page   to lsr-sayfa-satir
    subtract 4 from lsr-sayfa-sutun
    subtract 4 from lsr-sayfa-satir
    open output liste
    initialize liste-rec 
    perform yazdir
    close liste.


*
 yazdir.
*    perform set-pen-width-3
    perform baslik-ciz-kutu-at
    perform rapor-dok
        .

*
 winprint-column-reset.
    call "win$printer" using winprint-clear-page-columns.
    call "win$printer" using winprint-clear-data-columns.

| Bu alandaki bilgiler kolonun x düzleminde baþlangýç ve bitiþ noktalarýný yani geniþliðini belirliyor.

*
  winprint-column-set-aciklama.
    initialize winprint-column lsr-yer lsr-alan-boy  
    compute winprint-col-start = 10
    perform set-page-column
    add function length(l1)             to lsr-alan-boy.
*
 winprint-column-set.
    initialize winprint-column lsr-yer lsr-alan-boy  
    compute winprint-col-start = 0
    perform set-page-column
    add function length(l1)             to lsr-alan-boy 

    initialize winprint-column  
    compute winprint-col-start = 5  |--> bu rakamda bir degisiklik yapilirsa dikey yazýnýn ekrandaki konumu degisir(deðer azalýrsa sola/artarsa saða hareket eder)
    perform set-page-column
    add function length(l2)               to lsr-alan-boy   

    initialize winprint-column 
    compute winprint-col-start = 8
    perform set-page-column
    add function length(l3)               to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 11
    perform set-page-column
    add function length(l4)               to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 20
    perform set-page-column
    add function length(l5)               to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 17
    perform set-page-column
    add function length(l6)               to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 21
    perform set-page-column
    add function length(l7)               to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 23
    perform set-page-column
    add function length(l8)               to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 27
    perform set-page-column
    add function length(l9)               to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 29
    perform set-page-column
    add function length(l10)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 39
    perform set-page-column       
    add function length(l11)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 41
    perform set-page-column
    add function length(l12)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 51
    perform set-page-column
    add function length(l13-1)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 53
    perform set-page-column
    add function length(l13)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 63
    perform set-page-column
    add function length(l14)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 66
    perform set-page-column
    add function length(l15)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 69
    perform set-page-column
    add function length(l16)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 72
    perform set-page-column
    add function length(l17)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 75
    perform set-page-column
    add function length(l18)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 80
    perform set-page-column
    add function length(l19)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 85
    perform set-page-column
    add function length(l20)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 90
    perform set-page-column
    add function length(l21)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 95
    perform set-page-column
    add function length(l22)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 100
    perform set-page-column
    add function length(l23)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 106
    perform set-page-column
    add function length(l24)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 109
    perform set-page-column
    add function length(l25)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 110
    perform set-page-column
    add function length(l26)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 115
    perform set-page-column
    add function length(l27)              to lsr-alan-boy.

    initialize winprint-column    
    compute winprint-col-start = 118
    perform set-page-column
    add function length(l28)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 121
    perform set-page-column
    add function length(l29)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 124
    perform set-page-column
    add function length(l30)              to lsr-alan-boy.

    initialize winprint-column 
    compute winprint-col-start = 127
    perform set-page-column          
    add function length(l31)              to lsr-alan-boy.

    
    
    
*
 winprint-column-set-lucky.
    initialize winprint-column lsr-yer lsr-alan-boy  
    compute winprint-col-start = 0  
    perform set-page-column         
    add function length(lck1)             to lsr-alan-boy 
                                    
    initialize winprint-column      
    compute winprint-col-start = 2  |--> bu rakamda bir degisiklik yapilirsa dikey yazýnýn ekrandaki konumu degisir(deðer azalýrsa sola/artarsa saða hareket eder)
    perform set-page-column         
    add function length(lck2)               to lsr-alan-boy   
                                    
    initialize winprint-column      
    compute winprint-col-start = 7  
    perform set-page-column         
    add function length(lck3)               to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 10 
    perform set-page-column       
    add function length(lck4)               to lsr-alan-boy.
                                    
    initialize winprint-column        
    compute winprint-col-start = 14 
    perform set-page-column         
    add function length(lck5)               to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 16 
    perform set-page-column         
    add function length(lck6)               to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 19 
    perform set-page-column         
    add function length(lck7)               to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 22 
    perform set-page-column         
    add function length(lck8)               to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 25 
    perform set-page-column         
    add function length(lck9)               to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 28 
    perform set-page-column         
    add function length(lck10)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 31 
    perform set-page-column         
    add function length(lck11)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 43 
    perform set-page-column         
    add function length(lck12)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 57 
    perform set-page-column         
    add function length(lck13)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 65 
    perform set-page-column         
    add function length(lck14)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 68 
    perform set-page-column         
    add function length(lck15)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 71 
    perform set-page-column         
    add function length(lck16)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 74 
    perform set-page-column         
    add function length(lck17)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 84 
    perform set-page-column         
    add function length(lck18)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 87 
    perform set-page-column         
    add function length(lck19)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 90 
    perform set-page-column         
    add function length(lck20)            to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 93 
    perform set-page-column         
    add function length(lck21)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 96 
    perform set-page-column         
    add function length(lck22)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 99
    perform set-page-column         
    add function length(lck23)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 102
    perform set-page-column         
    add function length(lck24)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 112
    perform set-page-column         
    add function length(lck25)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 122
    perform set-page-column        
    add function length(lck26)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 130
    perform set-page-column         
    add function length(lck27)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 140
    perform set-page-column         
    add function length(lck28)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 150
    perform set-page-column         
    add function length(lck29)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 160
    perform set-page-column         
    add function length(lck30)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 162
    perform set-page-column         
    add function length(lck31)              to lsr-alan-boy.
                                    
    initialize winprint-column      
    compute winprint-col-start = 164
    perform set-page-column         
    add function length(lck32)              to lsr-alan-boy.

    
    
    
*
 set-page-column.
    move null                           to winprint-col-font
    move wprtunits-cells                to winprint-col-units
    move wprtalign-none                 to winprint-col-alignment
    set  winprint-transparent           to true
    call "win$printer" using winprint-set-page-column  winprint-column
    call "win$printer" using winprint-set-data-columns lsr-alan-boy.


*///////////////// SAK SAK SAK RUTINLER
*
 set-cursor.
     initialize WINPRINT-DATA.
     initialize wprtdata-draw .
     move lsr-sutun           to wprtdata-draw-start-x.
     move lsr-satir           to wprtdata-draw-start-y.
     move wprtunits-cells to wprtdata-draw-units.
     call "win$printer" using winprint-set-cursor
                              winprint-data
                        giving lsr-donus.
*
 set-pen-width-3.
*3 pixel geniÐli-inde kalem yarat
      initialize wprtdata-pen.
      move wprt-pen-solid   to  wprtdata-pen-style.
      move 1                to  wprtdata-pen-width.
      call "win$printer" using winprint-graph-pen
                               winprint-data
                         giving lsr-donus.

*
 set-pen-width-0.
*0 pixel geniÐli-inde kalem yarat
      initialize wprtdata-pen.
      move wprt-pen-null    to  wprtdata-pen-style.
      move 0                to  wprtdata-pen-width.
      call "win$printer" using winprint-graph-pen
                               winprint-data
                         giving lsr-donus.


 kutu-ciz.
     move wprt-draw-rectangle to wprtdata-draw-shape.
     move wprtunits-cells     to wprtdata-draw-units.
     call "win$printer" using winprint-graph-draw
                              winprint-data
                        giving lsr-donus.



 ustten-alta-ciz.
* cizgi ciz 
     initialize wprtdata-draw
     compute wprtdata-draw-start-x = sutun-y
     move wprtdata-draw-start-x   to wprtdata-draw-stop-x
     move 11                       to wprtdata-draw-start-y
     move 69                      to wprtdata-draw-stop-y
     perform cizgi-ciz.

 soldan-saga-ciz.
* cizgi ciz 
     initialize wprtdata-draw
     move 2                      to wprtdata-draw-start-x
     move 132                    to wprtdata-draw-stop-x
     move lsr-satir              to wprtdata-draw-start-y
     move lsr-satir              to wprtdata-draw-stop-y
     perform cizgi-ciz.
*
 genel-kutu-ciz-1.
     initialize wprtdata-draw
     move 2                     to wprtdata-draw-start-x
     move 11                     to wprtdata-draw-start-y
     move 132                   to wprtdata-draw-stop-x
     move 69                    to wprtdata-draw-stop-y
     perform kutu-ciz.
*
 genel-kutu-ciz-2.
     initialize wprtdata-draw
     move 2                     to wprtdata-draw-start-x
     move 71                    to wprtdata-draw-start-y
     move 132                   to wprtdata-draw-stop-x
     move 81                    to wprtdata-draw-stop-y
     perform kutu-ciz
     perform kutu-ici-cizgi-ciz.
*
 set-font-bold.
     initialize wfont-data
     move grafik-yazici-font-bold   to wprtdata-font 
     call "win$printer" using winprint-set-font
                              winprint-data .     
 set-font-normal.
     initialize wfont-data
     move grafik-yazici-font        to wprtdata-font 
     call "win$printer" using winprint-set-font
                              winprint-data .
 set-font-underline.
     initialize wfont-data
     move grafik-yazici-font-underline to wprtdata-font 
     call "win$printer" using winprint-set-font
                              winprint-data .  
   
 set-font-90.
     initialize wfont-data
     move grafik-yazici-font-90       to wprtdata-font 

     call "win$printer" using winprint-set-font
                              winprint-data .
   
 set-font-baslik.
     initialize wfont-data
     move baslik-font       to wprtdata-font 

     call "win$printer" using winprint-set-font
                              winprint-data .

*-
 baslik-yaz.

    move 25           to lsr-sutun
    move 3            to lsr-satir
    perform set-cursor

    initialize liste-rec
    move "KAT GOREVLISI KONTROL FORMU" to liste-rec
    write liste-rec before advancing 1 line.

*
 cizgi-ciz.
     move wprt-draw-line      to wprtdata-draw-shape.
     move wprtunits-cells     to wprtdata-draw-units.
     call "win$printer" using winprint-graph-draw
                              winprint-data
                        giving lsr-donus.
*
 cizgi-ciz-pixel.
     move wprt-draw-line      to wprtdata-draw-shape.
     move wprtunits-pixels    to wprtdata-draw-units.
     call "win$printer" using winprint-graph-draw
                              winprint-data
                        giving lsr-donus.
*
 win-prt-font-al.
*/ grafik yazýcý-start

*/ UNDERLINE FONT
       initialize wfont-data wfont-face-data 
                  return-code lsr-font-handle
       set WFDEVICE-WIN-PRINTER  to true    
       move lsr-font             to wfont-name
       move lsr-font-size        to wfont-size
       set wfont-underline       to true
       call "w$font" using WFONT-GET-FONT, 
                           lsr-font-handle,
                           wfont-data
                           returning wfont-status.
       if wfont-status < 1
          display message box 
                  lsr-font," (Underline) Sistemde tanimli font bulunamadi", x"0a0d",
                  "Hata kodu : ", return-code
                  icon mb_error_icon
                  title "Hata".
       move lsr-font-handle to grafik-yazici-font-underline

*/ BOLD FONT
       initialize wfont-data wfont-face-data 
                  return-code lsr-font-handle
       set WFDEVICE-WIN-PRINTER  to true    
       set wfont-bold            to true
       move lsr-font             to wfont-name
       move lsr-font-size        to wfont-size
       call "w$font" using WFONT-GET-FONT, 
                           lsr-font-handle,
                           wfont-data
                           returning wfont-status.
       if wfont-status < 1
          display message box 
                  lsr-font," (Underline) Sistemde tanimli font bulunamadi", x"0a0d",
                  "Hata kodu : ", return-code
                  icon mb_error_icon
                  title "Hata".

       move lsr-font-handle to grafik-yazici-font-bold
*/ grafik yazýcý-end

*/ NORMAL FONT

       initialize wfont-data wfont-face-data 
                  return-code lsr-font-handle
       set WFDEVICE-WIN-PRINTER   to true    
       move lsr-font              to wfont-name
       move lsr-font-size         to wfont-size
       call "w$font" using WFONT-GET-FONT, 
                           lsr-font-handle,
                           wfont-data
                           returning wfont-status.
       if wfont-status < 1
          display message box 
                  lsr-font," Sistemde tanimli font bulunamadi", x"0a0d",
                  "Hata kodu : ", return-code
                  icon mb_error_icon
                  title "Hata".

       move lsr-font-handle to grafik-yazici-font.


*/ NORMAL FONT  dereceli

       initialize wfont-data wfont-face-data 
                  return-code lsr-font-handle
       set WFDEVICE-WIN-PRINTER  to true    
       move lsr-font             to wfont-name
       move lsr-font-size        to wfont-size
       move 90                   to wfont-angle
       call "w$font" using WFONT-GET-FONT, 
                           lsr-font-handle,
                           wfont-data
                           returning wfont-status.
       if wfont-status < 1
          display message box 
                  lsr-font," Sistemde tanimli font bulunamadi (dereceli)", x"0a0d",
                  "Hata kodu : ", return-code
                  icon mb_error_icon
                  title "Hata".

       move lsr-font-handle to grafik-yazici-font-90.



       initialize wfont-data wfont-face-data 
                  return-code lsr-font-handle
       set WFDEVICE-WIN-PRINTER   to true    
       move lsr-font              to wfont-name
       move 12                    to wfont-size
       call "w$font" using WFONT-GET-FONT, 
                           lsr-font-handle,
                           wfont-data
                           returning wfont-status.
       if wfont-status < 1
          display message box 
                  lsr-font," Sistemde tanimli font bulunamadi", x"0a0d",
                  "Hata kodu : ", return-code
                  icon mb_error_icon
                  title "Hata".

       move lsr-font-handle to baslik-font.
*
 genelfis-numara-al.
        open i-o genelfis
             move 1 to genelfis-anahtar
             read genelfis no lock invalid  
                  initialize genelfis-rec
                  move 1 to genelfis-anahtar
                  add 1  to EKRAN-FIS-1
                  move EKRAN-FIS-1 to maid-oda-dno 
                  write genelfis-rec invalid
                        rewrite genelfis-rec invalid continue
                        end-rewrite 
                  end-write
              not invalid
                 add 1 to  print-no
                 move print-no to maid-oda-dno
                 rewrite genelfis-rec end-rewrite
             end-read
         close genelfis
       .

*
 rapor-dok. 

*
      move high-values to son-maid
      open input odalar cast rez konum konuk kodlar02 acenta takvim
      initialize sutun-y 
      initialize odalar-rec
*---------------------------
      perform genelfis-numara-al
      move k-kodu-tasi to maid-oda-k
      open output maid-oda close maid-oda   open i-o maid-oda
      start odalar key not < odalar-anah invalid 
            close  odalar cast rez konum konuk kodlar02 acenta takvim
            exit paragraph.
               
              

            initialize fs-odalar 
            perform with test after until fs-odalar = "10"
             read odalar next no lock  end move "10" to  fs-odalar
             not end 
               move odalar-no to maid-oda-no
               move odalar-maid  to maid-oda-maid
               write maid-oda-rec invalid
                     stop " "
               end-write
            end-read
            end-perform
            initialize maid-oda-rec
            start maid-oda key not < maid-oda-maid invalid 
               
               exit paragraph.
               
              

              initialize fs-maid-oda 
              perform with test after until fs-maid-oda = "10"
              read maid-oda next no lock  end move "10" to  fs-maid-oda
               not end 
              
              initialize odalar-rec
              move maid-oda-anah to odalar-anah
              read odalar no lock invalid exit perform cycle
              end-read
                    
*-------------------------------                         
                    if rkat not = SPACES and rkat not = ODALAR-KAT 
                       exit perform cycle
                    
                    end-if    
                    if hrb-degisken-1 = 2 or 
                     ( hrb-degisken-1 = 1 and odalar-hayali not = "H" and odalar-hayal2 not = 1  )
                       continue
                    else 
                       exit perform cycle
                    end-if 
                    if odalar-konumu not = rapor-konum and
                       rapor-konum not = zeroes  
                         exit perform cycle 
                    end-if 
                    if rapor-staf = spaces or 
                       house-staf = rapor-staf
                       continue
                    else 
                       exit perform cycle
                    end-if
                    if rapor-st     = spaces or 
                       house-durumu = rapor-st
                       continue
                    else 
                       exit perform cycle
                    end-if
                     move odalar-konumu   to rez-oda-konumu rez-fiyat-konumu
******-------------
              if son-maid = high-values move odalar-maid to son-maid end-if
              if son-maid not = odalar-maid 
                 move 99 to rapor-satiri 
                 move odalar-maid to son-maid
              end-if 

*-------------------
                     if history = 1 then 
                         move odalar-anah to cikmayan
                          perform hkonuk-ara
                          if cikmayan not = spaces
                            move 1 to oda-var-yok
                            initialize konuk-rec
                            move odalar-anah to konuk-odano
                            perform satir-ekle
                          end-if
                     else
                         
                            perform konuk-ara thru konuk-ara-exit

                            compute fark-buyuk = konuk-buyuk - house-buyuk
                            compute fark-kucuk = konuk-kucuk - house-kucuk
                            compute fark-free  = konuk-free  - house-free 
                            compute fark-bebek = konuk-bebek - house-bebek

                          
                            if  rb-degisken-1 = 2  and 
                                fark-buyuk  + fark-kucuk + fark-free + fark-bebek = 0
                                   then 
                               exit perform cycle
                           end-if

                           if temizlik-var-yok = 1 or temizlik-gunu < 2 then
                               perform satir-ekle 
                           end-if
                     end-if 
                     
                 end-read 
              end-perform.

         close odalar cast rez konum konuk kodlar02 acenta takvim maid-oda.

*
 eski-rapor.

       open i-o odalar konuk
       initialize konuk-rec sutun-y
       move "I"   to konuk-durumu
       start konuk key not < konuk-oda invalid
             continue
       not invalid 
       perform with test after until fs-konuk = "10"
       read konuk next no lock end move "10" to fs-konuk
       not at end 

           if konuk-durumu = "H" 
              exit perform
           end-if 

           if konuk-fol-kodu not = "R"
              exit perform cycle
           end-if

           if rapor-satiri > 49
              move 1 to rapor-satiri
              initialize liste-rec
              write liste-rec after page
              perform baslik-ciz-kutu-at              
           end-if

           initialize lucky-rec 
           move rapor-satiri       to zz
           move zz                 to lck1
           move konuk-odano        to lck2
           initialize odalar-rec
           move konuk-odano       to odalar-anah
           read odalar no lock invalid 
                continue
           end-read
           move odalar-durumu      to lck3        
*           move house-durumu       to lck4
           move konuk-buyuk        to zz
           move zz                 to lck5
           move konuk-kucuk        to zz
           move zz                 to lck6
           if konuk-kucuk = 0 and konuk-buyuk not = 0
              move "XX"            to lck6
           end-if
           move konuk-free         to zz
           move zz                 to lck7
           if konuk-free = 0 and konuk-buyuk not = 0
              move "XX"            to lck7
           end-if
           move konuk-bebek        to zz
           move zz                 to lck8
           if konuk-bebek = 0 and konuk-buyuk not = 0
              move "XX"            to lck8
           end-if
           move house-buyuk        to zz
           move zz                 to lck9
           if house-buyuk = 0 and konuk-buyuk not = 0
              move "XX"            to lck9
           end-if
           move konuk-vip          to lck10
           move konuk-adi(1:9)     to lck11
           move konuk-soyadi(1:9)  to lck12
           if konuk-buyuk not = 0 
              initialize tarih
              move konuk-gel-yil      to yil
              move konuk-gel-ay       to ay
              move konuk-gel-gun      to gun
              move tarih              to lck13
              initialize tarih
              move konuk-git-yil      to yil
              move konuk-git-ay       to ay
              move konuk-git-gun      to gun
              move tarih              to lck14
           end-if
           write liste-rec from lucky-rec before advancing 1 line
           perform soldan-saga-ciz
           add 1 to rapor-satiri
           add 1 to lsr-satir
           add 1 to sutun-y
     end-read
     end-perform
     end-start
     close odalar konuk.



                .
*
 sutunlari-ciz.
     perform varying sutun-y
             from 1
             by 1
             until sutun-y  = 200
       evaluate sutun-y
             when 7                              | col-2
             when 13                             | col-4
             when 19                             | col-6
             when 22                             | col-7
             when 31                             | col-10
             when 43                             | col-11
             when 55                             | col-12
             when 65                             | col-13 
             when 68
             when 71
             when 74
             when 77                             | col-14 
             when 82                             | col-16 Çarþaf
             when 87                             | col-17 Y.Kýlýfý
             when 92                             | col-18 B.Havlu
             when 97                             | col-19 Yorgan
             when 102                            | col-23 
             when 112                            | col-26 
             when 122                            | col-29 
                 perform ustten-alta-ciz           
           end-evaluate
     end-perform
     .
*
 aciklamalari-ekle.
     perform varying lsr-satir
       from 60
       by 1
       until lsr-satir = 92
         evaluate lsr-satir
           when 69
                perform winprint-column-reset
                move 5 to lsr-sutun
                perform set-cursor
                initialize liste-rec lsr-kayit
                move "NOT : Kontrol edilen odalara tik iþareti konulur. Uygunsuzluk gorulur ise (-) isaretlenir. Aciklamasi alt boluma yapilir." to liste-rec(5:) 
                write liste-rec
           when 70
                perform winprint-column-reset
                move 5 to lsr-sutun
                perform set-cursor
                initialize liste-rec lsr-kayit
                move "Aciklama :" to lsr-kayit(5:)
                write liste-rec from lsr-kayit
           when 80 
               perform winprint-column-reset
               initialize lsr-kayit liste-rec
               perform set-cursor
               move "*     C/Out Olacak"                 to lsr-kayit(5:20)
               move "$$    C/In Olacak"                  to lsr-kayit(35:20)
               move "**$$  C/Out Oldu Blokajli Oda"      to lsr-kayit(65:40)
               move "**$   C/Out Oldu - C/In Oldu"       to lsr-kayit(125:)
               write liste-rec from lsr-kayit 
           when 81 
               perform winprint-column-reset
               initialize lsr-kayit liste-rec
               perform set-cursor
               move "**    C/Out Oldu"                    to lsr-kayit(5:20)
               move " $     C/In Oldu"                    to lsr-kayit(35:20)
               move "    *$$   C/Out Olacak Blokajli Oda" to lsr-kayit(65:40)
               write liste-rec from lsr-kayit 
           when 83 
               perform winprint-column-reset
               initialize lsr-kayit liste-rec
               perform set-cursor
               move "CI      -Giris Yapan Oda"              to lsr-kayit(5:30)
               move "    VR    -Bos Temiz Oda"           to lsr-kayit(40:75)
               move "OR    -Dolu Temiz Oda"              to lsr-kayit(85:120)

               move "N-Normal"                           to lsr-kayit(110:8)
               move "1-V.I.P 1"                          to lsr-kayit(120:9)
               move "2-V.I.P 2"                          to lsr-kayit(131:9)
               move "3-V.I.P 3"                          to lsr-kayit(142:9)
               move "B-Balayi"                           to lsr-kayit(153:8)
               move "G-G.Repeat"                         to lsr-kayit(163:10)

               write liste-rec from lsr-kayit 
           when 84 
               perform winprint-column-reset
               initialize lsr-kayit liste-rec
               perform set-cursor
               move "CO    -Cikis Yapan Oda"            to lsr-kayit(5:30)
               move "  VD    -Bos Kirli Oda"            to lsr-kayit(40:75)
               move "  OD     -Dolu Kirli Oda"          to lsr-kayit(85:120)

               move "T-Top Vip"                          to lsr-kayit(116:9)
               move "V-V.I.P"                            to lsr-kayit(127:7)
               write liste-rec from lsr-kayit 
           when 85 
               perform winprint-column-reset
               initialize lsr-kayit liste-rec
               perform set-cursor
               move "Ext      -Tatilini Uzatan Oda"         to lsr-kayit(5:30)
               move "    OO    -Arizali Oda"             to lsr-kayit(40:75)
               move "      R/C   -Oda Degisikligi"        to lsr-kayit(85:120)
               move "        PE    -Otel Idaresi Tarafindan Kullanilan Oda"              to lsr-kayit(130:)
               write liste-rec from lsr-kayit 
           when 86 
               perform winprint-column-reset
               initialize lsr-kayit liste-rec
               perform set-cursor
               move "S/Out -Dolu Kullanilmis Oda"        to lsr-kayit(5:30)
               move "OS    -Kapali Oda"                  to lsr-kayit(40:75)
               move "   V     -Ozel Misafir"                to lsr-kayit(85:120)
               move "      RE    -Rahatsiz Edilmek Istemeyen Oda"                      to lsr-kayit(130:)
               write liste-rec from lsr-kayit  
           when 87
               perform winprint-column-reset
               initialize lsr-kayit liste-rec
               perform set-cursor   

               initialize wprtdata-draw
               move 2                    to wprtdata-draw-start-x
               move 131                  to wprtdata-draw-stop-x
               move 88                   to wprtdata-draw-start-y
               move 88                   to wprtdata-draw-stop-y
               perform cizgi-ciz  
             
*               move "KY.HK.FR.06"                        to lsr-kayit(5:30)
*               move "Rev.No:00 /01.01.2017"              to lsr-kayit(210:)
                move  iso-rapor-adi        to lsr-kayit(5:30)
                move  iso-rez-gercek-no           to lsr-kayit(210:)
               write liste-rec from lsr-kayit  
         end-evaluate
     end-perform
        .

*
 kutu-ici-cizgi-ciz.
     perform varying i
     from 71
     by 1
     until i > 81

                initialize wprtdata-draw
                move 2                    to wprtdata-draw-start-x
                move 131                  to wprtdata-draw-stop-x
                move i                    to wprtdata-draw-start-y
                move i                    to wprtdata-draw-stop-y
                perform cizgi-ciz

     end-perform.

*
 baslik-ciz-kutu-at.
    perform set-font-normal.
    perform winprint-column-reset

    open i-o isyeri
    initialize isyeri-rec
    move isyeri-adres-tasi        to isyeri-adres
    read isyeri key isyeri-adres invalid
         continue
    end-read
    close isyeri

    perform set-font-normal.

    move 2 to lsr-satir 

    move "Tesis Adi :"        to kadir(5:20)
    move isyeri-unvan         to kadir(25:)

    accept tarih-tasi from century-date
    move "Rapor Tarihi :"       to kadir(150:20)
    if history = 1
       move ilk-gun to gun
       move ilk-ay  to ay
       move ilk-yil to yil
       move tarih          to kadir(165:)
    else
       move gun-tasi to gun
       move ay-tasi  to ay
       move yil-tasi to yil
       move tarih          to kadir(165:)
    end-if
    write liste-rec from kadir

    initialize kadir
    move 10 to lsr-satir
    move "Kat Gorevlisi :"  to kadir (5:16)
    move odalar-maid to kadir (30:4)
    write liste-rec from kadir

    perform set-font-baslik.
    perform baslik-yaz.

    perform set-font-normal.


    perform genel-kutu-ciz-1
    perform genel-kutu-ciz-2



*//////////FONT U 90 DERECE CEVIR
    perform set-font-90
*    move 115           to lsr-sutun
*    move 19          to lsr-satir
*    perform set-cursor
*    initialize liste-rec
*    move "Banyo Seramik"         to liste-rec
*    write liste-rec before advancing 1 line

*    move 118           to lsr-sutun
*    move 19          to lsr-satir
*    perform set-cursor
*    initialize liste-rec
*    move "Batarya - Gider"         to liste-rec
*    write liste-rec before advancing 1 line

    move 120           to lsr-sutun
    move 19          to lsr-satir
    perform set-cursor
    initialize liste-rec
    move "Giris Tarihi"         to liste-rec
    write liste-rec before advancing 1 line

*   move 124           to lsr-sutun
*   move 19          to lsr-satir
*   perform set-cursor
*   initialize liste-rec
*   move "Havlu - Buklet"         to liste-rec
*   write liste-rec before advancing 1 line

    move 130           to lsr-sutun
    move 19          to lsr-satir
    perform set-cursor
    initialize liste-rec
    move "Cikis Tarihi"         to liste-rec
    write liste-rec before advancing 1 line
          


   
 
        perform winprint-column-reset
         perform winprint-column-set.

    move 1           to lsr-sutun
    move 19          to lsr-satir
    perform set-cursor
    initialize lsr-kayit
    move "Oda No"                       to l2
    move "Sistem Durumu"                to l5
*    move "Kat G."                       to l7
*    move "Durum"                        to l8
    move "Kat G."                       to l9
    move "Durum"                        to l10
    move "Kat G."                       to l11
    move "Giris Saati"                  to l12
    move "Kat G."                       to l13-1
    move "Cikis Saati"                  to l13
    move "VIP"                          to l14

    move "Pax"                          to l15
    move "Child"                        to l16
    move "Free"                         to l17
    move "Baby"                         to l18
    move "Carsaf"                       to l19
    move "Y. Kilifi"                    to l20
    move "B. Havlu"                     to l21
    move "Yorgan"                       to l22 
    move "Carsaf Degisimi"              to l23 

    move "Uyruk"                        to l26 
    move "Giris Tarihi"                 to l29 
    move "Cikis Tarihi"                 to l31 
    MOVE ALL SPACES TO L27 L28 L29 L30 L31

    write liste-rec from lsr-kayit before advancing 1 line

*/DERECEYI NORMALE CEVIR
    perform set-font-normal
    perform aciklamalari-ekle
    move 5  to lsr-sutun
    move 20 to lsr-satir
    perform set-cursor
    perform winprint-column-reset
    perform Winprint-Column-Set-Lucky
    perform sutunlari-ciz.

 Form1-Ef-1-Aft-Procedure.
       initialize gec-gecme
       if rapor-staf = spaces
          modify lb-staf-adi, title = "Tum Kullanicilar"
          exit paragraph.
       open input kllnc
       move rapor-staf to k-kodu
       read kllnc no lock invalid 
            modify lb-staf-adi, title = "Tanimsiz Kullanici"
            move 4 to accept-control
            move 4 to control-id
            move 1 to gec-gecme
       not invalid
           modify lb-staf-adi, title = k-soyadi
       end-read
       close kllnc.
*
 Form1-Ef-1a-Aft-Procedure.
       initialize gec-gecme
       if rapor-st = spaces
          modify lb-durum-adi, title = "Tum Durumlar"
          exit paragraph.
       open input kodlar02
       move "C"  to kodlar02-tipi
       move rapor-st to kodlar02-kodu
       read kodlar02 no lock invalid 
                   modify lb-durum-adi, title = "Tanimsiz HK Durumu"
                   move 4 to accept-control
                   move 7 to control-id
                   move 1 to gec-gecme
        not invalid
            modify lb-durum-adi, title = kodlar02-adi
        end-read
        close kodlar02.
     .
*
 Before-Procedure.
     
     .
*
 acc-konum-Aft-Procedure.
     if rapor-konum not = 0
        perform konum-oku
     else
       modify lb-pansiyon-e,title = "Tum Konumlar"
     end-if .
     
*
 hkonuk-ara2.
    initialize konuk-rec rez-rec oda-var-yok temizlik-var-yok.
    move cast-rez-no   to rez-no.
    read rez no lock invalid go hkonuk-ara-exit. 
    if rez-durumu not = "I" go hkonuk-ara-exit. 
    move rez-folio   to konuk-folio.
    read konuk no lock invalid go hkonuk-ara-exit.
    if konuk-fol-kodu   = "R" or konuk-fol-kodu = "G"  
       continue
    else
       go hkonuk-ara-exit 
    end-if.
    if konuk-git-tar <= cast-tarih go hkonuk-ara-exit .
*   TRACE Uygulamasi Acik ise kisi sayilari cast'tan alinacak
    if rezpara-trace = 1
       if konuk-kisi not = cast-kisi
          move cast-kisi to konuk-kisi
       end-if
    end-if
*

       move 1 to oda-var-yok.
    if konuk-gel-tar = tarih-tasi 
       move 1 to temizlik-var-yok go hkonuk-yaz-cik
    end-if.
    if temizlik-gunu < 2 move 1 to temizlik-var-yok 
       go hkonuk-yaz-cik
    end-if.
       perform temize-dahil thru temize-dahil-exit
       initialize bolunen kalan
       divide defa by temizlik-gunu giving bolunen remainder kalan

    if takvim-anah > konuk-git-tar
       move 0 to temizlik-var-yok go hkonuk-yaz-cik
    end-if.
    if kalan = 0
       move 1 to temizlik-var-yok go hkonuk-yaz-cik
    end-if.
 hkonuk-yaz-cik.
 
     perform satir-ekle.

 hkonuk-ara-exit.
       exit.
     
*
 History-tikla.
        display la1 acc-01 acc-02 acc-03
     .
 hkonuk-ara.
    initialize cast-rec bulunan-odano
    move ilk-tarih     to cast-tarih
    move odalar-anah   to cast-oda-no
    start cast key = cast-anah3 
      invalid 
         initialize konuk-rec
          move odalar-anah  to konuk-odano
          perform satir-ekle
      not invalid 
          perform until  fs-cast = "10"
             read cast next no lock 
                end move "10" to fs-cast
                not end
                  if ilk-tarih not = cast-tarih or 
                     odalar-anah not = cast-oda-no
                      move "10" to fs-cast
                  else
                        move cast-oda-no     to bulunan-odano
                        perform hkonuk-ara2 thru hkonuk-ara-exit
                        
                  end-if
             end-read
          end-perform
    end-start.
*
 konum-ara.
      initialize konum-cagir.
      call "/asya/ytl/obj/otel/konumara.asy" using konum-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/konumara.asy" 
       end-call
       move konum-cagir  to rapor-konum
       perform konum-oku.
*
 konum-oku.
       open input konum
       initialize konum-rec 
       move rapor-konum to rapor-konum konum-anahtar
       read konum no lock invalid 
            move 4        to accept-control
            move 1011     to control-id
            exit paragraph
            not invalid continue 
       end-read
       close konum
       modify lb-pansiyon-e, title = konum-adi
       display acc-konum.
*     ,



*
 liste-uyum.
       move konuk-acenta  to acenta-kodu
    read acenta no lock invalid
         continue
    not invalid
         continue
    end-read
    initialize kodlar02-rec.
    move "B" to kodlar02-tipi.
    move konuk-odeme-tipi to kodlar02-kodu.
    read kodlar02 no lock invalid
         move spaces to kodlar02-adi
    end-read
         if ode-posting = "H" set oda-yok to true
         end-if.


*
 satir-ekle.
    if rapor-satiri > 49
       move 1 to rapor-satiri
       initialize liste-rec
       write liste-rec after page
       perform baslik-ciz-kutu-at              
    end-if
                 
    if complar-haric = 1 then
       perform liste-uyum
    end-if

    if oda-yok   
       initialize konuk-rec
       move odalar-anah  to konuk-odano
    end-if

    if history = 1 then
       move "VD"  to odalar-durumu

    end-if

    initialize  lucky-rec

    move konuk-buyuk        to zz
    move zz                 to lck5
    move konuk-kucuk        to zz
    move zz                 to lck6
    move konuk-free         to zz
    move zz                 to lck7

    move konuk-bebek        to zz
    move zz                 to lck8


    move odalar-durumu   to lck3

    if bulunan-odano not = spaces
       move bulunan-odano       to lck2
    else
       move konuk-odano       to lck2
    end-if

    move konuk-adi(1:9)     to lck11
    move konuk-soyadi(1:9)  to lck12
    if konuk-buyuk not = 0
       initialize tarih
       move konuk-gel-yil      to yil
       move konuk-gel-ay       to ay
       move konuk-gel-gun      to gun
       move tarih              to lck13
       move konuk-vip          to lck10
       
       initialize tarih
       move konuk-git-yil      to yil
       move konuk-git-ay       to ay
       move konuk-git-gun      to gun
       move tarih              to lck14
    end-if
    if oda-yok and bos-ciksin = 0  then
       continue
    else
      if ( odalar-hayali = "H" or odalar-hayal2 = 1 ) and konuk-adi = spaces 
         and konuk-soyadi = spaces 
             continue
      else
*************************************TURATTTTTTTTTTTTTTTTTTTTTT
        if rapor-satiri > 49
           move 1 to rapor-satiri
           initialize liste-rec
           write liste-rec after page
           perform baslik-ciz-kutu-at              
        end-if

        initialize lucky-rec 
        move konuk-odano        to lck2
        initialize odalar-rec
        move konuk-odano       to odalar-anah
        read odalar no lock invalid 
             continue
        end-read
        move odalar-durumu      to lck5      |

        move konuk-buyuk        to zz
        move zz                 to lck14
        move konuk-kucuk        to zz
        move zz                 to lck15
        if konuk-buyuk = 0 
           move 0 to zz
           move zz to lck15
        end-if
        move konuk-free         to zz
        move zz                 to lck16
        if konuk-buyuk = 0 
           move 0 to zz
           move zz to lck16
        end-if
        move konuk-bebek        to zz
        move zz                 to lck17
        if konuk-buyuk = 0 
           move 0 to zz
           move zz to lck17
        end-if
*****09.02.2018 tarihli adalya ismail beyin isteði üzerine kaldýrýldý Ramazan
*         if konuk-vip = "V" 
*            move "V.I.P."     to lck13
*         end-if
*         if konuk-vip = "T" 
*            move "Top VIP"    to lck13
*         end-if
*         if konuk-vip = "N" 
*            move "Normal"     to lck13
*         end-if
      move konuk-vip          to lck13
*****09.02.2018 tarihli adalya ismail beyin isteði üzerine kaldýrýldý Ramazan
         
         if tem-gunu not = 0
            perform temizlik-gun-kontrol
            if tem-gun-durumu = 1
               move "X" to lck23
*/*******************eski hali T idi
            end-if 
         end-if
         initialize rez-rec
         move konuk-rez-no to rez-no
         read rez no lock invalid 
              continue
         end-read
         perform uyruk-oku
         if konuk-buyuk not = 0 
            move rap-uyruk(1:7)   to lck24
         end-if
        if konuk-buyuk not = 0
           initialize tarih
           move konuk-gel-yil      to yil
           move konuk-gel-ay       to ay
           move konuk-gel-gun      to gun
           move tarih              to lck25
           initialize tarih
           move konuk-git-yil      to yil
           move konuk-git-ay       to ay
           move konuk-git-gun      to gun
           move tarih              to lck26
        end-if
        write liste-rec from lucky-rec before advancing 1 line
        perform soldan-saga-ciz
        add 1 to rapor-satiri
        add 1 to lsr-satir
        add 1 to sutun-y
*************************************TURATTTTTTTTTTTTTTTTTTTTTT
       initialize cikmayan
    end-if
    end-if.

 temize-dahil.  
    initialize defa
    move konuk-gel-tar   to takvim-anah
    start takvim key > takvim-anah invalid
    not invalid
       perform with test after until fs-takvim = "10"
        read takvim next no lock end move "10" to fs-takvim
          not at end
           if takvim-anah > tarih-tasi or
              takvim-anah = tarih-tasi 
              move "10" to fs-takvim
           end-if
           add 1 to defa
        end-read
       end-perform
    end-start.
 temize-dahil-exit.
       exit.


 konuk-ara.
    initialize konuk-rec oda-var-yok temizlik-var-yok.
    move "I"          to konuk-durumu.
    move odalar-anah  to konuk-odano.
    start konuk key = konuk-oda invalid
          initialize konuk-rec
          move odalar-anah  to konuk-odano
          go konuk-ara-exit.
 konuk-oku.
    read konuk next no lock end go konuk-ara-exit.
    if fs-konuk = 99 go konuk-oku.
    if konuk-odano      > odalar-anah  go konuk-ara-exit.
    if konuk-durumu not = "I" go konuk-ara-exit.
    if konuk-fol-kodu   = "R" or konuk-fol-kodu = "G" 
       continue
    else 
       go konuk-oku
    end-if.
       move 1 to oda-var-yok.
    if temizlik-gunu < 2 move 1 to temizlik-var-yok 
       go konuk-ara-exit
    end-if.
       perform temize-dahil thru temize-dahil-exit
       initialize bolunen kalan
              divide defa by temizlik-gunu giving bolunen remainder kalan

    if takvim-anah >= konuk-git-tar
       move 0 to temizlik-var-yok go konuk-ara-exit
    end-if.
    if takvim-anah = konuk-gel-tar
       move 0 to temizlik-var-yok go konuk-ara-exit
    end-if.
    if kalan = 0
       move 1 to temizlik-var-yok go konuk-ara-exit
    end-if.
 konuk-ara-exit.
       exit.
*
 uyruk-oku.
     open i-o polisxml ulke uyruk
     initialize polisxml-rec
     move rez-no         to polisxml-rezno
     move 1              to polisxml-sirano
     read polisxml no lock invalid
          initialize ulke-rec
          move rez-ulke       to ulke-anah
          read ulke no lock invalid 
              continue 
          not invalid 
              initialize uyruk-rec
              move ULKE-akbs   to uyruk-anah
              read uyruk no lock invalid
                   continue 
              end-read 
          end-read 
     not invalid 
         initialize uyruk-rec
         move polisxml-uyruk   to uyruk-anah
         read uyruk no lock invalid    
             initialize ulke-rec
             move rez-ulke       to ulke-anah
             read ulke no lock invalid 
                 continue 
             not invalid 
                 initialize uyruk-rec
                 move ULKE-akbs   to uyruk-anah
                 read uyruk no lock invalid
                      continue 
                 end-read 
             end-read                             
         end-read 
     end-read 
     move uyruk-adi to rap-uyruk
     close polisxml ulke uyruk
     .
*
 Screen1-Ex-Other.
    evaluate key-status
      when 1
        evaluate control-id
        when 40
           perform konum-ara
        end-evaluate 
      when 2 


     open i-o prosif
     initialize prosif-rec
     move called-program      to prosif-cob
     move "I"                 to prosif-tipi
     read prosif no lock invalid
          continue
     not invalid
          move prosif-iso-rapor-adi                 to iso-rapor-adi
          move prosif-iso-rev-no                    to iso-rev-no
          move prosif-iso-rev-yil                   to iso-eyil
          move prosif-iso-rev-ay                    to iso-eay 
          move prosif-iso-rev-gun                   to iso-egun
          move iso-etarih                           to iso-rev-tar 
     end-read
     close prosif
        perform Form1-Ef-1-Aft-Procedure
        if gec-gecme = 0
           perform osuttur
        end-if
    end-evaluate
     .
*
 temizlik-gun-kontrol.
    initialize tem-gun-durumu
    if konuk-gel-tar = zero
       exit paragraph
    end-if
    initialize int-gel-tar int-bugun bugun
    accept bugun from century-date
    move konuk-gel-tar to gel-tar
    move function integer-of-date (gel-tar) to int-gel-tar
    move function integer-of-date (bugun)   to int-bugun
    compute int-fark rounded = int-bugun - int-gel-tar
       divide int-fark by tem-gunu giving bolunen remainder kalan1
    if kalan1 = 0 
       move 1 to tem-gun-durumu                         
    else 
       move 0      to tem-gun-durumu
    end-if
      .

 
