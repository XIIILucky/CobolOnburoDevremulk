* profbul.evt
* profbul.evt is generated from D:\asya\acugt.ytl\otel\profbul.Psf
* This is a generated file. DO NOT modify this file directly.


 Form5-Event-Proc.
     .

 Form5-Exception-Proc.
     PERFORM Form5-Ex-Other
     .

 Form1-Gd-2-Event-Proc.
     PERFORM gd2-Ev-Other
     .

 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .

 Form1-Gd-1-Event-Proc.
     PERFORM Form1-Gd-1-Ev-Other
     .
***   start event editor code   ***
*
 Form5-Bef-Create.
     perform adresleri-tasi
     call "c$narg" using link-var
     open i-o genel genel2
     move 1 to genel-anahtar genel2-anah
     read genel no lock invalid 
          Continue
     end-read

     read genel2 no lock invalid
          continue
     end-read
     close genel genel2  
     if genel-profil-kolbandi-aktif = 1
        open i-o bantstok
        initialize bantstok-rec stok-var
        move 1 to bantstok-anah-kodu
        read bantstok no lock invalid
             move 0 to stok-var
        not invalid 
             move 1 to stok-var
        end-read 
        close bantstok
        if genel2-kolbandi-algo-stok-yok = 1
            move 0 to stok-var
        end-if 
        if stok-var = 1
           perform acuserve-bant-adres-aktar
        end-if
     end-if
     .
*
 profile-eslesen-ara.
    open i-o genelfis
    move 1 to genelfis-anahtar
    read genelfis no lock invalid
         accept print-no from time
    not invalid
         add 1 to print-no
         rewrite genelfis-rec end-rewrite
    end-read
    close genelfis
    move print-no to takasp-dno
    open output takasp close takasp         

    open input  musteri 
    open i-o takasp
    if ada-gode-arama = 1
       if musteri-kart-filtre <> spaces
          initialize  musteri-rec c5  
          move musteri-kart-filtre      to musteri-puan-kart-no
          start musteri key not < musteri-puan-kart-no invalid
                continue
          not invalid
          perform with test after until fs-musteri = "10"
          read musteri next no lock end move "10" to fs-musteri
          not at end
                  if musteri-puan-kart-no <> musteri-kart-filtre
                      exit perform 
                  end-if 
                  if musteri-silindi = 1 and 
                     silinen-getir = 0
                         exit perform cycle 
                  end-if
          
                  if musteri-sirket = spaces or 
                     musteri-no = zeroes
                       exit perform cycle
                  end-if
              
                 add 1                   to c5
                 initialize takasp-rec 
*                 move m-profil           to takasp-anah            |mprofil bos geliyor o yuzden icini dagýttým fýrat 17/08/2020
                 move musteri-no         to takasp-no
                 move musteri-sirket     to takasp-sirket

                 move puan               to takasp-puan
                 move musteri-adi        to takasp-adi
                 move musteri-soyadi     to takasp-soyadi 
                 move musteri-d-tarihi   to takasp-d-tarih
                 move musteri-silindi    to takasp-silinen
                 move musteri-e-mail     to takasp-email
                 evaluate musteri-b-turu
                 when "P"
                      move musteri-seri-no    to takasp-seri-no
                 when "N"
                      move musteri-kim-tcno   to takasp-tc-no
                 when other 
                      move musteri-seri-no    to takasp-seri-no
                 end-evaluate
                 move musteri-b-turu          to takasp-b-turu
                 if musteri-puan-kart-no > zeroes 
                    move musteri-puan-kart-no         to takasp-kart-no
                 end-if 
                 write takasp-rec invalid 
                    rewrite takasp-rec end-rewrite 
                 end-write 
          end-read
          end-perform
          end-start
       else
          open i-o kolbant
          initialize kolbant-rec 
          move musteri-bant-filtre to kolbant-seri-no
          start kolbant key not < kolbant-anah1 invalid
                continue
          not invalid
          perform with test after until fs-kolbant = "10" 
          read kolbant next no lock end move "10" to fs-kolbant
          not at end 
              if musteri-bant-filtre <> kolbant-seri-no
                 exit perform 
              end-if
              if musteri-bant-filtre = kolbant-seri-no
                 initialize musteri-rec 
*                 move kolbant-mus-anah to m-profil       |mprofil bos geliyor o yuzden icini dagýttým fýrat 17/08/2020
                 move kolbant-mus-sirket to musteri-sirket
                 move kolbant-mus-profil to musteri-no
                 read musteri no lock invalid    
                      continue
                 not invalid
                 add 1                   to c5
                 initialize takasp-rec 
*                 move m-profil           to takasp-anah            |mprofil bos geliyor o yuzden icini dagýttým fýrat 17/08/2020
                 move musteri-no         to takasp-no
                 move musteri-sirket     to takasp-sirket

                 move puan               to takasp-puan
                 move musteri-adi        to takasp-adi
                 move musteri-soyadi     to takasp-soyadi 
                 move musteri-d-tarihi   to takasp-d-tarih
                 move musteri-silindi    to takasp-silinen
                 move musteri-e-mail     to takasp-email
                 evaluate musteri-b-turu
                 when "P"
                      move musteri-seri-no    to takasp-seri-no
                 when "N"
                      move musteri-kim-tcno   to takasp-tc-no
                 when other 
                      move musteri-seri-no    to takasp-seri-no
                 end-evaluate
                 move musteri-b-turu          to takasp-b-turu
                 if musteri-puan-kart-no > zeroes 
                    move musteri-puan-kart-no         to takasp-kart-no
                 end-if 
                 write takasp-rec invalid 
                    rewrite takasp-rec end-rewrite 
                 end-write 
                 end-read
              end-if
          end-read
          end-perform 
          end-start
          close kolbant

       end-if
    else 

       if musteri-no-filtre = 0 
                
          initialize boy deg-boyu sira
          inspect musteri-adi-filtre tallying deg-boyu for trailing spaces
          compute boy = 30 - deg-boyu 

********************************************************************************************
          if boy > 2
             initialize  musteri-rec c5 aranan sira
             move musteri-adi-filtre(1:kac-adet)     to musteri-adi(1:kac-adet)
             move musteri-soy-filtre(1:kac-adet)     to musteri-soyadi(1:kac-adet)
             start musteri key not < musteri-ilk invalid
                   continue
             not invalid
             perform with test after until fs-musteri = "10"
             read musteri next no lock end move "10" to fs-musteri
             not at end
                 if musteri-adi(1:kac-adet) not = musteri-adi-filtre(1:kac-adet)
                    move "10"   to fs-musteri
                    exit perform cycle 
                 end-if 
        
                 if musteri-silindi = 1 and 
                    silinen-getir = 0
                        exit perform cycle 
                 end-if
             
                 if musteri-sirket = spaces or 
                    musteri-no = zeroes
                      exit perform cycle
                 end-if
                 if musteri-adi = spaces or
                    musteri-soyadi = spaces 
                      exit perform cycle 
                 end-if 
                 modify Form5-St-1-Handle, panel-index = 1
                                           panel-text = musteri-no
                 perform takas-yaz
             
             end-read
             end-perform
             end-start
          end-if 
***********************************************************************************************
          if boy > 3
             initialize  musteri-rec c5 aranan sira
             move musteri-adi-filtre(2:kac-adet)     to musteri-adi(2:kac-adet)
             start musteri key not < musteri-adi2 invalid
                   continue
             not invalid
             perform with test after until fs-musteri = "10"
             read musteri next no lock end move "10" to fs-musteri
             not at end
                 if musteri-adi(2:kac-adet) not = musteri-adi-filtre(2:kac-adet)
                    move "10"   to fs-musteri
                    exit perform cycle 
                 end-if 
        
                 if musteri-silindi = 1 and 
                    silinen-getir = 0
                        exit perform cycle 
                 end-if
             
                 if musteri-sirket = spaces or 
                    musteri-no = zeroes
                      exit perform cycle
                 end-if
                 if musteri-adi = spaces or
                    musteri-soyadi = spaces 
                      exit perform cycle 
                 end-if 

                 modify Form5-St-1-Handle, panel-index = 1
                                           panel-text = musteri-no
                 
                 perform takas-yaz
             
             end-read
             end-perform
             end-start
          end-if 
***********************************************************************************************
          if boy > 4
             initialize  musteri-rec c5 aranan  sira sira
             move musteri-adi-filtre(3:kac-adet)     to musteri-adi(3:kac-adet)
             start musteri key not < musteri-adi3 invalid
                   continue
             not invalid
             perform with test after until fs-musteri = "10"
             read musteri next no lock end move "10" to fs-musteri
             not at end
                     if musteri-adi(3:kac-adet) not = musteri-adi-filtre(3:kac-adet)
                        move "10"   to fs-musteri
                        exit perform cycle 
                     end-if 
                     add 1 to sira 
                     if musteri-silindi = 1 and 
                        silinen-getir = 0
                            exit perform cycle 
                     end-if
             
                     if musteri-sirket = spaces or 
                        musteri-no = zeroes
                          exit perform cycle
                     end-if
                     if musteri-adi = spaces or
                        musteri-soyadi = spaces 
                          exit perform cycle 
                     end-if 

                     modify Form5-St-1-Handle, panel-index = 1
                                               panel-text = musteri-no

                     perform takas-yaz
             
             end-read
             end-perform
             end-start
          end-if 
********************soyadý filtre basliyor***************************************************************************
          initialize boy deg-boyu
          inspect musteri-soy-filtre tallying deg-boyu for trailing spaces
          compute boy = 30 - deg-boyu 
          if boy > 2
             initialize  musteri-rec c5 aranan sira
             move musteri-soy-filtre(1:kac-adet)     to musteri-soyadi(1:kac-adet)
             start musteri key not < musteri-soy invalid
                   continue
             not invalid
             perform with test after until fs-musteri = "10"
             read musteri next no lock end move "10" to fs-musteri
             not at end
                 if musteri-soyadi(1:kac-adet) not = musteri-soy-filtre(1:kac-adet)
                    move "10"   to fs-musteri
                    exit perform cycle 
                 end-if 
        
                 if musteri-silindi = 1 and 
                    silinen-getir = 0
                        exit perform cycle 
                 end-if
               
                 if musteri-sirket = spaces or 
                    musteri-no = zeroes
                      exit perform cycle
                 end-if
                 if musteri-adi = spaces or
                    musteri-soyadi = spaces 
                      exit perform cycle 
                 end-if 

                 modify Form5-St-1-Handle, panel-index = 1
                                           panel-text = musteri-no
                 
                 perform takas-yaz
               
             end-read
             end-perform
             end-start
          end-if 
***********************************************************************************************
          if boy > 3
             initialize  musteri-rec c5 aranan sira
             move musteri-soy-filtre(2:kac-adet)     to musteri-soyadi(2:kac-adet)
             start musteri key not < musteri-soyadi2 invalid
                   continue
             not invalid
             perform with test after until fs-musteri = "10"
             read musteri next no lock end move "10" to fs-musteri
             not at end
                     if musteri-soyadi(2:kac-adet) not = musteri-soy-filtre(2:kac-adet)
                        move "10"   to fs-musteri
                        exit perform cycle 
                     end-if 
        
                     if musteri-silindi = 1 and 
                        silinen-getir = 0
                            exit perform cycle 
                     end-if
             
                     if musteri-sirket = spaces or 
                        musteri-no = zeroes
                          exit perform cycle
                     end-if
                     if musteri-adi = spaces or
                        musteri-soyadi = spaces 
                          exit perform cycle 
                     end-if 

                     modify Form5-St-1-Handle, panel-index = 1
                                               panel-text = musteri-no
                     
                     perform takas-yaz
             
             end-read
             end-perform
             end-start
          end-if 
***********************************************************************************************
          if boy > 4
             initialize  musteri-rec c5 aranan sira
             move musteri-soy-filtre(3:kac-adet)     to musteri-soyadi(3:kac-adet)
             start musteri key not < musteri-soyadi3 invalid
                   continue
             not invalid
             perform with test after until fs-musteri = "10"
             read musteri next no lock end move "10" to fs-musteri
             not at end
                     if musteri-soyadi(3:kac-adet) not = musteri-soy-filtre(3:kac-adet)
                        move "10"   to fs-musteri
                        exit perform cycle 
                     end-if 
        
                     if musteri-silindi = 1 and 
                        silinen-getir = 0
                            exit perform cycle 
                     end-if
             
                     if musteri-sirket = spaces or 
                        musteri-no = zeroes
                          exit perform cycle
                     end-if
                     if musteri-adi = spaces or
                        musteri-soyadi = spaces 
                          exit perform cycle 
                     end-if 

                      
 
                     modify Form5-St-1-Handle, panel-index = 1
                                               panel-text = musteri-no
                   
                     perform takas-yaz
             
             end-read
             end-perform
             end-start
          end-if 
***********************************************************************************************
       else
     
          initialize  musteri-rec c5  
          move musteri-no-filtre      to musteri-no
          start musteri key not < musteri-anah1 invalid
                continue
          not invalid
          perform with test after until fs-musteri = "10"
          read musteri next no lock end move "10" to fs-musteri
          not at end
              if musteri-no <> musteri-no-filtre
                  exit perform 
              end-if 
              if musteri-silindi = 1 and 
                 silinen-getir = 0
                     exit perform cycle 
              end-if
          
              if musteri-sirket = spaces or 
                 musteri-no = zeroes
                   exit perform cycle
              end-if
              
              add 1                   to c5
              initialize takasp-rec 
*              move m-profil           to takasp-anah            |mprofil bos geliyor o yuzden icini dagýttým fýrat 17/08/2020
              move musteri-no         to takasp-no
              move musteri-sirket     to takasp-sirket

              move puan               to takasp-puan
              move musteri-adi        to takasp-adi
              move musteri-soyadi     to takasp-soyadi 
              move musteri-d-tarihi   to takasp-d-tarih
              move musteri-silindi    to takasp-silinen
              move musteri-e-mail     to takasp-email
              evaluate musteri-b-turu
                  when "P"
                       move musteri-seri-no    to takasp-seri-no
                  when "N"
                       move musteri-kim-tcno   to takasp-tc-no
                  when other 
                       move musteri-seri-no    to takasp-seri-no
              end-evaluate
              move musteri-b-turu          to takasp-b-turu
              if musteri-puan-kart-no > zeroes 
                 move musteri-puan-kart-no         to takasp-kart-no
              end-if 
                 write takasp-rec invalid 
                    rewrite takasp-rec end-rewrite 
                 end-write 
          end-read
          end-perform
          end-start         
     
       end-if  
    end-if
    close  musteri takasp.

*
 takas-yaz.
           initialize c1 c2 c3 c4  c6 puan
           move musteri-adi            to aranan
           move musteri-adi-filtre     to aranacak
       
           if musteri-adi-filtre not = spaces             
              perform ada-gore
           end-if 
            initialize c1 c2 c3 c4  c6  
           move musteri-soyadi         to aranan
           move musteri-soy-filtre     to aranacak
       
           if musteri-soy-filtre not = spaces               
              perform ada-gore
           end-if 
          
           if puan > 0
              add 1                   to c5
              initialize takasp-rec 
*              move m-profil           to takasp-anah            |mprofil bos geliyor o yuzden icini dagýttým fýrat 17/08/2020
              move musteri-no         to takasp-no
              move musteri-sirket     to takasp-sirket
              move puan               to takasp-puan
              move musteri-adi        to takasp-adi
              move musteri-soyadi     to takasp-soyadi 
              move musteri-d-tarihi   to takasp-d-tarih
              move musteri-silindi    to takasp-silinen
              move musteri-e-mail     to takasp-email
              evaluate musteri-b-turu
              when "P"
                   move musteri-seri-no    to takasp-seri-no
              when "N"
                   move musteri-kim-tcno   to takasp-tc-no
              when other 
                   move musteri-seri-no    to takasp-seri-no
              end-evaluate
              move musteri-b-turu          to takasp-b-turu
              if musteri-puan-kart-no > zeroes 
                 move musteri-puan-kart-no         to takasp-kart-no
              end-if 
              write takasp-rec invalid 
                 rewrite takasp-rec end-rewrite 
              end-write 
           end-if .

*
 ada-gore.       
        inspect aranan tallying c1 for trailing spaces
        compute c2 = 30 - c1
        initialize c1
        inspect aranacak tallying c1 for trailing spaces
        compute c3 = 30 - c1 

        if c2 > c3
                move c3  to kisa
                move 0   to c4
                inspect aranan tallying c4 for all aranacak(1:c3)
                if c4 > 0 
                    move 0 to sayac  
                    unstring    aranan delimited by aranacak(1:c3)
                    into cop-deg
                                             pointer sayac
                   if sayac > 9 
                      move 9  to sayac
                   end-if 
                   compute puan = puan + (kisa * 200) * (11 - sayac)
                   if c2 = c3 
                       add 3000 to puan
                   end-if
                   exit paragraph
                end-if 
        
                move 0 to c4
                inspect aranan(1:3) tallying c4 for all aranacak(1:3)
                if c4 > 0
                   add 2000 to puan
                end-if
        
                move 0 to c4
                inspect aranan tallying c4 for all aranacak(1:c3)
                if c4 > 0
                   add 3000 to puan
                end-if 
        
                perform varying i 
                          from 1
                          by 1
                          until i > c3 - 2
                              move 0   to c4 
                              inspect aranan tallying c4 for all aranacak(i:3)
                              if c4 > 0
                                if i = 1
                                   add 1000 to puan
                                end-if 
                                  add 500 to puan
                              end-if 
                end-perform
        
                perform varying i 
                          from 1
                          by 1
                          until i > c3 - 1
                              move 0   to c4 
                              inspect aranan tallying c4 for all aranacak(i:2)
                              if c4 > 0
                                if i = 1
                                   add 500 to puan
                                end-if 
                                  add 300 to puan
                              end-if 
                end-perform
        else 
                move 0 to c4
                move c2  to kisa
                inspect aranacak tallying c4 for all aranan(1:c2)
                if c4 > 0
                    move 0 to sayac  
                    unstring    aranacak delimited by aranan(1:c2)
                    into cop-deg
                                             pointer sayac
                   if sayac > 9 
                      move 9  to sayac
                   end-if 
                   compute puan = puan + (kisa * 200) * (11 - sayac)                   
                   if c2 = c3 
                      add 3000 to puan
                   end-if
                   exit paragraph
                end-if 
        
                move 0 to c4
                inspect aranan(1:3) tallying c4 for all aranacak(1:3)
                if c4 > 0
                   add 2000 to puan
                end-if
        
                move 0 to c4
                inspect aranan tallying c4 for all aranacak(1:c2)
                if c4 > 0
                   add 3000 to puan
                end-if 
        
                perform varying i 
                          from 1
                          by 1
                          until i > c3 - 2
                              move 0   to c4 
                              inspect aranan tallying c4 for all aranacak(i:3)
                              if c4 > 0
                                if i = 1
                                   add 1000 to puan
                                end-if 
                                  add 500 to puan
                              end-if 
                end-perform
        
                perform varying i 
                          from 1
                          by 1
                          until i > c3 - 1
                              move 0   to c4 
                              inspect aranan tallying c4 for all aranacak(i:2)
                              if c4 > 0
                                if i = 1
                                   add 500 to puan
                                end-if 
                                  add 300 to puan
                              end-if 
                end-perform    
        end-if. 


     
*
 profile-grid.
    open input takasp ulke
    initialize takasp-rec i
    move high-values to takasp-puan 
    evaluate  siralama 
      WHEN 4
       start takasp key not > takasp-d-tarih invalid 
         continue 
    not invalid 
        perform pro-grid-ic
    end-start
    WHEN OTHER
    start takasp key not > takasp-puan invalid 
         continue 
    not invalid 
        perform pro-grid-ic
    end-start
    END-EVALUATE
    close takasp ulke
    modify gd2,mass-update = 0
            modify Form5-St-1-Handle, panel-index = 1
                                      panel-text = spaces
    delete file takasp.
*
 pro-grid-ic.
    perform until fs-takasp = "10"  
    read takasp previous no lock end move "10"  to fs-takasp
    not at end 
            add 1                to i
            if i > 100
               exit perform 
            end-if 
            initialize gd2-rec
            move takasp-no       to gd-2-col-1
            move takasp-adi      to gd-2-col-2
            move takasp-soyadi   to gd-2-col-3
            move takasp-d-yil    to eyil
            move takasp-d-ay     to eay
            move takasp-d-gun    to egun
            move etar            to gd-2-col-4

            move takasp-email    to gd-2-col-5

            move takasp-puan     to z-puan
            move z-puan          to gd-2-col-6

            move takasp-sirket   to gd-2-col-8
            if takasp-silinen = 1
               move "Silinen"    to gd-2-col-9
            end-if 
            evaluate takasp-b-turu
            when "P"
                move takasp-seri-no  to gd-2-col-10
            when "N"
                move takasp-tc-no    to gd-2-col-10
            when other 
                move takasp-seri-no  to gd-2-col-10
            end-evaluate 
            move takasp-kart-no      to gd-2-col-11

            modify gd2,record-to-add(gd2-rec) 
            modify Form5-St-1-Handle, panel-index = 1
                                      panel-text = takasp-no
    end-read 
    end-perform  .
*
 Form5-Aft-Initdata.
     
    if link-var > 0 
       move bulunan-profil-no      to eski-profil-no
       move bulunan-profil-sirket  to eski-profil-sirket
       move aranacak-adi           to musteri-adi-filtre
       move aranacak-soyadi        to musteri-soy-filtre
       display Form5-Ef-1a Form5-Ef-1aa
       open i-o prohrk close prohrk
       perform baslik-yukle
       perform profile-eslesen-ara-ilk-yukle
       perform profile-grid
    else
     move "."           to musteri-adi-filtre 
     move "."        to musteri-soy-filtre  
     display Form5-Ef-1a Form5-Ef-1aa
    end-if .
*
 Form5-Bef-Initdata.
     perform baslik-yukle.
*
 baslik-yukle.
     modify gd2,
            reset-grid = 1
            mass-update = 1
     move "P.No"        to gd-2-col-1
     move "Adi"         to gd-2-col-2
     move "Soyadi"      to gd-2-col-3
     move "D.Tarihi"    to gd-2-col-4
     move "E-Mail"      to gd-2-col-5
     move "#"         to gd-2-col-6
     move "Birlestir"   to gd-2-col-7
     move "Sirket"      to gd-2-col-8
     move "Durum"       to gd-2-col-9
     move "Kimlik/Pas. No" to gd-2-col-10
     move "Kart No"        to gd-2-col-11
     modify gd2,record-to-add(gd2-rec).
*
 Form5-Ex-Other.
     evaluate key-status
     when 1
        if musteri-kart-filtre not = spaces or
           musteri-bant-filtre not = spaces
           move 1         to ada-gode-arama
        end-if 
        if musteri-no-filtre = zeroes and ( musteri-adi-filtre = spaces AND musteri-soy-filtre = spaces )
               display message box "En Az 3 Karakter Ad yada Soyad Girmelisiniz."
               EXIT PARAGRAPH
        end-if

        perform baslik-yukle
        perform profile-eslesen-ara
        perform profile-grid
     when 2
        inquire gd2, CURSOR-Y sayac
        inquire gd2(sayac,1),cell-data in bulunan-profil-no
        inquire gd2(sayac,8),cell-data in bulunan-profil-sirket
        if   bulunan-profil-no > 0
             move 1 to kolbant-degistir
             perform prohrk-kaydet
             move 1          to secildi
             set exit-pushed to true
        end-if
     when 3
        initialize  bulunan-profil-no bulunan-profil-sirket
        move 2   to secildi
        perform prohrk-sil
        set exit-pushed to true 
     when 5
        perform yeni-profil  
     when 6
        if liste-sec = 0 
           display message box "Lutfen satir secimi yapiniz.."
           exit paragraph
        end-if
        initialize mis-cagir
        inquire gd2, CURSOR-Y sayac
        inquire gd2(sayac,1),cell-data in mis-no-cagir
        inquire gd2(sayac,8),cell-data in mis-sirket-cagir
         if sifre-devrede = 1
            move  sifre-devrede to mis-sifreli
         end-if
        if mis-no-cagir > 0 then 
           call "/asya/ytl/obj/otel/musteri.asy" using mis-cagir end-call
        end-if
     when 7
        perform Acu-Form1-Routine
     when 27                                            
       if link-var > 0
        move 9  to secildi
        delete file takasp
        set exit-pushed to true
       end-if
     end-evaluate.
*
 gd2-Ev-Other.
     move 1 to liste-sec
     evaluate event-type
     when msg-begin-entry
        move event-action-fail    to event-action
       evaluate event-data-1
       when 7
        move event-action-fail    to event-action
         inquire gd2(event-data-2,7),
                      hidden-data in eh
         if eh = "E"
            modify gd2(event-data-2,7),
                   hidden-data = space
                   bitmap = null
         else
            modify gd2(event-data-2,7),
                   hidden-data = "E"
                   bitmap = yes-bmp
                   bitmap-number = 1
                   bitmap-width = 16
            
         end-if
       end-evaluate
        when msg-goto-cell
        when msg-goto-cell-mouse
        when msg-begin-drag
        when msg-end-drag
        when msg-goto-cell-drag
                  inquire gd2,y in yeni-y
             if yeni-y < 2
                move 2 to yeni-y eski-y
             end-if
              modify gd2,
                    y = yeni-y,
                    start-x = 1
                    start-y = yeni-y
                    x = 11,
                    region-color = 336
             move yeni-y to eski-y
     end-evaluate.
*
 secili-yukle. 
       
     initialize max-secili secili
     inquire gd2,last-row in son-satir
     perform varying i 
              from 2 
              by 1 
              until i > son-satir
                 inquire gd2(i,7),hidden-data in yedek-secili
                 if yedek-secili = "E"
                    inquire gd2(i,7),record-data in gd2-rec
                    add 1                     to max-secili
                    move gd-2-col-1           to secili-pno(max-secili)
                    move gd-2-col-8           to secili-psirket(max-secili)
*                    inquire gd2(i,1),hidden-data in secili-panah(max-secili)
                    move gd-2-col-2           to secili-adi(max-secili)
                    move gd-2-col-3           to secili-soy(max-secili)
                    move gd-2-col-5           to secili-email(max-secili)
                    move gd-2-col-10          to secili-kimlik(max-secili)

                    move gd-2-col-4(1:2)      to secili-d-gun(max-secili)
                    move gd-2-col-4(4:2)      to secili-d-ay(max-secili)
                    move gd-2-col-4(7:4)      to secili-d-yil(max-secili)


                 end-if
     end-perform.
*
 tum-birles. 
     open i-o baglanti 
     initialize baglanti-rec
     start baglanti key not < baglanti-kodu invalid
         continue
     not invalid
     perform with test after until fs-baglanti = "10"
     read baglanti next no lock end move "10" to fs-baglanti
     not at end
             if baglanti-ana not = space and
                baglanti-alt not = space
                  if isyeri-adres-tasi = baglanti-adi(1:8)
                     move baglanti-ana to kendi-sube
                     exit perform
                  end-if
             end-if
             
     end-read
     end-perform
     end-start
     if kendi-sube = spaces then
        display message box "Kendi subemi bulamadim"
        exit paragraph
     end-if
 
      open i-o prohrk prohrk2 musteri sprohrk
      move secili-panah(son-secili)   to secili-son-anah
      perform varying i 
                 from 1 
                 by 1 
                 until i > max-secili
                      if i not = son-secili
                          move secili-panah(i)   to secili-dey-anah
                          perform tek-birles 
                      end-if
      end-perform
      close prohrk prohrk2 musteri sprohrk  close baglanti.
*
 tek-birles.
     
     move secili-dey-anah    to prohrk-profil-anah
     start prohrk key = prohrk-profil-anah invalid
          continue
     not invalid
     perform with test after until fs-prohrk = "10"
     read prohrk next no lock end move "10"   to fs-prohrk
     not at end
             if prohrk-profil-anah not = secili-dey-anah
                move "10"   to fs-prohrk
             else 
                move prohrk-rec        to prohrk2-rec
                move secili-son-anah   to prohrk2-profil-anah   
                accept prohrk2-duz-tarih from century-date
                write prohrk2-rec invalid 
                        display message box "Birlesme Yapilamadi..." 
                                        title "Uyari"
                                        icon 1


                end-write 
                         initialize baglanti-rec
                             move  prohrk2-rez-sirket to baglanti-ADI
       
                                  read baglanti no lock key baglanti-ADI  invalid
                                  continue
                                  not invalid
                                   if baglanti-ana = kendi-sube
                                         move prohrk2-rez-sirket to  yanrez-dosya-adres 
                                           open i-o yanrez
                                                  initialize yanrez-rec
                                             move  prohrk2-rez-no    to yanrez-rezno
                                              move  prohrk2-rez-sira  to yanrez-sirano
                                              read yanrez no lock invalid
                                             
                                               continue
                                             not invalid
                                            
                                                 move    prohrk2-profil-anah to   yanrez-profil-anah
                                               
                                                  rewrite yanrez-rec invalid continue end-rewrite 
                                                  perform log-operation-yanrez
                                           
                                              end-read
                                            close yanrez
                                   end-if
                                   end-read
                delete prohrk invalid 
                        display message box "Birlesme Yapilamadi..." 
                                        title "Uyari"
                                        icon 1
                end-delete
                move prohrk-rec to sprohrk-rec
                
                 accept  sprohrk-duz-tarih from century-date 
                write sprohrk-rec invalid rewrite sprohrk-rec end-write
             end-if
     end-read
     end-perform
     end-start

     initialize musteri-rec 
     move secili-dey-anah         to m-profil1  
     read musteri no lock invalid 
         continue 
     not invalid
         move 1            to musteri-silindi  
         accept  musteri-g-tarih from century-date 

         accept musteri-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
         accept musteri-edit-zaman from time          |                           

         write musteri-rec invalid 
             rewrite musteri-rec end-rewrite 
         end-write
         perform log-operation-musteri 
     end-read.      
*
 Prohrk-Kaydet.         
     if bulunan-profil-sirket not = spaces and
        bulunan-profil-no     not = zeroes and
        eski-profil-no        not = zeroes 
           perform prohrk-sil
     end-if

     if bulunan-profil-no not = zeroes and
        bulunan-profil-sirket not = spaces
*        move isyeri-adres-tasi to prohrk13-dosya-adres       
        open i-o prohrk musteri kolbant prohrk13 yanrez
        open input  rez  onbkodlar10   
        initialize prohrk-rec rez-rec 
        move bulunan-profil-sirket   to prohrk-profil-sirket
        move bulunan-profil-no       to prohrk-profil-no
        move bulunan-rez-sirketi     to prohrk-rez-sirket  rez-dosya-adres
        move aranan-rez-no           to prohrk-rez-no rez-no
        read prohrk no lock invalid 
             initialize prohrk-rec        
        end-read                
           move bulunan-profil-sirket     to prohrk-profil-sirket  MUSTERi-sirket
           move bulunan-profil-no         to prohrk-profil-no     musteri-no
           read musteri no lock invalid
              continue 
           end-read                            
           read rez no lock invalid 
             display message box "Rezervasyonu kaydettikten sonra profil baglamaniz onerilir"
           end-read
           move yan-kac         to  prohrk-rez-sira       
           move musteri-adi     to  prohrk-pro-adi       
           move musteri-soyadi  to  prohrk-pro-soyadi    
           move rez-acenta      to  prohrk-acenta       
           move rez-gir-tar     to  prohrk-gel-tar
           move rez-cik-tar     to  prohrk-git-tar
           move rez-banka       to  prohrk-banka  
           move rez-doviz       to  prohrk-doviz 
           move rez-pan-tipi    to  prohrk-pans     
           move rez-pazar       to  prohrk-pazar
           move rez-ulke        to  prohrk-ulke 
           move rez-voucher     to  prohrk-voucher
           move rez-odano       to  prohrk-odano
           perform polisxml-at

           accept prohrk-duz-tarih from century-date 
           move bulunan-rez-sirketi       to prohrk-rez-sirket
           move aranan-rez-no             to prohrk-rez-no
           write prohrk-rec invalid
               rewrite prohrk-rec end-rewrite
           end-write

           if musteri-hes-kodu not = spaces
              initialize yanrez-rec 
              move rez-no  to yanrez-rezno 
              move yan-kac to yanrez-sirano 
              read yanrez no lock invalid
                   continue
              not invalid
                  move musteri-hes-kodu to yanrez-hes-kodu 
                  rewrite yanrez-rec invalid stop " " end-rewrite 
              end-read 
           end-if
           if genel-profil-kolbandi-aktif = 1
              if mis-kol-bandi <> spaces 
                 perform kolbant-data-yaz
              else 
                 if kolbant-degistir = 1
                    perform kolbant-musteri-degistir
                 end-if
              end-if
           end-if
           perform gelis-sayisi-duzelt
        close prohrk rez musteri onbkodlar10 kolbant prohrk13 yanrez
     end-if.
*
 kolbant-musteri-degistir.
     initialize kolbant-rec 
     move aranan-rez-no to kolbant-rez-no 
     start kolbant key not < kolbant-anah invalid
           continue
     not invalid
     perform with test after until fs-kolbant = "10"
     read kolbant next no lock end move "10" to fs-kolbant
     not at end 
         if kolbant-rez-no <> aranan-rez-no 
            exit perform 
         end-if
         if kolbant-durumu <> 1 
            exit perform cycle
         end-if
         if eski-profil-no     = kolbant-mus-profil and 
            eski-profil-sirket = kolbant-mus-sirket

            move prohrk-profil-anah to kolbant-mus-anah

            if kolbant-rez-no = 0 exit perform cycle end-if

            rewrite kolbant-rec invalid
                    stop " "
            end-rewrite 

            initialize musteri-rec 
            move eski-profil-sirket to musteri-sirket
            move eski-profil-no     to musteri-no
            read musteri no lock invalid
                 continue
            not invalid
                if musteri-kol-bandi <> spaces 
                   initialize musteri-kol-bandi

                   accept musteri-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                   accept musteri-edit-zaman from time          |                           

                   rewrite musteri-rec invalid
                           stop " "
                   end-rewrite 
                end-if
            end-read 

            initialize musteri-rec 
*            move kolbant-mus-anah   to m-profil            |mprofil bos geliyor o yuzden icini dagýttým fýrat 17/08/2020
            move kolbant-mus-sirket to musteri-sirket
            move kolbant-mus-profil to musteri-no
            read musteri no lock invalid
                 continue
            not invalid
                if musteri-kol-bandi = spaces 
                   move kolbant-seri-no to musteri-kol-bandi

                   accept musteri-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                   accept musteri-edit-zaman from time          |                           

                   rewrite musteri-rec invalid
                           stop " "
                   end-rewrite 
                end-if
            end-read 
         end-if

     end-read 
     end-perform
     end-start.
*
 kolbant-data-yaz.
     move mis-kol-bandi to bant-seri
     perform bant-kisi-kontrol
     initialize tmp-ex-pax
     if genel2-kolbandi-algo-stok-yok = 1
            move 0 to bant-fazla
     end-if 
     if bant-fazla = 1 
        display message box "Aktif kolbandi sayisi rezervasyon toplam kisi sayisindan fazla olamaz." new-line
                            "Daha fazla kolbandi tanimlamasi sisteme EXTRA PAX olarak islenecektir." new-line
                            "Devam edecek misiniz...?"
                      title "[Bildirim]"
                       type 2
                       icon 2
                  returning return-code
        if return-code = 2
           exit paragraph
        end-if
        move 1 to tmp-ex-pax
     end-if
     if bant-seri(7:1) <> space 
        move bant-seri(1:6) to bant-kont
        move bant-seri      to fullbant-kont
        perform kolbant-algo-kont
        if genel2-kolbandi-algo-stok-yok = 1
           move 0 to hatali-bant
        end-if 
        if hatali-bant = 1 
           display message box "Girilen bant serisi Algoritmaya uymuyor." new-line
                               "Bant yazma islemi iptal edilmistir.."
           exit paragraph
        end-if
     else
        display message box "Girilen bant serisi 7 haneden az olamaz.." new-line
                            "Bant yazma islemi iptal edilmistir.."
        exit paragraph
     end-if
*     perform bant-mukerrer-kontrol
*     if bant-bos <> 0 
*        exit paragraph
*     end-if
*     if c-out-bant-alindi = 1 
*        move 1 to tmp-uzatma
*     end-if
     move prohrk-profil-anah to yedek-prof
     perform musteri-kolbandi-kontrol
     if profil-kolbandi-var <> 0 
        exit paragraph
     end-if
*     move tarih-tasi       to gbugun
*     move musteri-d-tarihi to gdogtar
*     perform yas-hes-pro
*     if yasz not > 2
*        display message box "2 yasindan kucuk misafirlere kolbandi verilemez.." new-line 
*                            "Kolbandi kaydedilmeyecektir.." 
*        exit paragraph
*     end-if
     if stok-var = 1
        initialize bant-seri
        move mis-kol-bandi  to bant-seri
        move bant-seri(1:6) to bant-kont
        move bant-seri      to fullbant-kont
        perform stok-seri-kontrol
     end-if
     if genel2-kolbandi-algo-stok-yok = 1
        move 0 to kolbant-seri-buldum
     end-if 
     if kolbant-seri-buldum = 0 
        if stok-var = 1
           display message box "Secilen Kolbandi Serisi Tanimlanmamis.."
                           title "Uyari"
                           icon 1
        else
           initialize kolbant-rec 
           move aranan-rez-no to kolbant-rez-no
           move mis-kol-bandi to kolbant-seri-no
           read kolbant no lock invalid    
                move 1                     to kolbant-durumu
                move tarih-tasi            to kolbant-kayit-tar
                                              kolbant-deg-tar
                move k-kodu-tasi           to kolbant-kayit-staff
                                              kolbant-deg-staff
                move bulunan-profil-sirket to kolbant-mus-sirket
                move bulunan-profil-no     to kolbant-mus-profil
                move tmp-ex-pax            to kolbant-ex-pax
                move tmp-uzatma            to kolbant-uzatma

                if kolbant-rez-no <> 0 
                   write kolbant-rec invalid
                         continue
                   end-write
                end-if
           end-read       
        end-if
     else
        initialize kolbant-rec 
        move aranan-rez-no to kolbant-rez-no
        move mis-kol-bandi to kolbant-seri-no
        read kolbant no lock invalid    
             move 1                     to kolbant-durumu
             move tarih-tasi            to kolbant-kayit-tar
                                           kolbant-deg-tar
             move k-kodu-tasi           to kolbant-kayit-staff
                                           kolbant-deg-staff
             move bulunan-profil-sirket to kolbant-mus-sirket
             move bulunan-profil-no     to kolbant-mus-profil
             move tmp-ex-pax            to kolbant-ex-pax
             move tmp-uzatma            to kolbant-uzatma
             if kolbant-rez-no <> 0 
                write kolbant-rec invalid 
                      continue
                not invalid
*                    move kolbant-mus-anah to m-profil          |firat m-profil bos geliyor 17/08/2020 
                    move kolbant-mus-profil to musteri-no 
                    move kolbant-mus-sirket to musteri-sirket
                    read musteri no lock invalid
                         continue
                    end-read
                    initialize musteri-kol-bandi

                    accept musteri-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                    accept musteri-edit-zaman from time          |                           

                    rewrite musteri-rec end-rewrite
                end-write
             end-if
        end-read       
     end-if.
*
 gelis-sayisi-duzelt.
      initialize prohrk-rec gel-sayi
      move bulunan-profil-sirket  to prohrk-profil-sirket
      move bulunan-profil-no      to prohrk-profil-no
      start prohrk key not < prohrk-anah invalid   
          continue 
      not invalid 
      perform until fs-prohrk = "10"
      read prohrk next no lock end move "10" to fs-prohrk
      not at end 
          if prohrk-profil-sirket <> bulunan-profil-sirket
             exit perform 
          end-if 
          if prohrk-profil-no <> bulunan-profil-no
              exit perform 
          end-if 
          if prohrk-rez-durumu not = "S"
             add 1 to gel-sayi
          end-if 
      end-read 
      end-perform
      end-start

      initialize musteri-rec
      move bulunan-profil-sirket     to MUSTERi-sirket
      move bulunan-profil-no         to musteri-no
      read musteri no lock invalid
          continue 
      not invalid
          move gel-sayi  to musteri-gelis-sayisi

          accept musteri-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
          accept musteri-edit-zaman from time          |                           

          rewrite musteri-rec end-rewrite 
      end-read.
*
 prohrk-sil.
     open i-o prohrk  sprohrk musteri kolbant
     initialize prohrk-rec kolbant-rec musteri-rec 
     move eski-profil-sirket      to prohrk-profil-sirket
     move eski-profil-no          to prohrk-profil-no
     move bulunan-rez-sirketi     to prohrk-rez-sirket
     move aranan-rez-no           to prohrk-rez-no
     move yan-kac                 to prohrk-rez-sira
       
     read prohrk no lock invalid 
          initialize prohrk-rec  
     not invalid 
       accept  prohrk-duz-tarih from century-date 
      move prohrk-rec to sprohrk-rec 
      write sprohrk-rec invalid 
         rewrite sprohrk-rec
      end-write
          delete prohrk end-delete 
     end-read      

     move prohrk-rez-no to kolbant-rez-no          |profil baglantisi kesilince kol bandi siliniyor..
     start kolbant key not < kolbant-anah invalid
           continue
     not invalid
     perform with test after until fs-kolbant = "10"
     read kolbant next no lock end move "10" to fs-kolbant
     not at end 
         if kolbant-rez-no <> prohrk-rez-no 
            exit perform 
         end-if
         if kolbant-mus-anah <> prohrk-profil-anah
            exit perform cycle
         else
            delete kolbant end-delete
*            move kolbant-mus-anah to m-profil           |firat m-profil bos geliyor 17/08/2020
            move kolbant-mus-profil to musteri-no 
            move kolbant-mus-sirket to musteri-sirket
            read musteri no lock invalid
                 continue
            not invalid
                if musteri-kol-bandi <> spaces
                   initialize musteri-kol-bandi

                   accept musteri-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                   accept musteri-edit-zaman from time          |                           

                   rewrite musteri-rec invalid
                           stop " " 
                   end-rewrite
                end-if
            end-read
         end-if
     end-read
     end-perform 
     end-start
     close prohrk sprohrk musteri kolbant.
*
 Form1-Aft-Initdata.        
     perform secili-yukle
     perform varying i
                 from 1
                 by 1
                 until i > max-secili
                     move secili-pno(i)     to gd-1-col-1
                     move secili-adi(i)     to gd-1-col-2
                     move secili-soy(i)     to gd-1-col-3
                     move secili-psirket(i) to gd-1-col-4
                     move secili-email(i)   to gd-1-col-6
                     move secili-kimlik(i)  to gd-1-col-8
                     move secili-d-gun(i)   to egun
                     move secili-d-ay(i)    to eay
                     move secili-d-yil(i)   to eyil                     
                     move etar              to gd-1-col-7

                     modify Form1-Gd-1, record-to-add(Form1-Gd-1-Record)
     end-perform.
*
 Form1-Bef-Initdata.
     perform birlesme-baslik-yukle.
*
 birlesme-baslik-yukle.
     modify Form1-Gd-1,
            reset-grid = 1
     move "P.No"          to gd-1-col-1
     move "Adi"           to gd-1-col-2
     move "Soyadi"        to gd-1-col-3
     move "Sirket"        to gd-1-col-4
***     move "#"             to gd-1-col-5
     move "E-Mail"        to gd-1-col-6
     move "D.Tarihi"      to gd-1-col-7
     move "Kimlik/Pass."  to gd-1-col-8
     modify form1-gd-1, record-to-add(form1-gd-1-record).
*
 Form1-Gd-1-Ev-Other.
     evaluate event-type
     when msg-begin-entry
        
        move event-action-fail    to event-action
       evaluate event-data-1
       when 5
          move event-action-fail    to event-action
          inquire form1-gd-1(event-data-2,5),
                       hidden-data in eh
          if eh = "E"
             modify form1-gd-1(event-data-2,5),
                    hidden-data = space
                    bitmap = null
          else
             modify form1-gd-1(event-data-2,5),
                    hidden-data = "E"
                    bitmap = yes-bmp
                    bitmap-number = 1
                    bitmap-width = 16
              move event-data-2 to son-secili
              subtract 1 from son-secili
          end-if
        end-evaluate
      end-evaluate.
*
 yeni-profil.
       if link-var > 0     
        move aranacak-adi        to mis-cagir-adi
        move aranacak-soyadi     to mis-cagir-soyadi
        move 1                   to mis-kim-cagir 
        move aranan-rez-no       to mis-kol-bandi
        call "/asya/ytl/obj/otel/musteri.asy" using mis-cagir, mis-toplu-cagir, mis-kol-bandi end-call
        if mis-no-cagir  not = 0 then 
           move mis-sirket-cagir to bulunan-profil-sirket
           move mis-no-cagir     to bulunan-profil-no
                
           perform prohrk-kaydet
           if mis-kayit = 1
              move 3 to secildi
              set exit-pushed to true
           end-if
        end-if
       else
        move musteri-adi-filtre     to mis-cagir-adi
        move musteri-soy-filtre     to mis-cagir-soyadi
        move 1                      to mis-kim-cagir        
        call "/asya/ytl/obj/otel/musteri.asy" using mis-cagir end-call
        
        if mis-no-cagir  not = 0 then            
           if mis-kayit = 1              
              move 1  to mis-kim-cagir
           end-if
        end-if
         
       end-if. 
*
 polisxml-at.
       open i-o polisxml
       initialize polisxml-rec
       move aranan-rez-no             to polisxml-rezno
       move yan-kac                   to polisxml-sirano
       read polisxml no lock invalid
            initialize polisxml-rec
       end-read
       move aranan-rez-no             to polisxml-rezno
       move yan-kac                   to polisxml-sirano
       move musteri-adi               to polisxml-adi
       move musteri-soyadi            to polisxml-soyadi
       move musteri-kim-tcno          to polisxml-tckimlikno          
       move musteri-kim-uyruk         to polisxml-uyruk      
       move musteri-kim-cinsiyet      to polisxml-cinsiyet   
       move musteri-kim-medeni        to polisxml-medeni     
       move musteri-kim-adrs          to polisxml-adr
       MOVE musteri-d-tarihi          to polisxml-dog-tar
*       move musteri-kim-adrs1        to polisxml-adrs1      
       move musteri-b-turu            to polisxml-kturu         
       move musteri-seri-no           to polisxml-kseri        
       move musteri-baba-adi          to polisxml-babaadi       
       move musteri-ana-adi           to polisxml-anaadi        
       move musteri-d-yeri            to polisxml-dyeri         
       move musteri-kim-il            to polisxml-nil         
       move musteri-kim-ilce          to polisxml-nilce       
       move musteri-kim-mahalle       to polisxml-nmahalle    
       move musteri-kim-cilt          to polisxml-ncilt       
       move musteri-kim-aile-no       to polisxml-naile    
       move musteri-kim-sira-no       to polisxml-nsira  
       move rez-odano                 to polisxml-odano
       move musteri-prb-ack           to polisxml-prb
       move REZ-GIR-TAR               to polisxml-GEL-TAR
       move rez-cik-tar               to polisxml-git-tar
       move rez-gel-zaman             to polisxml-gel-zaman
       move rez-git-zaman             to polisxml-git-zaman
       write polisxml-rec invalid 
            rewrite polisxml-rec end-write
       close polisxml.
*       if k-kodu-tasi = "X   "           
*          move 1 to girisler
*          perform kbs-exe-baglan         
*       end-if.
*
 Form1-Ex-Other.
      evaluate key-status
      when 3
         perform tum-birles
         display message box "Profil Kayitlari Birlestirildi.."
                         title "[ Uyari ]"
                         icon 1
         set exit-pushed to true 
      end-evaluate.
*/**************/*/*/*/*/*/*/*/*/*/********************////*ilk yukleme
*
 profile-eslesen-ara-ilk-yukle.
      open i-o genelfis
              move 1 to genelfis-anahtar
              read genelfis no lock invalid
                   accept print-no from time
              not invalid
                   add 1 to print-no
                   rewrite genelfis-rec end-rewrite
              end-read
              close genelfis
              move print-no to takasp-dno
    open output takasp close takasp         

    open input  musteri 
    open i-o takasp
     
          
        initialize boy deg-boyu sira
        inspect musteri-adi-filtre tallying deg-boyu for trailing spaces
        compute boy = 30 - deg-boyu 


        initialize soy-boy soy-deg-boyu
        inspect musteri-soy-filtre tallying soy-deg-boyu for trailing spaces
        compute soy-boy = 30 - soy-deg-boyu 

        evaluate true
        when boy > 2
               if soy-boy > 3
                  move 3  to soy-boy
               end-if 
               initialize  musteri-rec c5 aranan sira
               move musteri-adi-filtre(1:kac-adet)     to musteri-adi(1:kac-adet)
               move musteri-soy-filtre(1:soy-boy)      to musteri-soyadi(1:soy-boy)
               start musteri key not < musteri-ad-soy invalid
                     continue
               not invalid
               perform with test after until fs-musteri = "10"
               read musteri next no lock end move "10" to fs-musteri
               not at end
                       if musteri-adi(1:kac-adet) not = musteri-adi-filtre(1:kac-adet)
                          move "10"   to fs-musteri
                          exit perform cycle 
                       end-if 
                       if musteri-soyadi(1:soy-boy) not = musteri-soy-filtre(1:soy-boy)
                          move "10"   to fs-musteri
                          exit perform cycle 
                       end-if
                       if musteri-silindi = 1 and 
                          silinen-getir = 0
                              exit perform cycle 
                       end-if
               
                       if musteri-sirket = spaces or 
                          musteri-no = zeroes
                            exit perform cycle
                       end-if
                       if musteri-adi = spaces or
                          musteri-soyadi = spaces 
                            exit perform cycle 
                       end-if 

                       modify Form5-St-1-Handle, panel-index = 1
                                                 panel-text = musteri-no
                       perform takas-yaz
               
               end-read
               end-perform
               end-start
        when soy-boy > 2
               if boy > 3
                  move 3  to boy
               end-if
               initialize  musteri-rec c5 aranan sira
               move musteri-adi-filtre(1:boy)     to musteri-adi(1:boy)
               move musteri-soy-filtre(1:kac-adet)     to musteri-soyadi(1:kac-adet)
               start musteri key not < musteri-soy-ad invalid
                     continue
               not invalid
               perform with test after until fs-musteri = "10"
               read musteri next no lock end move "10" to fs-musteri
               not at end
                       if musteri-adi(1:boy) not = musteri-adi-filtre(1:boy)
                          move "10"   to fs-musteri
                          exit perform cycle 
                       end-if 
                       if musteri-soyadi(1:kac-adet) not = musteri-soy-filtre(1:kac-adet)
                          move "10"   to fs-musteri
                          exit perform cycle 
                       end-if
                       if musteri-silindi = 1 and 
                          silinen-getir = 0
                              exit perform cycle 
                       end-if
               
                       if musteri-sirket = spaces or 
                          musteri-no = zeroes
                            exit perform cycle
                       end-if
                       if musteri-adi = spaces or
                          musteri-soyadi = spaces 
                            exit perform cycle 
                       end-if 

                       modify Form5-St-1-Handle, panel-index = 1
                                                 panel-text = musteri-no
                       perform takas-yaz
               
               end-read
               end-perform
               end-start
        when other
             if musteri-adi-filtre = spaces or musteri-soy-filtre = spaces 
                   display message box "En Az 3 Karakter Ad yada Soyad Girmelisiniz."
             end-if
        end-evaluate 

 
    close  musteri takasp.
*/**********************/*/*/*/*/*/*/******************////*/*/*/*/*/*/
*
 gd2-Ev-Msg-Heading-Dblclick.
      if event-data-1 < 2 or 
          event-data-1 > 10
            exit paragraph
       end-if     .
*        move event-data-1   to siralama
       
   
     
     .
*
 yas-hes-pro.

     move gbugun  to yasbulilk-tarih
     move gdogtar to yasbulson-tarih
     subtract yasbulson-gun from yasbulilk-gun giving yasbulfark-gun                                        
     if yasbulfark-gun < 0 then 
       subtract 1 from yasbulilk-ay  
       evaluate yasbulilk-ay
          when 1 
          when 3 
          when 5 
          when 7 
          when 8 
          when 10 
          when 0
             add 31 to yasbulfark-gun 
          when 2
             divide yasbulilk-yil by 4 giving bolum remainder kalan
             if kalan = 0 then 
                 add 29 to yasbulfark-gun 
             else
                 add 28 to yasbulfark-gun
             end-if
          when other 
             add 30 to yasbulfark-gun 
         end-evaluate
     end-if
     subtract yasbulson-ay from yasbulilk-ay giving yasbulfark-ay 
     if yasbulfark-ay < 0 then 
       add 12 to yasbulfark-ay 
       subtract 1 from yasbulilk-yil
     end-if
     subtract yasbulson-yil from yasbulilk-yil giving yasbulfark-yil 
     compute yasbulfark-yil-say  rounded  =  yasbulfark-yil
          + ( yasbulfark-ay / 12 ) + ( yasbulfark-GUN / 365 )  
     move yasbulfark-yil-say to yasz.


 
