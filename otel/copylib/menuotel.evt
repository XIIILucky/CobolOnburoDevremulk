* menuotel.evt
* menuotel.evt is generated from D:\asya\acugt.ytl\otel\menuotel.Psf
* This is a generated file. DO NOT modify this file directly.


 Acu-Form1-Event-Extra.
     EVALUATE Event-Type
     WHEN Msg-Close
        PERFORM Acu-Form1-Msg-Close
     END-EVALUATE
     .

 Acu-Form1-Msg-Close.
     ACCEPT Quit-Mode-Flag FROM ENVIRONMENT "QUIT_MODE"
     IF Quit-Mode-Flag = ZERO
        PERFORM Acu-Form1-Exit
        IF Exit-Pushed
           PERFORM Acu-Exit-Rtn
        ELSE
           MOVE Event-Action-Fail TO Event-Action
        END-IF
     END-IF
     .

 Form1-Event-Proc.
* 
     PERFORM Acu-Form1-Event-Extra
* 
     EVALUATE Event-Type
     WHEN Msg-Menu-Input
        PERFORM Form1-Ev-Msg-Menu-Input
     WHEN Ntf-Resized
        PERFORM Form1-Ev-Ntf-Resized
     END-EVALUATE
     .

 Form1-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Resized
           PERFORM Form1-Ex-Ntf-Resized
        END-EVALUATE
     ELSE
        PERFORM Form1-Ex-Other
     END-IF
     .

 but-6-Event-Proc.
     .

 but-13-Event-Proc.
     .

 but-15-Event-Proc.
     .

 ac-ayrac-Event-Proc.
* 
     EVALUATE Event-Type
     WHEN Cmd-Clicked
        PERFORM ac-ayrac-Ev-Cmd-Clicked
     END-EVALUATE
     .

 ikaz-Event-Proc.
     .

 Form2-Event-Proc.
     .

 Form2-Exception-Proc.
     PERFORM Form2-Ex-Other
     .

 Form3-Event-Proc.
     .

 Form3-Exception-Proc.
     PERFORM Form3-Ex-Other
     .

 Form4-Event-Proc.
     .

 Form4-Exception-Proc.
     PERFORM Form4-Ex-Other
     .

 Form5-Exception-Proc.
     PERFORM Form5-Ex-Other
     .

 Form6-Event-Proc.
     .
***   start event editor code   ***
*
 menu-dosya-oku.
*/**********MENUINX**************************    
    accept inx-random from time.
    move all low-values to menuotel-inx-dosya
    string menuotel-inx-dosya,
           "/asya/ytl/liste/" delimited by low-values
           inx-random delimited by low-values
           ".mnx" delimited by low-values
           into menuotel-inx-dosya.
    open output menu-inx close menu-inx 
    open i-o menu-inx with mass-update.
    move form1-mn-1-handle to menuotel-inx-menu-handle m-menu.
    move form1-handle      to menuotel-inx-window-handle m-form.
*/*******************************************    


    open input prosif.
    open input menutext.
    initialize fs-menutext i ii satir durum
               mnu-handle-occ kisayol-i devredir
               prog-occ prog-i button-enable-dizi
    move 1 to mnu-i 
    move 0 to menu-inx-anah
    perform with test after until fs-menutext = "10"
       initialize menutext-rec
       read menutext next no lock end move "10" to fs-menutext
       not at end
            if menutext-str(1:1) = "#" or menutext-str = spaces
               exit perform cycle
            end-if
             if menutext-str(1:1) = "R" and genel-rezidance not = 1 then 
               exit perform cycle
            end-if
            if menutext-str(1:1) = "*" and ( k-kodu-tasi not = "ASYA" and  k-kodu-tasi not = "X   " )
               exit perform cycle
            end-if
            add 1 to satir
            if satir = 1
               if menutext-str(1:17) <> "ASYASOFT_WIN_MENU"
                  display message box
                          "Kullanilan menutext dosyasi, Asya-Soft Menu menutext dosyasi degil",new-line,
                          "Lutfen mesaji Ant-Bim Bilgisayara iletiniz"
                          icon mb_error_icon
                          title "Menu formati farkli"
                          stop run
               end-if
            end-if
            if menutext-str(1:19) = "KISAYOL_TANIM_BASLA"
               move "A" to durum
               exit perform cycle
            end-if
            if menutext-str(1:17) = "KISAYOL_TANIM_BIT"
               move "B" to durum
               exit perform cycle
            end-if
            if menutext-str(1:19) = "BASLIK_BUTTON_BASLA"
               move "C" to durum
               exit perform cycle
            end-if
            if menutext-str(1:17) = "BASLIK_BUTTON_BIT"
               move "D" to durum
               display but-1 but-2 but-3 but-4 but-5 but-6
               but-7 but-8 but-9 but-10 but-11 but-12 but-13
               but-14 but-15
               exit perform cycle
            end-if
            if menutext-str(1:10) = "MENU_BASLA"
               move "E" to durum
               exit perform cycle
            end-if
            if menutext-str(1:8) = "MENU_BIT"
               move "F" to durum
               exit perform
            end-if
            if menutext-str(1:1) = "+"
                move "G" to durum
            end-if
            
            evaluate durum
               when "A" 
                    add 1 to kisayol-i
                    move menutext-str     to kisayol(kisayol-i)
               when "C"
                    perform button-ekle
               when "E"
                    perform menu-proc
               when "G"
                    perform menu-proc
            end-evaluate
       end-read
    end-perform.
    close menutext.
    close prosif.
    call "w$menu" using wmenu-show,form1-mn-1-handle.
    close menu-inx.
    copy "konumoku.prc".


*    
 menu-proc.
*******************************************************************
*/ ana menu -> 
*  call "w$menu" using wmenu-new 
*                giving mnu-handle(1)
*  call "w$menu" using wmenu-add,
*                      menu-handle,
*                      0,
*                      0,
*                      "prog ismi",
*                      id,
*                      menu-handle(1)
*  program ekle ->
*  call "w$menu" using wmenu-add,
*                      mnu-handle(1),
*                      0,
*                      0,
*                      "mahsup",
*                      id
*
*  Alt menu ekleme ->
*    call "w$menu" using wmenu-new 
*                  giving mnu-handle(2)
*    call "w$menu" using wmenu-add,
*                        mnu-handle(menutext-menu-handle2),
*                        0,
*                        flag,
*                        menutext-menu-aciklama 
*                        menutext-menu-id,
*                        mnu-handle(menutext-menu-handle1)
*
***********************************************************************
      evaluate true
******************seperator bar*****************
        when menutext-str(1:1) = "+"
             if devredir = "E" 
                exit paragraph
             end-if            
             move w-separator to flag
             call "w$menu" using wmenu-add,
                                 mnu-handle(menutext-menu-handle2)
                                 0,
                                 flag
             end-call
             add 1 to menu-inx-anah
             write menu-inx-rec end-write
        when menutext-str(1:1) = "!"
             move all zeroes to mnu-handle-occ
******************Ana menu*****************
        when menutext-menu-handle1 = 0 and menutext-menu-handle2 = 0
             if menutext-menu-prog(1:5) = "DEVRE" and 
                genel-devremulk not = 1
                 move "E"    to devredir
                 exit paragraph
             else  
                 move "H"   to devredir
             end-if
                   
             move 0 to flag 
             move 1 to mnu-i
             perform wmenu-new-mem
             perform yetki-kontrol-menu
             compute menu-inx-id = satir + 8000
             call "w$menu" using wmenu-add,
                                 menu-handle,
                                 0,
                                 flag,
                                 menutext-menu-aciklama,
                                 menu-inx-id,
                                 mnu-handle(1)
             end-call
             add 1 to menu-inx-anah
             move menu-handle    to menu-inx-handle
             move flag             to menu-inx-durum
             write menu-inx-rec end-write
******************program*****************
        when menutext-menu-handle1 = 0 and menutext-menu-handle2 <> 0
             if devredir = "E" 
                exit paragraph
             end-if
             if menu-debug = "E"
                string menutext-menu-aciklama
                       x"09"
                       menutext-menu-prog
                       delimited by space into menutext-menu-aciklama
             end-if
             add 1 to prog-i
             if prog-i > max-prog
                display message box 
                        "Program adresleri icin ayrilan hafiza doldu",new-line,new-line
                        "Lutfen mesaji Ant-Bim Bilgisayara iletiniz"
                        icon mb_Error_icon
                        title "Hata"
             end-if
             move menutext-menu-prog  to prog(prog-i)
             perform yetki-kontrol,
             add 6000 to prog-i
             compute menu-inx-id = prog-i

             call "w$menu" using wmenu-add,
                                 mnu-handle(menutext-menu-handle2)
                                 0,
                                 flag,
                                 menutext-menu-aciklama,
                                 prog-i
             end-call
             subtract 6000 from prog-i

             add 1 to menu-inx-anah
             move mnu-handle(menutext-menu-handle2)    to menu-inx-handle
             move flag             to menu-inx-durum
             write menu-inx-rec end-write
******************Alt menu*****************
        when menutext-menu-handle1 <> 0 and menutext-menu-handle2 <> 0 
             if devredir = "E" 
                exit paragraph
             end-if
             move menutext-menu-handle1 to mnu-i
             perform wmenu-new-mem
             perform yetki-kontrol-menu
             compute menu-inx-id = satir + 8000
             call "w$menu" using wmenu-add,
                                 mnu-handle(menutext-menu-handle2),
                                 0,
                                 flag,
                                 menutext-menu-aciklama 
                                 menu-inx-id,
                                 mnu-handle(menutext-menu-handle1)
             add 1 to menu-inx-anah
             move mnu-handle(menutext-menu-handle2)    to menu-inx-handle
             move flag             to menu-inx-durum
             write menu-inx-rec end-write
        end-evaluate.
*
 Form1-Bef-Create. 
 
       accept yazici-buffer from command-line.
    if yazici-buffer <> spaces
       unstring yazici-buffer delimited by "-"
                  into yazici-buffer2(1)
                       yazici-buffer2(2)
                       yazici-buffer2(3)
                       yazici-buffer2(4)
                       yazici-buffer2(5)
                       yazici-buffer2(6)
                       yazici-buffer2(7)
                       yazici-buffer2(8)
                       yazici-buffer2(9)
                       yazici-buffer2(10)

        perform varying i
                from 1
                by 1
                until i > 10
*/ 10 NUMARALI YAZICI FATURA PRINTERI OLARAK AYARLANDI -001-005-FATURA=007-FSERI=1-008- GÝBÝ
*/ 9 NUMARALI YAZICI FOLU FATURA SERISI OLARAK AYARLANDI -001-005-FATURA=008-FSERI=2-008- GÝBÝ
                if function upper-case(yazici-buffer2(i)(1:6)) = "FATURA"
                   move function numval-c(yazici-buffer2(i)(8:3))    to kullanilan-yazicilar(10)
                else
                   if function upper-case(yazici-buffer2(i)(1:5)) = "FSERI"
                      move function numval-c(yazici-buffer2(i)(7:3))    to kullanilan-yazicilar(9)
                   else
                   if yazici-buffer2(i) <> spaces  and i < 9
                      move function numval-c(yazici-buffer2(i))     to kullanilan-yazicilar(i)
                   end-if
                   end-if
                end-if

        end-perform

    else
       initialize kullanilan-yazicilar-ana

    end-if


    initialize skinframework-deg yukleme-durumu
    call "/asya/ytl/obj/tcp-ip/killet.asy" 
         on exception continue
         not on exception
    cancel "/asya/ytl/obj/tcp-ip/killet.asy" 
    end-call.

    move "IMZA"   to isyeri-adres-tasi.
    set environment "cursor_mode" to "2".
    accept tarih-tasi from century-date.



************************
    move 1 to res-line res-col.
    accept terminal-abilities from terminal-info.
    accept system-information from system-info.
    compute res-temp = (((usable-screen-height - 10 ) / 2) - 41.50) / 2
    move res-temp     to res-line.
    COMPUTE RES-LINE = RES-LINE / 10.
************************

*****************LOCK-FILE
****************kaldirildi.............
*    if is-remote 
*       initialize lock-file-rec
*       move station-id            to lock-file-pid pid
*       move "ACS"                 to lock-file-sign
*       move terminal-name         to lock-file-terminal-name
*       move client-machine-name   to lock-file-client-name
*       accept lock-file-connect-time from time
*       open output lock-file close lock-file 
*       open i-o lock-file mass-update
*       move 1 to lock-file-anah
*       write lock-file-rec 
*             invalid
*                  continue
*       end-write
*    end-if.
*************************

*************CTRL-C CTRL-A CTRL-V CTRL-Z CTRL-X
    set environment "KEYSTROKE" to "exception=1971 ^x".
    set environment "KEYSTROKE" to "exception=1975 ^c".
    set environment "KEYSTROKE" to "exception=1978 ^v".
    set environment "KEYSTROKE" to "exception=1990 ^z".
    set environment "KEYSTROKE" to "exception=1453 ^a".
    Set exception value 1971 to cut-selection.  
    Set exception value 1975 to copy-selection.  
    Set exception value 1978 to paste-selection.  
    Set exception value 1990 to undo.  
    Set exception value 1453 to select-all-selection.
*    Set exception value 11   to help-cursor
    Set exception value 25   to item-help
    set environment "HELP-PROGRAM" to 
                    "/asya/ytl/obj/otel/yardim.asy".

***********************************************


    move zeroes to fs-menutext fs-prosif.
    perform acu-form2-routine.
    if giris-donus <> 1 
       goback.
    
*    perform skin-yukle
*    perform kullanici-skin-bul

    initialize key-status.
    modify form1-st-1-handle,
           panel-index = 2
           panel-text  = k-adi.
 
 yetki-kontrol.
    initialize prog-adi
    move w-enabled to flag.
    perform varying temp-a from 1 by 1 until temp-a > max-kisayol
            if kisayol(temp-a) <> spaces
               if kisayol(temp-a)(1:6) = prog(prog-i)(1:6)
                  string prog-adi,
                         kisayol(temp-a)(8:),
                         prog(prog-i)(7:),
                         ".asy"
                         delimited by space into prog-adi
                  exit perform
               end-if
           end-if
    end-perform.
*/ eger menu ise 
    if prog-adi = spaces
       move prog(prog-i) to prog-adi
    end-if
    .
    move k-kodu-tasi   to prosif-kim
    move prog-adi      to prosif-cob
    move "Y"           to prosif-tipi
    read prosif no lock invalid
*         move w-disabled to flag
         continue
    not invalid
         if prosif-giris = "H" 
            move w-disabled to flag
         end-if
    end-read.

 yetki-kontrol-menu.
    move w-enabled           to flag.
    move k-kodu-tasi         to prosif-kim
    move menutext-menu-prog  to prosif-cob
    move "Y"                 to prosif-tipi
    read prosif no lock invalid
*         move w-disabled to flag
         continue
    not invalid
         if prosif-giris = "H" 
            move w-disabled to flag
         end-if
    end-read.

 wmenu-new-mem.
*/ mnu-i -> giris 
    call "w$menu" using wmenu-new,
                  giving mnu-handle(mnu-i)
    end-call.
    if mnu-handle(mnu-i) = 0
       display message box
               "Menu olusturulurken hafiza tasmasi tespit edildi",new-line,new-line,
               "Bilgi",new-line
               menutext-str,new-line
               "Lutfen Ant-Bim Bilgisayara iletiniz"
               title "Hafiza tasmasi...",
               icon mb_ok
               stop run
    end-if.
*
 Form1-Ev-Msg-Menu-Input.
*/ cikis icin 
    if event-data-2 = 100
       stop run
    end-if
*/
    if event-data-2 < 6000
       exit paragraph
    end-if.
    if event-data-2 > 8000 and event-data-2 < 8100
       move event-data-2 to key-status
       perform Form1-Ex-Other
       exit paragraph
    end-if
*/ program id event-data-2 icinde sakli
    initialize prog-adi
    subtract 6000 from event-data-2
    if event-data-2 > 0 and event-data-2 < max-prog
       perform varying kisayol-i from 1 by 1 until kisayol-i > max-kisayol
               if kisayol(kisayol-i) <> spaces
                  if kisayol(kisayol-i)(1:6) = prog(event-data-2)(1:6)
                     string prog-adi,
                            kisayol(kisayol-i)(8:),
                            prog(event-data-2)(7:),
                            ".asy"
                            delimited by space into prog-adi
                     exit perform
                  end-if
               end-if
       end-perform

       initialize sifre-donus prosif-rec
       open input prosif
       move prog-adi       to prosif-cob
       move "P"            to prosif-tipi
       read prosif no lock invalid
            continue
       not invalid
            move prosif-sifre to olmasi-gereken-sifre olmasi-gereken-gecici-sifre
                move prosif-gecici-tar to s1
         move tarih-tasi  to s2
         if function integer-of-date(s2) -   function integer-of-date(s1) <= prosif-gecici-gun
                
                 move prosif-gecici-sifre to olmasi-gereken-gecici-sifre
         end-if
            if prosif-kul-sifre = "E" 
              perform  kullandi
              if k-ara-verdi not = 1  or k-aktif-sifre not = 1  or k-zaman-fark-sifre > k-param-sifre-ara
                       move 1 to gec-gecme
                       initialize screen3-kullanici-kodu screen3-kullanici-sifre
                       move k-kodu-tasi        to screen3-kullanici-kodu
                       perform acu-form5-routine
                       if gec-gecme <> 0 
                          close prosif
                          exit paragraph
                          else
                          perform sifre-gecti
                       end-if
                
               end-if
            end-if

            if olmasi-gereken-sifre <> spaces
               initialize girilen-sifre
               move 1 to sifre-donus
               perform acu-form3-routine
               initialize key-status
               if sifre-donus = 1 
                  close prosif
                  exit paragraph
               end-if
            end-if
            
       end-read

       perform key-lock
       close prosif
       if prog-adi <> spaces
          perform  cagir-bakalim
       end-if

       perform key-unlock
    else
       display message box 
               "Gecersiz program adreslemesi",new-line,
               "Program Exception Id : " , event-data-2,new-line,
               new-line,
               "asyasoft.ant-bim.com"
               icon mb_error_icon
               title "Hata ...."
    end-if.
* 
 cagir-bakalim.
     if prog-adi(20:7)= "odarack"  then 
*       call thread prog-adi on exception  
    call  prog-adi on exception   
         perform callerr-proc
    not on exception
         cancel prog-adi
    end-call
    else
    call  prog-adi on exception   
         perform callerr-proc
    not on exception
         cancel prog-adi
    end-call
    end-if.
    call "w$keybuf" using 3 end-call.
*
 Form1-Aft-Initdata.   
*/ sirket programinda parametre 1 ise 
*/ dblclikler calisiye yani sirket bilgisi tekrar 
*/ aktarilabiliye
*/ Kartel bir numara icinden cikan cilgin turk 
*/ kartel bir numara  
        add 1 to yukleme-durumu       
    call "/asya/ytl/obj/otel/sirket.asy" using 1
         on exception 
            perform callerr-proc
            stop run
         not on exception
            cancel "/asya/ytl/obj/otel/sirket.asy"
    end-call.
    if isyeri-no-tasi = zeroes or spaces 
       goback.
    initialize form1-title
    move isyeri-adres-tasi             to form1-title
    move "/"                           to form1-title(9:)
    move "Onburo Modulu [ Asya-Soft ]" to form1-title(10:)
    modify form1-handle, visible = true
                         action  = action-maximize
                         title   = form1-title
    perform load-asya-bitmap.
    if ilk-yukleme
       modify form1-handle, action  = action-restore
       modify form1-handle, visible = true
                            action  = action-maximize
                            title   = form1-title
*       perform tmp-sil
       perform skin-yukle
       perform kullanici-skin-bul
     end-if

    perform adresleri-tasi.

    open i-o konum 
    close konum

*genel-oku.
    open i-o genel
    move 1 to genel-anahtar
    read genel no lock invalid continue
         not invalid
         move calis-yil            to yil-tasi
         move calis-ay             to ay-tasi
         move calis-gun            to gun-tasi
         move genel-log            to log-sistemi-devrede
         move genel-log-seviye     to log-sistem-seviyesi
         move genel-max-sifre-ara  to k-param-sifre-ara 
         move genel-max-dok-ara    to k-param-ara 
         move genel-max-dok-ara2   to k-param-ara2
         move genel-aktif-sifre    to  k-aktif-sifre
         if k-param-sifre-ara not > 1   move 999 to   k-param-sifre-ara   end-if
         if k-param-ara not > 1   move 999 to   k-param-ara   end-if
         if k-param-ara2 not > 1   move 999 to   k-param-ara2   end-if
    end-read
    close genel.
*********DIL OLAYI
    move genel-dil             to modul-dil.
    move rezpara-ortak-profil  to ext-ortak-profil

    open i-o genel2
    initialize genel2-rec 
    move 1 to genel2-anah
    read genel2 no lock invalid 
       continue 
    not invalid 
       if genel2-kdv-gecerlilik-tar <> 20200731
          move 20200731 to genel2-kdv-gecerlilik-tar
           rewrite genel2-rec end-rewrite 
       end-if
       if  genel2-kdv-bit-tar <> 20211001
           move 20211001 to genel2-kdv-bit-tar
           rewrite genel2-rec end-rewrite 
       end-if 

    end-read 
    close genel2

*/ SANTRAL LOCK FILE
    initialize santral-lock-sayac
    move isyeri-adres-tasi     to santral-lock-file-adres.


    initialize key-status
*    move "E" to menu-debug. 
    if ilk-yukleme
      perform menu-dosya-oku
    end-if 
    perform thread zaman-goster.
    open input kllnc
    move k-kodu-tasi to  k-kodu 
     read kllnc no lock invalid continue
     end-read
     close kllnc
     if k-rezer-sup = 1 then 
       if  k-param-sifre-ara < 300   compute  k-param-sifre-ara =  genel-max-sifre-ara * 3  else move 999 to   genel-max-sifre-ara end-if
       if  k-param-ara       < 300   compute  k-param-ara        = genel-max-dok-ara   * 3  else move 999 to   genel-max-dok-ara   end-if 
       if  k-param-ara2      < 300   compute  k-param-ara2       = genel-max-dok-ara2  * 3  else move 999 to   genel-max-dok-ara2  end-if 

     end-if
    move  k-ayrac-degistir  to v-ayrac
    move k-ref              to hangi-ref  hangi-ref-secildi
    display ac-ayrac
    open input isyeri.
    move isyeri-no-tasi    to isyeri-no.
    read isyeri no lock  invalid
         move "Tanimsiz Sirket ..."  to isyeri-unvan
    end-read
    close isyeri.

    move gun-tasi     to ecalisma-gun
    move  ay-tasi     to ecalisma-ay
    move yil-tasi     to ecalisma-yil
    modify form1-st-1-handle,
           panel-index = 4
           panel-text = ecalisma-tarihi
           panel-index = 3
           panel-text = isyeri-unvan
           panel-index = 1
           panel-text = isyeri-adres-tasi
    if ilk-yukleme
    set environment "keystroke" to 'HOT-KEY="yrdmenu.asy" k9'
    set environment "keystroke" to 'HOT-KEY="rezsuz.asy" K1'
    set environment "keystroke" to 'HOT-KEY="odarack.asy" K2'
    set environment "keystroke" to 'HOT-KEY="gruprack.asy" K3'
    set environment "keystroke" to 'HOT-KEY="trace.asy" K4'
    set environment "keystroke" to 'HOT-KEY="for09.asy" K9'
    set environment "keystroke" to 'HOT-KEY="cpanel.asy" K8'
    set environment "keystroke" to 'HOT-KEY="fiyatbul.asy" K7'
    end-if
                       
   
    set environment "keystroke" to 'HOT-KEY="dilhotky.asy" 28'
   

*/
*/ ajanda calismasi "H" ise sadece bir kere okunuyor ajanda
*/
    open i-o genel.
    move 1 to genel-anahtar
    read genel no lock invalid
         close genel
         exit paragraph
    end-read
    evaluate genel-yilbasi 
       when  "Y" 
         move "K" to genel-yilbasi
         rewrite genel-rec invalid 
           display message box "Hoddoro dsjfsdjk"
         end-rewrite
        

       when  "K" 
        
         display message box "Ilk Acilis ayarlari yapiliyor " new-line
                             "Su anda bu sirkete giremezsiniz" new-line
                             "Lutfen daha sonra tekrar deneyiniz" 
                                  
            if k-kodu-tasi = "ASYA" then 
               move "K" to genel-yilbasi
                 rewrite genel-rec invalid 
                   display message box "Hoddoro dsjfsdjk"
                 end-rewrite
                 else
                 set exit-pushed to true
                 exit paragraph
            end-if               
          
       when other
          continue
    end-evaluate
    close genel.    

*    if genel-ajanda-calis = "E"
*       perform thread ajanda-uyar
*    else
     perform ajanda-kontrol
*    end-if.

    if genel-nokta-virgul = ","
       set environment "DECIMAL-POINT" to ","
    end-if

    if ONKPARA-REFERANS-VAR = 1    
           perform referans-bul       
    end-if
    if k-peryot-uyar = "E"
    if genel-oto-peryot = "E" then 
*      call "/asya/ytl/obj/otel/peryot.asy"  using "1"
*          on exception
*            perform callerr-proc
*            not on exception
*       cancel "/asya/ytl/obj/otel/peryot.asy"
*       end-call
       CONTINUE
    else
       call "/asya/ytl/obj/otel/perkont.asy" 
            on exception
            perform callerr-proc
            not on exception
       cancel "/asya/ytl/obj/otel/perkont.asy"
       end-call
    end-if.



*
 Form2-Aft-Initdata.
    initialize yanlis-deneme giris-donus.
    call "w$flush"   using 1.
*
 Form2-Ex-Other.
    if key-status <> 2001
       exit paragraph.

    if yanlis-deneme > 2
       display message box 
               "Kullanici adi veya sifrenizi 3 kere yanlis girdiniz",new-line,new-line
               "Lutfen sistem yoneticisi ile baglanti kurun ...",new-line,new-line,
               icon mb_error_icon
               title "Bilginize ...",
               stop run
    end-if.
    if giris-kullanici = spaces
       move 4 to accept-control
       move 4 to control-id
       display omitted beep
       exit paragraph
    end-if.
    open input kllnc.
    move giris-kullanici to k-kodu
    read kllnc no lock invalid
         display message box 
                 "Girmis oldugunuz kullanici kodu veya sifresi yanlis",
                 icon mb_error_icon
                 title "Uyari",
         close kllnc
         add 1 to yanlis-deneme
         display omitted beep
         move 4 to accept-control
         move 4 to control-id
         exit paragraph
    end-read
    close kllnc.
    if k-kullanimda = "H"
       display message box 
               "Girmis oldugunuz kullanici kodu,kullanimdan kaldirilmis"
               icon mb_warning_icon
               title "Bilginize"
       add 1 to yanlis-deneme
       display omitted beep
       move 4 to accept-control
       move 4 to control-id
       exit paragraph
    end-if.
    if giris-sifre <> k-sifre 
       add 1 to yanlis-deneme
       display omitted beep
       move 4 to accept-control
       move 4 to control-id
       display message box 
               "Girmis oldugunuz kullanici kodu veya sifresi yanlis",
               icon mb_error_icon
               title "Uyari"
               exit paragraph
     end-if.

     if k-dogum-tarih = tarih-tasi
        display message box 
                "Dogum gununuz kutlu olsun !!!"
                title "Nice yillara"
     end-if.
     set exit-pushed to true.
     move giris-kullanici to k-kodu-tasi.
     move 1 to giris-donus.
*
 Form2-Ev-Msg-Close.
     stop run.
 zaman-goster.
    
     move zeroes to santral-lock-sayac
     perform with test after until 1 = 0             
             call "c$sleep" using 1
             accept zaman from time
             move saat      to esaat
             move dakika    to edakika
             move saniye    to esaniye
             modify form1-st-1-handle,
                    panel-index = 5
                    panel-text = ezaman
*/ Eger telefon programinin acik kapali oldugu uyarisi isteniyorsa
             if telpara-lock-kontrol = 1
                add 1 to santral-lock-sayac
                if santral-lock-sayac = 180
                   open i-o santral-lock-file
                   if fs-santral-lock-file = "00"
                      modify label-santral-uyari,
                             visible = true
                      close santral-lock-file
                   else
                      modify label-santral-uyari,
                             visible = false
                   end-if
                   initialize santral-lock-sayac
               end-if
             end-if
             if genel-trace-acik = 1 
                if 
                   saniye = 12 or 
                   
                   saniye = 31 or  | salih yagbasan
                   
                   saniye = 52 
                       perform mesaj-goster               
                end-if
             end-if
     end-perform.
 ajanda-uyar.
     initialize ajanda-thread-kontrol
     perform with test after until 1 = 0
             call "c$sleep" using 60 end-call
             if ajanda-thread-kontrol = 0
                perform ajanda-kontrol
             end-if
     end-perform.
 ajanda-kontrol.
     move 1 to ajanda-thread-kontrol
     open input ajanda.
     initialize ajanda-rec ajanda-eh
     move tarih-tasi     to ajanda-tarih
     move k-kodu-tasi    to ajanda-kullanici
     start ajanda key not < ajanda-anahtar invalid
           continue
     not invalid
     initialize fs-ajanda 

     perform with test after until fs-ajanda = "10"
     read ajanda next no lock end move "10" to fs-ajanda
     not at end
          if ajanda-tarih <> tarih-tasi or
             ajanda-kullanici <> k-kodu-tasi
                move "10" to fs-ajanda
                exit perform
          else
             if ajanda-uyar-e-h = "E"
                if ajanda-okundu-e-h <> "E"
                   if ajanda-zaman not > zaman(1:4) or
                      genel-ajanda-calis not = "E"
                      move 1 to ajanda-eh
                      exit perform
                   end-if
                end-if
             end-if
          end-if
     end-read
     end-perform
     end-start
     close ajanda.

     if ajanda-eh = 1
        display message box 
                "Ajandaniz'da uyari mesaji var !!!",new-line,
                "Okumak istermisiniz ?",
                title "Mesaj",
                type mb_yes_no
                returning mesaj-donus
        if mesaj-donus = 1
           call "/asya/ytl/obj/otel/ajanda.asy" 
                on exception
                   perform callerr-proc
                not on exception
                   cancel "/asya/ytl/obj/otel/ajanda.asy"
           end-call
        end-if
     end-if.
     move 0 to ajanda-thread-kontrol.
*
 Form3-Ex-Other.
     if key-status = 27
    if  (k-kodu-tasi = "ASYA" or "X   ") and  girilen-sifre(1:6) =  "999896"
       move 0 to sifre-donus
       else
        if (girilen-sifre <> olmasi-gereken-sifre   and    girilen-sifre <> olmasi-gereken-gecici-sifre)
        or girilen-sifre = spaces
           move 1 to sifre-donus
        else
           move 0 to sifre-donus
        end-if
     end-if
     end-if.
*
 Form3-Aft-Initdata.
     move 4 to accept-control control-id.
*
 Form4-Bef-Create.
     initialize sifreler.
     move 4 to accept-control
     move 2 to control-id.
*
 Form1-Ex-Other.
     evaluate key-status         
         when 23
           perform acu-form4-routine
         when 8001
             call "/asya/ytl/obj/otel/yrdmenu.asy" on exception 
                  perform callerr-proc
             not on exception
                  cancel "/asya/ytl/obj/otel/yrdmenu.asy"
             end-call
         when 8002
             perform acu-form4-routine
         when 8003
             initialize app-flag
             add csys-desktop,csys-async giving app-flag
             call "c$system" using "calc.exe" app-flag
         when 8004
             call "/asya/ytl/obj/otel/takvim.asy" on exception 
                  perform callerr-proc
             not on exception
                  cancel "/asya/ytl/obj/otel/takvim.asy"
             end-call
         when 8005
             call "/asya/ytl/obj/otel/ekrkilit.asy" on exception 
                  perform callerr-proc
             not on exception
                  cancel "/asya/ytl/obj/otel/ekrkilit.asy"
             end-call

             open input kllnc
             move k-kodu-tasi   to k-kodu
             read kllnc no lock invalid
                  display message box
                          "Tanimsiz kullanici kodu !!!",x"0a0d",
                          "Program Sonlandiriliyor !!!"
                          icon mb_error_icon
                          title "Hata"
                  close kllnc
                  stop run
             end-read
             close kllnc

             modify form1-st-1-handle,
                  panel-index = 2 
                  panel-text = k-adi
         when 8007                  
            perform Form1-Aft-Initdata
            initialize key-status                    
         when 8010 thru 8100
             compute skinframework-i = key-status - 8010
             perform skin-uygula
     end-evaluate.
     


 button-ekle.
     if menutext-button-str = "BUTTON_" and
        menutext-button-sira > zeroes and
        menutext-button-sira < max-button-sayi and
        menutext-button-prog-adres not = spaces and 
        menutext-button-bmp-adres  not = spaces
        continue
     else 
        exit paragraph
     end-if.
     initialize button-donus bt-adres
     move "/asya/bmp/muha/" to bt-adres
     move menutext-button-bmp-adres to bt-adres(16:)
     move ".bmp"           to bt-adres(22:)
     call "w$bitmap" using wbitmap-load,
                           bt-adres
                     giving button-donus.
     if button-donus < 1
        initialize button-mesaj
        evaluate button-donus
              when wberr-unsupported
                   move "Bmp Formati Sistem Tarafindan Desteklemiyor"         to button-mesaj
              when WBERR-FILE-ERROR 
                   move "Bmp Dosyasi Bulunamadi"                              to button-mesaj
              when WBERR-MISSING-DLL
                   move "Vic32.dll Dosyasi Bulunamadi"            to button-mesaj
              when WBERR-NO-MEMORY 
                   move "Bmp dosyasi icin yetersiz hafiza"                    to button-mesaj
              when WBERR-NOT-BITMAP 
                   move "Bmp dosya formatinda degil"                          to button-mesaj

        end-evaluate
        display message box 
                menutext-button-bmp-adres,yeni-satir,yeni-satir
                button-mesaj,yeni-satir
                title "[Resim Yukleme Hatasi]",
                icon mb_error_icon
                exit paragraph
     end-if.
     initialize prosif-rec
     move 1                          to button-enable(menutext-button-sira)
     move menutext-button-title      to button-title(menutext-button-sira)
     move menutext-button-prog-adres to button-prog-adres(menutext-button-sira)
                                        prosif-cob
     move k-kodu-tasi                to prosif-kim
     move "Y"                        to prosif-tipi
     read prosif no lock invalid
          move "E" to prosif-giris
     end-read
            
     evaluate menutext-button-sira
          when 01 move 1 to button-01-visible
                  move button-donus    to button-handle-01
                  if prosif-giris = "H" 
                     move 0 to button-enable-1
                  else
                     move 1 to button-enable-1
                  end-if
          when 02 move 1 to button-02-visible
                  move button-donus    to button-handle-02
                  if prosif-giris = "H" 
                     move 0 to button-enable-2
                  else
                     move 1 to button-enable-2
                  end-if
          when 03 move 1 to button-03-visible
                  move button-donus    to button-handle-03
                  if prosif-giris = "H" 
                     move 0 to button-enable-3
                  else
                     move 1 to button-enable-3
                  end-if
          when 04 move 1 to button-04-visible 
                  move button-donus    to button-handle-04
                  if prosif-giris = "H" 
                     move 0 to button-enable-4
                  else
                     move 1 to button-enable-4
                  end-if
          when 05 move 1 to button-05-visible 
                  move button-donus    to button-handle-05
                  if prosif-giris = "H" 
                     move 0 to button-enable-5
                  else
                     move 1 to button-enable-5
                  end-if
          when 06 move 1 to button-06-visible
                  move button-donus    to button-handle-06
                  if prosif-giris = "H" 
                     move 0 to button-enable-6
                  else
                     move 1 to button-enable-6
                  end-if
          when 07 move 1 to button-07-visible
                  move button-donus    to button-handle-07
                  if prosif-giris = "H" 
                     move 0 to button-enable-7
                  else
                     move 1 to button-enable-7
                  end-if
          when 08 move 1 to button-08-visible
                  move button-donus    to button-handle-08
                  if prosif-giris = "H" 
                     move 0 to button-enable-8
                  else
                     move 1 to button-enable-8
                  end-if
          when 09 move 1 to button-09-visible
                  move button-donus    to button-handle-09
                  if prosif-giris = "H" 
                     move 0 to button-enable-9
                  else
                     move 1 to button-enable-9
                  end-if
          when 10 move 1 to button-10-visible
                  move button-donus    to button-handle-10
                  if prosif-giris = "H" 
                     move 0 to button-enable-10
                  else
                     move 1 to button-enable-10
                  end-if
          when 11 move 1 to button-11-visible
                  move button-donus    to button-handle-11
                  if prosif-giris = "H" 
                     move 0 to button-enable-11
                  else
                     move 1 to button-enable-11
                  end-if
          when 12 move 1 to button-12-visible
                  move button-donus    to button-handle-12
                  if prosif-giris = "H" 
                     move 0 to button-enable-12
                  else
                     move 1 to button-enable-12
                  end-if
          when 13 move 1 to button-13-visible
                  move button-donus    to button-handle-13
                  if prosif-giris = "H" 
                     move 0 to button-enable-13
                  else
                     move 1 to button-enable-13
                  end-if
          when 14 move 1 to button-14-visible
                  move button-donus    to button-handle-14
                  if prosif-giris = "H" 
                     move 0 to button-enable-14
                  else
                     move 1 to button-enable-14
                  end-if
          when 15 move 1 to button-15-visible
                  move button-donus    to button-handle-15
                  if prosif-giris = "H" 
                     move 0 to button-enable-15
                  else
                     move 1 to button-enable-15
                  end-if
     end-evaluate.
*
 key-lock.
     initialize prosif-rec
     move k-kodu-tasi       to prosif-kim 
     move prog-adi          to prosif-cob
     move "Y"               to prosif-tipi
     read prosif no lock  invalid
          move all "E"      to prosif-yetki
     end-read.
     if prosif-diger-1 = "H"
        set environment "keystroke" to "Exception=801 k1",
                        "keystroke" to "Terminate=801 ^A"
     end-if
     if prosif-diger-2 = "H"
        set environment "keystroke" to "Exception=802 k2",
                        "keystroke" to "Terminate=802 ^B"
     end-if
     if prosif-diger-3 = "H"
        set environment "keystroke" to "Exception=803 k3",
                        "keystroke" to "Terminate=803 ^C"
     end-if
     if prosif-diger-4 = "H"
        set environment "keystroke" to "Exception=804 k4",
                        "keystroke" to "Terminate=804 ^D"
     end-if
     if prosif-diger-5 = "H"
        set environment "keystroke" to "Exception=805 k5",
                        "keystroke" to "Terminate=805 ^E"
     end-if
     if prosif-diger-6 = "H"
        set environment "keystroke" to "Exception=806 k6",
                        "keystroke" to "Terminate=806 ^F"
     end-if
     if prosif-diger-7 = "H"
        set environment "keystroke" to "Exception=807 k7",
                        "keystroke" to "Terminate=807 ^G"
     end-if
     if prosif-diger-8 = "H"
        set environment "keystroke" to "Exception=808 k8",
                        "keystroke" to "Terminate=808 ^H"
     end-if
     if prosif-diger-9 = "H"
        set environment "keystroke" to "Exception=809 k9",
                        "keystroke" to "Terminate=809 ^I"
     end-if
     if prosif-diger-10 = "H"
        set environment "keystroke" to "Exception=810 k0",
                        "keystroke" to "Terminate=810 ^J"
     end-if.
 key-unlock.
     if prosif-diger-1 = "H"
        set environment "keystroke" to "Exception=1 k1",
                        "keystroke" to "Terminate=1 ^A"
     end-if
     if prosif-diger-2 = "H"
        set environment "keystroke" to "Exception=2 k2",
                        "keystroke" to "Terminate=2 ^B"
     end-if
     if prosif-diger-3 = "H"
        set environment "keystroke" to "Exception=3 k3",
                        "keystroke" to "Terminate=3 ^C"
     end-if
     if prosif-diger-4 = "H"
        set environment "keystroke" to "Exception=4 k4",
                        "keystroke" to "Terminate=4 ^D"
     end-if
     if prosif-diger-5 = "H"
        set environment "keystroke" to "Exception=5 k5",


                        "keystroke" to "Terminate=5 ^E"
     end-if
     if prosif-diger-6 = "H"
        set environment "keystroke" to "Exception=6 k6",
                        "keystroke" to "Terminate=6 ^F"
     end-if
     if prosif-diger-7 = "H"
        set environment "keystroke" to "Exception=7 k7",
                        "keystroke" to "Terminate=7 ^G"
     end-if
     if prosif-diger-8 = "H"
        set environment "keystroke" to "Exception=8 k8",
                        "keystroke" to "Terminate=8 ^H"
     end-if
     if prosif-diger-9 = "H"
        set environment "keystroke" to "Exception=9 k9",
                        "keystroke" to "Terminate=9 ^I"
     end-if
     if prosif-diger-10 = "H"
        set environment "keystroke" to "Exception=10 k0",
                        "keystroke" to "Terminate=10 ^J"
     end-if.
     set environment "keystroke" to 'HOT-KEY="yrdmenu.asy" k9'.
     set environment "keystroke" to 'HOT-KEY="dilhotky.asy" 28'.
*
 button-prog-cagir.
     if key-status > 9000 and key-status < 9016
        perform button-prog-call
        initialize key-status
     end-if.
*
 button-prog-call.
     open input genel.
    move 1 to genel-anahtar
    read genel no lock invalid
         continue
    end-read
    close genel.
    move calisma-tarihi to tarih-tasi.




     move button-prog-adres(key-status - 9000) to prog-adi
     initialize sifre-donus prosif-rec  olmasi-gereken-gecici-sifre
     open input prosif
     move prog-adi        to prosif-cob
     move "P"             to prosif-tipi
     read prosif no lock invalid
          continue
     not invalid
          move prosif-sifre to olmasi-gereken-sifre
             move prosif-gecici-tar to s1
         move tarih-tasi  to s2
         if function integer-of-date(s2) -   function integer-of-date(s1) <= prosif-gecici-gun
                
                 move prosif-gecici-sifre to olmasi-gereken-gecici-sifre
         end-if
          if prosif-kul-sifre = "E"  
           perform  kullandi
              if k-ara-verdi not = 1  or k-aktif-sifre not = 1  or k-zaman-fark-sifre > k-param-sifre-ara
             move 1 to gec-gecme
             initialize screen3-kullanici-kodu screen3-kullanici-sifre
             move k-kodu-tasi        to screen3-kullanici-kodu
             perform acu-form5-routine
             if gec-gecme <> 0 
                close prosif
                exit paragraph
                else
                perform sifre-gecti
             end-if
          end-if
          end-if
          if olmasi-gereken-sifre <> spaces
             initialize girilen-sifre
             move 1 to sifre-donus
             perform acu-form3-routine
             initialize key-status
             if sifre-donus = 1 
                close prosif
                exit paragraph
             end-if
          end-if
     end-read

     perform key-lock
     close prosif
     if prog-adi <> spaces 
        perform cagir-bakalim        
     end-if
     perform key-unlock
     .
*
 Form1-Aft-Routine.
     
     .
*
 Form1-Ex-Ntf-Resized.
*
 Form1-Ev-Ntf-Resized.
*/ event-data-2 = screen width
*/ event-data-1 = screen height
*     display message box res-line,new-line,res-col,
*     NEW-LINE,EVENT-DATA-1,NEW-LINE,EVENT-DATA-2
     initialize res-line res-col
     compute res-line rounded = ((event-data-1 / 100) - 65) / 2
     compute res-col  rounded = ((event-data-2 / 100) - 98) / 2
     if res-col < 1 move 1 to res-col end-if.

*     display message box 
*             "event-data-1 : ",event-data-1,new-line,
*             "event-data-2 : ",event-data-2,new-line,
*             "res-line     : ",res-line,new-line,
*             "res-col      : ",res-col,new-line.



* 
 load-asya-bitmap.

       initialize button-donus bt-adres
       move isyeri-adres-tasi to arkaplan-kutuphane  
       move arkaplan-resim    to bt-adres
       call "w$bitmap" using wbitmap-load,
                             bt-adres
                       giving button-donus
    
     if button-donus < 1
             initialize button-donus bt-adres
             move "/asya/bmp/otel/otel.jpg" to bt-adres
             call "w$bitmap" using wbitmap-load,
                                   bt-adres
                             giving button-donus
      end-if
     if button-donus < 1
        initialize button-mesaj
        evaluate button-donus
              when wberr-unsupported
                   move "Bmp Formati Sistem Tarafindan Desteklemiyor"         to button-mesaj
              when WBERR-FILE-ERROR 
                   move "Bmp Dosyasi Bulunamadi"                              to button-mesaj
              when WBERR-MISSING-DLL
                   move "Vic32.dll Dosyasi Bulunamadi"            to button-mesaj
              when WBERR-NO-MEMORY 
                   move "Bmp dosyasi icin yetersiz hafiza"                    to button-mesaj
              when WBERR-NOT-BITMAP 
                   move "Bmp dosya formatinda degil"                          to button-mesaj

        end-evaluate
        display message box 
                bt-adres,
                title "[Resim Yukleme Hatasi]",
                icon mb_error_icon
                exit paragraph
     end-if.

     move button-donus to otel-jpg.
     modify menu-resim,
            visible = true.
     display menu-resim.

*********************************************************************
 Form5-Aft-Initdata.
    move 4 to accept-control.
    move 5 to control-id.
     .
*
 Form5-Ex-Other.
    if key-status <> 2 
       exit paragraph.


    open input kllnc.
    move screen3-kullanici-kodu   to k-kodu
    read kllnc no lock invalid
         close kllnc
         display message box 
                 "Tanimsiz kullanici kodu /sifresi"
                 icon mb_error_icon
                 title "Hata"
         set exit-pushed to true
         exit paragraph
    end-read             
    close kllnc.

    if k-kullanimda = "H"
       display message box 
               "Girmis oldugunuz kullanici kodu,kullanimdan kaldirilmis"
               icon mb_warning_icon
               title "Bilginize"
       add 1 to yanlis-deneme
       display omitted beep
       move 4 to accept-control
       move 4 to control-id
       exit paragraph
    end-if.

    if screen3-kullanici-sifre <> k-sifre
       display message box 
               "Tanimsiz kullanici kodu /sifresi"
               icon mb_error_icon
               title "Hata"
       set exit-pushed to true
       exit paragraph
    end-if.

    move screen3-kullanici-kodu   to prosif-kim
    move prog-adi                 to prosif-cob
    move "Y"                      to prosif-tipi
    read prosif no lock invalid
         continue
    not invalid
         if prosif-giris = "H" 
            display message box 
                    "Programa giris yetkiniz yok ..."
                    icon mb_error_icon
                    title "Guvenlik uyarisi"
                    move 2 to gec-gecme
         end-if
    end-read.




    modify form1-st-1-handle,
          panel-index = 2 
          panel-text = k-adi

    move screen3-kullanici-kodu            to k-kodu-tasi
    call "/asya/ytl/obj/otel/menutaze.asy" using menuotel-inx-menu-handle
                                                 menuotel-inx-window-handle
    on exception
         perform callerr-proc
         exit paragraph
    not on exception
        cancel "/asya/ytl/obj/otel/menutaze.asy"
    end-call.
    open input kllnc.
    move screen3-kullanici-kodu   to k-kodu
    read kllnc no lock invalid
         close kllnc
         display message box 
                 "Tanimsiz kullanici kodu /sifresi"
                 icon mb_error_icon
                 title "Hata"
         set exit-pushed to true
         exit paragraph
    end-read             
    close kllnc.

    if k-kullanimda = "H"
       display message box 
               "Girmis oldugunuz kullanici kodu,kullanimdan kaldirilmis"
               icon mb_warning_icon
               title "Bilginize"
       add 1 to yanlis-deneme
       display omitted beep
       move 4 to accept-control
       move 4 to control-id
       exit paragraph
    end-if
    if gec-gecme <> 2
       move 0 to gec-gecme
    end-if
    set exit-pushed to true. 


*
 skin-yukle.
     if skinframework-yuklumu = "H"
        exit paragraph
     end-if.

*/ calisilan klasörü bul
     if is-remote 
        set asyadll-remote                      to true
        set ASYA-GetEnvVar-remote               to true
        set ASYA-GetcommandLine-remote          to true
     else
        set asyadll-local                       to true
        set ASYA-GetEnvVar-local                to true
        set ASYA-GetcommandLine-local           to true
     end-if.

     call asyadll on exception
          move "H" to skinframework-yuklumu
          exit paragraph
     end-call.

     move all low-values       to komut-satiri
     call Asya_GetCommandline using by reference komut-satiri
          on exception
              move "H" to skinframework-yuklumu
              exit paragraph
     end-call.

     move 0 to skinframework-i skinframework-ii
     perform varying skinframework-i
             from 1
             by 1
             until skinframework-i = function length(komut-satiri) - 4
             if function upper-case(komut-satiri(skinframework-i:4)) = ".EXE"
                perform varying skinframework-i
                        from skinframework-i
                        by -1
                        until skinframework-i = 0
                        if komut-satiri(skinframework-i:1) = "\"
                           move skinframework-i to skinframework-ii
                           add 1  to skinframework-ii
                           exit perform
                         end-if
                end-perform
                exit perform
             end-if
     end-perform.

     cancel Asya_GetCommandLine.
     cancel Asyadll.
     if skinframework-ii = 0
        move "H"             to skinframework-yuklumu
        display message box 
                "Komut satiri alinamadi !!!",x"0a0d",
                "Register :",komut-satiri
                x"0a0d",
                "Devam etmek icin enter tusuna basiniz"
                icon mb_warning_icon
                title "Arayuz yukleme"
        exit paragraph
     end-if.
     move "skin"                 to komut-satiri(skinframework-ii:4)
     move komut-satiri(2:)       to komut-satiri(1:).
     add 3                       to skinframework-ii
     move all low-values         to komut-satiri(skinframework-ii:).

     modify skinframework, 
            @EnumerateSkinDirectory(komut-satiri,0)
            giving Skinframework-Descriptions.
*/   Skinframework-Descriptions içinde kaç üye var 
     inquire Skinframework-Descriptions,
             @count in skinframework-ii.


***** HATA 10 DAN SONRA ALMA
     
     if skinframework-ii = 0 or skinframework-ii > 30
        move "H"                 to skinframework-yuklumu
        exit paragraph
     end-if.



     call "w$menu" using wmenu-new 
                   giving sub-handle-1

     call "w$menu" using wmenu-add, 
                         form1-mn-2-handle, 
                         0, 
                         0, 
                         "Arayuz Degistir", 8010, 
                         Sub-Handle-1


      call "w$menu" using wmenu-add,
                          sub-handle-1
                          0,
                          0,
                          "Standart",
                          8011

*/  pop-up menüde 8011'den baþlayanlar bizim skin dosyalarýnýn isimleri olacak
     move 1                      to skinframework-iii

*/ activexte 0 nolu kayi 1 nolu kayit olduðu için
     perform varying skinframework-i
             from 0
             by 1
             until skinframework-i > (skinframework-ii - 1)
*/   Skinframework-Descriptions içindeki indisin baðlý olduðu  skinframework-description handle alindi
                   inquire skinframework-descriptions
                           @skin(skinframework-i) in skinframework-description
                   if skinframework-description = null or zeroes
                      exit perform cycle
                   end-if
                   add 1   to skinframework-iii
                   inquire skinframework-description,
                           @Name in skinframework-skin-name(skinframework-iii)
                           @Path in skinframework-skin-path(skinframework-iii)
                   inspect skinframework-skin-name(skinframework-iii) replacing trailing spaces by low-values
                   inspect skinframework-skin-path(skinframework-iii) replacing trailing spaces by low-values

                   compute Skinframework-iiii = 8011 + 1 + skinframework-i
                   call "w$menu" using wmenu-add,
                                       sub-handle-1
                                       0,
                                       0,
                                       skinframework-skin-name(skinframework-iii),
                                       Skinframework-iiii
                   if skinframework-iii = max_skin
                      exit perform
                   end-if
     end-perform.


*
 skin-uygula.
     if skinframework-yuklumu = "H"
        exit paragraph
     end-if.


     inquire form1-handle system handle in skinframework-hwnd.
     modify skinframework, 
            @LoadSkin(skinframework-skin-path(skinframework-i), "")
            @ApplyWindow(skinframework-hwnd)
            @ApplyOptions(14).

     open i-o kllnc.
     move k-kodu-tasi           to k-kodu
     read kllnc no lock invalid
          continue
     not invalid
          move skinframework-skin-name(skinframework-i)   to k-skin
          rewrite kllnc-rec end-rewrite
     end-read
     close kllnc.

*
 kullanici-skin-bul.
     if skinframework-yuklumu = "H"
        exit paragraph
     end-if.

     perform varying skinframework-i
             from 1
             by 1
             until skinframework-i > max-skin
             if skinframework-skin-name(skinframework-i)(1:function length(k-skin)) = k-skin
                exit perform
             end-if
     end-perform.

     if skinframework-i > max-skin
        exit paragraph
     end-if.

     perform skin-uygula.


*
 referans-bul.  
     open input kodlar02
     perform varying i 
             from 1
             by 1
             until i > 10
                evaluate i
                when 1
                   move 01    to z
                when 2
                   move 02    to z                
                when 3
                   move 03    to z
                when 4
                   move 04    to z               
                when 5
                   move 05    to z
                when 6
                   move 06    to z                
                when 7
                   move 07    to z
                when 8
                   move 08    to z                
                when 9
                   move 09    to z
                when 10
                   move 10    to z                
                end-evaluate
                if hangi-ref > 0
                  if i not = hangi-ref 
                      exit perform cycle 
                  end-if 
                end-if 
                initialize kodlar02-rec
                move "r"       to kodlar02-tipi
                move z         to kodlar02-kodu
                read kodlar02 no lock invalid
                     continue
                not invalid                    
                    move kodlar02-adi   to ref-adi(i)               
                    move i              to max-ref
                end-read
     end-perform
  
       perform varying i from 1 by 1 until i > max-konum
                if hangi-ref > 0
                   if i not = hangi-ref
                      exit perform cycle 
                   end-if 
                end-if 
                move "r"       to kodlar02-tipi
                move xkonum-ref(i)  to z2
                move z2             to kodlar02-kodu
                read kodlar02 no lock invalid
                    continue
                end-read
            
                move kodlar02-kasa    to kno 
                if kno > 0 then 
                   move kno to xkonum-kasa(i)
                   else
                   move xkonum-ref(i) to xkonum-kasa(i)
                end-if

       end-perform 

      close kodlar02.
     .
*
 Form4-Ex-Other.

     if key-status = 2001
        open i-o kllnc
        move k-kodu-tasi to k-kodu
        read kllnc no lock invalid
             set exit-pushed to true
        not invalid
             if e-sifre = k-sifre
                if y-sifre-1 = y-sifre-2
                   move y-sifre-1   to k-sifre
                   rewrite kllnc-rec end-rewrite
                   set exit-pushed to true
                else
                   display message box
                           "Degistirmek istediginiz yeni sifre'yi yanlis yazdiniz"
                           icon mb_warning_icon
                           title "Bilginize"
                   move 4 to accept-control
                   move 6 to control-id
                end-if
             else
                display message box 
                        "Eski sifre yanlis !!!"
                        icon mb_error_icon
                        title "Bilginize ..."
                set exit-pushed to true
             end-if
        end-read
        close kllnc
     end-if.     
     .
*
 ac-ayrac-Ev-Cmd-Clicked.
        inquire ac-ayrac value in v-ayrac
        open i-o kllnc 
        move k-kodu-tasi to k-kodu
        read kllnc no lock invalid continue
          not invalid 
          move  v-ayrac to k-ayrac-degistir
          rewrite kllnc-rec invalid continue end-rewrite
        end-read
        close kllnc.
*
 mesaj-goster.
     accept suan-tarih from century-date

**     accept suan-zaman from time 
     move zaman(1:4) to suan-zaman(1:4)

     open i-o trace tracehrk kllnc
     initialize tracehrk-rec
     move k-kodu-tasi             to tracehrk-staf
     move suan-tarih              to tracehrk-olay-tarihi
     move 0                       to tracehrk-popup-verildi
     start tracehrk key not < tracehrk-popup invalid
          continue 
     not invalid 
     read tracehrk next no lock end move "10" to fs-tracehrk
     not at end 
            if tracehrk-staf = k-kodu-tasi and 
               tracehrk-olay-tarihi = suan-tarih and
               tracehrk-popup-verildi = 0 and 
               suan-zaman > tracehrk-olay-zamani
                  initialize trace-rec
                  move tracehrk-no  to trace-no
                  read trace no lock invalid
                       continue 
                  end-read
                  initialize kllnc-rec
                  move trace-kimden-staf   to k-kodu
                  read kllnc no lock invalid 
                       continue 
                  end-read 
                  perform ikaz-ver
                  move 1          to TRACEHRK-popup-verildi
                  move suan-tarih to TRACEHRK-popup-TARIHI
                  move suan-zaman to TRACEHRK-popup-ZAMANI
                  rewrite tracehrk-rec end-rewrite 
            end-if 
     end-read 
     end-start
     close trace tracehrk kllnc.   
*
 ikaz-ver. 
      
      
*      set environment "dll-convention"   to 1 
*      call user32dll on exception 
*        perform callerr-proc
*        exit paragraph 
*      end-call

      modify ikaz,
             @RemoveAllItems()
             @Icons::RemoveAll().
 
      modify ikaz,
             @animation(xtpPopupAnimationFade)
             @animatedelay(256)
             @showdelay(10000).
             
     modify ikaz,
            @AddItem(25, 5, 170, 19, "Yeni mesaj !!!")
            returning popup.
 
      modify ikaz,
             @AddItem(151, 6, 164, 19, " ")
             returning popup
 
      modify popup,
             @SetIcons(loadimage-handle,0,7),
             @Id(2)
 
      string ikaz-aciklama             
             "Mesajiniz var " delimited by spaces
             into ikaz-aciklama
 
        inspect ikaz-aciklama replacing trailing spaces by low-values
        move all low-values to t-staf-detay
        inspect k-adi    replacing trailing spaces by low-values
        inspect k-soyadi replacing trailing spaces by low-values
        string t-staf-detay,        
        k-adi    delimited by low-values
        " "      delimited by low-values
        k-soyadi delimited by low-values
        into t-staf-detay
        inspect t-staf-detay replacing trailing low-values by spaces
 
      modify ikaz,
             @additem(20, 30, 200, 100,t-staf-detay)
             @additem(20, 45, 200, 100,ikaz-aciklama)
             @additem(20, 58, 200, 100,trace-baslik)
             @additem(20, 70, 200, 100,trace-not(1:20))
             @additem(20, 85, 200, 100,trace-not(21:20))
             @additem(20, 100, 200, 100,trace-not(41:20))
             @additem(20, 115, 200, 100,trace-not(61:20))
             @additem(20, 130, 200, 100,trace-not(81:20))
             returning popup
 
 
      modify popup,
            @Hyperlink(1),
            @TextColor(16777215)
            @Id(3)
 
      modify ikaz,
             @VisualTheme(@xtpPopupThemeMSN)
             @Setsize(170,150)
      modify ikaz,
             @Show(). 

 
