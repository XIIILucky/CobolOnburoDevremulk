* acenper.evt
* acenper.evt is generated from D:\asya\acugt.ytl\otel\acenper.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .
***   start event editor code   ***
*
 Form1-Bef-Create.
    perform adresleri-tasi.
    open input genel
    initialize genel-rec
    move 1   to genel-anahtar
    read genel no lock invalid
         continue
    end-read
    close genel
     .
*
 Form1-Aft-Initdata.
    move gun-tasi to ilk-gun son-gun.
    move ay-tasi  to ilk-ay  son-ay fore-ay.
    move yil-tasi to ilk-yil son-yil fore-yil.
    move "I" to rez-dur(1:1).
    move "B" to rap-det.
    move "05" to det-tip-value det-tip.

    display  com-03.

    perform ekran-goster.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 ekran-goster.
    display acc-01 acc-02 acc-03 acc-04 acc-05 acc-06
            com-01 com-02 acc-06a acc-06aa.

 takas-dosya-ac.
    open i-o genelfis.
    move 1 to genelfis-anahtar.
    read genelfis no lock invalid 
    move 1 to ekran-fis-1.
  
    add 1 to ekran-fis-1.

    move ekran-fis-1(2:) to takas-no takasi-no takasay-no takas8-no takasfiyat-no.
    rewrite genelfis-rec invalid write genelfis-rec.
    close genelfis.
    open output takas takasi takasay takasfiyat takas8 close takasfiyat takas takas8 takasi takasay open i-o takasfiyat takas takasi takas8 takasay with mass-update.
*
 takasi-olustur.     
      move fore-tarih to takasay-anah
      move 1 to takasay-sira
      
      perform varying i from 1 by 1 until i > 13
          write takasay-rec invalid stop " " end-write
          add 1 to takasay-ay
          add 1 to takasay-sira
            if takasay-ay = 13 then 
              move 1 to takasay-ay
              add 1 to takasay-yil
            end-if
       end-perform 
       perform with test after until fs-rez = "10"
                    read rez next no lock end move "10" to fs-rez
                    not at end
*                        
                         if rez-durumu not =  rez-dur(1:1)
                           exit perform
                         end-if
                           if tum-rez not = 1 then 
                             if rez-isl-tar > son-tarih
                               exit perform
                             end-if
                           end-if
*                         if rez-isl-tar > rez-gir-tar
*                            exit perform cycle 
*                         end-if
                           if  rez-k-g-b not = rap-tip(1:1) then
                               exit perform cycle
                           end-if
                           if  rez-dur(1:1) not = rez-durumu then 
                               exit perform cycle 
                           end-if                          

                         if rez-acenta = rapor-acenta or 
                            rapor-acenta  = spaces

                            if onkpara-referans-var = 1 then
                               perform ref-filtre
                               if  not ref-gecti then 
                                   exit perform cycle
                               end-if
                            end-if

                             if filtre-var = 1 then
                                 perform filtre
                                 if filtre-gecti  = 1 then 
                                    perform tek-takas-yaz
                                 end-if
                             else
                                 perform tek-takas-yaz
                             end-if                              
                         end-if                        
                    end-read
              end-perform
           initialize takas-rec 
           start takas key > takas-anahtar 
              invalid  continue
              not invalid
              perform until fs-takas = "10"
              read takas next no lock end move "10" to fs-takas
                   not end

                      initialize takasay-rec
                      move takas-ay to takasay-anah
                      read takasay no lock invalid
                        move 13 to takasay-sira
                      end-read

                      initialize takasi-rec
                      move high-values  to takasi-anah
                      move high-values  to takasi-ara-detay
                      if dovizsiz not = 1 
                           move takas-doviz  to takasi-doviz 
                      end-if
                      read takasi no lock invalid 
                           continue
                      end-read
                              add takas-veri to takasi-data(takasay-sira)
                              add takas-buyuk to takasi-buyuk(takasay-sira)
                              add takas-veri to takasi-toplam
                              add takas-fiyati to takasi-gelir(takasay-sira)
                      write takasi-rec  invalid rewrite takasi-rec end-write

                      initialize takasi-rec
                      move takas-detay  to takasi-anah
                      move high-values  to takasi-ara-detay
                     if dovizsiz not = 1 
                          move takas-doviz  to takasi-doviz
                     end-if
                      read takasi no lock invalid 
                           continue
                      end-read
                              add takas-veri to takasi-data(takasay-sira)
                              add takas-buyuk to takasi-buyuk(takasay-sira)
                              add takas-veri to takasi-toplam
                              add takas-fiyati to takasi-gelir(takasay-sira)
                      write takasi-rec  invalid rewrite takasi-rec end-write

                      initialize takasi-rec
                      move takas-detay     to takasi-anah
                       if dovizsiz not = 1 
                              move takas-doviz     to takasi-doviz
                       end-if
                      move takas-ara-detay to takasi-ara-detay
                      read takasi no lock invalid 
                           continue
                      end-read
                              add takas-veri   to takasi-data(takasay-sira)
                              add takas-buyuk  to takasi-buyuk(takasay-sira)
                              add takas-veri   to takasi-toplam
                              add takas-fiyati to takasi-gelir(takasay-sira)
                      write takasi-rec  invalid rewrite takasi-rec end-write
                       
              end-read
              end-perform
           end-start


            .
*
 tek-takas-yaz.
               initialize secilen-ara-detay 
               move high-values to kiyas-detay
               evaluate det-tip
                    when 11 move rez-operator      to secilen-ara-detay
                    when 12 move rez-firma         to secilen-ara-detay
                    when 02 move rez-pazar         to secilen-ara-detay
                    when 03 move rez-pan-tipi      to secilen-ara-detay
                    when 04 move rez-ulke          to secilen-ara-detay
                    when 05 move rez-anlasma       to secilen-ara-detay
                    when 06 move rez-s-d-t-g       to secilen-ara-detay
                    when 07 move rez-oda-konumu    to secilen-ara-detay
                    when 08 move rez-odeme-tipi    to secilen-ara-detay
                    when 09 move rez-doviz         to secilen-ara-detay
                    when 10 move rez-acenta        to secilen-ara-detay
               end-evaluate           
 
       evaluate rap-det(1:1)
            when "A"
               move rez-oda-konumu to kiyas-detay
            when "B"
               move rez-acenta to kiyas-detay

            when "C"  
               move rez-ulke to kiyas-detay
            when "D" 
               move REZ-PAN-TIPI  to kiyas-detay
            when "E" 
               move rez-anlasma to kiyas-detay
            when "F" 
               move REZ-ODEME-TIPI to kiyas-detay
            when "G"  
               move rez-fiyat-konumu to kiyas-detay
            when "H"
              if rez-firma > spaces then 
                  move rez-firma    to kiyas-detay
                  else
                  move rez-acenta to  kiyas-detay(2:4)
              end-if
       end-evaluate 

       evaluate rap-det2(1:1)
            when "A"  
              initialize cast-rec 
              move rez-no to cast-rez-no 
              start cast key >= cast-anah1
                 invalid continue
                 not invalid
                 perform until fs-cast = "10"
                    read cast next no lock 
                      end move "10" to fs-cast
                      not end 
                        if cast-tarih <= rez-cik-tar and 
                           cast-rez-no = rez-no
                           if rezpara-trace = 1
                              if rez-kisi not = cast-kisi
                                move cast-kisi to rez-kisi
                           end-if
                            move cast-oda-no to rez-odano
                              move cast-fiyat-konumu to rez-fiyat-konumu
                              move cast-oda-konumu to rez-oda-konumu
                           move cast-share to rez-share
                           if rez-share = 1 then 
                              move 0 to eklenecek-oda 
                               else
                               move 1 to eklenecek-oda
                            end-if
                           else 
                             move 1 to eklenecek-oda
                          end-if
                          initialize takas-rec
                          move cast-tarih(1:6)   to takas-ay 
                          move kiyas-detay       to takas-detay
                          if dovizsiz not = 1 
                          move rez-doviz         to takas-doviz
                          end-if
                          move secilen-ara-detay to takas-ara-detay
                          read takas no lock invalid
                                continue
                          end-read
                               evaluate rap-det2(1:1)
                                    when "A" 
                                      if rez-cik-tar > cast-tarih
                                               add eklenecek-oda to takas-veri                                     
                                               
        
                                               evaluate ychild(1:1)
                                               when 1 
                                                   compute pax-sayisi = rez-buyuk + ( rez-kucuk / 2 )
                                               when 0
                                                   compute pax-sayisi = rez-buyuk
                                               when 2 
                                                   compute pax-sayisi = rez-buyuk +  rez-kucuk  + rez-free
                                               when 3
                                                   compute pax-sayisi = rez-buyuk +  rez-kucuk  + rez-free + rez-bebek
                                               when 4
                                                   compute pax-sayisi = rez-buyuk +  rez-kucuk 
                                               when other
                                                    compute pax-sayisi = rez-buyuk + ( rez-kucuk / 2 )   
                                              end-evaluate
                                             add pax-sayisi     to takas-buyuk
                                      end-if
                                          
                                       move cast-anah to yedek-cast-anah
                                      initialize gunluk-fiyat
                                      move cast-tarih to takvim-anah
                                       if dovizsiz not = 1 
                                      perform rez-fiyat-kaydet
                                         add gunluk-fiyat  to takas-fiyati
                                         initialize cast-rec
                                      move yedek-cast-anah to cast-anah
                                      initialize fs-cast
                                      
                                      start cast key > cast-anah1
                                         invalid move "10" to fs-cast
                                      end-start
                                      end-if
                               end-evaluate

                             write takas-rec invalid rewrite takas-rec end-write
                        else 
                             move "10" to fs-cast
                        end-if
                     end-read
                 end-perform
             end-start
             when "B"
               move cast-share to rez-share
                if rez-share = 1 then 
                    move 0 to eklenecek-oda 
                     else
                     move 1 to eklenecek-oda
                  end-if
                
                initialize takas-rec
                move rez-gir-tar(1:6)    to takas-ay
                move kiyas-detay         to takas-detay
                 if dovizsiz not = 1 
                move rez-doviz           to takas-doviz
                end-if
                move secilen-ara-detay   to takas-ara-detay
                read takas no lock invalid
                      continue
                end-read
                     evaluate rap-det2(1:1)
                          when "B" 
                             add eklenecek-oda to takas-veri
                                       evaluate ychild(1:1)
                                       when 1 
                                           compute pax-sayisi = rez-buyuk + ( rez-kucuk / 2 )
                                       when 0
                                           compute pax-sayisi = rez-buyuk
                                       when 2 
                                           compute pax-sayisi = rez-buyuk +  rez-kucuk  + rez-free
                                       when 3
                                           compute pax-sayisi = rez-buyuk +  rez-kucuk  + rez-free + rez-bebek
                                       when 4
                                           compute pax-sayisi = rez-buyuk +  rez-kucuk 
                                       when other
                                            compute pax-sayisi = rez-buyuk + ( rez-kucuk / 2 )   
                                      end-evaluate

                                     
                                          add pax-sayisi     to takas-buyuk
                             initialize takvim-rec
                             move rez-gir-tar  to takvim-anah
                             start takvim key >= takvim-anah invalid
                                 continue
                             not invalid
                             perform with test after until fs-takvim = "10"
                             read takvim next no lock end move "10" to fs-takvim
                             not at end 
                                   if takvim-anah > rez-cik-tar
                                       move "10" to fs-takvim
                                   else
                                        if dovizsiz not = 1 
                                              initialize gunluk-fiyat
                                              perform rez-fiyat-kaydet
                                               add gunluk-fiyat  to takas-fiyati
                                       end-if
                                   end-if
                             end-read
                             end-perform
                             end-start

                     end-evaluate 
                write takas-rec invalid rewrite takas-rec end-write
       end-evaluate.
*
 Form1-Ex-Other.
      evaluate key-status
        when 1 
           if control-id= 15 then 
              initialize acenta-cagir
              call "/asya/ytl/obj/otel/acenara.asy" 
                  using acenta-cagir  
                  on exception 
                     perform callerr-proc
                  not on exception
                     if acenta-cagir <> spaces
                        move acenta-cagir to rapor-acenta
                        display acc-07a
                     end-if
             end-call
             move 4  to accept-control
             move 15 to control-id

           end-if
           exit paragraph
    
       when 33 
            call "/asya/ytl/obj/otel/rezfilt.asy" 
                  using filtre-tasi  
                  on exception 
                     perform callerr-proc
                  not on exception
                     continue
             end-call
             display l-filtre
              
        when 2
              move det-tip-value(1:2) to det-tip
              perform takas-dosya-ac
              open input rez  acenta takvim kur romhrk konuk takvim2 fiyat 
                       fiyatana aksiyhrk konum kodlar02 ulke cast firma cast3 odalar
                      initialize rez-rec
                      move rez-dur(1:1)   to rez-durumu
                  if tum-rez not = 1 then 
                      move ilk-tarih      to rez-isl-tar
                  end-if
                      start rez key not < rez-isl invalid
                            initialize mesaj-link
                            move 04 to mesaj-no
                            perform mesaj-ver
                            close rez  takvim acenta konum kur konuk romhrk fiyat 
                            takvim2 fiyatana aksiyhrk kodlar02 ulke takas takasi  
                            takasfiyat cast takas8 takasay   firma cast3 odalar

                            delete file takas takasi takasay takas8 takasfiyat
                            exit paragraph
                      not invalid
                            perform takasi-olustur
                      end-start
              open i-o genelfis
              move 1 to genelfis-anahtar
              read genelfis no lock invalid
                   accept print-no from time
              not invalid
                   add 1 to print-no
                   rewrite genelfis-rec end-rewrite
              end-read
              close genelfis
**************************
     initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya

     set  dokumer-asya-set to true
     move print-no         to dokumer-dosya-adi
     open output dokumer
*/WINDOW TITLE
     initialize dokumer-rec detay
     move "W"                  to det-dokumer-20(1:)
     if rez-dur(1:1) = "I" 
        move "Ayrintili Yillik Analiz Raporu.."      to det-filler
     else
        move "Ayrintili Yillik Analiz Raporu.."      to det-filler
     end-if 
     write dokumer-rec from detay
*/ BASLIKLAR
     initialize dokumer-rec detay
     move "1"          to det-dokumer-20(10:1)
     move "B"                  to det-dokumer-20(1:1)
     if rez-dur(1:1) = "I" 
        move "Ayrintili Yillik Analiz Raporu.."      to det-filler
     else
        move "Ayrintili Yillik Analiz Raporu.."      to det-filler
     end-if 
     move "Tarih..:"     to det-filler(41:10)
     move ilk-gun        to det-filler(51:02)
     move "/"            to det-filler(53:01)
     move ilk-ay         to det-filler(54:02)
     move "/"            to det-filler(56:01)
     move ilk-yil        to det-filler(57:04)
     move "-"            to det-filler(61:01)
     move son-gun        to det-filler(62:02)
     move "/"            to det-filler(64:01)
     move son-ay         to det-filler(65:02)
     move "/"            to det-filler(67:01)
     move son-yil        to det-filler(68:04)
     write dokumer-rec from detay
     move "2"          to det-dokumer-20(10:1)
     move "B"                  to det-dokumer-20(1:1)
     initialize det-filler
     move "Forecast tipi:"     to det-filler(15:)
     move rez-dur(3:)         to det-filler(30:)
     move rap-tip(3:)          to det-filler(55:)
     move rap-det2(3:)        to det-filler(70:)
     
     write dokumer-rec from detay

     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:1)
     write dokumer-rec from detay

*/ DOKUMER OZELLIKLER-REC
     initialize dokumer-rec detay
     move "O" to det-dokumer-20(1:)
     move "E" to dokumer-oto-sayfa-basi
     move 56  to dokumer-oto-sayfa-satir
     move "|" to dokumer-detay-kolon-ayirici
     move "LRRRRRRRRRRRRRRRRRRRRRRRRR"  to dokumer-align-occ
     move dokumer-ozellikler-rec     to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR  

     initialize dokumer-rec    detay 
     move "1"          to det-dokumer-20(10:1)
     move "D1"                          to det-dokumer-20(1:2)     
     move rap-det(4:)                   to det-det
     initialize takasay-rec 
     start takasay key >= takasay-sira invalid continue
       not invalid
       
       perform until fs-takasay = "10"
       read takasay next no lock 
         end move "10" to fs-takasay
         not end 
           evaluate takasay-sira
             when 1
                  move "--->" to det-1
                  move ay-adi(takasay-ay) to det-1-1
                  move "<---" to det-1-2
             when 2
                  move "--->" to det-2
                  move ay-adi(takasay-ay) to det-2-1
                  move "<---" to det-2-2
             when 3
                  move "--->" to det-3
                  move ay-adi(takasay-ay) to det-3-1
                  move "<---" to det-3-2
             when 4
                  move "--->" to det-4
                  move ay-adi(takasay-ay) to det-4-1
                  move "<---" to det-4-2
             when 5
                  move "--->" to det-5
                  move ay-adi(takasay-ay) to det-5-1
                  move "<---" to det-5-2
             when 6
                  move "--->" to det-6
                  move ay-adi(takasay-ay) to det-6-1
                  move "<---" to det-6-2
             when 7
                  move "--->" to det-7
                  move ay-adi(takasay-ay) to det-7-1
                  move "<---" to det-7-2
             when 8
                  move "--->" to det-8
                  move ay-adi(takasay-ay) to det-8-1
                  move "<---" to det-8-2
             when 9
                  move "--->" to det-9
                  move ay-adi(takasay-ay) to det-9-1
                  move "<---" to det-9-2
             when 10
                  move "--->" to det-10
                  move ay-adi(takasay-ay) to det-10-1
                  move "<---" to det-10-2
             when 11
                  move "--->" to det-11
                  move ay-adi(takasay-ay) to det-11-1
                  move "<---" to det-11-2
             when 12
                  move "--->" to det-12
                  move ay-adi(takasay-ay) to det-12-1
                  move "<---" to det-12-2
         end-evaluate
       end-read
       end-perform
       end-start


     MOVE "Diger"                    to det-13 
     MOVE "Toplam"                      to det-top 
     
     move "|" to fil-det fil-1 fil-1-1 fil-1-2 fil-2 fil-2-1 fil-2-2 
                 fil-3 fil-3-1 fil-3-2 fil-4 fil-4-1 fil-4-2 fil-5 fil-5-1 fil-5-2
                 fil-6 fil-6-1 fil-6-2 fil-7 fil-7-1 fil-7-2 fil-8 fil-8-1 fil-8-2 
                 fil-9 fil-9-1 fil-9-2 fil-10 fil-10-1 fil-10-2 fil-11 fil-11-1 fil-11-2
                 fil-12 fil-12-1 fil-12-2 fil-13 fil-top
     write dokumer-rec from detay

     initialize dokumer-rec detay
     move "D2"           to det-dokumer-20(1:2)
      move all "-" to det-det det-1 det-1-1 det-1-2 
                     det-2 det-2-1 det-2-2 det-3 det-3-1 det-3-2 
                     det-4 det-4-1 det-4-2 det-5 det-5-1 det-5-2 
                     det-6 det-6-1 det-6-2 det-7 det-7-1 det-7-2
                     det-8 det-8-1 det-8-2 det-9 det-9-1 det-9-2
                     det-10 det-10-1 det-10-2 det-11 det-11-1 det-11-2
                     det-12 det-12-1 det-12-2 det-13 det-top
     move "Detay"        to det-det
     move "Oda"          to det-1
     move "Pax"          to det-1-1
     move "Gelir"        to det-1-2
     move "Oda"          to det-2
     move "Pax"          to det-2-1
     move "Gelir"        to det-2-2
     move "Oda"          to det-3
     move "Pax"          to det-3-1
     move "Gelir"        to det-3-2
     move "Oda"          to det-4
     move "Pax"          to det-4-1
     move "Gelir"        to det-4-2
     move "Oda"          to det-5
     move "Pax"          to det-5-1
     move "Gelir"        to det-5-2
     move "Oda"          to det-6
     move "Pax"          to det-6-1
     move "Gelir"        to det-6-2
     move "Oda"          to det-7
     move "Pax"          to det-7-1
     move "Gelir"        to det-7-2
     move "Oda"          to det-8
     move "Pax"          to det-8-1
     move "Gelir"        to det-8-2
     move "Oda"          to det-9
     move "Pax"          to det-9-1
     move "Gelir"        to det-9-2
     move "Oda"          to det-10
     move "Pax"          to det-10-1
     move "Gelir"        to det-10-2
     move "Oda"          to det-11
     move "Pax"          to det-11-1
     move "Gelir"        to det-11-2
     move "Oda"          to det-12
     move "Pax"          to det-12-1
     move "Gelir"        to det-12-2
     move " "            to det-13
     move " "            to det-top
     move "|" to fil-det fil-1 fil-1-1 fil-1-2 fil-2 fil-2-1 fil-2-2 
                 fil-3 fil-3-1 fil-3-2 fil-4 fil-4-1 fil-4-2 fil-5 fil-5-1 fil-5-2
                 fil-6 fil-6-1 fil-6-2 fil-7 fil-7-1 fil-7-2 fil-8 fil-8-1 fil-8-2 
                 fil-9 fil-9-1 fil-9-2 fil-10 fil-10-1 fil-10-2 fil-11 fil-11-1 fil-11-2
                 fil-12 fil-12-1 fil-12-2 fil-13 fil-top
     write dokumer-rec from detay
**************************
                initialize takasi-rec yedek-takasi-anah
                 start takasi key >= takasi-alt-anah
                   invalid
                    continue
                   not invalid
                    perform until fs-takasi="10"
                      read takasi next no lock 
                        end move "10" to fs-takasi
                        not end 
                           evaluate true
                           when takasi-anah = high-values and takasi-ara-detay = high-values
                                perform liste-doviz-toplam                             
                           when takasi-anah not = high-values and takasi-ara-detay = high-values
                             if det-tip = 1 then 
                                 continue
                                 else
                                perform liste-acenta-toplam
                             end-if
                           when takasi-anah = high-values and takasi-ara-detay not = high-values 
                                continue
                                |detaysiz....
                           when takasi-anah not = high-values and takasi-ara-detay not = high-values 
                                perform tek-detay-yaz
                           when other
                                 stop " "
                           end-evaluate
*                           if takasi-anah = high-values and
*                              takasi-ara-detay not = high-values
*                                 perform  tek-detay-yaz
*                           else
*                             perform liste-genel-toplam
*                           end-if                              
                       end-read
                    end-perform
                  end-start
                                   
              close dokumer
              call dokumer-prog on exception
                   perform callerr-proc
              not on exception
                   cancel dokumer-prog
              end-call
              close rez  acenta konum kodlar02 takvim takvim2
              kur romhrk fiyat fiyatana aksiyhrk ulke takas konuk takasi 
              takasfiyat cast takas8 takasay firma cast3  odalar

              delete file dokumer takas takasi  takasay takas8 takasfiyat
    end-evaluate.
 
 tek-detay-yaz.    
      initialize dokumer-rec detay
       
      evaluate det-tip
         when 01
              perform ilk-det-bul
         when 07
               move takasi-ara-detay(1:2)  to konum-anahtar
               read konum no lock invalid
                    move all "*" to konum-adi 
               end-read
               move konum-adi       to det-det
          when 12
               move takasi-ara-detay(1:5)  to firma-anahtar 
               read firma no lock invalid
                    move all " " to firma-adi
               end-read
               
               move firma-adi      to det-det
         when 10
               move takasi-ara-detay(1:4)  to acenta-anahtar 
               read acenta no lock invalid
                    move all "*" to acenta-adi
               end-read
               
               move acenta-adi      to det-det
         when 04
               move takasi-ara-detay(1:3)  to ulke-anah
               read ulke no lock invalid
                    move all "*" to ulke-adi
               end-read                                  
               
               move ulke-adi        to det-det
         when 03
               move takasi-ara-detay(1:2)  to kodlar02-kodu
               move "A"                 to kodlar02-tipi
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               
               move kodlar02-adi    to det-det
         when 05
               move takasi-ara-detay(1:2)  to kodlar02-kodu
               move "D"                     to kodlar02-tipi
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
              
               move kodlar02-adi    to det-det
         when 08
               move takasi-ara-detay(1:2)  to kodlar02-kodu
               move "B"                 to kodlar02-tipi
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               
               move kodlar02-adi    to det-det
         when 02 
               move takasi-ara-detay(1:2)  to kodlar02-kodu
               move "E"                 to kodlar02-tipi
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               
               move kodlar02-adi    to det-det
               
*         when "G"
*               move takasi-anah(1:2)  to konum-anahtar
*               read konum no lock invalid
*                    move all "*" to konum-adi 
*               end-read
*              
*               move konum-adi       to det-det
         end-evaluate
               
              perform datalari-yaz

        move "|" to fil-det fil-1 fil-2 fil-3 fil-4 fil-5 fil-6
                 fil-7 fil-8  fil-9 fil-10 fil-11
                 fil-12 fil-13 fil-top
        write dokumer-rec from detay.
 


 datalari-yaz.                  
     move takasi-data(1) to z-10-10
     move z-10-10           to det-1
     move takasi-buyuk(1) to z-10-10
     move z-10-10           to det-1-1
     move takasi-gelir(1) to z-10
     move z-10           to det-1-2
     
     move takasi-data(2) to z-10-10
     move z-10-10           to det-2
     move takasi-buyuk(2) to z-10-10
     move z-10-10           to det-2-1
     move takasi-gelir(2) to z-10
     move z-10           to det-2-2
     
     move takasi-data(3) to z-10-10
     move z-10-10           to det-3
     move takasi-buyuk(3) to z-10-10
     move z-10-10           to det-3-1
     move takasi-gelir(3) to z-10
     move z-10           to det-3-2
     
     move takasi-data(4) to z-10-10
     move z-10-10           to det-4
     move takasi-buyuk(4) to z-10-10
     move z-10-10           to det-4-1
     move takasi-gelir(4) to z-10
     move z-10           to det-4-2
     
     move takasi-data(5) to z-10-10
     move z-10-10           to det-5
     move takasi-buyuk(5) to z-10-10
     move z-10-10           to det-5-1
     move takasi-gelir(5) to z-10
     move z-10           to det-5-2
     
     move takasi-data(6) to z-10-10
     move z-10-10           to det-6
     move takasi-buyuk(6) to z-10-10
     move z-10-10           to det-6-1
     move takasi-gelir(6) to z-10
     move z-10           to det-6-2
     
     move takasi-data(7) to z-10-10
     move z-10-10           to det-7
     move takasi-buyuk(7) to z-10-10
     move z-10-10           to det-7-1
     move takasi-gelir(7) to z-10
     move z-10           to det-7-2
     
     move takasi-data(8) to z-10-10
     move z-10-10           to det-8
     move takasi-buyuk(8) to z-10-10
     move z-10-10           to det-8-1
     move takasi-gelir(8) to z-10
     move z-10            to det-8-2
     
     move takasi-data(9) to z-10-10
     move z-10-10           to det-9
     move takasi-buyuk(9) to z-10-10
     move z-10-10           to det-9-1
     move takasi-gelir(9) to z-10
     move z-10            to det-9-2
     
     move takasi-data(10) to z-10-10
     move z-10-10           to det-10
     move takasi-buyuk(10) to z-10-10
     move z-10-10           to det-10-1
     move takasi-gelir(10) to z-10
     move z-10             to det-10-2
     
     move takasi-data(11) to z-10-10
     move z-10-10           to det-11
     move takasi-buyuk(11) to z-10-10
     move z-10-10           to det-11-1
     move takasi-gelir(11) to z-10
     move z-10             to det-11-2
     
     move takasi-data(12) to z-10-10
     move z-10-10           to det-12
     move takasi-buyuk(12) to z-10-10
     move z-10-10           to det-12-1
     move takasi-gelir(12) to z-10
     move z-10             to det-12-2
     
     move takasi-data(13) to z-10-10
     move z-10-10         to det-13
     
     move takasi-toplam   to z-10-10
     move z-10-10         to det-top.
                 
     


 liste-doviz-toplam.
    initialize dokumer-rec detay
    move "-"            to det-dokumer-20(5:1)
    move all "-" to det-det det-1 det-2 det-3 det-4 det-5 det-6
                 det-7 det-8  det-9 det-10 det-11
                 det-12 det-13 det-top
    write dokumer-rec from detay
    initialize dokumer-rec detay 
    initialize det-dokumer-20(5:1)
    open input doviz
    initialize doviz-rec
    move takasi-doviz    to doviz-kodu
    read doviz no lock invalid
        move "Tanimsiz...."  to det-det
    end-read
        move d-kisa-adi to det-det(1:3)
    close doviz 
    move "-Toplam-" to det-det(4:)
          perform datalari-yaz
    move "A"          to det-dokumer-20(3:1)
    move 250          to det-renk1
    move "1"          to det-dokumer-20(10:1)
         move "|" to fil-det fil-1 fil-2 fil-3 fil-4 fil-5 fil-6
                 fil-7 fil-8  fil-9 fil-10 fil-11
                 fil-12 fil-13 fil-top
          write dokumer-rec from detay.
 liste-acenta-toplam.
    initialize dokumer-rec detay
    move "-"            to det-dokumer-20(5:1)
    move all "-" to det-det det-1 det-2 det-3 det-4 det-5 det-6
                 det-7 det-8  det-9 det-10 det-11
                 det-12 det-13 det-top
    write dokumer-rec from detay
    initialize dokumer-rec detay 
    initialize det-dokumer-20(5:1)
    perform 
*    open input doviz
*    initialize doviz-rec
*    move takasi-detay    to doviz-kodu
*    read doviz no lock invalid
*        move "Tanimsiz...."  to det-det
*    end-read
*        move d-kisa-adi to det-det(1:3)
*    close doviz 
    move "-Toplam-" to det-det(10:)

          perform datalari-yaz
    move "A"          to det-dokumer-20(3:1)
    move 481          to det-renk1
    move "1"          to det-dokumer-20(10:1)
         move "|" to fil-det fil-1 fil-2 fil-3 fil-4 fil-5 fil-6
                 fil-7 fil-8  fil-9 fil-10 fil-11
                 fil-12 fil-13 fil-top
          write dokumer-rec from detay.
*    
 ilk-det-bul.
      evaluate rap-det(1:1)
         when "A"
               move takasi-anah(1:2)  to konum-anahtar
               read konum no lock invalid
                    move all "*" to konum-adi 
               end-read
               move konum-adi       to det-det
         when "B"
               move takasi-anah(1:4)  to acenta-anahtar 
               read acenta no lock invalid
                    move all "*" to acenta-adi
               end-read
               
               move acenta-adi      to det-det
         when "C"
               move takasi-anah(1:3)  to ulke-anah
               read ulke no lock invalid
                    move all "*" to ulke-adi
               end-read                                  
               
               move ulke-adi        to det-det
         when "D"
               move takasi-anah(1:2)  to kodlar02-kodu
               move "A"                 to kodlar02-tipi
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               
               move kodlar02-adi    to det-det
         when "E"
               move takasi-anah(1:2)  to kodlar02-kodu
               move "D"                     to kodlar02-tipi
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
              
               move kodlar02-adi    to det-det
         when "F"
               move takasi-anah(1:2)  to kodlar02-kodu
               move "B"                 to kodlar02-tipi
               read kodlar02 no lock invalid
                    move all "*" to kodlar02-adi
               end-read
               
               move kodlar02-adi    to det-det
         When "g"
                 move takasi-anah(1:2)  to konum-anahtar
               read konum no lock invalid
                    move all "*" to konum-adi 
               end-read
               move konum-adi       to det-det
          when "H"
              if takasi-anah(1:1) = high-values then 
                  move takasi-anah(2:4)  to acenta-anahtar 
                   read acenta no lock invalid
                    move  "------**ACENTA" to acenta-adi
                    move acenta-kodu to acenta-adi
                   end-read
                    move "--" to det-det
                    move acenta-adi      to det-det(3:)
                    else
               move takasi-anah(1:5)  to firma-anahtar
               read firma no lock invalid
                    move  "------***SIRKET" to firma-adi 
                    move firma-kodu to firma-adi
               end-read    
               move firma-adi       to det-det
              end-if
         end-evaluate.
*
 acc-07-Aft-Procedure.
     open input acenta
     if rapor-acenta = spaces
        move "Tum Acentalar"   to acenta-adi
     else
        move rapor-acenta    to acenta-kodu
        read acenta no lock invalid
             move "Tanimsiz Acenta ..." to acenta-adi
             move 4 to accept-control
             move 15 to control-id
        end-read
     end-if
     display lb-acenta.
     close acenta.
     
     .


 rez-fiyat-kaydet.           
             move rez-no  to takasfiyat-rez-no
             move takvim-anah to takasfiyat-tarih
             
             read takasfiyat no lock 
                invalid
                if rez-cik-tar not = rez-gir-tar and 
                   takvim-anah = rez-cik-tar and 
                   bas-tar not = takvim-anah
                      continue  
                 else
                   perform  peryot-fiyat-bul
*                   if  rez-cik-tar  = takvim-anah then 
*                     initialize pax-sayisi
*                  end-if
                   perform varying jj from 1 by 1 until  jj > 200 
                      
                   if fiyatt-tar(jj) = takvim-anah
                
*                  if gercek-cin-kuru = 1 then 
*                      compute cevrilmis-deger rounded =  fiyatt-fiy(jj) * 
*                       fiyatt-kur(jj) / butce-kurlari(butce-cev-doviz)
*                       compute cevrilmis-tl rounded =  fiyatt-fiy(jj) * 
*                       fiyatt-kur(jj) 
*                    else
*                       compute cevrilmis-deger =  fiyatt-fiy(jj) *  
*                       butce-kurlari(rez-doviz) / butce-kurlari(butce-cev-doviz)
*                       compute cevrilmis-tl rounded =  fiyatt-fiy(jj) * 
*                       butce-kurlari(rez-doviz)  
*                  end-if
                  
*                        compute takas8-price-total rounded = takas8-price-total +
*                               cevrilmis-deger
*                        compute takas8-price-totaltl rounded = takas8-price-totaltl +
*                               cevrilmis-tl
                         move fiyatt-fiy(jj) to gunluk-fiyat  
*                         compute toplam-rez-fiyati rounded = toplam-rez-fiyati +
*                               fiyatt-fiy(jj)
                   end-if
                 end-perform  
              end-if
              not invalid 
*                  if  rez-cik-tar  = takvim-anah then 
*                     initialize pax-sayisi
*                  end-if
*                  if gercek-cin-kuru = 1 then 
*                      compute cevrilmis-deger rounded =  takasfiyat-fiyat * 
*                       takasfiyat-kur / butce-kurlari(butce-cev-doviz)
*                       compute cevrilmis-tl rounded =  takasfiyat-fiyat * 
*                       takasfiyat-kur 
*                    else
*                       compute cevrilmis-deger =  takasfiyat-fiyat *  
*                       butce-kurlari(rez-doviz) / butce-kurlari(butce-cev-doviz)
*                       compute cevrilmis-tl =  takasfiyat-fiyat *  
*                       butce-kurlari(rez-doviz) 
*                  end-if
*                    compute takas8-price-total rounded = takas8-price-total +
*                             cevrilmis-deger 
*                    compute takas8-price-totaltl rounded = takas8-price-totaltl +
*                             cevrilmis-tl
*                    compute takas8-price-totaldov rounded = takas8-price-totaldov +
*                             takasfiyat-fiyat
                     move takasfiyat-fiyat   to gunluk-fiyat

             end-read.


 
