* fihrist.evt
* fihrist.evt is generated from D:\asya\acugt.ytl\otel\fihrist.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .

 arama-combo-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM arama-combo-Ex-Ntf-Selchange
        END-EVALUATE
     ELSE
        PERFORM Form1-Ex-Other
     END-IF
     .

 Lb-Sirala-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Pl-First
           PERFORM Lb-Sirala-ilk
        WHEN Ntf-Pl-Last
           PERFORM Lb-Sirala-Son
        WHEN Ntf-Pl-Next
           PERFORM Lb-Sirala-Sonraki
        WHEN Ntf-Pl-Nextpage
           PERFORM Lb-Sirala-Sonraki-Sayfa
        WHEN Ntf-Pl-Prev
           PERFORM Lb-Sirala-Onceki
        WHEN Ntf-Pl-Prevpage
           PERFORM Lb-Sirala-Onceki-Sayfa
        WHEN Ntf-Pl-Search
           PERFORM Lb-Sirala-Arama
        WHEN Ntf-Selchange
           PERFORM Lb-Sirala-Secim
        END-EVALUATE
     ELSE
        PERFORM Form1-Ex-Other
     END-IF
     .

 Gd-Data-Event-Proc.
* 
     EVALUATE Event-Type
     WHEN Msg-Begin-Entry
        PERFORM Gd-Data-Ev-Msg-Begin-Entry
     WHEN Msg-Goto-Cell
        PERFORM Gd-Data-Ev-Msg-Goto-Cell
     WHEN Msg-Goto-Cell-Mouse
        PERFORM Gd-Data-Ev-Msg-Goto-Cell-Mouse
     WHEN Msg-Paged-First
        PERFORM Lb-Sirala-ilk
     WHEN Msg-Paged-Last
        PERFORM Lb-Sirala-Son
     WHEN Msg-Paged-Next
        PERFORM Lb-Sirala-Sonraki
     WHEN Msg-Paged-Nextpage
        PERFORM Lb-Sirala-Sonraki-Sayfa
     WHEN Msg-Paged-Prev
        PERFORM Lb-Sirala-Onceki
     WHEN Msg-Paged-Prevpage
        PERFORM Lb-Sirala-Onceki-Sayfa
     END-EVALUATE
     .

 Gd-Data-Exception-Proc.
     PERFORM Form1-Ex-Other
     .

 Form1-Pb-1aaa-Exception-Proc.
     PERFORM Form1-Ex-Other
     .

 Form1-Pb-1aab-Exception-Proc.
     PERFORM Form1-Ex-Other
     .
***   start event editor code   ***
*
 Form1-Bef-Create.
     perform adresleri-tasi
     .
*
 Form1-Aft-Initdata.
     perform lb-Sirala-init
     open i-o fihrist
*     perform gd-yukle
     perform lb-Sirala-Kolon-Ayar
     initialize fihrist-rec
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
     .
*
 Form1-Ex-Other.
     evaluate key-status
       when 1 perform fihrist-ara
       when 2
         initialize fihrist-anahtar
         Perform detay-goster
       when 3 perform fihrist-sil
       when 4 perform rapor-ver
     end-evaluate
     .
*
 arama-combo-Ex-Ntf-Selchange.
     move cb-sirala-val to arama.
*     perform Gd-Yukle
     perform Lb-Sirala-Kolon-Ayar
     .
*
 Form1-Lb-1-Ex-Cmd-Dblclick.
    move 2001 to key-status.
    perform  Form1-Ex-Other.
*
 Form1-Aft-Routine.
     close fihrist.
*
 fihrist-ara.
     initialize fihara-cagir
     inquire Gd-Data, cursor-y in gd-y
     modify Gd-Data, X = 18, Y = gd-y
     inquire gd-data
       cell-data in fihrist-anahtar
     move fihrist-anahtar to fihara-anahtar
                             fihrdty-anahtar
     call "/asya/ytl/obj/otel/fihara.asy"
       using fihara-cagir
       on exception 
       perform callerr-proc
       not on exception
     cancel "/asya/ytl/obj/otel/fihara.asy"
     end-call
     move fihara-anahtar to fihrist-anahtar
     if fihara-anahtar not = fihrdty-anahtar                       
        perform detay-goster
     end-if
     .
*
 lb-Sirala-init.
     modify cb-siralama,
       reset-list = 1 
       mass-update = 1
     modify cb-siralama,
       item-to-add("0-Fihrist Koduna Gore",
                   "1-Ada gore",
                   "2-Soyada gore",
                   "3-Ile gore",
                   "4-Ulkeye gore",
                   "5-Telefona gore",
                   "6-Gruba gore")
     move 1 to cb-sirala-val
     move 1 to arama
     modify cb-siralama,
       mass-update = 0
       value       = cb-sirala-val
     .
*
 lb-Sirala-Kolon-Ayar.

     perform gd-data-kolon-ayarla
     modify Gd-Data, reset-grid    = 1
     modify Gd-Data, mass-update   = 1
                     drag-color    = 80
                     region-color  = 432
     move gd-baslik to fihrist-rec
     perform Gd-Data-Ekran-Yaz

     modify Lb-Sirala,
       reset-list  = 1 
       mass-update = 1
     modify Lb-Sirala,
       data-columns    = 0
       display-columns = 0
     modify Lb-Sirala,
       data-columns(1)
       display-columns(1)
     perform Lb-Sirala-ilk
     modify Lb-Sirala,
       mass-update = 0

     modify gd-data,
            mass-update = 0.
     .
*
 Lb-Sirala-Arama.
     inquire Lb-Sirala,
       search-text in arama-kelime
     modify Lb-Sirala,
       reset-list  = 1 
       mass-update = 1
     evaluate cb-sirala-val
       when 0 move arama-kelime to fihrist-harf
       when 1 move arama-kelime to fihrist-adi
       when 2 move arama-kelime to fihrist-soyadi
       when 3 move arama-kelime to fihrist-il
       when 4 move arama-kelime to fihrist-ulke
       when 5 move arama-kelime to fihrist-telefon
       when 6 move arama-kelime to fihrist-grup
     end-evaluate
     set lb-sirala-oku-ileri to true
     perform lb-sirala-sayfa-oku
     modify Lb-Sirala,
       mass-update = 0
     perform Lb-Sirala-Onceki
     .
*
 Lb-Sirala-ilk.
     modify Lb-Sirala,
       reset-list  = 1 
       mass-update = 1
     move all null to fihrist-rec
     set lb-sirala-oku-ileri to true
     perform lb-sirala-sayfa-oku
     modify Lb-Sirala,
       mass-update = 0
     .
*
 Lb-Sirala-Son.
     modify Lb-Sirala,
       reset-list  = 1 
       mass-update = 1
     move all high-values to fihrist-rec
     set lb-sirala-oku-geri to true
     perform lb-sirala-sayfa-oku
     modify Lb-Sirala,
       mass-update = 0
     .
*
 Lb-Sirala-Onceki.
     perform lb-sirala-ilk-oku 
     set lb-sirala-oku-geri to true
     perform lb-sirala-oku
     .
*
 Lb-Sirala-Onceki-Sayfa.
     perform lb-sirala-ilk-oku 
     set lb-sirala-oku-geri to true
     perform lb-sirala-sayfa-oku
     .
*
 Lb-Sirala-Sonraki.
     perform lb-sirala-son-oku 
     set lb-sirala-oku-ileri to true
     perform lb-sirala-oku
     .
*
 Lb-Sirala-Sonraki-Sayfa.
     perform lb-sirala-son-oku 
     set lb-sirala-oku-ileri to true
     perform lb-sirala-sayfa-oku
     .
*
 lb-sirala-ilk-oku.
     modify Lb-Sirala, query-index = 1
     perform lb-sirala-pos-oku
     .
*
 lb-sirala-son-oku.
     move kayit-sayisi to lb-sirala-idx
     initialize kelime
     perform with test after
             until kelime not = spaces
       modify  Lb-Sirala, query-index = lb-sirala-idx
       inquire Lb-Sirala, item-value in kelime
       subtract 1 from lb-sirala-idx
     end-perform
     if kelime = "_"
        move spaces to kelime
     end-if
     perform lb-sirala-pos-oku
     .
*
 lb-sirala-pos-oku.
     evaluate cb-sirala-val
       when 0
         inquire Lb-Sirala,
           item-value in fihrist-harf
         if fihrist-harf = "_"
            move spaces to fihrist-harf
         end-if
       when 1
         inquire Lb-Sirala,
           item-value in fihrist-adi
         if fihrist-adi = "_"
            move spaces to fihrist-adi
         end-if
       when 2
         inquire Lb-Sirala,
           item-value in fihrist-soyadi
         if fihrist-soyadi = "_"
            move spaces to fihrist-soyadi
         end-if
       when 3
         inquire Lb-Sirala,
           item-value in fihrist-il
         if fihrist-il = "_"
            move spaces to fihrist-il
         end-if
       when 4
         inquire Lb-Sirala,
           item-value in fihrist-ulke
         if fihrist-ulke = "_"
            move spaces to fihrist-ulke
         end-if
       when 5
         inquire Lb-Sirala,
           item-value in fihrist-telefon
         if fihrist-telefon = "_"
            move spaces to fihrist-telefon
         end-if
       when 6
         inquire Lb-Sirala,
           item-value in fihrist-grup
         if fihrist-grup = "_"
            move spaces to fihrist-grup
         end-if
     end-evaluate
     .
*
 lb-sirala-sayfa-oku.
     move 1 to lb-sirala-idx
     perform with test after
       until fs-fihrist    = "10" or
             lb-sirala-idx > kayit-sayisi
       perform Lb-Sirala-Oku
       add 1 to lb-sirala-idx
     end-perform
     .
*
 lb-sirala-oku.
     initialize fs-fihrist
     evaluate true
       when lb-sirala-oku-ileri
         evaluate cb-sirala-val
           when 0
             start fihrist key > fihrist-harf
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 1 
             start fihrist key > fihrist-adi
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 2
             start fihrist key > fihrist-soyadi
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 3
             start fihrist key > fihrist-il
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 4
             start fihrist key > fihrist-ulke
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 5
             start fihrist key > fihrist-telefon
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 6
             start fihrist key > fihrist-grup
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
         end-evaluate
       when lb-sirala-oku-geri
         evaluate cb-sirala-val
           when 0
             start fihrist key < fihrist-harf
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 1 
             start fihrist key < fihrist-adi
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 2
             start fihrist key < fihrist-soyadi
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 3
             start fihrist key < fihrist-il
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 4
             start fihrist key < fihrist-ulke
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 5
             start fihrist key < fihrist-telefon
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
           when 6
             start fihrist key < fihrist-grup
               invalid
                 move "10" to fs-fihrist
               not invalid
                 perform lb-sirala-kayit-oku
             end-start
         end-evaluate
     end-evaluate
     .
*
 lb-sirala-kayit-oku.
     evaluate true
       when lb-sirala-oku-ileri
         read fihrist next no lock
           end
             move "10" to fs-fihrist
           not end
             perform lb-sirala-kayit-yaz
         end-read
       when lb-sirala-oku-geri
         read fihrist previous no lock
           end
             move "10" to fs-fihrist
           not end
             perform lb-sirala-kayit-yaz
         end-read
     end-evaluate
     .
*
 lb-sirala-kayit-yaz.
     evaluate true
       when lb-sirala-oku-ileri
         modify Lb-Sirala,
*           insertion-index = 0
*           insertion-index = kayit-sayisi
       when lb-sirala-oku-geri
         modify Lb-Sirala,
           insertion-index = 1
         modify Gd-Data, 
           insertion-index = 2
          
     end-evaluate
     evaluate cb-sirala-val
       when 0
         if fihrist-harf = spaces
            move all "_" to fihrist-harf
         end-if
         modify Lb-Sirala,
           item-to-add fihrist-harf
       when 1
         if fihrist-adi = spaces
            modify Lb-Sirala,
              item-to-add "_"
         else
            modify Lb-Sirala,
              item-to-add fihrist-adi
         end-if
       when 2
         if fihrist-soyadi = spaces
            modify Lb-Sirala,
              item-to-add "_"
         else
            modify Lb-Sirala,
              item-to-add fihrist-soyadi
         end-if
       when 3
         if fihrist-il = spaces
            modify Lb-Sirala,
              item-to-add "_"
         else
            modify Lb-Sirala,
              item-to-add fihrist-il
         end-if
       when 4
         if fihrist-ulke = spaces
            modify Lb-Sirala,
              item-to-add "_"
         else
            modify Lb-Sirala,
              item-to-add fihrist-ulke
         end-if
       when 5
         if fihrist-telefon = spaces
            modify Lb-Sirala,
              item-to-add "_"
         else
            modify Lb-Sirala,
              item-to-add fihrist-telefon
         end-if
       when 6
         if fihrist-grup = spaces
            modify Lb-Sirala,
              item-to-add "_"
         else
            modify Lb-Sirala,
              item-to-add fihrist-grup
         end-if
     end-evaluate
     perform gd-data-ekran-yaz
     .
*
 Lb-Sirala-Secim.
     inquire Lb-Sirala,
       selection-index in i
     inquire Lb-Sirala(i), value in arama-kelime
     if arama-kelime = "_"
        move spaces to arama-kelime
     end-if
     perform gd-konumlan
     .
*
 fihrist-oto-al.
     open i-o genelfis
     move 1 to genelfis-anahtar
     read genelfis no lock
       invalid
         initialize genelfis-rec
         move 1 to genelfis-anahtar
     end-read
     add 1 to fihrist-oto
     if fihrist-oto > 999998
        initialize fihrist-oto
     else
        move fihrist-oto to fihrist-no
     end-if
     rewrite genelfis-rec
       invalid
         write genelfis-rec, end-write
     end-rewrite
     close genelfis
     .

*
 detay-goster.
     initialize fihrdty-cagir
     if fihrist-no = 0
        perform fihrist-oto-al
     end-if   
     move fihrist-harf to fihrdty-harf
     move fihrist-no   to fihrdty-no
     call "/asya/ytl/obj/otel/fihrdty.asy"
       using fihrdty-cagir
       on exception perform callerr-proc
       not on exception
         cancel "/asya/ytl/obj/otel/fihrdty.asy"
         perform arama-combo-Ex-Ntf-Selchange
         set grid-search-forwards     to true
         set grid-search-wrap         to true
         set grid-search-ignore-case  to false
         set grid-search-match-all    to true
         set grid-search-skip-current to false
         set grid-search-moves-cursor to true
         move 18 to grid-search-column
         modify Gd-Data,
           cursor-x = 18
           cursor-y = 2
           x        = 18
           Y        = 2
         modify Gd-Data,
           search-options = grid-search-options
           search-text    = fihrdty-anahtar giving gd-y
         move 1 to gd-x
         inquire gd-data, cursor-y in gd-y
         modify Gd-Data, cursor-x = gd-x
                         cursor-y = gd-y
                         X        = gd-x
                         Y        = gd-y
*         move gd-x to event-data-1
*         move gd-y to event-data-2
*         perform Gd-Data-Parlat
      
     end-call
     .
*
 gd-yukle.
     perform gd-data-kolon-ayarla
     modify Gd-Data, reset-grid    = 1
     modify Gd-Data, mass-update   = 0
                     drag-color    = 80
                     region-color  = 432
     move gd-baslik to fihrist-rec
     perform Gd-Data-Ekran-Yaz
     exit paragraph

     initialize fihrist-rec
                fs-fihrist
     evaluate cb-sirala-val
       when 0
         start fihrist key >= fihrist-harf
           invalid
             move "10" to fs-fihrist
         end-start
       when 1 
         start fihrist key >= fihrist-adi
           invalid
             move "10" to fs-fihrist
         end-start
       when 2
         start fihrist key >= fihrist-soyadi
           invalid
             move "10" to fs-fihrist
         end-start
       when 3
         start fihrist key >= fihrist-il
           invalid
             move "10" to fs-fihrist
         end-start
       when 4
         start fihrist key >= fihrist-ulke
           invalid
             move "10" to fs-fihrist
         end-start
       when 5
         start fihrist key >= fihrist-telefon
           invalid
             move "10" to fs-fihrist
         end-start
       when 6
         start fihrist key >= fihrist-grup
           invalid
             move "10" to fs-fihrist
         end-start
     end-evaluate
     if fs-fihrist not = "10"
        perform gd-data-grid-aktar
     end-if
     modify Gd-Data, mass-update   = 0
     .
*
 gd-data-grid-aktar.
     perform with test after
             until fs-fihrist = "10"
       read fihrist next no lock
         end
           move "10" to fs-fihrist
         not end
           move 1 to gd-y
           perform gd-data-ekran-yaz
       end-read
     end-perform
     .
*
 gd-data-ekran-yaz.
     evaluate cb-sirala-val
       when 0
         move fihrist-harf           to gd-rapor(gd-sutun-pos(1):)
         move fihrist-telefon        to gd-rapor(gd-sutun-pos(2):)
         move fihrist-adi            to gd-rapor(gd-sutun-pos(3):)
         move fihrist-soyadi         to gd-rapor(gd-sutun-pos(4):)
         move fihrist-unvani         to gd-rapor(gd-sutun-pos(5):)
         move fihrist-grup           to gd-rapor(gd-sutun-pos(6):)
         move fihrist-fax            to gd-rapor(gd-sutun-pos(7):)
         move fihrist-mobil-tel      to gd-rapor(gd-sutun-pos(8):)
         move fihrist-il             to gd-rapor(gd-sutun-pos(9):)
         move fihrist-ilce           to gd-rapor(gd-sutun-pos(10):)
         move fihrist-ulke           to gd-rapor(gd-sutun-pos(11):)
         move fihrist-adres-1        to gd-rapor(gd-sutun-pos(12):)
         move fihrist-adres-2        to gd-rapor(gd-sutun-pos(13):)
         move fihrist-adres-3        to gd-rapor(gd-sutun-pos(14):)
         move fihrist-internet-adres to gd-rapor(gd-sutun-pos(15):)
         move fihrist-email          to gd-rapor(gd-sutun-pos(16):)
         move fihrist-not            to gd-rapor(gd-sutun-pos(17):)
       when 1 
         move fihrist-adi            to gd-rapor(gd-sutun-pos(1):)
         move fihrist-soyadi         to gd-rapor(gd-sutun-pos(2):)
         move fihrist-telefon        to gd-rapor(gd-sutun-pos(3):)
         move fihrist-unvani         to gd-rapor(gd-sutun-pos(4):)
         move fihrist-harf           to gd-rapor(gd-sutun-pos(5):)
         move fihrist-grup           to gd-rapor(gd-sutun-pos(6):)
         move fihrist-fax            to gd-rapor(gd-sutun-pos(7):)
         move fihrist-mobil-tel      to gd-rapor(gd-sutun-pos(8):)
         move fihrist-il             to gd-rapor(gd-sutun-pos(9):)
         move fihrist-ilce           to gd-rapor(gd-sutun-pos(10):)
         move fihrist-ulke           to gd-rapor(gd-sutun-pos(11):)
         move fihrist-adres-1        to gd-rapor(gd-sutun-pos(12):)
         move fihrist-adres-2        to gd-rapor(gd-sutun-pos(13):)
         move fihrist-adres-3        to gd-rapor(gd-sutun-pos(14):)
         move fihrist-internet-adres to gd-rapor(gd-sutun-pos(15):)
         move fihrist-email          to gd-rapor(gd-sutun-pos(16):)
         move fihrist-not            to gd-rapor(gd-sutun-pos(17):)
       when 2
         move fihrist-soyadi         to gd-rapor(gd-sutun-pos(1):)
         move fihrist-adi            to gd-rapor(gd-sutun-pos(2):)
         move fihrist-telefon        to gd-rapor(gd-sutun-pos(3):)
         move fihrist-unvani         to gd-rapor(gd-sutun-pos(4):)
         move fihrist-harf           to gd-rapor(gd-sutun-pos(5):)
         move fihrist-grup           to gd-rapor(gd-sutun-pos(6):)
         move fihrist-fax            to gd-rapor(gd-sutun-pos(7):)
         move fihrist-mobil-tel      to gd-rapor(gd-sutun-pos(8):)
         move fihrist-il             to gd-rapor(gd-sutun-pos(9):)
         move fihrist-ilce           to gd-rapor(gd-sutun-pos(10):)
         move fihrist-ulke           to gd-rapor(gd-sutun-pos(11):)
         move fihrist-adres-1        to gd-rapor(gd-sutun-pos(12):)
         move fihrist-adres-2        to gd-rapor(gd-sutun-pos(13):)
         move fihrist-adres-3        to gd-rapor(gd-sutun-pos(14):)
         move fihrist-internet-adres to gd-rapor(gd-sutun-pos(15):)
         move fihrist-email          to gd-rapor(gd-sutun-pos(16):)
         move fihrist-not            to gd-rapor(gd-sutun-pos(17):)
       when 3
         move fihrist-il             to gd-rapor(gd-sutun-pos(1):)
         move fihrist-telefon        to gd-rapor(gd-sutun-pos(2):)
         move fihrist-adi            to gd-rapor(gd-sutun-pos(3):)
         move fihrist-soyadi         to gd-rapor(gd-sutun-pos(4):)
         move fihrist-unvani         to gd-rapor(gd-sutun-pos(5):)
         move fihrist-harf           to gd-rapor(gd-sutun-pos(6):)
         move fihrist-grup           to gd-rapor(gd-sutun-pos(7):)
         move fihrist-fax            to gd-rapor(gd-sutun-pos(8):)
         move fihrist-mobil-tel      to gd-rapor(gd-sutun-pos(9):)
         move fihrist-ilce           to gd-rapor(gd-sutun-pos(10):)
         move fihrist-ulke           to gd-rapor(gd-sutun-pos(11):)
         move fihrist-adres-1        to gd-rapor(gd-sutun-pos(12):)
         move fihrist-adres-2        to gd-rapor(gd-sutun-pos(13):)
         move fihrist-adres-3        to gd-rapor(gd-sutun-pos(14):)
         move fihrist-internet-adres to gd-rapor(gd-sutun-pos(15):)
         move fihrist-email          to gd-rapor(gd-sutun-pos(16):)
         move fihrist-not            to gd-rapor(gd-sutun-pos(17):)
       when 4
         move fihrist-ulke           to gd-rapor(gd-sutun-pos(1):)
         move fihrist-telefon        to gd-rapor(gd-sutun-pos(2):)
         move fihrist-adi            to gd-rapor(gd-sutun-pos(3):)
         move fihrist-soyadi         to gd-rapor(gd-sutun-pos(4):)
         move fihrist-unvani         to gd-rapor(gd-sutun-pos(5):)
         move fihrist-harf           to gd-rapor(gd-sutun-pos(6):)
         move fihrist-grup           to gd-rapor(gd-sutun-pos(7):)
         move fihrist-fax            to gd-rapor(gd-sutun-pos(8):)
         move fihrist-mobil-tel      to gd-rapor(gd-sutun-pos(9):)
         move fihrist-il             to gd-rapor(gd-sutun-pos(10):)
         move fihrist-ilce           to gd-rapor(gd-sutun-pos(11):)
         move fihrist-adres-1        to gd-rapor(gd-sutun-pos(12):)
         move fihrist-adres-2        to gd-rapor(gd-sutun-pos(13):)
         move fihrist-adres-3        to gd-rapor(gd-sutun-pos(14):)
         move fihrist-internet-adres to gd-rapor(gd-sutun-pos(15):)
         move fihrist-email          to gd-rapor(gd-sutun-pos(16):)
         move fihrist-not            to gd-rapor(gd-sutun-pos(17):)
       when 5
         move fihrist-telefon        to gd-rapor(gd-sutun-pos(1):)
         move fihrist-adi            to gd-rapor(gd-sutun-pos(2):)
         move fihrist-soyadi         to gd-rapor(gd-sutun-pos(3):)
         move fihrist-unvani         to gd-rapor(gd-sutun-pos(4):)
         move fihrist-harf           to gd-rapor(gd-sutun-pos(5):)
         move fihrist-grup           to gd-rapor(gd-sutun-pos(6):)
         move fihrist-fax            to gd-rapor(gd-sutun-pos(7):)
         move fihrist-mobil-tel      to gd-rapor(gd-sutun-pos(8):)
         move fihrist-il             to gd-rapor(gd-sutun-pos(9):)
         move fihrist-ilce           to gd-rapor(gd-sutun-pos(10):)
         move fihrist-ulke           to gd-rapor(gd-sutun-pos(11):)
         move fihrist-adres-1        to gd-rapor(gd-sutun-pos(12):)
         move fihrist-adres-2        to gd-rapor(gd-sutun-pos(13):)
         move fihrist-adres-3        to gd-rapor(gd-sutun-pos(14):)
         move fihrist-internet-adres to gd-rapor(gd-sutun-pos(15):)
         move fihrist-email          to gd-rapor(gd-sutun-pos(16):)
         move fihrist-not            to gd-rapor(gd-sutun-pos(17):)
       when 6
         move fihrist-grup           to gd-rapor(gd-sutun-pos(1):)
         move fihrist-telefon        to gd-rapor(gd-sutun-pos(2):)
         move fihrist-adi            to gd-rapor(gd-sutun-pos(3):)
         move fihrist-soyadi         to gd-rapor(gd-sutun-pos(4):)
         move fihrist-unvani         to gd-rapor(gd-sutun-pos(5):)
         move fihrist-harf           to gd-rapor(gd-sutun-pos(6):)
         move fihrist-fax            to gd-rapor(gd-sutun-pos(7):)
         move fihrist-mobil-tel      to gd-rapor(gd-sutun-pos(8):)
         move fihrist-il             to gd-rapor(gd-sutun-pos(9):)
         move fihrist-ilce           to gd-rapor(gd-sutun-pos(10):)
         move fihrist-ulke           to gd-rapor(gd-sutun-pos(11):)
         move fihrist-adres-1        to gd-rapor(gd-sutun-pos(12):)
         move fihrist-adres-2        to gd-rapor(gd-sutun-pos(13):)
         move fihrist-adres-3        to gd-rapor(gd-sutun-pos(14):)
         move fihrist-internet-adres to gd-rapor(gd-sutun-pos(15):)
         move fihrist-email          to gd-rapor(gd-sutun-pos(16):)
         move fihrist-not            to gd-rapor(gd-sutun-pos(17):)
     end-evaluate
     move fihrist-anahtar            to gd-rapor(gd-sutun-pos(18):)
     modify Gd-Data, record-to-add = gd-rapor
     .
*
 gd-data-kolon-ayarla.
     evaluate cb-sirala-val
       when 0
         set gd-sutun-pos(1)  to size of fihrist-harf
         set gd-sutun-pos(2)  to size of fihrist-telefon
         set gd-sutun-pos(3)  to size of fihrist-adi
         set gd-sutun-pos(4)  to size of fihrist-soyadi
         set gd-sutun-pos(5)  to size of fihrist-unvani
         set gd-sutun-pos(6)  to size of fihrist-grup
         set gd-sutun-pos(7)  to size of fihrist-fax
         set gd-sutun-pos(8)  to size of fihrist-mobil-tel
         set gd-sutun-pos(9)  to size of fihrist-il
         set gd-sutun-pos(10) to size of fihrist-ilce
         set gd-sutun-pos(11) to size of fihrist-ulke
         set gd-sutun-pos(12) to size of fihrist-adres-1
         set gd-sutun-pos(13) to size of fihrist-adres-2
         set gd-sutun-pos(14) to size of fihrist-adres-3
         set gd-sutun-pos(15) to size of fihrist-internet-adres
         set gd-sutun-pos(16) to size of fihrist-email
         set gd-sutun-pos(17) to size of fihrist-not
       when 1 
         set gd-sutun-pos(1)  to size of fihrist-adi
         set gd-sutun-pos(2)  to size of fihrist-soyadi
         set gd-sutun-pos(3)  to size of fihrist-telefon
         set gd-sutun-pos(4)  to size of fihrist-unvani
         set gd-sutun-pos(5)  to size of fihrist-harf
         set gd-sutun-pos(6)  to size of fihrist-grup
         set gd-sutun-pos(7)  to size of fihrist-fax
         set gd-sutun-pos(8)  to size of fihrist-mobil-tel
         set gd-sutun-pos(9)  to size of fihrist-il
         set gd-sutun-pos(10) to size of fihrist-ilce
         set gd-sutun-pos(11) to size of fihrist-ulke
         set gd-sutun-pos(12) to size of fihrist-adres-1
         set gd-sutun-pos(13) to size of fihrist-adres-2
         set gd-sutun-pos(14) to size of fihrist-adres-3
         set gd-sutun-pos(15) to size of fihrist-internet-adres
         set gd-sutun-pos(16) to size of fihrist-email
         set gd-sutun-pos(17) to size of fihrist-not
       when 2
         set gd-sutun-pos(1)  to size of fihrist-soyadi
         set gd-sutun-pos(2)  to size of fihrist-adi
         set gd-sutun-pos(3)  to size of fihrist-telefon
         set gd-sutun-pos(4)  to size of fihrist-unvani
         set gd-sutun-pos(5)  to size of fihrist-harf
         set gd-sutun-pos(6)  to size of fihrist-grup
         set gd-sutun-pos(7)  to size of fihrist-fax
         set gd-sutun-pos(8)  to size of fihrist-mobil-tel
         set gd-sutun-pos(9)  to size of fihrist-il
         set gd-sutun-pos(10) to size of fihrist-ilce
         set gd-sutun-pos(11) to size of fihrist-ulke
         set gd-sutun-pos(12) to size of fihrist-adres-1
         set gd-sutun-pos(13) to size of fihrist-adres-2
         set gd-sutun-pos(14) to size of fihrist-adres-3
         set gd-sutun-pos(15) to size of fihrist-internet-adres
         set gd-sutun-pos(16) to size of fihrist-email
         set gd-sutun-pos(17) to size of fihrist-not
       when 3
         set gd-sutun-pos(1)  to size of fihrist-il
         set gd-sutun-pos(2)  to size of fihrist-telefon
         set gd-sutun-pos(3)  to size of fihrist-adi
         set gd-sutun-pos(4)  to size of fihrist-soyadi
         set gd-sutun-pos(5)  to size of fihrist-unvani
         set gd-sutun-pos(6)  to size of fihrist-harf
         set gd-sutun-pos(7)  to size of fihrist-grup
         set gd-sutun-pos(8)  to size of fihrist-fax
         set gd-sutun-pos(9)  to size of fihrist-mobil-tel
         set gd-sutun-pos(10) to size of fihrist-ilce
         set gd-sutun-pos(11) to size of fihrist-ulke
         set gd-sutun-pos(12) to size of fihrist-adres-1
         set gd-sutun-pos(13) to size of fihrist-adres-2
         set gd-sutun-pos(14) to size of fihrist-adres-3
         set gd-sutun-pos(15) to size of fihrist-internet-adres
         set gd-sutun-pos(16) to size of fihrist-email
         set gd-sutun-pos(17) to size of fihrist-not
       when 4
         set gd-sutun-pos(1)  to size of fihrist-ulke
         set gd-sutun-pos(2)  to size of fihrist-telefon
         set gd-sutun-pos(3)  to size of fihrist-adi
         set gd-sutun-pos(4)  to size of fihrist-soyadi
         set gd-sutun-pos(5)  to size of fihrist-unvani
         set gd-sutun-pos(6)  to size of fihrist-harf
         set gd-sutun-pos(7)  to size of fihrist-grup
         set gd-sutun-pos(8)  to size of fihrist-fax
         set gd-sutun-pos(9)  to size of fihrist-mobil-tel
         set gd-sutun-pos(10) to size of fihrist-il
         set gd-sutun-pos(11) to size of fihrist-ilce
         set gd-sutun-pos(12) to size of fihrist-adres-1
         set gd-sutun-pos(13) to size of fihrist-adres-2
         set gd-sutun-pos(14) to size of fihrist-adres-3
         set gd-sutun-pos(15) to size of fihrist-internet-adres
         set gd-sutun-pos(16) to size of fihrist-email
         set gd-sutun-pos(17) to size of fihrist-not
       when 5
         set gd-sutun-pos(1)  to size of fihrist-telefon
         set gd-sutun-pos(2)  to size of fihrist-adi
         set gd-sutun-pos(3)  to size of fihrist-soyadi
         set gd-sutun-pos(4)  to size of fihrist-unvani
         set gd-sutun-pos(5)  to size of fihrist-harf
         set gd-sutun-pos(6)  to size of fihrist-grup
         set gd-sutun-pos(7)  to size of fihrist-fax
         set gd-sutun-pos(8)  to size of fihrist-mobil-tel
         set gd-sutun-pos(9)  to size of fihrist-il
         set gd-sutun-pos(10) to size of fihrist-ilce
         set gd-sutun-pos(11) to size of fihrist-ulke
         set gd-sutun-pos(12) to size of fihrist-adres-1
         set gd-sutun-pos(13) to size of fihrist-adres-2
         set gd-sutun-pos(14) to size of fihrist-adres-3
         set gd-sutun-pos(15) to size of fihrist-internet-adres
         set gd-sutun-pos(16) to size of fihrist-email
         set gd-sutun-pos(17) to size of fihrist-not
       when 6
         set gd-sutun-pos(1)  to size of fihrist-grup
         set gd-sutun-pos(2)  to size of fihrist-telefon
         set gd-sutun-pos(3)  to size of fihrist-adi
         set gd-sutun-pos(4)  to size of fihrist-soyadi
         set gd-sutun-pos(5)  to size of fihrist-unvani
         set gd-sutun-pos(6)  to size of fihrist-harf
         set gd-sutun-pos(7)  to size of fihrist-fax
         set gd-sutun-pos(8)  to size of fihrist-mobil-tel
         set gd-sutun-pos(9)  to size of fihrist-il
         set gd-sutun-pos(10) to size of fihrist-ilce
         set gd-sutun-pos(11) to size of fihrist-ulke
         set gd-sutun-pos(12) to size of fihrist-adres-1
         set gd-sutun-pos(13) to size of fihrist-adres-2
         set gd-sutun-pos(14) to size of fihrist-adres-3
         set gd-sutun-pos(15) to size of fihrist-internet-adres
         set gd-sutun-pos(16) to size of fihrist-email
         set gd-sutun-pos(17) to size of fihrist-not
     end-evaluate
     set gd-sutun-pos(18) to size of fihrist-anahtar
     set gd-sutun-pos(19) to 0
     set gd-sutun-pos(20) to 0
     move gd-sutun-pos(1) to onceki-boy
     move 1               to gd-sutun-pos(1)
                             gd-sutun-boy(1)
                             onceki-pos
     perform varying
             islem-sutun
             from  2
             by    1
             until islem-sutun > 20
       move    gd-sutun-pos(islem-sutun) to onceki-tmp
       compute gd-sutun-pos(islem-sutun)  = onceki-pos + onceki-boy
       move    gd-sutun-pos(islem-sutun) to onceki-pos
       move    onceki-tmp                to onceki-boy
       compute gd-sutun-boy(islem-sutun)  = gd-sutun-pos(islem-sutun) + ( 2 * (islem-sutun - 1 ))
     end-perform
     modify Gd-Data, 
       data-columns (gd-sutun-pos(1),
                     gd-sutun-pos(2),
                     gd-sutun-pos(3),
                     gd-sutun-pos(4),
                     gd-sutun-pos(5),
                     gd-sutun-pos(6),
                     gd-sutun-pos(7),
                     gd-sutun-pos(8),
                     gd-sutun-pos(9),
                     gd-sutun-pos(10),
                     gd-sutun-pos(11),
                     gd-sutun-pos(12),
                     gd-sutun-pos(13),
                     gd-sutun-pos(14),
                     gd-sutun-pos(15),
                     gd-sutun-pos(16),
                     gd-sutun-pos(17),
                     gd-sutun-pos(18),
                     gd-sutun-pos(19),
                     gd-sutun-pos(20) )
     modify Gd-Data,
       display-columns
                    (gd-sutun-boy(1),
                     gd-sutun-boy(2),
                     gd-sutun-boy(3),
                     gd-sutun-boy(4),
                     gd-sutun-boy(5),
                     gd-sutun-boy(6),
                     gd-sutun-boy(7),
                     gd-sutun-boy(8),
                     gd-sutun-boy(9),
                     gd-sutun-boy(10),
                     gd-sutun-boy(11),
                     gd-sutun-boy(12),
                     gd-sutun-boy(13),
                     gd-sutun-boy(14),
                     gd-sutun-boy(15),
                     gd-sutun-boy(16),
                     gd-sutun-boy(17),
                     gd-sutun-boy(18))
*                     gd-sutun-boy(19),
*                     gd-sutun-boy(20) )
      .
*
 gd-konumlan.
      set grid-search-forwards     to true
      set grid-search-wrap         to true
      set grid-search-ignore-case  to false
      set grid-search-match-all    to true
      set grid-search-skip-current to false
      set grid-search-moves-cursor to true
      move 1 to grid-search-column
      modify Gd-Data, ( 1 , 2 )
        search-options = grid-search-options
        search-text    = arama-kelime giving gd-y
      inquire Gd-Data, CURSOR-X in gd-x
                       cursor-y in gd-y
      perform Gd-Data-Parlat
      .
*
*
 Gd-Data-Parlat.
     modify Gd-Data, START-X = 1
                     start-y = gd-y
                     x       = 20
                     y       = gd-y
     modify Gd-Data, region-color = 432
     .
*
 Gd-Data-Ev-Msg-Goto-Cell.
     move event-data-1 to gd-x
     move event-data-2 to gd-y
     perform Gd-Data-Parlat
     .
*
 Gd-Data-Ev-Msg-Goto-Cell-Mouse.
     move event-data-1 to gd-x
     move event-data-2 to gd-y
     perform Gd-Data-Parlat
     .
*
 Gd-Data-Ev-Msg-Begin-Entry.
     inquire Gd-Data, entry-reason in gd-giris
                      cursor-x     in gd-x
                      cursor-y     in gd-y
     if gd-giris = x"00" or gd-giris = x"0D"
        inquire Gd-Data, cursor-y in gd-y
        modify Gd-Data, X = 18, Y = gd-y
        inquire gd-data
          cell-data in fihrist-anahtar
        move event-action-fail to event-action 
        modify gd-data
          cursor-x = gd-x
          cursor-y = gd-y
        Perform detay-goster
     else
        move event-action-fail to event-action
        modify gd-data
          cursor-x = gd-x
          cursor-y = gd-y
     end-if
     .
*
 fihrist-sil.
     inquire Gd-Data, cursor-y in gd-y
     modify Gd-Data, X = 18, Y = gd-y
     inquire gd-data
       cell-data in fihrist-anahtar

     read fihrist record
       key is fihrist-anahtar
       invalid
         continue
       not invalid
         display message box
           fihrist-anahtar new-line
           Fihrist-adi " " fihrist-soyadi new-line new-line
           "Bu Kayit silinsin mi?"
           title   is "Silme Onayi"
           type    is MB-YES-NO
           icon    is MB-WARNING-ICON
           default is MB-NO
           giving  Kayit-onay
         if Kayit-onay = MB-YES
            delete fihrist record
              invalid
                display message box "Abicim ben bu kaydi simdi okudumdu" new-line
                                    "Nereye kayboldu yahuuu bu ??? Bulamiyorum !!!"
              not invalid
                perform arama-combo-Ex-Ntf-Selchange
            end-delete
         end-if
         end-read .
         .
*
 rapor-ver.
                  
        initialize fihrist-rec  veri-var
        start fihrist key > fihrist-anahtar  invalid continue
          not invalid
           perform until fs-fihrist = "10"
            read fihrist next 
              end move "10" to fs-fihrist
              not end
                perform detay-at
             end-read
           end-perform
        end-start
        if veri-var = 1 perform dokumer-kapat end-if.


      .
*
 detay-at.
       if veri-var = 0 then 
          perform dokumer-ac
       end-if
       initialize dokumer-rec detay2
       move fihrist-adi       to det-1
       move fihrist-soyadi    to det-2
       move fihrist-telefon   to det-3
       move fihrist-mobil-tel to det-4
       move fihrist-email     to det-5
       move fihrist-unvani    to det-6 
       move fihrist-adres-1   to det-7 
       move fihrist-il        to det-8 
       move fihrist-ilce      to det-9 
       move fihrist-ulke      to det-10
       move fihrist-adres-3   to det-11
       move fihrist-not       to det-12
       move "|" to fil-1 fil-2 fil-3 fil-4 fil-5 
                   fil-6 fil-7 fil-8 fil-9 fil-10
                   fil-11 fil-12 
       write dokumer-rec from detay2



       .
 dokumer-ac.
        open i-o genelfis
           move 1 to genelfis-anahtar
           read genelfis no lock invalid
              move 1 to print-no
           end-read
           
           add 1 to print-no
           rewrite genelfis-rec invalid
                   write genelfis-rec end-write
           end-rewrite
           close genelfis  . 
       move 1 to veri-var    
              initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya

     set  dokumer-asya-set to true
     move print-no         to dokumer-dosya-adi
     open output dokumer 
     
*/WINDOW TITLE
     initialize dokumer-rec detay2
     move "W"                  to det-dokumer-20(1:)
     move "Fihrist Raporu" to det-filler
     write dokumer-rec from detay2
*/ BASLIKLAR
     initialize dokumer-rec detay2
     move "1"          to det-dokumer-20(10:1)
     move "B"                  to det-dokumer-20(1:1)
     move "Fihrist Raporu" to det-filler
     move "Tarih..:"     to det-filler(41:10)
     move gun-tasi       to det-filler(51:02)
     move "/"            to det-filler(53:01)
     move ay-tasi        to det-filler(54:02)
     move "/"            to det-filler(56:01)
     move yil-tasi       to det-filler(57:04)
     write dokumer-rec from detay2

     
     
     

*/ DOKUMER OZELLIKLER-REC
     initialize dokumer-rec detay2
     move "O" to det-dokumer-20(1:)
     move "E" to dokumer-oto-sayfa-basi
     move 56  to dokumer-oto-sayfa-satir
     move "|" to dokumer-detay-kolon-ayirici
     move "LLLLLLLLLLLLL" to dokumer-align-occ
     move dokumer-ozellikler-rec     to det-filler
     write dokumer-rec from detay2
*/ BASLIKLAR  

     initialize dokumer-rec detay2 
     move "1"                           to det-dokumer-20(10:1)
     move "D1"                          to det-dokumer-20(1:2)     
     move "Adi"                         to det-1 
     move "Soyadi"                      to det-2
     move "Tel"                         to det-3
     move "Mobil-Tel"                   to det-4
     move "E-Mail"                      to det-5
     move "Unvan"                       to det-6
     move "Adres"                       to det-7
     move "Il"                          to det-8
     move "Ilce"                        to det-9
     move "Ulke"                        to det-10
     move "Vergi D."                    to det-11
     move "Vergi N."                    to det-12
     move "|" to fil-1 fil-2 fil-3 fil-4 fil-5
                 fil-6 fil-7 fil-8 fil-9 fil-10 
                 fil-11 fil-12
     write dokumer-rec from detay2
     initialize dokumer-rec detay2
     move "D2"           to det-dokumer-20(1:2)
     move "-"            to det-dokumer-20(5:1)
     move all "-" to det-1 det-2 det-3 det-4 det-5
     move "|" to fil-1 fil-2 fil-3 fil-4 fil-5
                 fil-6 fil-7 fil-8 fil-9 fil-10
                 fil-11 fil-12
     write dokumer-rec from detay2.
     .

     

                 
                 
                .
 dokumer-kapat.
          close dokumer  
              call dokumer-prog on exception
                   perform callerr-proc
              not on exception
                   cancel dokumer-prog
              end-call
              delete file dokumer.


 
