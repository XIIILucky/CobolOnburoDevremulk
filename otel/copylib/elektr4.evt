* elektr4.evt
* elektr4.evt is generated from D:\asya\acugt.ytl\otel\elektr4.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Exception-Proc.
     PERFORM exception-procedure
     .
***   start event editor code   ***
*
 Form1-Bef-Create.   
       perform adresleri-tasi .        
*
 before-procedure.     
             .

 Form1-Aft-Initdata.     
    open input genel
    move 1 to genel-anahtar
    read genel no lock invalid
          initialize mesaj-link
          move 03 to mesaj-no
          perform mesaj-ver
    not invalid
        continue
    end-read
    close genel.

*      
 exception-procedure. 
     evaluate key-status
          when 2 
                 | display message box  "SISTEM KAPANDI"
                 | EXIT PARAGRAPH
               open output trnot
                  perform islem-yap
               close trnot
               display  message box "Islem Bitti"  
         end-evaluate. 

*
 transfer-adres-yukle.
          initialize amontext-dosya-adres fidetext-dosya-adres
          move "/amonra" to amontext-dosya-adres fidetext-dosya-adres
          move "/"       to amontext-dosya-adres(12:1) fidetext-dosya-adres(12:1)
          move "MUKA"    to fidetext-kisa-ad amontext-kisa-ad.
*
 islem-yap.
        if tanim-value  = 1 then
                         
           if ref-no <= 1
              OPEN OUTPUT MUSTERI NT  CLOSE MUSTERI NT  
           end-if
           perform transfer-adres-yukle


           
           move "Fihrist" to tittle-value  display Form1-La-3 
           perform afihrist-al
    
           move "Doviz" to tittle-value  display Form1-La-3 
           perform doviz-al

           move "Kur" to tittle-value  display Form1-La-3 
           perform kur-al
 
         
           
           move "Acenta" to tittle-value  display Form1-La-3 
           perform acenta-al
                
  
        
          move "Konum" to tittle-value  display Form1-La-3 
          perform konum-al 

 

          move "Oda" to tittle-value  display Form1-La-3 
          perform aoda-al 
                   
    
          if prof-alma <> 1
                  move "Guest" to tittle-value  display Form1-La-3 
                  perform fguest-al
        
        
                  move "Profil" to tittle-value  display Form1-La-3 
                  perform profil-al 
          end-if  

          move "Departman" to tittle-value  display Form1-La-3 
          perform adep-al   
       
 
          |**** perform akonum-al   |****
          |****** PERFORM katalog-ver |****
          |******************perform takas-adres-al
               
         move "Pazar Kodlari" to tittle-value  display Form1-La-3 
         perform apazar-AL 

         move "Ulke Kodlari" to tittle-value  display Form1-La-3 
         perform aulke-AL
 
       
          | perform fatura-al
         
*        |*********perform adahili-al
*        |*********perform arezdoviz-al

        end-if
 
              perform transfer-adres-yukle
        
        if rez-value  = 1 then 
                if not-output = 1 
                      open output nt close nt 
                end-if
                if ref-no <= 1
                    open output  konuk ozluk  polisxml froom rez yanrez cast   |**** rez yrez cast  nt
  
                    close  konuk ozluk polisxml  froom  rez yanrez cast   |**** rez yrez cast  nt
                end-if 
              move "Rezervasyon" to tittle-value  display Form1-La-3 
             perform arez-al 
             |DISPLAY MESSAGE BOX PM-SAY " PM VAR "                     
        end-if
       
        if share-iptal = 1
            perform share-iptal
        end-if 


        if cin-value = 1 
            open output frez fextra close frez fextra
            move "Cin" to tittle-value  display Form1-La-3 
            perform cin-yap    
        end-if

        if hrk-value = 1 then 
             move "Hareketler" to tittle-value  display Form1-La-3 
             perform hrk-al
        end-if


        if folyo-duz = 1
              move "Folyoo" to tittle-value  display Form1-La-3 
              perform folyo-duz

        end-if
        if city-ver = 1 then
            perform city-kaldir 

        end-if
 

        if kontrat-al = 1
               move "Kontrat" to tittle-value  display Form1-La-3  
              perform kontrat-al
        end-if
        

        if acen-kontrol = 1
            perform acen-kontrol
        end-if

    

        if eski-folio-al = 1
              continue
******            perform tum-folio-al
        end-if

                || sen beným eksýk kalan yerimsin..   01.05.2013




        if salih2  = 1 then
           continue
**              perform musteri-telefon-al 
        end-if
     

        if rez-kur = 1
             perform rez-kur
        end-if


        if cast-bakim = 1 then            
             move "CAST" to tittle-value  display Form1-La-3 
             perform acast-al
*             call "/asya/ytl/obj/otel/cast2int.asy" using 1
*                on exception
*                    perform callerr-proc
*                 not on exception
*               cancel "/asya/ytl/obj/otel/cast2int.asy"
*             end-call        
            
*             exit paragraph
             |perform castoda-bakim

             
            | perform cast-bakim
            | perform Form1-Pb-2-Link  |departmannn
            | perform cast-ters-cevirip-yan   | pm ayarla
            | perform cast-ters-cevirip-duz | dis konaklama ayarlar
      
        end-if
 

        if mus-duzelt = 1

              perform mus-duzelt
        end-if
        if yan-value = 1 
            perform yan-al
        end-if
        if rez-bakim-yap = 1
              perform rez-bakim
        end-if


        if eb-at = 1
             perform eb-isaretle 
        end-if
        
        if f-bakim = 1 then
              perform fbakim-yap
        end-if
        if fat-al = 1 then
              perform fatura-al
        end-if

       

        if profil-ucur = 1 then
             perform p-ucur
        end-if
        if grup-statu = 1 then
              perform grup-statu
        end-if

        if cast-9050 =  1 then
              perform cast-9050
        end-if


        if cor-duz = 1
              perform corr-duzelt
        end-if
        .

*
 kontrat-al.

    move "kontrat.txt" to fidetext-adi
    move "kontrat2.txt" to amontext-adi
    open input fidetext
    open output amontext frezdoviz fiyatana close  amontext  frezdoviz fiyatana
    open i-o amontext frezdoviz fkonum fiyatana facenta   
 
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
  
     
             
               initialize fkonum-rec
               move amontext-det(2) to fkonum-fide-kodu
               read fkonum no lock invalid 
                    exit perform cycle
               end-read

               initialize facenta-rec
               move amontext-det(1)    to facenta-fide-kodu
               read facenta no lock invalid
                       exit perform cycle
               end-read



         
      
                 

               initialize fiyatana-rec

               move amontext-det(4)(1:4)   to fiyatana-ilk-yil
               move amontext-det(4)(6:2)   to fiyatana-ilk-ay
               move amontext-det(4)(9:2)   to fiyatana-ilk-gun

               move amontext-det(5)(1:4)   to fiyatana-son-yil
               move amontext-det(5)(6:2)   to fiyatana-son-ay
               move amontext-det(5)(9:2)   to fiyatana-son-gun
              
               if fiyatana-son-yil not > 2014 
                     exit perform cycle
               end-if

               move facenta-asya-kodu      to fiyatana-acenta
               move 1                      to fiyatana-rez-tipi
               move "BB"                   to fiyatana-pan-tipi
               move 01                     to fiyatana-banka
               move 02                     to fiyatana-doviz
               move 01                     to fiyatana-anlasma


               move "ASYA"                 to fiyatana-staf
               
               if amontext-det(6) <> "NULL"

                       move 1                      to fiyatana-buyuk
                       move 0                      to fiyatana-kucuk
        
                       read fiyatana no lock invalid
                               continue
                       end-read

                       inspect amontext-det(6) replacing  all "." by ","
                       move function numval-c(amontext-det(6))  to fiyatana-oda-fiyati(fkonum-asya-kodu) 

                       write fiyatana-rec invalid
                            rewrite fiyatana-rec invalid stop " "end-rewrite
                       end-write
               end-if
               if amontext-det(7) <> "NULL"

                       move 2                      to fiyatana-buyuk
                       move 0                      to fiyatana-kucuk

                       read fiyatana no lock invalid
                               continue
                       end-read


                       inspect amontext-det(7) replacing  all "." by ","
                       move function numval-c(amontext-det(7))  to fiyatana-oda-fiyati(fkonum-asya-kodu) 
                 
                       write fiyatana-rec invalid
                              rewrite fiyatana-rec invalid stop " "end-rewrite
                       end-write
               end-if
               if amontext-det(8) <> "NULL"

                       move 3                      to fiyatana-buyuk
                       move 0                      to fiyatana-kucuk

                       read fiyatana no lock invalid
                               continue
                       end-read

                       inspect amontext-det(8) replacing  all "." by ","
                       move function numval-c(amontext-det(8))  to fiyatana-oda-fiyati(fkonum-asya-kodu) 
 
                       write fiyatana-rec invalid
                             rewrite fiyatana-rec invalid stop " "end-rewrite
                       end-write
               end-if
               display fiyatana-rec
     
    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext amontext  fkonum fiyatana  facenta
         .
*
 musteri-telefon-al.
         open i-o musteri musteri2
 
                 initialize musteri-rec  
                 start musteri key not < musteri-anah invalid
                         continue
                 not invalid
                 perform until fs-musteri = "10"
                 read musteri next no lock end move "10" to fs-musteri
                 not end 

          
                           initialize musteri2-rec
                           move m-profil to m2-profil 
                           read musteri2 no lock invalid
                                  continue
                           not invalid
                         
        
                                   if musteri-tel1 = spaces then
                                       move musteri2-tel1 to  musteri-tel1
                                       rewrite musteri-rec invalid
                                               stop " "
                                       end-rewrite
                                   end-if
                        
                                   if musteri-gsm = spaces then
                                       move musteri2-gsm to musteri-gsm
                                   
                                   end-if 
        
                                   move musteri2-b-turu to musteri-b-turu
                                       rewrite musteri-rec invalid
                                               stop " "
                                       end-rewrite
        
                          end-read
                 end-read
                 end-perform
                 end-start
                        
         close musteri musteri2.
 


           
  
* 
 mus-duzelt.
         open i-o yanrez
         open input musteri
          initialize yanrez-rec
           stop " "
          start yanrez key not < yanrez-anah invalid
                  continue
          not invalid
          perform until fs-yanrez = "10"
          read yanrez next no lock end move "10" to fs-yanrez
          not end
                  if yanrez-sirano = 1 then
                            exit perform cycle
                  end-if

                  initialize musteri-rec
                  move yanrez-profil-sirket  to musteri-sirket
                  move yanrez-profil-no      to musteri-no
                  read musteri no lock invalid
                          continue
                  not invalid
                          move musteri-adi    to yanrez-adi
                          move musteri-soyadi to yanrez-soyadi
                          rewrite yanrez-rec invalid
                                  stop " " 
                          end-rewrite
                  end-read

          end-read
          end-perform
          end-start
       close yanrez musteri
         .
*
 cast-9050.
          open i-o cast
               initialize cast-rec  
               move tarih-tasi to cast-tarih
               start cast key not < cast-anah invalid
                       continue
               not invalid
               perform until fs-cast = "10"
               read cast next no lock end move "10" to fs-cast
               not end

                       if cast-tarih >= tarih-tasi and cast-oda-no = 9050 then
                             initialize cast-oda-no
                             move CAST-FIYAT-KONUMU to CAST-ODA-KONUMU
                             rewrite cast-rec invalid
                                     stop " "
                             end-rewrite
                       end-if
                   

               end-read
               end-perform
               end-start

          close cast

         .
*
 grup-statu.
          open i-o gruplar
              initialize gruplar-rec  
               start gruplar key not < gruplar-anahtar invalid
                       continue
               not invalid
               perform until fs-gruplar = "10"
               read gruplar next no lock end move "10" to fs-gruplar
               not end
                       move 4 to gruplar-grup-statu

                       rewrite gruplar-rec end-rewrite

               end-read
               end-perform
               end-start
          close gruplar

         .
*
 p-ucur.

            open i-o rez yanrez konuk
               initialize rez-rec add-grup-kodu
               start rez key not < rez-anah invalid
                       continue
               not invalid
               perform until fs-rez = "10"
               read rez next no lock end move "10" to fs-rez
               not end
                       initialize konuk-rec
                       move REZ-FOLIO to konuk-folio
                       read konuk no lock invalid
                               continue
                       end-read
                      if rez-gir-tar >= tarih-tasi or konuk-durumu = "I" then      

                                   
                                    initialize yanrez-rec
                                    move 1         to yanrez-sirano
                                    move rez-no    to yanrez-rezno
                                    read yanrez no lock invalid 
                                         continue 
                                    not invalid
                                        initialize yanrez-profil-anah  
                                        rewrite yanrez-rec  invalid
                                                continue
                                        end-rewrite
                                     end-read 
          
                                      initialize yanrez-rec
                                    move 2         to yanrez-sirano
                                    move rez-no    to yanrez-rezno
                                    read yanrez no lock invalid 
                                         continue 
                                    not invalid
                                        initialize yanrez-profil-anah  
                                        rewrite yanrez-rec  invalid
                                                continue
                                        end-rewrite
                                     end-read  

                                      initialize yanrez-rec
                                    move 3         to yanrez-sirano
                                    move rez-no    to yanrez-rezno
                                    read yanrez no lock invalid 
                                         continue 
                                    not invalid
                                        initialize yanrez-profil-anah  
                                        rewrite yanrez-rec  invalid
                                                continue
                                        end-rewrite
                                     end-read  

                                      initialize yanrez-rec
                                    move 4         to yanrez-sirano
                                    move rez-no    to yanrez-rezno
                                    read yanrez no lock invalid 
                                         continue 
                                    not invalid
                                        initialize yanrez-profil-anah  
                                        rewrite yanrez-rec  invalid
                                                continue
                                        end-rewrite
                                     end-read  

                                      initialize yanrez-rec
                                    move 5        to yanrez-sirano
                                    move rez-no    to yanrez-rezno
                                    read yanrez no lock invalid 
                                         continue 
                                    not invalid
                                        initialize yanrez-profil-anah  
                                        rewrite yanrez-rec  invalid
                                                continue
                                        end-rewrite
                                     end-read  

                                      initialize yanrez-rec
                                    move 6        to yanrez-sirano
                                    move rez-no    to yanrez-rezno
                                    read yanrez no lock invalid 
                                         continue 
                                    not invalid
                                        initialize yanrez-profil-anah  
                                        rewrite yanrez-rec  invalid
                                                continue
                                        end-rewrite
                                     end-read  
                      end-if             
 
               end-read
               end-perform
               end-start
               
               close rez yanrez konuk.
 

*
 fatura-al.

    move "fatura.txt" to fidetext-adi
    move "fatura2.txt" to amontext-adi
    open input fidetext
    open output amontext  fatura fatdetay close amontext fatura fatdetay   
    open i-o amontext fatura fatdetay
 
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
                
       if function numval(amontext-det(1)) > 0
    
                 initialize fatdetay-rec    
                 move amontext-det(13)(1:4)               to  fatdetay-fat-yil
                 move amontext-det(13)(6:2)               to  fatdetay-fat-ay
                 move amontext-det(13)(9:2)               to  fatdetay-fat-gun
                 move amontext-det(2)                    to  fatdetay-fat-no                     
                 if amontext-det(37) = "AGENCY" then
                      move "A"             to  fatdetay-romhrk-exthrk 
                 else
                      move "F"             to  fatdetay-romhrk-exthrk     
                 end-if  
        
                 inspect amontext-det(25) replacing  all "," by "."
                 move function numval-c(amontext-det(25))  to fatdetay-fatura-toplam 
                
                 if fatdetay-fatura-toplam <= 0
                      exit perform cycle
                 end-if

                 write fatdetay-rec invalid 
                         rewrite fatdetay-rec 
                 end-write
                  
                 initialize fatura-rec
                 move  function numval(amontext-det(2))  to fatura-no
                 MOVE amontext-det(2)                    TO FATURA-ULKE
                 move 0                                   to fatura-sira

                 move amontext-det(13)(1:4)               to fatura-yil
                 move amontext-det(13)(6:2)               to fatura-ay
                 move amontext-det(13)(9:2)               to fatura-gun

                 if amontext-det(37) = "AGENCY" then
                      move "A"             to  fatura-tipi 
                 else                                           
                      move "F"             to  fatura-tipi     
                 end-if

                 move "D"                                to fatura-durumu
                | move function numval(amontext-det(2))   to fatura-folio
                 move amontext-det(6)(1:40)    to fatura-baslik-1 
                 move amontext-det(6)(41:40)   to fatura-baslik-2 

                 move amontext-det(7)          to fatura-adres-1  
                 move amontext-det(8)          to fatura-adres-2 
   
                 move amontext-det(11)         to fatura-ver-da   
                 move amontext-det(12)         to fatura-ver-no 
               |  if amontext-det(3)(1:1)="A" then
               |          move "EFAT:" to fatura-aciklama 
               |          move amontext-det(3)         to fatura-aciklama(6:)  
               |  end-if
               
                     inspect amontext-det(24) replacing   all "," by "."
                 move function numval-c(amontext-det(24))  to fatura-kdv

                     inspect amontext-det(23) replacing   all "," by "."
                 move function numval-c(amontext-det(23))  to fatura-matrah


                 inspect amontext-det(25) replacing  all "," by "."
                 move function numval-c(amontext-det(25))  to fatura-toplam  fatura-g-toplam

                 inspect fatura-baslik-1 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                 to x"8DA69A9E989980879FA7818D94"
                 inspect fatura-baslik-2 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                 to x"8DA69A9E989980879FA7818D94"
                 inspect fatura-adres-1 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                 to x"8DA69A9E989980879FA7818D94"
                 inspect fatura-adres-2 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                 to x"8DA69A9E989980879FA7818D94"
                 inspect fatura-aciklama converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                 to x"8DA69A9E989980879FA7818D94"

                 inspect fatura-ver-da converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                 to x"8DA69A9E989980879FA7818D94"

                 |modify lbl-for , title = fatura-rec
                 write fatura-rec invalid 
                       rewrite fatura-rec end-rewrite
                 end-write
                 display fatura-rec
 
       end-if
    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext amontext   fatura fatdetay



         .
*
 fbakim-yap.

         open i-o rez konuk
         initialize rez-rec  
         start rez key not < rez-anah invalid
                 continue
         not invalid
         perform until fs-rez = "10" 
         read rez next no lock end move "10" to fs-rez
         not end
                    if rez-odano <> 9050 then
                          exit perform cycle
                    end-if
                  
                    initialize konuk-rec
                    move rez-folio to konuk-folio
                    read konuk no lock invalid
                            continue
                    not invalid


                           initialize KONUK-rez-no  

                           rewrite konuk-rec invalid
                                  stop " "
                           end-rewrite

                           
                          
                    end-read

                     initialize rez-folio
                     move "H" to rez-c-in
                     rewrite rez-rec invalid
                             stop " "
                      end-rewrite


         end-read
         end-perform
         end-start
         close rez konuk


         .
*
 eb-isaretle.

    move "eb.txt" to fidetext-adi
    move "eb2.txt" to amontext-adi
    open input fidetext
    open output amontext  close amontext    
    open i-o amontext rez  konuk
 
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 5
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
  
     if function numval(amontext-det(1)) > 0
 


         if amontext-det(4) not = "EB" then
             exit perform cycle
         end-if

         initialize rez-rec
         move  function numval(amontext-det(2))  to rez-no
         read rez no lock invalid
                 continue
         not invalid
               move "E" to REZ-EB
               rewrite rez-rec  invalid
                       stop " "
               end-rewrite

               initialize konuk-rec
               move rez-folio to konuk-folio
               read konuk no lock invalid
                       continue
               not invalid
                   move "E" to KONUK-EB
                    rewrite konuk-rec  invalid
                       stop " "
                    end-rewrite
               end-read

         end-read

    end-if
    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext amontext rez  konuk.
*
 castoda-bakim.
        
     open i-o cast rez odalar konuk kur
         initialize cast-rec
         start cast key not < cast-anah invalid
                 continue
         not invalid
         perform until fs-cast = "10" 
         read cast next no lock end move "10" to fs-cast
         not end

              initialize rez-rec
              move cast-rez-no to rez-no
              read rez no lock invalid
                      exit perform cycle
              end-read


                     move rez-kisi to cast-kisi
                     move rez-FIYATI to CAST-FIYATI
          
                         initialize kur-rec
                          move rez-gir-tar to kur-tarih
                          move rez-doviz   to KUR-DOVIZ
                          move 01       to kur-banka
                          read kur no lock invalid
                                 exit perform cycle
                          end-read
                     
                     move DOVIZ-alis    to REZ-CIN-KURU
                     move "H"           to rez-fiyat-fix

                           |move 1  to rez-plan

                      if cast-tarih = rez-cik-tar 
                          initialize CAST-FIYATI  CAST-ANLASMA-FIYATI CAST-BASILAN-FIYAT         
                       end-if
  

                           initialize odalar-rec
                           move rez-odano to odalar-no
                           read odalar no lock invalid
                                   move rez-oda-konumu to cast-oda-konumu     
                           not invalid
                                   move odalar-konumu to rez-oda-konumu cast-oda-konumu     
                           end-read                           
                         

                           initialize konuk-rec
                               move rez-folio to konuk-folio
                               read konuk no lock invalid
                                       continue

                               not invalid

                                   MOVE REZ-CIN-KURU TO konuk-kur-degeri
                                   move rez-fiyati          to konuk-dv-degeri
                                   compute konuk-oda-tutar  rounded = REZ-FIYATI * konuk-kur-degeri 

                                   move rez-oda-konumu to konuk-oda-konumu |konuk-fiyat-konumu
                                   move rez-odano     to konuk-odano
                                   MOVE rez-doviz TO KONUK-DOVIZ

                                   rewrite konuk-rec invalid
                                           stop " " 
                                   end-rewrite
                               end-read
                    
                      rewrite cast-rec invalid
                               stop " "
                      end-rewrite
                      display cast-rec
                      
                      rewrite rez-rec invalid
                            stop " "
                      end-rewrite
                                       
         end-read
         end-perform
         end-start
     close cast rez odalar konuk kur.

* 
 cast-ters-cevirip-duz.
               
    move "diskonak.txt" to fidetext-adi
    move "diskonak2.txt" to amontext-adi
    open input fidetext
    open output amontext     close  amontext     
    open i-o amontext    
  
 
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 10
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
           
       
             if function numval(amontext-det(1)) > 0  
                 if function numval(amontext-det(6)) <> 1
                   open i-o cast
                     initialize cast-rec
                   |  if ref-no <> 0
                   |         compute deger-8 =   function numval(amontext-det(2)) + ( ref-no * 1000000 ) 
                   |         move deger-8 to cast-rez-no  
                   |  end-if

                     move amontext-det(3)(1:4)               to cast-yil
                     move amontext-det(3)(6:2)               to cast-ay
                     move amontext-det(3)(9:2)               to cast-gun
  
                     read cast no lock invalid
                              continue
                     not invalid

                               if function numval(cast-bos9(1:1)) = 1 then
               
                                   compute deger-4 = 9902 + ( ref-no * 10 )  
                                   move    deger-4 to cast-oda-no
                               else
                                   compute deger-4 = 9901 + ( ref-no * 10 )  
                                   move    deger-4 to cast-oda-no
                               end-if
                              
                               initialize cast-bos9
                               rewrite cast-rec invalid
                                       stop " "
                               end-rewrite
                     end-read
        
                     close cast
                  end-if
             end-if
 
    end-read
    end-perform
    close fidetext amontext   
         .

* 
 cast-ters-cevirip-yan.
               
    move "pm.txt" to fidetext-adi
    move "pm2.txt" to amontext-adi
    open input fidetext
    open output amontext     close  amontext     
    open i-o amontext    
  
          open i-o cast rez konuk
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 10
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
           
   

             if function numval(amontext-det(1)) > 0  
 
                   if amontext-det(4) = "NotPM" then
                         exit perform cycle
                   end-if

              
                     initialize cast-rec
                   |  if ref-no <> 0
                   |         compute deger-8 =   function numval(amontext-det(3)) + ( ref-no * 1000000 ) 
                   |         move deger-8 to cast-rez-no  
                   |  end-if
                    
                     initialize rez-rec
                     move cast-rez-no to rez-no
                     read rez no lock invalid
                             exit perform cycle
                     not invalid
                             if rez-odano <> amontext-det(1)
                                   exit perform cycle
                             end-if
                     end-read
                     move amontext-det(2)(1:4)               to cast-yil
                     move amontext-det(2)(6:2)               to cast-ay
                     move amontext-det(2)(9:2)               to cast-gun
  
                     read cast no lock invalid
                              continue
                     not invalid
                               compute deger-4 = 9900 + ( ref-no * 10 )  
                               move    deger-4 to cast-oda-no

                               move 1 to cast-bos9(1:1)  | pm oda
                               rewrite cast-rec invalid
                                       stop " "
                               end-rewrite
                     end-read

                  
 
             end-if
 
    end-read
    end-perform
    close fidetext amontext  
       close cast rez konuk
         .
*
 cast-bakim.
        |  if salih = 1 then stop " " end-if
          open i-o fcast cast  rez konuk kur odalar
         initialize fcast-rec
         start fcast key not < fcast-anah invalid

                 continue
         not invalid
         perform until fs-fcast = "10" 
         read fcast next no lock end move "10" to fs-fcast
         not end
       
                 initialize cast-rec
                 move fcast-anah to cast-anah
                 read cast no lock invalid
                        continue
                 not invalid
      
                      move cast-rez-no to rez-no
                      read rez no lock invalid        
                              continue
                      not invalid

                           if rez-gir-tar = cast-tarih and rez-folio = zeroes then
                               move CAST-FIYATI to rez-fiyati  rez-ucreti
                           end-if

                           if rez-cik-tar = cast-tarih then
                               move CAST-FIYATI to rez-fiyati  rez-ucreti
                           end-if

                           if tarih-tasi = cast-tarih and rez-folio not = zeroes then
                               move CAST-FIYATI to rez-fiyati  rez-ucreti
                           end-if

                            if CAST-FIYATI <> rez-fiyati and rez-fiyati <> zeroes 
                                |   move 1 to rez-plan
                                        continue
                            end-if

                            move rez-kisi to cast-kisi
                            | move fcast-pax   to CAST-BUYUK
                            | move fcast-kucuk to cast-kucuk
                            | move fcast-free  to cast-free
                            | move fcast-board to CAST-PAN-TIPI
                            | move fcast-bebek to cast-bebek
                             move fCAST-FIYATI to CAST-FIYATI

                    
                            move fCAST-FIYATI to rez-fiyati
                            move fcast-doviz  to rez-doviz

                              initialize kur-rec
                                 move rez-gir-tar to kur-tarih
                                 move rez-doviz   to KUR-DOVIZ
                                 move 01       to kur-banka
                                 read kur no lock invalid
                                        stop " " 
                                 end-read
                        
                            move DOVIZ-alis    to REZ-CIN-KURU
                            move "H"          to rez-fiyat-fix

                           |move 1  to rez-plan

  

                            initialize odalar-rec
                           move rez-odano to odalar-no
                           read odalar no lock invalid
                                   move rez-oda-konumu to cast-oda-konumu     
                           not invalid
                                   move odalar-konumu to rez-oda-konumu cast-oda-konumu     
                           end-read                           
                         
                           MOVE rez-odano TO cast-oda-no 

                           rewrite rez-rec invalid
                                   stop " " 
                           end-rewrite


                           initialize konuk-rec
                               move rez-folio to konuk-folio
                               read konuk no lock invalid
                                       continue

                               not invalid

                                   if CAST-FIYATI <> rez-fiyati and rez-fiyati <> zeroes 
                                       |    move 1 to konuk-plan
                                               continue
                                   end-if

                                   MOVE REZ-CIN-KURU TO konuk-kur-degeri
                                   move rez-fiyati          to konuk-dv-degeri
                                   compute konuk-oda-tutar  rounded = REZ-FIYATI * konuk-kur-degeri 
                                   |move 1 to konuk-plan

                                   move rez-oda-konumu to konuk-oda-konumu |konuk-fiyat-konumu
                                   move rez-odano     to konuk-odano
                                   MOVE rez-doviz TO KONUK-DOVIZ
                              

                                   rewrite konuk-rec invalid
                                           stop " " 
                                   end-rewrite
                               end-read

                      end-read

                      rewrite cast-rec invalid
                               stop " "
                      end-rewrite
                      display cast-rec

                 end-read
         end-read
         end-perform
         end-start
         close  fcast cast rez  konuk kur   odalar
 
         .
*
 tarih-ayir.
    if lck = 2 stop " " end-if
    unstring tarih-ent-xiii delimited by " "
        into tarih-ent-xiii-t
             tarih-ent-xiii-s
    end-unstring
    initialize gun-ay-yil gun-dot ay-dot yil-dot
    perform varying xiii from 1 by 1 until xiii > 10
    if tarih-ent-xiii-t(xiii:1) = "." and gun-ay-yil = 1
       compute ay-dot = xiii - 1
       move tarih-ent-xiii-t(1:ay-dot) to cast-ay
       move 2 to gun-ay-yil
    end-if
    if gun-ay-yil = 2
       compute yil-dot = xiii + 1
       move tarih-ent-xiii-t(yil-dot:4) to cast-yil
       exit perform 
    end-if
    if tarih-ent-xiii-t(xiii:1) = "." and gun-ay-yil = 0
       compute gun-dot = xiii - 1
       move tarih-ent-xiii-t(1:gun-dot) to cast-gun
       move 1 to gun-ay-yil
    end-if
    end-perform           
         .

*
 acast-al.
    move "cast.txt" to fidetext-adi
    move "cast2.txt" to amontext-adi
    open input fidetext
    open output amontext fcast   close  amontext fcast  
 

    open i-o amontext cast fcast fdoviz konum  rez 
 
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
    if function numval (amontext-det(1)) > 0
       initialize cast-rec konum-rec
       move amontext-det(5)      to tarih-ent-xiii        
       perform tarih-ayir
       move function numval(amontext-det(2))        to cast-rez-no
       read cast no lock invalid
            continue
       not invalid
           move amontext-det(31)                    to cast-oda-no
           if amontext-det(31)(1:1) = "T"
               move 9999 to cast-oda-no
           end-if 
****            if cast-rez-no = 111081 stop " " end-if 
           initialize rez-rec 
           move cast-rez-no  to rez-no
           read rez no lock invalid 
               continue 
           end-read 
           
           move function numval(amontext-det(8))    to cast-buyuk
           move function numval(amontext-det(9))    to cast-kucuk
           move function numval(amontext-det(11))   to cast-bebek
           move function numval(amontext-det(10))   to cast-free
           inspect amontext-det(15) replacing all "." by ","
           move function numval-c(amontext-det(15)) to cast-fiyati
                                                
           if function numval (amontext-det(7)) = 0 
              if cast-tarih not = rez-cik-tar
                  initialize cast-buyuk cast-kucuk cast-bebek cast-free
                  move 1 to cast-share
              end-if
           else
              if cast-tarih = rez-cik-tar 
                  move rez-buyuk to cast-buyuk
                  move rez-kucuk to cast-kucuk
                  move rez-free  to cast-free
                  move rez-bebek to cast-bebek
                  move 0 to cast-share               
              end-if 
           end-if                                
           if cast-tarih = rez-cik-tar
              move rez-kisi to cast-kisi
           end-if 
           write cast-rec invalid
             rewrite cast-rec end-rewrite
           end-write
       end-read
    end-if
    end-read
    end-perform
    close fidetext amontext cast rez fcast fdoviz konum


         .
*
 rez-bakim.
         move 100000 to rez-oto
         open i-o rez yanrez genelfis  musteri polisxml
         initialize rez-rec  donus-sayisi toplam-rez
         start rez key not < rez-anah invalid
                 continue
         not invalid
         perform until fs-rez = "10" 
         read rez next no lock end move "10" to fs-rez
         not end
                if function numval(rez-title) not = zeroes then
                    move function numval(rez-title) to donus-sayisi
                    initialize rez-title
                    rewrite rez-rec invalid 
                              if debug = 1 then stop " " end-if 
                    end-rewrite 
                    
                    if rez-gir-tar <= tarih-tasi then
                         exit perform cycle
                    end-if

                    perform rez-cogalt 
                end-if
         end-read
         end-perform
         end-start
         close rez yanrez  genelfis musteri polisxml
 
         display message box "toplam cogaltilan rez :" toplam-rez
         .
*
 rez-cogalt.
               
               perform varying i from 2 by 1 until i >  donus-sayisi
                 |     move 1 to genelfis-anahtar
                |      read genelfis invalid
                 |             continue
                 |     not invalid
                          add 1 to REZ-OTO
*                          rewrite genelfis-rec invalid stop " "
*                          end-rewrite
                 |     end-read

                      move rez-oto to rez-no


                     initialize yanrez-rec  
                     move rez-no                to yanrez-rezno
                     |move rez-profil-no         to yanrez-profil-no
                     |move rez-profil-sirket     to yanrez-profil-sirket
        
                     move rez-adi    to yanrez-ADI
                     move rez-soyadi to yanrez-soyadi

                     initialize rez-odano
                    add 1 to toplam-rez
 
                    write rez-rec invalid 
                              if debug = 1 then stop " " end-if 
                    end-write 

                    write YANREZ-rec invalid 
                              if debug = 1 then stop " " end-if 
                    end-write 
                    perform polisxml-at
 
                  
                 end-perform
        .
*
 kur-al.

    move "kur.txt" to fidetext-adi
    move "kur2.txt" to amontext-adi
    open input fidetext
    open output amontext kur  close  amontext kur  
    open i-o amontext kur fdoviz   
 
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
    
     if amontext-det(3) not =  spaces
         
        initialize kur-rec fdoviz-rec
 
        move function numval(amontext-det(2)(1:4)) to KUR-yil
        move function numval(amontext-det(2)(6:2)) to kur-ay
        move function numval(amontext-det(2)(9:2)) to KUR-gun
 
        move 01               to kur-banka
        call "c$justify" using amontext-det(3) ,"L"
        move amontext-det(3)  to fdoviz-fide-kodu
        read fdoviz no lock invalid
              exit perform cycle
        not invalid 
            move fdoviz-asya-kodu  to KUR-DOVIZ 
        end-read 
 
**        inspect amontext-det(5) replacing  all "," by "."
                      inspect amontext-det(5) replacing all "." by "#"
                      inspect amontext-det(5) replacing all "," by "."
                      inspect amontext-det(5) replacing all "#" by ","

        move function numval-c(amontext-det(5))  to DOVIZ-alis
 

        if KUR-DOVIZ = 10   then
              move 1 to DOVIZ-alis 
        end-if
 
     
       write kur-rec invalid
          rewrite kur-rec invalid
               stop " "
          end-rewrite  
       end-write



     
        move 01 to kur-banka
        move 10  to  KUR-DOVIZ 
        move 1  to DOVIZ-alis 
         
        write kur-rec invalid
          rewrite kur-rec invalid
               stop " "
          end-rewrite  
       end-write
 

*        move 02 to kur-banka
*        move fdoviz-asya-kodu  to KUR-DOVIZ 
*
*        inspect amontext-det(4) replacing  all "." by ","
*        move function numval-c(amontext-det(4))  to DOVIZ-alis
* 
*
*        if KUR-DOVIZ = 2  or KUR-DOVIZ = 7  then
*              move 1 to DOVIZ-alis 
*        end-if
* 
*        write kur-rec invalid
*          rewrite kur-rec invalid
*               stop " "
*          end-rewrite  
*        end-write

    end-if
    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext amontext  kur fdoviz

         .
*
 takas-adres-al.

    move "tadres.txt" to fidetext-adi
    move "tadres2.txt" to amontext-adi
    open input fidetext

    open output tadres close tadres

    open output amontext 
    close  amontext  
    open i-o amontext tadres    
 
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
  
     if function numval(amontext-det(1)) > 0
 
            initialize tadres-rec
            move  function numval(amontext-det(1)) to tadres-id
            move  amontext-det(2)                  to tadres-ulke
            move  amontext-det(3)                  to tadres-il
            move  amontext-det(4)                  to tadres-ilce
            move  amontext-det(5)                  to tadres-postakodu
            move  amontext-det(6)                  to tadres-adres
            move  amontext-det(7)                  to tadres-vergidairesi
            move  amontext-det(8)                  to tadres-vergino
            move  amontext-det(9)                  to tadres-tel
            move  amontext-det(10)                  to tadres-fax
            move  amontext-det(11)                  to tadres-cep
 
            write tadres-rec invalid
                    continue
            end-write

    end-if
 
    end-read
    end-perform
    close fidetext amontext  tadres.

*
 arezdoviz-al.

    move "rezdoviz.txt" to fidetext-adi
    move "rezdoviz2.txt" to amontext-adi
    open input fidetext
    open output amontext frezdoviz close  amontext  frezdoviz
    open i-o amontext frezdoviz    
 
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
  
     if function numval(amontext-det(1)) > 0
 
            initialize frezdoviz-rec
            move  function numval(amontext-det(1)) to frezdoviz-rez-no
            move  amontext-det(2)                  to frezdoviz-fide-doviz
            inspect amontext-det(3) replacing  all "." by ","
            move  function numval-c(amontext-det(3))                  to frezdoviz-folio-kur
            write frezdoviz-rec invalid
                    continue
            end-write

    end-if
    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext amontext  frezdoviz

         .

* 
 adahili-al.

    move "PNUMBER.txt" to fidetext-adi
    move "PNUMBER2.txt" to amontext-adi
    open input fidetext
    open output amontext telkod close  amontext  telkod
    open i-o telkod amontext  
 
    perform until fs-fidetext = "10"
     initialize fidetext-rec   fiihrist-ID 
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
  
     if function numval(amontext-det(1)) > 0
 
            initialize telkod-rec
            move amontext-det(2)  to TEL-ODA
            if function numval(amontext-det(7)) = 1 then 
                  move "M" to TEL-TIPI
            end-if
             if function numval(amontext-det(7)) = 2 then 
                  move "D" to TEL-TIPI
            end-if
            
            move amontext-det(3)   to TEL-ONB-ODA
            move amontext-det(4)   to TEL-ADI  
 
            if function numval (amontext-det(5)) not = 1 then
                    move amontext-det(5)   to TEL-INDIRIM   
            end-if

 
            write telkod-rec invalid
                    stop " "
            end-write

    end-if
    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext amontext  telkod.
 

* 
 afihrist-al.

    move "fihrist.txt" to fidetext-adi
    move "fihrist2.txt" to amontext-adi
    open input fidetext
    open output amontext fihrist close  amontext fihrist  
    open i-o fihrist amontext  
    initialize fiihrist-ID
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
  
     if function numval(amontext-det(1)) > 0

            add 1 to fiihrist-ID
            initialize fihrist-rec
            move fiihrist-ID to FIHRIST-NO 
         
            if amontext-det(2) <> "NULL"
                    move amontext-det(2)      to fihrist-adi
                    move amontext-det(2)   to FIHRIST-SOYADI
            end-if
            if amontext-det(28) <> "NULL"
                 move amontext-det(28)       to FIHRIST-UNVANI 
            END-if
            if amontext-det(10) <> "NULL"
                   move amontext-det(10)       to FIHRIST-ADRES-1
            end-if
            if amontext-det(11) <> "NULL"
                   move amontext-det(11)       to FIHRIST-ADRES-2
            end-if
            if amontext-det(16) <> "NULL"
                   move amontext-det(16)       to FIHRIST-TELEFON
            end-if
            if amontext-det(21) <> "NULL"
                    move amontext-det(21)      to FIHRIST-MOBIL-TEL  
            end-if
            if amontext-det(15) <> "NULL"
                    move amontext-det(15)      to FIHRIST-INTERNET-ADRES
            end-if 
            if amontext-det(19) <> "NULL"
                    move amontext-det(19)      to FIHRIST-FAX 
            end-if          
 
            inspect FIHRIST-ADI    converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
               to x"8DA69A9E989980879FA7818D94"
            inspect FIHRIST-SOYADI converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
               to x"8DA69A9E989980879FA7818D94"

            inspect FIHRIST-ADRES-1    converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
               to x"8DA69A9E989980879FA7818D94"
            inspect FIHRIST-ADRES-2 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
               to x"8DA69A9E989980879FA7818D94"
 
            write fihrist-rec invalid
                    stop " "
            end-write

    end-if
    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext amontext  fihrist


         .
*
 fguest-al.
 
    move "guestres.txt" to fidetext-adi
    move "guestres2.txt" to amontext-adi
    open input fidetext
    open output amontext  fguest
     close  amontext   fguest
     open i-o fGuest amontext  
 

    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
  
     if function numval(amontext-det(1)) > 0  
            initialize fguest-rec
            move function numval(amontext-det(2)) to fguest-ID
            move function numval(amontext-det(3)) to Fguest-rezno
           
            if amontext-det(4) <> "NULL" then
                 move function numval(amontext-det(4)) to fguest-guestid
            end-if

            move amontext-det(17) to fguest-guestadi
            move amontext-det(18) to fguest-guestsoyadi

            
            inspect fguest-guestadi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94"
            call "c$toupper" using fguest-guestadi value 100

            inspect fguest-guestsoyadi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94"
            call "c$toupper" using fguest-guestsoyadi value 100


            write fguest-rec invalid
                   CONTINUE
            end-write

    end-if
    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext amontext fguest

         .
*
 apazar-al.

    move "market.txt" to fidetext-adi
    move "market2.txt" to amontext-adi
    open input fidetext
    open output amontext fpazar  
     close     fpazar   
     open i-o kodlar02 fpazar ulke
     initialize kodlar02-rec  pazar-add ulke-add ydk-pazar-ad


             initialize kodlar02-rec
             start kodlar02 key not < kodlar02-anah invalid
                     continue
             not invalid
             perform until fs-kodlar02 = "10"
             read kodlar02 next no lock end move "10" to fs-kodlar02
             not end
                     if kodlar02-tipi = "E" then
                           delete kodlar02 end-delete
                     end-if
             end-read
             end-perform
             end-start

    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
  
     if function numval(amontext-det(1)) > 0  
            
                    initialize kodlar02-rec
                    move "E"                                 to kodlar02-tipi
                    move function numval(amontext-det(1))    to deger-2
                    move deger-2                             to kodlar02-kodu
                    move amontext-det(2)                     to kodlar02-adi
                     inspect kodlar02-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                           to x"8DA69A9E989980879FA7818D94"

                    write kodlar02-rec invalid 
                        rewrite kodlar02-rec end-rewrite
                    end-write 

    end-if
    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext close amontext kodlar02 fpazar ulke .

         .

*
 aulke-al.
           
    move "uyruk.txt" to fidetext-adi
    move "uyruk2.txt" to amontext-adi
    open input fidetext

    open output fulke ulke close fulke ulke
    open i-o fulke close fulke
    open output amontext  

    open i-o ulke fulke
    initialize ulke-rec

    perform until fs-fidetext = "10"
     initialize fidetext-rec   pazar-add 
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
  
     if amontext-det(1) <> SPACES
 
            add 1 to ulke-add
            initialize ulke-rec fulke-rec
            move ulke-add                            to ULKE-ANAH1
            move amontext-det(2)                     to ULKE-ADI
 
 
            move amontext-det(1)  to fulke-FIDE-KODU
            move ULKE-ANAH1       to fulke-asya-KODU

           inspect ULKE-ADI converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                       to x"8DA69A9E989980879FA7818D94"


            write ulke-rec invalid
                    stop " "
            end-write 

            write fulke-rec invalid    
                    if debug = 1 then stop " " end-if 
            end-write  
      
    end-if
    write amontext-rec end-write
    end-read
    end-perform
    close fidetext 
    close amontext ulke fulke.

         . 
*
 Aoda-Al.
    move "oda.txt"  to fidetext-adi
    move "oda2.txt" to amontext-adi
    open input fidetext
    open output amontext  
  

     open output odalar  close odalar 

     open i-o odalar fkonum 
     initialize odalar-rec
*     read fidetext next no lock
*    end continue
*    end-read
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform      
         
     if function numval(amontext-det(1)) > 0
       
       initialize odalar-rec

       call "c$justify" using amontext-det(1),"L"
 
       move amontext-det(2) to odalar-anah

       initialize fkonum-rec
       move amontext-det(3) to fkonum-fide-kodu
       read fkonum no lock invalid 
            if debug = 1 then stop " " end-if
       end-read

       move fkonum-asya-kodu to odalar-konumu

      | move amontext-det(3)  to odalar-tipi
*       move amontext-det(4)  to house-durumu odalar-durumu
 
        move amontext-det(7) to odalar-kat

        move function numval(amontext-det(9)) to  odalar-kapasite

        move "VR" to house-durumu odalar-durumu

        move "G" to odalar-hayali
        if function numval(amontext-det(21)) = 1 then
             |move "E" to ODALAR-HAYALI
             continue
        end-if

        |move "00" to ODALAR-KAT
        |move amontext-det(2) to ODALAR-KAT(2:1)

     
       write odalar-rec invalid
               ||hayali odalarda olacagýna goreeeeeeeeee 
               stop " "

       end-write 
       initialize odalar-rec
       move 9999 to odalar-anah
       move "E" to ODALAR-HAYALI
       write odalar-rec invalid
             continue
       end-write
             
     end-if
    write amontext-rec end-write
    end-read
    end-perform
    close fidetext close amontext odalar fkonum.
*
 acenta-al.
    initialize  ydk-acenta
    move 9000000       to ydk-firma-prof ydk-acenta-prof
    move "acenta.txt"  to fidetext-adi
    move "acenta2.txt" to amontext-adi
    open input fidetext

     open output amontext
     if ref-no <= 1 
            open output firma acenta   
            close acenta  firma  
     end-if
     move 9000 to ydk-acenta
     open output facenta close facenta
     open i-o acenta  nt facenta  fdoviz musteri firma
     initialize acenta-rec
*     read fidetext next no lock
*    end continue
*    end-read
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform                      
     if amontext-det(1) not = spaces
            
                     
                  initialize acenta-rec FACENTA-REC
                  add 1                                         to ydk-acenta ydk-acenta-prof 
                  move ydk-acenta                               to acenta-kodu  


                  initialize not-rec 
                  move "ACE"       to not-dos
                  move "Default"   to not-dos-anah
                  move acenta-kodu to not-dos-anah(8:)
                  move "01"        to acen-dft-banka


                  initialize fdoviz-rec
                  move amontext-det(19) to fdoviz-fide-kodu 
                  read fdoviz no lock invalid
                           move  02         to acen-dft-doviz
                  not invalid
                           move  fdoviz-asya-kodu         to acen-dft-doviz  
                  end-read
            
                  |move  01         to acen-dft-BANKA

                  move "BB"        to acen-dft-pan-tipi

                  move "01"        to acen-dft-odeme-tipi
                  if amontext-det(22) ="GUEST" then
                        move "01"        to acen-dft-odeme-tipi
                  end-if
                  if amontext-det(22) ="AGENCY" then
                        move "02"        to acen-dft-odeme-tipi


                  end-if

       
                  
                  move "01"        to acen-dft-anlasma
                  move "01"        to acen-dft-pazar

                  move "006"       to acen-dft-ulke
                 
                  move acen-dft    to not1
                  write not-rec invalid 
                       rewrite not-rec invalid continue
                       end-rewrite 
                  end-write        


          
               move amontext-det(3)                          to acenta-adi
               move amontext-det(4)                          to acenta-unvani

               call "c$justify" using acenta-adi ,"L"



               inspect acenta-adi converting  x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94" 
               inspect acenta-adi converting  x"989E999A80A6A78D81879F94" to x"49534F55434767697563736F"
                      call "c$toupper" using acenta-adi value 100
        
               inspect acenta-unvani converting  x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94" 
               inspect acenta-unvani converting x"989E999A80A6A78D81879F94" to x"49534F55434767697563736F"
                      call "c$toupper" using acenta-unvani value 100
        
               move amontext-det(1)                    to facenta-fide-kodu
               move acenta-kodu                         to facenta-asya-kodu


       
               initialize musteri-rec 
               move ydk-acenta-prof                     to musteri-no
               move isyeri-adres-tasi                   to musteri-sirket
               read musteri no lock invalid
                   
                    move acenta-unvani                  to musteri-unvan1
                    move acenta-adi                     to musteri-adi musteri-soyadi

              if amontext-det(5) <> "NULL"
                            move amontext-det(5)               to musteri-adres1
                       inspect musteri-adres1 converting  x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94" 
                       inspect musteri-adres1 converting x"989E999A80A6A78D81879F94" to x"49534F55434767697563736F"
                              call "c$toupper" using musteri-adres1 value 80
              end-if

              if amontext-det(6) <> "NULL"
                            move amontext-det(6)               to musteri-adres2
                       inspect musteri-adres2 converting  x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94" 
                       inspect musteri-adres2 converting x"989E999A80A6A78D81879F94" to x"49534F55434767697563736F"
                              call "c$toupper" using musteri-adres2 value 80
        
              end-if

             if  amontext-det(73) <> "NULL"
                    move amontext-det(73)                to musteri-il
               inspect musteri-il converting  x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94" 
               inspect musteri-il converting x"989E999A80A6A78D81879F94" to x"49534F55434767697563736F"
                      call "c$toupper" using musteri-il value 50
              end-if

              if  amontext-det(74) <> "NULL"
                    move amontext-det(74)                to musteri-il
               inspect musteri-il converting  x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94" 
               inspect musteri-il converting x"989E999A80A6A78D81879F94" to x"49534F55434767697563736F"
                      call "c$toupper" using musteri-il value 50
              end-if

              if amontext-det(17) <> "NULL"
                    move amontext-det(17)                to musteri-e-mail
               inspect musteri-e-mail converting  x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94" 
               inspect musteri-e-mail converting x"989E999A80A6A78D81879F94" to x"49534F55434767697563736F"
                      call "c$toupper" using musteri-e-mail value 100

              end-if

              if amontext-det(14) <> "NULL"
                  move amontext-det(12)               to musteri-tel1
              end-if
              if amontext-det(15) <> "NULL"
                  move amontext-det(13)               to musteri-tel2
              end-if
              if amontext-det(16) <> "NULL"
                   move amontext-det(14)               to musteri-fax
              end-if

                    
                 
                 
               if amontext-det(12) <> "NULL"
                       move amontext-det(12)               to musteri-arac-model |kontakt
                       inspect musteri-arac-model converting  x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94" 
                       inspect musteri-arac-model converting x"989E999A80A6A78D81879F94" to x"49534F55434767697563736F"
                              call "c$toupper" using musteri-arac-model value 100
                end-if

               if amontext-det(10) <> "NULL"
                       move amontext-det(10)               to musteri-vdairesi
                       inspect musteri-vdairesi converting  x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94" 
                       inspect musteri-vdairesi converting x"989E999A80A6A78D81879F94" to x"49534F55434767697563736F"
                              call "c$toupper" using musteri-vdairesi value 100
                end-if

               if amontext-det(11) <> "NULL"
                       move amontext-det(11)               to musteri-vno 
              end-if

            |   if amontext-det(31) <> "NULL"
            |       move amontext-det(31)              to musteri-aciklama
            |  end-if


              
                  
               inspect musteri-aciklama converting  x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94" 
               inspect musteri-aciklama converting x"989E999A80A6A78D81879F94" to x"49534F55434767697563736F"
                      call "c$toupper" using musteri-aciklama value 100


               |     move amontext-det(23)   to acenta-muhno musteri-muhasebe-kodu
                    write musteri-rec invalid 
                       if debug = 1 stop " " end-if                          
                    end-write 
                    move musteri-no     to acenta-profil-no
                    move musteri-sirket to acenta-profil-sirket
               end-read
 

                  write acenta-rec invalid 
                               if debug = 1 stop " " end-if 
                  end-write 
    

                |  write acenta-rec invalid 
                |                if debug = 1 stop " " end-if     orjinali bu satirrlar
                |  end-write 
          
             |  if  not ( amontext-det(23) = "FÝRMALAR" or  "NULL" ) then
             |          write acenta-rec invalid 
             |                   if debug = 1 stop " " end-if 
            |          end-write   
             |
             |  else
                  
             if 1 = 2            
                          initialize not-rec 
                          move "FIR"       to not-dos
                          move "Default"   to not-dos-anah
                          move acenta-kodu to not-dos-anah(8:)
                          move "01"        to acen-dft-banka
                          initialize fdoviz-rec 
                          move amontext-det(39)  to fdoviz-fide-kodu
                          read fdoviz no lock invalid 
                              move 01   to  acen-dft-doviz
                          not invalid 
                              move fdoviz-asya-kodu  to acen-dft-doviz
                          end-read 
                         

                           evaluate amontext-det(16)
                           when "AI"
                                move "AI" to rez-pan-tipi
                           when "BB"
                                move "BB" to rez-pan-tipi
                           when "HB"
                                move "HB" to rez-pan-tipi
                           when "UAI"
                                move "UA" to rez-pan-tipi
                           end-evaluate
                
        
                          move "BB"        to acen-dft-pan-tipi
                          move "02"        to acen-dft-odeme-tipi
                          move "01"        to acen-dft-anlasma
                          move "01"        to acen-dft-pazar
                          move "209"       to acen-dft-ulke
                         
                         move acen-dft    to not1
                       |  write not-rec invalid 
                       |        rewrite not-rec invalid continue
                       |        end-rewrite 
                       |  end-write        
                        

                       initialize FIRMA-rec 
                       move 10000 to z-firma
                       move acenta-kodu     to z-firma(2:4)
                       move z-firma                                  to firma-kodu
                       move amontext-det(2)                          to firma-ADI 
                       move amontext-det(3)                          to firma-UNVANI
                       move "FIY1" to firma-rate
                       inspect firma-ADI converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                       to x"8DA69A9E989980879FA7818D94" 
                              call "c$toupper" using acenta-adi value 100
                
                       inspect firma-UNVANI converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                       to x"8DA69A9E989980879FA7818D94"
                              call "c$toupper" using acenta-unvani value 100
   
           
                        move musteri-no     to firma-profil-no
                        move musteri-sirket to firma-profil-sirket
      
                        write firma-rec invalid 
                                 if debug = 1 stop " " end-if 
                        end-write 
      
                        MOVE 1          TO FACENTA-FIRMA
                        move firma-kodu to facenta-firma-kodu
                        move firma-rate to facenta-asya-kodu

             END-IF

             write facenta-rec invalid 
                     continue
             end-write

            initialize acenta-rec
            move 9999 to acenta-kodu
            move "Ozel ISLEMLER" to acenta-adi
            write acenta-rec invalid
                    rewrite acenta-rec invalid
                            continue
                    end-rewrite
            end-write
          
       end-if
   | write amontext-rec end-write
    end-read
    end-perform
    close fidetext 
    close amontext acenta nt   
          facenta  musteri firma fdoviz.
*
 adep-al.
 
    move "depkod.txt"  to fidetext-adi
    move "depkod2.txt" to amontext-adi
    open input fidetext
    open output amontext 
 
    open output depkod 
    close depkod  

    initialize y-depkod
    open output fdepkod close fdepkod
    open i-o depkod  fdepkod
    initialize depkod-rec 
    move 99 to y-depkod
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform     
                 
     if function numval(amontext-det(1))  > 0  

       add 1 to y-depkod

      if function numval(amontext-det(1)) = 2
             move 200 to y-depkod
       end-if

       if function numval(amontext-det(1)) = 90
             move 900 to y-depkod
       end-if

    
       initialize depkod-rec fdepkod-rec
       move y-depkod        to fdepkod-asya-kodu

       move amontext-det(1) to fdepkod-fide-kodu

       move y-depkod                                 to z-depanah
       move z-depanah                                to depkod-anah
       move amontext-det(2)                          to depkod-adi
       move function numval(amontext-det(6))         to depkod-kdv
       move amontext-det(3)                          to depkod-ba

       if depkod-ba = "B"     
           move "E"                                  to DEPKOD-FATURA-TAKIP
       end-if
       move 1                                        to depkod-tipi
       move 1                                        to depkod-turu
       
       inspect depkod-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"

      inspect depkod-adi converting x"989E999A80A6A78D81879F94" to
                                 x"49534F55434767697563736F"

       call "c$toupper" using depkod-adi value 30

               write depkod-rec invalid 
                 if debug = 1 stop "depkod" end-if 
               end-write 
               write fdepkod-rec invalid 
                 if debug = 1 stop "fdepkod" end-if 
               end-write
    
     
     end-if
    write amontext-rec end-write
    end-read
    end-perform
      
 

          move 800 to depkod-kodu
          move "A" to depkod-ba
          move 2 to depkod-turu
          move 1 to depkod-tipi
          move "CORRECTION (-)  " to depkod-adi
          perform depkode-yaz


          move 801 to depkod-kodu
          move "B" to depkod-ba
          move 2 to depkod-turu
          move 1 to depkod-tipi
          move "CORRECTION (+)  " to depkod-adi
          perform depkode-yaz

 
          move 601 to depkod-kodu
          move "B" to depkod-ba
          move 3 to depkod-turu
          move 1 to depkod-tipi
          move "PARA IADE  " to depkod-adi
          perform depkode-yaz
 
        |  move 904 to depkod-kodu
        |  move "A" to depkod-ba
        |  move 5 to depkod-turu
        |  move 1 to depkod-tipi

    close fidetext 
    close amontext depkod fdepkod .

 depkode-yaz.
          write depkod-rec invalid
                  rewrite  depkod-rec invalid
                          if debug = 1 then stop " "  end-if 
                  end-rewrite        
          end-write

          move depkod-kodu   to fdepkod-asya-kodu fdepkod-fide-kodu
          write fdepkod-rec invalid
                  rewrite  fdepkod-rec invalid
                          if debug = 1 then stop " "  end-if 
                  end-rewrite        
          end-write.
         
*
 arez-al.
     
    move "rez.txt"  to fidetext-adi
    move "rez2.txt" to amontext-adi
          
    if ref-no <= 1
           open output   polisxml prohrk    ffolio  
           close   polisxml prohrk   ffolio  
    end-if
    open output tpm close tpm
    open output amontext
    open i-o rez    fdoviz yanrez  musteri facenta prohrk kodlar02   nt genelfis tpm
             polisxml  fkonum fidetext  fpazar fguest takvim banka kur  frezdoviz fulke tkat odalar ffolio

*    read fidetext next no lock
*    end continue
*    end-read

    move 1 to sayac PM-SAY
    initialize amontext-rec 
    move  900000 to rez-no-8
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform 

    perform until fs-fidetext = "10"
    initialize fidetext-rec    
    read fidetext next no lock
    end 
      exit perform 
    not end
    move 1 to sayac
    initialize amontext-rec 
    perform varying k from 1 by 1 until k > 300 or sayac > 3000
         
    unstring  fidetext-rec delimited by x"09"                                                 
         into amontext-det(k)   pointer sayac 
    end-unstring
    end-perform 


     if function numval(amontext-det(2)) > 0
                         
        initialize rez-rec 
        move amontext-det(1) to rez-bosv9
         
        move function numval(amontext-det(2)) to rez-no yanrez-rezno  |||| birden fazla rez varer

        move amontext-det(7) to rez-telefon-no 
      
        evaluate amontext-det(4)(1:1) 
        when "P"
        when "X"
            move "S"                   to rez-durumu
        when other 
            move "I"                   to rez-durumu
        end-evaluate

       | move "I"                   to rez-durumu         
       | if amontext-det(43) <> "NULL"  
       |         initialize aranan-i
       |         inspect amontext-det(43) tallying aranan-i for all "T"
       |         if aranan-i = 1 
       |                  move "S"                   to rez-durumu
       |         end-if
       | END-IF

        if amontext-det(5) not = spaces  
               initialize facenta-rec
               move amontext-det(5)    to facenta-fide-kodu
               read facenta no lock invalid
                       move "TANI" to rez-acenta
               not invalid
                       move facenta-asya-kodu  to rez-acenta
               end-read
        end-if 
       |  call "c$justify" using amontext-det(56) ,"L"


       | move "E"                          to rez-c-in
        move amontext-det(10)(1:4)         to rez-gir-yil
        move amontext-det(10)(6:2)         to rez-gir-ay
        move amontext-det(10)(9:2)         to rez-gir-gun

       
       | if amontext-det(4) <> "R" 
       |       exit perform cycle
       | end-if

       add 1 to rez-no-8                        | REZ SIRADAN ALMA
       | move  rez-no-8  to rez-no yanrez-rezno   |    

        move amontext-det(11)(1:4)         to rez-cik-yil
        move amontext-det(11)(6:2)         to rez-cik-ay
        move amontext-det(11)(9:2)         to rez-cik-gun


       |     unstring amontext-det(17)  delimited by " "
       |        into    rez-adi rez-soyadi           
       
        call "c$justify" using amontext-det(7) ,"L"
        call "c$justify" using amontext-det(8) ,"L"

       |  if rez-no = 171566 then stop  " " end-if 
       move amontext-det(87) to deger-100 

       PERFORM ISIM-BITIS-BUL  | REZAL
 
       move deger-100(1:isim-bitis)     to rez-soyadi   yanrez-soyadi
       move deger-100(isim-bitis + 1:)  to rez-adi          yanrez-adi 


             ||yanrez adýýý

       inspect rez-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using rez-adi value 100
       inspect rez-soyadi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using rez-soyadi value 100


       inspect yanrez-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using yanrez-adi value 100

       inspect yanrez-soyadi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using yanrez-soyadi value 100


         call "c$justify" using amontext-det(26),"L"


 

         if amontext-det(20) <> "NULL"  

               initialize odalar-rec
               move amontext-det(20) to odalar-no
               read odalar no lock invalid
                       continue 
               not invalid
                  move odalar-no to rez-odano
               
 


                  initialize tpm-rec
                  move odalar-no   to tpm-oda
                  move rez-gir-tar to tpm-gir
                  move rez-cik-tar to tPM-CIK
                  write tpm-rec invalid
                         rewrite tpm-rec invalid
                                 stop " "
                         not invalid
                                 ADD 1 TO PM-SAY
                                 move 9900 to rez-odano
                         end-rewrite
                  end-write

               end-read 
               if amontext-det(20)(1:1) = "T"
                  move 9999 to rez-odano
               end-if
               |initialize aranan-i
               |inspect amontext-det(20) tallying aranan-i for all "T"
               |if aranan-i = 1 
               |         move "S"                   to rez-durumu
               |end-if

         end-if



           if amontext-det(21) not = "NULL"
              initialize fkonum-rec
              move amontext-det(21)     to fkonum-fide-kodu
              read fkonum no lock invalid 
                     |if rez-odano = zeroes or   rez-odano = spaces
                     |      stop "oda nosu olamadigi icin ref atanamayacak not al."
                     |end-if
                     move 1   to rez-oda-konumu   
              not invalid
                   move fkonum-asya-kodu   to rez-oda-konumu   
              end-read 
           end-if 


          if amontext-det(12) not = "NULL"
              initialize fkonum-rec
              move amontext-det(12)     to fkonum-fide-kodu
              read fkonum no lock invalid 
                     move rez-oda-konumu  to rez-fiyat-konumu   
              not invalid
                   move fkonum-asya-kodu   to rez-fiyat-konumu   
              end-read 
           end-if 

      
          | COMPUTE DEGER-2 =  function numval (amontext-det(75)) 
          | move function numval (amontext-det(13))   to rez-buyuk
          | move DEGER-2                              to rez-free
          | move function numval (amontext-det(16))   to rez-bebek
           |move function numval (amontext-det(18))   to rez-free
          | move function numval (amontext-det(74))   to rez-kucuk

           
      
         

           move function numval (amontext-det(14))   to rez-free
           move function numval (amontext-det(13))   to rez-buyuk
       
           move function numval (amontext-det(16))   to rez-bebek
           |move function numval (amontext-det(18))   to rez-free
           move function numval (amontext-det(15))   to rez-kucuk
         

           if  amontext-det(3) <> "NULL"
                  move amontext-det(3)(1:4)  to rez-isl-yil 
                  move amontext-det(3)(6:2)  to rez-isl-ay     
                  move amontext-det(3)(9:2)  to rez-isl-gun 
           end-if
           if amontext-det(92) <> "NULL"
                  move amontext-det(92)(1:4)  to rez-al-yil
                  move amontext-det(92)(6:2)  to rez-al-ay   
                  move amontext-det(92)(9:2)  to rez-al-gun
           end-if
 

          | BURADA KALDIK
 

           move 01                    to rez-banka
           move "K"                   to rez-k-g-b
           move 1                     to rez-tipi

           initialize fulke-rec
           move amontext-det(86)  to fulke-fide-kodu
           read fulke no lock invalid
                    move 001                 to rez-ulke
           not invalid
                    move Fulke-ASYA-KODU     to rez-ulke
           end-read
                    
*           initialize deger-2 
           move amontext-det(122)(1:2) to rez-pazar 
*           move deger-2                            to rez-pazar

           move "G"                   to REZ-KUR-AYGUN
           move 01                    to rez-anlasma

           if amontext-det(38) = "GUEST" or amontext-det(38) = "NULL" then
                move 01               to rez-odeme-tipi ||PESIN
           else
                move 02               to rez-odeme-tipi ||CITY
           end-if
                                                        
           if amontext-det(37) = "COMP" OR amontext-det(37) = "FCOMP" then
                move 03               to rez-odeme-tipi ||COMP
           end-if
               
 

           evaluate amontext-det(19)
           when "FB"
                move "FB" to rez-pan-tipi
           when "FB+"
                move "FB" to rez-pan-tipi
           when "HB"
                move "HB" to rez-pan-tipi
           when "OB"
                move "OB" to rez-pan-tipi
           when "BB"
                move "BB" to rez-pan-tipi
           when "AI"
                move "AI" to rez-pan-tipi
           when other
                move "UA" to rez-pan-tipi
           end-evaluate
         
 

           move 03                  to rez-doviz
           if amontext-det(24) <> "NULL" then
                initialize fdoviz-rec
                move amontext-det(24)   to fdoviz-fide-kodu
                read fdoviz no lock invalid
                          continue
                not invalid 
                      move fdoviz-asya-kodu to rez-doviz
                end-read 
           end-if

           perform gun-bul

          | if rez-no = 1753 then
           |      stop " "
           |end-if
           if amontext-det(23) <> "NULL" 
                 
                   |inspect amontext-det(23) replacing  all "." by ","
                      inspect amontext-det(23) replacing all "." by "#"
                      inspect amontext-det(23) replacing all "," by "."
                      inspect amontext-det(23) replacing all "#" by ","

                   move function numval(amontext-det(23)) to rez-fiyati 
                   |move rez-fiyati-k                      to  rez-fiyati-k
           end-if
 
           if amontext-det(25) <> "NULL"
                      inspect amontext-det(25) replacing all "." by "#"
                      inspect amontext-det(25) replacing all "," by "."
                      inspect amontext-det(25) replacing all "#" by ","

                   if function numval(amontext-det(25))  > 1 
                        move function numval(amontext-det(25)) to rez-cin-kuru
                   end-if
           end-if

           if amontext-det(33) <> "NULL"
                   move amontext-det(33)(1:20)              to rez-not1
                   inspect rez-not1 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                   to x"8DA69A9E989980879FA7818D94"
                      call "c$toupper" using rez-not1 value 100
                   
                   move amontext-det(33)(21:)               to rez-not2
                   inspect rez-not2 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                   to x"8DA69A9E989980879FA7818D94"
                      call "c$toupper" using rez-not2 value 100
           end-if

              | 61 62 acýklamalar alýnacak


           move rez-buyuk                           to rez-s-d-t-g
           if rez-buyuk > 4 then 
               move 4 to rez-s-d-t-g 
           end-if
 
           |||||||||||||||||||||||||||||YANINDAKINLER BASGLANGIC
   
        initialize yanrez-rec     
        move 1                                       to yanrez-sirano
        move rez-no                                  to yanrez-rezno
        move rez-adi                                 to yanrez-ADI
        move rez-soyadi                              to yanrez-soyadi

        write YANREZ-rec invalid 
                if debug = 1 then stop " " end-if 
        end-write 
        perform polisxml-at
    

        initialize fguest-rec
        move rez-no to fguest-rezno
        start fguest key not < fguest-rezno invalid
                continue
        not invalid
        perform until fs-fguest = "10" 
        read fguest next no lock end move "10" to fs-fguest
        not end
                   
                if fguest-rezno not = rez-no
                      exit perform
                end-if

                initialize yanrez-rec  musteri-rec
                move fguest-id                          to yanrez-sirano
                move isyeri-adres-tasi                  to yanrez-profil-sirket musteri-sirket
                move fguest-guestID                     to musteri-no   
                read musteri no lock invalid 
                    
                     move rez-no                to yanrez-rezno 
                     move fguest-guestadi       to yanrez-ADI    
                     move fguest-guestsoyadi    to yanrez-soyadi 
                     if fguest-id = 1
                     move fguest-guestadi       to rez-adi
                     move fguest-guestsoyadi    to rez-soyadi
                     end-if 
                not invalid 
                     move rez-no                to yanrez-rezno
                     move musteri-no            to yanrez-profil-no  | rez-profil-no
                     move musteri-sirket        to yanrez-profil-sirket | rez-profil-sirket
        
                     move musteri-adi           to yanrez-ADI
                     move musteri-soyadi        to yanrez-soyadi

                end-read 
   
                write YANREZ-rec invalid 
                     REWRITE YANREZ-rec INVALID  
                        if debug = 1 then stop " " end-if 
                    END-REWRITE
                end-write 
                      perform polisxml-at

 
        end-read
        end-perform
        end-start


         |||||||||||||||||||||||||||||YANINDAKINLER BITIS
        |||fatura nooooo
        call "c$justify" using amontext-det(34) ,"L"
        |move amontext-det(34)   to REZ-ADRES1
       | initialize yanrez-sirano
        ||||||||||

        ||||-cýn kurtu
       | if rez-no = 31403 then stop " " end-if
       
        | initialize kur-rec
        | move rez-gir-tar    to KUR-TARIH
        | move rez-banka      to KUR-banka
        | move rez-doviz      to KUR-doviz
        | read kur no lock invalid
        |         continue
        | not invalid
        |        move DOVIZ-ALIS to rez-cin-kuru
        | end-read

        |||||

        if rez-gir-tar < tarih-tasi
                move "E"                to rez-fiyat-fix
        else
                move "H"                to rez-fiyat-fix
        end-if
     
        |move  amontext-det(23)  to rez-sil-sebeb

        if amontext-det(8) <> "NULL" then
                move amontext-det(8) to rez-voucher
        end-if

         inspect rez-voucher converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
           to x"8DA69A9E989980879FA7818D94"
 
      | move 006                       to rez-ulke  
       |move 06                       to rez-pazar
 

       MOVE "N" TO rez-vip 
      | if function numval(amontext-det(49)) = 1  or
      |         MOVE "V" TO rez-vip 
      | end-if

      | if function numval(amontext-det(49)) = 15
      |         MOVE "B" TO rez-vip 
      | end-if

      | if amontext-det(40) = "C" 
      |         MOVE "04" TO rez-odeme-tipi 
      | end-if
|||||||||||||||
 

         call "c$justify" using amontext-det(55) ,"L"
         call "c$justify" using amontext-det(56) ,"L"

        if  amontext-det(29) <> "NULL"
            move amontext-det(29)(12:2) to rez-gel-saat
            move amontext-det(29)(15:2) to rez-gel-dak
        else
           move 12  to rez-gel-saat rez-gel-dak
        end-if
        if  amontext-det(30) <> "NULL"
            move amontext-det(30)(12:2) to rez-git-saat
            move amontext-det(30)(15:2) to rez-git-dak
        else
           move 00  to rez-git-saat rez-git-dak
        end-if

        if function numval(rez-bosv9) = 1
            move 12 to rez-gel-saat
            move 00 to rez-gel-dak  rez-git-saat rez-git-dak
        end-if
        |    move amontext-det(52)(12:2) to rez-late-zaman(1:2)
        |    move amontext-det(52)(15:2) to rez-late-zaman(3:2)

        

          | if function numval(amontext-det(15)) > 1 then
                 |  move  amontext-det(15) to  REZ-TITLE
          | end-if

 
           | if function numval(amontext-det(27)) > 0 and rez-gir-tar < tarih-tasi  then
           |        move function numval(amontext-det(27)) to rez-folio
           |        move 0 to rez-folio
           | else  
          |         move 0 to rez-folio
          |  end-if
 

           |  call "c$justify" using amontext-det(11),"L"

           | MOVE amontext-det(11)(1:50) TO rez-bosv9(1:50)

   


       initialize Ffolio-REC
       |move function numval(amontext-det(95)) to Ffolio-FIDE-kodu
       move rez-no to Ffolio-FIDE-kodu
       read Ffolio no lock invalid
                  move rez-no to Ffolio-FIDE-kodu
                  move function numval(amontext-det(94)) to deger-8
                  move deger-8 to ffolio-fat-no

                  move rez-no to Ffolio-asya-rez-kodu
                 | write ffolio-rec invalid
                 |         stop " "
                 | end-write
       not invalid
                move rez-no to Ffolio-asya-rez-kodu 
                move function numval(amontext-det(94)) to deger-8
                move deger-8 to ffolio-fat-no

                if function numval(amontext-det(94)) > 0
                  continue
                  |   rewrite ffolio-rec invalid
                  |          stop " "
                  |   end-rewrite
                end-if
       end-read



            if function numval(amontext-det(50)) > 1 
            | AND TARIH-TASI < REZ-GIR-TAR 

                    initialize genelfis-rec
                    move 1 to genelfis-anahtar
                    read genelfis no lock invalid
                            continue
                    not invalid
                             ADD 1         TO GRUP-OTO
                             MOVE GRUP-OTO TO REZ-GRUp-no
                             rewrite genelfis-rec invalid
                                       stop " "
                             end-rewrite
                    end-read

                initialize deger-4 rez-k
                move function numval(amontext-det(50))  to deger-4
                |compute deger-4 = deger-4 - 1 
                perform varying rez-k from 1 by 1 until rez-k > deger-4
                    add 1         to rez-no-8
                    move rez-no-8 to rez-no 
                    write rez-rec invalid 
                          if debug = 1 then stop "REZ-YAZAMADI" end-if 
                     end-write
                     display rez-rec
                end-perform

            ELSE

                     write rez-rec invalid 
                          if debug = 1 then stop "REZ-YAZAMADI" end-if 
                     end-write
                     display rez-rec
                 
            end-if
   

            initialize not-rec
            move "REZ"            to NOT-DOS
            move rez-no           to NOT-DOS-ANAH 
            move "Cin Notu : "      to form-acik
            move amontext-det(33) to form-acik(12:)

            move form-acik to not1
 
            if amontext-det(33) = "NULL" or amontext-det(59) = spaces or not1 = spaces then
                    CONTINUE
            ELSE
                    inspect not1 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94"
        
                    move 1 to NOT-REZ NOT-REGISTER NOT-CEKR NOT-CEKE  NOT-COUTr  NOT-COUTe NOT-CIN  NOT-RFOLIO NOT-EFOLIO      
                    move tarih-tasi to NOT-Giris-TARIH
                    move 1200 to NOT-Giris-zaman
                    move 1 to not-sira
                    MOVE "ASYA" TO NOT-Giris-STAF
                    write not-rec invalid
                          stop "NOT YAZAMADI"
                    end-write
            end-if

         



            initialize not-rec
            move "REZ"            to NOT-DOS
            move rez-no           to NOT-DOS-ANAH 
            move "Oda Notu : "      to form-acik
            move amontext-det(34) to form-acik(12:)

            move form-acik to not1

            if amontext-det(34) = "NULL" or amontext-det(34) = spaces  or not1 = spaces then
                    CONTINUE
            ELSE
                    inspect not1 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94"
                    move 1 to NOT-REZ NOT-REGISTER NOT-CEKR NOT-CEKE  NOT-COUTr  NOT-COUTe NOT-CIN  NOT-RFOLIO NOT-EFOLIO      
                    move tarih-tasi to NOT-Giris-TARIH
                    move 1200 to NOT-Giris-zaman
                    move 2 to not-sira
                    MOVE "ASYA" TO NOT-Giris-STAF
                    write not-rec invalid
                           stop "NOT YAZAMADI"
                    end-write  
            end-if
           
 
            initialize not-rec
            move "REZ"      to NOT-DOS
            move rez-no      to NOT-DOS-ANAH 
            move "Cout Notu : " to form-acik
            move amontext-det(35) to form-acik(13:)


            move form-acik to not1

            if amontext-det(35) = "NULL" or amontext-det(35) = spaces  or not1 = spaces then
                    CONTINUE
            ELSE
                    inspect not1 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6" to x"8DA69A9E989980879FA7818D94"

                    move 1 to NOT-REZ NOT-REGISTER NOT-CEKR NOT-CEKE  NOT-COUTr  NOT-COUTe NOT-CIN  NOT-RFOLIO NOT-EFOLIO      
                    move tarih-tasi to NOT-Giris-TARIH
                    move 1200 to NOT-Giris-zaman
                    move 3 to not-sira
                    MOVE "ASYA" TO NOT-Giris-STAF
                    write not-rec invalid
                           stop "NOT YAZAMADI"
                    end-write 
            end-if


         

  

     end-if    
    end-read
    end-perform              
         close amontext  fidetext facenta rez yanrez  fpazar kodlar02 ffolio genelfis tpm
               prohrk musteri polisxml fdoviz fkonum fguest takvim banka kur frezdoviz nt fulke tkat odalar.
 
*
 konum-al.

    move "konum.txt" to fidetext-adi
    move "konum2.txt" to amontext-adi
    open input fidetext
    open output amontext  


     if ref-no <= 1 then
         open output   konum  
         close konum  
     end-if
      open output  fkonum close fkonum 

     open i-o konum  fkonum 
     initialize konum-rec


     initialize konum-anahtar kk-konum

    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
                           
     if amontext-det(1) <> "Kodu" 
            initialize fkonum-rec
            move amontext-det(1)                      to Fkonum-FIDE-KODU  

            move amontext-det(1)                      to konum-adi
            move function numval(amontext-det(2))     to KONUM-TOP-ODA konum-hazir-oda 
            add 1 to kk-konum
            move kk-konum         to konum-anahtar
            move konum-anahtar    to fkonum-asya-kodu

            move 1 to konum-satis

           | MOVE REF-NO TO KONUM-REF
            write konum-rec invalid if debug = 1 then stop " " end-if end-write 
            write fkonum-rec invalid if debug = 1 then stop " " end-if end-write   
**            write amontext-rec end-write
    end-if
    
    end-read
    end-perform
    close fidetext close amontext konum fkonum.
*
 cin-yap.
        ||998877

     open i-o rez 
    initialize rez-rec
     if ref-no <= 1
             open output  konuk ozluk 
             close  konuk ozluk
     end-if
 
     |if ref-no <> 0
     |        compute deger-8 =  ref-no * 1000000 
     |        move deger-8 to fol-sira  
     |        move deger-8 to rez-no
     |end-if
     move 1 to fol-sira
     initialize rez-rec 
     open i-o frez konuk ozluk frezdoviz
     start rez key > rez-anah 
       invalid continue
       not invalid
       perform until fs-rez = "10" 
          read rez next no lock 
            end move "10" to fs-rez
            not end
      
 
            if rez-gir-tar <= tarih-tasi and REZ-DURUMU = "I" 
                    if function numval (rez-bosv9) not = 1 then
                            perform tek-cin
                    end-if
                 |  PERFORM extra-cin
            end-if 

          end-read
       end-perform
      end-start       
      close rez konuk ozluk frez frezdoviz
         .     
*

 tek-cin.
          move rez-no to frez-fide-rez-kodu  frez-asya-rez-kodu
          initialize konuk-rec ozluk-rec
          move fol-sira to frez-asya-rfolio-kodu konuk-folio ozluk-folio 
          add 1 to fol-sira
          perform oda-cin
          move fol-sira to frez-asya-efolio-kodu
          |add 1 to fol-sira   extra folio icin
          write frez-rec invalid if debug = 1 then stop " " end-if end-write.
*
 extra-cin.         
         move frez-asya-efolio-kodu  to konuk-folio ozluk-folio ozluk2-folio.         
         move cinpara-ext-fol-banka  to banka-kodu.     
         move cinpara-ext-fol-doviz  to doviz-kodu.                   
         move cinpara-ext-fol-ode    to kodlar02-kodu. 
         move rez-no to konuk-extra-rez-no
         
              move "I"  to  konuk-durumu 
*          if konuk-git-tar <= tarih-tasi          
             if function numval(rez-sil-sebeb)  = 3
                  move "H"    to konuk-durumu
             end-if


             if konuk-odano = 9999 then
                  move "H"  to  konuk-durumu 
             end-if

          initialize konuk-adi 
          move "E"                       to konuk-fol-kodu. 
          move rez-adi(1:17)             to konuk-adi(04:17). 

          move "E=>"                     to konuk-adi(01:03). 
***********>Gereksiz bilgiler sifirlaniyor........... 
          initialize  konuk-rez-no 
          konuk-kisi  konuk-voucher  konuk-nor-indirim 
          konuk-cik-cikma 
          konuk-oda-tutar   konuk-extbed-tutar konuk-kahvalti-tutar 
          konuk-ogle-tutar  konuk-aksam-tutar konuk-icecek-tutar 
          konuk-extra-tutar konuk-top-borc konuk-top-alac konuk-kur-degeri 
          konuk-dv-degeri konuk-dv-degeri konuk-acik konuk-kartno . 

          move konuk-durumu         to  ozluk-durumu. 
          move konuk-adi            to  ozluk-adi(04:17). 
          move "E=>"                to  ozluk-adi(01:03). 
          write konuk-rec invalid if debug = 1 then stop " " end-if
          end-write.                         
          write ozluk-rec invalid if debug = 1 then stop " " end-if
          end-write.
*
 oda-cin.
    move rez-no              to konuk-rez-no ozluk-rez-no
    move rez-adi             to konuk-adi ozluk-adi 
    move rez-soyadi          to konuk-soyadi ozluk-soyadi
    move rez-s-d-t-g         to konuk-s-d-t-g 
    move rez-oda-konumu      to konuk-oda-konumu 
    if rez-fiyat-konumu = 0 then 
       move rez-oda-konumu   to rez-fiyat-konumu
    end-if
    move rez-fiyat-konumu    to konuk-fiyat-konumu 
    move rez-odeme-tipi      to konuk-odeme-tipi 
    move rez-odano           to konuk-odano  
*    if rez-odano = spaces then
*     if rez-gir-tar < tarih-tasi  then
        |move 9999 to rez-odano  konuk-odano
**        move 1 to rez-share 
      |else
      |   move 9050 to rez-odano  konuk-odano
*     end-if
        
*    end-if
   
    move rez-ulke            to konuk-ulke 
    move rez-buyuk           to konuk-buyuk  
    move rez-kucuk           to konuk-kucuk  
    move rez-free            to konuk-free
 
    move rez-bebek           to konuk-bebek 
    move rez-acenta          to konuk-acenta 
    move rez-grup-no         to konuk-grup-no 
    move rez-voucher         to konuk-voucher 
    move rez-fiyat-konumu    to konuk-fiyat-konumu 
    move rez-nor-indirim     to konuk-nor-indirim 
    move rez-pan-tipi        to konuk-pan-tipi
    move rez-tipi            to konuk-rez-tipi 
    move rez-banka           to konuk-banka
    move rez-doviz           to konuk-doviz 
    move rez-anlasma         to konuk-anlasma
    move rez-pazar           to konuk-pazar
    move rez-share           to konuk-share
    move rez-eb              to konuk-eb
    move rez-ug-ind          to konuk-ug-indirimi
    move rez-fiyat-fix       to konuk-fiyat-fix
    move rez-kur-aygun       to konuk-kur-aygun
    move rez-firma           to konuk-firma 

    move rez-bilbord-eh      to konuk-bilbord-eh
    move REZ-AKSIYON-EH      to konuk-AKSIYON-EH  
    move REZ-share           to konuk-share
    move rez-vip             to konuk-vip
    move rez-gir-tar         to konuk-gel-tar 
    move rez-cik-tar         to konuk-git-tar 
    move rez-not1            to konuk-acik-1
           inspect konuk-acik-1 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
           to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using konuk-acik-1 value 100
    
*    move rez-not2            to konuk-acik-2
*           inspect konuk-acik-2 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
*           to x"8DA69A9E989980879FA7818D94"
*              call "c$toupper" using konuk-acik-2 value 100
    move rez-gel-saat        to konuk-gel-saat
    move rez-gel-dak         to konuk-gel-dakika
    move rez-late-zaman      to konuk-late-zaman

    move rez-git-saat        to konuk-git-saat
    move rez-git-dak         to konuk-git-dakika

**    move "I"                 to konuk-durumu
     |if konuk-git-tar <= tarih-tasi
*     if rez-e-mail(1:1) = "O"
         
    | end-if
          
 

    |  if rez-cin-kuru = zeroes then   
    
           initialize fdoviz-rec frezdoviz-rec
           move rez-no to frezdoviz-rez-no
           read frezdoviz no lock invalid
                   continue
           not invalid
                   move frezdoviz-folio-kur to rez-cin-kuru
           end-read

   |  end-if

      move rez-cin-kuru        to konuk-kur-DEGERI

      move "I"    to konuk-durumu
       
*     if function numval(rez-bosv9) not = 1 and  
*        function numval(rez-bosv9) not = 2
*            move "H"    to konuk-durumu
*     end-if

     if konuk-git-tar <= tarih-tasi
          move "H"    to konuk-durumu
     end-if

      move "E"                 to rez-c-in

      if rez-odano = 9999 then
          move "H"    to konuk-durumu
      end-if

      move "R"                 to konuk-fol-kodu. 

      if  rez-odano = 9000 then
          move "E"                 to konuk-fol-kodu 
          move "H"                 to rez-c-in
      end-if
         initialize rez-ucreti tl-toplam dv-toplam. 
    move rez-fiyati          to rez-ucreti dv-toplam konuk-dv-degeri
                     
****>Ozluk Bilgileri ataniyor.....
    |move rez-adres1          to ozluk-adres1.
    move rez-adres2          to ozluk-adres2.
    move konuk-folio         to rez-folio
              
    
    rewrite rez-rec invalid if debug = 1 then stop " " end-if  end-rewrite
    compute konuk-oda-tutar  rounded = REZ-FIYATI * konuk-kur-degeri          
    write konuk-rec  invalid if debug = 1 then stop " " end-if end-write
    display konuk-rec 
    write ozluk-rec  invalid if debug = 1 then stop " " end-if end-write
      .

*****************************************




         .    
*****************************************   
*****************************************
*

             
*
 hata-goster.
    call "c$rerr" using extend-stat text-message 1.
    move extend-stat       to fileerr-linkage-hata-no.
    move Secondary-Error   to fileerr-linkage-secondary-hata-no.
    call "c$rerrname" using fileerr-linkage-dosya-adi.
    display message box "DOSYA : ",fileerr-linkage-dosya-adi,
    x"0a0d","errrrror :",fileerr-linkage-hata-no,x"0ad0",
    "error2 :",fileerr-linkage-secondary-hata-no.
    set exit-pushed to true
    if debug = 1 then stop " " end-if
    .       

 

*
 ISIM-BITIS-BUL.

       initialize dolu-bitis isim-bitis isim-baslangic

       perform varying k from 1 by 1 until k > 100
               if deger-100(k:1) = "/"   
                    move spaces to deger-100(k:)
                    move k to dolu-bitis
                    exit perform 
               end-if
       end-perform
      perform varying k from 1 by 1 until k > 100

               if deger-100(k:) = spaces
                    move k to dolu-bitis
                    exit perform 
               end-if
       end-perform

       perform varying k from 1 by 1 until k >= dolu-bitis
               if deger-100(k:1) = spaces
                   move k to isim-bitis
               end-if
       end-perform.

*
 profil-al.
   
    move "profil.txt"  to fidetext-adi
    move "profil2.txt" to amontext-adi
    open input fidetext
    open output amontext   
 
     open i-o musteri  tadres fulke
     initialize musteri-rec  
 
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform 
           
   || if 112760 = function numval(amontext-det(33)) then stop " " end-if
     if function numval(amontext-det(1)) > 0
                            
       initialize musteri-rec 
       move isyeri-adres-tasi                 to musteri-sirket
       move function numval(amontext-det(1))  to musteri-no

 
      | move amontext-det(3) to deger-100
       
      | PERFORM ISIM-BITIS-BUL
 
       move amontext-det(3) to musteri-adi
       move amontext-det(4) to musteri-soyadi

       inspect musteri-soyadi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-soyadi value 100

       inspect musteri-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-adi value 100



       if amontext-det(11) <> "NULL" then
             move amontext-det(11)  to musteri-kim-adrs
       end-if
       if amontext-det(12) <> "NULL" then
               move amontext-det(12)    to musteri-kim-adrs1
       end-if
     
       if amontext-det(20) <> "NULL" then
               MOVE amontext-det(20) to musteri-tel1 
       end-if
       if amontext-det(21) <> "NULL" then
               MOVE amontext-det(21) to musteri-tel2
       end-if
       if amontext-det(22) <> "NULL" then
               MOVE amontext-det(22) to musteri-fax
       end-if
 
       if amontext-det(13) <> "NULL" then
              move  amontext-det(13)       to musteri-il
       end-if
       if amontext-det(18) <> "NULL" then
              move  amontext-det(18)        to musteri-vdairesi
       end-if
       if amontext-det(19) <> "NULL" then
               move  amontext-det(19)       to musteri-vno
       end-if
      

  


       inspect musteri-adres1 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-adres1 value 100

       inspect musteri-kim-adrs converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-kim-adrs value 100
                                                                                                       
 
       inspect musteri-adres2 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-adres2 value 100
       inspect musteri-kim-adrs1 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-kim-adrs1 value 100

       inspect musteri-il converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-il value 100

     |  initialize fulke-rec
     |  move amontext-det(17)  to fulke-fide-kodu
     |  read fulke no lock invalid
     |          continue
     |  end-read
     |         
     |  move fulke-asya-KODU                   to musteri-ulke
      move  amontext-det(8)                 to musteri-kim-uyruk

      
       inspect musteri-vdairesi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-vdairesi value 100

       
       evaluate amontext-det(24)(1:1)
       when "P"
           move "P"  to   musteri-b-turu 
       when "p"
           move "P"  to   musteri-b-turu   
       when "E"
           move "E"   to musteri-b-turu
       when "e"
           move "E"   to musteri-b-turu
       when "N"
           move "N"   to musteri-b-turu
       when "n"
           move "N"   to musteri-b-turu    
       when other
           move "D"   to musteri-b-turu    
       end-evaluate

       if amontext-det(24) ="NULL"
            move "D"   to musteri-b-turu   
       end-if

       if amontext-det(25) <> "NULL"
               move amontext-det(25)                  to musteri-seri-no
       end-if

       if amontext-det(51) <> "NULL"
               move function numval(amontext-det(51))  to musteri-kim-tcno
       end-if

       if amontext-det(27) <> "NULL"
                move amontext-det(27)                  to musteri-baba-adi
       end-if

       if amontext-det(52) <> "NULL"
               move amontext-det(52)                   to musteri-ana-adi
       end-if

       if amontext-det(58) <> "NULL"
               move amontext-det(58)                  to musteri-kim-mahalle
       end-if

       if amontext-det(57) <> "NULL"
               move amontext-det(57)                  to musteri-kim-ilce
       end-if

       if amontext-det(56) <> "NULL"
               move amontext-det(56)                  to musteri-kim-il
       end-if

       if amontext-det(28) <> "NULL"
               move amontext-det(28)                  to musteri-d-yeri
       end-if
       
       inspect musteri-kim-mahalle converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-kim-mahalle value 100

      
       inspect musteri-kim-ilce converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-kim-ilce value 100

       inspect musteri-kim-il converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-kim-il value 100

     
       inspect musteri-d-yeri converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-d-yeri value 100
      
       if amontext-det(29) <> "NULL"
               move amontext-det(29)(1:4)             to musteri-dyil
               move amontext-det(29)(6:2)             to musteri-day
               move amontext-det(29)(9:2)             to musteri-dgun
       end-if
       
 
              | move amontext-det(48)(1:4)             to musteri-eyil
              | move amontext-det(48)(6:2)             to musteri-eay
              | move amontext-det(48)(9:4)             to musteri-egun
    
        if amontext-det(37) <> "NULL"
               move function numval(amontext-det(37)) to musteri-gelis-sayisi
       end-if

       inspect musteri-baba-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-baba-adi value 100


       inspect musteri-ana-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-ana-adi value 100

       if amontext-det(23) <> "NULL"
               move amontext-det(23)                  to musteri-e-mail
       end-if
    
       inspect musteri-e-mail converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using musteri-e-mail value 100

       evaluate amontext-det(7)
       when "E"
          move "E"   to  musteri-kim-cinsiyet
       when "B"
          move "K"   to  musteri-kim-cinsiyet
       when "Erkek"
          move "E"   to  musteri-kim-cinsiyet
       when "Bay"
          move "E"   to  musteri-kim-cinsiyet
       when "Bayan"
          move "K"   to  musteri-kim-cinsiyet
       when other
          move "E"   to  musteri-kim-cinsiyet
       end-evaluate 
    
       evaluate amontext-det(55)
       when "NULL"
            move "B"  to musteri-kim-medeni
       WHEN "BEKAR"
            move "E"  to musteri-kim-medeni
       WHEN "EVLÝ"
            move "E"  to musteri-kim-medeni
       WHEN "Bekar"
            move "E"  to musteri-kim-medeni
       WHEN "Evli"
            move "E"  to musteri-kim-medeni
       when other
            move "B"  to musteri-kim-medeni          
       end-evaluate

       if amontext-det(59) <> "NULL"
              move amontext-det(59)                   to musteri-kim-cilt
       end-if

       if amontext-det(60) <> "NULL"
             move amontext-det(60)                   to musteri-kim-aile-no
       end-if
       if amontext-det(61) <> "NULL"
                  move amontext-det(61)                   to musteri-kim-sira-no
       end-if
    
       write musteri-rec invalid 
         if debug = 1 stop " " end-if 
       end-write 

     end-if

   | write amontext-rec end-write
    end-read
    end-perform
    close fidetext 
    close amontext musteri tadres  fulke
    .
*
 polisxml-at.

                     initialize musteri-rec polisxml-rec
                     move yanrez-rezno       to polisxml-rezno
                     move yanrez-sirano      to polisxml-sirano
                     move yanrez-profil-anah to m-profil
 
                     read musteri no lock invalid 
                        display "update edilecek polis kaydi yok"
                     not invalid
                          move musteri-adi            to polisxml-adi
                       move musteri-soyadi            to polisxml-soyadi
                       move musteri-kim-tcno          to polisxml-tckimlikno          
                       move musteri-kim-uyruk         to polisxml-uyruk      
                       move musteri-kim-cinsiyet      to polisxml-cinsiyet   
                       move musteri-kim-medeni        to polisxml-medeni
                       string 
                         musteri-kim-adrs    delimited by "   "
                          musteri-kim-adrs1    delimited by "   "
                      
                       into polisxml-adr

                       MOVE musteri-d-tarihi          to polisxml-dog-tar
               
                       move musteri-b-turu            to polisxml-kturu         
                       move musteri-seri-no           to polisxml-kseri        
                       move musteri-baba-adi          to polisxml-babaadi       
                       move musteri-ana-adi           to polisxml-anaadi        
                       move musteri-d-yeri            to polisxml-dyeri         
                       move musteri-kim-il            to polisxml-nil         
                       move musteri-kim-ilce          to polisxml-nilce       
                       move musteri-kim-mahalle       to polisxml-nmahalle    
                       move musteri-kim-cilt          to polisxml-ncilt       
                       move musteri-kim-aile-no       to polisxml-naile    
                       move musteri-kim-sira-no       to polisxml-nsira  
                      
                       move musteri-prb-ack           to polisxml-prb
                       write polisxml-rec invalid 
                         if debug = 1 stop " " end-if                                           
                       end-write 
                     end-read.

*
 prohrk-kaydet.                   


        initialize prohrk-rec 
        move m-profil                to prohrk-profil-anah
*        move must       to prohrk-profil-no
        move isyeri-adres-tasi       to prohrk-rez-sirket  
        move rez-no                  to prohrk-rez-no 
               



           move yanrez-sirano         to  prohrk-rez-sira       
           move musteri-adi     to  prohrk-pro-adi       
           move musteri-soyadi  to  prohrk-pro-soyadi    
           move rez-acenta      to  prohrk-acenta       
           move rez-gir-tar     to  prohrk-gel-tar
           move rez-cik-tar     to  prohrk-git-tar
           move rez-banka       to  prohrk-banka  
           move rez-doviz       to  prohrk-doviz 
           move rez-pan-tipi    to  prohrk-pans     
           move rez-pazar       to  prohrk-pazar
           move rez-ulke        to  prohrk-ulke 
           move rez-voucher     to  prohrk-voucher
           move rez-odano       to  prohrk-odano


           accept  prohrk-duz-tarih from century-date 
           move isyeri-adres-tasi       to prohrk-rez-sirket
           move rez-no             to prohrk-rez-no
             write prohrk-rec invalid
                 rewrite prohrk-rec end-rewrite
             end-write.
*
 tum-folio-al.
    move 900000        to fol-sira
    move "tumfol.txt"  to fidetext-adi
    move "tumfol2.txt" to amontext-adi
    open input fidetext
    open output amontext  ozluk2
    close   ozluk2

     open i-o  konuk rez acenta 
              ozluk  ozluk2 odalar facenta 
     initialize konuk-rec
     read fidetext next no lock
    end continue
    end-read
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
     if function numval(amontext-det(26)) > 1
        perform extra-ac2-3
     else
        perform folio-kontol 
     end-if              

   | write amontext-rec end-write
    end-read
    end-perform
    close fidetext 
    close amontext konuk  rez  acenta 
          facenta ozluk ozluk2 odalar
     .
*
 folio-kontol.
     if amontext-det(1) not = spaces
       initialize rez-rec 
       move function numval(amontext-det(21))   to rez-no
       read rez no lock invalid
***           display message box "Rez No:"rez-no " bulunamadi"new-line
***                               "Amonra Folio No  " amontext-det(1)
*           if debug = 1 stop "rez"  end-if
           move amontext-det(1)   to amontext-det(3)
           move "REZ YOK"         to konuk-soyadi
            perform extra-ac2-3 
       not invalid
           initialize konuk-rec 
           move rez-folio      to konuk-folio
           read konuk no lock invalid
              if debug = 1 stop "konuk"  end-if
           not invalid
              if rez-odano = spaces
                 call "c$justify" using amontext-det(2),"L"
                 move  amontext-det(2) to rez-odano konuk-odano
                 rewrite rez-rec invalid stop " " end-rewrite 
                 rewrite konuk-rec invalid stop " " end-rewrite 
              end-if 

           end-read 
       end-read
     end-if.
*
 extra-ac2-3.
     add 1                              to fol-sira 
     move fol-sira                      to konuk-folio ozluk-folio ozluk2-folio.         

*     move amontext-det(1)                        to konuk-voucher
     if function numval(amontext-det(26)(1:1)) = 2
        move amontext-det(21)                    to konuk-voucher|amonra rez no 
     end-if 

     move cinpara-ext-fol-banka                  to banka-kodu     
     move cinpara-ext-fol-doviz                  to doviz-kodu                   
     move cinpara-ext-fol-ode                    to kodlar02-kodu 

     if amontext-det(2)(5:2) = "-A" or 
        amontext-det(2)(1:1) = "T" or
        amontext-det(2)(1:2) = "G-" or
        amontext-det(2)(1:2) = "Z-" 

        initialize odalar-rec 
        move amontext-det(2)(1:3)      to  odalar-anah
        read odalar no lock invalid
           move 9999                   to odalar-anah  
        end-read
        move odalar-anah               to konuk-odano
     else
           move 9999                   to konuk-odano   
     end-if

          move "E"                     to konuk-fol-kodu. 
          move "E=>"                   to konuk-adi(01:03) 
          
          move amontext-det(3)         to konuk-adi(04:17)
          move amontext-det(4)         to konuk-soyadi
       inspect konuk-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"

              call "c$toupper" using konuk-adi value 100
          
          initialize  konuk-rez-no 
          konuk-kisi    konuk-nor-indirim 
          konuk-cik-cikma 
          konuk-oda-tutar   konuk-extbed-tutar konuk-kahvalti-tutar 
          konuk-ogle-tutar  konuk-top-borc konuk-top-alac konuk-aksam-tutar konuk-icecek-tutar 
          konuk-extra-tutar   konuk-kur-degeri 
          konuk-dv-degeri konuk-dv-degeri konuk-acik konuk-kartno  



          move konuk-durumu          to ozluk-durumu. 

          move amontext-det(5)(1:2)  to konuk-gel-gun
          move amontext-det(5)(4:2)  to konuk-gel-ay
          move amontext-det(5)(7:4)  to konuk-gel-yil
          move amontext-det(6)(1:2)  to konuk-git-gun
          move amontext-det(6)(4:2)  to konuk-git-ay
          move amontext-det(6)(7:4)  to konuk-git-yil

          if konuk-git-tar <= tarih-tasi          
              move "H"                 to konuk-durumu
          else
              move "I"                 to konuk-durumu             
          end-if
          
*               initialize ffirma-rec firma-bulundu
*               move amontext-det(7)           to ffirma-fide-kodu
*               read ffirma no lock invalid
*                    continue 
*               not invalid
*                    move ffirma-asya-kodu   to konuk-firma

*                    move 1                  to firma-bulundu 
*               end-read 

*        if firma-bulundu = 0
           initialize facenta-rec 
           move amontext-det(8)                  to facenta-fide-kodu
           read facenta no lock invalid
                  initialize acenta-rec 
                  add 1                                         to ydk-acenta 
                  move ydk-acenta                               to acenta-kodu
           
                  move "SILINMIS ACENTA"                          to acenta-adi
                  move amontext-det(8)                          to acenta-unvani
           
                  move amontext-det(8)                     to facenta-fide-kodu
                  move acenta-kodu                         to facenta-asya-kodu
                  write facenta-rec invalid 
                      stop " " 
                  end-write
           
                  write acenta-rec invalid 
                    if debug = 1 stop " " end-if 
                  end-write 
           end-read
            move facenta-asya-kodu   to konuk-acenta
*        end-if          
*          initialize facenta-rec 
*          move amontext-det(7) to facenta-fide-kodu
*          read facenta no lock invalid
*               if debug = 1 stop " " end-if 
*          end-read
*          move facenta-asya-kodu    to konuk-acenta

          move "UA"                 to konuk-pan-tipi
          move amontext-det(3)      to ozluk-adi(04:17). 
          move "E=>"                to ozluk-adi(01:03). 
          move 01                   to konuk-odeme-tipi
          move banka-kodu           to konuk-banka
          move 01                   to konuk-anlasma
          move 06                  to konuk-pazar
          move 001                  to konuk-ulke
          move 02                   to konuk-doviz
                  write konuk-rec invalid if debug = 1 then stop " " end-if
                  end-write                         
                  write ozluk-rec invalid if debug = 1 then stop " " end-if
                  end-write
         

     .
*
 ext4-konuk-ac.
          initialize  ext-fol-no
          compute ext-fol-no = 9000000 + function numval (amontext-det(2))
          move ext-fol-no      to konuk-folio ozluk-folio ozluk2-folio. 
         
          move 9999                    to konuk-odano   
          |if ref-no <> 0
          ||    compute  deger-4 = function numval(konuk-odano) + ( ref-no * 10 )
          |end-if
          |move deger-4 to konuk-odano
          move "E"                     to konuk-fol-kodu. 
          move "E=>"                   to konuk-adi(01:03) 
          
           if odasiz-folio = 1 or rez-adi = spaces 
                  move "CASH"            to konuk-adi(04:17)
                  move "FOLIO"           to konuk-soyadi

           else

                  move REZ-ADI            to konuk-adi(04:17)
                  move REZ-SOYADI         to konuk-soyadi
          end-if

                       
         initialize odalar-rec
         move konuk-odano to odalar-no
         read odalar no lock invalid
                 continue
         end-read
         
         move odalar-konumu to konuk-oda-konumu  

          inspect konuk-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
          to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using konuk-adi value 100
          
          initialize  konuk-rez-no 
          konuk-kisi    konuk-nor-indirim 
          konuk-cik-cikma 
          konuk-oda-tutar   konuk-extbed-tutar konuk-kahvalti-tutar 
          konuk-ogle-tutar  konuk-top-borc konuk-top-alac konuk-aksam-tutar konuk-icecek-tutar 
          konuk-extra-tutar   konuk-kur-degeri 
          konuk-dv-degeri konuk-dv-degeri konuk-acik konuk-kartno konuk-voucher 

          move konuk-durumu          to ozluk-durumu 
         
          if odasiz-folio = 1
                  move amontext-det(3)(1:4) to konuk-gel-yil 
                  move 01                   to konuk-gel-ay  
                  move 01                   to konuk-gel-gun
        
                  move 2014                 to konuk-git-yil
                  move 12                   to konuk-git-ay
                  move 31                   to konuk-git-gun
                  |move tarih-tasi to konuk-git-tar
          else
                  move rez-gir-tar to konuk-gel-tar
                  move rez-cik-tar to konuk-git-tar
          end-if
      
        

          move "H"    to konuk-durumu
          if function numval(rez-bosv9) = 1 or function numval(rez-bosv9) = 2
              move "I"    to konuk-durumu
          end-if
                  
                         |salih
          move 9999                 to konuk-acenta
          move "AI"                 to konuk-pan-tipi
          move konuk-adi            to ozluk-adi(04:17). 
          move "E=>"                to ozluk-adi(01:03). 
          move 01                   to konuk-odeme-tipi
          move 01                   to konuk-banka
          move 01                   to konuk-anlasma
          move 06                   to konuk-pazar
          move 001                  to konuk-ulke
          move 02                   to konuk-doviz

          write konuk-rec invalid 
                continue
          end-write                         
         .
*
 ext-ON-konuk-ac.
          initialize  ext-fol-no
          move 9                      to konuk-folio ozluk-folio ozluk2-folio.         
          move 9050                   to konuk-odano   
 
          move "E"                     to konuk-fol-kodu. 
          move "E=>"                   to konuk-adi(01:03) 
          
          move "ON ODEME"          to konuk-adi(04:17)
          move "FOLIO"         to konuk-soyadi
       inspect konuk-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using konuk-adi value 100
          
          initialize  konuk-rez-no 
          konuk-kisi    konuk-nor-indirim 
          konuk-cik-cikma 
          konuk-oda-tutar   konuk-extbed-tutar konuk-kahvalti-tutar 
          konuk-ogle-tutar  konuk-top-borc konuk-top-alac konuk-aksam-tutar konuk-icecek-tutar 
          konuk-extra-tutar   konuk-kur-degeri 
          konuk-dv-degeri konuk-dv-degeri konuk-acik konuk-kartno  

          move konuk-durumu          to ozluk-durumu. 

          move 01    to konuk-gel-gun
          move 01    to konuk-gel-ay
          move 2012  to konuk-gel-yil

          move tarih-tasi to konuk-git-tar

          move "I"    to konuk-durumu
                         |salih
          move 9999                 to konuk-acenta
          move "AI"                 to konuk-pan-tipi
          move konuk-adi            to ozluk-adi(04:17). 
          move "E=>"                to ozluk-adi(01:03). 
          move 01                   to konuk-odeme-tipi
          move 01                   to konuk-banka
          move 01                   to konuk-anlasma
          move 06                  to konuk-pazar
          move 001                  to konuk-ulke
          move 02                   to konuk-doviz

          write konuk-rec invalid 
                 rewrite konuk-rec invalid
                         stop " "
                 end-rewrite
          end-write .  
*
 hrk-al.
 
  |||||
    move "hrk.txt"  to fidetext-adi
    move "hrk2.txt" to amontext-adi
    open input fidetext
    open output amontext   
    if ref-no <= 1
            open output  romhrk exthrk yromhrk hrk2  
            close        romhrk exthrk yromhrk hrk2  
    end-if

    open i-o  konuk rez ozluk depkod yromhrk hrk2
              ozluk2 odalar facenta romhrk exthrk genelfis nt ffolio  fdepkod
    initialize  konuk-rec 
 
    perform until fs-fidetext = "10"
    initialize fidetext-rec odasiz-folio    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
 
          if 1192626 = amontext-det(8)  
               |  stop " "         
              continue
         end-if

       | if  function numval(amontext-det(17)) <> 0 
       |       exit perform cycle  | ayristirilan mk ne anlama geldiði belli deðil daha
       | end-if
        |  3 ve 4 odenmezler
        if function numval(amontext-det(1)) > 0  and function numval(amontext-det(2)) > 0
                
                  initialize rez-rec  odasiz-folio
                  initialize ffolio-rec
                  move function numval(amontext-det(2)) TO Ffolio-FIDE-kodu
                  read ffolio no lock invalid
                       move function numval(amontext-det(2)) to rez-no 
                  not invalid
                      move Ffolio-asya-rez-kodu to rez-no
                  end-read
                  
**                  if rez-no = 112838 stop " " end-if 
                  read rez no lock invalid
       
                      move 1 to genelfis-anahtar
                      read genelfis invalid
                              continue
                      not invalid
                              add 1 to REZ-folio
                      end-read
        
                      move 1 to odasiz-folio

                      perform ext4-konuk-ac
                  not invalid 

 
                               MOVE REZ-NO TO a-rez-NO
                               initialize konuk-rec
                               move rez-folio         to konuk-folio
        
                               if  function numval (amontext-det(1)) > 2 then
                                         |add 1 to konuk-folio
                                         |move "E" to KONUK-FOL-KODU
                                         CONTINUE
                               end-if     
                
                               read konuk no lock invalid
                                     perform ext4-konuk-ac
                                     |mov e 1 to odasiz-folio
                                     |PERFORM ext-ON-konuk-ac
                                     |exit perform cycle 
                               end-read 
         
                  end-read
                 | add 1                       to uuasya-sira         
                  initialize romhrk-rec

                  if amontext-det(39) <> "NULL"
                          move  function numval(amontext-det(39)) to ROMHRK-FATURA-NO
                  end-if
                  move amontext-det(3)(1:4)  to romhrk-yil 
                  move amontext-det(3)(6:2)  to romhrk-ay
                  move amontext-det(3)(9:2)  to romhrk-gun

                  if romhrk-tarih > tarih-tasi then 
                        exit perform cycle
                  end-if    
            
                 if konuk-durumu = "H"  
                       if function numval(amontext-det(27))  = 1
                             exit perform cycle
                       end-if

                 else
                       if function numval(amontext-det(27))  <> 1
                             exit perform cycle
                       end-if
                 end-if

        

                 if amontext-det(4)<> "NULL" 
                          move amontext-det(4)(12:2)  TO ROMHRK-SAAT
                          move amontext-det(4)(15:2)  TO ROMHRK-DAKIKA
                          move amontext-det(4)(18:2)  TO ROMHRK-SANIYE      
                 end-if

                 if ROMHRK-SAAT = spaces or ROMHRK-SAAT = zeroes then
                       move 12  TO ROMHRK-SAAT ROMHRK-DAKIKA ROMHRK-SANIYE
                 end-if

                  move function numval(amontext-det(1))   to romhrk-islem


                  move konuk-folio                        to romhrk-folio

               
                  initialize fdepkod-rec
                  if amontext-det(7)(1:1) <> "0" and amontext-det(7)(2:1) = spaces
                         move "0"             to fdepkod-fide-kodu
                         move amontext-det(7) to fdepkod-fide-kodu(2:1)
                  else
                         move amontext-det(7) to fdepkod-fide-kodu
                  end-if
                 

                 read fdepkod no lock invalid
                        continue
                 end-read

                 move fdepkod-asya-kodu to depkod-kodu
                  read depkod no lock invalid 
                  
*                       inspect amontext-det(12)  replacing all "," by "."
                       move function numval-c(amontext-det(12))  to tutar-tl
                       initialize depkod-rec
                       move "TANIMSIZ DEPARTMAN"             to depkod-adi
                       if tutar-tl  > 0 then
                               move "B"                      to depkod-ba
                               move 700 to depkod-kodu romhrk-depkod
                       else
                               move "A"                       to depkod-ba
                               move 701 to depkod-kodu romhrk-depkod
                       end-if
                       write depkod-rec invalid
                               continue
                       end-write 
                  end-read 
                      
          
                     initialize aranan-i
                     inspect amontext-det(12) tallying aranan-i for all "E"

                     if aranan-i = 1 
                             exit perform cycle
                     end-if

                      MOVE DEPKOD-BA                 TO romhrk-ba
                      move DEPKOD-KODU               to romhrk-depkod
                                                               
                      inspect amontext-det(12) replacing all "." by "#"
                      inspect amontext-det(12) replacing all "," by "."
                      inspect amontext-det(12) replacing all "#" by ","
                      

                      move function numval(amontext-det(12))  to tutar-tl
                      compute ROMHRK-TL-TUTAR rounded = tutar-tl  
 
                       |if ROMHRK-TL-TUTAR > 9000 |OR 738105 =  amontext-det(1)
                       |      stop " "
                       |end-if
                      if ROMHRK-TL-TUTAR = 0 then
                            exit perform cycle
                      end-if

                      if depkod-ba = "B"
                             if function numval(amontext-det(12)) < 0 
                                  move 800         to romhrk-depkod
                                  MOVE "A"                 TO  romhrk-ba
                                  move depkod-kodu to romhrk-corr-depkod
                             end-if
                      else
                             if function numval(amontext-det(12)) > 0 
                                  move 801         to romhrk-depkod
                                  MOVE "B"                 TO  romhrk-ba
                                  move depkod-kodu to romhrk-corr-depkod
                             end-if
                      end-if

                     
                   | if cor-depkod <> zeroes then
                   |       move cor-depkod to ROMHRK-CORR-DEPKOD
                   |end-if

               

                   move "ASYA"                            TO romhrk-staf

                   initialize form-acik
                   if amontext-det(9) <> "NULL"
                           MOVE amontext-det(9) TO form-acik
                   end-if

                   if amontext-det(8) <> "NULL"
                           MOVE FUNCTION NUMVAL(amontext-det(8)) TO ROMHRK-CEKNO
                   end-if
                 
                    inspect form-acik converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                                              to x"8DA69A9E989980879FA7818D94"

                    move "M"                                to ROMHRK-ISLEM-TIPI

                    if amontext-det(25) <> "NULL"
                          initialize y-folio
                          move function numval(amontext-det(25)) TO y-folio
                          if y-folio <> konuk-rez-no  
                                     move "T"     to ROMHRK-ISLEM-TIPI
                          end-if
                  end-if  


                  if KONUK-FOL-KODU = "R"                     
                           write romhrk-rec invalid
                                if debug = 1 stop "romhrk" end-if
                           end-write
     
                          initialize not-rec
                          move  "RHR"     to NOT-DOS
                          move romhrk-anah to  NOT-DOS-ANAH 
                          move form-acik to not1
                          write not-rec invalid
                                rewrite not-rec invalid
                                        stop " "
                                end-rewrite
                          end-write 
 
                  else
                           move romhrk-rec   to exthrk-rec 
                           write exthrk-rec invalid 
                                if debug = 1 stop "exthrk" end-if                    
                           end-write
 
                          initialize not-rec
                          move  "EHR"      to NOT-DOS
                          move exthrk-anah to NOT-DOS-ANAH 
                          move form-acik to not1
                          write not-rec invalid
                                rewrite not-rec invalid
                                        stop " "
                                end-rewrite
                          end-write 
                  end-if
                  initialize hrk2-rec yromhrk-rec
 
                  move romhrk-anah    to hrk2-ANAH
                  move romhrk-rec     to yromhrk-rec
                  move romhrk-folio   to yromhrk-folio hrk2-kaynak-folio yromhrk-kaynak-folio
         

                  if ROMHRK-ISLEM-TIPI = "T"  
                           initialize rez-rec
                           move y-folio to rez-no
                           read rez no lock invalid
                                    continue   
                           not invalid
                                   initialize konuk-rec
                                   move rez-folio to konuk-folio
                                   read konuk no lock invalid
                                           continue
                                   not invalid
                                           move konuk-folio  to hrk2-kaynak-folio  yromhrk-folio yromhrk-kaynak-folio
                                   end-read 
                           end-read    
                  end-if
 
                  initialize yROMHRK-FATURA-NO

                  write yromhrk-rec invalid
                         stop "durrr"
                  end-write 

                  write hrk2-rec invalid
                        stop "durrr2"
                  end-write 

                  display yromhrk-rec 

        end-if 

    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext 
    close amontext konuk  rez depkod facenta  yromhrk hrk2 ozluk ozluk2 odalar romhrk exthrk genelfis nt ffolio fdepkod.

*
 corr-duzelt.
          open i-o exthrk romhrk yromhrk genelfis konuk  hrk2 depkod
            initialize romhrk-rec
            start romhrk key not < romhrk-anah invalid
                     continue
             not invalid
             perform until fs-romhrk = "10"
             read romhrk next no lock end move "10" to fs-romhrk
             not end

                     
             initialize depkod-rec
             move  romhrk-depkod to depkod-kodu
             read depkod no lock invalid
                     continue
             not invalid
                    if depkod-turu <> 2 and ROMHRK-CORR-DEPKOD <> 0 then

                        initialize ROMHRK-CORR-DEPKOD
                        rewrite romhrk-rec
                        end-rewrite
                        display romhrk-rec
                    end-if
             end-read
                      
             end-read
             end-perform
             end-start

            initialize exthrk-rec
            start exthrk key not < exthrk-anah invalid
                     continue
             not invalid
             perform until fs-exthrk = "10"
             read exthrk next no lock end move "10" to fs-exthrk
             not end

                     
             initialize depkod-rec
             move  exthrk-depkod to depkod-kodu
             read depkod no lock invalid
                     continue
             not invalid
                    if depkod-turu <> 2 and exthrk-CORR-DEPKOD <> 0 then
                        initialize exthrk-CORR-DEPKOD
                        rewrite exthrk-rec
                        end-rewrite
                        display exthrk-rec
                    end-if
             end-read
                      
             end-read
             end-perform
             end-start
            initialize yromhrk-rec
            start yromhrk key not < yromhrk-anah invalid
                     continue
             not invalid
             perform until fs-yromhrk = "10"
             read yromhrk next no lock end move "10" to fs-yromhrk
             not end
                     initialize depkod-rec
                     move yromhrk-depkod to depkod-kodu
                     read depkod no lock invalid
                             continue
                     not invalid
                            if depkod-turu <> 2 and yROMHRK-CORR-DEPKOD <> 0 then
                                initialize yROMHRK-CORR-DEPKOD
                                rewrite yromhrk-rec
                                end-rewrite
                                display yromhrk-rec
                            end-if
                     end-read
             end-read
             end-perform
             end-start

        close exthrk  romhrk yromhrk genelfis konuk  hrk2 depkod .

*
 folyo-duz.
            open i-o yromhrk exthrk romhrk hrk2  konuk
        if 1 = 1    
            
             initialize romhrk-rec  eski-folio basilacak-tl-tutar  eski-cek-no
             start romhrk key not < romhrk-anah invalid
                     continue
             not invalid
             perform until fs-romhrk= "10"
             read romhrk next no lock end move "10" to fs-romhrk
             not end

                     initialize konuk-rec
                     move romhrk-folio to konuk-folio
                     read konuk no lock invalid
                             continue
                     end-read

                     if romhrk-folio <> eski-folio and eski-folio <> 0  then   
                          if basilacak-tl-tutar > -1 and  basilacak-tl-tutar < 1 and basilacak-tl-tutar <> 0 then         
                                  initialize yromhrk-rec
                                  move eski-folio         to yromhrk-folio
                                  move eski-cek-no        to yromhrk-islem  
                                  read yromhrk invalid
                                          stop " "
                                  not invalid
                                             
                                               if yromhrk-ba = "A"
                                                      compute yROMHRK-TL-TUTAR = yROMHRK-TL-TUTAR + basilacak-tl-tutar 
                                                else   
                                                      compute yROMHRK-TL-TUTAR = yROMHRK-TL-TUTAR - basilacak-tl-tutar 
                                                end-if
                                                rewrite yromhrk-rec invalid
                                                       stop " "
                                                end-rewrite
                                                display yromhrk-rec
                                      
                                        
                                  end-read

                            end-if
                            initialize basilacak-tl-tutar 
                        
                     end-if

                     if konuk-durumu <> "H" then
                             exit perform cycle
                     end-if

                     if romhrk-ba = "B" then
                           add romhrk-TL-TUTAR to basilacak-tl-tutar
                     end-if
                     if romhrk-ba = "A" then
                           subtract romhrk-TL-TUTAR from basilacak-tl-tutar
                     end-if     
               
                     move romhrk-folio  to eski-folio 
                    
                     move romhrk-islem  to eski-cek-no
                     move konuk-git-tar to eski-tar
                 
             end-read
             end-perform
             end-start

            if basilacak-tl-tutar > -1 and  basilacak-tl-tutar < 1  and basilacak-tl-tutar <> 0 then    
                           initialize yromhrk-rec
                           move eski-folio         to yromhrk-folio
                           move eski-cek-no        to yromhrk-islem  
                           read yromhrk invalid
                                   stop " "
                           not invalid
                                 
                                               if yromhrk-ba = "A"
                                                      compute yROMHRK-TL-TUTAR = yROMHRK-TL-TUTAR + basilacak-tl-tutar 
                                                else   
                                                      compute yROMHRK-TL-TUTAR = yROMHRK-TL-TUTAR - basilacak-tl-tutar 
                                                end-if
                                                rewrite yromhrk-rec invalid
                                                       stop " "
                                                end-rewrite
                                                   display yromhrk-rec
                        
                                   
                           end-read
                           initialize basilacak-tl-tutar 
             end-if

             ||||||||||||||||

             initialize exthrk-rec  eski-folio basilacak-tl-tutar  eski-cek-no
             start exthrk key not < exthrk-anah invalid
                     continue
             not invalid
             perform until fs-exthrk= "10"
             read exthrk next no lock end move "10" to fs-exthrk
             not end
            
           | if 9017855 = exthrk-folio stop " " end-if

                     initialize konuk-rec
                     move exthrk-folio to konuk-folio
                     read konuk no lock invalid
                             continue
                     end-read

                     if exthrk-folio <> eski-folio and eski-folio <> 0  then   
                        if basilacak-tl-tutar > -1 and  basilacak-tl-tutar < 1 and basilacak-tl-tutar <> 0 then  
                                  initialize yromhrk-rec
                                  move eski-folio         to yromhrk-folio
                                  move eski-cek-no        to yromhrk-islem  
                                  read yromhrk invalid
                                          stop " "
                                  not invalid
                             
                                               if yromhrk-ba = "A"
                                                      compute yROMHRK-TL-TUTAR = yROMHRK-TL-TUTAR + basilacak-tl-tutar 
                                                else   
                                                      compute yROMHRK-TL-TUTAR = yROMHRK-TL-TUTAR - basilacak-tl-tutar 
                                                end-if
                                                rewrite yromhrk-rec invalid
                                                       stop " "
                                                end-rewrite
                                                   display yromhrk-rec
                                        
                                         
                                       
                                  end-read
                          end-if
                         initialize basilacak-tl-tutar 
                        
                     end-if

                     if konuk-durumu <> "H" then
                             exit perform cycle
                     end-if

                     if exthrk-ba = "B" then
                           add exthrk-TL-TUTAR to basilacak-tl-tutar
                     end-if
                     if exthrk-ba = "A" then
                           subtract exthrk-TL-TUTAR from basilacak-tl-tutar
                     end-if     
               
                     move exthrk-folio  to eski-folio
                     move exthrk-islem  to eski-cek-no
                     move konuk-git-tar to eski-tar

             end-read
             end-perform
             end-start

           if basilacak-tl-tutar > -1 and  basilacak-tl-tutar < 1 and basilacak-tl-tutar <> 0 then      
                           initialize yromhrk-rec
                           move eski-folio         to yromhrk-folio
                           move eski-cek-no        to yromhrk-islem  
                           read yromhrk invalid
                                   stop " "
                           not invalid
                                    
                                               if yromhrk-ba = "A"
                                                      compute yROMHRK-TL-TUTAR = yROMHRK-TL-TUTAR + basilacak-tl-tutar 
                                                else   
                                                      compute yROMHRK-TL-TUTAR = yROMHRK-TL-TUTAR - basilacak-tl-tutar 
                                                end-if
                                                rewrite yromhrk-rec invalid
                                                       stop " "
                                                end-rewrite
                                                   display yromhrk-rec
                                     

                                  
                           end-read
                            initialize basilacak-tl-tutar 
             end-if
        end-if
             |||||||||yarrak vardý dimiii

             initialize romhrk-rec yromhrk-rec  eski-folio
             start yromhrk key not < yromhrk-anah invalid
                     continue
             not invalid
             perform until fs-yromhrk = "10"
             read yromhrk next no lock end move "10" to fs-yromhrk
             not end

                 |if 9017855 = yromhrk-folio stop " " end-if
                 initialize konuk-rec
                 move yromhrk-folio to konuk-folio
                 read konuk no lock invalid
                             stop " "
                 end-read

                 if KONUK-FOL-KODU = "R" 
                     initialize romhrk-rec
                     move yromhrk-rec to romhrk-rec

                     read romhrk no lock invalid
                     initialize romhrk-rec
                             move yromhrk-rec          to romhrk-rec
                             move yromhrk-kaynak-folio to romhrk-folio
                             read romhrk no lock invalid
                                     continue
                             not invalid
                                     move yromhrk-tl-tutar to romhrk-tl-tutar
                                    rewrite romhrk-rec invalid
                                          stop " "
                                     end-rewrite
                             end-read
                           
                     not invalid
                             move yromhrk-tl-tutar to romhrk-tl-tutar
                             rewrite romhrk-rec invalid
                                     stop " "
                             end-rewrite
                     end-read
                      display romhrk-rec
                 else
                     initialize exthrk-rec
                     move yromhrk-rec to exthrk-rec
                     read exthrk no lock invalid
                     initialize exthrk-rec
                             move yromhrk-rec          to exthrk-rec
                             move yromhrk-kaynak-folio to exthrk-folio
                             read exthrk no lock invalid
                                     continue
                             not invalid
                                    move yromhrk-tl-tutar to exthrk-tl-tutar
                                    rewrite exthrk-rec invalid
                                          stop " "
                                     end-rewrite
                             end-read
                           
                     not invalid
                             move yromhrk-tl-tutar to exthrk-tl-tutar
                             rewrite exthrk-rec invalid
                                     stop " "
                             end-rewrite
                     end-read
                         display exthrk-rec

                 end-if

             end-read
             end-perform
             end-start
             
             close yromhrk exthrk romhrk hrk2 konuk.
*
 city-kaldir.
      if 2 = 1
         open i-o romhrk yromhrk genelfis konuk  hrk2
            initialize romhrk-rec
            start romhrk key not < romhrk-anah invalid
                     continue
             not invalid
             perform until fs-romhrk = "10"
             read romhrk next no lock end move "10" to fs-romhrk
             not end
                     if romhrk-depkod = 901 
                          delete romhrk 
                          end-delete
                    end-if
             end-read
             end-perform
             end-start

            initialize yromhrk-rec
            start yromhrk key not < yromhrk-anah invalid
                     continue
             not invalid
             perform until fs-yromhrk = "10"
             read yromhrk next no lock end move "10" to fs-yromhrk
             not end
                     if yromhrk-depkod = 901 
                          delete yromhrk
                          end-delete
                    end-if
             end-read
             end-perform
             end-start

        close  romhrk yromhrk genelfis konuk  hrk2  
        exit paragraph
       end-if 
           
        open i-o exthrk romhrk yromhrk genelfis konuk  hrk2
             initialize romhrk-rec yromhrk-rec  eski-folio
            | if ref-no <> 0
            |         compute deger-8 =  ref-no * 1000000 
            |         move deger-8 to ROMHRK-FOLIO  
            | end-if
             start romhrk key not < romhrk-anah invalid
                     continue
             not invalid
             perform until fs-romhrk = "10"
             read romhrk next no lock end move "10" to fs-romhrk
             not end

     
                     if romhrk-folio > ( ( ref-no + 1 ) * 1000000 )
                           exit perform  
                     end-if
                     initialize konuk-rec
                     move romhrk-folio to konuk-folio
                     read konuk no lock invalid
                             continue
                     end-read

                     if romhrk-folio <> eski-folio and eski-folio <> 0  then   
                          initialize genelfis-rec
                          move 1 to genelfis-anahtar
                          read genelfis no lock invalid
                                  continue
                          not invalid    
                                 add 1 to CEKGIR-OTO
                                 rewrite genelfis-rec invalid
                                         stop " "
                                 end-rewrite
                          end-read
                          if basilacak-tl-tutar > 0 then         
                                  initialize yromhrk-rec
                                  move romhrk-rec         to yromhrk-rec
                                  move eski-folio         to yromhrk-folio
                                  move CEKGIR-OTO         to yromhrk-islem  
                     
                                  move 901 to yromhrk-depkod
        
                                  move "A"                to yromhrk-ba
                                  move eski-tar           to yromhrk-tarih
                                  move basilacak-tl-tutar to yROMHRK-TL-TUTAR
         
                                  initialize yROMHRK-FATURA-NO
                                  write yromhrk-rec invalid
                                       stop " "
                                  end-write
        
                                  initialize basilacak-tl-tutar 
                          end-if
                     end-if

                    if konuk-durumu <> "H" then
                             exit perform cycle
                     end-if

                     if romhrk-ba = "B" then
                           add ROMHRK-TL-TUTAR to basilacak-tl-tutar
                     end-if
                     if romhrk-ba = "A" then
                           subtract ROMHRK-TL-TUTAR from basilacak-tl-tutar
                     end-if                    
                     move romhrk-folio  to eski-folio
                     move konuk-git-tar to eski-tar
             end-read
             end-perform
             end-start
              
 
                          initialize genelfis-rec
                          move 1 to genelfis-anahtar
                          read genelfis no lock invalid
                                  continue
                          not invalid    
                                 add 1 to CEKGIR-OTO
                                 rewrite genelfis-rec invalid
                                         stop " "
                                 end-rewrite
                          end-read
                          if basilacak-tl-tutar > 0 then         
                         
                          initialize yromhrk-rec
                          move romhrk-rec         to yromhrk-rec
                          move eski-folio         to yromhrk-folio
                          move CEKGIR-OTO         to yromhrk-islem  
   
                        
                          move 901 to yromhrk-depkod

                          move "A"                to yromhrk-ba
                          move eski-tar           to yromhrk-tarih
                          move basilacak-tl-tutar to yROMHRK-TL-TUTAR
                          move yromhrk-folio to yromhrk-kaynak-folio
                          initialize yROMHRK-FATURA-NO
                          write yromhrk-rec invalid
                               stop " "
                          end-write

                          initialize basilacak-tl-tutar  
           end-if
                |||||||||||||||||||||
    
       
             initialize exthrk-rec yromhrk-rec  eski-folio basilacak-tl-tutar
             if ref-no <> 0
               |      compute deger-8 =  ref-no * 1000000 
               |  |    move deger-8 to extHRK-FOLIO  
               continue
             end-if
             move 9000000 to extHRK-FOLIO
             start extHRK key not < extHRK-anah invalid
                     continue
             not invalid
             perform until fs-extHRK = "10"
             read extHRK next no lock end move "10" to fs-extHRK
             not end

        
                                                
                     if extHRK-folio not >  9000000
                           exit perform cycle  
                     end-if

                     initialize konuk-rec
                     move extHRK-folio to konuk-folio
                     read konuk no lock invalid
                             continue
                     end-read

                     if extHRK-folio <> eski-folio and eski-folio <> 0  then   
                          initialize genelfis-rec
                          move 1 to genelfis-anahtar
                          read genelfis no lock invalid
                                  continue
                          not invalid    
                                 add 1 to CEKGIR-OTO
                                 rewrite genelfis-rec invalid
                                         stop " "
                                 end-rewrite
                          end-read
                          if basilacak-tl-tutar > 0 then         
                                  initialize yromhrk-rec
                                  move extHRK-rec         to yromhrk-rec
                                  move eski-folio         to yromhrk-folio
                                  move CEKGIR-OTO         to yromhrk-islem  
           
                                   
                                  move 901 to yromhrk-depkod
        
                                  move "A"                to yromhrk-ba
                                  move eski-tar           to yromhrk-tarih
                                  move basilacak-tl-tutar to yROMHRK-TL-TUTAR
                                  move yromhrk-folio      to yromhrk-kaynak-folio
        
                                  initialize yROMHRK-FATURA-NO
                                  write yromhrk-rec invalid
                                       stop " "
                                  end-write
        
                                  initialize basilacak-tl-tutar  
                          end-if
                        
                     end-if

                     if konuk-durumu <> "H" then
                             exit perform cycle
                     end-if

                     if exthrk-ba = "B" then
                           add extHRK-TL-TUTAR to basilacak-tl-tutar
                     end-if
                     if exthrk-ba = "A" then
                           subtract extHRK-TL-TUTAR from basilacak-tl-tutar
                     end-if     
               
                     move extHRK-folio  to eski-folio
                     move konuk-git-tar to eski-tar
             end-read
             end-perform
             end-start



                             initialize genelfis-rec
                          move 1 to genelfis-anahtar
                          read genelfis no lock invalid
                                  continue
                          not invalid    
                                 add 1 to CEKGIR-OTO
                                 rewrite genelfis-rec invalid
                                         stop " "
                                 end-rewrite
                          end-read
                          if basilacak-tl-tutar > 0 then         
       
                                  initialize yromhrk-rec
                                  move extHRK-rec         to yromhrk-rec
                                  move eski-folio         to yromhrk-folio
                                  move CEKGIR-OTO         to yromhrk-islem  
           
                                  
                                  move 901 to yromhrk-depkod
        
                                  move "A"                to yromhrk-ba
                                  move eski-tar           to yromhrk-tarih
                                  move basilacak-tl-tutar to yROMHRK-TL-TUTAR
                                  initialize yROMHRK-FATURA-NO
                                  write yromhrk-rec invalid
                                       stop " "
                                  end-write
        
                                  initialize basilacak-tl-tutar  |
                            end-if

                          |||||||||||

             initialize romhrk-rec yromhrk-rec  eski-folio
            | if ref-no <> 0
            |         compute deger-8 =  ref-no * 1000000 
            |         move deger-8 to yROMHRK-FOLIO  
            | end-if
             start yromhrk key not < yromhrk-anah invalid
                     continue
             not invalid
             perform until fs-yromhrk = "10"
             read yromhrk next no lock end move "10" to fs-yromhrk
             not end


                 initialize konuk-rec
                 move yromhrk-folio to konuk-folio
                 read konuk no lock invalid
                             stop " "
                 end-read

                 if KONUK-FOL-KODU = "R" 
                     initialize romhrk-rec
                     move yromhrk-rec to romhrk-rec
                     rewrite romhrk-rec invalid
                             stop " "
                     end-rewrite

                 else
                     initialize exthrk-rec
                     move yromhrk-rec to exthrk-rec
                     initialize exthrk-FATURA-NO
                     write exthrk-rec invalid
                             stop " "
                     end-write

                 end-if

             end-read
             end-perform
             end-start
        close romhrk exthrk yromhrk genelfis konuk hrk2.
*
 yan-al.
    initialize ilk-rez-mi
    move "rez.txt"  to fidetext-adi
    move "rez2.txt" to amontext-adi
    open input fidetext
    open output amontext 
     open i-o rez yanrez  musteri
     initialize yanrez-rec
*     read fidetext next no lock
*    end continue
*    end-read
    perform until fs-fidetext = "10"
     initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    move 1 to i
    initialize amontext-rec 
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform                      
     if amontext-det(5) not = spaces
        initialize yanrez-rec rez-rec
        move function numval(amontext-det(5)) to rez-no
        read rez no lock invalid 
           exit perform cycle 
        not invalid                                 
            
            evaluate true
            when amontext-det(7) not = spaces and
                 amontext-det(8) not = spaces and
                 amontext-det(9)     = spaces and
                 amontext-det(10)    = spaces and
                 amontext-det(11)    = spaces
 
                    initialize yanrez-rec
                    move 2        to yanrez-sirano
                    move rez-no   to yanrez-rezno
                    read yanrez no lock invalid 
                         continue 
                    end-read
                        initialize musteri-rec 
                        move isyeri-adres-tasi  to musteri-sirket
                        move function numval(amontext-det(8)) to musteri-no
                        read musteri no lock invalid 
                            continue 
                        not invalid 
                            move musteri-adi      to yanrez-adi
                            move musteri-soyadi   to yanrez-soyadi
                            move musteri-no   to yanrez-profil-no
                            move isyeri-adres-tasi to yanrez-profil-sirket

                                   inspect yanrez-adi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                       to x"8DA69A9E989980879FA7818D94"
                              call "c$toupper" using yanrez-adi value 100
                
                       inspect yanrez-soyadi converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
                       to x"8DA69A9E989980879FA7818D94"
                              call "c$toupper" using yanrez-soyadi value 100

                                write yanrez-rec invalid 
                                   rewrite yanrez-rec end-rewrite 
                                end-write 
                        end-read 
  
            when amontext-det(7) not = spaces and
                 amontext-det(8) not = spaces and
                 amontext-det(9) not = spaces and
                 amontext-det(10)    = spaces and
                 amontext-det(11)    = spaces
 
                    initialize yanrez-rec
                    move 2        to yanrez-sirano
                    move rez-no   to yanrez-rezno
                    read yanrez no lock invalid 
                         continue 
                    end-read
                        initialize musteri-rec 
                        move isyeri-adres-tasi  to musteri-sirket
                        move function numval(amontext-det(8)) to musteri-no
                        read musteri no lock invalid 
                            continue 
                        not invalid 
                            move musteri-adi      to yanrez-adi
                            move musteri-soyadi   to yanrez-soyadi
                            move musteri-no   to yanrez-profil-no
                            move isyeri-adres-tasi to yanrez-profil-sirket

                                write yanrez-rec invalid 
                                   rewrite yanrez-rec end-rewrite 
                                end-write 
                        end-read 
                    initialize yanrez-rec
                    move 3        to yanrez-sirano
                    move rez-no   to yanrez-rezno
                    read yanrez no lock invalid 
                         continue 
                    end-read
                        initialize musteri-rec 
                        move isyeri-adres-tasi  to musteri-sirket
                        move function numval(amontext-det(9)) to musteri-no
                        read musteri no lock invalid 
                            continue 
                        not invalid 
                            move musteri-adi      to yanrez-adi
                            move musteri-soyadi   to yanrez-soyadi
                            move musteri-no   to yanrez-profil-no
                            move isyeri-adres-tasi to yanrez-profil-sirket

                                write yanrez-rec invalid 
                                   rewrite yanrez-rec end-rewrite 
                                end-write 
                        end-read 

            when amontext-det(7) not = spaces and
                 amontext-det(8) not = spaces and
                 amontext-det(9) not = spaces and
                 amontext-det(10) not = spaces and
                 amontext-det(11)    = spaces
 
                    initialize yanrez-rec
                    move 2        to yanrez-sirano
                    move rez-no   to yanrez-rezno
                    read yanrez no lock invalid 
                         continue 
                    end-read
                        initialize musteri-rec 
                        move isyeri-adres-tasi  to musteri-sirket
                        move function numval(amontext-det(8)) to musteri-no
                        read musteri no lock invalid 
                            continue 
                        not invalid 
                            move musteri-adi      to yanrez-adi
                            move musteri-soyadi   to yanrez-soyadi
                            move musteri-no   to yanrez-profil-no
                            move isyeri-adres-tasi to yanrez-profil-sirket

                                write yanrez-rec invalid 
                                   rewrite yanrez-rec end-rewrite 
                                end-write 
                        end-read 
                    initialize yanrez-rec
                    move 3        to yanrez-sirano
                    move rez-no   to yanrez-rezno
                    read yanrez no lock invalid 
                         continue 
                    end-read
                        initialize musteri-rec 
                        move isyeri-adres-tasi  to musteri-sirket
                        move function numval(amontext-det(9)) to musteri-no
                        read musteri no lock invalid 
                            continue 
                        not invalid 
                            move musteri-adi      to yanrez-adi
                            move musteri-soyadi   to yanrez-soyadi
                            move musteri-no   to yanrez-profil-no
                            move isyeri-adres-tasi to yanrez-profil-sirket

                                write yanrez-rec invalid 
                                   rewrite yanrez-rec end-rewrite 
                                end-write 
                        end-read  
                    initialize yanrez-rec
                    move 4        to yanrez-sirano
                    move rez-no   to yanrez-rezno
                    read yanrez no lock invalid 
                         continue 
                    end-read
                        initialize musteri-rec 
                        move isyeri-adres-tasi  to musteri-sirket
                        move function numval(amontext-det(10)) to musteri-no
                        read musteri no lock invalid 
                            continue 
                        not invalid 
                            move musteri-adi      to yanrez-adi
                            move musteri-soyadi   to yanrez-soyadi
                            move musteri-no   to yanrez-profil-no
                            move isyeri-adres-tasi to yanrez-profil-sirket

                                write yanrez-rec invalid 
                                   rewrite yanrez-rec end-rewrite 
                                end-write 
                        end-read  

            when amontext-det(7) not = spaces and
                 amontext-det(8) not = spaces and
                 amontext-det(9) not = spaces and
                 amontext-det(10) not = spaces and
                 amontext-det(11)    not = spaces
 
                    initialize yanrez-rec
                    move 2        to yanrez-sirano
                    move rez-no   to yanrez-rezno
                    read yanrez no lock invalid 
                         continue 
                    end-read
                        initialize musteri-rec 
                        move isyeri-adres-tasi  to musteri-sirket
                        move function numval(amontext-det(8)) to musteri-no
                        read musteri no lock invalid 
                            continue 
                        not invalid 
                            move musteri-adi      to yanrez-adi
                            move musteri-soyadi   to yanrez-soyadi
                            move musteri-no   to yanrez-profil-no
                            move isyeri-adres-tasi to yanrez-profil-sirket

                                write yanrez-rec invalid 
                                   rewrite yanrez-rec end-rewrite 
                                end-write 
                        end-read 
                    initialize yanrez-rec
                    move 3        to yanrez-sirano
                    move rez-no   to yanrez-rezno
                    read yanrez no lock invalid 
                         continue 
                    end-read
                        initialize musteri-rec 
                        move isyeri-adres-tasi  to musteri-sirket
                        move function numval(amontext-det(9)) to musteri-no
                        read musteri no lock invalid 
                            continue 
                        not invalid 
                            move musteri-adi      to yanrez-adi
                            move musteri-soyadi   to yanrez-soyadi
                            move musteri-no   to yanrez-profil-no
                            move isyeri-adres-tasi to yanrez-profil-sirket

                                write yanrez-rec invalid 
                                   rewrite yanrez-rec end-rewrite 
                                end-write 
                        end-read  
                    initialize yanrez-rec
                    move 4        to yanrez-sirano
                    move rez-no   to yanrez-rezno
                    read yanrez no lock invalid 
                         continue 
                    end-read
                        initialize musteri-rec 
                        move isyeri-adres-tasi  to musteri-sirket
                        move function numval(amontext-det(10)) to musteri-no
                        read musteri no lock invalid 
                            continue 
                        not invalid 
                            move musteri-adi      to yanrez-adi
                            move musteri-soyadi   to yanrez-soyadi
                            move musteri-no   to yanrez-profil-no
                            move isyeri-adres-tasi to yanrez-profil-sirket

                                write yanrez-rec invalid 
                                   rewrite yanrez-rec end-rewrite 
                                end-write 
                        end-read             
                    initialize yanrez-rec
                    move 5        to yanrez-sirano
                    move rez-no   to yanrez-rezno
                    read yanrez no lock invalid 
                         continue 
                    end-read
                        initialize musteri-rec 
                        move isyeri-adres-tasi  to musteri-sirket
                        move function numval(amontext-det(11)) to musteri-no
                        read musteri no lock invalid 
                            continue 
                        not invalid 
                            move musteri-adi      to yanrez-adi
                            move musteri-soyadi   to yanrez-soyadi

                            move musteri-no   to yanrez-profil-no
                            move isyeri-adres-tasi to yanrez-profil-sirket

                                write yanrez-rec invalid 
                                   rewrite yanrez-rec end-rewrite 
                                end-write 
                        end-read             
                 end-evaluate
        end-read 
     end-if
    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext 
    close amontext rez yanrez musteri.

*
 doviz-al.
    move "doviz.txt" to fidetext-adi
    move "doviz2.txt" to amontext-adi
    open input fidetext
   
      open output fdoviz  doviz
      close fdoviz  doviz
    open output amontext 
    open i-o fdoviz doviz
    initialize doviz-rec ydk-doviz-kodu fdoviz-rec

    perform until fs-fidetext = "10"
    initialize fidetext-rec    
    read fidetext next no lock
    end 
    not end
    move 1 to sayac
    initialize amontext-rec
    perform varying k from 1 by 1 until k > 300
    unstring    fidetext-rec delimited by x"09"
         into amontext-det(k)   pointer sayac
    end-perform
 
    if amontext-det(1) <> spaces

       move amontext-det(1)    to fdoviz-fide-kodu d-kisa-adi
       add 1 to ydk-doviz-kodu
       move ydk-doviz-kodu  to fdoviz-asya-kodu  doviz-kodu
       move amontext-det(1)    to d-adi-1 
       inspect d-adi-1 converting x"FDD0DCDEDDD6C7E7FEF0FCFDF6"
       to x"8DA69A9E989980879FA7818D94"
              call "c$toupper" using d-adi-1 value 100


       move amontext-det(1)         to D-MERKEZ-BANKA-KODU

       write doviz-rec invalid stop " " end-write 
       write fdoviz-rec end-write 
    end-if 

    |write amontext-rec end-write
    end-read
    end-perform
    close fidetext close amontext fdoviz doviz.


*
 gun-bul.
     initialize gun-s
     move rez-gir-tar to takvim-anah
     start takvim key not < takvim-anah
         invalid 
             continue
          not invalid
             perform until fs-takvim = "10"
                read takvim next no lock
                    end move "10" to fs-takvim
                    not end
                      if takvim-anah >= rez-cik-tar
                          move "10" to fs-takvim
                        else
                          add 1 to gun-s                      
                      end-if 
                end-read
             end-perform  
     end-start.
     move gun-s to gun-say
      .
*
 Form1-Pb-2-Link.
           
     open i-o depkod depkod2
         initialize depkod-rec
         start depkod key not < depkod-anah invalid
                 continue
         not invalid
         perform until fs-depkod = "10"
         read depkod next no lock end move "10" to fs-depkod
         not end
        if depkod-ba = "A" then
                         move depkod-anah to depkod2-anah 
                         read depkod2 no lock invalid
                                 move depkod-rec to depkod2-rec
                         end-read
                          move depkod-rec to depkod2-rec    
                         if DEPKOD-turu = 4 
                            move 07 to depkod2-alt-kate
                            move 01 to DEPKOD-tipi
                         else
                            move 04 to depkod2-alt-kate
                         end-if
        

                         initialize DEPKOD-FATURA-TAKIP
                         write depkod2-rec invalid  
                                 rewrite depkod2-rec invalid
                                      stop " "
                                 end-rewrite
                         end-write
                         write depkod-rec invalid  
                                 rewrite depkod-rec invalid
                                      stop " "
                                 end-rewrite
                         end-write
         else

                 move depkod-anah to depkod2-anah 
                 read depkod2 no lock invalid
                           move depkod-rec to depkod2-rec
                 end-read
                   move depkod-rec to depkod2-rec
                 if DEPKOD-tipi = 2 
                    move 01 to depkod2-alt-kate

                 else
                    move 04 to depkod2-alt-kate
                    move 03 to DEPKOD-tipi
                 end-if

                 move 18 to depkod-kdv
                 write depkod2-rec invalid  
                         rewrite depkod2-rec invalid
                              stop " "
                         end-rewrite
                 end-write
                 write depkod-rec invalid  
                         rewrite depkod-rec invalid
                              stop " "
                         end-rewrite
                 end-write
        end-if
         end-read
         end-perform
         end-start

     close  depkod depkod2
     .
*
 Form1-Pb-3-Link.
                          
       open i-o rez konuk odalar cast
       initialize rez-rec
       start rez key not <rez-anah invalid
               continue
       not invalid
       perform until fs-rez = "10"
       read rez next no lock end move "10" to fs-rez
       not end
     
            if function numval(rez-odano)  < 9000
                    exit perform cycle
            end-if
                           
           if rez-no < 2000000
                move 1 to ref-no
                compute deger-4 = 9001 + ( ref-no * 10 ) 
                move deger-4 to rez-odano 
           end-if
           if rez-no > 2000000 and  rez-no < 3000000
                move 2 to ref-no
                compute deger-4 = 9001 + ( ref-no * 10 ) 
                move deger-4 to rez-odano 
           end-if
          if rez-no > 3000000
                move 3 to ref-no
                compute deger-4 = 9001 + ( ref-no * 10 ) 
                move deger-4 to rez-odano 
           end-if

           initialize odalar-rec
           move rez-odano to odalar-no
           read odalar no lock invalid
                   continue
           end-read
           
           move odalar-konumu to rez-oda-konumu     

           move rez-folio to konuk-folio
           read konuk  no lock invalid
                   continue
           end-read

           move rez-oda-konumu to konuk-oda-konumu |konuk-fiyat-konumu
           move rez-odano      to konuk-odano

           rewrite rez-rec invalid
                   stop " " 
           end-rewrite
           rewrite konuk-rec invalid
                   continue
           end-rewrite


           compute  rez-folio = rez-folio + 1
            move rez-folio to konuk-folio
           read konuk  no lock invalid
                   continue
           end-read

           move rez-oda-konumu to konuk-oda-konumu |konuk-fiyat-konumu
           move rez-odano      to konuk-odano
           rewrite konuk-rec invalid
                   continue
           end-rewrite

                              
               initialize cast-rec  
               move rez-no to CAST-REZ-NO
               start cast key not < CAST-REZ-NO invalid
                       continue
               not invalid
               perform until fs-cast = "10"
               read cast next no lock end move "10" to fs-cast
               not end

                       if CAST-REZ-NO <> rez-no 
                             exit perform 
                       end-if
                 

                       move rez-odano to cast-oda-no
                       move rez-oda-konumu to CAST-ODA-KONUMU
                     |  move rez-oda-konumu to cast-fiyat-konumu

                       rewrite cast-rec invalid
                             stop " "
                       end-rewrite
                     
                   

               end-read
               end-perform
               end-start
 

        end-read
        end-perform
        end-start

       close rez konuk odalar  cast
 
     .

*
 rez-kur.
             
             open i-o rez kur konuk
     initialize rez-rec
     start rez key > rez-anah 
       invalid continue
       not invalid
       perform until fs-rez = "10" 
          read rez next no lock 
            end move "10" to fs-rez
            not end
      
         

         |  IF REZ-NO = 3481887 THEN STOP " " END-IF

           
              move rez-folio to konuk-folio
              read konuk no lock invalid
                      exit perform cycle
              end-read

           
*                   if REZ-DOVIZ <> 10 or konuk-doviz <> 10

*                         if ( rez-cin-kuru = 1 or konuk-kur-degeri  = 1 )  or ( konuk-doviz <> REZ-DOVIZ )
                              
                                 initialize kur-rec
                                 move rez-gir-tar to kur-tarih
                                 move rez-doviz   to KUR-DOVIZ
                                 move 01          to kur-banka
                                 read kur no lock invalid
                                      continue
                                 end-read

                                 move DOVIZ-alis to rez-cin-kuru
                    

                                 move rez-cin-kuru to konuk-kur-degeri
                                 
                                 move rez-doviz to konuk-doviz
                                 compute konuk-oda-tutar = doviz-alis * rez-fiyati
                                 move rez-fiyati to konuk-dv-degeri

                                 rewrite konuk-rec invalid
                                         stop " "
                                 end-rewrite

                                 rewrite rez-rec invalid
                                         stop " "
                                 end-rewrite
                                 DISPLAY rez-rec

*                         end-if
*                   end-if
  
            end-read
            end-perform
            end-start

            close rez  kur  konuk.
 

* 
 acen-kontrol.
    open input acenta rez
    initialize rez-rec
    start rez key not < rez-anah invalid
            continue
    not invalid
    perform until fs-rez = "10"
    read rez next no lock end move "10" to fs-rez
    not end
                  initialize acenta-rec
                  move rez-acenta to acenta-kodu
                  read acenta no lock invalid
                          display message box rez-no " nolu rezervasyonun acenta kodu yok!"
                          stop " "
                  end-read
    end-read
    end-perform
    end-start
    close acenta rez.
*
 Form1-Pb-4-Link.
     
           open i-o acenta  rez konuk   nt kodlar02
                      initialize rez-rec
                      start rez key not < rez-anah invalid 
                              continue
                      not invalid 
                      perform until fs-rez = "10"
                      read rez next no lock end move "10" to fs-rez
                      not end
                             

                              initialize acenta-rec
                              move rez-acenta to acenta-anahtar
                              read acenta no lock invalid
                                      exit perform cycle
                              end-read


                                             
                             initialize not-rec 
                             move "ACE" to not-dos
                             move "Default" to not-dos-anah
                             move rez-acenta to not-dos-anah(8:)
                             read nt no lock  invalid
                                        stop " "
                             not invalid 
                                  move not1 to acen-dft
                             end-read

                             initialize kodlar02-rec
                             move "E" to kodlar02-tipi
                             move acen-dft-pazar to kodlar02-kodu
                             read kodlar02 no lock invalid        
                                     exit perform cycle
                             end-read



                                 move acen-dft-pazar to rez-pazar
                                 rewrite rez-rec invalid continue
                                 end-rewrite
                                 
                                 initialize konuk-rec
                                 move rez-folio to konuk-folio
                                 read konuk no lock invalid 
                                            continue
                                 not invalid 
                                          move acen-dft-pazar to konuk-pazar
                                          rewrite konuk-rec invalid stop " " end-rewrite
                                  end-read
                                        
                       
                                      
                    end-read
                    end-perform 
                    end-start
                     
            close acenta  rez konuk   nt  kodlar02
                         display message box "Islem Tamamlandi FULL ACENTA PAZAR DAGITILDI".
*
 Form1-Pb-5-Link.
     perform castoda-bakim
       display message box "Islem Tamamlandi FULL KONUM DAGITILDI"
     .
*
 Form1-Pb-6-Link.
     open i-o rez konuk
         initialize rez-rec konuk-rec
         start rez key not < rez-anah invalid
                 continue
         not invalid
         perform until fs-rez = "10"
         read rez next no lock end move "10" to fs-rez
         not end
                  
         EXIT PERFORM 
                if rez-ulke = 118 then
                   MOVE 224 TO REZ-ULKE
                end-if
                if rez-ulke = 107 then
                    MOVE 054 TO REZ-ULKE
                end-if
                if rez-ulke = 110 then
                    MOVE 014 TO REZ-ULKE
                end-if
                 if rez-ulke = 111 then
                    MOVE 013 TO REZ-ULKE
                end-if

               if rez-ulke = 112 then
                    MOVE 016 TO REZ-ULKE
                end-if

                 if rez-ulke = 116 then
                    MOVE 034 TO REZ-ULKE
                end-if


                if rez-ulke = 117 then
                    MOVE 020 TO REZ-ULKE
                end-if

                 if rez-ulke = 120 then
                    MOVE 022 TO REZ-ULKE
                end-if

                if rez-ulke = 124 then
                    MOVE 056 TO REZ-ULKE
                end-if

                if rez-ulke = 129 then
                    MOVE 071 TO REZ-ULKE
                end-if

               if rez-ulke = 128 then
                    MOVE 067 TO REZ-ULKE
                end-if

                if rez-ulke = 135 then
                    MOVE 160 TO REZ-ULKE
                end-if

                if rez-ulke = 137 then
                    MOVE 102  TO REZ-ULKE
                end-if

               if rez-ulke = 146 then
                    MOVE 109  TO REZ-ULKE
                end-if

                if rez-ulke = 148 then
                    MOVE 036 TO REZ-ULKE
                end-if


                if rez-ulke = 150 then
                    MOVE  121  TO REZ-ULKE
                end-if

               if rez-ulke = 155 then
                    MOVE  132  TO REZ-ULKE
                end-if

                if rez-ulke = 156 then
                    MOVE 123  TO REZ-ULKE
                end-if


                if rez-ulke = 157 then
                    MOVE  130  TO REZ-ULKE
                end-if

               if rez-ulke = 158 then
                    MOVE  143  TO REZ-ULKE
                end-if

                if rez-ulke = 163 then
                    MOVE 135  TO REZ-ULKE
                end-if


                if rez-ulke = 164 then
                    MOVE  161  TO REZ-ULKE
                end-if

                if rez-ulke = 167 then
                    MOVE  172  TO REZ-ULKE
                end-if
                      
                if rez-ulke = 168 then
                    MOVE 173  TO REZ-ULKE
                end-if


                if rez-ulke = 170 then
                    MOVE  183  TO REZ-ULKE
                end-if

                if rez-ulke = 171 then
                    MOVE  185  TO REZ-ULKE
                end-if
                      
                if rez-ulke = 175 then
                    MOVE 196  TO REZ-ULKE
                end-if



                 if rez-ulke = 176 then
                    MOVE 194    TO REZ-ULKE
                end-if

                if rez-ulke = 182 then
                    MOVE  214  TO REZ-ULKE
                end-if
                      
                if rez-ulke = 105 then
                    MOVE  217  TO REZ-ULKE
                end-if


                 if rez-ulke = 183 then
                    MOVE   222  TO REZ-ULKE
                end-if

                if rez-ulke = 122 then
                    MOVE  053   TO REZ-ULKE
                end-if
                      
                if rez-ulke = 136 then  | INGILTEREEE
                    MOVE 073   TO REZ-ULKE
                end-if

                
                 if rez-ulke = 138 then
                    MOVE   103  TO REZ-ULKE
                end-if

                if rez-ulke = 139 then
                    MOVE  098   TO REZ-ULKE
                end-if
                      
                if rez-ulke = 141 then 
                    MOVE  099  TO REZ-ULKE
                end-if



                
                
                 if rez-ulke = 142 then | ISVEC 
                    MOVE   191   TO REZ-ULKE
                end-if

                if rez-ulke = 143 then  | ISVECCEE 
                    MOVE   041   TO REZ-ULKE
                end-if
                      
                if rez-ulke = 141 then 
                    MOVE   105  TO REZ-ULKE
                end-if


              |  REWRITE rez-rec invalid
              |       |   stop " " 
              |  end-rewrite

                initialize konuk-rec
                move rez-folio to konuk-folio
                read konuk no lock invalid
                        continue
                not invalid
                  |   move rez-ulke to konuk-ulke
                  |   REWRITE konuk-rec invalid
                  |      stop " " 
                  |   end-rewrite
                  continue
                end-read


         end-read
         end-perform
         end-start

         open i-o musteri
         initialize musteri-rec  
         start musteri key not < musteri-anah invalid
                 continue
         not invalid
         perform until fs-musteri = "10"
         read musteri next no lock end move "10" to fs-musteri
         not end 

                      if MUSTERI-ULKE = 118 then
                   MOVE 224 TO MUSTERI-ULKE
                end-if
                if MUSTERI-ULKE = 107 then
                    MOVE 054 TO MUSTERI-ULKE
                end-if
                if MUSTERI-ULKE = 110 then
                    MOVE 014 TO MUSTERI-ULKE
                end-if
                 if MUSTERI-ULKE = 111 then
                    MOVE 013 TO MUSTERI-ULKE
                end-if

               if MUSTERI-ULKE = 112 then
                    MOVE 016 TO MUSTERI-ULKE
                end-if

                 if MUSTERI-ULKE = 116 then
                    MOVE 034 TO MUSTERI-ULKE
                end-if


                if MUSTERI-ULKE = 117 then
                    MOVE 020 TO MUSTERI-ULKE
                end-if

                 if MUSTERI-ULKE = 120 then
                    MOVE 022 TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 124 then
                    MOVE 056 TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 129 then
                    MOVE 071 TO MUSTERI-ULKE
                end-if

               if MUSTERI-ULKE = 128 then
                    MOVE 067 TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 135 then
                    MOVE 160 TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 137 then
                    MOVE 102  TO MUSTERI-ULKE
                end-if

               if MUSTERI-ULKE = 146 then
                    MOVE 109  TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 148 then
                    MOVE 036 TO MUSTERI-ULKE
                end-if


                if MUSTERI-ULKE = 150 then
                    MOVE  121  TO MUSTERI-ULKE
                end-if

               if MUSTERI-ULKE = 155 then
                    MOVE  132  TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 156 then
                    MOVE 123  TO MUSTERI-ULKE
                end-if


                if MUSTERI-ULKE = 157 then
                    MOVE  130  TO MUSTERI-ULKE
                end-if

               if MUSTERI-ULKE = 158 then
                    MOVE  143  TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 163 then
                    MOVE 135  TO MUSTERI-ULKE
                end-if


                if MUSTERI-ULKE = 164 then
                    MOVE  161  TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 167 then
                    MOVE  172  TO MUSTERI-ULKE
                end-if
                      
                if MUSTERI-ULKE = 168 then
                    MOVE 173  TO MUSTERI-ULKE
                end-if


                if MUSTERI-ULKE = 170 then
                    MOVE  183  TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 171 then
                    MOVE  185  TO MUSTERI-ULKE
                end-if
                      
                if MUSTERI-ULKE = 175 then
                    MOVE 196  TO MUSTERI-ULKE
                end-if



                 if MUSTERI-ULKE = 176 then
                    MOVE 194    TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 182 then
                    MOVE  214  TO MUSTERI-ULKE
                end-if
                      
                if MUSTERI-ULKE = 105 then
                    MOVE  217  TO MUSTERI-ULKE
                end-if


                 if MUSTERI-ULKE = 183 then
                    MOVE   222  TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 122 then
                    MOVE  053   TO MUSTERI-ULKE
                end-if
                      
                if MUSTERI-ULKE = 136 then  | INGILTEREEE
                    MOVE 073   TO MUSTERI-ULKE
                end-if

                
                 if MUSTERI-ULKE = 138 then
                    MOVE   103  TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 139 then
                    MOVE  098   TO MUSTERI-ULKE
                end-if
                      
                if MUSTERI-ULKE = 141 then 
                    MOVE  099  TO MUSTERI-ULKE
                end-if



                
                
                 if MUSTERI-ULKE = 142 then | ISVEC 
                    MOVE   191   TO MUSTERI-ULKE
                end-if

                if MUSTERI-ULKE = 143 then  | ISVECCEE 
                    MOVE   041   TO MUSTERI-ULKE
                end-if
                      
                if MUSTERI-ULKE = 141 then 
                    MOVE   105  TO MUSTERI-ULKE
                end-if


                REWRITE musteri-rec invalid
                        stop " " 
                end-rewrite
         end-read
         end-perform
         end-start

     close rez konuk musteri
     display message box "bittti"
     .
*
 Form1-Pb-7-Link.
         open i-o acenta
          initialize acenta-rec
           
          start acenta key not < acenta-kodu invalid
                  continue
          not invalid
          perform until fs-acenta = "10"
          read acenta next no lock end move "10" to fs-acenta
          not end
                  initialize acenta-profil-sirket
                  if function numval(acenta-kodu) > 9000
                  move "otel2015" to acenta-profil-sirket
                  end-if
                  rewrite acenta-rec invalid
                          stop" "
                  end-rewrite

          end-read
          end-perform
          end-start

          close acenta
     .
*
 share-iptal.
    open i-o cast rez
         initialize cast-rec                 
               start cast key not < cast-anah invalid
                       continue
               not invalid
               perform until fs-cast = "10"
               read cast next no lock end move "10" to fs-cast
               not end
                      initialize rez-rec 
                      move cast-rez-no to rez-no
                      read rez no lock invalid 
                          continue 
                      not invalid 
                           if rez-cik-tar = cast-tarih
                             move 0 to  cast-share 
                              move rez-kisi to cast-kisi
                              rewrite cast-rec end-rewrite 
                           end-if 
                      end-read                      
               end-read
               end-perform
               end-start
          close cast rez .

 
