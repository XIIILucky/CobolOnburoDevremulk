* musara.evt
* musara.evt is generated from D:\asya\acugt.ytl\otel\musara.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .

 combo-rapor-baslik-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM combo-rapor-baslik-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           EVALUATE Event-Control-Id
           WHEN 16
              PERFORM Form1-Cb-1aaaa-Ex-Cmd-Clicked
           WHEN 91
              PERFORM cb-yan-adi-Ex-Cmd-Clicked
           WHEN 96
              PERFORM cb-yan-soyadi-Ex-Cmd-Clicked
           END-EVALUATE
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaaaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaaaaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaaaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM cb-voucher-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form6-Event-Proc.
     .

 Form6-Exception-Proc.
     PERFORM Form6-Ex-Other
     .

 Form6-Gd-1-Event-Proc.
     PERFORM Form6-Gd-1-Ev-Other
     .
***   start event editor code   ***
* 1-Check box rapordan deger geldigi zaman renk ve
*   disable enable
* 2-duzenle'de silme'de hata var ...
* 3-yanlis calisiyor ....
****************************************************
 Form1-Bef-Create.
     perform adresleri-tasi.
     move tarih-tasi       to bas-cin-tarih
                              bit-cin-tarih
                              bas-cout-tarih
                              bit-cout-tarih
     open input genel
     initialize genel-rec
     move 1 to genel-anahtar
     read genel no lock invalid
             continue
     end-read
     close genel.
*
 Form1-Cb-1-Ex-Cmd-Clicked.
     display acc-bas-numara acc-bit-numara.
     if ilk-secilen = zeroes
        move 1 to ilk-secilen
        perform cb-renklendir
     else 
        if numara-eh = 0
           if ilk-secilen = 1
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
*
 Form1-Cb-1aa-Ex-Cmd-Clicked.
     display acc-bas-acenta acc-bit-acenta.
     if ilk-secilen = zeroes
        move 2 to ilk-secilen
        perform cb-renklendir
     else 
        if acenta-eh = 0
           if ilk-secilen = 2
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
*
 Form1-Cb-1aaa-Ex-Cmd-Clicked.
     display acc-bas-musteri-adi acc-bit-musteri-adi.
     if ilk-secilen = zeroes
        move 3 to ilk-secilen
        perform cb-renklendir
     else 
        if musteri-adi-eh = 0
           if ilk-secilen = 3
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
*
 Form1-Cb-1aaaa-Ex-Cmd-Clicked.
     display acc-bas-musteri-soy acc-bit-musteri-soy.
     if ilk-secilen = zeroes
        move 4 to ilk-secilen
        perform cb-renklendir
     else 
        if musteri-soyadi-eh = 0
           if ilk-secilen = 4
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
*
 Form1-Cb-1aaaaa-Ex-Cmd-Clicked.
     display acc-bas-cin-gun acc-bas-cin-ay acc-bas-cin-yil
             acc-bit-cin-gun acc-bit-cin-ay acc-bit-cin-yil.
     if ilk-secilen = zeroes
        move 5 to ilk-secilen
        perform cb-renklendir
     else 
        if c-in-tarih-eh = 0
           if ilk-secilen = 5
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
*
 Form1-Cb-1aaaaaa-Ex-Cmd-Clicked.
     display acc-bas-cout-gun acc-bas-cout-ay acc-bas-cout-yil
             acc-bit-cout-gun acc-bit-cout-ay acc-bit-cout-yil.
     if ilk-secilen = zeroes
        move 6 to ilk-secilen
        perform cb-renklendir
     else 
        if c-out-tarih-eh = 0
           if ilk-secilen = 6
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
*
 Form1-Cb-1aaaaaaa-Ex-Cmd-Clicked.
     display acc-bas-voucher acc-bit-voucher.
     if ilk-secilen = zeroes
        move 7 to ilk-secilen
        perform cb-renklendir
     else 
        if voucher-eh = 0
           if ilk-secilen = 7
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
*
 Form1-Ex-Other.
     if key-status = 1
        perform yardimlar
     end-if
     
     if key-status = 2 or key-status = 2003 or
        key-status = 2004
        continue
     else
        exit paragraph
     end-if.
     if key-status = 2004
        perform acu-form6-routine
        exit paragraph
     end-if.

     if numara-eh = 0 and
        acenta-eh = 0 and musteri-adi-eh = 0 and
        musteri-soyadi-eh = 0 and c-in-tarih-eh = 0 and
        c-out-tarih-eh = 0 and oda-eh = 0 and yan-adi-eh = 0
        and yan-soyadi-eh = 0
            display message box 
                    "Raporu alabilmeniz icin ana secimlerden birini secmek zorundasiniz !!!"
                    icon mb_warning_icon
                    title "Uyari"
                    move 4 to accept-control
                    move 12 to control-id
                    exit paragraph
     end-if.

     perform Acc-Bit-Numara-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 21 to control-id
        exit paragraph.

     perform Acc-Bas-Acenta-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 28 to control-id
        exit paragraph.

     perform Acc-Bit-Acenta-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 29 to control-id
        exit paragraph.

     perform Acc-Bit-Musteri-Adi-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 31 to control-id
        exit paragraph.

     perform Acc-Bit-Musteri-Soy-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 33 to control-id
        exit paragraph.

     perform Acc-Bas-Cin-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 34 to control-id
        exit paragraph.

     perform Acc-Bit-Cin-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 37 to control-id
        exit paragraph.

     perform Acc-Bas-Cout-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 40 to control-id
        exit paragraph.

     perform Acc-Bit-Cout-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 43 to control-id
        exit paragraph.

     perform Acc-Bit-Voucher-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 47 to control-id
        exit paragraph.

     perform Acc-Bas-Banka-Kodu-Aft-Procedure.
     if gec-gecme = 1  
        move 4 to accept-control
        move 54 to control-id
        exit paragraph.

     perform Acc-Bas-Doviz-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 58 to control-id
        exit paragraph.

     perform Acc-Bas-Anlasma-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 62 to control-id
        exit paragraph.

     perform Acc-Bas-Odeme-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 66 to control-id
        exit paragraph.

     perform Acc-Bas-Ulke-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 74 to control-id
        exit paragraph.

     perform Acc-Bas-Pazar-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 82 to control-id
        exit paragraph.

     perform Acc-Bas-Pansiyon-Kodu-Aft-Procedure.
     if gec-gecme = 1
        move 4 to accept-control
        move 70 to control-id
        exit paragraph.

     move key-status to rapor-sekil.
     perform dokumer-islem.
     initialize esleme-i.

     exit paragraph.
*
 Form1-Aft-Initdata.


     initialize degiskenler degiskenler-1.
     modify combo-rezervasyon-turu, reset-list = 1
                                    mass-update = 1
     modify combo-musteri-turu,     reset-list = 1
                                    mass-update = 1
     modify combo-rezervasyon-durumu, reset-list = 1
                                      mass-update = 1
     modify combo-kur-tipi,         reset-list = 1
                                    mass-update = 1
     modify combo-rapor-baslik      reset-list = 1 
                                    mass-update = 1

                           
     modify combo-rezervasyon-turu,
     item-to-add("H-Hepsi","R-Room","E-Extra","T-Telefon","G-Grup")
     move "H-Hepsi" to combo-rezervasyon-turu-value

     modify combo-musteri-turu,
     item-to-add("N-Normal","V-Vip","T-Top Vip","H-Hepsi")
     move "N-Normal" to combo-musteri-turu-value

     modify combo-rezervasyon-durumu,
     item-to-add("I-Inhouse","H-History ")
     move "I-Inhouse" to combo-rezervasyon-durumu-value.

     modify combo-kur-tipi,
     item-to-add("H-Hepsi","G-Gunluk","A-Aybasi")
     move "H-Hepsi" to combo-kur-tipi-value

*/ form2 => degiskenleri
     move "0-Hepsi" to combo-oda-tipi-value
     move "00-Hepsi" to combo-oda-konumu-value
     move "H-Hepsi" to combo-rezervasyon-k-w-value
     move "Hepsi"   to combo-kullanici-kodu-value
     move 1         to cin-rezler-ciksin eb-rezler-ciksin
     move "A-Toplamsiz"  to combo-toplamlar-value

*/ Raporlarin isimleri aliniyor ...
     open input rapor.
     initialize rapor-rec
     move "A"         to rapor-tipi
     start rapor key not < rapor-anahtar invalid
           continue
     not invalid
     initialize fs-rapor i
     perform with test after until fs-rapor = "10"
     read rapor next no lock end move "10" to fs-rapor
     not at end
          if rapor-tipi = "A" 
             initialize rapor-baslik
             move rapor-no       to rapor-baslik
             move "-"            to rapor-baslik(5:)
             move rapor-adi      to rapor-baslik(6:)
             add 1 to i
             if i = 1 
                move rapor-baslik to gecici-rapor-baslik
             end-if
             modify combo-rapor-baslik,
                    item-to-add(rapor-baslik)
          else
             move "10" to fs-rapor
             exit perform
          end-if
     end-read
     end-perform
     end-start
     close rapor.

     modify combo-rezervasyon-turu, mass-update = 0
                                    value combo-rezervasyon-turu-value
     modify combo-musteri-turu,     mass-update = 0
                                    value combo-musteri-turu-value
     modify combo-rezervasyon-durumu,mass-update = 0 
                                    value combo-rezervasyon-durumu-value
     modify combo-kur-tipi,         mass-update = 0
                                    value combo-kur-tipi-value.
     modify combo-rapor-baslik      mass-update = 0
                                    value gecici-rapor-baslik.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 acc-bas-acenta-Aft-Procedure.
     initialize gec-gecme.
     if acenta-eh = 0
        exit paragraph.

     if bas-acenta <> spaces
        open input acenta 
        move bas-acenta  to acenta-kodu
        read acenta no lock invalid 
             move "Tanimsiz" to acenta-adi
             move 1 to gec-gecme
        end-read
        close acenta
     else
        move "Tumu ... " to acenta-adi
     end-if.
     display lb-bas-acenta-adi.
*
 acc-bit-acenta-Aft-Procedure.
     initialize gec-gecme.
     if acenta-eh = 0
        exit paragraph.

     if bit-acenta = spaces
        move "Tumu ..." to acenta-adi
        display lb-bit-acenta-adi
        exit paragraph.

     open input acenta
     move bit-acenta to acenta-kodu
     read acenta no lock invalid
          move "Tanimsiz ..."  to acenta-adi
          move 1 to gec-gecme
     end-read
     close acenta.
     display lb-bit-acenta-adi.

     if bas-acenta <> spaces and bit-acenta <> spaces
        if bas-acenta > bit-acenta
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bit-musteri-adi-Aft-Procedure.
     initialize gec-gecme.
     if musteri-adi-eh = 0
        exit paragraph.
     if bas-musteri-adi <> spaces and bit-musteri-adi <> spaces
        if bas-musteri-adi > bit-musteri-adi
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bit-musteri-soy-Aft-Procedure.
     initialize gec-gecme.
     if musteri-soyadi-eh = 0 
        exit paragraph.
     if bas-musteri-soy <> spaces and bit-musteri-soy <> spaces
        if bas-musteri-soy > bit-musteri-soy
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-cin-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-in-tarih-eh = 0
        exit paragraph.
     if bas-cin-tarih <> 0
        open input takvim
        move bas-cin-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.
*
 acc-bit-cin-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-in-tarih-eh = 0
        exit paragraph.
     if bit-cin-tarih <> 0
        open input takvim
        move bit-cin-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.

     if bas-cin-tarih <> 0 and bas-cin-tarih <> 0
        if bas-cin-tarih > bit-cin-tarih
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-cout-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-out-tarih-eh = 0
        exit paragraph.
     if bas-cout-tarih <> 0
        open input takvim
        move bas-cout-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.
*
 acc-bit-cout-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-out-tarih-eh = 0
        exit paragraph.
     if bit-cout-tarih <> 0
        open input takvim
        move bit-cout-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.

     if bas-cout-tarih <> 0 and bas-cout-tarih <> 0
        if bas-cout-tarih > bit-cout-tarih
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bit-voucher-Aft-Procedure.
     initialize gec-gecme.
     if oda-eh = 0 
        exit paragraph.
     if bas-oda <> spaces and bit-oda <> spaces
        if bas-oda > bit-oda
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-banka-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-banka-kodu <> 0
        open input banka
        move bas-banka-kodu   to banka-kodu
        read banka no lock invalid
             move 1 to gec-gecme
             move "Tanimsiz ..." to banka-adi
        end-read
        close banka
     else
        move "Tumu ..."  to banka-adi
     end-if.
     display lb-banka-adi.
*
 acc-bas-doviz-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-doviz-kodu <> 0
        open input doviz
        move bas-doviz-kodu   to doviz-kodu
        read doviz no lock invalid
             move 1 to gec-gecme
             move "Tanimsiz ..."  to d-adi-1
        end-read
        close doviz
     else
        move "Tumu ..." to d-adi-1
     end-if.
     display lb-doviz-adi.
*
 acc-bas-anlasma-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-anlasma-kodu <> spaces
        open input kodlar02
        move "D"              to kodlar02-tipi
        move bas-anlasma-kodu to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-anlasma-adi.
*
 acc-bas-odeme-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-odeme-kodu <> spaces
        open input kodlar02
        move "B"              to kodlar02-tipi
        move bas-odeme-kodu   to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-odeme-adi.
*
 acc-bas-ulke-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-ulke-kodu <> spaces
        open input ulke
        move bas-ulke-kodu   to ulke-anah
        read ulke no lock invalid
             move "Tanimsiz ..." to ulke-adi
             move 1 to gec-gecme
        end-read
        close ulke
     else
        move "Tumu ..." to ulke-adi
     end-if.
     display lb-ulke-adi.
*
 acc-bas-pazar-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-pazar-kodu <> spaces 
        open input kodlar02
        move "E"              to kodlar02-tipi
        move bas-pazar-kodu   to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-pazar-adi.
*
 acc-bas-pansiyon-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-pansiyon-kodu <> spaces
        open input kodlar02
        move "A"                 to kodlar02-tipi
        move bas-pansiyon-kodu   to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-pansiyon-adi.
     .
*

 dokumer-islem.
     open i-o genelfis.
     move 1 to genelfis-anahtar.
     read genelfis no lock invalid
          accept print-no from time
     end-read
     add 1 to print-no
     rewrite genelfis-rec invalid continue end-rewrite
     close genelfis.
**************************
     initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya

     set  dokumer-asya-set to true
     move print-no         to dokumer-dosya-adi
     open output dokumer
*/WINDOW TITLE
     initialize dokumer-rec detay
     move "W"                  to det-dokumer-20(1:)
     move rapor-baslik   to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR
     initialize dokumer-rec detay
     move "1"            to det-dokumer-20(10:1)
     move "B"            to det-dokumer-20(1:1)
     move rapor-baslik   to det-filler
     write dokumer-rec from detay


     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:1)
     write dokumer-rec from detay


*/ DOKUMER OZELLIKLER-REC
     initialize dokumer-rec detay
     move "O" to det-dokumer-20(1:)
     move "E" to dokumer-oto-sayfa-basi
     move 56  to dokumer-oto-sayfa-satir
     move "|" to dokumer-detay-kolon-ayirici
     move "RLLRRRRRRLLLLLLLLLLLLLLL" to dokumer-align-occ
     move dokumer-ozellikler-rec     to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR  

     initialize dokumer-rec detay 
     move "1"          to det-dokumer-20(10:1)
     move "D1"         to det-dokumer-20(1:2)
     move "Folio"            to det-1
     move "Adi"              to det-2
     move "Soyadi"           to det-3
     move "Yan Adi"              to det-201
     move "Yan Soyadi"           to det-202
     move "Yan Adi"              to det-203
     move "Yan Soyadi"           to det-204
     move "Pax"              to det-4
     move "Chi"              to det-5
     move "Free"             to det-6
     move "Beb."             to det-66
     move "C/in"             to det-7
     move "C/out"            to det-8
     move "F"                to det-9
     move "Odeme"            to det-10
     move "Acenta"           to det-11
     move "Ulke"             to det-12
     move "Voucher"          to det-13
     move "Anlas"            to det-14
     move "Bn"               to det-15
     move "Dv"               to det-16
     move "Gunluk Fiyat"     to det-17
     move "Gun"              to det-18
     move "Toplam Fiyat"     to det-19
     move "Pazar"            to det-20
     move "X"                to det-21
     move "Pk"               to det-22
     move "K"                to det-23
     move "Konum"            to det-24
     move "Tip"              to det-25
     move "Oda"              to det-26
     move "Grup"             to det-27
     move "GS"               to det-28
     move "Telefon No"       to det-29
     move "E-Mail"           to det-30
     move "Plaka"            to det-31.
     move "Staff"            to det-32.
     move " Telefon   "      to det-33.
     move "Aciklama"         to det-34 
     move "|" to fil-1 fil-2 fil-3 fil-4 fil-34
     fil-5 fil-6 fil-66 fil-7 fil-8 fil-9 fil-10 fil-11
     fil-12 fil-13 fil-14 fil-15 fil-16 fil-17
     fil-18 fil-19 fil-20 fil-21 fil-22 fil-23
     fil-24 fil-25 fil-26 fil-27 fil-28 fil-29
     fil-30 fil-31 fil-32 fil-33  fil-201 fil-202 fil-203 fil-204
     write dokumer-rec from detay

     initialize dokumer-rec detay
     move "D2"           to det-dokumer-20(1:2)
     move "-"            to det-dokumer-20(5:1)
     move all "-" to det-1 det-2 det-3 det-4
     det-5 det-6 det-66 det-7 det-8 det-9 det-10 det-11
     det-12 det-13 det-14 det-15 det-16 det-17
     det-18 det-19 det-20 det-21 det-22 det-23
     det-24 det-25 det-26 det-27 det-28 det-29 det-34
     det-30 det-31 det-32 det-33  det-201 det-202 det-203 det-204
     write dokumer-rec from detay
*********************************

     perform islem.
     close dokumer takas
     call dokumer-prog on exception
          perform callerr-proc
     not on exception
          cancel dokumer-prog
     end-call
     delete file dokumer takas.
*
 duzenle-islem.

 islem.
     open i-o genelfis.
     move 1 to genelfis-anahtar
     read genelfis no lock invalid
          move 1 to ekran-fis-1
     end-read
     add 1 to ekran-fis-1
     rewrite genelfis-rec invalid
             write genelfis-rec end-write
     end-rewrite
     close genelfis.
    
     move ekran-fis-1(2:)    to takas-no
     open output takas close takas open i-o takas with mass-update.
     initialize toplam
     open input konuk ozluk kodlar02 acenta ulke konum kllnc rez.
     initialize konuk-rec fs-konuk
     move combo-rezervasyon-durumu-value(1:1)  to konuk-durumu ozluk-durumu
     evaluate true
          when ilk-secilen  = 1
               move bas-numara to konuk-rez-no
               start konuk key not < konuk-rez invalid
                     move "89" to fs-konuk
               end-start
          when ilk-secilen = 2 
               move bas-acenta to konuk-acenta 
               start konuk key not < konuk-acen invalid
                     move "89" to fs-konuk
               end-start
          when ilk-secilen = 3
               move bas-musteri-adi to konuk-adi
               start konuk key not < konuk-ad invalid 
                     move "89" to fs-konuk
               end-start
          when ilk-secilen = 4
               move bas-musteri-soy to konuk-soyadi
               start konuk key not < konuk-soy invalid 
                     move "89" to fs-konuk
               end-start
          when ilk-secilen = 5
               move bas-cin-tarih to konuk-gel-tar
               start konuk key not < konuk-gel invalid 
                     move "89" to fs-konuk
               end-start
          when ilk-secilen = 6
               move bas-cout-tarih to konuk-git-tar
               start konuk key not < konuk-git invalid 
                     move "89" to fs-konuk
               end-start
          when ilk-secilen = 7
               move bas-oda to konuk-odano
               start konuk key not < konuk-oda invalid 
                     move "89" to fs-konuk
               end-start
          when ilk-secilen = 8
               move bas-yan-adi to ozluk-yani-adi1
               start ozluk key not < ozluk-yani1-adi invalid 
                     move "89" to fs-konuk
               end-start
          when ilk-secilen = 9
               move bas-yan-soyadi to ozluk-yani-soy1
               start ozluk key not < ozluk-yani1-adi invalid 
                     move "89" to fs-konuk
               end-start

     end-evaluate.
    
     if fs-konuk = "89"
           display message box
                   "Kayit bulunamadi ..."
           close konuk ozluk kodlar02 acenta ulke konum kllnc  
           delete file takas
           exit paragraph.

     initialize fs-konuk
     perform with test after until fs-konuk = "10"

          if ilk-secilen < 8
           read konuk next no lock end 
                move "10" to fs-konuk
                exit perform
           not at end
                initialize ozluk-rec
                move konuk-folio to ozluk-folio
                read ozluk no lock invalid
                     continue
                end-read
           end-read
          else
           read ozluk next no lock end move "10" to fs-konuk
           not at end
               move ozluk-anah to konuk-folio
               read konuk no lock invalid
                    continue
               end-read
           end-read
          end-if

*          if ilk-secilen not = 1
             if combo-rezervasyon-durumu-value(1:1) <> konuk-durumu
                move "10" to fs-konuk
                exit perform
             end-if
*          end-if 
          if ilk-secilen = 01 and bit-numara not = 0
             if konuk-rez-no > bit-numara 
                move "10" to fs-konuk
                exit perform
             end-if
          end-if
          if ilk-secilen = 02 and bit-acenta not = spaces
             if konuk-acenta > bit-acenta
                move "10" to fs-konuk
                exit perform 
             end-if
          end-if
          if ilk-secilen = 03  and bit-musteri-adi not = spaces
             if konuk-adi > bit-musteri-adi
                move "10" to fs-konuk
                exit perform
             end-if
          end-if
          if ilk-secilen = 04  and bit-musteri-soy not = spaces
             if konuk-soyadi > bit-musteri-soy
                move "10" to fs-konuk
                exit perform
             end-if
          end-if
          if ilk-secilen = 05 and bit-cin-tarih not = 0
             if konuk-gel-tar > bit-cin-tarih
                move "10" to fs-konuk
                exit perform
             end-if
          end-if
          if ilk-secilen = 06 and bit-cout-tarih not = 0
             if konuk-git-tar > bit-cout-tarih
                move "10" to fs-konuk
                exit perform
             end-if
          end-if
          if ilk-secilen = 07 and bit-oda not = spaces
             if konuk-odano > bit-oda
                move "10" to fs-konuk
                exit perform
             end-if
          end-if
          if ilk-secilen = 08 and bit-yan-adi not = spaces
             if ozluk-yani-adi1 > bit-yan-adi
                move "10" to fs-konuk
                exit perform
             end-if
          end-if
          if ilk-secilen = 09 and bit-yan-soyadi not = spaces
             if ozluk-yani-soy1 > bit-yan-soyadi
                move "10" to fs-konuk
                exit perform
             end-if
          end-if
*-------------------------------------------------------
*/ ana filtreler tekrar sorgulaniyor ...
*-------------------------------------------------------
          if numara-eh > 0
             if (bas-numara <> 0 and konuk-rez-no < bas-numara) or
                (bit-numara <> 0 and konuk-rez-no > bit-numara)
                     exit perform cycle
             end-if
          end-if
          if acenta-eh > 0
             if (bas-acenta <> spaces and konuk-acenta < bas-acenta) or 
                (bit-acenta <> spaces and konuk-acenta > bit-acenta)
                   exit perform cycle
             end-if
          end-if
          
          if musteri-adi-eh > 0
            
             if ((bas-musteri-adi <> spaces and konuk-adi < bas-musteri-adi) or
                (bit-musteri-adi <> spaces and konuk-adi > bit-musteri-adi))
                and 
                ((bas-musteri-adi <> spaces and  OZLUK-YANI-ADI1 < bas-musteri-adi) or
                 (bit-musteri-adi <> spaces and  OZLUK-YANI-ADI1 > bit-musteri-adi))     and
               
                ((bas-musteri-adi <> spaces  and  OZLUK-YANI-ADI2 < bas-musteri-adi) or
                 (bit-musteri-adi  <> spaces and  OZLUK-YANI-ADI2 > bit-musteri-adi))    
                 
                     exit perform cycle
             end-if

          end-if
          if musteri-soyadi-eh > 0
             if ((bas-musteri-soy <> spaces and konuk-soyadi < bas-musteri-soy) or
                (bit-musteri-soy <> spaces and konuk-soyadi > bit-musteri-soy)   ) AND
                ((bas-musteri-soy <> spaces and  OZLUK-YANI-SOY1  < bas-musteri-soy) or
                (bit-musteri-soy <> spaces and   OZLUK-YANI-SOY1 > bit-musteri-soy)   ) AND
                ((bas-musteri-soy <> spaces and OZLUK-YANI-SOY2 < bas-musteri-soy) or
                (bit-musteri-soy <> spaces and  OZLUK-YANI-SOY2 > bit-musteri-soy)   ) 
                     exit perform cycle
             end-if
          end-if
          if c-in-tarih-eh > 0
             if (bas-cin-tarih <> 0 and konuk-gel-tar < bas-cin-tarih) or
                (bit-cin-tarih <> 0 and konuk-gel-tar > bit-cin-tarih)
                     exit perform cycle
             end-if
          end-if
          if c-out-tarih-eh > 0
             if (bas-cout-tarih <> 0 and konuk-git-tar < bas-cout-tarih) or
                (bit-cout-tarih <> 0 and konuk-git-tar > bit-cout-tarih)
                     exit perform cycle
             end-if
          end-if
          if oda-eh > 0
             if (bas-oda <> spaces and konuk-odano < bas-oda) or
                (bit-oda <> spaces and konuk-odano > bit-oda)
                     exit perform cycle
             end-if
          end-if
          if yan-adi-eh > 0
             if (bas-yan-adi <> spaces and ozluk-yani-adi1 < bas-yan-adi) or
                (bit-yan-adi <> spaces and ozluk-yani-adi1 > bit-yan-adi)
                     exit perform cycle
             end-if
          end-if
          if yan-soyadi-eh > 0
             if (bas-yan-soyadi <> spaces and ozluk-yani-soy1 < bas-yan-soyadi) or
                (bit-yan-soyadi <> spaces and ozluk-yani-soy1 > bit-yan-soyadi)
                     exit perform cycle
             end-if
          end-if
*-------------------------------------------------------
*/ yardimci filtreler sorgulaniyor ... 
*-------------------------------------------------------
          if combo-rezervasyon-turu-value(1:1) <> "H"
             if combo-rezervasyon-turu-value(1:1) <> konuk-fol-kodu
                exit perform cycle
             end-if
          end-if
          if bas-grup-kodu <> spaces
             if bas-grup-kodu <> konuk-grup-no
                exit perform cycle
             end-if
          end-if
          if combo-kur-tipi-value(1:1) <> "H"
             if combo-kur-tipi-value(1:1) <> konuk-kur-aygun
                exit perform cycle
             end-if
          end-if
          if bas-dogum-tar <> "0000"
             if bas-dogum-gun = ozluk-dogum-gun and
                bas-dogum-ay  = ozluk-dogum-ay  
                    continue
             else
                exit perform cycle
             end-if
          end-if
          if bas-evlilik-tar <> "0000"
             if bas-evlilik-gun = ozluk-evlilik-gun and
                bas-evlilik-ay  = ozluk-evlilik-ay  
                    continue
             else
                exit perform cycle
             end-if
          end-if
          if bas-banka-kodu <> 0
             if bas-banka-kodu not = konuk-banka 
                    exit perform cycle
             end-if
          end-if
          if konuk-gelis-sayisi not numeric 
             initialize konuk-gelis-sayisi
          end-if
          if gelis-sayisi   <> 0
             if ( gelis-sayisi  > konuk-gelis-sayisi ) 
                
                    exit perform cycle
             end-if
          end-if
          if gelis-sayisi2   <> 0
             if  gelis-sayisi2  < konuk-gelis-sayisi 
               
                    exit perform cycle
             end-if
          end-if
          if bas-doviz-kodu <> 0
             if bas-doviz-kodu not =  konuk-doviz
                    exit perform cycle
             end-if
          end-if
          if bas-anlasma-kodu <> spaces
             if bas-anlasma-kodu not = konuk-anlasma 
                     exit perform cycle
             end-if
          end-if
          if bas-odeme-kodu <> spaces
             if bas-odeme-kodu not = konuk-odeme-tipi 
                     exit perform cycle
             end-if
          end-if
          if bas-ulke-kodu <> spaces
             if bas-ulke-kodu not = konuk-ulke 
                     exit perform cycle
             end-if
          end-if

          if bas-pazar-kodu <> spaces
             if bas-pazar-kodu > konuk-pazar or 
                bas-pazar-kodu < konuk-pazar
                     exit perform cycle
             end-if
          end-if
          if bas-pansiyon-kodu <> spaces
             if bas-pansiyon-kodu not = konuk-pan-tipi
                     exit perform cycle
             end-if
          end-if
*          if combo-musteri-turu-value(1:1) = "N" or 
*             combo-musteri-turu-value(1:1) = konuk-vip
*             continue
*          else 
*             exit perform cycle
*          end-if
      if ((konuk-vip = "N" or konuk-vip = " ") and cb-nor-v = 0 ) or
         ((konuk-vip   not = "N" and konuk-vip not = " ") and cb-vip2-v = 0)
          exit perform cycle
      end-if
      if cb-plaka-val = 1 
         if ozluk-plaka = spaces
             exit perform cycle 
         end-if
      end-if

*/ gelismis filtreler sorgulaniyor
*-------------------------------------------------------
          if combo-oda-tipi-value(1:1) <> "0" 
             if combo-oda-tipi-value(1:1) <> konuk-s-d-t-g
                   exit perform cycle
             end-if
          end-if
          if combo-oda-konumu-value(1:2) <> "00"
             if combo-oda-konumu-value(1:2) <> konuk-oda-konumu
                exit perform cycle
             end-if
          end-if
*          if combo-kullanici-no <> spaces 
*             if combo-kullanici-no <> konuk-staf
*                exit perform cycle
*             end-if
*          end-if
*          if eb-rezler-ciksin = 0
*             if konuk-eb = "E"
*                exit perform cycle
*             end-if
*          end-if
*          if buyuk-sayi <> 0
*             if buyuk-sayi <> konuk-buyuk
*                exit perform cycle
*             end-if
*          end-if
*          if kucuk-sayi <> 0
*             if kucuk-sayi <> konuk-kucuk
*                exit perform cycle
*             end-if
*          end-if
*          if free-sayi <> 0
*             if free-sayi <> konuk-free
*                exit perform cycle
*             end-if
*          end-if
*****************APO STOP " "
*          if komisyon-orani <> 0
*             if komisyon-orani <> konuk-komisyon
*                exit perform cycle
*             end-if
*          end-if
*-------------------------------------------------------
          initialize rez-rec
          move konuk-rez-no to rez-no
          read rez no lock invalid
                  continue
          end-read
         if onkpara-referans-var = 1 then 
             perform ref-filtre
             if  not ref-gecti then 
               exit perform cycle
             end-if
          end-if

          perform detay-ata
     end-perform.
          perform liste-toplam
     close konuk ozluk kodlar02 acenta ulke konum kllnc rez.
 detay-ata.
     set dokumere-yolla to true.
     if dokumere-yolla
        initialize dokumer-rec detay
        move konuk-folio             to det-1
        move konuk-adi               to det-2
        move konuk-soyadi            to det-3
         move ozluk-YANI-adi1               to det-201
        move ozluk-YANI-soy1            to det-202
         move ozluk-YANI-adi2               to det-203
        move ozluk-YANI-soy2            to det-204
        
        
        
        
        move konuk-buyuk             to 4-z
        move 4-z                     to det-4
        move konuk-kucuk             to 4-z
        move 4-z                     to det-5
        move konuk-free              to 4-z
        move 4-z                     to det-6
        move konuk-bebek             to 4-z
        move 4-z                     to det-66
        move konuk-gel-gun           to egun
        move konuk-gel-ay            to eay
        move konuk-gel-yil           to eyil
        move etarih                  to det-7
        move konuk-git-gun           to egun
        move konuk-git-ay            to eay
        move konuk-git-yil           to eyil
        move etarih                  to det-8
        move konuk-fol-kodu          to det-9
        move konuk-odeme-tipi          to kodlar02-kodu
        move "B"                       to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"  to kodlar02-adi
        end-read
        move kodlar02-adi            to det-10
        move konuk-acenta              to acenta-anahtar
        read acenta no lock invalid
             move "Tanimsiz"   to acenta-adi
        end-read
        move acenta-adi              to det-11
        move konuk-ulke                to ulke-anah
        read ulke no lock invalid 
             move "Tanimsiz"         to ulke-adi
        end-read
        move ulke-adi                to det-12
        move konuk-voucher             to det-13
        move konuk-anlasma             to kodlar02-kodu
        move "D"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"     to kodlar02-adi
        end-read
        move kodlar02-adi            to det-14
        move konuk-banka               to det-15
        move konuk-doviz               to det-16
        initialize temp-sayi
        compute temp-sayi = 
           konuk-oda-tutar       +
           konuk-extbed-tutar    +
           konuk-kahvalti-tutar  +
           konuk-ogle-tutar      +
           konuk-aksam-tutar     +
           konuk-icecek-tutar    +
           konuk-extra-tutar     
        compute t-oda   = t-oda   + 1
        compute t-pax   = t-pax   + konuk-buyuk
        compute t-chi   = t-chi   + konuk-kucuk
        compute t-fre   = t-fre   + konuk-free
        compute t-beb   = t-beb   + konuk-bebek

        move temp-sayi               to 15-z
        move 15-z                    to det-17
        move konuk-gel-tar           to g-bul-ilk-tarih
        move konuk-git-tar           to g-bul-son-tarih
        perform g-bul thru g-bul-exit
        move g-bul-gun-sayisi        to 4-z
        move 4-z                     to det-18
        compute temp-sayi = g-bul-gun-sayisi * temp-sayi
        move temp-sayi               to 15-z
        move 15-z                    to det-19
        move konuk-pazar             to kodlar02-kodu
        move "E"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"      to kodlar02-adi
        end-read
        move kodlar02-adi            to det-20
        move konuk-eb                to det-21
        move konuk-pan-tipi            to det-22
        move konuk-kur-aygun           to det-23
        move konuk-oda-konumu          to konum-anahtar
        read konum no lock invalid
             move "Tanimsiz" to konum-adi
        end-read
        move konum-adi               to det-24
        evaluate konuk-s-d-t-g
             when 1 move "Single"    to det-25
             when 2 move "Double"    to det-25
             when 3 move "Triple"    to det-25
             when 4 move "Grup"      to det-25
        end-evaluate
        move konuk-odano               to det-26
        move konuk-grup-no             to det-27
        move konuk-gelis-sayisi        to det-28
        move ozluk-telno               to det-29
        move ozluk-e-mail              to det-30
        move ozluk-plaka               to det-31

        move konuk-staf                to k-kodu
        read kllnc no lock invalid
             move "Tanimsiz"     to k-adi
        end-read
        move k-adi                   to det-32
        move ozluk-telno             to det-33
        string det-34 
               konuk-acik-1 delimited by "    "
               " " delimited by size
               konuk-acik-2 delimited by size 
        into det-34

        move "|" to fil-1 fil-2 fil-3 fil-4
        fil-5 fil-6 fil-66 fil-7 fil-8 fil-9 fil-10 fil-11
        fil-12 fil-13 fil-14 fil-15 fil-16 fil-17
        fil-18 fil-19 fil-20 fil-21 fil-22 fil-23
        fil-24 fil-25 fil-26 fil-27 fil-28 fil-29  fil-34
        fil-30 fil-31 fil-32 fil-33  fil-201 fil-202 fil-203 fil-204
        write dokumer-rec from detay
     else
        continue
*        initialize takas-rec
*        if combo-toplamlar-value(1:1) <> "A"
*           evaluate combo-toplamlar-value(1:1)
*               when "B"  move rez-pazar        to takas-anahtar1
*               when "C"  move rez-pan-tipi     to takas-anahtar1
*               when "D"  move rez-ulke         to takas-anahtar1
*               when "E"  move rez-anlasma      to takas-anahtar1
*               when "F"  move rez-s-d-t-g      to takas-anahtar1
*               when "G"  move rez-oda-konumu   to takas-anahtar1
*               when "H"  move rez-odeme-tipi   to takas-anahtar1
*               when "I"  move rez-doviz        to takas-anahtar1
*               when "J"  move rez-eb           to takas-anahtar1
*               when "K"  move rez-acenta       to takas-anahtar1
*           end-evaluate
*           move low-values                     to takas-anahtar2
*           read takas no lock invalid 
*                continue
*           end-read
*           add rez-buyuk         to takas-pax
*           add rez-kucuk         to takas-child
*           add rez-free          to takas-free
*           add temp-sayi         to takas-fiyat 
*           add 1                 to takas-adet
*           write takas-rec invalid
*                 rewrite takas-rec end-rewrite
*           end-write
*           if esleme-i > 0
*              initialize takas-rec
*              evaluate combo-toplamlar-value(1:1)
*                  when "B"  move rez-pazar        to takas-anahtar1
*                  when "C"  move rez-pan-tipi     to takas-anahtar1
*                  when "D"  move rez-ulke         to takas-anahtar1
*                  when "E"  move rez-anlasma      to takas-anahtar1
*                  when "F"  move rez-s-d-t-g      to takas-anahtar1
*                  when "G"  move rez-oda-konumu   to takas-anahtar1
*                  when "H"  move rez-odeme-tipi   to takas-anahtar1
*                  when "I"  move rez-doviz        to takas-anahtar1
*                  when "J"  move rez-eb           to takas-anahtar1
*                  when "K"  move rez-acenta       to takas-anahtar1
*              end-evaluate
*
*              evaluate esleme-i
*                  when 01 move rez-acenta       to takas-anahtar2
*                  when 02 move rez-pan-tipi     to takas-anahtar2
*                  when 03 move rez-anlasma      to takas-anahtar2
*                  when 04 move rez-oda-konumu   to takas-anahtar2
*                  when 05 move rez-doviz        to takas-anahtar2
*                  when 06 move rez-pazar        to takas-anahtar2
*                  when 07 move rez-ulke         to takas-anahtar2
*                  when 08 move rez-s-d-t-g      to takas-anahtar2
*                  when 09 move rez-odeme-tipi   to takas-anahtar2
*                  when 10 move rez-eb           to takas-anahtar2
*              end-evaluate
*              read takas no lock invalid 
*                   continue
*              end-read
*              add rez-buyuk         to takas-pax
*              add rez-kucuk         to takas-child
*              add rez-free          to takas-free
*              add temp-sayi         to takas-fiyat 
*              add 1                 to takas-adet
*              write takas-rec invalid
*                    rewrite takas-rec end-rewrite
*              end-write
*           end-if
*        end-if
     end-if.

 liste-toplam.
     set dokumere-yolla to true.
     if dokumere-yolla
        initialize dokumer-rec detay
        move "-"            to det-dokumer-20(5:1)
        move all "-" to det-1 det-2 det-3 det-4
        det-5 det-6 det-66 det-7 det-8 det-9 det-10 det-11
        det-12 det-13 det-14 det-15 det-16 det-17
        det-18 det-19 det-20 det-21 det-22 det-23
        det-24 det-25 det-26 det-27 det-28 det-29 det-34
        det-30 det-31 det-32 det-33  det-201 det-202 det-203
        det-204
        write dokumer-rec from detay
        initialize dokumer-rec detay
        move "Genel"                 to det-2
        move "Toplam"                to det-3
        move t-oda                   to 4-z   
        move 4-z                     to det-26
        move t-pax                   to 4-z
        move 4-z                     to det-4
        move t-chi                   to 4-z
        move 4-z                     to det-5
        move t-fre                   to 4-z
        move 4-z                     to det-6
        move t-beb                   to 4-z
        move 4-z                     to det-66
        move "A"          to det-dokumer-20(3:1)
        move 481          to det-renk1
        move "1"          to det-dokumer-20(10:1)
        move "|" to fil-1 fil-2 fil-3 fil-4
        fil-5 fil-6 fil-66 fil-7 fil-8 fil-9 fil-10 fil-11
        fil-12 fil-13 fil-14 fil-15 fil-16 fil-17
        fil-18 fil-19 fil-20 fil-21 fil-22 fil-23
        fil-24 fil-25 fil-26 fil-27 fil-28 fil-29  fil-34
        fil-30 fil-31 fil-32 fil-33 fil-201 fil-202 fil-203 fil-204
        write dokumer-rec from detay
        initialize dokumer-rec detay
        move "-"            to det-dokumer-20(5:1)
        move all "-" to det-1 det-2 det-3 det-4
        det-5 det-6 det-66 det-7 det-8 det-9 det-10 det-11
        det-12 det-13 det-14 det-15 det-16 det-17
        det-18 det-19 det-20 det-21 det-22 det-23
        det-24 det-25 det-26 det-27 det-28 det-29  det-34
        det-30 det-31 det-32 det-33 det-201 det-202 det-203
        det-204
        write dokumer-rec from detay
     end-if.

*
 cb-renklendir.
    evaluate ilk-secilen
         when 01  modify cb-numara,color = 5 
                  move 2 to numara-eh
         when 02  modify cb-acenta,color = 5 
                  move 2 to acenta-eh
         when 03  modify cb-musteri-adi,color = 5 
                  move 2 to musteri-adi-eh
         when 04  modify cb-musteri-soyadi,color = 5 
                  move 2 to musteri-soyadi-eh
         when 05  modify cb-cin-tarihi,color = 5 
                  move 2 to c-in-tarih-eh
         when 06  modify cb-cout-tarihi,color = 5 
                  move 2 to c-out-tarih-eh
         when 07  modify cb-voucher,color = 5 
                  move 2 to oda-eh
         when 08  modify cb-yan-adi,color = 5 
                  move 2 to yan-adi-eh
         when 09  modify cb-yan-soyadi,color = 5 
                  move 2 to yan-soyadi-eh
         when 99
                  if numara-eh = 1 
                     move 01 to ilk-secilen
                  else
                  if acenta-eh = 1 
                     move 02 to ilk-secilen
                  else
                  if musteri-adi-eh = 1 
                     move 03 to ilk-secilen
                  else
                  if musteri-soyadi-eh = 1 
                     move 04 to ilk-secilen
                  else
                  if c-in-tarih-eh = 1
                     move 05 to ilk-secilen
                  else
                  if c-out-tarih-eh = 1 
                     move 06 to ilk-secilen
                  else
                  if oda-eh = 1 
                     move 07 to ilk-secilen
                  else
                  if yan-adi-eh = 1 
                     move 08 to ilk-secilen
                  else
                  if yan-soyadi-eh = 1 
                     move 09 to ilk-secilen
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  modify cb-numara,      color = 2 
                  modify cb-acenta      ,color  = 2
                  modify cb-musteri-adi ,color  = 2
                  modify cb-musteri-soyadi,color  = 2
                  modify cb-cin-tarihi,color  = 2
                  modify cb-cout-tarihi,color  = 2
                  modify cb-voucher    ,color  = 2
                  modify cb-yan-adi    ,color  = 2
                  modify cb-yan-soyadi ,color  = 2
                  if ilk-secilen = 99
                     move 0 to ilk-secilen
                  end-if
                  if ilk-secilen <> 0  
                     perform cb-renklendir
                  end-if
         when other
              exit paragraph
    end-evaluate.
*
 Form6-Aft-Initdata.
    modify form6-gd-1,
           mass-update = 1 
           reset-grid  = 1
    initialize form6-gd-1-record
    move "No."       to gd-6-col-1
    move "Rapor adi" to gd-6-col-2
    modify form6-gd-1,
           record-to-add(form6-gd-1-record)

    open input rapor
    initialize rapor-rec
    move "A"   to rapor-tipi
    start rapor key not < rapor-anahtar invalid
          continue
    not invalid
    initialize fs-rapor
    perform with test after until fs-rapor = "10"
    read rapor next no lock end move "10" to fs-rapor
    not at end
         if rapor-tipi <> "A"
            move "10" to fs-rapor
            exit perform
         end-if
         initialize form6-gd-1-record
         move rapor-no         to gd-6-col-1
         move rapor-adi        to gd-6-col-2



         modify form6-gd-1,
                record-to-add(form6-gd-1-record)
    end-read
    end-perform
    end-start
    close rapor.

    modify form6-gd-1,
           mass-update = 0.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 Form6-Ef-1-Aft-Procedure.
     if rapor-no = zeroes 
        modify button-0101,enabled = false
        modify button-0102,enabled = false
     else 
        modify button-0101,enabled = true
        modify button-0102,enabled = true
     end-if.
     open input rapor.
     move "A"      to rapor-tipi
     read rapor no lock invalid
          initialize rapor-adi rapor-gelecek
     end-read
     display accept-0102.
     close rapor.
*
 Form6-Ef-1-Bef-Procedure.
     initialize rapor-rec.
     display accept-0102.
     modify button-0101,enabled = false
     modify button-0102,enabled = false.
*
 Form6-Ex-Other.
     evaluate key-status
         when 2
              if numara-eh = 0 and
                acenta-eh = 0 and musteri-adi-eh = 0 and
                musteri-soyadi-eh = 0 and c-in-tarih-eh = 0 and
                c-out-tarih-eh = 0 and oda-eh = 0 and
                yan-adi-eh = 0 and yan-soyadi-eh = 0
                    display message box 
                            "Raporu kaydedebilmeniz icin ana secimlerden birini secmek zorundasiniz !!!"
                            icon mb_warning_icon
                            title "Uyari"
                            move 4 to accept-control
                            move 5 to control-id
                            exit paragraph
              end-if
              open i-o rapor
              move "A" to rapor-tipi
              read rapor no lock invalid
                   continue
              end-read
              move numara-eh         to rapor-cb-1
              move acenta-eh         to rapor-cb-3
              move musteri-adi-eh    to rapor-cb-4
              move musteri-soyadi-eh to rapor-cb-5
              move c-in-tarih-eh     to rapor-cb-6
              move c-out-tarih-eh    to rapor-cb-7
              move oda-eh            to rapor-cb-8
              write rapor-rec invalid
                    rewrite rapor-rec end-rewrite
              end-write
              close rapor
              initialize rapor-rec
              display accept-0101 accept-0102
              move 4 to accept-control
              move 4 to control-id
              perform Form6-Aft-Initdata
         when 3
              open i-o rapor
              move "A" to rapor-tipi
              delete rapor invalid continue end-delete
              close rapor
              initialize rapor-rec
              display accept-0101 accept-0102
              move 4 to accept-control
              move 4 to control-id
              perform Form6-Aft-Initdata
     end-evaluate.
*
 Form6-Gd-1-Ev-Other.
    evaluate event-type
        when msg-begin-entry
             move event-action-fail to event-action
             inquire form6-gd-1,y in form6-y
             inquire form6-gd-1(form6-y),
                     record-data in form6-gd-1-record
             move gd-6-col-1     to rapor-no
             display accept-0101
             perform Form6-Ef-1-Aft-Procedure
             move 4 to accept-control
             move 4 to control-id
             exit paragraph
        when msg-goto-cell
        when msg-goto-cell-mouse
        when msg-begin-drag
        when msg-end-drag
        when msg-goto-cell-drag
             inquire form6-gd-1,y in form6-yeni-y
             if form6-yeni-y < 2
                move 2 to form6-yeni-y form6-eski-y
             end-if
             if form6-eski-y > zeroes 
                modify form6-gd-1(form6-eski-y),
                       x = 2
                       row-color = 0
                       cell-color = 0
             end-if
             modify form6-gd-1,
                    y = form6-yeni-y,
                    x = 2,
                    row-color = 480
                    cell-color = 480
             move form6-yeni-y to form6-eski-y
    end-evaluate.
*
 combo-rapor-baslik-Ex-Ntf-Selchange.
    open input rapor.
    move "A" to rapor-tipi
    move rapor-baslik(1:4) to rapor-no
    read rapor no lock invalid
         display message box
                 "Tanimsiz rapor ...."
                 title "Uyari"
                 icon mb_error_icon
         close rapor
         exit paragraph
    end-read
    move rapor-cb-1          to numara-eh
    move rapor-cb-2          to acenta-eh
    move rapor-cb-3          to musteri-adi-eh
    move rapor-cb-4          to musteri-soyadi-eh
    move rapor-cb-5          to c-in-tarih-eh
    move rapor-cb-6          to c-out-tarih-eh
    move rapor-cb-7          to oda-eh
    close rapor.

*    display cb-numara cb-islem-tarihi cb-acenta
*    cb-musteri-adi cb-musteri-soyadi cb-cin-tarihi
*    cb-cout-tarihi cb-voucher.
 acc-bit-numara-Aft-Procedure.
     initialize gec-gecme
     if numara-eh = 0 
        exit paragraph.
     if bas-numara <> 0 and bit-numara <> 0
        if bas-numara > bit-numara 
           move 1 to gec-gecme
           exit paragraph
        end-if
     end-if.
*
 cb-voucher-Ex-Cmd-Clicked.
     display acc-bas-voucher acc-bit-voucher
     if ilk-secilen = zeroes
        move 7 to ilk-secilen
        perform cb-renklendir
     else 
        if oda-eh = 0
           if ilk-secilen = 7
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

     
     .
*
 cb-yan-adi-Ex-Cmd-Clicked.
     display acc-bas-yan-adi acc-bit-yan-adi.
     
     if ilk-secilen = zeroes
        move 8 to ilk-secilen
        perform cb-renklendir
     else 
        if yan-soyadi-eh = 0
           if ilk-secilen = 8
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
     .
*
 cb-yan-soyadi-Ex-Cmd-Clicked.
     display acc-bas-yan-soyadi acc-bit-yan-soyadi.
     
     if ilk-secilen = zeroes
        move 9 to ilk-secilen
        perform cb-renklendir
     else 
        if yan-soyadi-eh = 0
           if ilk-secilen = 9
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
     
     .
*
 yardimlar.
     evaluate control-id
       when 28
       when 48 perform ilk-acenta-ara
       when 29
       when 49 perform son-acenta-ara
       when 54
       when 55 perform banka-ara
       when 58
       when 59 perform doviz-ara
       when 62
       when 63 perform anlasma-ara
       when 66
       when 67 perform odeme-ara
       when 74
       when 75 perform ulke-ara
       when 82
       when 83 perform pazar-ara
       when 70
       when 71 perform pansiyon-ara
     end-evaluate
     .
*
 ilk-acenta-ara.
     perform acenta-ara
     move acenta-cagir to bas-acenta
     display acc-bas-acenta
     .
*
 son-acenta-ara.
     perform acenta-ara
     move acenta-cagir to bit-acenta
     display acc-bit-acenta
     .
*
 acenta-ara.
     initialize acenta-cagir
     call "/asya/ytl/obj/otel/acenara.asy" 
       using acenta-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/acenara.asy"
     end-call
     .
*
 banka-ara.
     call "/asya/ytl/obj/otel/bankaara.asy" 
       using bas-banka-kodu  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/bankaara.asy"
     end-call
     display acc-bas-banka-kodu
     .
*
 doviz-ara.
     call "/asya/ytl/obj/otel/dovizara.asy" 
       using bas-doviz-kodu  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/dovizara.asy"
     end-call
     display acc-bas-doviz-kodu
     .
*
 anlasma-ara.
     move "D" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/infoxara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/infoxara.asy"
     end-call
     move infox-kodu-cagir to bas-anlasma-kodu
     display acc-bas-anlasma-kodu
     .
*
 odeme-ara.
     move "B" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/odemeara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/odemeara.asy"
     end-call
     move infox-kodu-cagir to bas-odeme-kodu
     display acc-bas-odeme-kodu
     .
*
 ulke-ara.
     call "/asya/ytl/obj/otel/ulkeara.asy" 
       using bas-ulke-kodu  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/ulkeara.asy"
     end-call
     display acc-bas-ulke-kodu
     .
*
 pazar-ara.
     move "E" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/pazarara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/pazarara.asy"
     end-call
     move infox-kodu-cagir to bas-pazar-kodu
     display acc-bas-pazar-kodu
     .
*
 pansiyon-ara.
     move "A" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/panara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/panara.asy"
     end-call
     move infox-kodu-cagir to bas-pansiyon-kodu
     display acc-bas-pansiyon-kodu.
 
