* manager3.evt
* manager3.evt is generated from D:\asya\acugt.ytl\otel\manager3.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .
***   start event editor code   ***
*
 Form1-Bef-Create.
    perform adresleri-tasi.
    open input genel
    move 1 to genel-anahtar
    read genel no lock invalid continue
         not invalid continue
    end-read
    close genel.
    open input genel2
    move 1 to genel2-anah 
    read genel2 no lock invalid continue
         not invalid continue
    end-read
    close genel2              
    move ONKPARA-DOVIZ to butce-cev-doviz .
    move 1 to reel-gecmis
    
    
     .
*              
 Form1-Aft-Initdata.

    move tarih-tasi to ilk-tarih son-tarih.
    move "01" to ilk-ay ilk-gun



    move "N" to rap-tip.
    display acc-01 acc-02 acc-03 acc-04 acc-05 acc-06 .
    perform Form1-Ef-1-Aft-Procedure 
    perform Form1-Ef-2-Aft-Procedure
    move 2 to xx
    move 28 to sut-yer sutun(xx)
    move 1 to reel-gecmis
    perform varying i from 1 by 1 until i > 7
         add 1 to xx      add 7 to sut-yer     move sut-yer to sutun(xx)
         add 1 to xx      add 5 to sut-yer     move sut-yer to sutun(xx)
         add 1 to xx      add 9 to sut-yer     move sut-yer to sutun(xx)
         add 1 to xx      add 7 to sut-yer     move sut-yer to sutun(xx)
         add 1 to xx      add 9 to sut-yer     move sut-yer to sutun(xx)
         add 1 to xx      add 14 to sut-yer     move sut-yer to sutun(xx)
    end-perform
     .
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 Form1-Ex-Other.
    evaluate key-status
      
        
      when 4 
      
      when 2
       move son-yil to ilk-yil
        open input doviz gruplar grupfiy hesayr
           initialize alt-toplam-dizi rez-adet
           perform takas-dosya-yaz thru takas-dosya-yaz-exit
        close doviz gruplar grupfiy hesayr
       
              initialize takas6-rec
              start takas6 key not < takas6-tarih invalid
                    initialize mesaj-link
                    move 04 to mesaj-no
                    perform mesaj-ver
                    close takas6 takas7
                    exit paragraph
              end-start

              open i-o genelfis
              move 1 to genelfis-anahtar
              read genelfis no lock invalid
                   accept print-no from time
              not invalid
                   add 1 to print-no
                   rewrite genelfis-rec end-rewrite
              end-read
              close genelfis
**************************
     initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya
*****      display message box rez-adet " adet rezervasyon tarandi"
     set  dokumer-asya-set to true
     move print-no         to dokumer-dosya-adi
     open output dokumer
*/WINDOW TITLE
     initialize dokumer-rec detay
     move "W"                  to det-dokumer-20(1:)
*     move "YONETIM RAPORU "to det-filler
     move " MANAGEMENT REPORT  "to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR
     initialize dokumer-rec detay
     move "1"          to det-dokumer-20(10:1)
     move "B"                  to det-dokumer-20(1:1)
     move "Otel Yonetim Raporu"   to det-filler
     move "Tarih..:"     to det-filler(41:10)
     move ilk-gun        to det-filler(51:02)
     move "/"            to det-filler(53:01)
     move ilk-ay         to det-filler(54:02)
     move "/"            to det-filler(56:01)
     move ilk-yil        to det-filler(57:04)
     move "-"            to det-filler(61:01)
     move son-gun        to det-filler(62:02)
     move "/"            to det-filler(64:01)
     move son-ay         to det-filler(65:02)
     move "/"            to det-filler(67:01)
     move son-yil        to det-filler(68:04)
     write dokumer-rec from detay

     initialize dokumer-rec detay
     move "1"          to det-dokumer-20(10:1)
     move "B"                  to det-dokumer-20(1:1)
     move "Rapor Tipi..:"          to det-filler(01:15)

     
    
     write dokumer-rec from detay
      if onkpara-referans-var = 1 then 
            initialize dokumer-rec detay
             move "1"            to det-dokumer-20(10:1)
             move "B"            to det-dokumer-20(1:1)
             if oda-ref = 0 then 
             move "TUM KOMPLEX " TO DET-FILLER
             else
             MOVE ref-adi(oda-ref)to det-filler
             move "OTEL "  to det-filler(16:)
             move "KONAKLAMALARI" to det-filler(25:)
             end-if
             if fiyat-ref not = 0 
                MOVE ref-adi(fiyat-ref)to det-filler(40:)
             move "OTEL "  to det-filler(50:)
             move "SATISLARI" to det-filler(58:)
             end-if
              write dokumer-rec from detay
     end-if
     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:)
     write dokumer-rec from detay


*/ DOKUMER OZELLIKLER-REC
     initialize dokumer-rec detay
     move "O" to det-dokumer-20(1:)
     move "E" to dokumer-oto-sayfa-basi
     move 56  to dokumer-oto-sayfa-satir
     move "|" to dokumer-detay-kolon-ayirici
     move "LRRRRRRRRRRRRRRRRRRRRRRRRRR" to dokumer-align-occ
  
     move dokumer-ozellikler-rec     to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR  
        
     initialize dokumer-rec detay  
     move "D1"           to det-dokumer-20(1:2)
      move "           "  to det11-baslik
    
      move "DAY     "    to det11-tutar1
    
      move "MTD     "      to det11-tutar2
   
      move "YTD "    to det11-tutar3
      move "|"  TO      fil11-baslik   fil11-oda1      fil11-pax1      fil11-doluluk1 
                        fil11-oda-ort1   fil11-pax-ort1   fil11-tutar1   
                        fil11-oda2      fil11-pax2      fil11-doluluk2 
                        fil11-oda-ort2   fil11-pax-ort2   fil11-tutar2    fil11-oda3     
                        fil11-pax3      fil11-doluluk3 
                        fil11-oda-ort3   fil11-pax-ort3   fil11-tutar3   
      move det-11-rec to det-1
      write dokumer-rec from detay


   


     initialize dokumer-rec detay
     move "D2"           to det-dokumer-20(1:2)
     move "-"            to det-dokumer-20(5:1)
     
      move all "-" to det-1(01:364)
     write dokumer-rec from detay
*********************************
      perform dokinit

         move "Adults Total"          to det11-baslik
         move  takas3-pax(1)  to z-oda1    
         move z-oda1   to    det11-tutar1 
         move  takas3-pax(2)  to z-oda1    
         move z-oda1   to    det11-tutar2 
         move  takas3-pax(3)  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay


      

     perform dokinit

      move "Complimentary Persons"          to det11-baslik
          move   takas3-comp-pax(1)  to z-oda1    
         move z-oda1   to    det11-tutar1 
         move   takas3-comp-pax(2)  to z-oda1    
         move z-oda1   to    det11-tutar2 
         move   takas3-comp-pax(3)  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1


      move det-11-rec to det-1
           write dokumer-rec from detay




    
           perform dokinit

      move "House Use Persons"          to det11-baslik
          move   takas3-hous-pax(1)  to z-oda1    
         move z-oda1   to    det11-tutar1 
         move   takas3-hous-pax(2)  to z-oda1    
         move z-oda1   to    det11-tutar2 
         move   takas3-hous-pax(3)  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1


      move det-11-rec to det-1
           write dokumer-rec from detay

    
               perform dokinit
      move "Children (Total)"          to det11-baslik
      compute arasay = takas3-chi(1) +  takas3-fre(1)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
          compute arasay = takas3-chi(2) +  takas3-fre(2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
          compute arasay = takas3-chi(3) +  takas3-fre(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
        
      move det-11-rec to det-1
           write dokumer-rec from detay


                 perform dokinit
              move "Extra Bed "          to det11-baslik
      compute arasay = 0
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
          compute arasay = 0
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
          compute arasay = 0
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
        
      move det-11-rec to det-1
           write dokumer-rec from detay


                  perform dokinit
              move "Crib "          to det11-baslik
      compute arasay = 0
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
          compute arasay = 0
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
          compute arasay = 0
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
        
      move det-11-rec to det-1
           write dokumer-rec from detay


                 perform dokinit
             move "Children (Non-Taxable)"          to det11-baslik
      compute arasay =  takas3-fre(1)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
          compute arasay =  takas3-fre(2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
          compute arasay =  takas3-fre(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
        
      move det-11-rec to det-1
           write dokumer-rec from detay


                   perform dokinit
           move "Guests In House"          to det11-baslik
          compute arasay = takas3-chi(1) +  takas3-fre(1) + takas3-pax(1)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
          compute arasay = takas3-chi(2) +  takas3-fre(2)  + takas3-pax(2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
          compute arasay = takas3-chi(3) +  takas3-fre(3) + takas3-pax(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
        
      move det-11-rec to det-1
           write dokumer-rec from detay


              perform dokinit
          move "% Beds  Occupied"          to det11-baslik
        compute arasay rounded = (takas3-chi(1) +  takas3-fre(1) + takas3-pax(1))/ takas3-hazir-yatak(1) * 100
          move   arasay  to z-for-yuzde     
         move z-for-yuzde2   to    det11-tutar1 
        
          compute arasay rounded = (takas3-chi(2) +  takas3-fre(2) + takas3-pax(2))/ takas3-hazir-yatak(2) * 100
          move   arasay  to z-for-yuzde     
         move z-for-yuzde2   to    det11-tutar2 
        
          compute arasay rounded = (takas3-chi(3) +  takas3-fre(3) + takas3-pax(3))/ takas3-hazir-yatak(3) * 100
          move   arasay  to z-for-yuzde     
         move z-for-yuzde2   to    det11-tutar3 
        
         move det-11-rec to det-1
           write dokumer-rec from detay

              perform dokinit
          move "Total Rooms in Hotel"          to det11-baslik
        compute arasay = takas3-hazir(1)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
          compute arasay =  takas3-hazir(2)
          move   arasay  to z-oda2    
         move z-oda2   to    det11-tutar2 
        
          compute arasay =  takas3-hazir(3)
          move   arasay  to z-oda3    
         move z-oda3   to    det11-tutar3 
        
          move det-11-rec to det-1
           write dokumer-rec from detay
         


           
                 perform dokinit
              move "Out of Order Rooms"          to det11-baslik
                  compute arasay = 0
                  move   arasay  to z-oda1    
                 move z-oda1   to    det11-tutar1 
                
                  compute arasay = 0
                  move   arasay  to z-oda1    
                 move z-oda1   to    det11-tutar2 
                
                  compute arasay = 0
                  move   arasay  to z-oda1    
                 move z-oda1   to    det11-tutar3 
                
              move det-11-rec to det-1
                   write dokumer-rec from detay


                    perform dokinit
                move "Out of Service Rooms"          to det11-baslik
                  compute arasay = 0
                  move   arasay  to z-oda1    
                 move z-oda1   to    det11-tutar1 
                
                  compute arasay = 0
                  move   arasay  to z-oda1    
                 move z-oda1   to    det11-tutar2 
                
                  compute arasay = 0
                  move   arasay  to z-oda1    
                 move z-oda1   to    det11-tutar3 
                
              move det-11-rec to det-1
                   write dokumer-rec from detay


                perform dokinit  
             move "Total Rooms -OOO"          to det11-baslik
            compute arasay = takas3-hazir(1)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
          compute arasay =  takas3-hazir(2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
          compute arasay =  takas3-hazir(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
        
          move det-11-rec to det-1
           write dokumer-rec from detay
         

            perform dokinit 
         move "Rooms Occupied"          to det11-baslik
         move  takas3-oda(1)  to z-oda1    
         move z-oda1   to    det11-tutar1 
         move  takas3-oda(2)  to z-oda1    
         move z-oda1   to    det11-tutar2 
         move  takas3-oda(3)  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

          perform dokinit 
         move "House Use"          to det11-baslik
         move  takas3-hous-oda(1)  to z-oda1    
         move z-oda1   to    det11-tutar1 
         move  takas3-hous-oda(2)  to z-oda1    
         move z-oda1   to    det11-tutar2 
         move  takas3-hous-oda(3)  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay


           perform dokinit 
         move "Occ.rooms inc.Comps - house"          to det11-baslik
            compute arasay = takas3-oda(1)  - takas3-hous-oda(1)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
          compute arasay =  takas3-oda(2)  - takas3-hous-oda(2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
          compute arasay = takas3-oda(3)  - takas3-hous-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



             perform dokinit 
         move "Complimentary Rooms"          to det11-baslik
            compute arasay = takas3-comp-oda(1)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
          compute arasay =  takas3-comp-oda(2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
          compute arasay = takas3-comp-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay





             perform dokinit 
         move "Rooms Occupied - comps/house"          to det11-baslik
            compute arasay = takas3-oda(1)  - takas3-hous-oda(1) -  takas3-comp-oda(1)
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
          compute arasay =  takas3-oda(2)  - takas3-hous-oda(2) - takas3-comp-oda(2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
          compute arasay = takas3-oda(3)  - takas3-hous-oda(3) - takas3-comp-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay


       
             perform dokinit 
         move "Available Rooms"          to det11-baslik
            compute arasay = takas3-hazir(1)  - takas3-oda(1)
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
            compute arasay = takas3-hazir(2)  - takas3-oda(2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
            compute arasay = takas3-hazir(3)  - takas3-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

                 perform dokinit 
         move "Available rooms - OOO"          to det11-baslik
            compute arasay = takas3-hazir(1)  - takas3-oda(1)
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
            compute arasay = takas3-hazir(2)  - takas3-oda(2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
            compute arasay = takas3-hazir(3)  - takas3-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

                      perform dokinit 
         move "Dirty Rooms"          to det11-baslik
            compute arasay = ((takas3-hazir(1)  - takas3-oda(1))/2) +  takas3-oda(1)
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
            compute arasay = ((takas3-hazir(2)  - takas3-oda(2))/2) +  takas3-oda(2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
            compute arasay = ((takas3-hazir(3)  - takas3-oda(3))/2) +  takas3-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

            perform dokinit 
         move "Clean Rooms"          to det11-baslik
            compute arasay = takas3-hazir(1) - ( ((takas3-hazir(1)  - takas3-oda(1))/2) +  takas3-oda(1))
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
            compute arasay = takas3-hazir(2) - (((takas3-hazir(2)  - takas3-oda(2))/2) +  takas3-oda(2) )
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
            compute arasay = takas3-hazir(3) - (((takas3-hazir(3)  - takas3-oda(3))/2) +  takas3-oda(3))
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay
      
              perform dokinit 
         move "Room Arrivals"          to det11-baslik
            compute arasay = bugun-cin-oda(1) 
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
            compute arasay =bugun-cin-oda (2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
            compute arasay = bugun-cin-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay


               perform dokinit 
         move "Arrivals (Pers)"          to det11-baslik
            compute arasay = bugun-cin-kisi(1) 
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
            compute arasay =bugun-cin-kisi (2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
            compute arasay = bugun-cin-kisi(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



                 perform dokinit 
         move "Room Departures"          to det11-baslik
            compute arasay = bugun-cout-oda(1) 
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
            compute arasay =bugun-cout-oda (2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
            compute arasay = bugun-cout-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay






                  perform dokinit 
         move "Depart.(Pers)"          to det11-baslik
            compute arasay = bugun-cout-kisi(1) 
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
            compute arasay =bugun-cout-kisi (2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
            compute arasay = bugun-cout-kisi(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

        
                 perform dokinit 
         move "Walk In"          to det11-baslik
            compute arasay = takas3-walkin-oda(1) 
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
            compute arasay =takas3-walkin-oda (2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
            compute arasay = takas3-walkin-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay






                  perform dokinit 
         move "Walk-in Persons"          to det11-baslik
            compute arasay = takas3-walkin-kisi(1) 
            move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar1 
        
            compute arasay =takas3-walkin-kisi (2)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar2 
        
            compute arasay = takas3-walkin-kisi(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



                    perform dokinit 
         move "% Rooms Occupied"          to det11-baslik
            compute arasay =  takas3-oda(1) / takas3-hazir(1) * 100
            move   arasay   to  z-for-yuzde     
         move z-for-yuzde2  to det11-tutar1 
        
            compute arasay = takas3-oda(2) / takas3-hazir(2) * 100
          move   arasay     to  z-for-yuzde     
         move z-for-yuzde2  to   det11-tutar2 
        
            compute arasay = takas3-oda(3) / takas3-hazir(3) * 100
          move   arasay     to  z-for-yuzde     
         move z-for-yuzde2  to  det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



      


       
             perform dokinit 
         move "% Rooms Occupied -Comps"          to det11-baslik
            compute arasay =  ( takas3-oda(1) - takas3-comp-oda(1) - takas3-hous-oda(1) )/ takas3-hazir(1) * 100
            move   arasay   to  z-for-yuzde     
         move z-for-yuzde2  to  det11-tutar1                                              
                                                                                       
            compute arasay = ( takas3-oda(2) - takas3-comp-oda(2) - takas3-hous-oda(2) )/ takas3-hazir(2) * 100
          move   arasay  to  z-for-yuzde     
         move z-for-yuzde2  to    det11-tutar2                                              
                                                                                       
            compute arasay = ( takas3-oda(3) - takas3-comp-oda(3) - takas3-hous-oda(3) )/ takas3-hazir(3) * 100
          move   arasay   to  z-for-yuzde     
         move z-for-yuzde2  to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay


        
             perform dokinit 
         move "%Occ.rooms inc.Comps - house"          to det11-baslik
            compute arasay =  ( takas3-oda(1) - takas3-hous-oda(1) )/ takas3-hazir(1) * 100
            move   arasay   to  z-for-yuzde     
         move z-for-yuzde2  to   det11-tutar1 
        
            compute arasay = ( takas3-oda(2) - takas3-hous-oda(2) )/ takas3-hazir(2) * 100
          move   arasay  to  z-for-yuzde     
         move z-for-yuzde2  to    det11-tutar2 
        
            compute arasay = ( takas3-oda(3) - takas3-hous-oda(3) )/ takas3-hazir(3) * 100
          move   arasay  to  z-for-yuzde     
         move z-for-yuzde2  to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



         
                    perform dokinit 
         move "% Rooms occupied - OOO"          to det11-baslik
            compute arasay =  takas3-oda(1) / takas3-hazir(1) * 100
            move   arasay   to  z-for-yuzde     
         move z-for-yuzde2  to   det11-tutar1 
        
            compute arasay = takas3-oda(2) / takas3-hazir(2) * 100
          move   arasay  to  z-for-yuzde     
         move z-for-yuzde2  to    det11-tutar2 
        
            compute arasay = takas3-oda(3) / takas3-hazir(3) * 100
          move   arasay  to  z-for-yuzde     
         move z-for-yuzde2  to     det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



       
             perform dokinit 
         move "% Rooms Occupied -Comps and -OOO Rooms"          to det11-baslik
         compute arasay =  ( takas3-oda(1) - takas3-comp-oda(1) - takas3-hous-oda(1) )/ takas3-hazir(1) * 100
         move   arasay  to  z-for-yuzde     
         move z-for-yuzde2  to     det11-tutar1                                              
                                                                                 
         compute arasay = ( takas3-oda(2) - takas3-comp-oda(2) - takas3-hous-oda(2) )/ takas3-hazir(2) * 100
         move   arasay  to  z-for-yuzde     
         move z-for-yuzde2  to    det11-tutar2                                              
                                                                                 
         compute arasay = ( takas3-oda(3) - takas3-comp-oda(3) - takas3-hous-oda(3) )/ takas3-hazir(3) * 100
         move   arasay   to  z-for-yuzde     
         move z-for-yuzde2  to    det11-tutar3 
         move det-11-rec to det-1

         write dokumer-rec from detay
          
         if yuzde-yok not = 1 and genel-br-ayir-cikma  not = 1
             move 65 to madik
             else
             move 0 to madik
         end-if

            perform varying gay from 1 by 1 until gay > 3
                compute  takas3-fb(gay) rounded = takas3-fb(gay) +
                   (takas3-oda1(gay) - takas3-odag(gay)) + 
                   (takas3-odag(gay) * ( madik / 100 ))
                   
               compute  takas3-fb-net(gay) rounded = takas3-fb-net(gay) + 
                   (takas3-oda1-net(gay) - takas3-odag-net(gay) ) + ( takas3-odag-net(gay) * ( madik / 100 ) )
        
               compute  takas3-oda1(gay) rounded =  ( takas3-odag(gay) * ((100 - madik) / 100 ))
        
               compute  takas3-oda1-net(gay) rounded = (takas3-odag-net(gay) * ((100 - madik) / 100 ))
            end-perform 
        
        
                 perform dokinit 
         move "Hotel Revenue"          to det11-baslik
            
            move takas3-otel(1) to z-for-tutar                                                   
            move z-for-tutar    to det11-tutar1                                              
                                                                                       
         
          move  takas3-otel(2)  to z-for-tutar                                                   
         move  z-for-tutar   to    det11-tutar2                                              
                                                                                       
        
          move   takas3-otel(3)  to z-for-tutar                                                   
         move  z-for-tutar       to  det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay





          
                 perform dokinit 
         move "Total Revenue Net"          to det11-baslik
           
            move   takas3-otel-net(1)  to  z-for-tutar                                                   
         move  z-for-tutar   to    det11-tutar1                                              
                                                                                       
         
          move   takas3-otel-net(2) to z-for-tutar                                                   
         move  z-for-tutar   to    det11-tutar2                                              
                                                                                       
        
          move   takas3-otel-net(3)  to z-for-tutar                                                   
         move  z-for-tutar    to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay


        
          
                 perform dokinit 
         move "Revenue per Guest"          to det11-baslik
            compute arasay rounded = takas3-otel(1) /   (takas3-chi(1) +  takas3-fre(1) + takas3-pax(1))
            move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar    to    det11-tutar1                                              
                                                                                       
            compute arasay rounded = takas3-otel(2) /   (takas3-chi(2) +  takas3-fre(2) + takas3-pax(2))
            move   arasay  to z-for-tutar                                                   
         move  z-for-tutar    to    det11-tutar2                                              
                                                                                       
            compute arasay rounded = takas3-otel(3) /   (takas3-chi(3) +  takas3-fre(3) + takas3-pax(3))
            move   arasay  to z-for-tutar                                                   
         move  z-for-tutar    to    det11-tutar3 
            move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "F&B Revenue"          to det11-baslik
               move takas3-fb(1) to arasay
               move arasay       to z-for-tutar                                                   
         move  z-for-tutar       to det11-tutar1                                              
                                                                                       
                 move  takas3-fb(2) to arasay
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar    to    det11-tutar2                                              
                                                                                       
            move  takas3-fb(3) to arasay
          move   arasay to  z-for-tutar                                                   
         move  z-for-tutar    to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "F&B Revenue Without Tax"          to det11-baslik
                move  takas3-fb-net(1) to arasay
            move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar    to   det11-tutar1                                              
                                                                                       
                move  takas3-fb-net(2) to arasay
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar    to     det11-tutar2                                              
                                                                                       
             move  takas3-fb-net(3) to arasay
          move   arasay to  z-for-tutar                                                   
         move  z-for-tutar    to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Room Revenue"          to det11-baslik
            move takas3-oda1(1) to arasay
            move   arasay   to  z-for-tutar                                                   
         move  z-for-tutar to  det11-tutar1                                              
                                                                                       
             move takas3-oda1(2) to arasay
          move   arasay   to  z-for-tutar                                                   
         move  z-for-tutar to    det11-tutar2                                              
                                                                                       
             move takas3-oda1(3) to arasay
          move   arasay   to  z-for-tutar                                                   
         move  z-for-tutar to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Room Revenue Without Tax"          to det11-baslik
           
           move takas3-oda1-net(1) to arasay
            move   arasay   to  z-for-tutar                                                   
         move  z-for-tutar to  det11-tutar1                                              
                                                                                       
             move takas3-oda1-net(2) to arasay
          move   arasay   to  z-for-tutar                                                   
         move  z-for-tutar to    det11-tutar2                                              
                                                                                       
             move takas3-oda1-net(3) to arasay
          move   arasay   to  z-for-tutar                                                   
         move  z-for-tutar to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Average Room Rate"          to det11-baslik
            compute  arasay rounded =   takas3-oda1(1) / takas3-oda(1)
            move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to  det11-tutar1                                              
                                                                                       
            compute  arasay rounded =   takas3-oda1(2) / takas3-oda(2)
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to   det11-tutar2                                              
                                                                                       
           compute  arasay rounded =   takas3-oda1(3) / takas3-oda(3)
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to   det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "ARR Without Tax"          to det11-baslik
           compute  arasay rounded =   takas3-oda1-net(1) / takas3-oda(1) 
            move   arasay to  z-for-tutar                                                   
         move  z-for-tutar to  det11-tutar1                                              
                                                                                       
           compute  arasay rounded =   takas3-oda1-net(2) / takas3-oda(2)
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to   det11-tutar2                                              
                                                                                       
          compute  arasay rounded =   takas3-oda1-net(3) / takas3-oda(3)
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to   det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "ARR Without Tax -Comps"          to det11-baslik
             compute  arasay rounded =   takas3-oda1-net(1) / ( takas3-oda(1) - takas3-hous-oda(1) - takas3-comp-oda(1)  )
            move   arasay to  z-for-tutar                                                   
         move  z-for-tutar to  det11-tutar1                                              
                                                                                       
           compute  arasay rounded =   takas3-oda1-net(2) / ( takas3-oda(2) - takas3-hous-oda(2) - takas3-comp-oda(2)  )
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to   det11-tutar2                                              
                                                                                       
             compute  arasay rounded =   takas3-oda1-net(3) / ( takas3-oda(3) - takas3-hous-oda(3) - takas3-comp-oda(3)  )  
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Zip Check-Out Statistics"          to det11-baslik
           
            move   0 to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
         
          move   0 to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
        
          move  0  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "ARR -house +comps"          to det11-baslik
             compute  arasay rounded =   takas3-oda1(1) / ( takas3-oda(1) - takas3-hous-oda(1)   ) 
            move   arasay to  z-for-tutar                                                   
         move  z-for-tutar to  det11-tutar1                                              
                                                                                       
           compute  arasay rounded =   takas3-oda1(2) / ( takas3-oda(2) - takas3-hous-oda(2)   ) 
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to   det11-tutar2                                              
                                                                                       
            compute  arasay rounded =   takas3-oda1(3) / ( takas3-oda(3) - takas3-hous-oda(3)   ) 
          move   arasay to  z-for-tutar                                                   
         move  z-for-tutar to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "ARR Without Comps"          to det11-baslik
          compute  arasay rounded =   takas3-oda1(1) / ( takas3-oda(1) - takas3-hous-oda(1) - takas3-comp-oda(1)  )
            move   arasay to  z-for-tutar                                                   
         move  z-for-tutar to det11-tutar1                                              
                                                                                       
          compute  arasay rounded =   takas3-oda1(2) / ( takas3-oda(2) - takas3-hous-oda(2) - takas3-comp-oda(2)  ) 
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to   det11-tutar2                                              
                                                                                       
          compute  arasay rounded =   takas3-oda1(3) / ( takas3-oda(3) - takas3-hous-oda(3) - takas3-comp-oda(3)  )
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Average Person Rate"          to det11-baslik
             compute  arasay rounded =   takas3-oda1(1) / ( takas3-pax(1) - takas3-chi(1) - takas3-fre(1)  )  
            move   arasay to  z-for-tutar                                                   
         move  z-for-tutar to  det11-tutar1                                              
                                                                                       
            compute  arasay rounded =   takas3-oda1(2) / ( takas3-pax(2) - takas3-chi(2) - takas3-fre(2)  )   
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to    det11-tutar2                                              
                                                                                       
             compute  arasay rounded =   takas3-oda1(3) / ( takas3-pax(3) - takas3-chi(3) - takas3-fre(3)  )  
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to   det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Number of Vip Guests"          to det11-baslik
            compute  arasay rounded =     takas3-vip-pax(1)
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
          compute  arasay rounded =     takas3-vip-pax(2)
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
          compute  arasay rounded =     takas3-vip-pax(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Payment"          to det11-baslik
            compute  arasay rounded =     takas3-tahsilat (1) 
            move   arasay to  z-for-tutar                                                   
         move  z-for-tutar to  det11-tutar1                                              
                                                                                       
            compute  arasay rounded =     takas3-tahsilat (2) 
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to   det11-tutar2                                              
                                                                                       
            compute  arasay rounded =     takas3-tahsilat (3) 
          move   arasay  to  z-for-tutar                                                   
         move  z-for-tutar to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Reservations Made Today"          to det11-baslik
             compute  arasay rounded =    bugun-islen-oda(1)
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
           compute  arasay rounded =    bugun-islen-oda(2)
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
           compute  arasay rounded =    bugun-islen-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Cancellations For Today"          to det11-baslik
          compute  arasay rounded =    bugun-iptal-oda(1)
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
           compute  arasay rounded =    bugun-iptal-oda(2)
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
          compute  arasay rounded =    bugun-iptal-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Late Cancellations"          to det11-baslik
           compute  arasay rounded =    bugun-iptal-oda(1) / 5
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
         compute  arasay rounded =    bugun-iptal-oda(2) / 5 
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
         compute  arasay rounded =    bugun-iptal-oda(3) / 5
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay


          
          
                 perform dokinit 
         move "No-shows"          to det11-baslik
            compute  arasay rounded =   takas3-noshow-oda(1)
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
             compute  arasay rounded =   takas3-noshow-oda(2)
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
            compute  arasay rounded =   takas3-noshow-oda(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

          
                 perform dokinit 
         move "No-Show Persons"          to det11-baslik
            compute  arasay rounded =   takas3-noshow-kisi(1)
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
           compute  arasay rounded =   takas3-noshow-kisi(2)
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
           compute  arasay rounded =   takas3-noshow-kisi(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

          
                 perform dokinit 
         move "Early Departures"          to det11-baslik
           compute  arasay rounded =  t-Earlycout(1) 
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
           compute  arasay rounded =  t-Earlycout(2) 
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
           compute  arasay rounded =  t-Earlycout(3) 
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

          
                 perform dokinit 
         move "Early departure Persons"          to det11-baslik
             compute  arasay rounded =  t-Earlycout-kisi(1) 
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
           compute  arasay rounded =  t-Earlycout-kisi(2) 
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
          compute  arasay rounded =  t-Earlycout-kisi(3) 
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

          
                 perform dokinit 
         move "Extended Stays"          to det11-baslik
             compute  arasay rounded = t-extention(1) 
            move   arasay  to z-oda1                                                    
         move z-oda1   to    det11-tutar1                                              
                                                                                       
            compute  arasay rounded = t-extention(2) 
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
           compute  arasay rounded = t-extention(3) 
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

          
                 perform dokinit 
         move "Extended Stays Persons"          to det11-baslik
             compute  arasay rounded = t-extention-kisi(1)   
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
             compute  arasay rounded = t-extention-kisi(2) 
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
             compute  arasay rounded = t-extention-kisi(3) 
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

          
                 perform dokinit 
         move "Day Use"          to det11-baslik
          compute  arasay rounded = bugun-dayuse-kisi(1) 
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
           compute  arasay rounded = bugun-dayuse-kisi(2) 
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
           compute  arasay rounded = bugun-dayuse-kisi(3) 
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

          
                 perform dokinit 
         move "Single-Occupied Doubles"          to det11-baslik
             compute  arasay rounded =   t-single(1)
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
           compute  arasay rounded =   t-single(2) 
          move   arasay  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
            compute  arasay rounded =   t-single(3)
          move   arasay  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

          
                 perform dokinit 
         move "Double Occ %"          to det11-baslik
            compute  arasay rounded = (  t-double(1) / takas3-oda(1))  * 100
            move   arasay to z-for-yuzde     
         move z-for-yuzde2 to det11-tutar1                                              
                                                                                       
         compute  arasay rounded =   (t-double(2) / takas3-oda(2)) * 100 
          move   arasay  to z-for-yuzde     
         move z-for-yuzde2 to    det11-tutar2                                              
                                                                                       
           compute  arasay rounded =  ( t-double(3) / takas3-oda(3))  * 100
          move   arasay  to z-for-yuzde     
         move z-for-yuzde2 to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay



          
                 perform dokinit 
         move "Arrivals Tomorrow"          to det11-baslik
             compute  arasay rounded =  for-cinoda(1)
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
        
         move det-11-rec to det-1
       write dokumer-rec from detay




          
                 perform dokinit 
         move "Departures Tomorrow"          to det11-baslik
              compute  arasay rounded =  for-coutoda(1)
            move   arasay  to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                            
                                                                                       
         
         move det-11-rec to det-1
       write dokumer-rec from detay





             
                 perform dokinit 
         move "Occupancy Tomorrow"          to det11-baslik
               compute  arasay rounded =  (for-oda(1) / takas3-hazir(1)) * 100
            move   arasay  to  z-for-yuzde     
         move z-for-yuzde2 to  det11-tutar1                                              
                                                                                       
         
        
         move det-11-rec to det-1
       write dokumer-rec from detay



                
                 perform dokinit 
         move "% Occupancy next 7 Days"          to det11-baslik
           
          compute  arasay rounded =  (next7-oda  / (takas3-hazir(1) * 7) ) * 100
            move   arasay  to z-for-yuzde     
         move z-for-yuzde2 to  det11-tutar1  
         
                           
         move det-11-rec to det-1
       write dokumer-rec from detay



              
                 perform dokinit 
         move "Occupancy next 31 Days"          to det11-baslik
           
          compute  arasay rounded =  (next31-oda  / (takas3-hazir(1) * 31) ) * 100
            move   arasay  to   z-for-yuzde     
         move z-for-yuzde2  to  det11-tutar1  

         move det-11-rec to det-1
       write dokumer-rec from detay


              perform dokinit 
         move "% Occupancy rest of Month"          to det11-baslik
           
          compute  arasay rounded =  (restofmonth-oda  / (takas3-hazir(1) * restofmonth-gun) ) * 100
            move   arasay  to   z-for-yuzde     
         move z-for-yuzde2  to  det11-tutar1  

         move det-11-rec to det-1
       write dokumer-rec from detay


                 perform dokinit 
         move "% Occupancy rest of Year"          to det11-baslik
           
             compute  arasay rounded =  (restofyear-oda  / (takas3-hazir(1) * restofyear-gun) ) * 100
            move   arasay  to   z-for-yuzde     
         move z-for-yuzde2  to  det11-tutar1  

         move det-11-rec to det-1
       write dokumer-rec from detay

                 perform dokinit 
         move "Travel Agent Guests"          to det11-baslik
           
            move    acenta-kisi(1) to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
         
          move   acenta-kisi(2)  to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
        
          move   acenta-kisi(3)  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay


              perform dokinit 
         move "Company Guests"          to det11-baslik
           
            move   sirket-kisi(1) to z-oda1                                                   
         move z-oda1   to    det11-tutar1                                              
                                                                                       
         
          move   sirket-kisi(2) to z-oda1                                                     
         move z-oda1   to    det11-tutar2                                              
                                                                                       
        
          move   sirket-kisi(3)  to z-oda1    
         move z-oda1   to    det11-tutar3 
         move det-11-rec to det-1
       write dokumer-rec from detay

    

********************************22222222222222222222222222222************

     
   

      
***************************************555555555555555555555555*************

             
      

              close dokumer takas6 takas7 takasfiyat
              
              if key-status = 2 then 
              call dokumer-prog on exception
                   perform callerr-proc
              not on exception
                   cancel dokumer-prog
              end-call
               

                 end-if

              delete file dokumer takas6 takas7 takasfiyat
    end-evaluate.
     .

 takas-dosya-yaz.
    initialize doviz-tablo
    perform varying xx from 1 by 1 until xx > 7
        move xx         to doviz-sira(xx)
        move spaces     to doviz-kodu2(xx)
    end-perform.

    open i-o genelfis.
    move 1 to genelfis-anahtar.
    read genelfis no lock invalid 
         move 1 to ekran-fis-1
    end-read.
   
    add 1 to ekran-fis-1.
   
    move ekran-fis-1(2:) to takas6-no takas7-no takasfiyat-no.
    rewrite genelfis-rec invalid 
            write genelfis-rec invalid continue
            end-write
    end-rewrite.
    close genelfis.
     initialize tum-data-REC
    open output takas6 close takas6
    open output takas7 close takas7
    open output takasfiyat close takasfiyat
    open i-o takas6 with mass-update.
    open i-o takas7 with mass-update.
    open i-o takasfiyat.
    open input takvim takvim2.
    initialize takvim-rec.
    move ilk-tarih to takvim-anah kur-tarih.
    move son-tarih to takvim-anah
    start takvim key not < takvim-anah invalid 
          close takvim go takas-dosya-yaz-exit,
          not invalid,
          open input aceanlas rez cast grup aksiyhrk fiyat fiyatana kur konuk romhrk kodlar02 gelist
                       odalar bilbord uzatma odadegis onkasa depkod depkod2 cast3  acenta
          move spaces to eh,
                
          
          perform with test after until evet,
              read takvim next no lock end move "E" to eh,
                   not end,
                   if takvim-anah > son-tarih,
                                    move "E" to eh,
                       else,
                            if takvim-anah not > son-tarih
                               initialize takas6-rec,
                               move takvim-anah to takas6-tarih,
                               write takas6-rec invalid 
                                     rewrite takas6-rec invalid continue
                                     end-rewrite,
                               end-write,
*                               perform cast-oku thru cast-oku-exit,
*                               perform kaydet,
                            end-if,
                   end-if,
              end-read,
          end-perform,
              perform gercek-oda-al
              perform forecast-bul
              perform islenen-bul
              perform diger-bul
              perform tum-bas-bul
        add takas3-oda-tutar-1(1) takas3-yiy-tutar-1(1) takas3-ice-tutar-1(1) takas3-dig-tutar-1(1) 
               to takas3-top-tutar-1(1)
       add takas3-oda-tutar-2(1) takas3-yiy-tutar-2(1) takas3-ice-tutar-2(1) takas3-dig-tutar-2(1) 
               to takas3-top-tutar-2(1)
       add takas3-oda-tutar-3(1) takas3-yiy-tutar-3(1) takas3-ice-tutar-3(1) takas3-dig-tutar-3(1) 
               to takas3-top-tutar-3(1)

        add takas3-oda-tutar-1(2) takas3-yiy-tutar-1(2) takas3-ice-tutar-1(2) takas3-dig-tutar-1(2) 
               to takas3-top-tutar-1(2)
       add takas3-oda-tutar-2(2) takas3-yiy-tutar-2(2) takas3-ice-tutar-2(2) takas3-dig-tutar-2(2) 
               to takas3-top-tutar-2(2)
       add takas3-oda-tutar-3(2) takas3-yiy-tutar-3(2) takas3-ice-tutar-3(2) takas3-dig-tutar-3(2) 
               to takas3-top-tutar-3(2)

       add takas3-oda-tutar-1(3) takas3-yiy-tutar-1(3) takas3-ice-tutar-1(3) takas3-dig-tutar-1(3) 
               to takas3-top-tutar-1(3)
       add takas3-oda-tutar-2(3) takas3-yiy-tutar-2(3) takas3-ice-tutar-2(3) takas3-dig-tutar-2(3) 
               to takas3-top-tutar-2(3)
       add takas3-oda-tutar-3(3) takas3-yiy-tutar-3(3) takas3-ice-tutar-3(3) takas3-dig-tutar-3(3) 
               to takas3-top-tutar-3(3)




**********************************
        add  takas3-yiy-tutar-1(1) takas3-ice-tutar-1(1) takas3-dig-tutar-1(1) 
               to takas3-extra-tutar-1(1)
       add  takas3-yiy-tutar-2(1) takas3-ice-tutar-2(1) takas3-dig-tutar-2(1) 
               to takas3-extra-tutar-2(1)
       add  takas3-yiy-tutar-3(1) takas3-ice-tutar-3(1) takas3-dig-tutar-3(1) 
               to takas3-extra-tutar-3(1)

        add  takas3-yiy-tutar-1(2) takas3-ice-tutar-1(2) takas3-dig-tutar-1(2) 
               to takas3-extra-tutar-1(2)
       add  takas3-yiy-tutar-2(2) takas3-ice-tutar-2(2) takas3-dig-tutar-2(2) 
               to takas3-extra-tutar-2(2)
       add  takas3-yiy-tutar-3(2) takas3-ice-tutar-3(2) takas3-dig-tutar-3(2) 
               to takas3-extra-tutar-3(2)

        add  takas3-yiy-tutar-1(3) takas3-ice-tutar-1(3) takas3-dig-tutar-1(3) 
               to takas3-extra-tutar-1(3)
       add  takas3-yiy-tutar-2(3) takas3-ice-tutar-2(3) takas3-dig-tutar-2(3) 
               to takas3-extra-tutar-2(3)
       add  takas3-yiy-tutar-3(3) takas3-ice-tutar-3(3) takas3-dig-tutar-3(3) 
               to takas3-extra-tutar-3(3)

    end-start.

    .

    close aceanlas takvim takvim2 rez cast grup aksiyhrk kodlar02
       konuk romhrk fiyat fiyatana kur gelist odalar acenta
       bilbord uzatma odadegis onkasa depkod depkod2 cast3 .
 takas-dosya-yaz-exit.
    exit.
*
 diger-bul.
       initialize konuk-rec
       move "H" to konuk-durumu
       
       start konuk key > konuk-git invalid continue
          not invalid
          perform until fs-konuk ="10"
               read konuk next no lock end move "10" to fs-konuk
                 not end
                  if konuk-fol-kodu not ="R" then
                     exit perform cycle
                  end-if
                  if konuk-durumu not = "H"  or konuk-git-tar > son-tarih then
                            move "10" to fs-konuk
                            else
                        if Konuk-Erken-Cik = "E" then
                           if konuk-share = 1
                             move 0 to eklenecek-oda
                              else
                              move 1 to eklenecek-oda
                           end-if
                            if konuk-git-tar = son-tarih
                                add eklenecek-oda to  t-Earlycout(1)
                                add konuk-buyuk konuk-kucuk konuk-free konuk-bebek to  t-Earlycout-kisi(1)

                            end-if
                            if konuk-git-yil = son-yil and konuk-git-ay = son-ay then 
                                     add eklenecek-oda to  t-Earlycout(2)
                                     add konuk-buyuk konuk-kucuk konuk-free konuk-bebek to  t-Earlycout-kisi(2)
                             end-if
                             if konuk-git-yil = son-yil then

                                   add eklenecek-oda to  t-Earlycout(3)
                                    add konuk-buyuk konuk-kucuk konuk-free konuk-bebek to  t-Earlycout-kisi(3)
                             end-if
                        end-if   
                  end-if
                end-read
          end-perform
      end-start
      initialize odadegis-rec
      move ilk-tarih to odadegis-tarih 
       start odadegis key >= odadegis-anah
         invalid continue
         not invalid
         perform until fs-odadegis = "10"
            read odadegis next no lock end move "10" to fs-odadegis
              not end
              move odadegis-folio to konuk-folio
              read konuk  no lock invalid continue
                not invalid
                 if konuk-fol-kodu = "R" then
                          if konuk-share = 1
                             move 0 to eklenecek-oda
                              else
                              move 1 to eklenecek-oda
                           end-if
                       if odadegis-tarih = son-tarih
                                add eklenecek-oda to  t-rchange(1)


                            end-if
                            if odadegis-yil = son-yil and odadegis-ay = son-ay then 
                                     add eklenecek-oda to  t-rchange(2)

                             end-if
                             if odadegis-yil = son-yil then

                                   add eklenecek-oda to  t-rchange(3)

                             end-if
         
                 end-if
              end-read
            end-read
         end-perform
      end-start
       initialize uzatma-rec
      move ilk-tarih to uzatma-tarih 
       start uzatma key >= uzatma-anah
         invalid continue
         not invalid
         perform until fs-uzatma = "10"
            read uzatma next no lock end move "10" to fs-uzatma
              not end
              move uzatma-folio to konuk-folio
              read konuk  no lock invalid continue
                not invalid
                 if konuk-fol-kodu = "R" then
                         if konuk-share = 1
                             move 0 to eklenecek-oda
                              else
                              move 1 to eklenecek-oda
                           end-if
                       if uzatma-tarih = son-tarih
                                add eklenecek-oda to  t-extention(1)
                                 add konuk-buyuk konuk-kucuk konuk-free konuk-bebek to  t-extention-kisi(1)

                            end-if
                            if uzatma-yil = son-yil and uzatma-ay = son-ay then 
                                    add eklenecek-oda to  t-extention(2)
                                   add konuk-buyuk konuk-kucuk konuk-free konuk-bebek to  t-extention-kisi(2)
                             end-if
                             if uzatma-yil = son-yil then
                                   add eklenecek-oda to  t-extention(3)
                                  add konuk-buyuk konuk-kucuk konuk-free konuk-bebek to  t-extention-kisi(3)
                             end-if
         
                 end-if
              end-read
            end-read
         end-perform
      end-start



         .
*
 tum-bas-bul.
    initialize gelist-rec
    move ilk-tarih to gelist-tarih
    
    start gelist key not < gelist-anah invalid 
           continue
          not invalid,
           perform with test after until fs-gelist = "10",
              read gelist next no lock end move "10" to fs-gelist,
                   not end,
                   if gelist-tarih > son-tarih,
                                    move "10" to fs-gelist
                       else,
                         move gelist-folio to konuk-folio
                         read konuk no lock invalid
                            continue
                            not invalid 
                              move konuk-odeme-tipi to kodlar02-kodu
                              move "B" to kodlar02-tipi
                              read kodlar02 no lock 
                                invalid continue
                                

                              end-read  
                         end-read
                         move "01" to kur-banka
                         move butce-cev-doviz  to kur-doviz
                         move gelist-tarih     to kur-tarih
                         read kur no lock invalid move 1 to doviz-alis
                         end-read
                         move doviz-alis to cev1


                         move butce-cev-doviz2 to kur-doviz
                         read kur no lock invalid move 1 to doviz-alis
                         end-read
                         move doviz-alis to cev2

                          if gelist-tarih = son-tarih
                            evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-tutar-1(1) rounded = 
                                                 takas3-hous-tutar-1(1)  + gelist-oda
                                    compute takas3-hous-tutar-2(1) rounded = 
                                                 takas3-hous-tutar-2(1)  + ( gelist-oda /cev1)
                                    compute takas3-hous-tutar-3(1) rounded = 
                                                 takas3-hous-tutar-3(1)  + ( gelist-oda /cev2)
                                 when "C"    when "D"
                                 when "O"
                                    compute takas3-comp-tutar-1(1) rounded = 
                                                 takas3-comp-tutar-1(1)  + gelist-oda
                                    compute takas3-comp-tutar-2(1) rounded = 
                                                 takas3-comp-tutar-2(1)  + ( gelist-oda /cev1)
                                    compute takas3-comp-tutar-3(1) rounded = 
                                                 takas3-comp-tutar-3(1)  + ( gelist-oda /cev2)
                                    
                                 when other
                                    compute takas3-ucr-tutar-1(1) rounded = 
                                                 takas3-ucr-tutar-1(1)  + gelist-oda
                                    compute takas3-ucr-tutar-2(1) rounded = 
                                                 takas3-ucr-tutar-2(1)  + ( gelist-oda / cev1 )
                                    compute takas3-ucr-tutar-3(1) rounded = 
                                                 takas3-ucr-tutar-3(1)  + ( gelist-oda / cev2 )
                            end-evaluate
                            compute takas3-oda-tutar-1(1) rounded = 
                                                 takas3-oda-tutar-1(1)  + gelist-oda
                            compute takas3-oda-tutar-2(1) rounded = 
                                                 takas3-oda-tutar-2(1)  + ( gelist-oda / cev1 )
                            compute takas3-oda-tutar-3(1) rounded = 
                                                 takas3-oda-tutar-3(1)  + ( gelist-oda / cev2 )

                            compute takas3-yiy-tutar-1(1) rounded = 
                                                 takas3-yiy-tutar-1(1)  + gelist-yiy
                            compute takas3-yiy-tutar-2(1) rounded = 
                                                 takas3-yiy-tutar-2(1)  + (gelist-yiy / cev1 )
                            compute takas3-yiy-tutar-3(1) rounded = 
                                                 takas3-yiy-tutar-3(1)  + (gelist-yiy / cev2 )
                                                 
                                                 
                             compute takas3-ice-tutar-1(1) rounded = 
                                                 takas3-ice-tutar-1(1)  + gelist-ice
                             compute takas3-ice-tutar-2(1) rounded = 
                                                 takas3-ice-tutar-2(1)  + (gelist-ice / cev1 )
                            compute takas3-ice-tutar-3(1) rounded = 
                                                 takas3-ice-tutar-3(1)  + (gelist-ice / cev2 )

                             compute takas3-dig-tutar-1(1) rounded = 
                                                 takas3-dig-tutar-1(1)  + gelist-dig
                            compute takas3-dig-tutar-2(1) rounded = 
                                                 takas3-dig-tutar-2(1)  + (gelist-dig / cev1 )
                            compute takas3-dig-tutar-3(1) rounded = 
                                                 takas3-dig-tutar-3(1)  + (gelist-dig / cev2 )

                          end-if
********************************AYLIK

                          if gelist-ay = son-ay and gelist-yil = son-yil then
                                evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-tutar-1(2) rounded = 
                                                 takas3-hous-tutar-1(2)  + gelist-oda
                                    compute takas3-hous-tutar-2(2) rounded = 
                                                 takas3-hous-tutar-2(2)  + ( gelist-oda /cev1)
                                    compute takas3-hous-tutar-3(2) rounded = 
                                                 takas3-hous-tutar-3(2)  + ( gelist-oda /cev2)
                                 when "C"  when "D"
                                 when "O"
                                    compute takas3-comp-tutar-1(2) rounded = 
                                                 takas3-comp-tutar-1(2)  + gelist-oda
                                    compute takas3-comp-tutar-2(2) rounded = 
                                                 takas3-comp-tutar-2(2)  + ( gelist-oda /cev1)
                                    compute takas3-comp-tutar-3(2) rounded = 
                                                 takas3-comp-tutar-3(2)  + ( gelist-oda /cev2)
                                    
                                 when other
                                    compute takas3-ucr-tutar-1(2) rounded = 
                                                 takas3-ucr-tutar-1(2)  + gelist-oda
                                    compute takas3-ucr-tutar-2(2) rounded = 
                                                 takas3-ucr-tutar-2(2)  + ( gelist-oda / cev1 )
                                    compute takas3-ucr-tutar-3(2) rounded = 
                                                 takas3-ucr-tutar-3(2)  + ( gelist-oda / cev2 )
                            end-evaluate
                            compute takas3-oda-tutar-1(2) rounded = 
                                                 takas3-oda-tutar-1(2)  + gelist-oda
                            compute takas3-oda-tutar-2(2) rounded = 
                                                 takas3-oda-tutar-2(2)  + ( gelist-oda / cev1 )
                            compute takas3-oda-tutar-3(2) rounded = 
                                                 takas3-oda-tutar-3(2)  + ( gelist-oda / cev2 )

                            compute takas3-yiy-tutar-1(2) rounded = 
                                                 takas3-yiy-tutar-1(2)  + gelist-yiy
                            compute takas3-yiy-tutar-2(2) rounded = 
                                                 takas3-yiy-tutar-2(2)  + (gelist-yiy / cev1 )
                            compute takas3-yiy-tutar-3(2) rounded = 
                                                 takas3-yiy-tutar-3(2)  + (gelist-yiy / cev2 )
                                                 
                                                 
                             compute takas3-ice-tutar-1(2) rounded = 
                                                 takas3-ice-tutar-1(2)  + gelist-ice
                             compute takas3-ice-tutar-2(2) rounded = 
                                                 takas3-ice-tutar-2(2)  + (gelist-ice / cev1 )
                             compute takas3-ice-tutar-3(2) rounded = 
                                                 takas3-ice-tutar-3(2)  + (gelist-ice / cev2 )

                             compute takas3-dig-tutar-1(2) rounded = 
                                                 takas3-dig-tutar-1(2)  + gelist-dig
                             compute takas3-dig-tutar-2(2) rounded = 
                                                 takas3-dig-tutar-2(2)  + (gelist-dig / cev1 )
                             compute takas3-dig-tutar-3(2) rounded = 
                                                 takas3-dig-tutar-3(2)  + (gelist-dig / cev2 )
     


                          end-if
                          if  gelist-yil = son-yil then
                                evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-tutar-1(3) rounded = 
                                                 takas3-hous-tutar-1(3)  + gelist-oda
                                    compute takas3-hous-tutar-2(3) rounded = 
                                                 takas3-hous-tutar-2(3)  + ( gelist-oda /cev1)
                                    compute takas3-hous-tutar-3(3) rounded = 
                                                 takas3-hous-tutar-3(3)  + ( gelist-oda /cev2)
                                 when "C"  when "D"
                                 when "O"
                                    compute takas3-comp-tutar-1(3) rounded = 
                                                 takas3-comp-tutar-1(3)  + gelist-oda
                                    compute takas3-comp-tutar-2(3) rounded = 
                                                 takas3-comp-tutar-2(3)  + ( gelist-oda /cev1)
                                    compute takas3-comp-tutar-3(3) rounded = 
                                                 takas3-comp-tutar-3(3)  + ( gelist-oda /cev2)
                                    
                                 when other
                                    compute takas3-ucr-tutar-1(3) rounded = 
                                                 takas3-ucr-tutar-1(3)  + gelist-oda
                                    compute takas3-ucr-tutar-2(3) rounded = 
                                                 takas3-ucr-tutar-2(3)  + ( gelist-oda / cev1 )
                                    compute takas3-ucr-tutar-3(3) rounded = 
                                                 takas3-ucr-tutar-3(3)  + ( gelist-oda / cev2 )
                            end-evaluate
                            compute takas3-oda-tutar-1(3) rounded = 
                                                 takas3-oda-tutar-1(3)  + gelist-oda
                            compute takas3-oda-tutar-2(3) rounded = 
                                                 takas3-oda-tutar-2(3)  + ( gelist-oda / cev1 )
                            compute takas3-oda-tutar-3(3) rounded = 
                                                 takas3-oda-tutar-3(3)  + ( gelist-oda / cev2 )

                            compute takas3-yiy-tutar-1(3) rounded = 
                                                 takas3-yiy-tutar-1(3)  + gelist-yiy
                            compute takas3-yiy-tutar-2(3) rounded = 
                                                 takas3-yiy-tutar-2(3)  + (gelist-yiy / cev1 )
                            compute takas3-yiy-tutar-3(3) rounded = 
                                                 takas3-yiy-tutar-3(3)  + (gelist-yiy / cev2 )
                                                 
                                                 
                             compute takas3-ice-tutar-1(3) rounded = 
                                                 takas3-ice-tutar-1(3)  + gelist-ice
                             compute takas3-ice-tutar-2(3) rounded = 
                                                 takas3-ice-tutar-2(3)  + (gelist-ice / cev1 )
                             compute takas3-ice-tutar-3(3) rounded = 
                                                 takas3-ice-tutar-3(3)  + (gelist-ice / cev2 )

                             compute takas3-dig-tutar-1(3) rounded = 
                                                 takas3-dig-tutar-1(3)  + gelist-dig
                             compute takas3-dig-tutar-2(3) rounded = 
                                                 takas3-dig-tutar-2(3)  + (gelist-dig / cev1 )
                             compute takas3-dig-tutar-3(3) rounded = 
                                                 takas3-dig-tutar-3(3)  + (gelist-dig / cev2 ) 


                          end-if
                          
                   end-if,
              end-read,
          end-perform,
    end-start.


 kaydet.
    rewrite takas6-rec invalid 
            write takas6-rec invalid continue
            end-write
    end-rewrite.
*
 takas7-doldur.
       perform peryot-fiyat-bul.

*
 gun-sayisi-bul.
      initialize g-bul-gun-sayisi
                takvim2-rec 
     move rez-gir-tar   to takvim2-anah
     start takvim2 key not < takvim2-anah
           invalid
                move 1 to g-bul-gun-sayisi
     not invalid
     initialize fs-takvim2
     perform with test after until fs-takvim2 = "10"
     read takvim2 next no lock end move "10" to fs-takvim2
     not at end
          if takvim2-anah = rez-cik-tar
             move "10" to fs-takvim2
             exit perform cycle
          end-if
          if takvim2-anah not > rez-cik-tar
             add 1 to g-bul-gun-sayisi
          else
             move "10" to fs-takvim2
          end-if
     end-read
     end-perform
     end-start.

*
 Form2-Ex-Other.
       evaluate key-status
          when 2 
            set exit-pushed to true
       end-evaluate
     .
*
 Form2-Bef-Create.
     .
*
 Form1-Ef-1-Aft-Procedure.
          open input kur doviz 
         move butce-cev-doviz to DOVIZ-KODU
         read doviz no lock invalid
            display message box  "Tanimsiz Doviz Girdiniz"
            move "Tanimsiz " to d-kisa-adi
         end-read
         move  d-kisa-adi to kur-adi

        move ilk-tarih to kur-tarih
        move "87" to kur-banka
        move doviz-kodu to kur-doviz
           read kur no lock invalid
                move 1 to merkez
                display Form1-Cb-1
                move "01" to kur-banka
                read kur no lock invalid
                  move 1 to doviz-alis
                end-read
            end-read
           move doviz-alis to cevrim-kuru
         display kdov adov 
        close kur doviz
     .

*
 Form1-Ef-2-Aft-Procedure.
          open input kur doviz 
         move butce-cev-doviz2 to DOVIZ-KODU
         read doviz no lock invalid
            display message box  "Tanimsiz Doviz Girdiniz"
            move "Tanimsiz " to d-kisa-adi
         end-read
         move  d-kisa-adi to kur-adi2

        move ilk-tarih to kur-tarih
        move "87" to kur-banka
        move doviz-kodu to kur-doviz
           read kur no lock invalid
                move 1 to merkez
                display Form1-Cb-1
                move "01" to kur-banka
                read kur no lock invalid
                  move 1 to doviz-alis
                end-read
            end-read
           move doviz-alis to cevrim-kuru
         display kdova adova 
        close kur doviz
     .


 forecast-bul.
*      open output trnot
      initialize ilerisi
      move ilk-tarih to takvim-anah
      start takvim key >= takvim-anah invalid continue
          not invalid
          perform until fs-takvim = "10"
              read takvim next no lock 
                 end move "10" to fs-takvim
                 not end
                   if takvim-anah <= son-tarih
                     if takvim-anah = son-tarih
                      add  TAKVIM-HAZIR-ODA  to takas3-hazir(1)
                      add takvim-hazir-yatak to takas3-hazir-yatak(1)
                     end-if
                   if takvim-ay = son-ay   and takvim-yil = son-yil
                     add  TAKVIM-HAZIR-ODA  to takas3-hazir(2)
                           add takvim-hazir-yatak   to takas3-hazir-yatak(2)
               
                   end-if
                   if takvim-yil = son-yil   
                     add  TAKVIM-HAZIR-ODA  to takas3-hazir(3)
                     add takvim-hazir-yatak   to takas3-hazir-yatak(3)
               
                   end-if
                     perform gece-bul
                  else
****************************ileriya dogru
                       add 1 to ilerisi
                       if takvim-yil  =  son-yil then
*                             perform bilbord-al
                               if takvim-ay = son-ay and takvim-yil = son-yil
                                         add 1 to    restofmonth-gun
                                end-if
                              if takvim-yil = son-yil
                                    add 1 to restofyear-gun
                              end-if
                           perform igece-bul
                              
*                           if ilerisi = 1 
*                                   compute for-doluluk(ilerisi) = for-oda(ilerisi) + for-forecast(ilerisi)
*                                   compute for-yuzde(ilerisi) rounded  =  for-doluluk(ilerisi) / for-hazir(ilerisi) * 100
*                                   compute for-netdolu(ilerisi) = for-doluluk(ilerisi)  - for-birles(ilerisi)
*                                   compute for-netyuzde(ilerisi) rounded  =  for-netdolu(ilerisi) / for-hazir(ilerisi) * 100
*                           end-if
                           evaluate ilerisi 
                                   when 1 
                                     move takvim-anah to tomorrowtarih
                                   when 7
                                     move takvim-anah to next7tarih
                                   when 31
                                     move takvim-anah to next31tarih
                           end-evaluate


                           else
                          move "10" to fs-takvim
                        end-if


                      
                   end-if

                end-read
          end-perform
     end-start   .
     move tarih-tasi   to takas-blok-bas-tar  takas-blok-bit-tar
  
     
     move "1231" to    takas-blok-bit-tar(5:4)
     move 1 to takas-blok-konumlu

  
        
       perform grup-takas-al
       perform gruplari-takasa-ekle .
               .         
*     close trnot.
*****************************************
 bilbord-al.
    initialize bilbord-rec son-acenta acenta-bilb
    move takvim-anah to bilbord-tarih 
    start bilbord key > bilbord-anah2 invalid continue
      not invalid
       perform until fs-bilbord = "10"
           read bilbord next no lock
             end move "10" to fs-bilbord
              not end
                if son-acenta  = spaces 
                   move bilbord-acenta to son-acenta 
                end-if
                if  son-acenta not = bilbord-acenta
                   if acenta-bilb > 0 then
                       compute for-forecast(ilerisi) = 
                          for-forecast(ilerisi) + acenta-bilb

                    end-if
                    initialize acenta-bilb
                    move bilbord-acenta to son-acenta
                end-if
              if bilbord-tarih  = takvim-anah 
               if  bilbord-oda not = bilbord-sat-oda
              compute acenta-bilb =  acenta-bilb +
                 bilbord-oda - bilbord-sat-oda
               end-if
                else
                move "10" to fs-bilbord
               end-if 
           end-read
       end-perform
    end-start
              if  son-acenta not = bilbord-acenta
                   if acenta-bilb > 0 then
                       compute for-forecast(ilerisi) = 
                          for-forecast(ilerisi) + acenta-bilb

                    end-if
                    initialize acenta-bilb
                    move bilbord-acenta to son-acenta
                end-if


    .

 gece-bul.
     initialize cast-rec var-yok.
    move takvim-anah to cast-tarih.
    start cast key not < cast-tarih invalid continue
      not invalid
        perform with test after until var
          read cast next no lock end move "V" to var-yok
            not end
              if cast-tarih > takvim-anah
                move "V" to var-yok
               else
                initialize rez-rec
                move cast-rez-no to rez-no
                read rez no lock invalid continue
                  not invalid
                          if rez-durumu not = "I"
                             exit perform cycle,
         
                         end-if
                          if ONKPARA-REFERANS-VAR = 1
                       if xkonum-ref(cast-oda-konumu) not = oda-ref and oda-ref > 0 then 
                         continue
                         else
                      perform gece-bul2
                     end-if
                     else
                         perform gece-bul2
                     end-if

                end-read
              end-if
          end-read
        end-perform
    end-start.
 
*
 gece-bul2.
        
          move "B" to kodlar02-tipi
          move rez-odeme-tipi to kodlar02-kodu
          read kodlar02 no lock invalid 
              move spaces to kodlar02-adi
          end-read

*** Grup Filtresi
   
     move 1 to eklenecek-oda
    if rezpara-trace = 1
       if rez-kisi not = cast-kisi
          move cast-kisi to rez-kisi
       end-if
        move cast-oda-no to rez-odano
                              move cast-fiyat-konumu to rez-fiyat-konumu
                              move cast-oda-konumu to rez-oda-konumu
       if cast-share = 1 then 
             move 0 to eklenecek-oda 
            else
              move 1 to eklenecek-oda
       end-if
      else 
          move 1 to eklenecek-oda
    end-if
     if cast-tarih = rez-cik-tar  
        if  cast-tarih = son-tarih then 
           add eklenecek-oda to bugun-cout-oda(1)
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               bugun-cout-kisi(1)
          if cast-tarih = rez-gir-tar then 
               add eklenecek-oda to bugun-dayuse-oda(1)
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               bugun-dayuse-kisi(1)
          end-if
         end-if

         if  cast-ay = son-ay and cast-yil = son-yil then 
                   add eklenecek-oda to bugun-cout-oda(2)
                   add rez-buyuk rez-kucuk rez-free rez-bebek  to 
                       bugun-cout-kisi(2)
          if cast-tarih = rez-gir-tar then 
               add eklenecek-oda to bugun-dayuse-oda(2)
               add rez-buyuk rez-kucuk rez-free rez-bebek  to 
                    bugun-dayuse-kisi(2)
          end-if
         end-if
         if  cast-yil = son-yil then 
                   add eklenecek-oda to bugun-cout-oda(3)
                   add rez-buyuk rez-kucuk rez-free rez-bebek  to 
                       bugun-cout-kisi(3)
          if cast-tarih = rez-gir-tar then 
               add eklenecek-oda to bugun-dayuse-oda(3)
               add rez-buyuk rez-kucuk rez-free rez-bebek  to 
                    bugun-dayuse-kisi(3)
          end-if
         end-if
    end-if
    if cast-tarih >= rez-cik-tar
          exit paragraph
    end-if
      if cast-tarih = rez-gir-tar 
        if cast-tarih = son-tarih then 
           add eklenecek-oda to bugun-cin-oda(1) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               bugun-cin-kisi(1)
           if rez-gec = 1 then 
               add eklenecek-oda to takas3-noshow-oda(1)
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               takas3-noshow-kisi(1)

          end-if
        end-if
         if cast-ay = son-ay and cast-yil = son-yil then 
           add eklenecek-oda to bugun-cin-oda(2) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               bugun-cin-kisi(2)
                 if rez-gec = 1 then 
               add eklenecek-oda to takas3-noshow-oda(2)
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               takas3-noshow-kisi(2)

          end-if
        end-if
         if cast-yil = son-yil then 
           add eklenecek-oda to bugun-cin-oda(3) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               bugun-cin-kisi(3)
                 if rez-gec = 1 then 
               add eklenecek-oda to takas3-noshow-oda(3)
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               takas3-noshow-kisi(3)

          end-if
        end-if





      end-if
        if rez-tipi  = 6
        if cast-tarih = son-tarih then 
           add eklenecek-oda to takas3-walkin-oda(1) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               takas3-walkin-kisi(1)
        end-if
         if cast-ay = son-ay and cast-yil = son-yil then 
           add eklenecek-oda to takas3-walkin-oda(2) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               takas3-walkin-kisi(2)
        end-if
         if cast-yil = son-yil then 
           add eklenecek-oda to takas3-walkin-oda(3) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               takas3-walkin-kisi(3)
        end-if
      end-if
    

     if ychild= 1 then
            compute geceleme = rez-buyuk + ( rez-kucuk / 2)
          else
             compute geceleme =  rez-buyuk
     end-if
          if cast-tarih = son-tarih
             if rez-firma not = spaces then   
                       add rez-buyuk rez-kucuk rez-free rez-bebek to sirket-kisi(1)
                       else
                       initialize acenta-rec
                       move rez-acenta to acenta-kodu
                       read acenta no lock invalid continue
                       end-read
                       if acenta-munferit not = 1
                         add rez-buyuk rez-kucuk rez-free rez-bebek to acenta-kisi(1)
                       end-if
               end-if


       if eklenecek-oda = 1 
         evaluate rez-buyuk
             when 0
             when 1
                 add 1 to t-single(1)
             when 2
                 add 1 to t-double(1)
             when 3 when 4   when 5 when 6  when 7 when 8    when 9
                 add 1 to t-triple(1)

         end-evaluate
       end-if
            
                    evaluate ode-tipi

                         when "F"
                            compute takas3-hous-oda(1) rounded = 
                                         takas3-hous-oda(1)  + eklenecek-oda
                            compute takas3-hous-pax(1) rounded = 
                                         takas3-hous-pax(1)  + rez-buyuk
                            
                         when "C"      when "D"
                         when "O"
                            compute takas3-comp-oda(1) rounded = 
                                         takas3-comp-oda(1)  + eklenecek-oda
                            compute takas3-comp-pax(1) rounded = 
                                         takas3-comp-pax(1)  + rez-buyuk
                            
                         when other
                             compute takas3-ucr-oda(1) rounded = 
                                         takas3-ucr-oda(1)  + eklenecek-oda
                            compute takas3-ucr-pax(1) rounded = 
                                         takas3-ucr-pax(1)  + rez-buyuk
                    end-evaluate
                    compute takas3-oda(1) rounded = 
                                         takas3-oda(1)  + eklenecek-oda
                    
                    compute takas3-pax(1) rounded = 
                                         takas3-pax(1)  + rez-buyuk
                    
                    compute takas3-chi(1) rounded = 
                                         takas3-chi(1)  + rez-kucuk
                    compute takas3-fre(1) rounded = 
                                         takas3-fre(1)  + rez-free

                     if rez-vip  not = " " and rez-vip  not = "N"
                       add 1        to takas3-vip-oda(1)
                       add rez-buyuk to takas3-vip-pax(1)
                     end-if
                  end-if
********************************AYLIK

            if cast-ay = son-ay and cast-yil = son-yil then
                           if rez-firma not = spaces then   
                       add rez-buyuk rez-kucuk rez-free rez-bebek to sirket-kisi(2)
                       else
                       initialize acenta-rec
                       move rez-acenta to acenta-kodu
                       read acenta no lock invalid continue
                       end-read
                       if acenta-munferit not = 1
                         add rez-buyuk rez-kucuk rez-free rez-bebek to acenta-kisi(2)
                       end-if
                   end-if
                          if eklenecek-oda = 1 
                     evaluate rez-buyuk
                         when 1
                             add 1 to t-single(2)
                         when 2
                             add 1 to t-double(2)
                         when 3 when 4   when 5 when 6  when 7 when 8    when 9
                             add 1 to t-triple(2)

                     end-evaluate
                    end-if


                                 evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-oda(2) rounded = 
                                                 takas3-hous-oda(2)  + eklenecek-oda
                                    compute takas3-hous-pax(2) rounded = 
                                                 takas3-hous-pax(2)  + rez-buyuk
                                    
                                 when "C"   when "D"
                                 when "O"
                                    compute takas3-comp-oda(2) rounded = 
                                                 takas3-comp-oda(2)  + eklenecek-oda
                                    compute takas3-comp-pax(2) rounded = 
                                                 takas3-comp-pax(2)  + rez-buyuk
                                    
                                 when other
                                     compute takas3-ucr-oda(2) rounded = 
                                                 takas3-ucr-oda(2)  + eklenecek-oda
                                    compute takas3-ucr-pax(2) rounded = 
                                                 takas3-ucr-pax(2)  + rez-buyuk
                            end-evaluate
                            compute takas3-oda(2) rounded = 
                                                 takas3-oda(2)  + eklenecek-oda
                            
                            compute takas3-pax(2) rounded = 
                                                 takas3-pax(2)  + rez-buyuk
                            
                            compute takas3-chi(2) rounded = 
                                                 takas3-chi(2)  + rez-kucuk
                            compute takas3-fre(2) rounded = 
                                                 takas3-fre(2)  + rez-free

                            if rez-vip not = " " and rez-vip  not = "N"
                               add 1        to takas3-vip-oda(2)
                               add rez-buyuk to takas3-vip-pax(2)
                             end-if

       end-if
      if  cast-yil = son-yil then
                           if rez-firma not = spaces then   
                       add rez-buyuk rez-kucuk rez-free rez-bebek to sirket-kisi(3)
                       else
                       initialize acenta-rec
                       move rez-acenta to acenta-kodu
                       read acenta no lock invalid continue
                       end-read
                       if acenta-munferit not = 1
                         add rez-buyuk rez-kucuk rez-free rez-bebek to acenta-kisi(3)
                       end-if
                   end-if
                                if eklenecek-oda = 1 
                     evaluate rez-buyuk
                         when 1
                             add 1 to t-single(3)
                         when 2
                             add 1 to t-double(3)
                         when 3 when 4   when 5 when 6  when 7 when 8    when 9
                             add 1 to t-triple(3)

                     end-evaluate
                    end-if
                                       evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-oda(3) rounded = 
                                                 takas3-hous-oda(3)  + eklenecek-oda
                                    compute takas3-hous-pax(3) rounded = 
                                                 takas3-hous-pax(3)  + rez-buyuk
                                    
                                 when "C"      when "D"
                                 when "O"
                                    compute takas3-comp-oda(3) rounded = 
                                                 takas3-comp-oda(3)  + eklenecek-oda
                                    compute takas3-comp-pax(3) rounded = 
                                                 takas3-comp-pax(3)  + rez-buyuk
                                    
                                 when other
                                     compute takas3-ucr-oda(3) rounded = 
                                                 takas3-ucr-oda(3)  + eklenecek-oda
                                    compute takas3-ucr-pax(3) rounded = 
                                                 takas3-ucr-pax(3)  + rez-buyuk
                            end-evaluate
                            compute takas3-oda(3) rounded = 
                                                 takas3-oda(3)  + eklenecek-oda
*                                  if takvim-anah = "20100425" then 
*                                  initialize trnot-rec
*                                     move rez-no to trnot-rec
*                                     move rez-buyuk to   trnot-rec(15:)
*                                     write trnot-rec end-write
*                                  end-if
 
                            compute takas3-pax(3) rounded = 
                                                 takas3-pax(3)  + rez-buyuk
                            
                             compute takas3-chi(3) rounded = 
                                                 takas3-chi(3)  + rez-kucuk
                            compute takas3-fre(3) rounded = 
                                                 takas3-fre(3)  + rez-free

                          if rez-vip not = " " and rez-vip  not = "N"
                               add 1        to takas3-vip-oda(3)
                               add rez-buyuk to takas3-vip-pax(3)
                             end-if
                          end-if

              .
   
*****************************************
 igece-bul.
     
    initialize cast-rec var-yok.
    move takvim-anah to cast-tarih.
    start cast key not < cast-tarih invalid continue
      not invalid
        perform with test after until var
          read cast next no lock end move "V" to var-yok
            not end
              if cast-tarih > takvim-anah
                move "V" to var-yok
               else
                initialize rez-rec
                move cast-rez-no to rez-no
                read rez no lock invalid continue
                  not invalid
                          if rez-durumu not = "I"
                       exit perform cycle,
         
                         end-if
                            if ONKPARA-REFERANS-VAR = 1
                       if xkonum-ref(cast-oda-konumu) not = oda-ref and oda-ref > 0 then 
                         continue
                         else
                      perform igece-bul2
                     end-if
                     else
                         perform igece-bul2
                     end-if

                    
                end-read
              end-if
          end-read
        end-perform
    end-start.
 
*
 igece-bul2.
        
     move 1 to eklenecek-oda
    if rezpara-trace = 1
       if rez-kisi not = cast-kisi
          move cast-kisi to rez-kisi
       end-if
       if cast-share = 1 then 
             move 0 to eklenecek-oda 
            else

              move 1 to eklenecek-oda
          end-if
      else 
          move 1 to eklenecek-oda
    end-if
    if ilerisi = 1
     if cast-tarih = rez-cik-tar  
          then 
           add eklenecek-oda to for-coutoda(ilerisi) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               for-coutpax(ilerisi)
          
    end-if
    if cast-tarih >= rez-cik-tar
          exit paragraph
    end-if
      if cast-tarih = rez-gir-tar 
           then 
           add eklenecek-oda to for-cinoda(ilerisi) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               for-cinpax(ilerisi)
    end-if
    
        add eklenecek-oda to for-oda(ilerisi)
        add rez-buyuk  to for-pax(ilerisi)
        add rez-kucuk  to for-chi(ilerisi)
        add rez-free   to for-fre(ilerisi)
        add rez-bebek  to for-beb(ilerisi)
       move cast-oda-no to odalar-anah
        read odalar no lock invalid
          continue
          not invalid
          if odalar-hayali = "H" then
            add eklenecek-oda  to for-birles(ilerisi)
          end-if
       end-read
      end-if
      if ilerisi <= 7 then 
           add eklenecek-oda to next7-oda

      end-if
      if takvim-ay = son-ay and takvim-yil = son-yil
                 add eklenecek-oda to    restofmonth-oda

      end-if

      if takvim-yil = son-yil
          add eklenecek-oda to restofyear-oda

      end-if

       if ilerisi <= 31 then 
           add eklenecek-oda to next31-oda

       end-if


            .
 islenen-bul.
       perform onkasa-oku
      initialize rez-rec
      move "I" to rez-durumu
      move ilk-tarih to rez-isl-tar
      start rez key >= rez-isl invalid continue
        not invalid
          perform until fs-rez = "10"
               read rez next no lock end move "10" to fs-rez
                  not end
                    if rez-durumu not = "I" or rez-isl-tar > son-tarih
                       move "10" to fs-rez
                       exit perform 
                    end-if

                    if rez-durumu  = "I" and rez-isl-tar  = son-tarih
                      if rez-share not = 1 
                          add 1 to bugun-islen-oda(1) 
                      end-if
                      add rez-buyuk to bugun-islen-kisi(1)
                     
                    end-if
                    if rez-durumu  = "I" and rez-isl-ay  = son-ay and rez-isl-yil = son-yil
                      if rez-share not = 1 
                          add 1 to bugun-islen-oda(2) 
                      end-if
                      add rez-buyuk to bugun-islen-kisi(2)
                     
                    end-if
                    if rez-durumu  = "I"  and rez-isl-yil = son-yil
                      if rez-share not = 1 
                          add 1 to bugun-islen-oda(3) 
                      end-if
                      add rez-buyuk to bugun-islen-kisi(3)
                     
                    end-if
                end-read
          end-perform
      end-start .
      initialize rez-rec
      move "S" to rez-durumu
      move ilk-tarih to rez-isl-tar
      start rez key >= rez-isl invalid continue
        not invalid
          perform until fs-rez = "10"
               read rez next no lock end move "10" to fs-rez
                  not end
                    if rez-durumu not = "S" or rez-isl-tar > son-tarih
                       move "10" to fs-rez
                       exit perform 
                    end-if
                    if rez-durumu  = "S" and rez-isl-tar  = son-tarih
                      move cast-share to rez-share
                      if rez-share not = 1 
                          add 1 to bugun-iptal-oda(1)
                      end-if

                      add rez-buyuk to bugun-iptal-kisi(1)
                    
                    end-if
                     if rez-durumu  = "S" and rez-isl-ay  = son-ay and rez-isl-yil = son-yil
                       move cast-share to rez-share
                      if rez-share not = 1 
                          add 1 to bugun-iptal-oda(2)
                      end-if

                      add rez-buyuk to bugun-iptal-kisi(2)
                    
                    end-if
                    if rez-durumu  = "S"  and rez-isl-yil = son-yil
                      if rez-share not = 1 
                          add 1 to bugun-iptal-oda(3)
                      end-if
                     add rez-buyuk to bugun-iptal-kisi(3)
                    end-if
                end-read
          end-perform
      end-start .

 onkasa-oku.
        
     initialize onkasa-rec
     move ilk-tarih to onkasa-tarih
     start onkasa key >= onkasa-anah invalid continue
        not invalid
     perform until fs-onkasa = "10"
     read onkasa next no lock end move "10" to fs-onkasa
              not end
              if onkasa-tarih > son-tarih
                exit perform
              end-if
             
              evaluate onkasa-dep
              when "888" 
                move onkasa-tutar-tl to takas3-dunden
              when "999"
                continue

              when other

              move onkasa-dep to depkod2-kodu depkod-kodu
              read depkod2 no lock invalid
                  move "01" to depkod2-alt-kate
              end-read
              read depkod no lock 
                   invalid 
                   continue
              end-read
              if depkod-turu = 2 then
                 exit perform cycle
              end-if
              if onkasa-tarih = son-tarih
                   move 1 to gay
                   perform   onktak-yaz
              end-if
               if onk-ay = son-ay and onk-yil = son-yil 
                   move 2 to gay
                   perform   onktak-yaz
              end-if

               if onk-yil = son-yil
                   move 3 to gay
                   perform   onktak-yaz
              end-if

              end-evaluate


     end-read
     end-perform
     end-start
     compute takas3-yarin = takas3-dunden + takas3-gelir - takas3-gider
     move takas3-gelir  to g53
     move takas3-gider  to g54
     move takas3-dunden to g56
     move takas3-yarin  to g57



     .
*
 onktak-yaz.

     if depkod2-alt-kate <= "04"
                 if depkod-ba = "B"
                           add       onkasa-tutar-tl        to   takas3-otel(gay) 
                           compute  takas3-otel-net(gay) rounded =  takas3-otel-net(gay) + 
                                  onkasa-tutar-tl / (( 100 + depkod-kdv ) / 100 )

                           subtract  ONKASA-CORR-TUTAR-TL   from takas3-otel(gay) 
                            compute  takas3-otel-net(gay) rounded =  takas3-otel-net(gay) -
                                  ONKASA-CORR-TUTAR-TL / (( 100 + depkod-kdv ) / 100 )
                 else
                           add       ONKASA-CORR-TUTAR-TL       to   takas3-otel(gay) 
                             compute  takas3-otel-net(gay) rounded =  takas3-otel-net(gay) +
                                  ONKASA-CORR-TUTAR-TL / (( 100 + depkod-kdv ) / 100 )
                           subtract  onkasa-tutar-tl            from takas3-otel(gay) 
                             compute  takas3-otel-net(gay) rounded =  takas3-otel-net(gay) -
                                  onkasa-tutar-tl / (( 100 + depkod-kdv ) / 100 )
                 end-if
               
     end-if
              if depkod2-alt-kate = "01"
                 if depkod-ba = "B"
                           add       onkasa-tutar-tl        to   takas3-oda1(gay)
                           compute  takas3-oda1-net(gay) rounded =  takas3-oda1-net(gay) + 
                                  onkasa-tutar-tl / (( 100 + depkod-kdv ) / 100 )


                           subtract  ONKASA-CORR-TUTAR-TL   from takas3-oda1(gay) 
                           compute  takas3-oda1-net(gay) rounded =  takas3-oda1-net(gay) -
                                  ONKASA-CORR-TUTAR-TL / (( 100 + depkod-kdv ) / 100 )
                   else
                           add       ONKASA-CORR-TUTAR-TL       to   takas3-oda1(gay) 
                            compute  takas3-oda1-net(gay) rounded =  takas3-oda1-net(gay) +
                                  ONKASA-CORR-TUTAR-TL / (( 100 + depkod-kdv ) / 100 )
                           subtract  onkasa-tutar-tl            from takas3-oda1(gay) 
                            compute  takas3-oda1-net(gay) rounded =  takas3-oda1-net(gay) -
                                  onkasa-tutar-tl / (( 100 + depkod-kdv ) / 100 )
                 end-if               
              end-if


               if depkod2-alt-kate = "02" or  
                  depkod2-alt-kate = "03"
                 if depkod-ba = "B"
                           add       onkasa-tutar-tl        to   takas3-fb(gay)
                            compute  takas3-fb-net(gay) rounded =  takas3-fb-net(gay) + 
                                  onkasa-tutar-tl / (( 100 + depkod-kdv ) / 100 )

                           subtract  ONKASA-CORR-TUTAR-TL   from takas3-fb(gay)
                            compute  takas3-fb-net(gay) rounded =  takas3-fb-net(gay) -
                                  ONKASA-CORR-TUTAR-TL / (( 100 + depkod-kdv ) / 100 )
                   else
                           add       ONKASA-CORR-TUTAR-TL       to   takas3-fb(gay)
                            compute  takas3-fb-net(gay) rounded =  takas3-fb-net(gay) +
                                  ONKASA-CORR-TUTAR-TL / (( 100 + depkod-kdv ) / 100 )

                           subtract  onkasa-tutar-tl            from takas3-fb(gay)
                             compute  takas3-fb-net(gay) rounded =  takas3-fb-net(gay) -
                                  onkasa-tutar-tl / (( 100 + depkod-kdv ) / 100 )
                 end-if
                
              end-if
                
               if depkod2-alt-kate = "06" or  depkod2-alt-kate = "07"
                 if depkod-ba = "B"
                           add       onkasa-tutar-tl            to   takas3-tahsilat(gay)
                           subtract  ONKASA-CORR-TUTAR-TL       from takas3-tahsilat(gay)
                   else
                           add       ONKASA-CORR-TUTAR-TL       to   takas3-tahsilat(gay)
                           subtract  onkasa-tutar-tl            from takas3-tahsilat(gay)
                 end-if
               

              end-if
          




                .
*
 dokinit.
     initialize det-11-rec 
      initialize dokumer-rec detay
      move "|"  TO     fil11-baslik   fil11-oda1      fil11-pax1      fil11-doluluk1 
                        fil11-oda-ort1   fil11-pax-ort1   fil11-tutar1   
                        fil11-oda2      fil11-pax2      fil11-doluluk2 
                        fil11-oda-ort2   fil11-pax-ort2   fil11-tutar2    fil11-oda3     
                        fil11-pax3      fil11-doluluk3 
                        fil11-oda-ort3   fil11-pax-ort3   fil11-tutar3 .
*

 gruplari-takasa-ekle2.
  
     if takas-blok-konumlu = 1 then 
     move takas-blok-konum to rez-oda-konumu rez-fiyat-konumu
      if onkpara-referans-var = 1 then 
       perform ref-filtre
       if  not ref-gecti then 
           exit paragraph
       end-if
      end-if
     end-if
    
   
   
    
    
***************************************
   
     
      compute geklenecek-oda = takas-blok-ayrilan-oda  - takas-blok-satilan-oda
     if geklenecek-oda < 0 then 
         move 0 to geklenecek-oda
     end-if
          compute geklenecek-pax = takas-blok-ayrilan-pax - takas-blok-satilan-pax
           if   gruplar-kalanlar-double = 1 then 
             compute geklenecek-pax = takas-blok-kalan-oda * 2
        end-if
     if geklenecek-pax < 0 then 
         move 0 to geklenecek-pax
     end-if
******** ara pazar toplamlari
  
        
  
*

  
    
          move takas-blok-tarih to takvim-anah
         
          if takvim-anah > son-tarih and takvim-anah <= next7tarih
                   add  geklenecek-oda to next7-oda    
          end-if
          if takvim-anah > son-tarih and takvim-anah <= next31tarih
             add  geklenecek-oda to next31-oda   
          end-if
          if takvim-anah > son-tarih and takvim-ay = son-ay and takvim-yil = son-yil
              add geklenecek-oda to  restofmonth-oda  
          end-if
          if takvim-anah > son-tarih and takvim-yil = son-yil
                add geklenecek-oda to  restofyear-oda 
          end-if
          
            .


   
      
 


*
 gercek-oda-al.
      
       move son-tarih        to     link-ilk-tarih  
       move son-tarih        to  link-son-tarih   
       move butce-cev-doviz to link-dov 
       move 0 to link-tutar
         call "/asya/ytl/obj/otel/mpanbrh.asy" 
           using    link-ilk-tarih   link-son-tarih  link-dov link-tutar link-occ link-kdvsiz link-referans       
               

           on exception 
           perform callerr-proc
           exit paragraph
           not on exception 
      cancel "/asya/ytl/obj/otel/mpanbrh.asy"
      end-call
        move link-tutar to takas3-odag(1)
        compute takas3-odag-net(1) rounded =  takas3-odag(1) / 1.08
  

      move "01" to link-ilk-tarih(7:2)
      if ilk-tarih >  link-ilk-tarih
       move ilk-tarih        to     link-ilk-tarih 
      end-if
       move son-tarih        to  link-son-tarih   
       move butce-cev-doviz to link-dov 
       move 0 to link-tutar
         call "/asya/ytl/obj/otel/mpanbrh.asy" 
           using    link-ilk-tarih   link-son-tarih  link-dov link-tutar link-occ link-kdvsiz link-referans
           on exception 
           perform callerr-proc
           exit paragraph
           not on exception 
      cancel "/asya/ytl/obj/otel/mpanbrh.asy"
      end-call
        move link-tutar to takas3-odag(2)
        compute takas3-odag-net(2) rounded =  takas3-odag(2) / 1.08


          move "0101" to link-ilk-tarih(5:4)
      if ilk-tarih >  link-ilk-tarih
       move ilk-tarih        to     link-ilk-tarih 
      end-if
       move son-tarih        to  link-son-tarih   
       move butce-cev-doviz to link-dov 
       move 0 to link-tutar
         call "/asya/ytl/obj/otel/mpanbrh.asy" 
           using    link-ilk-tarih   link-son-tarih  link-dov link-tutar link-occ link-kdvsiz link-referans
           on exception 
           perform callerr-proc
           exit paragraph
           not on exception 
      cancel "/asya/ytl/obj/otel/mpanbrh.asy"
      end-call
        move link-tutar to takas3-odag(3)
        compute takas3-odag-net(3) rounded =  takas3-odag(3) / 1.08




                .

 
