* odadegis.evt
* odadegis.evt is generated from D:\asya\acugt.ytl\otel\odadegis.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Exception-Proc.
     PERFORM Exception-Procedure
     .

 accept-yenioda-Exception-Proc.
     PERFORM aaa
     .
***   start event editor code   ***
*
 Form1-Bef-Create.
     perform icyetki-kontrol.
     call "c$narg" using link-var.
     perform adresleri-tasi.
     open input genel     
     move 1 to genel-anahtar
     read genel no lock invalid continue
          not invalid
          move calis-yil    to yil title-yil
          move calis-ay     to  ay title-ay
          move calis-gun    to gun title-gun
     end-read
     close genel.
     open input kodlar02.
     open i-o odalar2.
     open i-o konuk odalar.
     move 0 to vis-boz vis-ekle
     initialize gec-gecme.
*
*
 fis-al.
      open i-o genelfis
      initialize genelfis-rec 
      move 2     to genelfis-anahtar
      read genelfis no lock invalid
           display message box "Genel Parametre Tanimsiz..."
                           title "[ Uyari ]"
                           icon 1
               close genelfis
           exit paragraph
      not invalid
          add 1                 to share-no
          rewrite genelfis-rec end-rewrite 
      end-read 
      close genelfis.
*
 accept-eskioda-Bef-Procedure.
     initialize yeni-oda form-acik.
     if key-status = 1 and eski-oda not = spaces
        exit paragraph
     end-if.
     initialize eski-oda.
     if link-var  = 1
        move link-oda to o-kisa 
            perform oda-uzat
            move o-uzun to  eski-oda
        modify accept-eskioda
     end-if.
     move 0 to vis-boz
     display e1 e2

     modify button-eodaara enabled = true.
     modify button-yodaara enabled = false.
     modify accept-foliono value = zeroes

     modify lb-foliono-e   title = spaces
     modify fr-foliotipi-e title = spaces
     modify lb-adi-e       title = spaces
     modify lb-soyadi-e    title = spaces
     modify lb-girtar-e    title = spaces
     modify lb-ciktar-e    title = spaces
     modify fr-pansiyon-e  title = spaces
     modify lb-pansiyon-e  title = spaces
     modify fr-odeme-e     title = spaces
     modify lb-odeme-e     title = spaces
     modify lb-topborc-e   title = spaces
     modify lb-topalacak-e title = spaces
     modify lb-bakiye-e    title = spaces
     display form1.

     perform bef-procedure.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 exception-procedure.
     move control-id to gidis-id
     evaluate key-status
         when 1 
            evaluate control-id
              when  1001 
              when  14
               perform eoda-ara thru eoda-ara-exit
              when  1002 
              when  16
                perform oda-ara2
            end-evaluate
         when 8 
            if control-id = 1002
                 perform oda-ara2
            end-if
         when 2 
              perform kontroller
              if gecmez
                 initialize gec-gecme
                 move 4        to accept-control
                 move gidis-id to control-id
                 exit paragraph
              end-if           
            
              initialize mesaj-degiskenler
              move "Room Change Islemi Baslasin mi ?..."  to mmesaj-1
              move " [ Islem Basla ] " to mmesaj-title
              move 2           to mmesaj-type
              move 1           to mmesaj-icon
              move 1           to mmesaj-default
              perform mmesaj-ver
              if donus-kodu = 2
                 move 4        to accept-control
                 move gidis-id to control-id
                 exit paragraph
              end-if
              if genel-konum-upgrade-devrede = 1 
              
               if eski-oda-konum not = spaces  and  yeni-konum <> eski-oda-konum  and eski-rom-bulundu = 1 
               initialize rez-rec
               move eski-oda-konum to  l-eski-konum    
               move yeni-konum to l-yeni-konum     
               move upg-rez-no      to  l-rezno rez-no         
               initialize       l-rez-rec  
               open input rez
               read rez no lock invalid continue
               end-read
                move rez-rec to l-rez-rec
               close rez
               move 0 to  l-yapabilir     
                  
                       call "/asya/ytl/obj/otel/blokupg.asy" using  l-eski-konum  l-yeni-konum l-rezno l-rez-rec  l-yapabilir      
                            on exception perform callerr-proc
                            not on exception
                       cancel "/asya/ytl/obj/otel/blokupg.asy" 
                       end-call
*                       display message box  "l-eski-konum    :" l-eski-konum    new-line
*                                            "l-yeni-konum    :" l-yeni-konum     new-line
*                                            "l-rezno         :" l-rezno          new-line
*                                            "l-rez-rec(1:200):" l-rez-rec(1:200)  new-line
*                                            "l-yapabilir     :" l-yapabilir        new-line
*                                            "k-kodu-tasi     :" k-kodu-tasi        new-line
                if  l-yapabilir = 0 then 
                     
                  display message box  "Oda Upgrade Yetkiniz Bulunmamaktadir..." new-line
                                       "Room Change Gerceklesmedi....."
                                  title "Uyari"
                                  icon 2
                      move 1 to gec-gecme
                     initialize yeni-oda
                     display accept-yenioda
                     exit paragraph
                end-if
              end-if
              end-if




              perform kaydet thru kaydet-exit
                      move 4    to accept-control
                      move 1001 to control-id
     end-evaluate.
*                                  
 bef-procedure.
     move control-value    to sonraki-kontrol
     move control-id       to sonraki-id
*     display message box "o-k->" onceki-kontrol, new-line
*                         "S-k->" sonraki-kontrol, new-line
*                         "O-id->" onceki-id, new-line
*                         "S-Id->" sonraki-id, new-line
*                         "key-->" key-status new-line
*                         "gec-gecme-->" gec-gecme.
***>Onceki Kontrole gidebildin ama sonrakine gidemesin....
     if gecmez
        if sonraki-kontrol not = 2
           if sonraki-kontrol > onceki-kontrol
              move 4         to accept-control
              move onceki-id to control-id
              exit paragraph
           end-if
        end-if
     end-if
     evaluate control-id
       when 1001
            modify button-eodaara enabled = true
            move 0 to dana-goster
            display l-dana

       when 1002
                 
                   display y1
            modify button-yodaara enabled = true
            if ( key-status = 1 or key-status = 8 ) and yeni-oda not = spaces
               exit paragraph
            end-if
            initialize yeni-oda
            display accept-yenioda
     end-evaluate.

     initialize mesaj.
     evaluate control-id
          when 1001
              evaluate true
                  when turkce
                       move "Eski Oda Numarasi Giriniz F1->Oda No Ara..." to mesaj
                  when almanca
                       move "Eski Oda Numarasi Giriniz F1->Oda No Ara..." to mesaj
                  when ingilizce
                       move "Eski Oda Numarasi Giriniz F1->Oda No Ara..." to mesaj
              end-evaluate
          when 1002
              evaluate true
                  when turkce
                       move "Yeni Oda Numarasi Giriniz F8->Oda No Ara..." to mesaj
                  when almanca
                       move "Yeni Oda Numarasi Giriniz F8->Oda No Ara..." to mesaj
                  when ingilizce
                       move "Yeni Oda Numarasi Giriniz F8->Oda No Ara..." to mesaj
              end-evaluate
          when 1003
              evaluate true
                  when turkce
                       move "Room Change Aciklamasi Giriniz......." to mesaj
                  when ingilizce
                       move "Room Change Aciklamasi Giriniz......." to mesaj
                  when almanca
                       move "Room Change Aciklamasi Giriniz......." to mesaj
              end-evaluate
          when 1004
              evaluate true
                  when turkce
                       move "Room Change Islemini Baslat... " to mesaj
                  when ingilizce
                       move "Room Change Islemini Baslat... " to mesaj
                  when almanca
                       move "Room Change Islemini Baslat... " to mesaj
              end-evaluate
     end-evaluate.

     modify form1-st-1-handle,
            panel-index = 2 
            panel-text = mesaj.
*
  eski-share-kont.
         move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k. 
          open i-o arez acast   
          initialize acast-rec arez-rec fs-acast fs-arez eski-share-var eski-share-var  vis-boz eski-lab 
          move "SHARE BOZULACAK KAYITLAR " to eski-lab
      
         move tarih-tasi   to acast-tarih
         move eski-oda-k to acast-oda-no
       
            move konuk-sharenum to  bozulacak-share
         start acast key >= acast-anah2 invalid continue
              not invalid 
              perform until fs-acast = "10"
                   read acast next no lock 
                           end move "10" to fs-acast
                           not end
                           if   eski-oda-k = acast-oda-no
                               and tarih-tasi = acast-tarih  
                             if konuk-rez-no not =  acast-rez-no  
                                move acast-rez-no to arez-no
                                 read arez no lock invalid continue
                                 end-read
                                   
                                    move  1 to eski-share-var vis-boz
                                 
                                

                                 string eski-lab delimited by "    "
                                      new-line delimited by size
                                     arez-adi delimited by "    "
                                     " " delimited by size
                                     arez-soyadi delimited by "   "
                                    
                                     into eski-lab
                                 
                                 
                                     
                               end-if
                            else

                             move "10" to fs-acast
                            end-if
                   end-read
              end-perform
        end-start
        close arez acast
        display e1 e2.
     .
*
 dana-bul.
         move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k.
       open i-o arez
       initialize blok-cagir  dana-sharenum
       move 0 to odaramco-bulundu ileri-sharekont
           if eski-folio = 0 then 
                 move "I"      to konuk-durumu
                 move eski-oda-k to konuk-odano
                 start konuk key not < konuk-oda 
                  invalid     move 0 to odaramco-bulundu
                  not invalid 
                   perform until fs-konuk = "10"
                      read konuk next no lock end 
                             move "10" to fs-konuk
                          not end
                         if konuk-odano not = eski-oda-k
                               move "10" to fs-konuk
                               exit perform cycle
                         end-if
                         if konuk-fol-kodu = "R" 
                            move 1 to odaramco-bulundu
                             move "10" to fs-konuk
                               exit perform cycle
                         end-if
                       end-read
                   end-perform
                end-start
    
                if odaramco-bulundu = 0 then 
                   perform  per-odaramco-bulundu
                   exit paragraph
                end-if
              
               
              else
                move eski-folio to konuk-folio
                read konuk no lock invalid 
                    stop " "
                end-read


              end-if
                 move konuk-git-tar   to blok-bit-tar 
                if konuk-sharenum > 0 then
                   move konuk-sharenum to dana-sharenum
                end-if
          
         initialize arez-rec fs-arez  dana-var toplu-mesaj  toplu2
               move "____" to toplu2
               move "I" to arez-durumu 
           move dana-sharenum to arez-sharenum
           start arez key >= arez-anah-share invalid continue
              not invalid
              perform until fs-arez = "10"
                  read arez next no lock end move "10" to fs-arez
                    not end 
                      if arez-durumu = "I" and dana-sharenum = arez-sharenum  and dana-sharenum not = 0 
                         if  
                             arez-odano = konuk-odano
         | rezde sel sýkýntý cok donuyor                  
                
                           
                         
                             move 1 to dana-var
                       
                            if arez-folio not > 0 then 
                               move   "   GELECEK  " to acik1 
                               else
                               move   "   INHOUSE   " to acik1
                            end-if
                                
                              move arez-gir-gun to e-gun
                              move arez-gir-ay  to e-ay
                              move arez-gir-yil to e-yil
                              string toplu2 delimited by   "____"
                                     acik1 delimited by size
                                     "    " delimited by size
                                  etarih delimited by size
                                  "  -  " delimited by size 
                                   "____"  delimited by size
                                into toplu2 
                              move arez-cik-gun to e-gun
                              move arez-cik-ay  to e-ay
                              move arez-cik-yil to e-yil
                                  
                              string toplu2 delimited by  "____"
                                 
                                  etarih delimited by size
                                  "   " delimited by size 
                                  arez-adi delimited by "  " 
                                  " " delimited by size
                                  arez-soyadi delimited by size
                                
                                  new-line delimited by size
                                   new-line delimited by size
                                   "____"  delimited by size
                                into toplu2



                          
                           end-if
                         else
                         move "10" to fs-arez
                      end-if
                   end-read

              end-perform
           end-start.
           close arez.
*
 Aft-Procedure.
      move control-value    to onceki-kontrol
      move control-id       to onceki-id
      move control-id to gidis-id.
      evaluate control-id
     
       when 1001
            modify button-eodaara enabled = false
         initialize gec-gecme eski-share-var
         if eski-oda = spaces
            move 1 to gec-gecme
            exit paragraph
         end-if
         move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k
         move eski-oda-k to odalar-anah
         read odalar no lock invalid 
              initialize mesaj-degiskenler
              move "Tanimsiz Oda Sectiniz."            to mmesaj-1
              move "Oda Numarasini Degistiriniz....."  to mmesaj-2
              move " [ Tanimsiz Oda ] " to mmesaj-title
              move 1           to mmesaj-type
              move 3           to mmesaj-icon
              move 1           to mmesaj-default
              perform mmesaj-ver

              move 1 to gec-gecme
              initialize eski-oda
              display accept-eskioda
              exit paragraph
         not invalid 
            if odalar-aktif-pasif = 1
              initialize mesaj-degiskenler
              move "Secilen Oda Kullanimda Degil.."            to mmesaj-1
              move " [ Tanimsiz Oda ] " to mmesaj-title
              move 1           to mmesaj-type
              move 3           to mmesaj-icon
              move 1           to mmesaj-default
              perform mmesaj-ver

              move 1 to gec-gecme
              initialize eski-oda
              display accept-eskioda
              exit paragraph             
            end-if               
            move odalar-konumu to eski-konum
         end-read
            
         initialize eski-folio
         perform tum-oda-sor thru tum-oda-sor-exit
        
           if gec-gecme = 1 then exit paragraph end-if
             if gec-gecme = 0 and donus-kodu = 2              
              initialize folara-cagir eski-folio
              move "I"    to folara-cagri-tipi
              move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k
              move eski-oda-k  to folara-odano
                   call "/asya/ytl/obj/otel/folara.asy" using folara-cagir
                         on exception perform callerr-proc
                         not on exception
                   cancel "/asya/ytl/obj/otel/folara.asy" 
                   end-call
                   move folara-no-cagir    to eski-folio
                   if eski-folio = 0
                      move 1 to gec-gecme
                      exit paragraph
                   end-if

              move eski-folio to konuk-folio     
              read konuk no lock invalid 
                   move 1 to gec-gecme
                   exit paragraph                    
                   not invalid continue 
                   if konuk-durumu not = "I"
                      move 1 to gec-gecme
                      exit paragraph
                   end-if
                   if konuk-fol-kodu = "R" 
                     move 1 to eski-rom-bulundu
                     MOVE konuk-oda-konumu to eski-oda-konum
                      move konuk-rez-no to upg-rez-no
                     else
                     move 0 to eski-rom-bulundu
                   end-if
              end-read
                
              perform musteri-oku thru musteri-oku-exit
              modify accept-foliono value = konuk-folio
              end-if
              
              if eski-folio > 0  then 
                  perform eski-share-kont
                else
                   continue
                   
              end-if
              if eski-folio = 0 then  
                
                  perform dana-bul
                   if  0 = dana-var
                      move 0 to dana-goster
                   else
                     move 1 to dana-goster
                   end-if
                else
                 move 0 to dana-goster
              end-if
              display l-dana
        

       when 1002 
            modify button-yodaara enabled = false
            initialize gec-gecme
         if yeni-oda = spaces
            move 1 to gec-gecme
            exit paragraph
         end-if
         if eski-oda not = spaces
            if eski-oda = yeni-oda 
               initialize mesaj-degiskenler
               move "Ayni Odaya Room Change Yapamazsiniz.."   to mmesaj-1
               move "Oda Numarasini Degistiriniz....."        to mmesaj-2
               move " [ Yanlis Oda ] " to mmesaj-title
               move 1           to mmesaj-type
               move 3           to mmesaj-icon
               move 1           to mmesaj-default
               perform mmesaj-ver

               move 1 to gec-gecme
               initialize yeni-oda
               exit paragraph
            end-if 
          move yeni-oda  to o-uzun
            perform oda-kisalt
            move o-kisa to  odalar-anah
          read odalar no lock invalid 
               initialize mesaj-degiskenler
               move "Tanimsiz Oda Sectiniz."            to mmesaj-1
               move "Oda Numarasini Degistiriniz....."  to mmesaj-2
               move " [ Tanimsiz Oda ] " to mmesaj-title
               move 1           to mmesaj-type
               move 3           to mmesaj-icon
               move 1           to mmesaj-default
               perform mmesaj-ver

               move 1 to gec-gecme
               initialize yeni-oda
               display accept-yenioda
               exit paragraph
          not invalid 
            if odalar-aktif-pasif = 1
              initialize mesaj-degiskenler
              move "Secilen Oda Kullanimda Degil.."            to mmesaj-1
              move " [ Tanimsiz Oda ] " to mmesaj-title
              move 1           to mmesaj-type
              move 3           to mmesaj-icon
              move 1           to mmesaj-default
              perform mmesaj-ver

              move 1 to gec-gecme
              initialize eski-oda
              display accept-eskioda
              exit paragraph             
            end-if               
               move odalar-konumu to yeni-konum
               

              
          end-read
           

            
          if cinpara-farkli-konum-chg not = "E" and
             eski-konum not = yeni-konum
             initialize mesaj-degiskenler
             move "Oda Konumlari Farkli.."                                   to mmesaj-1
             move "Ayni Oda Konumlari Arasinda Room Cahange Yapabilirsiniz"  to mmesaj-2
             move "Yada Onburo Calisma Parametrelerini Degistiriniz   "      to mmesaj-3
             move " [ Konumlar Hatali ] " to mmesaj-title
             move 1           to mmesaj-type
             move 3           to mmesaj-icon
             move 1           to mmesaj-default
             perform mmesaj-ver
             move 1 to gec-gecme
             initialize yeni-oda
             display accept-yenioda
             exit paragraph
          end-if
             move 0 to vis-ekle
          
            perform blok-kontrol thru blok-kontrol-exit
         
            if eklenecek-share-var not = 1 
                perform blok-kont2
            end-if
            if ODALAR-DURUMU not = HOUSE-BT
             evaluate odalar-durumu
                  when       HOUSE-BK   move "Kirli    " to kadir-acik
                  when       HOUSE-CO   move "Kirli    " to kadir-acik
                  when       HOUSE-AO   move "ARIZALI  " to kadir-acik
                
                  when other            move "Uygunsuz " to kadir-acik
            end-evaluate
            
               if v-ekle = 1 and eklenecek-share-var = 0 then 
                  display message box "Dolu Odaya Share Etmeye Calismaniza ragmen " new-line
                                  "Bos Oda Vermektesiniz" new-line new-line 
                                  title " BOS ODA VERILIYOR" 

               end-if
              display y1 


            
*             display message box "Uygun olmayan oda konumu " new-line   new-line 
*               kadir-acik "   ODA "   new-line    new-line 
*               "Lutfen Oda Temizlendikten sonra deneyiniz"
*                 title "ODA HAZIR DEGIL"
            end-if
            end-if
      .
*
 kontroller.
         initialize gec-gecme
         if eski-oda = spaces
            move 1 to gec-gecme
            exit paragraph
         end-if
          if ODALAR-DURUMU not = HOUSE-BT and  v-ekle = 0
             display message box "Uygun olmayan oda konumu " new-line 
               "Lutfen Oda Temizlendikten sonra deneyiniz"
                 title "ODA HAZIR DEGIL"
                 

          end-if
          move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k
         move eski-oda-k to odalar-anah
         read odalar no lock invalid 
              initialize mesaj-degiskenler
              move "Tanimsiz Oda Sectiniz."            to mmesaj-1
              move "Oda Numarasini Degistiriniz....."  to mmesaj-2
              move " [ Tanimsiz Oda ] " to mmesaj-title
              move 1           to mmesaj-type
              move 3           to mmesaj-icon
              move 1           to mmesaj-default
              perform mmesaj-ver

              move 1 to gec-gecme
              initialize eski-oda
              display accept-eskioda
              exit paragraph
              not invalid continue 
              move odalar-konumu to eski-konum
         end-read

         if yeni-oda = spaces
            move 1 to gec-gecme
            exit paragraph
         end-if
            if eski-oda = yeni-oda 
               initialize mesaj-degiskenler
               move "Ayni Odaya Room Change Yapamazsiniz.."   to mmesaj-1
               move "Oda Numarasini Degistiriniz....."        to mmesaj-2
               move " [ Yanlis Oda ] " to mmesaj-title
               move 1           to mmesaj-type
               move 3           to mmesaj-icon
               move 1           to mmesaj-default
               perform mmesaj-ver

               move 1 to gec-gecme
               initialize yeni-oda
               exit paragraph
            end-if 
            if yeni-oda > "9000" and yeni-oda < "9100" then 
               display message box "POS ICIN AYRILAN ODA  " new-line 
                    "BASKA ODA DENEYINIZ"  title "    "
            end-if
         move yeni-oda  to o-uzun
            perform oda-kisalt
            move o-kisa to  odalar-anah
         read odalar no lock invalid 
              initialize mesaj-degiskenler
              move "Tanimsiz Oda Sectiniz."            to mmesaj-1
              move "Oda Numarasini Degistiriniz....."  to mmesaj-2
              move " [ Tanimsiz Oda ] " to mmesaj-title
              move 1           to mmesaj-type
              move 3           to mmesaj-icon
              move 1           to mmesaj-default
              perform mmesaj-ver

              move 1 to gec-gecme
              initialize yeni-oda
              display accept-yenioda
              exit paragraph
              not invalid continue 
              move odalar-konumu to yeni-konum
         end-read

         if cinpara-farkli-konum-chg not = "E" and
            eski-konum not = yeni-konum
            initialize mesaj-degiskenler
            move "Oda Konumlari Farkli.."                                   to mmesaj-1
            move "Ayni Oda Konumlari Arasinda Room Cahange Yapabilirsiniz"  to mmesaj-2
            move "Yada Onburo Calisma Parametrelerini Degistiriniz   "      to mmesaj-3
            move " [ Konumlar Hatali ] " to mmesaj-title
            move 1           to mmesaj-type
            move 3           to mmesaj-icon
            move 1           to mmesaj-default
            perform mmesaj-ver
            move 1 to gec-gecme
            initialize yeni-oda
            display accept-yenioda
            exit paragraph
         end-if

         if form-acik = spaces
            initialize mesaj-degiskenler
            move "Lutfen Aciklama Giriniz."           to mmesaj-1
            move " [ Aciklama Bos ] "                 to mmesaj-title
            move 1           to mmesaj-type
            move 2           to mmesaj-icon
            move 1           to mmesaj-default
            perform mmesaj-ver
            move 1 to gec-gecme
            display accept-yenioda
            exit paragraph
         end-if
      .

 Form1-Aft-Routine.
      close odalar2.
*
 musteri-oku.
        modify lb-foliono-e title = konuk-folio
        modify fr-foliotipi-e title = konuk-fol-kodu
        modify lb-adi-e     title = konuk-adi
        modify lb-soyadi-e  title = konuk-soyadi

        move konuk-gel-gun      to e-gun
        move konuk-gel-ay       to e-ay 
        move konuk-gel-yil      to e-yil
        modify lb-girtar-e  title = etarih

        move konuk-git-gun      to e-gun
        move konuk-git-ay       to e-ay 
        move konuk-git-yil      to e-yil
        modify lb-ciktar-e  title = etarih

        move "A"            to kodlar02-tipi
        move konuk-pan-tipi to kodlar02-kodu
        read kodlar02 no lock invalid 
             initialize kodlar02-adi 
             not invalid continue
        end-read
        modify fr-pansiyon-e  title = konuk-pan-tipi
        modify lb-pansiyon-e  title = kodlar02-adi

        move "B"            to kodlar02-tipi
        move konuk-odeme-tipi to kodlar02-kodu
        read kodlar02 no lock invalid 
             initialize kodlar02-adi 
             not invalid continue
        end-read
        modify fr-odeme-e  title = konuk-odeme-tipi
        modify lb-odeme-e  title = kodlar02-adi

        move konuk-top-borc     to z-tutar
        modify lb-topborc-e  title = z-tutar
        move konuk-top-alac     to z-tutar
        modify lb-topalacak-e  title = z-tutar
        initialize z-tutar
        compute z-tutar = konuk-top-borc - konuk-top-alac
        modify lb-bakiye-e  title = z-tutar
            .
 musteri-oku-exit.
     exit.
*
 tum-oda-sor.
 eski-oda-oku.
       move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k
    initialize konuk-rec.
    move "I"      to konuk-durumu.
    move eski-oda-k to konuk-odano.
    start konuk key not < konuk-oda invalid 
           display message box "Secmis Oldugunuz Oda Bos...."
                          new-line,
                         title = " [ Bos Oda ] "
           move 1 to gec-gecme
           go tum-oda-sor-exit
           not invalid continue
    end-start.
     move 0 to eski-oda-bulundu eski-rom-bulundu
    perform until fs-konuk = "10"
    read konuk next no lock end 
          if eski-oda-bulundu = 0
         display message box "Secmis Oldugunuz Oda Bos...."
                         new-line,
                         title = " [ Bos Oda ] "
           move 1 to gec-gecme
           go tum-oda-sor-exit
           end-if
     end-read
     if konuk-odano = eski-oda-k 
        add 1 to  eski-oda-bulundu
        if  eski-oda-bulundu = 1  or konuk-fol-kodu = "R"
           modify accept-foliono value = konuk-folio
          perform musteri-oku thru musteri-oku-exit
        end-if
        if konuk-fol-kodu = "R" 
            move 1 to  eski-rom-bulundu
            MOVE konuk-oda-konumu to eski-oda-konum
            move konuk-rez-no to upg-rez-no
        end-if
     else
        if eski-oda-bulundu = 0
        display message box "Secmis Oldugunuz Oda Bos...."
                        new-line,
                        title = " [ Bos Oda ] "
        move 1 to gec-gecme
        go tum-oda-sor-exit
        end-if
     end-if
     end-perform.
     
     initialize donus-kodu.
     display message box "Bu Odaya Ait Tum Foliolar Aktarilsin Mi ?"
                          new-line,
                         title = " [ Folio Sec ] "
                         type  = mb_yes-no returning donus-kodu
                         default = 1

    .
 tum-oda-sor-exit.
     exit.
*
 Form1-Aft-Initdata.
     modify form1-fr-3 title = tarih-title.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
 git-oda-share.
      
        open i-o rez cast
       move  eklenecek-share-ekfolio to konuk-folio
       read konuk no lock invalid stop " "
         not invalid
            move eklenecek-sharenum to konuk-sharenum
           rewrite konuk-rec invalid stop " " end-rewrite
      end-read
      move konuk-rez-no to rez-no
       read rez no lock invalid stop " "
         not invalid
            move eklenecek-sharenum to rez-sharenum

            accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
            accept rez-edit-zaman from time          |                           

           rewrite rez-rec invalid stop " " end-rewrite
      end-read
      
        initialize cast-rec
        move calisma-tarihi to cast-tarih.
        move konuk-rez-no   to cast-rez-no.
        start cast key not < cast-anah1 invalid 
            continue
            not invalid 
            perform until fs-cast = "10"
             read cast next no lock end move "10" to fs-cast
                 not end
                        if cast-tarih  > konuk-git-tar or 
                           cast-rez-no > konuk-rez-no  
                            move "10" to fs-cast
                            exit perform cycle
                        end-if
                         if cast-rez-no = konuk-rez-no 
                             move  eklenecek-sharenum to cast-sharenum
                         end-if
                          rewrite cast-rec invalid display message box "hataa 566666"
                          end-rewrite
                          perform log-operation-cast
               end-read
            end-perform
         end-start
         close rez cast
         .
*
 kaydet.
     
      perform blok-kontrol thru blok-kontrol-exit

      if v-ekle = 0 and eklenecek-share-var = 1 then 
         display message box "Dolu Odaya Share Et Secenegini tiklamalisiniz"
              title "    "
             go kaydet-exit
     end-if
     if v-boz = 0 and eski-share-var = 1 then 
         display message box "Share Boz Secenegini tiklamalisiniz"
              title "    "
             go kaydet-exit
     end-if
    
     if eklenecek-share-var = 1 and eklenecek-sharenum not >  0 then 
           perform fis-al
            move share-no      to eklenecek-sharenum
            perform git-oda-share
      end-if 
      if gec-gecme = 1 then 
        display message box "Islem Gerceklesmedi"
         go kaydet-exit
      end-if .
  
 folio-aktar.
          move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k   
            initialize konuk-rec.
    move "I"      to konuk-durumu.
    move eski-oda-k to konuk-odano.

    
    start konuk key not < konuk-oda invalid 
          go kaydet-exit.
       open i-o odadegis.
 folio-oku.
    read konuk next no lock end go islem-bitti.
    if fs-konuk = 99 go folio-oku.
    evaluate true
       when konuk-durumu not = "I"     go islem-bitti,
       when konuk-odano >     eski-oda-k go islem-bitti,
       when konuk-odano not = eski-oda-k go folio-oku,
       when eski-folio not = 0 and konuk-folio not = eski-folio go folio-oku,
    end-evaluate.

    move yeni-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to  konuk-odano yeni-oda-k
    move yeni-konum  to konuk-oda-konumu.
    if eski-share-var = 1 then 
       if bozulacak-share not = konuk-sharenum then
         if k-kodu-tasi = "ASYA" or "X   " then stop " " end-if
          display message box "Hataaaaaaa 1565866 "
       end-if
       initialize konuk-sharenum
    end-if
    if eklenecek-share-var = 1 
       move  eklenecek-sharenum  to konuk-sharenum
    else
       if eski-folio not = 0 then 
          move 0 to konuk-share
       end-if
    end-if 
    rewrite konuk-rec invalid continue
    end-rewrite.
    perform log-operation-konuk.
    move yeni-oda     to o-uzun
    perform oda-kisalt
    move o-kisa to   yeni-oda-k
    move eski-oda     to o-uzun
    perform oda-kisalt
    move o-kisa to   eski-oda-k.
    move calisma-tarihi   to odadegis-tarih,
    move eski-oda-k       to odadegis-eski-oda,
    move yeni-oda-k       to odadegis-yeni-oda,
    accept odadegis-zaman from time
    read odadegis no lock 
         invalid continue,
    not invalid
        call "c$sleep" using 1
        accept odadegis-zaman from time
    end-read,
    move konuk-folio    to odadegis-folio,
    move form-acik      to odadegis-aciklama,
    move k-kodu-tasi    to odadegis-staf,
    write odadegis-rec invalid 
         rewrite odadegis-rec,
         end-rewrite continue
    end-write.

    if konuk-fol-kodu = "R"
       perform rez-duzelt    thru rez-duzelt-exit
       perform cast-duzelt   thru cast-duzelt-exit
       perform takvim-duzelt thru takvim-duzelt-exit
       perform odalar-isle   thru odalar-isle-exit 
       perform odatemiz-isle
*       if telpara-dishat-ac-kapa = 1 then 
*          perform hat-ac
*          perform hat-kapa
*       end-if
    end-if.
     perform extpost-deg
     move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k
    move eski-oda-k to konuk-odano
    perform blokaj-degisim-yaz
   
    go folio-oku.
 islem-bitti.
       close odadegis.
         
       if eski-share-var  = 0  and vis-boz = 0 and dana-sharenum > 0
******************           anasýný alýyosan danasýný da al
           perform danasinial
        end-if
       if eski-share-var = 1 then 
          move bozulacak-share to eski-sharenum
          perform share-sil-kont
       end-if .
      
       
       if eklenecek-share-var = 1 then 
          move eklenecek-sharenum to rez-sharenum
          perform share-koy-kont
       end-if .
       
 kaydet-exit.
    exit.
*
 danasinial.
           move yeni-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   yeni-oda-k
       open i-o arez acast
         initialize arez-rec fs-arez  dana-var toplu-mesaj
         move  "DEGISEN ODAYA SHARE " to   toplu-mesaj
           move "I" to arez-durumu 
           move dana-sharenum to arez-sharenum
           start arez key >= arez-anah-share invalid continue
              not invalid
              perform until fs-arez = "10"
                  read arez next no lock end move "10" to fs-arez
                    not end 
                      if arez-durumu = "I" and dana-sharenum = arez-sharenum
                          if arez-folio not > 0 then 
                           move arez-rec to buf-rec
                             if eklenecek-share-var = 1 then 
                                  move eklenecek-sharenum to arez-sharenum
                              end-if 
                                move yeni-oda     to o-uzun
                            perform oda-kisalt
                            move o-kisa to   yeni-oda-k
                             move yeni-oda-k to arez-odano
                             move yeni-konum to arez-oda-konumu
                             rewrite arez-rec invalid stop " " end-rewrite
                             initialize acast-rec fs-acast
                             move arez-no to acast-rez-no 
                             start acast key >= acast-anah1 invalid stop " "
                                not invalid
                                perform until fs-acast = "10"
                                   read acast next no lock  end move "10" to fs-acast
                                      not end
                                         if acast-rez-no not = arez-no then 
                                            move "10" to fs-acast
                                            exit perform cycle
                                         end-if
                                            if eklenecek-share-var = 1 then 
                                                  move eklenecek-sharenum to acast-sharenum
                                             end-if 
                                             move yeni-oda-k to acast-oda-no
                                             move yeni-konum to acast-oda-konumu
                                         end-read
                                         rewrite acast-rec invalid stop " " end-rewrite
                                   end-perform


                              end-start
                              move 1 to dana-var
                              move arez-gir-gun to e-gun
                              move arez-gir-ay  to e-ay
                              move arez-gir-yil to e-yil
                                


                              string toplu-mesaj delimited by "       "
                                   new-line delimited by size 
                                  etarih delimited by size
                                  " girisli " delimited by size 
                                  arez-adi delimited by "  "
                                  " " delimited by size
                                  arez-soyadi delimited by " " 
                                  new-line delimited by size
                                into toplu-mesaj
                             move buf-rec to arez-rec
                          end-if
                         else
                         move "10" to fs-arez
                      end-if
                   end-read

              end-perform
           end-start
              if dana-var = 1 then 
                      string 
                              toplu-mesaj delimited by "      "
                                    new-line delimited by size
                               "Blokajlari degistirildi "  delimited by size 
                                    new-line delimited by size
                               "Bilginize ............."  delimited by size

                                      new-line delimited by size
                                into toplu-mesaj
                     display  message box  toplu-mesaj title "Bilginize ............."
              end-if


       close arez acast .
*
 rez-duzelt.
           move yeni-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   yeni-oda-k
          open i-o rez.
          move konuk-rez-no   to rez-no.
          read rez no lock invalid go rez-duzelt-bitti.
          move yeni-oda-k           to rez-odano.
          move konuk-oda-konumu   to rez-oda-konumu.
          if eski-share-var = 1 then 
             if bozulacak-share not = rez-sharenum then
                
                display message box "Hataaaaaaa 1566 "
             end-if

             initialize rez-sharenum
          end-if
          if eklenecek-share-var = 1 
             move  eklenecek-sharenum  to rez-sharenum
             else
              if eski-folio not = 0 then 
                   move 0 to rez-share
              end-if 
          end-if 

          accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
          accept rez-edit-zaman from time          |                           

          rewrite rez-rec invalid continue 
          end-rewrite.
*          if k-kodu-tasi = "ASYA" STOP " " end-if
          if eski-share-var not = 1 and vis-boz not = 1  then 
              perform hat-kapat
          end-if

          if eklenecek-share-var not = 1 
              perform hat-ac
          end-if
             
                  perform log-operation-rez.

 rez-duzelt-bitti.
          close rez.
 rez-duzelt-exit.
    exit.
*
 cast-duzelt.
        open i-o cast.
        move calisma-tarihi to cast-tarih.
        move konuk-rez-no   to cast-rez-no.
        start cast key not < cast-anah1 invalid 
              go cast-duzelt-bitti.
 cast-duzelt-oku.
        read cast next no lock end go cast-duzelt-bitti.
        if fs-cast = 99 go cast-duzelt-oku.
        if cast-tarih  > konuk-git-tar go cast-duzelt-bitti.
        if cast-rez-no > konuk-rez-no  go cast-duzelt-bitti.
        if cast-rez-no = konuk-rez-no 
           continue
        else 
           go cast-duzelt-oku
        end-if.
             move yeni-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   yeni-oda-k
           move yeni-oda-k   to cast-oda-no.
           move yeni-konum to cast-oda-konumu.
           if eski-share-var = 1 then 
             if bozulacak-share not = cast-sharenum then
                display message box "Hataaaaaaa 1566 "
             end-if
             initialize cast-sharenum
          end-if
          if eklenecek-share-var = 1 
             move  eklenecek-sharenum  to cast-sharenum
               else
                  if eski-folio not = 0 then 
                      move 0 to cast-share
                  end-if
          end-if 
        rewrite cast-rec invalid 
            continue.
        perform log-operation-cast
            go cast-duzelt-oku.
 cast-duzelt-bitti.
        close cast.
 cast-duzelt-exit.
    exit.
*
 takvim-duzelt.
         if eski-konum not = yeni-konum 
            continue
         else
            go takvim-duzelt-exit
        end-if.
        open i-o takvim.
        move konuk-gel-tar to takvim-anah.
        start takvim key not < takvim-anah invalid 
              go takvim-duzelt-bitti.
 takvim-duzelt-oku.
        read takvim next no lock end 
             go takvim-duzelt-bitti.
        if fs-takvim = 99 go takvim-duzelt-oku.
        if takvim-anah = konuk-git-tar 
           go takvim-duzelt-bitti
        end-if.
        if takvim-anah > konuk-git-tar 
           go takvim-duzelt-bitti
        end-if.

          compute takvim-sat-oda(yeni-konum) =
                  takvim-sat-oda(yeni-konum ) + 1.
          compute takvim-sat-oda(eski-konum ) =
                  takvim-sat-oda(eski-konum ) - 1.

          compute takvim-sat-buyuk(yeni-konum ) =
                  takvim-sat-buyuk(yeni-konum ) + konuk-buyuk.
          compute takvim-sat-buyuk(eski-konum ) =
                  takvim-sat-buyuk(eski-konum ) - konuk-buyuk.

          compute takvim-sat-kucuk(yeni-konum ) =
                  takvim-sat-kucuk(yeni-konum ) + konuk-kucuk.
          compute takvim-sat-kucuk(eski-konum ) =
                  takvim-sat-kucuk(eski-konum ) - konuk-kucuk.

          compute takvim-sat-free(yeni-konum ) =
                  takvim-sat-free(yeni-konum ) + konuk-free.
          compute takvim-sat-free(yeni-konum ) =
                  takvim-sat-free(yeni-konum ) + konuk-bebek.
          compute takvim-sat-free(eski-konum ) =
                  takvim-sat-free(eski-konum ) - konuk-free.
          compute takvim-sat-free(eski-konum ) =
                  takvim-sat-free(eski-konum ) - konuk-bebek.
        rewrite takvim-rec invalid go takvim-duzelt-oku.
            go takvim-duzelt-oku.

 takvim-duzelt-bitti.
        close takvim.
 takvim-duzelt-exit.
    exit.
*
 blok-kontrol.
 yeni-oda-oku.
   
     initialize yeni-lab  eklenecek-share-var
     move "SHARE EKLENECEK KAYITLAR " to yeni-lab
    initialize konuk-rec.
    move "I"      to konuk-durumu.
      move yeni-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   yeni-oda-k
    move yeni-oda-k to konuk-odano.
    start konuk key not < konuk-oda invalid 
          go blok-kontrol-basla.
 konuk-oku.
    read konuk next no lock end 
         go blok-kontrol-basla.
    if konuk-odano not =  yeni-oda-k then 
           go blok-kontrol-basla
        end-if
    if konuk-durumu not = "I" 
         go blok-kontrol-basla
    end-if.
    
    if konuk-odano = yeni-oda-k and 
      ( cinpara-dolu-oda-chg not = "E" or v-ekle = 1 )
       if  v-ekle =  0 then 
       move 1 to gec-gecme
       display message box 
               "Dolu Odaya Room Change Yapamazsiniz."
               new-line,
               title = " [ Dolu Oda Sectiniz ] "
               go blok-kontrol-exit
             else
*** mami   stop             
            if eklenecek-share-var = 1 
                if konuk-sharenum not = eklenecek-sharenum or eklenecek-sharenum  not >  0
                      display message box "Problemli Share olan odaya share 1556"

                end-if
                else
                  move konuk-sharenum to eklenecek-sharenum
                if eklenecek-sharenum not >  0 then 
                   move konuk-folio to eklenecek-share-ekfolio
                  
                 
                end-if
            end-if
            move 1 to eklenecek-share-var vis-ekle
            if eklenecek-share-var = 1 
            string yeni-lab delimited by "    "
                                      new-line delimited by size
                                     konuk-adi delimited by "    "
                                     " " delimited by size
                                     konuk-soyadi delimited by "   "
                                    
                                     into yeni-lab


           go blok-kontrol-basla
       end-if  
    end-if.



 blok-kontrol-basla.
        go blok-kontrol-exit.
        open i-o cast 
        open  i-o rez.
           initialize gec-gecme.
        move calisma-tarihi to cast-tarih.
          move yeni-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   yeni-oda-k
        move yeni-oda-k       to cast-oda-no.
        start cast key not < cast-anah3 invalid 
              go blok-kontrol-bitti.
 blok-kontrol-oku.
        read cast next no lock end 
             go blok-kontrol-bitti.
        if fs-cast = 99 go blok-kontrol-oku.
        
        if cast-tarih  > calisma-tarihi go blok-kontrol-bitti.
        if cast-oda-no > yeni-oda-k      go blok-kontrol-bitti.
        if cast-oda-no = yeni-oda-k  
            move cast-rez-no to rez-no
            
            read rez no lock 
                invalid
                display message box "Lutfen Forecastlari yeniden calistirin"
                not invalid
                if rez-durumu not = "I" then 
                     go blok-kontrol-oku
                  end-if
               if rez-cik-tar = calisma-tarihi then 
                   go blok-kontrol-oku
               end-if
               if rez-folio > 0 and v-ekle = 1 
                  go blok-kontrol-oku
               
               end-if
               end-read
        else 
           go blok-kontrol-oku
        end-if.
        
           initialize mesaj-degiskenler
           move "Girdiginiz Oda Konaklama tarihlerinde Blokeli.." to mmesaj-1
           move cast-rez-no to mmesaj-3
           move "Emin misiniz..............?????????" to mmesaj-2

           move "    [ Dikkat ]   " to mmesaj-title
           move mb-yes-no           to mmesaj-type
           move mb-warning-icon     to mmesaj-icon
           move 2           to mmesaj-default
           perform mmesaj-ver
           if donus-kodu = 2 
              move 1 to gec-gecme
              else 
              if rez-folio  = 0 then 
                read rez no lock 
                invalid
                display message box "Lutfen Forecatlari yeniden calistirin"
                not invalid
                     initialize rez-odano 

                     accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                     accept rez-edit-zaman from time          |                           

                     rewrite rez-rec invalid stop " " end-rewrite
                      start cast key not < cast-anah1 invalid
                        continue 
                        not invalid
                        perform until fs-cast = "10" 
                         read cast  next no lock
                            end  move "10" to fs-cast
                            not end 
                             if cast-rez-no not = rez-no 
                                 move "10" to fs-cast
                             else
                               initialize cast-oda-no
                               rewrite cast-rec invalid 
                                  stop " " 
                               end-rewrite
                               perform log-operation-cast
                             end-if
                         end-read
                         end-perform
                      end-start
                    display message box 
                  "Cakisan Blokaji Kaldirildi " new-line 
                  rez-adi rez-soyadi
                   
               end-read
               else 
                      display message box "Dolu Odaya Room Change Yapmaktasiniz "


              end-if
           end-if. 
        .
 blok-kontrol-bitti.
        close cast rez.
 blok-kontrol-exit.
     exit.
*
 odalar-isle. 
            move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k
             move eski-oda-k  to odalar-no. 
             read odalar no lock invalid 
                  go odalar-isle-exit. 
             move house-bk  to odalar-durumu house-durumu. 
             move "K"       to odalar-odatemiz              |Klima Filtre Bakim Sistemi 29/07/2020 Fýrat 
             rewrite odalar-rec invalid continue
             end-rewrite. 
                     perform log-operation-odalar.
               move yeni-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   yeni-oda-k
             move yeni-oda-k  to odalar-no. 
             read odalar no lock invalid 
                  go odalar-isle-exit. 
             move house-dk  to odalar-durumu house-durumu. 
             rewrite odalar-rec invalid continue
             end-rewrite. 
                     perform log-operation-odalar.
 odalar-isle-exit. 
       exit. 
*
 eoda-ara.
      initialize oda-cagir.
      move "D"   to oda-db-cagir.
      call "/asya/ytl/obj/otel/odaara.asy" using oda-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/odaara.asy" 
       end-call.
       move odano-cagir     to o-kisa 
            perform oda-uzat
            move o-uzun to  eski-oda.
 eoda-oku.
          move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k
       initialize odalar-rec.
       move eski-oda-k     to odalar-anah
       read odalar         no lock invalid 
            move 1         to gec-gecme
            not invalid continue 
       end-read
       display accept-eskioda.
 eoda-oku-exit.
       exit.
 eoda-ara-exit.
       exit.
*
 yoda-ara.
      initialize oda-cagir.
*      move "D"   to oda-db-cagir.
      call "/asya/ytl/obj/otel/odaara.asy" using oda-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/odaara.asy" 
       end-call.
       move odano-cagir     to o-kisa 
            perform oda-uzat
            move o-uzun to  yeni-oda.
 yoda-oku.
       initialize odalar-rec.
         move yeni-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   yeni-oda-k
       move yeni-oda-k     to odalar-anah
       read odalar         no lock invalid 
            move 1         to gec-gecme
            not invalid continue 
       end-read
       display accept-yenioda.
 yoda-oku-exit.
       exit.
 yoda-ara-exit.
       exit.
*
 mmesaj-ver.
      inspect mmesaj-1 replacing trailing spaces by low-values
      inspect mmesaj-2 replacing trailing spaces by low-values
      inspect mmesaj-3 replacing trailing spaces by low-values
      display message box mmesaj-1, new-line, mmesaj-2, new-line, mmesaj-3
              title   = mmesaj-title
              type    = mmesaj-type
              icon    = mmesaj-icon
              default = mmesaj-default
              returning donus-kodu.
*
 oda-ara2.
     initialize blok-cagir
     move "M" to oda2-db-cagir
    move konuk-oda-konumu   to oda2-konum-cagir.
    move tarih-tasi to    blok-bas-tar
    move konuk-git-tar to    blok-bit-tar
     move konuk-rez-no     to  blok-rez-no
      call "/asya/ytl/obj/otel/odaara2.asy" 
            using oda2-cagir, blok-bas-tar, 
                  blok-bit-tar, blok-rez-no
           on exception perform callerr-proc
       not on exception
      cancel "/asya/ytl/obj/otel/odaara2.asy" 
      end-call.
      
      move odano2-cagir    to o-kisa 
            perform oda-uzat
            move o-uzun to  yeni-oda
      display accept-yenioda
      initialize blok-cagir.
*
 per-odaramco-bulundu.
             display message box "Secmis Oldugunuz Oda Bos...."
                          new-line,
                         title = " [ Bos Oda ] "
                           move 1 to gec-gecme.
*

 blok-kont2.
             move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k
           if gecmez
               exit paragraph
            end-if 
             initialize blok-cagir  dana-sharenum
              move 0 to odaramco-bulundu ileri-sharekont
           if eski-folio = 0 then 
                 move "I"      to konuk-durumu
                 move eski-oda-k to konuk-odano
                 start konuk key not < konuk-oda 
                  invalid     move 0 to odaramco-bulundu
                  not invalid 
                   perform until fs-konuk = "10"
                      read konuk next no lock end 
                             move "10" to fs-konuk
                          not end
                         if konuk-odano not = eski-oda-k
                               move "10" to fs-konuk
                               exit perform cycle
                         end-if
                         if konuk-fol-kodu = "R" 
                            move 1 to odaramco-bulundu
                             move "10" to fs-konuk
                               exit perform cycle
                             
                             
                         end-if
                       end-read
                   end-perform
                end-start
    
                if odaramco-bulundu = 0 then 
                   perform  per-odaramco-bulundu
                  
                   exit paragraph
                end-if
              
               
              else
                move eski-folio to konuk-folio
                read konuk no lock invalid 
                stop " "
                end-read


              end-if
                 move konuk-git-tar   to blok-bit-tar 
                if konuk-sharenum > 0 then
                   move konuk-sharenum to dana-sharenum
                   initialize arez-rec fs-arez
                   open i-o arez
                   move  "I" to arez-durumu
                   move konuk-sharenum to arez-sharenum ileri-sharekont
                   start arez key >=  aREZ-anah-share invalid continue
                      not invalid 
                      perform until fs-arez = "10"
                            read arez next no lock end 
                               move "10" to fs-arez
                               not end
                                 if arez-durumu = "I" and    konuk-sharenum = arez-sharenum
                                           if arez-cik-tar > blok-bit-tar
                                             move arez-cik-tar to blok-bit-tar
                                           end-if
                                   else
                                       move "10" to fs-arez
                                end-if

                            end-read
                      end-perform
                    end-start
                    close arez
                end-if



                    .
               move tarih-tasi    to blok-bas-tar 
             
               move konuk-rez-no         to blok-rez-no 
                 move yeni-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   yeni-oda-k
               move yeni-oda-k      to blok-oda 
               move "R" to blok-yapabilir
               call "/asya/ytl/obj/otel/blokara.asy" using blok-cagir
                    on exception perform callerr-proc
                    not on exception
               cancel "/asya/ytl/obj/otel/blokara.asy" 
               end-call

               
               if rezpara-cifte-blokaj not = "E" and blok-yapabilir = "H" 
                 initialize yeni-oda
                  display accept-yenioda
                  move 1 to gec-gecme
                  move 4 to accept-control
                  move 1002 to control-id
                  exit paragraph

               end-if
        
           .
*
 hat-ac.
     initialize telayarq-dosya-adi telayar-rec telayarq-rec
     if function numval(yeni-oda) < 1000
        move yeni-oda to telayarq-dosya-adi(1:3)
        move ".tay" to telayarq-dosya-adi(4:4)
     else 
       move yeni-oda to telayarq-dosya-adi
       move ".tay" to telayarq-dosya-adi(5:4)

     end-if 

     open output telayarq  
     open i-o telayar
        move yeni-oda to telayarq-odano  telayar-odano 
     if konuk-folio > 0 then 
        move konuk-folio to  telayar-folio   telayarq-folio
     end-if

     move konuk-adi  to telayar-adi telayarq-adi
     move konuk-soyadi  to telayar-soy telayarq-soy
     
     accept telayar-tarih from century-date 
     accept telayar-saat from time 
     move telayar-saat to telayarq-saat 
     move telayar-tarih to telayarq-tarih  

     if  TELPARA-dishat-ac-kapa-ignore = 1 and  telayarq-odano(1:1) = "0"
        move  telayarq-odano(2:) to telayarq-odano(1:)
        move " " to   telayarq-odano(4:1) 
     end-if
      if  TELPARA-dishat-ac-kapa-ignore = 1 and  telayar-odano(1:1) = "0"
        move  telayar-odano(2:) to telayar-odano(1:)
        move " " to   telayar-odano(4:1) 
     end-if
     move "A " to telayar-islem telayarq-islem 
     write telayar-rec invalid continue end-write
     write telayarq-rec  end-write
     close telayarq

     if function numval(yeni-oda) < 1000
        move ".may" to telayarq-dosya-adi(4:4)
     else 
        move ".may" to telayarq-dosya-adi(5:4)
     end-if 
       
     open output telayarq 
     write telayarq-rec  end-write
     close telayar telayarq.
*
 rc-hat-ac.
       if konuk-fol-kodu = "E" then exit paragraph end-if

         initialize telayarq-dosya-adi telayar-rec telayarq-rec
             move yeni-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   yeni-oda-k
          if function numval(yeni-oda-k) < 1000
             move yeni-oda-k to telayarq-dosya-adi(1:3)
             move ".tay"   to telayarq-dosya-adi(4:4)
          else 
             move yeni-oda-k to telayarq-dosya-adi
             move ".tay" to telayarq-dosya-adi(5:4)
          end-if 
          open output telayarq  
          open i-o telayar
          move yeni-oda-k  to telayarq-odano  telayar-odano 
          if konuk-folio > 0 then 
             move konuk-folio to  telayar-folio   telayarq-folio
             add 100000 to telayarq-folio
          end-if
           move konuk-adi  to telayar-adi telayarq-adi
           move konuk-soyadi  to telayar-soy telayarq-soy
          accept telayar-tarih from century-date 
          accept telayar-saat from time 
          move telayar-saat to telayarq-saat 
          move telayar-tarih to telayarq-tarih  
          
           move "A " to telayar-islem telayarq-islem 
              if  TELPARA-dishat-ac-kapa-ignore = 1 and  telayarq-odano(1:1) = "0"
             move  telayarq-odano(2:) to telayarq-odano(1:)
             move " " to   telayarq-odano(4:1) 
          end-if
           if  TELPARA-dishat-ac-kapa-ignore = 1 and  telayar-odano(1:1) = "0"
             move  telayar-odano(2:) to telayar-odano(1:)
             move " " to   telayar-odano(4:1) 
          end-if
           write telayar-rec invalid continue end-write
            write telayarq-rec  end-write
            close telayarq
          if function numval(yeni-oda-k) < 1000     |yeni-oda-k <> konuk-odano
             move ".may" to telayarq-dosya-adi(4:4)
          else 
            move ".may" to telayarq-dosya-adi(5:4)
          end-if                
            open output telayarq 
            write telayarq-rec  end-write
            close telayar telayarq.
*
  xiii-hat-kapat.
      initialize telayarq-dosya-adi telayar-rec telayarq-rec
      if function numval(eski-oda) < 1000
         move eski-oda to telayarq-dosya-adi(1:3)
         move ".tay" to telayarq-dosya-adi(4:4)
      else 
        move eski-oda to telayarq-dosya-adi
        move ".tay" to telayarq-dosya-adi(5:4)

      end-if 


      open output telayarq  
      open i-o telayar
            move eski-oda to telayarq-odano  telayar-odano 
      if konuk-folio > 0 then 
      move konuk-folio to  telayar-folio   telayarq-folio
      end-if
       accept telayar-tarih from century-date 
      accept telayar-saat from time 
       move telayar-saat to telayarq-saat 
      move telayar-tarih to telayarq-tarih  
       move "K " to telayar-islem telayarq-islem 
        
         if  TELPARA-dishat-ac-kapa-ignore = 1 and  telayarq-odano(1:1) = "0"
         move  telayarq-odano(2:) to telayarq-odano(1:)
         move " " to   telayarq-odano(4:1) 
      end-if
       if  TELPARA-dishat-ac-kapa-ignore = 1 and  telayar-odano(1:1) = "0"
         move  telayar-odano(2:) to telayar-odano(1:)
         move " " to   telayar-odano(4:1) 
      end-if
       write telayar-rec invalid continue end-write
        write telayarq-rec  end-write
        close telayarq
      if function numval(konuk-odano) < 1000
         move ".may" to telayarq-dosya-adi(4:4)
      else 
       move ".may" to telayarq-dosya-adi(5:4)

      end-if 
        open output telayarq 
        write telayarq-rec  end-write
        close telayar telayarq .
* 
 hat-kapat.
         if konuk-fol-kodu = "E" then exit paragraph end-if
          initialize telayarq-dosya-adi telayar-rec telayarq-rec
          move eski-oda     to o-uzun
            perform oda-kisalt
            move o-kisa to   eski-oda-k
          if function numval(eski-oda-k) < 1000
             move eski-oda-k to telayarq-dosya-adi(1:3)
             move ".tay"   to telayarq-dosya-adi(4:4)
          else 
             move eski-oda-k to telayarq-dosya-adi
             move ".tay" to telayarq-dosya-adi(5:4)              
          end-if           
     
          open output telayarq  
          open i-o telayar
          move eski-oda-k to telayarq-odano  telayar-odano 
          if konuk-folio > 0 then 
             move konuk-folio to  telayar-folio   telayarq-folio
          end-if
           accept telayar-tarih from century-date 
          accept telayar-saat from time 
           move telayar-saat to telayarq-saat 
          move telayar-tarih to telayarq-tarih  
           move "K " to telayar-islem telayarq-islem 
              if  TELPARA-dishat-ac-kapa-ignore = 1 and  telayarq-odano(1:1) = "0"
             move  telayarq-odano(2:) to telayarq-odano(1:)
             move " " to   telayarq-odano(4:1) 
          end-if
           if  TELPARA-dishat-ac-kapa-ignore = 1 and  telayar-odano(1:1) = "0"
             move  telayar-odano(2:) to telayar-odano(1:)
             move " " to   telayar-odano(4:1) 
          end-if
           write telayar-rec invalid continue end-write
            write telayarq-rec  end-write
            close telayarq
          if function numval(eski-oda-k) < 1000    |eski-oda-k <> konuk-odano
             move ".may" to telayarq-dosya-adi(4:4)
          else 
            move ".may" to telayarq-dosya-adi(5:4)
          end-if 
            open output telayarq 
            write telayarq-rec  end-write
            close telayar telayarq .
*
 aaa.
      if key-status = 2 
          display message box "Lutfen Aciklama Giriniz" 
      end-if
      if control-id = 1002 and key-status = 8 
            perform oda-ara2
      end-if
     .
*
********************************************************
*
 share-koy-kont.
****** kural .
****** kontrol edilecek rez kaydi cagrýlmadan okunmus ve kaydedilmis olmali
******* arez.lib acast.lib takvim2.lib sel tfd de olmali  rez acik olmali
        
       open i-o arez  acast konu2
       open input takvim2
       initialize ana-oda-verildi arez-rec  fs-arez fs-acast
        move "I" to arez-durumu
        move rez-sharenum to arez-sharenum
        move high-values to ilk-share-tar 
        move low-values  to son-share-tar
        initialize sodasay
 

      
       initialize ana-oda-verildi acast-rec  share-odalar
         move high-values to ilk-share-tar 
        move low-values  to son-share-tar
        initialize sodasay
        move rez-sharenum to acast-sharenum
        move tarih-tasi to acast-tarih
          initialize fs-acast
       start acast key >= acast-anah6 
               invalid continue
          not invalid
          perform until fs-acast = "10" 
              read acast next no lock end 
                     move "10" to fs-acast
                 not end
                    if rez-sharenum not = acast-sharenum 
                        move "10" to fs-acast
                        exit perform cycle
                    end-if
                    move acast-rez-no to arez-no 
                    read arez no lock invalid 
                          display message  box "Hata Bakim icin arayiniz Castttt "
                     end-read
                            if arez-durumu  = "S" then
                              exit perform cycle
                            end-if

                             if acast-tarih > son-share-tar
                                move  acast-tarih to son-share-tar
                             end-if
                              if acast-tarih < ilk-share-tar
                                move  acast-tarih to ilk-share-tar
                             end-if

                                perform varying ish from 1 by 1 until ish > sodasay or ish > 20 
                                    if share-oda(ish) = acast-oda-no
                                      exit perform 
                                    end-if
                                end-perform
                                 if ish > sodasay then 
                                     if ish >= 20 then
                                          display message box "20 den fazla oda bagladiniz"
                                          exit perform 
                                       else
                                             move acast-oda-no to share-oda(ish)
                                             move ish to  sodasay
                                     end-if
                                 end-if
              end-read
          end-perform 
       end-start
       initialize fs-takvim2 takvim2-rec
       move ilk-share-tar to takvim2-anah 
       start takvim2 key >= takvim2-anah invalid continue
         not invalid 
         perform until fs-takvim2 = "10"
             read takvim2 next no lock end move "10" to fs-takvim2 
               not end
               if takvim2-anah > son-share-tar 
                   move "10" to fs-takvim2 
                   exit perform cycle
                end-if
             end-read
                perform varying ish  from 1 by 1 until ish > sodasay or ish > 20 
                  initialize ana-oda-verildi acast-rec   fs-acast
                  move takvim2-anah to acast-tarih
                  move rez-sharenum to acast-sharenum
                  move share-oda(ish) to acast-oda-no
                  move high-values to acast-fiyati  acast-buyuk

                  start acast key < acast-anah6 invalid 
                          continue
                     not invalid
                       perform until fs-acast = "10" 
                           read acast previous no lock  
                               end
                                move "10" to fs-acast
                                if ana-oda-verildi not = 1 
                                              move 1 to  ana-oda-verildi
                                               if  acast-share not = 0
                                                    move 0 to acast-share
                                                  rewrite acast-rec invalid stop " " end-rewrite

                                                  else
                                                  display message box "Hataaaaa"
                                               end-if
                                  end-if
                                not end
                                if   takvim2-anah not = acast-tarih  or
                                     rez-sharenum not = acast-sharenum  or
                                     share-oda(ish) not = acast-oda-no
                                       move "10" to fs-acast
                                        if ana-oda-verildi not = 1 
                                          read   acast next no lock 
                                          end   display message box "Hataaaaa"
                                          exit perform cycle
                                          end-read
                                              if   takvim2-anah not = acast-tarih  or
                                                     rez-sharenum not = acast-sharenum  or
                                                     share-oda(ish) not = acast-oda-no
                                                  display message box "Hataaaaa25666"
                                                   exit perform cycle
                                             end-if
                                              move 1 to  ana-oda-verildi
                                               if  acast-share not = 0
                                                    move 0 to acast-share
                                                  rewrite acast-rec invalid stop " " end-rewrite
                                                  else
                                                  display message box "Hataaaaa"
                                               end-if
                                         end-if
                                       exit perform cycle
                                end-if
                                move acast-rez-no to arez-no
                                move acast-rez-no to arez-no 
                                    read arez no lock invalid 
                                      display message  box "Hata Bakim icin arayiniz Castttt "
                                          end-read
                                            if arez-durumu  = "S" then
                                                  display message box "Silinmis Share gorunuyor"
                                                  exit perform cycle
                                                  
                                            end-if
                                   if arez-cik-tar <= acast-tarih
                                       if  acast-share not = 1
                                            move 1 to acast-share
                                            rewrite acast-rec invalid stop " " end-rewrite
                                       end-if
                                    else
                                        if ana-oda-verildi not = 1 
                                              move 1 to  ana-oda-verildi
                                               if  acast-share not = 0
                                                    move 0 to acast-share
                                                  rewrite acast-rec invalid stop " " end-rewrite
                                              end-if
                                        else
                                                 if  acast-share not = 1
                                                       move 1 to acast-share
                                                      rewrite acast-rec invalid stop " " end-rewrite
                                                 end-if
                                  end-if
                             end-if

                           end-read
                       end-perform
                  end-start
                end-perform 
        end-perform
      end-start
      initialize arez-rec fs-arez

        move "I" to arez-durumu
        move rez-sharenum to arez-sharenum
       start arez key >= aREZ-anah-share invalid continue
          not invalid
          perform until fs-arez = "10" 
              read arez next no lock end 
                       
                     move "10" to fs-arez
                 not end
                    if rez-sharenum not = arez-sharenum  
                     
                            move "10" to fs-arez
                        exit perform cycle
                    end-if
                    if  arez-durumu not = "I"
                       exit perform cycle
                    end-if
                    if arez-cik-tar < tarih-tasi 
                         exit perform cycle
                    end-if
                    if arez-gir-tar <= tarih-tasi
                       move   tarih-tasi to acast-tarih
                       move   arez-no   to  acast-rez-no
                       read acast no lock invalid 
                                   display message  box "Hata Bakim icin arayiniz Cast444tt "
                             not invalid 
                             if acast-share not = arez-share 
                                     move acast-share to arez-share
                                     rewrite arez-rec invalid stop " " end-rewrite
                                      if arez-folio > 0 then 
                                       move arez-folio to konu2-folio
                                       read konu2 no lock invalid continue
                                       not invalid
                                          move acast-share to konu2-share
                                          rewrite konu2-rec invalid continue end-rewrite
                                       end-read

                                     end-if
                             end-if
                       end-read
                        else
                        move   arez-gir-tar  to acast-tarih
                         move   arez-no        to  acast-rez-no
                       read acast no lock invalid 
                                   display message  box "Hata Bakim icin arayiniz Cast444tt "
                             not invalid 
                             if acast-share not = arez-share 
                                     move acast-share to arez-share
                                     rewrite arez-rec invalid stop " " end-rewrite
                             end-if
                       end-read


                   end-if
              end-read
          end-perform 
       end-start
      

     close arez acast takvim2 konu2. 

*********************************
**
********************************************************

********************************************************
*
 share-sil-kont.
****** kural eski-sharenum dolu olamli .
****** kontrol edilecek rez kaydi cagrýlmadan okunmus ve kaydedilmis olmali rez-sharenum tabiiki bos
******* arez.lib acast.lib takvim2.lib sel tfd de olmali  rez acik olmali
   
****** kontrol edilecek rez kaydi cagrýlmadan okunmus ve kaydedilmis olmali
******* arez.lib acast.lib takvim2.lib sel tfd de olmali  rez acik olmali
        if eski-sharenum  = 0 then exit paragraph end-if
       open i-o arez  acast konu2
       open input takvim2
       initialize ana-oda-verildi arez-rec
        move "I" to arez-durumu
        move eski-sharenum to arez-sharenum
        move high-values to ilk-share-tar 
        move low-values  to son-share-tar
        initialize sodasay
 

      
       initialize ana-oda-verildi acast-rec  share-odalar
         move high-values to ilk-share-tar 
        move low-values  to son-share-tar
        initialize sodasay   acast-rec fs-acast
        move eski-sharenum to acast-sharenum
        move tarih-tasi to acast-tarih

       start acast key >= acast-anah6 
               invalid continue
          not invalid
          perform until fs-acast = "10" 
              read acast next no lock end 
                     move "10" to fs-acast
                 not end
                    if eski-sharenum not = acast-sharenum 
                        move "10" to fs-acast
                        exit perform cycle
                    end-if
                    move acast-rez-no to arez-no 
                    read arez no lock invalid 
                          display message  box "Hata Bakim icin arayiniz Castttt "
                     end-read
                            if arez-durumu  = "S" then
                              exit perform cycle
                            end-if

                             if acast-tarih > son-share-tar
                                move  acast-tarih to son-share-tar
                             end-if
                              if acast-tarih < ilk-share-tar
                                move  acast-tarih to ilk-share-tar
                             end-if

                                perform varying ish from 1 by 1 until ish > sodasay or ish > 20 
                                    if share-oda(ish) = acast-oda-no
                                      exit perform 
                                    end-if
                                end-perform
                                 if ish > sodasay then 
                                     if ish >= 20 then
                                          display message box "20 den fazla oda bagladiniz"
                                       else
                                             move acast-oda-no to share-oda(ish)
                                             move ish to  sodasay
                                     end-if
                                 end-if
              end-read
          end-perform 
       end-start
       initialize takvim2-rec fs-takvim2
       move ilk-share-tar to takvim2-anah 
       start takvim2 key >= takvim2-anah invalid continue
         not invalid 
         perform until fs-takvim2 = "10"
             read takvim2 next no lock end move "10" to fs-takvim2 
               not end
               if takvim2-anah > son-share-tar 
                   move "10" to fs-takvim2 
                   exit perform cycle
                end-if
             end-read
                perform varying ish  from 1 by 1 until ish > sodasay or ish > 20 
                  initialize ana-oda-verildi acast-rec   fs-acast
                  move takvim2-anah to acast-tarih
                  move eski-sharenum to acast-sharenum
                  move share-oda(ish) to acast-oda-no
                  move high-values to acast-fiyati  acast-buyuk

                  start acast key < acast-anah6 invalid 
                          continue
                     not invalid
                       perform until fs-acast = "10" 
                           read acast previous no lock  
                               end
                                move "10" to fs-acast
                                if ana-oda-verildi not = 1 
                                              move 1 to  ana-oda-verildi
                                               if  acast-share not = 0
                                                    move 0 to acast-share
                                                  rewrite acast-rec invalid stop " " end-rewrite
                                                  else
                                                  display message box "Hataaaaa"
                                               end-if
                                  end-if
                                not end
                                if   takvim2-anah not = acast-tarih  or
                                     eski-sharenum not = acast-sharenum  or
                                     share-oda(ish) not = acast-oda-no
                                       move "10" to fs-acast
                                        if ana-oda-verildi not = 1 
                                          read   acast next no lock 
                                          end   display message box "Hataaaaa"
                                          exit perform cycle
                                          end-read
                                              if   takvim2-anah not = acast-tarih  or
                                                     eski-sharenum not = acast-sharenum  or
                                                     share-oda(ish) not = acast-oda-no
                                                  display message box "Hataaaaa25666"
                                                   exit perform cycle
                                             end-if
                                              move 1 to  ana-oda-verildi
                                               if  acast-share not = 0
                                                    move 0 to acast-share
                                                  rewrite acast-rec invalid stop " " end-rewrite
                                                  else
                                                  display message box "Hataaaaa"
                                               end-if
                                         end-if
                                       exit perform cycle
                                end-if
                                move acast-rez-no to arez-no
                                move acast-rez-no to arez-no 
                                    read arez no lock invalid 
                                      display message  box "Hata Bakim icin arayiniz Castttt "
                                          end-read
                                            if arez-durumu  = "S" then
                                                  display message box "Silinmis Share gorunuyor"
                                                  exit perform cycle
                                                  
                                            end-if
                                   if arez-cik-tar <= acast-tarih
                                       if  acast-share not = 1
                                            move 1 to acast-share
                                            rewrite acast-rec invalid stop " " end-rewrite
                                       end-if
                                    else
                                        if ana-oda-verildi not = 1 
                                              move 1 to  ana-oda-verildi
                                               if  acast-share not = 0
                                                    move 0 to acast-share
                                                  rewrite acast-rec invalid stop " " end-rewrite
                                              end-if
                                        else
                                                 if  acast-share not = 1
                                                       move 1 to acast-share
                                                      rewrite acast-rec invalid stop " " end-rewrite
                                                 end-if
                                  end-if
                             end-if

                           end-read
                       end-perform
                  end-start
                end-perform 
        end-perform
      end-start
      initialize arez-rec fs-arez
       move "I" to arez-durumu
        move eski-sharenum to arez-sharenum
         
       start arez key >= aREZ-anah-share invalid continue
          not invalid
          perform until fs-arez = "10" 
              read arez next no lock end 
                       
                     move "10" to fs-arez
                 not end
                    if eski-sharenum not = arez-sharenum or 
                       arez-durumu not = "I"
                            move "10" to fs-arez
                        exit perform cycle
                    end-if
                    if arez-cik-tar < tarih-tasi 
                         exit perform cycle
                    end-if
                    if arez-gir-tar <= tarih-tasi
                       move   tarih-tasi to acast-tarih
                       move   arez-no   to  acast-rez-no
                       read acast no lock invalid 
                                   display message  box "Hata Bakim icin arayiniz Cast444tt "
                             not invalid 
                             if acast-share not = arez-share 
                                     move acast-share to arez-share
                                     rewrite arez-rec invalid stop " " end-rewrite
                                     if arez-folio > 0 then 
                                       move arez-folio to konu2-folio
                                       read konu2 no lock invalid continue
                                       not invalid
                                          move acast-share to konu2-share
                                          rewrite konu2-rec invalid continue end-rewrite
                                       end-read

                                     end-if
                             end-if
                       end-read
                        else
                        move   arez-gir-tar  to acast-tarih
                         move   arez-no        to  acast-rez-no
                       read acast no lock invalid 
                                   display message  box "Hata Bakim icin arayiniz Cast444tt "
                             not invalid 
                             if acast-share not = arez-share 
                                     move acast-share to arez-share
                                     rewrite arez-rec invalid stop " " end-rewrite
                                     
                             end-if
                       end-read


                   end-if
              end-read
          end-perform 
       end-start
   

     close arez acast takvim2 konu2. 
*
 blokaj-degisim-yaz.
       open i-o blokd
       initialize blokd-rec 
       move tarih-tasi           to blokd-tarih
       accept blokd-zaman from time
       move rez-no          to blokd-rez-no
       read blokd no lock invalid 
           continue 
       end-read 
       move k-kodu-tasi          to blokd-k-kodu
       move konuk-odano          to blokd-odano
       write blokd-rec invalid 
           rewrite blokd-rec end-rewrite 
       end-write 
       close blokd.
*
 extpost-deg.
      
      if ONKPARA-MAIL-DEP not > 0 then exit paragraph end-if
      open i-o extpost postkod
      move konuk-folio to   EXTPOST-FOLIO     
      move ONKPARA-MAIL-DEP OF GENEL  to EXTPOST-DEP
      read extpost no lock invalid continue
          not invalid 
             move extpost-dep      to postkod-kodu
                move extpost-postkodu to postkod-no  
                read postkod no lock invalid continue
                not invalid
                move " "   to postkod-dolu-bos
                rewrite postkod-rec invalid continue
                end-rewrite
                 end-read
                move extpost-dep      to postkod-kodu
                move konuk-odano to postkod-no  
                read postkod no lock invalid continue
                not invalid
                move "E"   to postkod-dolu-bos
                rewrite postkod-rec invalid continue
                end-rewrite
                 end-read
                move konuk-odano to extpost-postkodu

                rewrite  extpost-rec invalid stop " "  end-rewrite
       end-read
      close postkod extpost .
*
 odatemiz-isle.
     open i-o odatemiz                         |Klima Filtre Bakim Sistemi 29/07/2020 Fýrat 
     initialize odatemiz-rec 
     move "K"              to odatemiz-tip
     move eski-oda         to odatemiz-oda
     accept odatemiz-tarih from century-date
     accept odatemiz-zaman from time
     read odatemiz no lock invalid
          move k-kodu-tasi      to odatemiz-ilk-staff
          write odatemiz-rec end-write 
     end-read 
     close odatemiz
     .


 
