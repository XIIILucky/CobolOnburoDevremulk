* yapisl.evt
* yapisl.evt is generated from D:\asya\acugt.ytl\otel\yapisl.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Exception-Proc.
     PERFORM Exception-Procedure
     .
***   start event editor code   ***
*
 Form1-Aft-Create.
      perform adresleri-tasi
     .
*
 Form1-Aft-Initdata.
       move tarih-tasi to ilk-tarih son-tarih
       display accept-gir-gun accept-gir-ay accept-gir-yil accept-cik-gun accept-cik-ay accept-cik-yil
       modify Form1-Cm-1 , item-to-add("XXXX-Tum Kullaniciler")
        open input kllnc
             initialize kllnc-rec i
             start kllnc key not < k-kodu invalid
                   continue
             not invalid
             initialize fs-kllnc
             perform with test after until fs-kllnc = "10"
                   read kllnc next no lock end move "10" to fs-kllnc
                   not at end
 
                           initialize combo-1-value
                           move k-kodu   to combo-1-kodu
                           move k-adi    to combo-1-adi
                           move k-soyadi to combo-1-soyadi   

                           move "-" to combo-filler1 
                           modify Form1-Cm-1 , item-to-add(combo-1-value)
                   end-read
             end-perform
             end-start
        close kllnc
        display Form1-Cm-1

        modify Form1-Cm-2 , item-to-add("00-Tum Raporlar")
        modify Form1-Cm-2 , item-to-add("01-Silinen Cekler Raporu")
        modify Form1-Cm-2 , item-to-add("02-Silinen Doviz Cek. Raporu")
        modify Form1-Cm-2 , item-to-add("03-Correction Raporu")
        modify Form1-Cm-2 , item-to-add("04-ReOpen Foliolar Raporu")
        modify Form1-Cm-2 , item-to-add("05-Silinen C/In Ler Raporu")
        modify Form1-Cm-2 , item-to-add("06-Silinen Rez. Raporu")

        modify Form1-Cm-2 , item-to-add("07-Oda Uzatma Raporu")
        modify Form1-Cm-2 , item-to-add("08-Oda Degisim Raporu")
        modify Form1-Cm-2 , item-to-add("09-Manuel Islenen Oda Gelirleri Raporu")

        display Form1-Cm-2
     .
* 
 isleme-basla.
          perform dokumer-hazirla
          evaluate cmb-turu(1:2)
          when "00"
                perform silinen-cekler-raporu
                perform silinen-doviz-raporu
                perform correction-raporu
                perform reopen-foliolar-raporu
                perform silinen-cin-raporu
                perform silinen-rez-raporu
                perform oda-uzatma-raporu
                perform oda-degisim-raporu
                perform manuel-islenen-oda-gelirleri
          when "01" 
                perform silinen-cekler-raporu
          WHEN "02"
                perform silinen-doviz-raporu
          when "03" 
                perform correction-raporu
          when "04" 
                perform reopen-foliolar-raporu
          when "05"
                perform silinen-cin-raporu
          when "06" 
                perform silinen-rez-raporu
          when "07"
                perform oda-uzatma-raporu
          when "08"
                perform oda-degisim-raporu
          when "09"
                perform manuel-islenen-oda-gelirleri
          end-evaluate
          perform dokumer-kapa.
*
 Exception-Procedure.
      evaluate key-status
          when 2
             perform isleme-basla
      end-evaluate.
*
 dokumer-hazirla.
 
              open i-o genelfis
              move 1 to genelfis-anahtar
              read genelfis no lock invalid
                   accept print-no from time
              not invalid
                   add 1 to print-no
                   rewrite genelfis-rec end-rewrite
              end-read
              close genelfis
              initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                         dokumer-dosya

              set  dokumer-asya-set to true
              move print-no         to dokumer-dosya-adi
              open output dokumer
*/WINDOW TITLE
              initialize dokumer-rec detay
              move "W"                    to det-dokumer-20(1:)
              move "Yapilan Islemler Raporu" to det-filler
              write dokumer-rec from detay
*/ BASLIKLAR
              initialize dokumer-rec detay
              move "B"                  to det-dokumer-20(1:)
              move "Yapilan Islemler Raporu" to det-filler
              write dokumer-rec from detay
              initialize dokumer-rec detay
              move "B"                  to det-dokumer-20(1:)
              write dokumer-rec from detay

*/ DOKUMER OZELLIKLER-REC
              initialize dokumer-rec detay
              move "O"                        to det-dokumer-20(1:)
              move "E" to dokumer-oto-sayfa-basi
              move 56  to dokumer-oto-sayfa-satir
              move "|" to dokumer-detay-kolon-ayirici
              move "RLLLLLLLLLLLLLLLLLLLLLLL" to dokumer-align-occ
              move dokumer-ozellikler-rec     to det-filler
              write dokumer-rec from detay
*/ BASLIKLAR 
              initialize dokumer-rec detay
              move "D1"               to det-dokumer-20(1:)  
              move "       "    to det-0
              move "Baslik1"    to det-1
              move "Baslik2"    to det-2
              move "Baslik3"    to det-3
              move "Baslik4"    to det-4
              move "Baslik5"    to det-5
              move "Baslik6"    to det-6
              move "Baslik7"    to det-7
              move "Baslik8"    to det-8
              move "Baslik9"    to det-9
              move "Baslik10"   to det-10
              move "Baslik11"   to det-11
              move "Baslik12"   to det-12
              move "Baslik13"   to det-13
              move "Baslik14"   to det-14 
              move "Baslik15"   to det-16
              move "Folio"      to det-15
              move all "|" to fil-0 fil-1 fil-2 fil-3 fil-4 fil-5 fil-6 fil-7 
                              fil-8 fil-9 fil-10 fil-11 fil-12 fil-13 fil-14 fil-15
                              fil-16
              write dokumer-rec from detay
              initialize dokumer-rec detay
              move "D2"               to det-dokumer-20(1:)     
              move "-"                to det-dokumer-20(5:1)
              move all "-" to det-0 det-1 det-2 det-3 det-4 det-5 det-6 det-7 
                              det-9 det-10 det-11 det-12 det-13 det-14 det-15
                              det-16
              write dokumer-rec from detay.

*
 dokumer-kapa.
     close dokumer
     call dokumer-prog on exception
          perform callerr-proc
     not on exception
          cancel dokumer-prog
     end-call
     delete file dokumer.

*
 silinen-cekler-raporu.
         
          initialize dokumer-rec detay
          move "[ Silinen Cekler Raporu ]"  to det-0
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 481          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 

          initialize dokumer-rec detay
          move "Tarih   "  to det-1
          move "Zaman   "  to det-2
          move "Oda     "  to det-3
          move "Folio No"  to det-4
          move "Adi     "  to det-5
          move "Soyadi  "  to det-6
          move "Islem no"  to det-7
          move "Departman" to det-8
          move "Tl Tutar " to det-9
          move "Dv Tutar " to det-10 
          move "Kullanici" to det-11
          move "Silinme Nedeni" to det-16


          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 144          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 
  
          open input silhrk konuk depkod kllnc skonuk nt
                initialize kayit-sayisi silhrk-rec toplam-dv toplam-tl
                move ilk-tarih to SILHRK-tarih
                start silhrk key not < SILHRK-ANAH2 invalid
                        continue
                not invalid
                perform until fs-silhrk = "10"
                read silhrk next no lock end move "10" to fs-silhrk
                not end
                      if SILHRK-tarih > son-tarih
                            exit perform
                      end-if
                      if silhrk-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if

                      if SILHRK-ISLEM-TIPI = "R" 
                            exit perform cycle
                      end-if
 

                       initialize detay
                       move silhrk-gun  to x-gun
                       move silhrk-ay   to x-ay
                       move silhrk-yil  to x-yil
                       move x-tarih     to det-1

                       move silhrk-saat   to x-saat
                       move silhrk-dakika to x-dakika
                       move x-zaman       to det-2

                       move silhrk-folio  to det-4

                       initialize konuk-rec
                       move silhrk-folio to konuk-folio
                       read konuk no lock invalid        
                               initialize konuk-folio
                                move silhrk-folio to skonuk-folio
                                read skonuk no lock invalid
                                        initialize skonuk-folio
                                end-read
                               move "***"         to det-5 det-6
                               move skonuk-odano  to det-3
                               move silhrk-folio  to det-4
                               move skonuk-adi    to det-5(4:)
                               move skonuk-soyadi to det-6(4:)
                       not invalid
                               move konuk-odano  to det-3
                               move silhrk-folio to det-4
                               move konuk-adi    to det-5
                               move konuk-soyadi to det-6
                       end-read

                       initialize depkod-rec
                       move silhrk-islem  to det-7
                       move silhrk-depkod to depkod-kodu
                       read depkod no lock invalid
                               initialize depkod-rec
                       end-read

                       move depkod-kodu to det-8(1:3)  
                       move "-"         to det-8(4:1)  
                       move depkod-adi  to det-8(5:)   

                       move SILHRK-TL-TUTAR  to z-tutar
                       move z-tutar          to det-9

                       add SILHRK-TL-TUTAR to toplam-tl

                       move SILHRK-DV-TUTAR  to z-tutar
                       move z-tutar          to det-10

                       add SILHRK-DV-TUTAR to toplam-dv

                       initialize kllnc-rec
                       move sILHRK-STAF to k-kodu
                       read kllnc no lock invalid    
                              MOVE  "Tanimsiz..." to k-adi  
                       end-read
                       move all low-values to deger-100
                       inspect k-adi    replacing trailing spaces by low-values
                       inspect k-soyadi replacing trailing spaces by low-values

                       string deger-100, 
                       k-adi    delimited by low-values
                       " "      delimited by low-values
                       k-soyadi delimited by low-values
                       into deger-100

                       inspect deger-100 replacing trailing  low-values by spaces 

                       move k-kodu    to det-11
                       move "-"       to det-11(5:1)
                       move deger-100 to det-11(6:)
                       move silhrk-folio to det-15

                       initialize not-rec
                       move  "SHR"        to NOT-DOS
                       move silhrk-anah   to NOT-DOS-ANAH                           
                       read nt no lock invalid 
                            initialize not1
                       end-read
                       move not1          to det-16 

                       write dokumer-rec from detay
                       add 1 to kayit-sayisi
                end-read
                end-perform
                end-start
          close silhrk konuk depkod kllnc skonuk nt
             
          initialize  detay
          move "Toplam"     to det-0
          move kayit-sayisi to z-4   move  z-4  to det-1
          move toplam-tl to z-tutar move z-tutar to det-9
          move toplam-dv to z-tutar move z-tutar to det-10
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 303          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay.
*
 reopen-foliolar-raporu.
         
          initialize dokumer-rec detay
          move "[ ReOpen Foliolar Raporu ]"  to det-0
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 481          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 

          initialize dokumer-rec detay
          move "Tarih   "  to det-1
          move "Zaman   "  to det-2
          move "Oda     "  to det-3
          move "Folio No"  to det-4
          move "Adi     "  to det-5
          move "Soyadi  "  to det-6
          move "Kullanici"  to det-7

          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 144          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 
 
          open input silhrk konuk depkod kllnc
                initialize kayit-sayisi silhrk-rec
                move ilk-tarih to SILHRK-tarih
                start silhrk key not < SILHRK-ANAH2 invalid
                        continue
                not invalid
                perform until fs-silhrk = "10"
                read silhrk next no lock end move "10" to fs-silhrk
                not end
                      if SILHRK-tarih > son-tarih
                            exit perform
                      end-if
                      if silhrk-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if

                      if SILHRK-ISLEM-TIPI <> "R" 
                            exit perform cycle
                      end-if
 

                       initialize detay
                       move silhrk-gun  to x-gun
                       move silhrk-ay   to x-ay
                       move silhrk-yil  to x-yil
                       move x-tarih     to det-1

                       move silhrk-saat   to x-saat
                       move silhrk-dakika to x-dakika
                       move x-zaman       to det-2

                       move silhrk-folio  to det-4

                       initialize konuk-rec
                       move silhrk-folio to konuk-folio
                       read konuk no lock invalid        
                               initialize konuk-folio
                       not invalid
                               move konuk-odano  to det-3
                               move silhrk-folio to det-4
                               move konuk-adi    to det-5
                               move konuk-soyadi to det-6
                       end-read

                      
                       initialize kllnc-rec
                       move sILHRK-STAF to k-kodu
                       read kllnc no lock invalid    
                              MOVE  "Tanimsiz..." to k-adi  
                       end-read
                       move all low-values to deger-100
                       inspect k-adi    replacing trailing spaces by low-values
                       inspect k-soyadi replacing trailing spaces by low-values

                       string deger-100, 
                       k-adi    delimited by low-values
                       " "      delimited by low-values
                       k-soyadi delimited by low-values
                       into deger-100

                       inspect deger-100 replacing trailing  low-values by spaces 

                       move k-kodu    to det-7
                       move "-"       to det-7(5:1)
                       move deger-100 to det-7(6:)
                       move silhrk-folio to det-15
                       write dokumer-rec from detay
                       add 1 to kayit-sayisi
                end-read
                end-perform
                end-start
          close silhrk konuk depkod kllnc
             
          initialize  detay
          move "Toplam"     to det-0
          move kayit-sayisi to z-4   move  z-4  to det-1
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 303          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay.

*
 silinen-cin-raporu.
          initialize dokumer-rec detay
          move "[ Silinen C/In Ler Raporu ]"  to det-0
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 481          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 

          initialize dokumer-rec detay
          move "Tarih   "    to det-1
          move "Zaman   "    to det-2
          move "Oda     "    to det-3
          move "Folio No"    to det-4
          move "Acenta"      to det-5
          move "C/in Saat"   to det-6
          move "C/in Tarih"  to det-7
          move "C/out Tarih" to det-8
          move "Pax"         to det-9
          move "Adi     "    to det-10
          move "Soyadi  "    to det-11
          move "TL Fiyat "   to det-12
          move "DV Fiyat "   to det-13
          move "Kullanici"   to det-14

          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 144          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 
 
          open input skonuk konuk depkod kllnc acenta
                initialize kayit-sayisi skonuk-rec toplam-dv toplam-tl
                start skonuk key not < skonuk-anah invalid
                        continue
                not invalid
                perform until fs-skonuk = "10"
                read skonuk next no lock end move "10" to fs-skonuk
                not end

          
                      if not (skonuk-gercek-tar >= ilk-tarih and skonuk-gercek-tar <= son-tarih)
                            exit perform cycle
                      end-if

                      if skonuk-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if


                       initialize detay
                       move skonuk-gercek-gun     to x-gun
                       move skonuk-gercek-ay      to x-ay
                       move skonuk-gercek-yil     to x-yil
                       move x-tarih               to det-1

                       move skonuk-gercek-SAAT    to x-saat
                       move skonuk-gercek-dakika  to x-dakika
                       move x-zaman               to det-2

                       move skonuk-folio          to det-4

                       move skonuk-odano  to det-3
                       move skonuk-FOL-KODU to det-10
                       move "-"             to det-10(2:1)
                       move skonuk-adi    to det-10(3:) 
                       move skonuk-soyadi to det-11
        
                       initialize acenta-rec
                       move skonuk-acenta to acenta-kodu
                       read acenta no lock invalid
                               continue
                       end-read

                       move acenta-kodu to det-5
                       move "-"         to det-5(5:1)
                       move acenta-adi  to det-5(6:)

                       MOVE skonuk-GEL-SAAT   to x-saat
                       move skonuk-GEL-dakika to x-dakika
                       move x-zaman     to det-6

                       move skonuk-GEL-YIL  to x-yil
                       move skonuk-GEL-ay   to x-ay
                       move skonuk-GEL-gun  to x-gun
                       move x-tarih         to det-7


                       move skonuk-Git-YIL  to x-yil
                       move skonuk-Git-ay   to x-ay
                       move skonuk-Git-gun  to x-gun
                       move x-tarih         to det-8

                       move skonuk-BUYUK to pax-buyuk
                       move skonuk-kucuk to pax-kucuk
                       move skonuk-bebek to pax-bebek
                       move skonuk-free  to pax-free
                       move pax-bilgisi  to det-9
 
                       move skonuk-DV-DEGERI  to z-tutar move z-tutar to det-13

                       compute HESAP rounded = skonuk-DV-DEGERI * skonuk-KUR-DEGERI 
                       move hesap  to z-tutar move z-tutar to det-12

                       add hesap            to toplam-tl
                       add skonuk-DV-DEGERI to toplam-dv
                       initialize kllnc-rec
                       move skonuk-staf to k-kodu
                       read kllnc no lock invalid    
                              MOVE  "Tanimsiz..." to k-adi  
                       end-read
                       move all low-values to deger-100
                       inspect k-adi    replacing trailing spaces by low-values
                       inspect k-soyadi replacing trailing spaces by low-values

                       string deger-100, 
                       k-adi    delimited by low-values
                       " "      delimited by low-values
                       k-soyadi delimited by low-values
                       into deger-100

                       inspect deger-100 replacing trailing  low-values by spaces 

                       move k-kodu    to det-14
                       move "-"       to det-14(5:1)
                       move deger-100 to det-14(6:)
                       move skonuk-folio to det-15
                       write dokumer-rec from detay
                       add 1 to kayit-sayisi
                end-read
                end-perform
                end-start
          close skonuk konuk depkod kllnc acenta
             
          initialize  detay
          move "Toplam"     to det-0
          move kayit-sayisi to z-4   move  z-4  to det-1
          move toplam-dv to z-tutar move z-tutar to det-13
          move toplam-tl to z-tutar move z-tutar to det-12

          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 303          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay.

*
 silinen-rez-raporu.
          initialize dokumer-rec detay
          move "[ Silinen Rez. Raporu ]"  to det-0
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 481          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 

          initialize dokumer-rec detay
          move "Tarih   "    to det-1
          move "Rez No"      to det-2
          move "Acenta"      to det-3
          move "Gir. Tarih"  to det-4
          move "Cik. Tarih"  to det-5
          move "Voucher   "  to det-6
          move "Pax"         to det-7
          move "Adi     "    to det-8
          move "Soyadi  "    to det-9
          move "Fiyati "      to det-10
          move "Doviz "     to det-11
          move "Kullanici"   to det-12

          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 144          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 
 
          open input skonuk konuk depkod kllnc acenta   rez  doviz
                initialize kayit-sayisi rez-rec toplam-tl
                move ilk-tarih to rez-isl-tar
                move "S"       to rez-durumu
                start rez key not < rez-isl invalid
                        continue
                not invalid
                perform until fs-rez = "10"
                read rez next no lock end move "10" to fs-rez
                not end

          
                      if rez-isl-tar > son-tarih 
                            exit perform 
                      end-if

                      if rez-durumu <> "S" 
                            exit perform
                      end-if

                      if rez-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if

                       initialize detay
                       move rez-isl-gun      to x-gun
                       move rez-isl-ay       to x-ay
                       move rez-isl-yil      to x-yil
                       move x-tarih          to det-1
                       move REZ-NO           to det-2



                       move rez-adi         to det-8
                       move rez-soyadi      to det-9
        
                       initialize acenta-rec
                       move rez-acenta to acenta-kodu
                       read acenta no lock invalid
                               continue
                       end-read

                       move acenta-kodu to det-3
                       move "-"         to det-3(5:1)
                       move acenta-adi  to det-3(6:)

                       move rez-gir-yil     to x-yil
                       move rez-gir-ay      to x-ay
                       move rez-gir-gun     to x-gun
                       move x-tarih         to det-4

                       move rez-cik-yil     to x-yil
                       move rez-cik-ay      to x-ay
                       move rez-cik-gun     to x-gun
                       move x-tarih         to det-5
          
                       move rez-voucher     to det-6
      

                       move rez-BUYUK    to pax-buyuk
                       move rez-kucuk    to pax-kucuk
                       move rez-bebek    to pax-bebek
                       move rez-free     to pax-free
                       move pax-bilgisi  to det-7
 
                       move rez-fiyati   to z-tutar move z-tutar to det-10

                       add rez-fiyati to toplam-tl
                       initialize doviz-rec
                       move rez-doviz to DOVIZ-KODU
                       read doviz no lock invalid
                               continue
                       end-read
                       move d-kisa-adi  to det-11

                       initialize kllnc-rec
                       move rez-staf to k-kodu
                       read kllnc no lock invalid    
                              MOVE  "Tanimsiz..." to k-adi  
                       end-read
                       move all low-values to deger-100
                       inspect k-adi    replacing trailing spaces by low-values
                       inspect k-soyadi replacing trailing spaces by low-values

                       string deger-100, 
                       k-adi    delimited by low-values
                       " "      delimited by low-values
                       k-soyadi delimited by low-values
                       into deger-100

                       inspect deger-100 replacing trailing  low-values by spaces 

                       move k-kodu    to det-12
                       move "-"       to det-12(5:1)
                       move deger-100 to det-12(6:)
                       if rez-folio > 0
                          move rez-folio to det-15
                       end-if 
                       write dokumer-rec from detay
                       add 1 to kayit-sayisi
                end-read
                end-perform
                end-start
          close skonuk konuk depkod kllnc acenta  rez  doviz
             
          initialize  detay
          move "Toplam"     to det-0
          move kayit-sayisi to z-4   move  z-4  to det-1

          move toplam-tl to z-tutar move z-tutar to det-10

          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 303          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay.


* 
 silinen-doviz-raporu.
          initialize dokumer-rec detay
          move "[ Silinen Doviz Cek. Raporu ]"  to det-0
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 481          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 

          initialize dokumer-rec detay
          move "Tarih   "       to det-1
          move "Zaman"          to det-2
          move "Fis No"         to det-3
          move "Banka"          to det-4
          move "Doviz"          to det-5
          move "Kur Degeri   "  to det-6
          move "Doviz Degeri"   to det-7
          move "Tl Degeri   "   to det-8
          move "Kullanici"      to det-9

          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 144          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
              
 
          open input skonuk konuk depkod kllnc acenta   rez  doviz  banka dov-boz
                initialize kayit-sayisi dov-boz-rec  toplam-tl toplam-dv
                move ilk-tarih to dov-boz-tarih
                start dov-boz key not < dov-boz-anah invalid
                        continue
                not invalid
                perform until fs-dov-boz =  "10"
                read dov-boz next no lock end move "10" to fs-dov-boz
                not end

   
                      if dov-boz-tarih > son-tarih 
                            exit perform   
                      end-if

                      if DOV-BOZ-ALIS-SATIS <> 0
                            exit perform cycle
                      end-if

                      if dov-boz-durumu <> "S" 
                            exit perform cycle
                      end-if

                      if dov-boz-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if
 
                       initialize detay
                       move dov-boz-gun      to x-gun
                       move dov-boz-ay       to x-ay
                       move dov-boz-yil      to x-yil
                       move x-tarih          to det-1

                       move DOV-BOZ-sil-SAAT   to x-saat
                       move DOV-BOZ-sil-dakika to x-dakika
                       move x-zaman            to det-2

                       move DOV-BOZ-FISNO to det-3
  
                       initialize banka-rec
                       move dov-boz-banka to banka-kodu
                       read banka no lock invalid
                               initialize banka-rec
                       end-read
                       move banka-adi  to det-4

                       initialize doviz-rec
                       move dov-boz-doviz to DOVIZ-KODU
                       read doviz no lock invalid
                               continue
                       end-read
                       move d-kisa-adi  to det-5
              
                       move DOV-BOZ-KUR-TUTAR to kur-z     move kur-z   to det-6
                       move DOV-BOZ-DV-TUTAR  to z-tutar   move z-tutar to det-7
                       move DOV-BOZ-TL-TUTAR  to z-tutar   move z-tutar to det-8

                       add DOV-BOZ-TL-TUTAR to toplam-tl 
                       add DOV-BOZ-DV-TUTAR to toplam-dv

                       initialize kllnc-rec
                       move dov-boz-staf to k-kodu
                       read kllnc no lock invalid    
                              MOVE  "Tanimsiz..." to k-adi  
                       end-read
                       move all low-values to deger-100
                       inspect k-adi    replacing trailing spaces by low-values
                       inspect k-soyadi replacing trailing spaces by low-values

                       string deger-100, 
                       k-adi    delimited by low-values
                       " "      delimited by low-values
                       k-soyadi delimited by low-values
                       into deger-100

                       inspect deger-100 replacing trailing  low-values by spaces 

                       move k-kodu    to det-9
                       move "-"       to det-9(5:1)
                       move deger-100 to det-9(6:)
                       move dov-boz-folio to det-15
                       write dokumer-rec from detay
              
                       add 1 to kayit-sayisi
                end-read
                end-perform
                end-start
          close skonuk konuk depkod kllnc acenta  rez  doviz banka dov-boz
             
          initialize  detay
          move "Toplam"     to det-0
          move kayit-sayisi to z-4   move  z-4  to det-1
          move toplam-dv    to z-tutar move z-tutar to det-7
          move toplam-tl    to z-tutar move z-tutar to det-8
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 303          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay.

* 
 oda-uzatma-raporu.
          initialize dokumer-rec detay
          move "[ Oda Uzatma Raporu ]"  to det-0
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 481          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 

          initialize dokumer-rec detay
          move "Tarih   "       to det-1
          move "Zaman"          to det-2
          move "Oda"            to det-3
          move "E.Cik.Tarih"    to det-4
          move "Y.Cik.Tarih"    to det-5
          move "Folio   "       to det-6
          move "Acenta"         to det-7
          move "Adi"            to det-8
          move "Soyadi   "      to det-9
          move "Pax"            to det-10
          move "Aciklama"       to det-11
          move "Kullanici"      to det-12

          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 144          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 
 
          open input skonuk konuk depkod kllnc acenta   rez  doviz  banka dov-boz  uzatma
                initialize kayit-sayisi dov-boz-rec
                move ilk-tarih to UZATMA-TARIH
                start uzatma key not < uzatma-anah invalid
                        continue
                not invalid
                perform until fs-uzatma =  "10"
                read uzatma next no lock end move "10" to fs-uzatma
                not end

   
                      if UZATMA-TARIH > son-tarih 
                            exit perform 
                      end-if
 

                      if uzatma-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if
 

                       initialize detay
                       move UZATMA-gun      to x-gun
                       move UZATMA-ay       to x-ay
                       move UZATMA-yil      to x-yil
                       move x-tarih         to det-1

                       move UZATMA-SAAT     to x-saat
                       move UZATMA-DAKIKA   to x-dakika
                       move x-zaman         to det-2

                       
                       move UZATMA-FOLIO    to det-6
                       initialize konuk-folio
                       move uzatma-folio to konuk-folio
                       read konuk no lock invalid
                               initialize konuk-rec
                       end-read

                       move konuk-odano   to det-3

                       move UZATMA-eski-gun to x-gun
                       move UZATMA-eski-ay  to x-ay
                       move UZATMA-eski-yil to x-yil
                       move x-tarih         to det-4

                       move UZATMA-yeni-gun to x-gun
                       move UZATMA-yeni-ay  to x-ay
                       move UZATMA-yeni-yil to x-yil
                       move x-tarih         to det-5

                       initialize acenta-rec
                       move konuk-acenta to acenta-kodu
                       read acenta no lock invalid
                               continue
                       end-read

                       move acenta-kodu to det-7
                       move "-"         to det-7(5:1)
                       move acenta-adi  to det-7(6:)

                       move konuk-adi     to det-8
                       move konuk-soyadi  to det-9
              
                       move konuk-BUYUK    to pax-buyuk
                       move konuk-kucuk    to pax-kucuk
                       move konuk-bebek    to pax-bebek
                       move konuk-free     to pax-free
                       move pax-bilgisi    to det-10

                       move uzatma-aciklama to det-11
                       initialize kllnc-rec
                       move uzatma-staf to k-kodu
                       read kllnc no lock invalid    
                              MOVE  "Tanimsiz..." to k-adi  
                       end-read
                       move all low-values to deger-100
                       inspect k-adi    replacing trailing spaces by low-values
                       inspect k-soyadi replacing trailing spaces by low-values

                       string deger-100, 
                       k-adi    delimited by low-values
                       " "      delimited by low-values
                       k-soyadi delimited by low-values
                       into deger-100

                       inspect deger-100 replacing trailing  low-values by spaces 

                       move k-kodu    to det-12
                       move "-"       to det-12(5:1)
                       move deger-100 to det-12(6:)
                       move uzatma-folio to det-15
                       write dokumer-rec from detay
              
                       add 1 to kayit-sayisi
                end-read
                end-perform
                end-start
          close skonuk konuk depkod kllnc acenta  rez  doviz banka dov-boz uzatma
             
          initialize  detay
          move "Toplam"     to det-0
          move kayit-sayisi to z-4   move  z-4  to det-1
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 303          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay.

* 
 oda-degisim-raporu.
          initialize dokumer-rec detay
          move "[ Oda Degisim Raporu ]"  to det-0
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 481          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 

          initialize dokumer-rec detay
          move "Tarih   "       to det-1
          move "Zaman"          to det-2
          move "E.Konum"        to det-3
          move "E.Oda"          to det-4
          move "Y.Oda"          to det-5
          move "Y.Konum"        to det-6
          move "Folio"          to det-7
          move "Acenta"         to det-8
          move "Adi"            to det-9
          move "Soyadi   "      to det-10
          move "Pax"            to det-11
          move "Aciklama"       to det-12
          move "Kullanici"      to det-13

          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 144          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 
 
          open input skonuk konuk depkod kllnc acenta   rez  doviz  banka dov-boz  uzatma konum odalar odadegis
                initialize kayit-sayisi dov-boz-rec
                move ilk-tarih to ODADEGIS-TARIH
                start odadegis key not < odadegis-anah invalid
                        continue
                not invalid
                perform until fs-odadegis =  "10"
                read odadegis next no lock end move "10" to fs-odadegis
                not end

   
                      if ODADEGIS-TARIH > son-tarih 
                            exit perform 
                      end-if
        
                      if ODADEGIS-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if
 

                       initialize detay
                       move ODADEGIS-gun      to x-gun
                       move ODADEGIS-ay       to x-ay
                       move ODADEGIS-yil      to x-yil
                       move x-tarih           to det-1

                       move ODADEGIS-SAAT     to x-saat
                       move ODADEGIS-DAKIKA   to x-dakika
                       move x-zaman           to det-2
 

                       MOVE ODADEGIS-ESKI-ODA TO det-4
                       initialize odalar-rec
                       move ODADEGIS-ESKI-ODA to odalar-no
                       read odalar no lock invalid
                               continue
                       end-read

                       initialize konum-rec
                       move ODALAR-KONUMU to KONUM-ANAHTAR
                       read konum no lock invalid
                               continue
                       end-read
                       move konum-adi to det-3


                       move ODADEGIS-YENI-ODA TO det-5
                       initialize odalar-rec
                       move ODADEGIS-YENI-ODA to odalar-no
                       read odalar no lock invalid
                               continue
                       end-read

                       initialize konum-rec
                       move ODALAR-KONUMU to KONUM-ANAHTAR
                       read konum no lock invalid
                               continue
                       end-read
                       move konum-adi to det-6

                       move ODADEGIS-FOLIO    to det-7
                       initialize konuk-folio
                       move odadegis-folio to konuk-folio
                       read konuk no lock invalid
                               initialize konuk-folio
                               move odadegis-folio to skonuk-folio
                               read skonuk no lock invalid
                                        initialize skonuk-folio
                               end-read
                               move "***"         to det-9 det-10
                               move skonuk-adi    to det-9(4:)
                               move skonuk-soyadi to det-10(4:)
                       not invalid
                               move konuk-adi     to det-9
                               move konuk-soyadi  to det-10
                       end-read

                       initialize acenta-rec
                       move konuk-acenta to acenta-kodu
                       read acenta no lock invalid
                               continue
                       end-read

                       move acenta-kodu to det-8
                       move "-"         to det-8(5:1)
                       move acenta-adi  to det-8(6:)
        
                       move konuk-BUYUK    to pax-buyuk
                       move konuk-kucuk    to pax-kucuk
                       move konuk-bebek    to pax-bebek
                       move konuk-free     to pax-free
                       move pax-bilgisi    to det-11

                       move odadegis-aciklama to det-12
                       initialize kllnc-rec
                       move odadegis-staf to k-kodu
                       read kllnc no lock invalid    
                              MOVE  "Tanimsiz..." to k-adi  
                       end-read
                       move all low-values to deger-100
                       inspect k-adi    replacing trailing spaces by low-values
                       inspect k-soyadi replacing trailing spaces by low-values

                       string deger-100, 
                       k-adi    delimited by low-values
                       " "      delimited by low-values
                       k-soyadi delimited by low-values
                       into deger-100

                       inspect deger-100 replacing trailing  low-values by spaces 

                       move k-kodu    to det-13
                       move "-"       to det-13(5:1)
                       move deger-100 to det-13(6:)
                       move odadegis-folio to det-15
                       write dokumer-rec from detay
              
                       add 1 to kayit-sayisi
                end-read
                end-perform
                end-start
          close skonuk konuk depkod kllnc acenta  rez  doviz banka dov-boz uzatma  konum odalar odadegis
             
          initialize  detay
          move "Toplam"     to det-0
          move kayit-sayisi to z-4   move  z-4  to det-1
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 303          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay.

*
 correction-raporu.
          initialize dokumer-rec detay
          move "[ Correction Raporu ]"  to det-0
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 481          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 

          initialize dokumer-rec detay
          move "Tarih   "  to det-1
          move "Zaman   "  to det-2
          move "Oda     "  to det-3
          move "Folio No"  to det-4
          move "Adi     "  to det-5
          move "Soyadi  "  to det-6
          move "Islem no"  to det-7
          move "Correciton"    to det-8
          move "Cor.Departman" to det-9
          move "Cor. TL Tutar"     to det-10
          move "Cor. DV Tutar"     to det-11 
          move "Aciklama     " to det-12
          move "Kullanici"     to det-13

          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 144          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
   
          open input silhrk konuk depkod kllnc skonuk romhrk exthrk nt
                initialize kayit-sayisi romhrk-rec toplam-tl toplam-dv
                move ilk-tarih to ROMHRK-TARIH
                start romhrk key not < ROMHRK-ANAH2 invalid
                        continue
                not invalid
                perform until fs-romhrk = "10"
                read romhrk next no lock end move "10" to fs-romhrk
                not end
                      if ROMHRK-TARIH > son-tarih
                            exit perform
                      end-if

                      if romhrk-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if

                      initialize depkod-rec
                      move ROMHRK-DEPKOD to depkod-kodu
                      read depkod no lock invalid
                               exit perform cycle 
                      not invalid
                           if DEPKOD-TURU <> 2 then 
                                exit perform cycle 
                           end-if
                      end-read

                      if ROMHRK-CORR-DEPKOD = zeroes
                            exit perform cycle
                      end-if

                      perform cor-detay-ata
                end-read
                end-perform
                end-start

                initialize exthrk-rec
                move ilk-tarih to exthrk-TARIH
                start exthrk key not < exthrk-ANAH2 invalid
                        continue
                not invalid
                perform until fs-exthrk = "10"
                read exthrk next no lock end move "10" to fs-exthrk
                not end
                      if exthrk-TARIH > son-tarih
                            exit perform
                      end-if

                      if exthrk-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if

                      initialize depkod-rec
                      move exthrk-DEPKOD to depkod-kodu
                      read depkod no lock invalid
                               exit perform cycle 
                      not invalid
                           if DEPKOD-TURU <> 2 then 
                                exit perform cycle 
                           end-if
                      end-read

                      if exthrk-CORR-DEPKOD = zeroes
                            exit perform cycle
                      end-if
                      move exthrk-rec to romhrk-rec
                      perform cor-detay-ata
                end-read
                end-perform
                end-start
          close silhrk konuk depkod kllnc skonuk  romhrk exthrk nt
             
          initialize  detay
          move "Toplam"     to det-0
          move kayit-sayisi to z-4   move  z-4  to det-1

          move toplam-tl    to z-tutar move z-tutar to det-10
          move toplam-dv    to z-tutar move z-tutar to det-11
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 303          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay.

*
 cor-detay-ata.
                      initialize detay
                      move ROMHRK-gun     to x-gun
                      move ROMHRK-ay      to x-ay
                      move ROMHRK-yil     to x-yil
                      move x-tarih        to det-1

                      move ROMHRK-saat    to x-saat
                      move ROMHRK-DAKIKA  to x-dakika
                      move x-zaman        to det-2

                      move depkod-kodu to det-8(1:3)
                      move "-"         to det-8(4:1)
                      move depkod-adi  to det-8(5:)

                      initialize depkod-rec
                      move ROMHRK-CORR-DEPKOD to depkod-kodu
                      read depkod no lock invalid
                              continue
                      end-read

                      move depkod-kodu to det-9(1:3)  
                      move "-"         to det-9(4:1)  
                      move depkod-adi  to det-9(5:)   



                      move romhrk-folio    to det-4
                      MOVE ROMHRK-ISLEM TO DET-7

                       initialize konuk-rec
                       move romhrk-folio to konuk-folio
                       read konuk no lock invalid        
                               initialize konuk-folio
                       not invalid
                               move konuk-odano  to det-3
                               move konuk-adi    to det-5
                               move konuk-soyadi to det-6
                       end-read

                       move ROMHRK-TL-TUTAR  to z-tutar
                       move z-tutar          to det-10
                       add ROMHRK-TL-TUTAR   to toplam-tl

                       move ROMHRK-DV-TUTAR  to z-tutar
                       move z-tutar          to det-11
                       add ROMHRK-DV-TUTAR   to toplam-dv 


                       initialize not-rec
                       if konuk-fol-kodu = "R"
                           move "RHR"       to NOT-DOS
                       else
                           move "EHR"       to NOT-DOS
                       end-if
                       move romhrk-anah to  NOT-DOS-ANAH
                       read nt no lock invalid 
                               initialize not1
                       end-read
                       move  not1  to det-12

                       initialize kllnc-rec
                       move ROMHRK-STAF to k-kodu
                       read kllnc no lock invalid    
                              MOVE  "Tanimsiz..." to k-adi  
                       end-read
                       move all low-values to deger-100
                       inspect k-adi    replacing trailing spaces by low-values
                       inspect k-soyadi replacing trailing spaces by low-values

                       string deger-100, 
                       k-adi    delimited by low-values
                       " "      delimited by low-values
                       k-soyadi delimited by low-values
                       into deger-100

                       inspect deger-100 replacing trailing  low-values by spaces 

                       move k-kodu    to det-13
                       move "-"       to det-13(5:1)
                       move deger-100 to det-13(6:)
                       move romhrk-folio to det-15
                       write dokumer-rec from detay
                       add 1 to kayit-sayisi.
*
 manuel-islenen-oda-gelirleri.
          initialize dokumer-rec detay
          move "[ Manuel Oda Geliri Raporu ]"  to det-0
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 481          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 

          initialize dokumer-rec detay
          move "Tarih   "  to det-1
          move "Zaman   "  to det-2
          move "Oda     "  to det-3
          move "Folio No"  to det-4
          move "Adi     "  to det-5
          move "Soyadi  "  to det-6
          move "Islem no"  to det-7
          move "Departman"    to det-8
          move "Islem Tipi" to det-9
          move "TL Tutar"     to det-10
          move "DV Tutar"     to det-11 
          move "Aciklama     " to det-12
          move "Kullanici"     to det-13

          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 144          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay
 
  
          open input silhrk konuk depkod kllnc skonuk romhrk exthrk nt
                initialize kayit-sayisi romhrk-rec toplam-tl toplam-dv
                move ilk-tarih to ROMHRK-TARIH
                start romhrk key not < ROMHRK-ANAH2 invalid
                        continue
                not invalid
                perform until fs-romhrk = "10"
                read romhrk next no lock end move "10" to fs-romhrk
                not end
                      if ROMHRK-TARIH > son-tarih
                            exit perform
                      end-if

                      if romhrk-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if                    
                      if romhrk-islem-tipi <> "M"
                         exit perform cycle 
                      end-if

                      initialize depkod-rec
                      move romhrk-depkod           to depkod-anah
                      read depkod no lock invalid 
                            exit perform cycle 
                      not invalid 
                           if depkod-ba <> "B"
                                exit perform cycle 
                           end-if 
                           if depkod-tipi <> "2" 
                               exit perform cycle 
                           end-if 
                      end-read 
                      
                      perform manuel-hrk-detay-ata
                end-read
                end-perform
                end-start

                initialize exthrk-rec
                move ilk-tarih to exthrk-TARIH
                start exthrk key not < exthrk-ANAH2 invalid
                        continue
                not invalid
                perform until fs-exthrk = "10"
                read exthrk next no lock end move "10" to fs-exthrk
                not end
                      if exthrk-TARIH > son-tarih
                            exit perform
                      end-if

                      if exthrk-staf <> cmb-kullanici(1:4) and cmb-kullanici(1:4) <> "XXXX"
                            exit perform cycle
                      end-if
                      if exthrk-islem-tipi <> "M"
                         exit perform cycle 
                      end-if 
                      initialize depkod-rec
                      move exthrk-depkod           to depkod-anah
                      read depkod no lock invalid 
                            exit perform cycle 
                      not invalid 
                           if depkod-ba <> "B"
                                exit perform cycle 
                           end-if 
                           if depkod-tipi <> "2" 
                               exit perform cycle 
                           end-if 
                      end-read 
 
                      move exthrk-rec to romhrk-rec
                      perform manuel-hrk-detay-ata
                end-read
                end-perform
                end-start
          close silhrk konuk depkod kllnc skonuk  romhrk exthrk nt
             
          initialize  detay
          move "Toplam"     to det-0
          move kayit-sayisi to z-4   move  z-4  to det-1

          move toplam-tl    to z-tutar move z-tutar to det-10
          move toplam-dv    to z-tutar move z-tutar to det-11
          move "T"          to det-dokumer-20(1:1)
          move "A"          to det-dokumer-20(3:1)
          move 303          to det-renk1
          move "1"          to det-dokumer-20(10:1)
          write dokumer-rec from detay.

*
 manuel-hrk-detay-ata.
                      initialize detay
                      move ROMHRK-gun     to x-gun
                      move ROMHRK-ay      to x-ay
                      move ROMHRK-yil     to x-yil
                      move x-tarih        to det-1

                      move ROMHRK-saat    to x-saat
                      move ROMHRK-DAKIKA  to x-dakika
                      move x-zaman        to det-2
                      initialize depkod-rec
                      move ROMHRK-DEPKOD to depkod-kodu
                      read depkod no lock invalid
                              continue
                      end-read

                      move depkod-kodu to det-8(1:3)
                      move "-"         to det-8(4:1)
                      move depkod-adi  to det-8(5:)


                      move romhrk-folio    to det-4
                      MOVE ROMHRK-ISLEM TO DET-7

                       initialize konuk-rec
                       move romhrk-folio to konuk-folio
                       read konuk no lock invalid        
                               initialize konuk-folio
                       not invalid
                               move konuk-odano  to det-3
                               move konuk-adi    to det-5
                               move konuk-soyadi to det-6
                       end-read
                       move "MANUEL POSTING" to det-9
                       move ROMHRK-TL-TUTAR  to z-tutar
                       move z-tutar          to det-10
                       add ROMHRK-TL-TUTAR   to toplam-tl

                       move ROMHRK-DV-TUTAR  to z-tutar
                       move z-tutar          to det-11
                       add ROMHRK-DV-TUTAR   to toplam-dv 


                       initialize not-rec
                       if konuk-fol-kodu = "R"
                           move "RHR"       to NOT-DOS
                       else
                           move "EHR"       to NOT-DOS
                       end-if
                       move romhrk-anah to  NOT-DOS-ANAH
**                       move exthrk-anah to  NOT-DOS-ANAH 
                       read nt no lock invalid 
                               initialize not1
                       end-read
                       move  not1  to det-12

                       initialize kllnc-rec
                       move ROMHRK-STAF to k-kodu
                       read kllnc no lock invalid    
                              MOVE  "Tanimsiz..." to k-adi  
                       end-read
                       move all low-values to deger-100
                       inspect k-adi    replacing trailing spaces by low-values
                       inspect k-soyadi replacing trailing spaces by low-values

                       string deger-100, 
                       k-adi    delimited by low-values
                       " "      delimited by low-values
                       k-soyadi delimited by low-values
                       into deger-100

                       inspect deger-100 replacing trailing  low-values by spaces 

                       move k-kodu    to det-13
                       move "-"       to det-13(5:1)
                       move deger-100 to det-13(6:)
                       move romhrk-folio to det-15
                       write dokumer-rec from detay
                       add 1 to kayit-sayisi.




 
