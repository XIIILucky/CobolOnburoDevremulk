* rezsuz.evt
* rezsuz.evt is generated from D:\asya\acugt.ytl\otel\rezsuz.Psf
* This is a generated file. DO NOT modify this file directly.


 Acu-Form1-Ta-1-Cmd-Tabchanged.
     EVALUATE Event-Type
     WHEN Cmd-Tabchanged
        MOVE Event-Data-1 TO Form1-Ta-1-Value
        MOVE 0 TO Form1-Pg-1-Visible, Form1-Pg-2-Visible,
            Form1-Pg-3-Visible, Form1-Pg-4-Visible, Form1-Pg-5-Visible,
            Form1-Pg-6-Visible
        EVALUATE Event-Data-1
        WHEN 1
           MOVE 1 TO Form1-Pg-1-Visible
        WHEN 2
           MOVE 1 TO Form1-Pg-2-Visible
        WHEN 3
           MOVE 1 TO Form1-Pg-3-Visible
        WHEN 4
           MOVE 1 TO Form1-Pg-4-Visible
        WHEN 5
           MOVE 1 TO Form1-Pg-5-Visible
        WHEN 6
           MOVE 1 TO Form1-Pg-6-Visible
        END-EVALUATE
*       Before-Tabchg-Display
        DISPLAY Form1
        PERFORM Form1-Ta-1-Aft-Tabchg-Display
     END-EVALUATE
     .

 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .

 cb-otel-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM cb-otel-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 Form1-Ta-1-Event-Proc.
* 
     EVALUATE Event-Type
     WHEN Cmd-Tabchanged
        PERFORM Form1-Ta-1-Ev-Cmd-Tabchanged
     END-EVALUATE
     .

 Form1-Gd-1-Event-Proc.
     PERFORM gd-1-Ev-Other
     .

 gd-3-Event-Proc.
     PERFORM gd-3-Ev-Other
     .

 gd-2-Event-Proc.
     PERFORM gd-2-Ev-Other
     .

 gd-4-Event-Proc.
     PERFORM gd-4-Ev-Other
     .

 gd-5-Event-Proc.
     EVALUATE Event-Control-Id
     WHEN 42
        PERFORM gd-5-Ev-Other
     WHEN 50
        PERFORM gd-6-Ev-Other
     END-EVALUATE
     .

 Form1-Tr-1-Event-Proc.
     PERFORM Form1-Tr-1-Ev-Other
     .

 Form1-Ef-1-Event-Proc.
     .
***   start event editor code   ***
*
 Form1-Ex-Other.
     evaluate key-status
         when 1
              if control-id = 64 
                 initialize acenta-cagir
                 call "/asya/ytl/obj/otel/acenara.asy"
                      using acenta-cagir on exception 
                         perform callerr-proc
                 not on exception
                    cancel "/asya/ytl/obj/otel/acenara.asy" 
                 end-call
                 open input acenta
                 initialize acenta-rec
                 move acenta-cagir     to acenta-anahtar 
                 read acenta no lock invalid
                      initialize grid-occ(4)
                 not invalid
                     move acenta-adi to grid-occ(4)
                 end-read
                 display Form1-Ef-1b
                 close acenta
              end-if
         when 5544
              perform aft-yukle
         when 845
              perform yazdir
         when 1005
              perform baslik-yukle-inhouse
              perform inhose-cagir
              move 4 to accept-control
              move 20 to control-id 
         when 23                                              |xiii 29/06/2018
              evaluate form1-ta-1-value
                  when 1
                       inquire gd-1,cursor-y in sayac
                       inquire gd-1(sayac,1),
                               hidden-data in ydk-rez
                       perform kart-yap
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-1,cursor-x 2
                                   cursor-y sayac
                  when 2
                       inquire gd-3,cursor-y in sayac
                       inquire gd-3(sayac,1),
                               hidden-data in ydk-rez
                       perform kart-yap
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-3,cursor-x 2
                                   cursor-y sayac
                  when 3
                       inquire gd-2,cursor-y in sayac
                       inquire gd-2(sayac,1),
                               hidden-data in ydk-rez
                       perform kart-yap
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-2,cursor-x 2
                                   cursor-y sayac
                  when 4
                       inquire gd-4,cursor-y in sayac
                       inquire gd-4(sayac,1),
                               hidden-data in ydk-rez
                       perform kart-yap
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-4,cursor-x 2
                                   cursor-y sayac
              end-evaluate
         when 6|ctrl - f folio
              evaluate Form1-Ta-1-Value
                  when 3
                       inquire gd-2,cursor-y in sayac
                       inquire gd-2(sayac,2),
                               hidden-data in ydk-konuk-folio
                       perform folio-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-2,cursor-x 2
                                   cursor-y sayac
                  when 2
                       inquire gd-3,cursor-y in sayac
                       inquire gd-3(sayac,2),
                               hidden-data in ydk-konuk-folio
                       perform folio-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-3,cursor-x 2
                                   cursor-y sayac
                  when 4
                       inquire gd-4,cursor-y in sayac
                       inquire gd-4(sayac,2),
                               hidden-data in ydk-konuk-folio
                       perform folio-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-4,cursor-x 2
                                   cursor-y sayac

                  when 5
                       inquire gd-5,cursor-y in sayac
                       inquire gd-5(sayac,2),
                               hidden-data in ydk-konuk-folio
                       perform folio-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-5,cursor-x 2
                                   cursor-y sayac

                  when 6
                       inquire gd-6,cursor-y in sayac
                       inquire gd-6(sayac,2),
                               hidden-data in ydk-konuk-folio
                       perform folio-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-6,cursor-x 2
                                   cursor-y sayac
        
              end-evaluate 
         when 7 | ctrl + G extra folio
              evaluate Form1-Ta-1-Value
                  when 3
                       inquire gd-2,cursor-y in sayac
                       inquire gd-2(sayac,2),
                               hidden-data in ydk-konuk-folio
                       compute ydk-konuk-folio = ydk-konuk-folio + 1
                       perform folio-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-2,cursor-x 2
                                   cursor-y sayac
        
                  when 2
                       inquire gd-3,cursor-y in sayac
                       inquire gd-3(sayac,2),
                               hidden-data in ydk-konuk-folio
                       compute ydk-konuk-folio = ydk-konuk-folio + 1
                       perform folio-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-3,cursor-x 2
                                   cursor-y sayac
        
                  when 4
                       inquire gd-4,cursor-y in sayac
                       inquire gd-4(sayac,2),
                               hidden-data in ydk-konuk-folio
                       compute ydk-konuk-folio = ydk-konuk-folio + 1
                       perform folio-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-4,cursor-x 2
                                   cursor-y sayac
                
                  when 5
                       inquire gd-5,cursor-y in sayac
                       inquire gd-5(sayac,2),
                               hidden-data in ydk-konuk-folio
                       compute ydk-konuk-folio = ydk-konuk-folio + 1
                       perform folio-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-5,cursor-x 2
                                   cursor-y sayac
                  when 6
                       inquire gd-6,cursor-y in sayac
                       inquire gd-6(sayac,2),
                               hidden-data in ydk-konuk-folio
                       compute ydk-konuk-folio = ydk-konuk-folio + 1
                       perform folio-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-6,cursor-x 2
                                   cursor-y sayac
                
              end-evaluate 

         when 18|ctrl - r rezervasyon
              evaluate Form1-Ta-1-Value
                  when 1
                       inquire gd-1,cursor-y in sayac
                       inquire gd-1(sayac,1),
                               hidden-data in ydk-rez
                       perform rez-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-1,cursor-x 2
                                   cursor-y sayac
                  when 2
                       inquire gd-3,cursor-y in sayac
                       inquire gd-3(sayac,1),
                               hidden-data in ydk-rez
                       perform rez-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display 
                       modify gd-3,cursor-x 2
                                   cursor-y sayac
        
                  when 3
                       inquire gd-2,cursor-y in sayac
                       inquire gd-2(sayac,1),
                               hidden-data in ydk-rez
                       perform rez-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-2,cursor-x 2
                                   cursor-y sayac
         
                  when 4
                       inquire gd-4,cursor-y in sayac
                       inquire gd-4(sayac,1),
                               hidden-data in ydk-rez
                       perform rez-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display 
                       modify gd-4,cursor-x 2
                                   cursor-y sayac
        
                  when 5
                       inquire gd-5,cursor-y in sayac
                       inquire gd-5(sayac,1),
                               hidden-data in ydk-rez
                       perform rez-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display 
                       modify gd-5,cursor-x 2
                                   cursor-y sayac
                   
                  when 6
                       inquire gd-6,cursor-y in sayac
                       inquire gd-6(sayac,1),
                               hidden-data in ydk-rez
                       perform rez-cagir
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-6,cursor-x 2
                                   cursor-y sayac
        
              end-evaluate  
         when 14|ctrl - n register kart
              evaluate Form1-Ta-1-Value
                  when 1
                       perform c-in-yap
                       perform Form1-Ta-1-Aft-Tabchg-Display
                  when 2
                       initialize ydk-folio
                       inquire gd-3,cursor-y in sayac
                       inquire gd-3(sayac,2), hidden-data in ydk-folio
                       perform reg-kart
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-3,cursor-x 2
                                   cursor-y sayac
        
                  when 3
                       initialize ydk-folio
                       inquire gd-2,cursor-y in sayac
                       inquire gd-2(sayac,2), hidden-data in ydk-folio
                       perform reg-kart
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-2,cursor-x 2
                                   cursor-y sayac
        
                  when 4
                       initialize ydk-folio
                       inquire gd-4,cursor-y in sayac
                       inquire gd-4(sayac,2), hidden-data in ydk-folio
                       perform reg-kart
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-4,cursor-x 2
                                   cursor-y sayac
        
                  when 5
                       initialize ydk-folio
                       inquire gd-5,cursor-y in sayac
                       inquire gd-5(sayac,2), hidden-data in ydk-folio
                       perform reg-kart
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-5,cursor-x 2
                                   cursor-y sayac
        
                  when 6
                       initialize ydk-folio
                       inquire gd-6,cursor-y in sayac
                       inquire gd-6(sayac,2), hidden-data in ydk-folio
                       perform reg-kart
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-6,cursor-x 2
                                   cursor-y sayac
        
              end-evaluate  
         when 7001
              perform hotel-status
         when 7002
              perform blokaj-menusu
         when 7003
              perform teknik-rack
         when 7005
              perform bos-oda-listesi
         when 7006
              perform cikis-listesi
         when 8
              evaluate Form1-Ta-1-Value
                  when 3
                       perform oda-degis
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-2,cursor-x 2
                                   cursor-y sayac
        
              end-evaluate
         when 21
              evaluate Form1-Ta-1-Value
                  when 3
                       perform oda-uzatma
                       perform Form1-Ta-1-Aft-Tabchg-Display
                       modify gd-2,cursor-x 2
                                   cursor-y sayac
        
              end-evaluate
         when 5000 
              perform baslik-yukle-tumrez
              perform tumrez-cagir
         when 5001
              perform baslik-yukle-tumrez
              perform tumrez-cagir
     end-evaluate.
*
 Form1-Bef-Create.
      perform adresleri-tasi
      open input genel
      initialize genel-rec
      move 1     to genel-anahtar
      read genel no lock invalid
           continue
      end-read
      close genel
      open input kllnc
      initialize kllnc-rec
      move k-kodu-tasi    to k-kodu
      read kllnc no lock invalid
          continue 
      end-read 
      close kllnc
      initialize hangi-ref
      move k-ref            to hangi-ref 

      move gun-tasi         to ilk-gun son-gun
      move ay-tasi          to ilk-ay  son-ay
      move yil-tasi         to ilk-yil son-yil filtre-son-yil

      move DONEM-BASI-YIL   to filtre-ilk-yil
      move 1                to filtre-ilk-gun filtre-ilk-ay
      move 31               to filtre-son-gun
      move 12               to filtre-son-ay.
      open i-o odalar2.
*
 gel-cagir.
     perform takas-dosya-ac
     open input konum kur rez kllnc takvim acenta 
                kodlar02 cast ulke firma yanrez doviz odalar
     initialize rez-rec gel-toplam gel-toplam-buyuk gel-toplam-kucuk
                yanrez-rec efiyat doviz-rec  gel-toplam-free gel-toplam-bebek  top-kac-gece  kayit-adet
     move ilk-tarih    to rez-gir-tar
     move "I"          to rez-durumu
     start rez key not < rez-gir invalid
           continue
     not invalid
     perform with test after until fs-rez = "10"
     read rez next no lock end move "10"  to fs-rez
     not at end 

        if rez-durumu not = "I" 
           exit perform cycle
        end-if
        if rez-gir-tar > son-tarih 
           exit perform cycle
        end-if
        if rez-k-g-b  not = "K"
           exit perform cycle
        end-if
        if cin-odalar-dahil not = 1
          if rez-c-in = "E"
             exit perform cycle
          end-if
        end-if 
        
        if onkpara-referans-var = 1
          if oda-ref(1:1) not = "0"
             initialize konum-rec
             move rez-oda-konumu   to konum-anahtar
             read konum no lock invalid 
                 continue 
             not invalid 
                 if konum-ref <> oda-ref(1:1)
                    exit perform cycle 
                 end-if 
             end-read 
          end-if 
        end-if 
        if yan-ciksin = 1 
           initialize yanrez-rec
           move rez-no to yanrez-rezno
           start yanrez key not < yanrez-anah invalid 
                 continue 
           not invalid 
           perform with test after until fs-yanrez = "10"
           read yanrez next no lock end move "10"  to fs-yanrez 
           not at end
               if yanrez-rezno <> rez-no
                  exit perform 
               end-if 
           
               move yanrez-adi    to rez-adi
               move yanrez-soyadi to rez-soyadi

               perform gelrez-tum-detaylar
               
           end-read
           end-perform
           end-start           
        else         
           move 1 to yanrez-sirano 
           perform gelrez-tum-detaylar
        end-if 
    
     end-read
     end-perform
     end-start

     close rez acenta cast kllnc kur takvim kodlar02 odalar
           ulke yanrez doviz firma konum takas


     modify gd-1,
            mass-update = 0.
     display acc-100 acc-99 acc-98 acc-97 acc-96 acc-95.
*
 gelrez-tum-detaylar.
        if yanrez-sirano = 1
           perform toplam-rez-tutar
        end-if 

        initialize gd1-rec    
        move rez-no          to gd-1-col-32
        if rez-grup-no > 0
            move rez-grup-no to gd-1-col-19
        end-if

        move rez-adi         to gd-1-col-2
        move rez-soyadi      to gd-1-col-3
        initialize acenta-rec
        move rez-acenta      to acenta-kodu
        read acenta no lock invalid
             move "Tanimsiz..." to gd-1-col-4
        not invalid
            move acenta-adi     to gd-1-col-4
        end-read
        move rez-gir-gun        to gd-1-col-5(1:2)
        move "/"                to gd-1-col-5(3:1)
        move rez-gir-ay         to gd-1-col-5(4:2)
        move "/"                to gd-1-col-5(6:1)
        move rez-gir-yil        to gd-1-col-5(7:4)  

        move rez-cik-gun        to gd-1-col-6(1:2)
        move "/"                to gd-1-col-6(3:1)
        move rez-cik-ay         to gd-1-col-6(4:2)
        move "/"                to gd-1-col-6(6:1)
        move rez-cik-yil        to gd-1-col-6(7:4)  

        if yanrez-sirano = 1
           move rez-buyuk          to ydk-buyuk
           move ydk-buyuk          to gd-1-col-7
           move rez-kucuk          to ydk-kucuk
           move ydk-kucuk          to gd-1-col-8
           move rez-free           to ydk-fre
           move ydk-fre            to gd-1-col-9
           move rez-bebek          to ydk-bebe
           move ydk-bebe           to gd-1-col-10
           move rez-voucher        to gd-1-col-11
        end-if 
        if yanrez-sirano = 1
           initialize konum-rec
           move rez-oda-konumu     to konum-anahtar
           read konum no lock invalid
                 move "Hata"       to konum-adi
           end-read 
                 move konum-adi    to gd-1-col-12(1:8)
                 move "-"          to gd-1-col-12(9:1)

           initialize konum-rec
           move rez-fiyat-konumu     to konum-anahtar
           read konum no lock invalid
                 move "Hata"       to konum-adi
           end-read 
                 move konum-adi    to gd-1-col-12(10:)
           
           
        
           move rez-gel-saat       to gd-1-col-14
           move rez-gel-dak        to gd-1-col-15
           move rez-git-saat       to gd-1-col-16
           move rez-git-dak        to gd-1-col-17
        
           initialize ulke-rec
           move rez-ulke           to ulke-anah1 
           read ulke no lock invalid
                move "Tanimsiz...."      to gd-1-col-18
           not invalid
               move ulke-adi             to gd-1-col-18        
           end-read
        end-if
        if rez-firma not = spaces
           initialize firma-rec
           move rez-firma          to firma-kodu
           read firma no lock invalid
                move "Tanimsiz..." to firma-adi 
           end-read 
                move firma-adi     to gd-1-col-13
        end-if 

        
        move rez-odano                 to o-kisa 
            perform oda-uzat
            move o-uzun to  gd-1-col-1
        if yanrez-sirano = 1
           initialize doviz-rec
           move rez-doviz                to doviz-kodu
           read doviz no lock invalid
                move "Tanimsiz Doviz Kodu" to gd-1-col-20
           end-read
           move d-adi-1                  to gd-1-col-20
           move rez-fiyati               to efiyat
           move efiyat                   to gd-1-col-21
           move doviz-alis               to zkur
           move zkur                     to gd-1-col-22
        
           move rez-not1                 to gd-1-col-23
           move rez-not2                 to gd-1-col-24
           
              perform geceleme-bul
              move kac-gece                 to z3
              move z3                       to gd-1-col-26
            
           move rez-al-gun               to gd-1-col-27(1:2)
           move "/"                      to gd-1-col-27(3:1)
           move rez-al-ay                to gd-1-col-27(4:2)
           move "/"                      to gd-1-col-27(6:1)
           move rez-al-yil               to gd-1-col-27(7:4)
           move toplam-cast-fiyati       to z-15
           move z-15                     to gd-1-col-28
           move toplam-dv                to z-15
           move z-15                     to gd-1-col-29
           
           perform kllnc-oku
           move k-adi                    to gd-1-col-30
        
           initialize kodlar02-rec
           move "A"                      to kodlar02-tipi
           move rez-pan-tipi             to kodlar02-kodu
           read kodlar02 no lock invalid
                move "Hata"              to kodlar02-adi
           end-read 
                move kodlar02-adi        to gd-1-col-31

           initialize kodlar02-rec                                     |firat pazar kolonu  10/08/2020
           move "E"       to kodlar02-tipi
           move rez-pazar to kodlar02-kodu
           read kodlar02 no lock invalid 
                move rez-pazar to kodlar02-adi
           end-read
           move kodlar02-adi         to gd-1-col-35

           initialize kodlar02-rec
           move "v"      to kodlar02-tipi
           move rez-vip  to kodlar02-kodu
           read kodlar02 no lock invalid
               initialize kodlar02-rec
           end-read
           move kodlar02-adi to gd-1-col-40

        end-if
        
        move rez-telefon-no              to gd-1-col-34

*        if konuk-late-zaman > 0                                         |firat late cout kolonu  12/08/2020
*           move konuk-late-gel-saat   to gd-1-col-36(1:)
*           move ":"                   to gd-1-col-36(3:)
*           move konuk-late-gel-dak    to gd-1-col-36(4:)
*        end-if
        move "00:00"                   to gd-1-col-36

        initialize odalar-rec             |firat oda durum kolonu  12/08/2020
        move rez-odano to odalar-anah
        read odalar no lock invalid
             continue
        end-read 
        initialize kodlar02-rec                                     
        move "C"                to kodlar02-tipi
        move odalar-durumu      to kodlar02-kodu
        read kodlar02 no lock invalid 
             move odalar-durumu to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-1-col-37

        initialize kodlar02-rec                                     
        move "B"                to kodlar02-tipi
        move rez-odeme-tipi     to kodlar02-kodu
        read kodlar02 no lock invalid 
             move "Tanimsiz."   to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-1-col-39

        if grid-occ(1) <> spaces
             move rez-odano         to o-kisa 
            perform oda-uzat
            move o-uzun to  kelime
             move grid-occ(1)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

       if grid-occ(2) <> spaces
             move function upper-case(rez-adi) to kelime
             move function upper-case(grid-occ(2))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy
        
             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        
        if grid-occ(3) <> spaces
             move function upper-case(rez-soyadi)   to kelime
             move function upper-case(grid-occ(3))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(4) <> spaces  
             initialize acenta-rec 
             move rez-acenta   to acenta-kodu
             read acenta no lock invalid
                  move "Tanimsiz..."  to acenta-adi
             not invalid
                 move acenta-adi      to ydk-acenta-adi
             end-read
             move function upper-case(ydk-acenta-adi) to kelime
             move function upper-case(grid-occ(4))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0                 
                exit paragraph
             end-if
        end-if
        if grid-occ(5) <> spaces
             move gd-1-col-5        to kelime
             move grid-occ(5)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                
                exit paragraph
             end-if
        end-if
        if grid-occ(6) <> spaces
             move gd-1-col-6        to kelime
             move grid-occ(6)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0                 
                exit paragraph
             end-if
        end-if
        if grid-occ(7) <> spaces
             move rez-buyuk        to kelime
             move grid-occ(7)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(8) <> spaces
             move rez-kucuk        to kelime
             move grid-occ(8)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(9) <> spaces
             move rez-free        to kelime
             move grid-occ(9)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(10) <> spaces
             move rez-bebek        to kelime
             move grid-occ(10)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(11) <> spaces         
             move function upper-case(rez-voucher) to kelime
             move function upper-case(grid-occ(11))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(12) <> spaces         
             initialize konum-rec
             move rez-oda-konumu           to konum-anahtar
             read konum no lock invalid 
                  continue 
             end-read 
             move function upper-case(konum-adi) to kelime
             move function upper-case(grid-occ(12))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(13) <> spaces 
             initialize firma-rec  ydk-firma-adi
             move rez-firma   to firma-kodu
             read firma no lock invalid
                  move "Tanimsiz..."  to firma-adi
             not invalid
                 move firma-adi       to ydk-firma-adi
             end-read
             move function upper-case(ydk-firma-adi) to kelime
             move function upper-case(grid-occ(13))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 

             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0                 
                exit paragraph
             end-if
        end-if

        if grid-occ(14) <> spaces         
             move rez-gel-saat   to kelime
             move grid-occ(14)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(15) <> spaces         
             move rez-gel-dak      to kelime
             move grid-occ(15)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(16) <> spaces         
             move rez-git-saat   to kelime
             move grid-occ(16)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(17) <> spaces         
             move rez-git-dak      to kelime
             move grid-occ(17)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(18) <> spaces
             initialize ulke-rec 
             move rez-ulke         to ulke-anah
             read ulke no lock invalid
                  move "   "       to ulke-adi
             end-read 
             move ulke-adi         to kelime
             move grid-occ(18)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(19) <> spaces
             move rez-grup-no        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(19)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(20) <> spaces
             initialize doviz-rec
             move rez-doviz        to doviz-kodu
             read doviz no lock invalid 
                  move "  "        to D-KISA-ADI
             end-read 
             move D-KISA-ADI        to kelime
             move grid-occ(20)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if        

        if grid-occ(21) <> spaces
             move rez-fiyati        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(21)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(23) <> spaces
             move rez-not1        to kelime
             move grid-occ(23)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(24) <> spaces
             move rez-not2        to kelime
             move grid-occ(24)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               exit paragraph
             end-if
        end-if
        if grid-occ(31) <> spaces
             initialize kodlar02-rec
             move rez-pan-tipi      to kodlar02-kodu
             move "A"               to kodlar02-tipi
             read kodlar02 no lock invalid
                  continue 
             end-read 
             move function upper-case(kodlar02-adi)          to kelime
             move grid-occ(31)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0              
                exit paragraph
             end-if
        end-if

        if grid-occ(32) <> spaces
             move rez-no         to kelime
             move grid-occ(32)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if   
    
        if grid-occ(34) <> spaces
           move rez-telefon-no         to kelime
           move grid-occ(34)   to aranan-kelime
           move 0 to aranan-i aranan-kelime-boy
           inspect aranan-kelime tallying aranan-kelime-boy
                   for trailing spaces 
           compute aranan-kelime-boy = function length(aranan-kelime) -
                                       aranan-kelime-boy

           inspect kelime tallying aranan-i 
                   for all aranan-kelime(1:aranan-kelime-boy)
           if aranan-i = 0 
              exit paragraph
           end-if
        end-if       
         
        if grid-occ(35) <> spaces
           move rez-telefon-no         to kelime
           move grid-occ(34)   to aranan-kelime
           move 0 to aranan-i aranan-kelime-boy
           inspect aranan-kelime tallying aranan-kelime-boy
                   for trailing spaces 
           compute aranan-kelime-boy = function length(aranan-kelime) -
                                       aranan-kelime-boy

           inspect kelime tallying aranan-i 
                   for all aranan-kelime(1:aranan-kelime-boy)
           if aranan-i = 0 
              exit paragraph
           end-if
        end-if       
         
 
        initialize cast-rec 
        move rez-gir-tar to cast-tarih
        move rez-no      to cast-rez-no
        read cast no lock invalid 
            exit paragraph 
        not invalid 
             if cast-share = 0 or spaces
                if yan-ciksin not = 1
                   add 1             to gel-toplam
                   add cast-buyuk    to gel-toplam-buyuk
                   add cast-kucuk    to gel-toplam-kucuk
                   add cast-free     to gel-toplam-free
                   add cast-bebek    to gel-toplam-bebek
                   add kac-gece      to top-kac-gece
                else
                   if yanrez-sirano = 1
                      add 1             to gel-toplam
                      add cast-buyuk    to gel-toplam-buyuk
                      add cast-kucuk    to gel-toplam-kucuk
                      add cast-free     to gel-toplam-free
                      add cast-bebek    to gel-toplam-bebek
                      add kac-gece      to top-kac-gece
                   end-if 
                end-if  
             end-if 
        end-read 
        modify gd-1, RECORD-TO-ADD(gd1-rec)
        modify gd-1(kayit-adet + 2,1) hidden-data = rez-no
        modify gd-1(kayit-adet + 2,2) hidden-data = rez-folio
        if rez-dev-uye-no   > 0
            modify gd-1(kayit-adet + 2) row-color = dev-renk 
        end-if  
        if cin-odalar-dahil = 1 and rez-c-in = "E"
            modify gd-1(kayit-adet + 2) row-color = 112 
        end-if

        if yanrez-sirano > 1
            modify gd-1(kayit-adet + 2) row-color = 257          
        end-if                                           

         if rez-vip not = "N" and  
            rez-vip not = " "
            modify gd-1(kayit-adet + 2) row-color = 385          
         else
            if rez-gr-olabilir = 1
               modify gd-1(kayit-adet + 2) row-color = 480          
            end-if 
         end-if  

         perform hucre-renk-bul
         if hucre-renk > 0
            modify gd-1(kayit-adet + 2,2) cell-color = hucre-renk
         end-if

        add 1                   to kayit-adet 
        
        initialize takas-rec
        move kayit-adet         to takas-anah
        move gd1-rec            to takas-ana-rec
        write takas-rec invalid  
             continue 
        end-write.
*
 git-cagir.
     open input rez acenta kur cast firma
                kodlar02 konuk kllnc ozluk
                ulke yanrez doviz takvim konum  odalar
     initialize rez-rec gel-toplam yanrez-rec efiyat doviz-rec
                gel-toplam-buyuk 
                gel-toplam-kucuk 
                gel-toplam-free  
                gel-toplam-bebek  top-kac-gece kayit-adet
     move ilk-tarih    to rez-cik-tar
     move "I"          to rez-durumu
     start rez key not < rez-cik invalid
           continue
     not invalid
     perform with test after until fs-rez = "10"
     read rez next no lock end move "10"  to fs-rez
     not at end        
        if rez-durumu not = "I" 
           exit perform 
        end-if
        if rez-cik-tar > son-tarih 
           exit perform
        end-if
        if rez-k-g-b  not = "K"
           exit perform cycle
        end-if

        initialize konuk-rec
        move rez-folio     to konuk-folio 
        read konuk no lock invalid
             exit perform cycle
        not invalid
            if konuk-durumu = "H"
                exit perform cycle 
            end-if
        end-read

        initialize ozluk-rec 
        move konuk-folio to ozluk-folio 
        read ozluk no lock invalid
             continue
        end-read 
         if onkpara-referans-var = 1 then 
            perform ref-filtre
            if  not ref-gecti then 
               exit perform cycle
          end-if
        end-if 


        if yan-ciksin = 1
        initialize yanrez-rec
        move rez-no to yanrez-rezno
        start yanrez key not < yanrez-anah invalid 
             continue 
        not invalid 
        perform with test after until fs-yanrez = "10"
        read yanrez next no lock end move "10"  to fs-yanrez 
        not at end
              if yanrez-rezno <> rez-no
                  exit perform 
              end-if 
           
                  move yanrez-adi    to rez-adi
                  move yanrez-soyadi to rez-soyadi

                  perform gitrez-tum-detaylar
               
        end-read
        end-perform
        end-start           
        else         
          move 1 to yanrez-sirano 
          perform gitrez-tum-detaylar
        end-if 
       
             

     end-read
     end-perform
     end-start
     close rez acenta kur konum kllnc kodlar02 cast takvim odalar
           ulke yanrez doviz konuk firma ozluk
     modify gd-3,
            mass-update = 0
     display acc-99 acc-100 acc-98 acc-97 acc-96 acc-95.
*
 gitrez-tum-detaylar.
        if yanrez-sirano = 1
          perform toplam-rez-tutar
        end-if
        initialize gd3-rec 
        move rez-no      to gd-3-col-32
        if rez-grup-no > 0
                    move rez-grup-no to gd-3-col-19
        end-if
        move rez-adi     to gd-3-col-2
        move rez-soyadi  to gd-3-col-3
        initialize acenta-rec
        move rez-acenta  to acenta-kodu
        read acenta no lock invalid
             move "Tanimsiz..."     to gd-3-col-4
        not invalid
            move acenta-adi     to gd-3-col-4
        end-read

        move rez-gir-gun        to gd-3-col-5(1:2)
        move "/"                to gd-3-col-5(3:1)
        move rez-gir-ay         to gd-3-col-5(4:2)       
        move "/"                to gd-3-col-5(6:1)
        move rez-gir-yil        to gd-3-col-5(7:4)  

        move rez-cik-gun        to gd-3-col-6(1:2)
        move "/"                to gd-3-col-6(3:1)
        move rez-cik-ay         to gd-3-col-6(4:2)
        move "/"                to gd-3-col-6(6:1)
        move rez-cik-yil        to gd-3-col-6(7:4)  
        if yanrez-sirano = 1
        move rez-buyuk          to ydk-buyuk
        move ydk-buyuk          to gd-3-col-7
        move rez-kucuk          to ydk-kucuk
        move ydk-kucuk          to gd-3-col-8
        move rez-free           to ydk-fre
        move ydk-fre            to gd-3-col-9
        move rez-bebek          to ydk-bebe
        move ydk-bebe           to gd-3-col-10
        move rez-voucher        to gd-3-col-11

        initialize konum-rec
        move rez-oda-konumu     to konum-anahtar
        read konum no lock invalid
              move "Hata"       to konum-adi
        end-read 
              move konum-adi    to gd-3-col-12(1:6)
              move "-"          to gd-3-col-12(7:1)
        initialize konum-rec
        move rez-fiyat-konumu     to konum-anahtar
        read konum no lock invalid
              move "Hata"       to konum-adi
        end-read 
              move konum-adi    to gd-3-col-12(8:)
        if rez-firma not = spaces 
           initialize firma-rec
           move rez-firma           to firma-kodu
           read firma no lock invalid
                move "Tanimsiz..."  to firma-adi
           end-read 
                move firma-adi      to gd-3-col-13
        end-if 
        move REZ-GEL-SAAT           to gd-3-col-14
        move REZ-GEL-dak            to gd-3-col-15
        move rez-git-saat           to gd-3-col-16
        move rez-git-dak            to gd-3-col-17
        initialize ulke-rec
        move rez-ulke           to ulke-anah1 
        read ulke no lock invalid
             move "Tanimsiz...."      to gd-3-col-18
        not invalid
            move ulke-adi             to gd-3-col-18        
        end-read
       end-if 
        move rez-odano                 to o-kisa 
            perform oda-uzat
            move o-uzun to  gd-3-col-1
        if yanrez-sirano = 1
                initialize doviz-rec
                move rez-doviz                to doviz-kodu
                read doviz no lock invalid
                     move "Tanimsiz Doviz Kodu" to gd-3-col-20
                end-read
                move d-adi-1                  to gd-3-col-20
                move rez-fiyati               to efiyat
                move efiyat                   to gd-3-col-21
                move doviz-alis              to zkur
                move zkur                    to gd-3-col-22
                move rez-not1                 to gd-3-col-23
                move rez-not2                 to gd-3-col-24
        end-if 
        move konuk-folio              to gd-3-col-25 
        if yanrez-sirano = 1
        perform geceleme-bul
        move kac-gece                 to z3
        move z3                       to gd-3-col-26
        move rez-al-gun               to gd-3-col-27(1:2)
        move "/"                      to gd-3-col-27(3:1)
        move rez-al-ay                to gd-3-col-27(4:2)
        move "/"                      to gd-3-col-27(6:1)
        move rez-al-yil               to gd-3-col-27(7:4)
        move toplam-cast-fiyati       to z-15
        move z-15                     to gd-3-col-28
        move toplam-dv                to z-15
        move z-15                     to gd-3-col-29
        perform kllnc-oku
        move k-adi                    to gd-3-col-30

        initialize kodlar02-rec
        move "A"                      to kodlar02-tipi
        move rez-pan-tipi             to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Hata"              to kodlar02-adi
        end-read 
             move kodlar02-adi        to gd-3-col-31
        end-if
        if konuk-telefon-no <> spaces 
           move konuk-telefon-no      to rez-telefon-no
        end-if
        move ozluk-plaka              to gd-3-col-33
        move rez-telefon-no           to gd-3-col-34

        initialize kodlar02-rec                                     |firat pazar kolonu ekleme 10/08/2020
        move "E"       to kodlar02-tipi
        move rez-pazar to kodlar02-kodu
        read kodlar02 no lock invalid 
             move rez-pazar to kodlar02-adi
        end-read
        move kodlar02-adi              to gd-3-col-35

           initialize kodlar02-rec
           move "v"      to kodlar02-tipi
           move rez-vip  to kodlar02-kodu
           read kodlar02 no lock invalid
               initialize kodlar02-rec
           end-read
           move kodlar02-adi to gd-3-col-40

        if konuk-late-zaman > 0                                         |firat late cout kolonu  12/08/2020
           move konuk-late-gel-saat   to gd-3-col-36(1:)
           move ":"                   to gd-3-col-36(3:)
           move konuk-late-gel-dak    to gd-3-col-36(4:)
        end-if

        initialize odalar-rec             |firat oda durum kolonu  12/08/2020
        move konuk-odano to odalar-anah
        read odalar no lock invalid
             continue
        end-read 
        initialize kodlar02-rec                                     
        move "C"                to kodlar02-tipi
        move odalar-durumu      to kodlar02-kodu
        read kodlar02 no lock invalid 
             move odalar-durumu to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-3-col-37

        initialize kodlar02-rec                                     
        move "B"                to kodlar02-tipi
        move konuk-odeme-tipi   to kodlar02-kodu
        read kodlar02 no lock invalid 
             move "Tanimsiz"    to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-3-col-39

        if grid-occ(2) <> spaces
             move function upper-case(rez-adi) to kelime
             move function upper-case(grid-occ(2))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 

                exit paragraph
             end-if
        end-if

        if grid-occ(3) <> spaces
             move function upper-case(rez-soyadi)   to kelime
             move function upper-case(grid-occ(3))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 


                exit paragraph
             end-if
        end-if

        if grid-occ(4) <> spaces  
             initialize acenta-rec 
             move rez-acenta   to acenta-kodu
             read acenta no lock invalid
                  move "Tanimsiz..."  to acenta-adi
             not invalid
                 move acenta-adi      to ydk-acenta-adi
             end-read
             move function upper-case(ydk-acenta-adi) to kelime
             move function upper-case(grid-occ(4))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                 

                exit paragraph
             end-if
        end-if
        if grid-occ(5) <> spaces
             move gd-3-col-5        to kelime
             move grid-occ(5)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
             
                exit paragraph
             end-if
        end-if
        if grid-occ(6) <> spaces
             move gd-3-col-6        to kelime
             move grid-occ(6)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
               exit paragraph
             end-if
        end-if
        if grid-occ(7) <> spaces
             move rez-buyuk        to kelime
             move grid-occ(7)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
             
               exit paragraph
             end-if
        end-if
        if grid-occ(8) <> spaces
             move rez-kucuk        to kelime
             move grid-occ(8)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                 exit paragraph
             end-if
        end-if
        if grid-occ(9) <> spaces
             move rez-free        to kelime
             move grid-occ(9)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(10) <> spaces
             move rez-bebek        to kelime
             move grid-occ(10)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(11) <> spaces         
             move function upper-case(rez-voucher) to kelime
             move function upper-case(grid-occ(11))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(12) <> spaces         
             initialize konum-rec
             move rez-oda-konumu           to konum-anahtar
             read konum no lock invalid 
                  continue 
             end-read 
             move function upper-case(konum-adi) to kelime
             move function upper-case(grid-occ(12))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(13) <> spaces 
             initialize firma-rec  ydk-firma-adi
             move rez-firma           to firma-kodu
             read firma no lock invalid
                  move "Tanimsiz..."  to firma-adi
             not invalid
                 move firma-adi       to ydk-firma-adi
             end-read
             move function upper-case(ydk-firma-adi) to kelime
             move function upper-case(grid-occ(13))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0                 
                exit paragraph
             end-if
        end-if
        if grid-occ(14) <> spaces         
             move rez-gel-saat   to kelime
             move grid-occ(14)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if

        if grid-occ(15) <> spaces         
             move rez-gel-dak      to kelime
             move grid-occ(15)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(16) <> spaces         
             move rez-git-saat   to kelime
             move grid-occ(16)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(17) <> spaces         
             move rez-git-dak      to kelime
             move grid-occ(17)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(18) <> spaces
             initialize ulke-rec 
             move rez-ulke         to ulke-anah
             read ulke no lock invalid
                  move "   "       to ulke-adi
             end-read 
             move ulke-adi         to kelime
             move grid-occ(18)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(1) <> spaces
             move rez-odano         to o-kisa 
            perform oda-uzat
            move o-uzun to  kelime
             move grid-occ(1)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(19) <> spaces
             move rez-grup-no        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(19)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               
                exit paragraph
             end-if
        end-if
        if grid-occ(20) <> spaces
             initialize doviz-rec
             move rez-doviz        to doviz-kodu
             read doviz no lock invalid 
                  move "  "        to D-KISA-ADI
             end-read 
             move D-KISA-ADI        to kelime
             move grid-occ(20)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if        

        if grid-occ(21) <> spaces
             move rez-fiyati        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(21)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if


        if grid-occ(23) <> spaces
             move rez-not1        to kelime
             move grid-occ(23)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(24) <> spaces
             move rez-not2        to kelime
             move grid-occ(24)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if 
        if grid-occ(31) <> spaces
             initialize kodlar02-rec
             move rez-pan-tipi      to kodlar02-kodu
             move "A"               to kodlar02-tipi
             read kodlar02 no lock invalid
                  continue 
             end-read 
             move function upper-case(kodlar02-adi)          to kelime
             move grid-occ(31)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0              
                exit paragraph
             end-if
        end-if
        if grid-occ(32) <> spaces
             move rez-no        to kelime
             move grid-occ(32)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 

                exit paragraph 
                
             end-if
        end-if
        if grid-occ(33) <> spaces
             move ozluk-plaka    to kelime
             move grid-occ(33)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 

                exit paragraph 
                
             end-if
        end-if
        if grid-occ(34) <> spaces
             move rez-telefon-no to kelime
             move grid-occ(34)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph 
                
             end-if
        end-if
        initialize cast-rec 
        move rez-cik-tar to cast-tarih
        move rez-no      to cast-rez-no
        read cast no lock invalid 
             exit paragraph 
        not invalid
              if cast-share = 0 or spaces
                if yan-ciksin not = 1
                add 1            to gel-toplam
                add cast-buyuk    to gel-toplam-buyuk
                add cast-kucuk    to gel-toplam-kucuk
                add cast-free     to gel-toplam-free
                add cast-bebek    to gel-toplam-bebek
                add kac-gece     to top-kac-gece
                else
                if yanrez-sirano = 1
                add 1            to gel-toplam
                add cast-buyuk    to gel-toplam-buyuk
                add cast-kucuk    to gel-toplam-kucuk
                add cast-free     to gel-toplam-free
                add cast-bebek    to gel-toplam-bebek
                add kac-gece     to top-kac-gece

                end-if 
                end-if               
              end-if
        end-read 

        modify gd-3, RECORD-TO-ADD(gd3-rec)
        modify gd-3(kayit-adet + 2,1) hidden-data = rez-no 
        modify gd-3(kayit-adet + 2,2) hidden-data = rez-folio
        if rez-dev-uye-no   > 0
           modify gd-3(kayit-adet + 2) row-color = dev-renk 
        end-if
        if yanrez-sirano > 1
           modify gd-3(kayit-adet + 2) row-color = 257          
        end-if 

         if rez-vip not = "N" and  
            rez-vip not = " "
            modify gd-3(kayit-adet + 2) row-color = 385          
         else
            if rez-gr-olabilir = 1
               modify gd-3(kayit-adet + 2) row-color = 480          
            end-if 
         end-if

        add 1                   to kayit-adet.

*
 cin-cagir.
     open input konuk acenta takvim odalar   
     initialize konuk-rec gel-toplam kayit-adet
     move "I"         to konuk-durumu
     move ilk-tarih   to konuk-gel-tar         
     start konuk key not < konuk-gel invalid 
           continue
     not invalid
     perform until fs-konuk = "10"
     read konuk next no lock end move "10" to fs-konuk
     not at end
        if konuk-durumu not = "I" and 
           konuk-gel-tar <= son-tarih and
           konuk-gel-tar >= ilk-tarih 
           exit perform cycle
        end-if

         move konuk-oda-konumu   to rez-oda-konumu 
         move konuk-fiyat-konumu to rez-fiyat-konumu  
         move konuk-odano to rez-odano

         if onkpara-referans-var = 1 then 
            perform ref-filtre
            if  not ref-gecti then 
               exit perform cycle
          end-if
        end-if

        add 1               to gel-toplam
        move konuk-rez-no   to gd-1-col-1
        move konuk-adi      to gd-1-col-2
        move konuk-soyadi   to gd-1-col-3
        initialize acenta-rec
        move konuk-acenta  to acenta-kodu
        read acenta no lock invalid
             move "Tanimsiz..."     to gd-1-col-4
        not invalid
            move acenta-adi     to gd-1-col-4
        end-read
        move konuk-gel-gun        to gd-1-col-5(1:2)
        move "/"                to gd-1-col-5(3:1)
        move konuk-gel-ay         to gd-1-col-5(4:2)
        move "/"                to gd-1-col-5(6:1)
        move konuk-gel-yil        to gd-1-col-5(7:4)  

        move konuk-git-gun        to gd-1-col-6(1:2)
        move "/"                to gd-1-col-6(3:1)
        move konuk-git-ay         to gd-1-col-6(4:2)
        move "/"                to gd-1-col-6(6:1)
        move konuk-git-yil        to gd-1-col-6(7:4)  

        modify gd-1, RECORD-TO-ADD(gd1-rec)
        if rez-dev-uye-no   > 0
           modify gd-1(kayit-adet + 2) row-color = dev-renk 
        end-if
     end-read
     end-perform
     end-start
     close konuk acenta takvim odalar.
     display acc-99 acc-100 acc-98 acc-97
     modify gd-1,
            mass-update = 0.   

*
 inhose-cagir.
     open input konuk acenta kur cast takvim
                ulke kodlar02 yanrez kllnc ozluk
                rez doviz odalar firma konum  

     initialize konuk-rec gel-toplam gel-toplam-buyuk gel-toplam-kucuk gel-toplam-free 
                ulke-rec yanrez-rec rez-rec doviz-rec gel-toplam-bebek  top-kac-gece   kayit-adet
     move "I"         to konuk-durumu
     start konuk key not < konuk-oda invalid 
           continue
     not invalid
     perform until fs-konuk = "10"
     read konuk next no lock end move "10" to fs-konuk
     not at end
        if konuk-durumu not = "I"
           exit perform cycle
        end-if

        if KONUK-FOL-KODU = "E" 
           exit perform cycle
        end-if
        if gitme-gosterme = 1 
           if konuk-git-tar = tarih-tasi 
              exit perform cycle 
           end-if 
        end-if 
         move konuk-oda-konumu   to rez-oda-konumu 
         move konuk-fiyat-konumu to rez-fiyat-konumu  
         move konuk-odano to rez-odano

         if onkpara-referans-var = 1 then 
            perform ref-filtre
            if  not ref-gecti then 
               exit perform cycle
          end-if
        end-if 
        if konuk-rez-no > 0
           initialize rez-rec
           move konuk-rez-no     to rez-no
           read rez no lock invalid 
               continue 
           end-read 
        end-if 


        if yan-ciksin = 1
        initialize yanrez-rec
        move rez-no to yanrez-rezno
        start yanrez key not < yanrez-anah invalid 
             continue 
        not invalid 
        perform with test after until fs-yanrez = "10"
        read yanrez next no lock end move "10"  to fs-yanrez 
        not at end
              if yanrez-rezno <> rez-no
                  exit perform 
              end-if 
           
                  move yanrez-adi    to konuk-adi YEDEK-rez-adi
                  move yanrez-soyadi to konuk-soyadi YEDEK-rez-soyadi

                  perform inhouse-tumdetaylar
               
        end-read
        end-perform
        end-start   
        else
           move 1 to yanrez-sirano
           move  konuk-adi TO YEDEK-rez-adi
           move  konuk-soyadi TO YEDEK-rez-soyadi
           perform inhouse-tumdetaylar
        end-if 
     
     end-read
     end-perform
     end-start
     close konuk acenta cast kur
           ulke kodlar02 takvim
           yanrez rez  kllnc ozluk
           doviz odalar firma konum


     modify gd-2,
            mass-update = 0
     display acc-99 acc-100 acc-98 acc-97 acc-96 acc-95. 
*
 inhouse-tumdetaylar.
        if yanrez-sirano = 1
          perform toplam-rez-tutar
        end-if 
        initialize gd2-rec
        move konuk-rez-no   to gd-2-col-32
        if konuk-grup-no > 0
           move konuk-grup-no to gd-2-col-19
        end-if

        initialize ozluk-rec filtre-ozluk-plaka
        move konuk-folio    to ozluk-folio
        read ozluk no lock invalid 
            continue 
        not invalid 
           move ozluk-plaka    to gd-2-col-33 filtre-ozluk-plaka
        end-read 
        
        move konuk-adi      to gd-2-col-2
        move konuk-soyadi   to gd-2-col-3
        initialize acenta-rec
        move konuk-acenta  to acenta-kodu
        read acenta no lock invalid
             move "Tanimsiz..."     to gd-2-col-4
        not invalid
            move acenta-adi     to gd-2-col-4
        end-read
        move konuk-gel-gun      to gd-2-col-5(1:2)
        move "/"                to gd-2-col-5(3:1)
        move konuk-gel-ay       to gd-2-col-5(4:2)
        move "/"                to gd-2-col-5(6:1)
        move konuk-gel-yil      to gd-2-col-5(7:4)  

        move konuk-git-gun      to gd-2-col-6(1:2)
        move "/"                to gd-2-col-6(3:1)
        move konuk-git-ay       to gd-2-col-6(4:2)
        move "/"                to gd-2-col-6(6:1)
        move konuk-git-yil      to gd-2-col-6(7:4)
        if yanrez-sirano = 1
             move konuk-buyuk        to ydk-buyuk
             move ydk-buyuk          to gd-2-col-7
             move konuk-kucuk        to ydk-kucuk
             move ydk-kucuk          to gd-2-col-8
             move konuk-free         to ydk-fre
             move ydk-fre            to gd-2-col-9
             move konuk-bebek        to ydk-bebe
             move ydk-bebe           to gd-2-col-10
             move konuk-voucher      to gd-2-col-11    
        
             initialize konum-rec
             move rez-oda-konumu     to konum-anahtar
             read konum no lock invalid
                   move "Hata"       to konum-adi
             end-read 
                   move konum-adi    to gd-2-col-12(1:6)
                   move "-"          to gd-2-col-12(7:1)
             initialize konum-rec
             move rez-fiyat-konumu     to konum-anahtar
             read konum no lock invalid
                   move "Hata"       to konum-adi
             end-read 
                   move konum-adi    to gd-2-col-12(8:)
        end-if
        if konuk-firma not = spaces 
           initialize firma-rec 
           move konuk-firma                to firma-kodu
           read firma no lock invalid
                move "Tanimsiz...."        to firma-adi
           end-read 
                move firma-adi             to gd-2-col-13
        end-if 
        if yanrez-sirano = 1
        move konuk-GEL-SAAT           to gd-2-col-14
        move konuk-GEL-dakika         to gd-2-col-15
        move konuk-git-saat           to gd-2-col-16
        move konuk-git-dakika         to gd-2-col-17

        initialize ulke-rec
        move konuk-ulke               to ulke-anah1 
        read ulke no lock invalid
             move "Tanimsiz...."      to gd-2-col-18
        not invalid
            move ulke-adi             to gd-2-col-18        
        end-read
        end-if 
        move konuk-odano               to o-kisa 
            perform oda-uzat
            move o-uzun to  gd-2-col-1
        if yanrez-sirano = 1
            initialize doviz-rec
        move konuk-doviz              to doviz-kodu
        read doviz no lock invalid
             move "Tanimsiz Doviz Kodu..."  to gd-2-col-20
        end-read
          move d-adi-1                 to gd-2-col-20

        move konuk-dv-degeri           to efiyat
        move efiyat                    to gd-2-col-21
*        move konuk-grup-no             to gd-2-col-22
        move doviz-alis              to zkur
        move zkur                    to gd-2-col-22
        move konuk-acik-1              to gd-2-col-23
        move konuk-acik-2              to gd-2-col-24
        end-if
        move konuk-folio               to gd-2-col-25

        move konuk-telefon-no      to gd-2-col-34

        initialize rez-rec 
        move konuk-rez-no          to rez-no
        read rez no lock invalid
              continue 
        end-read 

       


        if yanrez-sirano = 1
        perform geceleme-bul
        move kac-gece                 to z3
        move z3                       to gd-2-col-26
        end-if
        move rez-al-gun               to gd-2-col-27(1:2)
        move "/"                      to gd-2-col-27(3:1)
        move rez-al-ay                to gd-2-col-27(4:2)
        move "/"                      to gd-2-col-27(6:1)
        move rez-al-yil               to gd-2-col-27(7:4)
        if yanrez-sirano = 1
        move toplam-cast-fiyati       to z-15
        move z-15                     to gd-2-col-28
        move toplam-dv                to z-15
        move z-15                     to gd-2-col-29
        end-if
        perform kllnc-oku
        move k-adi                    to gd-2-col-30
        if yanrez-sirano = 1
        initialize kodlar02-rec
        move "A"                      to kodlar02-tipi
        move rez-pan-tipi             to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Hata"              to kodlar02-adi
        end-read 
             move kodlar02-adi        to gd-2-col-31
        end-if

        initialize kodlar02-rec                                     |firat pazar kolonu ekleme 10/08/2020
        move "E"       to kodlar02-tipi
        move rez-pazar to kodlar02-kodu
        read kodlar02 no lock invalid 
             move rez-pazar to kodlar02-adi
        end-read
        move kodlar02-adi              to gd-2-col-35

           initialize kodlar02-rec
           move "v"      to kodlar02-tipi
           move rez-vip  to kodlar02-kodu
           read kodlar02 no lock invalid
               initialize kodlar02-rec
           end-read
           move kodlar02-adi to gd-2-col-40

        if konuk-late-zaman > 0                                         |firat late cout kolonu  12/08/2020
           move konuk-late-gel-saat   to gd-2-col-36(1:)
           move ":"                   to gd-2-col-36(3:)
           move konuk-late-gel-dak    to gd-2-col-36(4:)
        end-if

        initialize odalar-rec             |firat oda durum kolonu  12/08/2020
        move konuk-odano to odalar-anah
        read odalar no lock invalid
             continue
        end-read 
        initialize kodlar02-rec                                     
        move "C"                to kodlar02-tipi
        move odalar-durumu      to kodlar02-kodu
        read kodlar02 no lock invalid 
             move odalar-durumu to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-2-col-37

        initialize kodlar02-rec                                     
        move "B"                to kodlar02-tipi
        move rez-odeme-tipi     to kodlar02-kodu
        read kodlar02 no lock invalid 
             move "Tanimsiz."   to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-2-col-38

        if grid-occ(32) <> spaces
             move rez-no        to kelime
             move grid-occ(32)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 


                exit paragraph
             end-if
        end-if

        if grid-occ(34) <> spaces
             move konuk-telefon-no        to kelime
             move grid-occ(34)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 


                exit paragraph
             end-if
        end-if

        
           if grid-occ(33) <> spaces            
                move filtre-ozluk-plaka to kelime
                move grid-occ(33)       to aranan-kelime
                move 0 to aranan-i aranan-kelime-boy
                inspect aranan-kelime tallying aranan-kelime-boy
                        for trailing spaces 
                compute aranan-kelime-boy = function length(aranan-kelime) -
                                            aranan-kelime-boy
        
                inspect kelime tallying aranan-i 
                        for all aranan-kelime(1:aranan-kelime-boy)
                if aranan-i = 0         
                   exit paragraph
                end-if
           end-if 

        if grid-occ(2) <> spaces
             move function upper-case(YEDEK-rez-adi) to kelime
             move function upper-case(grid-occ(2))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 

                exit paragraph
             end-if
        end-if

        if grid-occ(3) <> spaces
             move function upper-case(YEDEK-rez-SOYadi)   to kelime
             move function upper-case(grid-occ(3))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(4) <> spaces  
             initialize acenta-rec 
             move rez-acenta   to acenta-kodu
             read acenta no lock invalid
                  move "Tanimsiz..."  to acenta-adi
             not invalid
                 move acenta-adi      to ydk-acenta-adi
             end-read
             move function upper-case(ydk-acenta-adi) to kelime
             move function upper-case(grid-occ(4))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                

                exit paragraph
             end-if
        end-if
        if grid-occ(5) <> spaces
             move gd-2-col-5        to kelime
             move grid-occ(5)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               

                exit paragraph
             end-if
        end-if
        if grid-occ(6) <> spaces
             move gd-2-col-6        to kelime
             move grid-occ(6)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
             
                exit paragraph
             end-if
        end-if
        if grid-occ(7) <> spaces
             move rez-buyuk        to kelime
             move grid-occ(7)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                

                exit paragraph
             end-if
        end-if
        if grid-occ(8) <> spaces
             move rez-kucuk        to kelime
             move grid-occ(8)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              exit paragraph
             end-if
        end-if
        if grid-occ(9) <> spaces
             move rez-free        to kelime
             move grid-occ(9)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(10) <> spaces
             move rez-bebek        to kelime
             move grid-occ(10)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               

                exit paragraph
             end-if
        end-if
        if grid-occ(11) <> spaces         
             move function upper-case(rez-voucher) to kelime
             move function upper-case(grid-occ(11))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
             

                exit paragraph
             end-if
        end-if
        if grid-occ(12) <> spaces         
             initialize konum-rec
             move rez-oda-konumu           to konum-anahtar
             read konum no lock invalid 
                  continue 
             end-read 
             move function upper-case(konum-adi) to kelime
             move function upper-case(grid-occ(12))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if         
        if grid-occ(13) <> spaces
             if konuk-firma = spaces
                 exit paragraph 
             end-if 
             if konuk-firma not = spaces             
                initialize firma-rec ydk-firma-adi
                move konuk-firma   to firma-kodu
                read firma no lock invalid
                     move "Tanimsiz..."  to firma-adi
                not invalid
                    move firma-adi      to ydk-firma-adi
                end-read
                move function upper-case(ydk-firma-adi) to kelime
                move function upper-case(grid-occ(13))  to aranan-kelime
                move 0 to aranan-i aranan-kelime-boy
                inspect aranan-kelime tallying aranan-kelime-boy
                        for trailing spaces 
                compute aranan-kelime-boy = function length(aranan-kelime) -
                                            aranan-kelime-boy
                
                inspect kelime tallying aranan-i 
                        for all aranan-kelime(1:aranan-kelime-boy)
                if aranan-i = 0 
                  exit paragraph
                end-if
            end-if 
        end-if
        if grid-occ(14) <> spaces         
             move rez-gel-saat   to kelime
             move grid-occ(14)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               
                exit paragraph
             end-if
        end-if

        if grid-occ(15) <> spaces         
             move rez-gel-dak      to kelime
             move grid-occ(15)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               

                exit paragraph
             end-if
        end-if

        if grid-occ(16) <> spaces         
             move rez-git-saat   to kelime
             move grid-occ(16)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               

                exit paragraph
             end-if
        end-if

        if grid-occ(17) <> spaces         
             move rez-git-dak      to kelime
             move grid-occ(17)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                

                exit paragraph
             end-if
        end-if
        if grid-occ(18) <> spaces
             initialize ulke-rec 
             move rez-ulke         to ulke-anah
             read ulke no lock invalid
                  move "   "       to ulke-adi
             end-read 
             move ulke-adi         to kelime
             move grid-occ(18)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
               exit paragraph
             end-if
        end-if

        if grid-occ(1) <> spaces
             move rez-odano         to o-kisa 
            perform oda-uzat
            move o-uzun to  kelime
             move grid-occ(1)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               

                exit paragraph
             end-if
        end-if
        if grid-occ(20) <> spaces
             initialize doviz-rec
             move rez-doviz        to doviz-kodu
             read doviz no lock invalid 
                  move "  "        to D-KISA-ADI
             end-read 
             move D-KISA-ADI        to kelime
             move grid-occ(20)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if        

        if grid-occ(21) <> spaces
             move rez-fiyati        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(21)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0               
                exit paragraph
             end-if
        end-if
        if grid-occ(19) <> spaces
             move rez-grup-no        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(19)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if
        if grid-occ(23) <> spaces
             move rez-not1        to kelime
             move grid-occ(23)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               

                exit paragraph
             end-if
        end-if
        if grid-occ(24) <> spaces
             move rez-not2        to kelime
             move grid-occ(24)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0                
                exit paragraph
             end-if
        end-if
        if grid-occ(31) <> spaces
             initialize kodlar02-rec
             move rez-pan-tipi      to kodlar02-kodu
             move "A"               to kodlar02-tipi
             read kodlar02 no lock invalid
                  continue 
             end-read 
             move function upper-case(kodlar02-adi)          to kelime
             move grid-occ(31)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0              
                exit paragraph
             end-if
        end-if
        initialize cast-rec
        move tarih-tasi     to cast-tarih
        move konuk-rez-no   to cast-rez-no
        read cast no lock invalid 
             exit paragraph 
        not invalid 
            if cast-share = 0 or spaces
                if yan-ciksin not = 1
                add 1            to gel-toplam
                add cast-buyuk    to gel-toplam-buyuk
                add cast-kucuk    to gel-toplam-kucuk
                add cast-free     to gel-toplam-free
                add cast-bebek    to gel-toplam-bebek
                add kac-gece     to top-kac-gece
                else
                if yanrez-sirano = 1
                add 1            to gel-toplam
                add cast-buyuk    to gel-toplam-buyuk
                add cast-kucuk    to gel-toplam-kucuk
                add cast-free     to gel-toplam-free
                add cast-bebek    to gel-toplam-bebek
                add kac-gece     to top-kac-gece

                end-if 
                end-if                
            end-if 
        end-read 

        modify gd-2, RECORD-TO-ADD(gd2-rec)
        modify gd-2(kayit-adet + 2,1) hidden-data = konuk-rez-no
        modify gd-2(kayit-adet + 2,2) hidden-data = konuk-folio
        if rez-dev-uye-no   > 0
        modify gd-2(kayit-adet + 2) row-color = dev-renk 
        end-if
        if yanrez-sirano   > 1
        modify gd-2(kayit-adet + 2) row-color = 257 
        end-if

         if rez-vip not = "N" and  
            rez-vip not = " "
            modify gd-2(kayit-adet + 2) row-color = 385          
         else
            if rez-gr-olabilir = 1
               modify gd-2(kayit-adet + 2) row-color = 480          
            end-if 
         end-if

        add 1                   to kayit-adet. 

     .    
*
 gercin-cagir.
     open input konuk acenta cast kllnc ozluk
                ulke kodlar02 kur yanrez takvim
                rez doviz odalar firma konum 
     initialize konuk-rec ulke-rec yanrez-rec rez-rec doviz-rec 
     if flag = "I" 
        initialize gel-toplam-bebek top-kac-gece kayit-adet gel-toplam 
        gel-toplam-buyuk gel-toplam-kucuk gel-toplam-free
     end-if                   
     move flag        to konuk-durumu       | firat history cinler ciksin
*     move "I"         to konuk-durumu       
     move ilk-tarih   to konuk-gel-tar
     start konuk key not < konuk-gel invalid 
           continue
     not invalid
     perform until fs-konuk = "10"
     read konuk next no lock end move "10" to fs-konuk
     not at end
*        if konuk-durumu not = "I"
*           exit perform 
*        end-if

        if konuk-durumu not = flag            | firat history cinler cikmiyordu
           exit perform 
        end-if

        if konuk-gel-tar > son-tarih
           exit perform cycle        
        end-if

        if KONUK-FOL-KODU = "E" 
           exit perform cycle
        end-if
         move konuk-oda-konumu   to rez-oda-konumu 
         move konuk-fiyat-konumu to rez-fiyat-konumu  
         move konuk-odano to rez-odano

         if onkpara-referans-var = 1 then 
            perform ref-filtre
            if  not ref-gecti then 
               exit perform cycle
          end-if
        end-if
        if konuk-rez-no > 0
           initialize rez-rec 
           move konuk-rez-no   to rez-no
           read rez no lock invalid 
                continue 
           end-read 
        end-if 
        
        initialize ozluk-rec 
        move konuk-folio to ozluk-folio 
        read ozluk no lock invalid
             continue
        end-read 

        if yan-ciksin = 1
        initialize yanrez-rec
        move rez-no to yanrez-rezno
        start yanrez key not < yanrez-anah invalid 
             continue 
        not invalid 
        perform with test after until fs-yanrez = "10"
        read yanrez next no lock end move "10"  to fs-yanrez 
        not at end
              if yanrez-rezno <> rez-no
                  exit perform 
              end-if 
           
                  move yanrez-adi    to konuk-adi rez-adi yedek-rez-adi
                  move yanrez-soyadi to konuk-soyadi  rez-soyadi yedek-rez-soyadi

                  perform gercin-tumdetaylar
               
        end-read
        end-perform
        end-start   
        else
        move konuk-adi to yedek-rez-adi
        move konuk-soyadi to yedek-rez-soyadi
           move 1 to yanrez-sirano
           perform gercin-tumdetaylar
        end-if 
           

     end-read
     end-perform
     end-start
     close konuk acenta kur ulke kllnc cast takvim
           kodlar02 yanrez firma konum odalar ozluk
           rez doviz.
     if flag = "H"                       || firat history cinler ciksin diye
        modify gd-4,
               mass-update = 0
     end-if
     display acc-99 acc-100 acc-98 acc-97 acc-96 acc-95.   
*
 gercin-tumdetaylar.
        if yanrez-sirano = 1
           perform toplam-rez-tutar
        end-if
        initialize gd4-rec
        move konuk-rez-no   to gd-4-col-32
        if konuk-grup-no > 0
                    move konuk-grup-no to gd-4-col-19
        end-if
        move konuk-adi      to gd-4-col-2
        move konuk-soyadi   to gd-4-col-3
        initialize acenta-rec
        move konuk-acenta  to acenta-kodu
        read acenta no lock invalid
             move "Tanimsiz..."     to gd-4-col-4
        not invalid
            move acenta-adi     to gd-4-col-4
        end-read
        move konuk-gel-gun      to gd-4-col-5(1:2)
        move "/"                to gd-4-col-5(3:1)
        move konuk-gel-ay       to gd-4-col-5(4:2)
        move "/"                to gd-4-col-5(6:1)
        move konuk-gel-yil      to gd-4-col-5(7:4)  

        move konuk-git-gun      to gd-4-col-6(1:2)
        move "/"                to gd-4-col-6(3:1)
        move konuk-git-ay       to gd-4-col-6(4:2)
        move "/"                to gd-4-col-6(6:1)
        move konuk-git-yil      to gd-4-col-6(7:4)
        if yanrez-sirano = 1
        move konuk-buyuk        to ydk-buyuk
        move ydk-buyuk          to gd-4-col-7
        move konuk-kucuk        to ydk-kucuk
        move ydk-kucuk          to gd-4-col-8
        move konuk-free         to ydk-fre
        move ydk-fre            to gd-4-col-9
        move konuk-bebek        to ydk-bebe
        move ydk-bebe           to gd-4-col-10
        move konuk-voucher      to gd-4-col-11

        initialize konum-rec
        move rez-oda-konumu     to konum-anahtar
        read konum no lock invalid
              move "Hata"       to konum-adi
        end-read 
              move konum-adi    to gd-4-col-12(1:6)
              move "-"          to gd-4-col-12(7:1)
        initialize konum-rec
        move rez-fiyat-konumu     to konum-anahtar
        read konum no lock invalid
              move "Hata"       to konum-adi
        end-read 
              move konum-adi    to gd-4-col-12(8:)
        end-if
        if konuk-firma not = spaces 
           initialize firma-rec 
           move konuk-firma              to firma-kodu
           read firma no lock invalid 
                 move "Tanimsiz..."      to firma-adi
           end-read 
                 move firma-adi          to gd-4-col-13
        end-if 
        if yanrez-sirano = 1
        move konuk-GEL-SAAT           to gd-4-col-14
        move konuk-GEL-dakika         to gd-4-col-15
        move konuk-git-saat           to gd-4-col-16
        move konuk-git-dakika         to gd-4-col-17
        initialize ulke-rec
        move konuk-ulke               to ulke-anah1 
        read ulke no lock invalid
             move "Tanimsiz...."      to gd-4-col-18
        not invalid
            move ulke-adi             to gd-4-col-18        
        end-read
        end-if
        move konuk-odano               to o-kisa 
            perform oda-uzat
            move o-uzun to  gd-4-col-1
        if yanrez-sirano = 1 
            initialize doviz-rec
        move konuk-doviz              to doviz-kodu
        read doviz no lock invalid
             move "Tanimsiz Doviz Kodu..."  to gd-4-col-20
        end-read
          move d-adi-1                 to gd-4-col-20
        
        move konuk-dv-degeri           to efiyat
        move efiyat                    to gd-4-col-21
*        move konuk-grup-no             to gd-4-col-22
        move doviz-alis                to zkur
        move zkur                      to gd-4-col-22
        move konuk-acik-1              to gd-4-col-23
        move konuk-acik-2              to gd-4-col-24
        end-if
        move konuk-folio               to gd-4-col-25

        initialize rez-rec 
        move konuk-rez-no          to rez-no
        read rez no lock invalid
              continue 
        end-read 
        perform geceleme-bul
        if yanrez-sirano = 1
        move kac-gece                 to z3
        move z3                       to gd-4-col-26
        end-if
        move rez-al-gun               to gd-4-col-27(1:2)
        move "/"                      to gd-4-col-27(3:1)
        move rez-al-ay                to gd-4-col-27(4:2)
        move "/"                      to gd-4-col-27(6:1)
        move rez-al-yil               to gd-4-col-27(7:4)
        if yanrez-sirano = 1 
        move toplam-cast-fiyati       to z-15
        move z-15                     to gd-4-col-28
        move toplam-dv                to z-15
        move z-15                     to gd-4-col-29
        perform kllnc-oku
        move k-adi                    to gd-4-col-30
        initialize kodlar02-rec
        move "A"                      to kodlar02-tipi
        move rez-pan-tipi             to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Hata"              to kodlar02-adi
        end-read 
             move kodlar02-adi        to gd-4-col-31
        end-if

        if konuk-telefon-no <> spaces 
           move konuk-telefon-no      to rez-telefon-no
        end-if
        move ozluk-plaka              to gd-4-col-33
        move rez-telefon-no           to gd-4-col-34             

        initialize kodlar02-rec                                     |firat pazar kolonu ekleme 10/08/2020
        move "E"       to kodlar02-tipi
        move rez-pazar to kodlar02-kodu
        read kodlar02 no lock invalid 
             move rez-pazar to kodlar02-adi
        end-read
        move kodlar02-adi              to gd-4-col-35

           initialize kodlar02-rec
           move "v"      to kodlar02-tipi
           move rez-vip  to kodlar02-kodu
           read kodlar02 no lock invalid
               initialize kodlar02-rec
           end-read
           move kodlar02-adi to gd-4-col-40

        if konuk-late-zaman > 0                                         |firat late cout kolonu  12/08/2020
           move konuk-late-gel-saat   to gd-4-col-36(1:)
           move ":"                   to gd-4-col-36(3:)
           move konuk-late-gel-dak    to gd-4-col-36(4:)
        end-if

        initialize odalar-rec             |firat oda durum kolonu  12/08/2020
        move konuk-odano to odalar-anah
        read odalar no lock invalid
             continue
        end-read 
        initialize kodlar02-rec                                     
        move "C"                to kodlar02-tipi
        move odalar-durumu      to kodlar02-kodu
        read kodlar02 no lock invalid 
             move odalar-durumu to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-4-col-37

        initialize kodlar02-rec                                     
        move "B"                to kodlar02-tipi
        move konuk-odeme-tipi   to kodlar02-kodu
        read kodlar02 no lock invalid 
             move "Tanimsiz."   to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-4-col-38

        if grid-occ(32) <> spaces
             move rez-no        to kelime
             move grid-occ(32)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 


                exit paragraph
             end-if
        end-if
        if grid-occ(33) <> spaces
             move ozluk-plaka        to kelime
             move grid-occ(33)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 


                exit paragraph
             end-if
        end-if
        if grid-occ(34) <> spaces
             move rez-telefon-no        to kelime
             move grid-occ(34)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 


                exit paragraph
             end-if
        end-if
        if grid-occ(2) <> spaces
             move function upper-case(yedek-rez-adi) to kelime
             move function upper-case(grid-occ(2))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 

                exit paragraph
             end-if
        end-if

        if grid-occ(3) <> spaces
             move function upper-case(yedek-rez-soyadi)   to kelime
             move function upper-case(grid-occ(3))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 


                exit paragraph
             end-if
        end-if

        if grid-occ(4) <> spaces  
             initialize acenta-rec 
             move rez-acenta   to acenta-kodu
             read acenta no lock invalid
                  move "Tanimsiz..."  to acenta-adi
             not invalid
                 move acenta-adi      to ydk-acenta-adi
             end-read
             move function upper-case(ydk-acenta-adi) to kelime
             move function upper-case(grid-occ(4))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                

                exit paragraph
             end-if
        end-if
        if grid-occ(5) <> spaces
             move gd-4-col-5        to kelime
             move grid-occ(5)       to aranan-kelime


             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                
                exit paragraph
             end-if
        end-if
        if grid-occ(6) <> spaces
             move gd-4-col-6        to kelime
             move grid-occ(6)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if
        if grid-occ(7) <> spaces
             move rez-buyuk        to kelime
             move grid-occ(7)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
             

                exit paragraph
             end-if
        end-if
        if grid-occ(8) <> spaces
             move rez-kucuk        to kelime
             move grid-occ(8)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              exit paragraph
             end-if
        end-if
        if grid-occ(9) <> spaces
             move rez-free        to kelime
             move grid-occ(9)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(10) <> spaces
             move rez-bebek        to kelime
             move grid-occ(10)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
             
                exit paragraph
             end-if
        end-if

        if grid-occ(11) <> spaces         
             move function upper-case(rez-voucher) to kelime
             move function upper-case(grid-occ(11))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
            
                exit paragraph
             end-if
        end-if
        if grid-occ(12) <> spaces         
             initialize konum-rec
             move rez-oda-konumu           to konum-anahtar
             read konum no lock invalid 
                  continue 
             end-read 
             move function upper-case(konum-adi) to kelime
             move function upper-case(grid-occ(12))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if
        if grid-occ(13) <> spaces
             if konuk-firma = spaces
                 exit paragraph 
             end-if 
             initialize firma-rec 
             move konuk-firma   to firma-kodu
             read firma no lock invalid
                  move "Tanimsiz..."  to firma-adi
             not invalid
                 move firma-adi      to ydk-firma-adi
             end-read
             move function upper-case(ydk-firma-adi) to kelime
             move function upper-case(grid-occ(13))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                

                exit paragraph
             end-if
        end-if
        if grid-occ(14) <> spaces         
             move rez-gel-saat   to kelime
             move grid-occ(14)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if

        if grid-occ(15) <> spaces         
             move rez-gel-dak      to kelime
             move grid-occ(15)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
             
                exit paragraph
             end-if
        end-if

        if grid-occ(16) <> spaces         
             move rez-git-saat   to kelime
             move grid-occ(16)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if

        if grid-occ(17) <> spaces         
             move rez-git-dak      to kelime
             move grid-occ(17)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if
        if grid-occ(18) <> spaces
             initialize ulke-rec 
             move rez-ulke         to ulke-anah
             read ulke no lock invalid
                  move "   "       to ulke-adi
             end-read 
             move ulke-adi         to kelime
             move grid-occ(18)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               
                exit paragraph
             end-if
        end-if

        if grid-occ(1) <> spaces
             move rez-odano         to o-kisa 
            perform oda-uzat
            move o-uzun to  kelime
             move grid-occ(1)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               
                exit paragraph
             end-if
        end-if
        if grid-occ(20) <> spaces
             initialize doviz-rec
             move rez-doviz        to doviz-kodu
             read doviz no lock invalid 
                  move "  "        to D-KISA-ADI
             end-read 
             move D-KISA-ADI        to kelime
             move grid-occ(20)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                                  
                exit paragraph
             end-if
        end-if        

        if grid-occ(21) <> spaces
             move rez-fiyati        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(21)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              

                exit paragraph
             end-if
        end-if
        if grid-occ(19) <> spaces
             move rez-grup-no        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(19)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               
               exit paragraph
             end-if
        end-if
        if grid-occ(23) <> spaces
             move rez-not1        to kelime
             move grid-occ(23)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                

                exit paragraph
             end-if
        end-if
        if grid-occ(24) <> spaces
             move rez-not2        to kelime
             move grid-occ(24)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if
        if grid-occ(31) <> spaces
             initialize kodlar02-rec
             move rez-pan-tipi      to kodlar02-kodu
             move "A"               to kodlar02-tipi
             read kodlar02 no lock invalid
                  continue 
             end-read 
             move function upper-case(kodlar02-adi)          to kelime
             move grid-occ(31)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0              
                exit paragraph
             end-if
        end-if 
        initialize cast-rec
        move konuk-gel-tar  to cast-tarih
        move konuk-rez-no   to cast-rez-no
        read cast no lock invalid
             exit paragraph
        not invalid 
             if cast-share = 0 or spaces
                if yan-ciksin not = 1
                add 1            to gel-toplam
                add cast-buyuk    to gel-toplam-buyuk
                add cast-kucuk    to gel-toplam-kucuk
                add cast-free     to gel-toplam-free
                add cast-bebek    to gel-toplam-bebek
                add kac-gece     to top-kac-gece
                else
                if yanrez-sirano = 1
                add 1            to gel-toplam
                add cast-buyuk    to gel-toplam-buyuk
                add cast-kucuk    to gel-toplam-kucuk
                add cast-free     to gel-toplam-free
                add cast-bebek    to gel-toplam-bebek
                add kac-gece     to top-kac-gece

                end-if 
                end-if                
             end-if 
        end-read 

        modify gd-4, RECORD-TO-ADD(gd4-rec)
        modify gd-4(kayit-adet + 2,1) hidden-data = konuk-rez-no
        modify gd-4(kayit-adet + 2,2) hidden-data = konuk-folio
        if yanrez-sirano > 1
            modify gd-1(kayit-adet + 2) row-color = 257          
        end-if  
        if rez-dev-uye-no   > 0   
          modify gd-4(kayit-adet + 2) row-color = dev-renk 
        end-if
         if rez-vip not = "N" and  
            rez-vip not = " "
            modify gd-2(kayit-adet + 2) row-color = 385          
         else
            if rez-gr-olabilir = 1
               modify gd-2(kayit-adet + 2) row-color = 480          
            end-if 
         end-if
        add 1 to kayit-adet.

*
 gercout-cagir.
     open input konuk acenta kur ulke cast takvim kllnc ozluk 
                kodlar02 yanrez rez doviz odalar firma konum  

     initialize konuk-rec gel-toplam gel-toplam-buyuk gel-toplam-kucuk gel-toplam-free 
                ulke-rec yanrez-rec rez-rec doviz-rec gel-toplam-bebek top-kac-gece kayit-adet
     move "H"         to konuk-durumu
     move ilk-tarih   to konuk-git-tar
     start konuk key not < konuk-git invalid 
           continue
     not invalid
     perform until fs-konuk = "10"
     read konuk next no lock end move "10" to fs-konuk
     not at end
        if konuk-durumu not = "H"
           exit perform 
        end-if
        if konuk-git-tar > son-tarih
           exit perform  
        end-if
        if KONUK-FOL-KODU = "E"
           exit perform cycle
        end-if

         move konuk-oda-konumu   to rez-oda-konumu 
         move konuk-fiyat-konumu to rez-fiyat-konumu  
         move konuk-odano to rez-odano

         if onkpara-referans-var = 1 then 
            perform ref-filtre
            if  not ref-gecti then 
               exit perform cycle
          end-if
        end-if
        if konuk-rez-no > 0
           initialize rez-rec 
           move konuk-rez-no   to rez-no
           read rez no lock invalid
                continue 
           end-read 
        end-if 
             
        if yan-ciksin = 1
        initialize yanrez-rec
        move rez-no to yanrez-rezno
        start yanrez key not < yanrez-anah invalid 
             continue 
        not invalid 
        perform with test after until fs-yanrez = "10"
        read yanrez next no lock end move "10"  to fs-yanrez 
        not at end
              if yanrez-rezno <> rez-no
                  exit perform 
              end-if 
           
                  move yanrez-adi    to konuk-adi  rez-adi yedek-rez-adi
                  move yanrez-soyadi to konuk-soyadi  rez-soyadi  yedek-rez-soyadi

                  perform gercout-tumdetaylar
               
        end-read
        end-perform
        end-start
        else
          move konuk-adi to yedek-rez-adi
         move konuk-soyadi to yedek-rez-soyadi
          move 1 to yanrez-sirano
          perform gercout-tumdetaylar
        end-if 

     end-read
     end-perform
     end-start
     close konuk acenta ulke kur cast takvim ozluk
           kodlar02 yanrez firma kllnc konum
           rez doviz odalar.
     display acc-99 acc-100 acc-98 acc-97 acc-96 acc-95

     modify gd-5,
            mass-update = 0. 
*
 gercout-tumdetaylar.
       if yanrez-sirano = 1
        perform toplam-rez-tutar
        end-if
        initialize gd5-rec
        move konuk-rez-no   to gd-5-col-32
        if konuk-grup-no > 0
                    move konuk-grup-no to gd-5-col-19
        end-if
        move konuk-adi      to gd-5-col-2
        move konuk-soyadi   to gd-5-col-3
        initialize acenta-rec
        move konuk-acenta  to acenta-kodu
        read acenta no lock invalid
             move "Tanimsiz..."     to gd-5-col-4
        not invalid
            move acenta-adi     to gd-5-col-4
        end-read
        move konuk-gel-gun      to gd-5-col-5(1:2)
        move "/"                to gd-5-col-5(3:1)
        move konuk-gel-ay       to gd-5-col-5(4:2)
        move "/"                to gd-5-col-5(6:1)
        move konuk-gel-yil      to gd-5-col-5(7:4)  

        move konuk-git-gun      to gd-5-col-6(1:2)
        move "/"                to gd-5-col-6(3:1)
        move konuk-git-ay       to gd-5-col-6(4:2)
        move "/"                to gd-5-col-6(6:1)
        move konuk-git-yil      to gd-5-col-6(7:4)
        if yanrez-sirano = 1
        move konuk-buyuk        to ydk-buyuk
        move ydk-buyuk          to gd-5-col-7
        move konuk-kucuk        to ydk-kucuk
        move ydk-kucuk          to gd-5-col-8
        move konuk-free         to ydk-fre
        move ydk-fre            to gd-5-col-9
        move konuk-bebek        to ydk-bebe
        move ydk-bebe           to gd-5-col-10
        move konuk-voucher      to gd-5-col-11
        
        initialize konum-rec
        move rez-oda-konumu     to konum-anahtar
        read konum no lock invalid
              move "Hata"       to konum-adi
        end-read 
              move konum-adi    to gd-5-col-12(1:6)
              move "-"          to gd-5-col-12(7:1)
        initialize konum-rec
        move rez-fiyat-konumu     to konum-anahtar
        read konum no lock invalid
              move "Hata"       to konum-adi
        end-read 
              move konum-adi    to gd-5-col-12(8:)

        if konuk-firma not = spaces
           initialize firma-rec 
           move konuk-firma           to firma-kodu
           read firma no lock invalid
                 move "Tanimsiz..."   to firma-adi
           end-read 
                 move firma-adi       to gd-5-col-13
        end-if 

        move konuk-GEL-SAAT           to gd-5-col-14
        move konuk-GEL-dakika         to gd-5-col-15
        move konuk-git-saat           to gd-5-col-16
        move konuk-git-dakika         to gd-5-col-17

        initialize ulke-rec
        move konuk-ulke               to ulke-anah1 
        read ulke no lock invalid
             move "Tanimsiz...."      to gd-5-col-18
        not invalid
            move ulke-adi             to gd-5-col-18        
        end-read
        end-if
        move konuk-odano               to o-kisa 
            perform oda-uzat
            move o-uzun to  gd-5-col-1
        if yanrez-sirano = 1
        initialize doviz-rec
        move konuk-doviz              to doviz-kodu
        read doviz no lock invalid
             move "Tanimsiz Doviz Kodu..."  to gd-5-col-20
        end-read
          move d-adi-1                 to gd-5-col-20

        move konuk-dv-degeri           to efiyat
        move efiyat                    to gd-5-col-21
*        move konuk-grup-no             to gd-5-col-22
        move doviz-alis                to zkur
        move zkur                      to gd-5-col-22
        move konuk-acik-1              to gd-5-col-23
        move konuk-acik-2              to gd-5-col-24
        end-if
        move konuk-folio               to gd-5-col-25
        initialize rez-rec 
        move konuk-rez-no          to rez-no
        read rez no lock invalid
              continue 
        end-read 
        perform geceleme-bul
        if yanrez-sirano = 1
           move kac-gece                 to z3
           move z3                       to gd-5-col-26
        end-if
        move rez-al-gun                  to gd-5-col-27(1:2)
        move "/"                         to gd-5-col-27(3:1)
        move rez-al-ay                   to gd-5-col-27(4:2)
        move "/"                         to gd-5-col-27(6:1)
        move rez-al-yil                  to gd-5-col-27(7:4)
        if yanrez-sirano = 1
           move toplam-cast-fiyati       to z-15
           move z-15                     to gd-5-col-28
           move toplam-dv                to z-15
           move z-15                     to gd-5-col-29
           perform kllnc-oku
           move k-adi                    to gd-5-col-30
           initialize kodlar02-rec
           move "A"                      to kodlar02-tipi
           move rez-pan-tipi             to kodlar02-kodu
           read kodlar02 no lock invalid
                move "Hata"              to kodlar02-adi
           end-read 
                move kodlar02-adi        to gd-5-col-31
           
           initialize kodlar02-rec                                     |firat pazar kolonu ekleme 10/08/2020
           move "E"       to kodlar02-tipi
           move rez-pazar to kodlar02-kodu
           read kodlar02 no lock invalid 
                move rez-pazar to kodlar02-adi
           end-read
           move kodlar02-adi              to gd-5-col-35

           initialize kodlar02-rec
           move "v"      to kodlar02-tipi
           move rez-vip  to kodlar02-kodu
           read kodlar02 no lock invalid
               initialize kodlar02-rec
           end-read
           move kodlar02-adi to gd-5-col-40

        end-if

        if konuk-telefon-no <> spaces 
           move konuk-telefon-no      to rez-telefon-no
        end-if
        move ozluk-plaka              to gd-5-col-33
        move rez-telefon-no           to gd-5-col-34

        if konuk-late-zaman > 0                                         |firat late cout kolonu  12/08/2020
           move konuk-late-gel-saat   to gd-5-col-36(1:)
           move ":"                   to gd-5-col-36(3:)
           move konuk-late-gel-dak    to gd-5-col-36(4:)
        end-if

        initialize odalar-rec             |firat oda durum kolonu  12/08/2020
        move konuk-odano to odalar-anah
        read odalar no lock invalid
             continue
        end-read 
        initialize kodlar02-rec                                     
        move "C"                to kodlar02-tipi
        move odalar-durumu      to kodlar02-kodu
        read kodlar02 no lock invalid 
             move odalar-durumu to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-5-col-37

        initialize kodlar02-rec                                     
        move "B"                to kodlar02-tipi
        move konuk-odeme-tipi     to kodlar02-kodu
        read kodlar02 no lock invalid 
             move "Tanimsiz."   to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-5-col-38

        if grid-occ(32) <> spaces
             move rez-no        to kelime
             move grid-occ(32)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               
                exit paragraph
             end-if
        end-if

        if grid-occ(33) <> spaces
             move ozluk-plaka        to kelime
             move grid-occ(33)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               
                exit paragraph
             end-if
        end-if

        if grid-occ(34) <> spaces
             move rez-telefon-no        to kelime
             move grid-occ(34)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               
                exit paragraph
             end-if
        end-if

        if grid-occ(2) <> spaces
             move function upper-case(yedek-rez-adi) to kelime
             move function upper-case(grid-occ(2))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 

                exit paragraph
             end-if
        end-if

        if grid-occ(3) <> spaces
             move function upper-case(yedek-rez-soyadi)   to kelime
             move function upper-case(grid-occ(3))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if

        if grid-occ(4) <> spaces  
             initialize acenta-rec 
             move rez-acenta   to acenta-kodu
             read acenta no lock invalid
                  move "Tanimsiz..."  to acenta-adi
             not invalid
                 move acenta-adi      to ydk-acenta-adi
             end-read
             move function upper-case(ydk-acenta-adi) to kelime
             move function upper-case(grid-occ(4))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if
        if grid-occ(5) <> spaces
             move gd-5-col-5        to kelime
             move grid-occ(5)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if
        if grid-occ(6) <> spaces
             move gd-5-col-6        to kelime
             move grid-occ(6)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               
                exit paragraph
             end-if
        end-if
        if grid-occ(7) <> spaces
             move rez-buyuk        to kelime
             move grid-occ(7)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               

                exit paragraph
             end-if
        end-if
        if grid-occ(8) <> spaces
             move rez-kucuk        to kelime
             move grid-occ(8)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              exit paragraph
             end-if
        end-if
        if grid-occ(9) <> spaces
             move rez-free        to kelime
             move grid-occ(9)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph
             end-if
        end-if
        if grid-occ(10) <> spaces
             move rez-bebek        to kelime
             move grid-occ(10)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              

                exit paragraph
             end-if
        end-if
        if grid-occ(11) <> spaces         
             move function upper-case(rez-voucher) to kelime
             move function upper-case(grid-occ(11))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if
        if grid-occ(12) <> spaces         
             initialize konum-rec
             move rez-oda-konumu           to konum-anahtar
             read konum no lock invalid 
                  continue 
             end-read 
             move function upper-case(konum-adi) to kelime
             move function upper-case(grid-occ(12))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              
                exit paragraph
             end-if
        end-if
        if grid-occ(13) <> spaces 
             if konuk-firma = spaces
                 exit paragraph 
             end-if

            if konuk-firma not = spaces
               initialize firma-rec ydk-firma-adi
                move konuk-firma   to firma-kodu
                read firma no lock invalid
                     move "Tanimsiz..."  to firma-adi
                not invalid
                    move firma-adi       to ydk-firma-adi
                end-read
            end-if
             move function upper-case(ydk-firma-adi) to kelime
             move function upper-case(grid-occ(13))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0               
                exit paragraph
             end-if
        end-if

        if grid-occ(14) <> spaces         
             move rez-gel-saat   to kelime
             move grid-occ(14)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               

                exit paragraph
             end-if
        end-if

        if grid-occ(15) <> spaces         
             move rez-gel-dak      to kelime
             move grid-occ(15)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               

                exit paragraph
             end-if
        end-if

        if grid-occ(16) <> spaces         
             move rez-git-saat   to kelime
             move grid-occ(16)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
              

                exit paragraph
             end-if
        end-if

        if grid-occ(17) <> spaces         
             move rez-git-dak      to kelime
             move grid-occ(17)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
            
                exit paragraph
             end-if
        end-if
        if grid-occ(18) <> spaces
             initialize ulke-rec 
             move rez-ulke         to ulke-anah
             read ulke no lock invalid
                  move "   "       to ulke-adi
             end-read 
             move ulke-adi         to kelime
             move grid-occ(18)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
             

                exit paragraph
             end-if
        end-if

        if grid-occ(1) <> spaces
             move rez-odano         to o-kisa 
            perform oda-uzat
            move o-uzun to  kelime
             move grid-occ(1)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
               
                exit paragraph
             end-if
        end-if
        if grid-occ(20) <> spaces
             initialize doviz-rec
             move rez-doviz        to doviz-kodu
             read doviz no lock invalid 
                  move "  "        to D-KISA-ADI
             end-read 
             move D-KISA-ADI        to kelime
             move grid-occ(20)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                
                exit paragraph
             end-if
        end-if        

        if grid-occ(21) <> spaces
             move rez-fiyati        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(21)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                
                exit paragraph
             end-if
        end-if
        if grid-occ(19) <> spaces
             move rez-grup-no        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(19)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                
                exit paragraph
             end-if
        end-if
        if grid-occ(23) <> spaces
             move rez-not1        to kelime
             move grid-occ(23)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                
                exit paragraph
             end-if
        end-if
        if grid-occ(24) <> spaces
             move rez-not2        to kelime
             move grid-occ(24)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                
                exit paragraph
             end-if
        end-if 
        if grid-occ(31) <> spaces
             initialize kodlar02-rec
             move rez-pan-tipi      to kodlar02-kodu
             move "A"               to kodlar02-tipi
             read kodlar02 no lock invalid
                  continue 
             end-read 
             move function upper-case(kodlar02-adi)          to kelime
             move grid-occ(31)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0              
                exit paragraph
             end-if
        end-if
        initialize cast-rec
        move konuk-git-tar  to cast-tarih
        move konuk-rez-no   to cast-rez-no
        read cast no lock invalid 
             exit paragraph 
        not invalid 
             if cast-share = 0 or spaces
                if yan-ciksin not = 1
                add 1            to gel-toplam
                add cast-buyuk    to gel-toplam-buyuk
                add cast-kucuk    to gel-toplam-kucuk
                add cast-free     to gel-toplam-free
                add cast-bebek    to gel-toplam-bebek
                add kac-gece     to top-kac-gece
                else
                if yanrez-sirano = 1
                add 1            to gel-toplam
                add cast-buyuk    to gel-toplam-buyuk
                add cast-kucuk    to gel-toplam-kucuk
                add cast-free     to gel-toplam-free
                add cast-bebek    to gel-toplam-bebek
                add kac-gece     to top-kac-gece

                end-if 
                end-if              
             end-if
        end-read 
                
        modify gd-5, RECORD-TO-ADD(gd5-rec)
        modify gd-5(kayit-adet + 2,1) hidden-data = konuk-rez-no
        modify gd-5(kayit-adet + 2,2) hidden-data = konuk-folio
        if rez-dev-uye-no   > 0
           modify gd-5(kayit-adet + 2) row-color = dev-renk 
        end-if
        if yanrez-sirano   > 1
           modify gd-5(kayit-adet + 2) row-color = 257 
        end-if
        if rez-vip not = "N" and  
           rez-vip not = " "
           modify gd-2(kayit-adet + 2) row-color = 385          
        else
           if rez-gr-olabilir = 1
              modify gd-2(kayit-adet + 2) row-color = 480          
           end-if 
        end-if

        add 1                   to kayit-adet.  

*
 Form1-Bef-Initdata.
     perform baslik-yukle.
*
 baslik-yukle.
      modify gd-1,
             reset-grid = 1
             mass-update = 1
     move "O.No"        to gd-1-col-1
     move "Adi"         to gd-1-col-2
     move "Soyadi"      to gd-1-col-3
     move "Acenta"      to gd-1-col-4
     move "C/in Tarihi" to gd-1-col-5
     move "C/Out Tarih" to gd-1-col-6
     move "Pax"         to gd-1-col-7
     move "Chi"         to gd-1-col-8
     move "Free"        to gd-1-col-9
     move "Bebek"       to gd-1-col-10
     move "Voucher"     to gd-1-col-11
     move "O/F Konumu"  to gd-1-col-12
     move "Firma  Adi"  to gd-1-col-13
     move "S"           to gd-1-col-14
     move "Dk"          to gd-1-col-15
     move "S"           to gd-1-col-16
     move "Dk"          to gd-1-col-17
     move "Ulke"        to gd-1-col-18
     move "Grup"        to gd-1-col-19
     move "Doviz"       to gd-1-col-20
     move "Fiyat"       to gd-1-col-21
     move "Kur "        to gd-1-col-22
     move "Not 1"       to gd-1-col-23
     move "Not 2 "      to gd-1-col-24
     move "Folio No"    to gd-1-col-25
     move "Gece"        to gd-1-col-26
     move "Sat.Tarihi"  to gd-1-col-27
     move "Top.DV"      to gd-1-col-28
     move "Top.TL"      to gd-1-col-29
     move "Staf"        to gd-1-col-30
     move "Pans."       to gd-1-col-31
     MOVE "Rez"         to gd-1-col-32
     move "Plaka"       to gd-1-col-33
     move "Telefon"     to gd-1-col-34
     move "Pazar"       to gd-1-col-35
     move "Vip Durum"   to gd-1-col-40
     move "L.Cout"      to gd-1-col-36
     move "Oda Durumu"  to gd-1-col-37
     move "Odeme Tipi"  to gd-1-col-39

     modify gd-1, RECORD-TO-ADD(gd1-rec).

*
 baslik-yukle-inhouse.
      modify gd-2,
             reset-grid = 1
             mass-update = 1
     move "O.No"        to gd-2-col-1
     move "Adi"         to gd-2-col-2
     move "Soyadi"      to gd-2-col-3
     move "Acenta"      to gd-2-col-4
     move "C/in Tarihi" to gd-2-col-5
     move "C/Out Tarih" to gd-2-col-6
     move "Pax"         to gd-2-col-7
     move "Chi"         to gd-2-col-8
     move "Free"        to gd-2-col-9
     move "Bebek"       to gd-2-col-10
     move "Voucher"     to gd-2-col-11
     move "O/F Konumu"  to gd-2-col-12
     move "Firma Adi"   to gd-2-col-13
     move "S"           to gd-2-col-14
     move "Dk"          to gd-2-col-15
     move "S"           to gd-2-col-16
     move "Dk"          to gd-2-col-17
     move "Ulke"        to gd-2-col-18
     move "Grup"        to gd-2-col-19
     move "Doviz"       to gd-2-col-20
     move "Fiyat"       to gd-2-col-21
     move "Kur "        to gd-2-col-22
     move "Not 1"       to gd-2-col-23
     move "Not 2 "      to gd-2-col-24
     move "Folio No"    to gd-2-col-25
     move "Gece"        to gd-2-col-26
     move "Sat.Tarihi"  to gd-2-col-27
     move "Top.DV"      to gd-2-col-28
     move "Top.TL"      to gd-2-col-29
     move "Staf"        to gd-2-col-30
     move "Pans."       to gd-2-col-31
     move "Rez"         to gd-2-col-32
     move "Plaka"       to gd-2-col-33
     move "Telefon"     to gd-2-col-34
     move "Pazar"       to gd-2-col-35
     move "Vip Durum"   to gd-2-col-40
     move "L.Cout"      to gd-2-col-36
     move "Oda Durumu"  to gd-2-col-37
     move "Odeme Tipi"  to gd-2-col-38
     modify gd-2, RECORD-TO-ADD(gd2-rec).
*
 baslik-yukle-gercin.
      modify gd-4,
             reset-grid = 1
             mass-update = 1
     move "O.No"        to gd-4-col-1
     move "Adi"         to gd-4-col-2
     move "Soyadi"      to gd-4-col-3
     move "Acenta"      to gd-4-col-4
     move "C/in Tarihi" to gd-4-col-5
     move "C/Out Tarih" to gd-4-col-6
     move "Pax"         to gd-4-col-7
     move "Chi"         to gd-4-col-8
     move "Free"        to gd-4-col-9
     move "Bebek"       to gd-4-col-10
     move "Voucher"     to gd-4-col-11
     move "O/F Konumu"  to gd-4-col-12
     move "Firma Adi"   to gd-4-col-13
     move "S"           to gd-4-col-14
     move "Dk"          to gd-4-col-15
     move "S"           to gd-4-col-16
     move "Dk"          to gd-4-col-17
     move "Ulke"        to gd-4-col-18
     move "Grup"        to gd-4-col-19
     move "Doviz"       to gd-4-col-20
     move "Fiyat"       to gd-4-col-21
     move "Kur "        to gd-4-col-22
     move "Not 1"       to gd-4-col-23
     move "Not 2 "      to gd-4-col-24
     move "Folio No"    to gd-4-col-25
     move "Gece"        to gd-4-col-26
     move "Sat.Tarihi"  to gd-4-col-27
     move "Top.DV"      to gd-4-col-28
     move "Top.TL"      to gd-4-col-29
     move "Staf"        to gd-4-col-30
     move "Pans."       to gd-4-col-31 
     move "Rez"         to gd-4-col-32
     move "Plaka"       to gd-4-col-33
     move "Telefon"     to gd-4-col-34   
     move "Pazar"       to gd-4-col-35
     move "Vip Durum"   to gd-4-col-40
     move "L.Cout"      to gd-4-col-36
     move "Oda Durumu"  to gd-4-col-37
     move "Odeme Tipi"  to gd-4-col-38
     modify gd-4, RECORD-TO-ADD(gd4-rec).
*
 baslik-yukle-gercout.
      modify gd-5,
             reset-grid = 1
             mass-update = 1
     move "O.No"        to gd-5-col-1
     move "Adi"         to gd-5-col-2
     move "Soyadi"      to gd-5-col-3
     move "Acenta"      to gd-5-col-4
     move "C/in Tarihi" to gd-5-col-5
     move "C/Out Tarih" to gd-5-col-6
     move "Pax"         to gd-5-col-7
     move "Chi"         to gd-5-col-8
     move "Free"        to gd-5-col-9
     move "Bebek"       to gd-5-col-10
     move "Voucher"     to gd-5-col-11
     move "O/F Konumu"  to gd-5-col-12
     move "Firma Adi"   to gd-5-col-13
     move "S"           to gd-5-col-14
     move "Dk"          to gd-5-col-15
     move "S"           to gd-5-col-16
     move "Dk"          to gd-5-col-17
     move "Ulke"        to gd-5-col-18
     move "Grup"        to gd-5-col-19
     move "Doviz"       to gd-5-col-20
     move "Fiyat"       to gd-5-col-21
     move "Kur "        to gd-5-col-22
     move "Not 1"       to gd-5-col-23
     move "Not 2 "      to gd-5-col-24
     move "Folio No"    to gd-5-col-25
     move "Gece"        to gd-5-col-26
     move "Sat.Tarihi"  to gd-5-col-27
     move "Top.DV"      to gd-5-col-28
     move "Top.TL"      to gd-5-col-29
     move "Staf"        to gd-5-col-30
     move "Pans."       to gd-5-col-31
     move "Rez"         to gd-5-col-32
     move "Plaka"       to gd-5-col-33
     move "Telefon"     to gd-5-col-34
     move "Pazar"       to gd-5-col-35
     move "Vip Durum"   to gd-5-col-40
     move "L.Cout"      to gd-5-col-36
     move "Oda Durumu"  to gd-5-col-37
     move "Odeme Tipi"  to gd-5-col-38
     modify gd-5, RECORD-TO-ADD(gd5-rec).
*
 baslik-yukle-git.
      modify gd-3,
             reset-grid = 1
             mass-update = 1
     move "O.No"        to gd-3-col-1
     move "Adi"         to gd-3-col-2
     move "Soyadi"      to gd-3-col-3
     move "Acenta"      to gd-3-col-4
     move "C/in Tarihi" to gd-3-col-5
     move "C/Out Tarih" to gd-3-col-6
     move "Pax"         to gd-3-col-7
     move "Chi"         to gd-3-col-8
     move "Free"        to gd-3-col-9
     move "Bebek"       to gd-3-col-10
     move "Voucher"     to gd-3-col-11
     move "O/F Konumu"  to gd-3-col-12
     move "Firma Adi"   to gd-3-col-13
     move "S"           to gd-3-col-14
     move "Dk"          to gd-3-col-15
     move "S"           to gd-3-col-16
     move "Dk"          to gd-3-col-17
     move "Ulke"        to gd-3-col-18
     move "Grup"        to gd-3-col-19
     move "Doviz"       to gd-3-col-20
     move "Fiyat"       to gd-3-col-21
     move "Kur "        to gd-3-col-22
     move "Not 1"       to gd-3-col-23
     move "Not 2 "      to gd-3-col-24
     move "Folio No"    to gd-3-col-25
     move "Gece"        to gd-3-col-26
     move "Sat.Tarihi"  to gd-3-col-27
     move "Top.DV"      to gd-3-col-28
     move "Top.TL"      to gd-3-col-29
     move "Staf"        to gd-3-col-30
     move "Pans."       to gd-3-col-31
     move "Rez"         to gd-3-col-32
     move "Plaka"       to gd-3-col-33
     move "Telefon"     to gd-3-col-34
     move "Pazar"       to gd-3-col-35
     move "Vip Durum"   to gd-3-col-40
     move "L.Cout"      to gd-3-col-36
     move "Oda Durumu"  to gd-3-col-37
     move "Odeme Tipi"  to gd-3-col-39
     modify gd-3, RECORD-TO-ADD(gd3-rec).


*
 baslik-yukle-tumrez.
      modify gd-6,
             reset-grid = 1
             mass-update = 1
     move "O.No"        to gd-6-col-1
     move "Adi"         to gd-6-col-2
     move "Soyadi"      to gd-6-col-3
     move "Acenta"      to gd-6-col-4
     move "C/in Tarihi" to gd-6-col-5
     move "C/Out Tarih" to gd-6-col-6
     move "Pax"         to gd-6-col-7
     move "Chi"         to gd-6-col-8
     move "Free"        to gd-6-col-9
     move "Bebek"       to gd-6-col-10
     move "Voucher"     to gd-6-col-11
     move "0.Kon"       to gd-6-col-12
     move "Firma Adi"   to gd-6-col-13
     move "S"           to gd-6-col-14
     move "Dk"          to gd-6-col-15
     move "S"           to gd-6-col-16
     move "Dk"          to gd-6-col-17
     move "Ulke"        to gd-6-col-18
     move "Grup"        to gd-6-col-19
     move "Doviz"       to gd-6-col-20
     move "Fiyat"       to gd-6-col-21
     move "Kur"         to gd-6-col-22
     move "Not 1"       to gd-6-col-23
     move "Not 2 "      to gd-6-col-24
     move "Folio No"    to gd-6-col-25
     move "Gece"        to gd-6-col-26
     move "Sat.Tarihi"  to gd-6-col-27
     move "Top.DV"      to gd-6-col-28
     move "Top.TL"      to gd-6-col-29
     move "Staf"        to gd-6-col-30
     move "Pans."       to gd-6-col-31
     move "Rez"         to gd-6-col-32
     move "Plaka"       to gd-6-col-33
     move "Telefon"     to gd-6-col-34
     move "Pazar"       to gd-6-col-35
     move "Vip Durum"   to gd-6-col-40
     move "L.Cout"      to gd-6-col-36
     move "Oda Durumu"  to gd-6-col-37
     move "Odeme Tipi"  to gd-6-col-38
     modify gd-6, RECORD-TO-ADD(gd6-rec).
*
 Form1-Aft-Initdata.
    
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*  
      if onkpara-referans-var = 1 then
               modify cb-otel reset-list = 1 
               if hangi-ref not > 0
                  move "0->Tum Komplex" to   ref-ekle
                  modify cb-otel item-to-add ref-ekle
               end-if 
              perform varying ref from 1 by 1 until ref > max-ref
                  if hangi-ref > 0
                     if hangi-ref not = ref
                        exit perform cycle 
                     end-if 
                  end-if 
                  move ref           to ref-ekle
                  move "->"          to ref-ekle(2:2)
                  move ref-adi(ref)  to ref-ekle(4:)
                 modify cb-otel item-to-add ref-ekle
        
              end-perform
**              modify cb-otel, value = 0
               move 0 to oda-ref fiyat-ref
                      if hangi-ref > 0
                            move hangi-ref   to oda-ref       
                      end-if 
               display oda-ref-acc sat-ref-acc cb-otel
       end-if
     move 1 to hangi-buton

     perform gel-cagir.       
*
 kart-yap.
        initialize link-kart-rezno
        move ydk-rez to link-kart-rezno
        perform Kalekart-Call



*       initialize dokcagir-tasi
*       set dokcagir-tasi-call-rez1   to true
*       move ydk-rez                  to dokcagir-rez-no
*       perform dokcagir-call
*       move dokcagir-rez-no          to rez-no.


       .
*
 rez-cagir.

       initialize dokcagir-tasi
       set dokcagir-tasi-call-rez1   to true
       move ydk-rez                   to dokcagir-rez-no
       perform dokcagir-call
       move dokcagir-rez-no          to rez-no.
*
 folio-cagir.
       initialize dokcagir-tasi
       set dokcagir-tasi-call-folio1      to true
       move ydk-konuk-folio               to dokcagir-konuk-folio
       perform dokcagir-call
       move dokcagir-konuk-folio          to konuk-folio.

*
 c-in-yap.
      initialize ydk-rez
      inquire gd-1,cursor-y in sayac
      inquire gd-1(sayac,1), hidden-data in ydk-rez
      open input rez
      initialize rez-rec
      move ydk-rez     to rez-no
      read rez no lock invalid
          display message box "Rezervasyon Bulunamadi.."
                          title "[ Uyari ]"
                          icon 1
          close rez
          exit paragraph
      end-read
      close rez
      if rez-gir-tar = tarih-tasi      
         move 99999998               to konuk-folio
         move rez-no                 to konuk-rez-no
         initialize dokcagir-tasi
         set dokcagir-tasi-call-cin2 to true
         move konuk-rez-no           to dokcagir-konuk-rez-no      
         move konuk-folio            to dokcagir-konuk-folio
         perform dokcagir-call
         move dokcagir-konuk-rez-no  to konuk-rez-no
         move dokcagir-konuk-folio   to konuk-folio
      else
         display message box "Rezervasyon Giris Tarihi:"rez-gir-gun"/"rez-gir-ay"/"rez-gir-yil new-line
                             "Calisma Tarihi:"gun-tasi"/"ay-tasi"/"yil-tasi
                       title "[ Uyumsuz Tarih ]"
                       icon 1
      end-if        
       .
*
 reg-kart.

      open input konuk
      initialize konuk-rec
      move ydk-folio           to konuk-folio
      read konuk no lock invalid
           display message box "Konuk Kaydi Bulunamadi..."
                           title "[ Uyari ]"
                           icon 1
           close konuk
           exit paragraph
      end-read
      close konuk
      initialize dokcagir-tasi
      set dokcagir-tasi-call-cin2 to true
      move konuk-rez-no           to dokcagir-konuk-rez-no      
      move konuk-folio            to dokcagir-konuk-folio
      perform dokcagir-call
      move dokcagir-konuk-rez-no  to konuk-rez-no
      move dokcagir-konuk-folio   to konuk-folio.
*
 oda-degis.
        initialize temp-oda
        inquire gd-2,cursor-y in sayac
        inquire gd-2(sayac,1), cell-data in temp-oda
        initialize dokcagir-tasi
        set dokcagir-tasi-call-odadegis1  to true
        move temp-oda                       to o-uzun
            perform oda-kisalt
            move o-kisa to  dokcagir-konuk-odano
        perform dokcagir-call
        move dokcagir-konuk-odano          to o-kisa 
            perform oda-uzat
            move o-uzun to  temp-oda.
*
 oda-uzatma.
        initialize temp-oda
        inquire gd-2,cursor-y in sayac
        inquire gd-2(sayac,1), cell-data in temp-oda

        initialize dokcagir-tasi
        set dokcagir-tasi-call-uzatma1    to true
        move temp-oda                       to o-uzun
            perform oda-kisalt
            move o-kisa to   dokcagir-konuk-odano
        perform dokcagir-call
        move dokcagir-konuk-odano         to o-kisa 
            perform oda-uzat
            move o-uzun to temp-oda.
*
 reg-kart-gercin.
      initialize ydk-folio
      inquire gd-4,cursor-y in sayac
      inquire gd-4(sayac,25), cell-data in ydk-folio
      open input konuk
      initialize konuk-rec
      move ydk-folio           to konuk-folio
      read konuk no lock invalid
           display message box "Konuk Kaydi Bulunamadi..."
                           title "[ Uyari ]"
                           icon 1
           close konuk
           exit paragraph
      end-read
      close konuk
      initialize dokcagir-tasi
      set dokcagir-tasi-call-cin2 to true
      move konuk-rez-no           to dokcagir-konuk-rez-no      
      move konuk-folio            to dokcagir-konuk-folio
      perform dokcagir-call
      move dokcagir-konuk-rez-no  to konuk-rez-no
      move dokcagir-konuk-folio   to konuk-folio.
*
 reg-kart-gercout.
      initialize ydk-folio
      inquire gd-5,cursor-y in sayac
      inquire gd-5(sayac,25), cell-data in ydk-folio
      open input konuk
      initialize konuk-rec
      move ydk-folio           to konuk-folio
      read konuk no lock invalid
           display message box "Konuk Kaydi Bulunamadi..."
                           title "[ Uyari ]"
                           icon 1
           close konuk
           exit paragraph
      end-read
      close konuk
      initialize dokcagir-tasi
      set dokcagir-tasi-call-cin2 to true
      move konuk-rez-no           to dokcagir-konuk-rez-no      
      move konuk-folio            to dokcagir-konuk-folio
      perform dokcagir-call
      move dokcagir-konuk-rez-no  to konuk-rez-no
      move dokcagir-konuk-folio   to konuk-folio.
*
 gd-1-Ev-Other.
    evaluate event-type
     when msg-goto-cell-mouse
     when msg-goto-cell

          inquire gd-1(event-data-2,34), cell-data in cell-rez 
          perform not-goster

          inquire gd-1(event-data-2,1), cell-data in temp-oda
          perform oda-tip-goster

     when msg-begin-entry
 
          if |event-data-2 not = 2 and 
             (event-data-1 not = 15 and event-data-1 not = 16 and 
              event-data-1 not = 17 and event-data-1 not = 18)
                move event-action-fail to event-action
          end-if
     when msg-finish-entry
*         if (event-data-1 not = 14 and event-data-1 not = 15 and     |firat ilk satir suzme kapatildi. 12/10/2020
*              event-data-1 not = 16 and event-data-1 not = 17)
*            inquire gd-1(event-data-2,event-data-1), 
*                      cell-data in grid-occ(event-data-1)
*            perform baslik-yukle
*            perform gel-cagir
*         else
            inquire gd-1(event-data-2,15), cell-data in temp
            if temp > 24
               display message box "Hatali Saat Girdiniz.."
                               title "Uyari"
                               icon 1
                exit paragraph 
            end-if 
            inquire gd-1(event-data-2,16), cell-data in temp
            if temp > 59
               display message box "Hatali Dakika Girdiniz.."
                               title "Uyari"
                               icon 1
                exit paragraph 
            end-if 

            inquire gd-1(event-data-2,17), cell-data in temp
            if temp > 24
               display message box "Hatali Saat Girdiniz.."
                               title "Uyari"
                               icon 1
                exit paragraph 
            end-if 
            inquire gd-1(event-data-2,18), cell-data in temp
            if temp > 59
               display message box "Hatali Dakika Girdiniz.."
                               title "Uyari"
                               icon 1
                exit paragraph 
            end-if 


            inquire gd-1(event-data-2,34), cell-data in cell-rez
            open i-o rez
            initialize rez-rec
            move cell-rez   to rez-no
            read rez no lock invalid 
                display message box "Rezervasyon Bulunamadi.."
                                title "Uyari"
                                icon 1
                             close rez
                             exit paragraph 
            not invalid 
               evaluate event-data-1
               when 15
                   inquire gd-1(event-data-2,15), cell-data in rez-gel-saat 
                   modify gd-1,cursor-y event-data-2 
                               cursor-x 15
               when 16
                   inquire gd-1(event-data-2,16), cell-data in rez-gel-dak 
                   modify gd-1,cursor-y event-data-2 + 1 
                               cursor-x 14               
               when 17
                   inquire gd-1(event-data-2,17), cell-data in rez-git-saat 
                   modify gd-1,cursor-y event-data-2 
                               cursor-x 17               
               when 18
                   inquire gd-1(event-data-2,18), cell-data in rez-git-dak  
                   modify gd-1,cursor-y event-data-2 + 1 
                               cursor-x 16               
               end-evaluate 
                
               accept rez-edit-tarih from century-date  |firat amonra iin konuldu 03/11/2020
               accept rez-edit-zaman from time          |                           
               
               rewrite rez-rec end-rewrite 
               perform log-operation-rez
            end-read 
            close rez
*         end-if 
    end-evaluate              
     .



*
 Form1-Ta-1-Ev-Cmd-Tabchanged.

     .
*
 takas-dosya-ac.
    open i-o genelfis
    initialize genelfis-rec
    move 1 to genelfis-anahtar
    read genelfis no lock invalid
         continue 
    not invalid 
        add 1      to ekran-fis-1 
        rewrite genelfis-rec end-rewrite 
        move ekran-fis-1  to takas-no
    end-read 
    close genelfis 
    open output takas close takas open i-o takas.
*
 Form1-Ta-1-Aft-Tabchg-Display.     
     if Form1-Ta-1-Value not = 6         
           move 0 to tum-rez-girildi
     end-if
     evaluate Form1-Ta-1-Value
     when 1
     modify cb-odalar-ciksin,visible = true
        modify gd-1,visible = 0
 
        modify cb-extraa,visible = false
        move 0   to vis-1 vis-2 vis-3 vis-4 
                    vis-5 vis-6 vis-7 vis-8
        display lb-filt1 lb-filt2 acc-01a acc-02a
                acc-03a acc-04a acc-05a acc-06a
        move 1   to v-1 v-2 v-3 v-4 v-5 v-6 v-7 v-8
        display lb-ilk lb-son acc-01 acc-02 acc-03 acc-04 acc-05 acc-06 
        modify cb-gitme-cikma,visible = 0
        perform baslik-yukle
        perform gel-cagir              
        move 4 to accept-control
        move 4 to control-id
         modify gd-1,visible = 1
     when 2
     
     modify cb-odalar-ciksin,visible = false
                modify cb-extraa,visible = false
           modify gd-3,visible = 0
      
        move 0   to vis-1 vis-2 vis-3 vis-4 
                    vis-5 vis-6 vis-7 vis-8
        display lb-filt1 lb-filt2 acc-01a acc-02a
                acc-03a acc-04a acc-05a acc-06a
        move 1   to v-1 v-2 v-3 v-4 v-5 v-6 v-7 v-8
        display lb-ilk lb-son acc-01 acc-02 acc-03 acc-04 acc-05 acc-06 
        modify cb-gitme-cikma,visible = 0
        perform baslik-yukle-git
        perform git-cagir
        move 4 to accept-control
        move 21 to control-id
             modify gd-3,visible = 1
     when 3 
     modify cb-odalar-ciksin,visible = false

             modify cb-extraa,visible = false
            modify gd-2,visible = 0
         
        move 0   to vis-1 vis-2 vis-3 vis-4 
                    vis-5 vis-6 vis-7 vis-8
        display lb-filt1 lb-filt2 acc-01a acc-02a
                acc-03a acc-04a acc-05a acc-06a
        move 1   to v-1 v-2 v-3 v-4 v-5 v-6 v-7 v-8
        display lb-ilk lb-son acc-01 acc-02 acc-03 acc-04 acc-05 acc-06 
        modify cb-gitme-cikma,visible = 1
        perform baslik-yukle-inhouse
        perform inhose-cagir
        move 4 to accept-control
        move 20 to control-id
           modify gd-2,visible = 1
     when 4                    |||firatfirat
     modify cb-odalar-ciksin,visible = false

             modify cb-extraa,visible = false
            modify gd-4,visible = 0
       
        move 0   to vis-1 vis-2 vis-3 vis-4 
                    vis-5 vis-6 vis-7 vis-8
        display lb-filt1 lb-filt2 acc-01a acc-02a
                acc-03a acc-04a acc-05a acc-06a
        move 1   to v-1 v-2 v-3 v-4 v-5 v-6 v-7 v-8
        display lb-ilk lb-son acc-01 acc-02 acc-03 acc-04 acc-05 acc-06 
        modify cb-gitme-cikma,visible = 0
        perform baslik-yukle-gercin 
        set inhouse to true                || firat history cinler cikmiyordu
           perform gercin-cagir
        set history to true 
           perform gercin-cagir
*        perform gercin-cagir
        move 4 to accept-control
        move 20 to control-id
             modify gd-4,visible = 1
     when 5
     modify cb-odalar-ciksin,visible = false

             modify cb-extraa,visible = false
            modify gd-5,visible = 0

        move 0   to vis-1 vis-2 vis-3 vis-4 
                    vis-5 vis-6 vis-7 vis-8
        display lb-filt1 lb-filt2 acc-01a acc-02a
                acc-03a acc-04a acc-05a acc-06a
        move 1   to v-1 v-2 v-3 v-4 v-5 v-6 v-7 v-8
        display lb-ilk lb-son acc-01 acc-02 acc-03 acc-04 acc-05 acc-06 
        modify cb-gitme-cikma,visible = 0
        perform baslik-yukle-gercout
        perform gercout-cagir
        move 4 to accept-control
        move 20 to control-id
             modify gd-5,visible = 0
    modify gd-5,visible = 1
     when 6
          modify cb-odalar-ciksin,visible = false

             modify cb-extraa,visible = true
       modify gd-1,visible = 0
       modify gd-2,visible = 0
       modify gd-3,visible = 0
       modify gd-4,visible = 0
       modify gd-5,visible = 0
       modify gd-6,visible = 0


        move 1   to vis-1 vis-2 vis-3 vis-4 
                    vis-5 vis-6 vis-7 vis-8
        display lb-filt1 lb-filt2 acc-01a acc-02a
                acc-03a acc-04a acc-05a acc-06a

        move 0   to v-1 v-2 v-3 v-4 v-5 v-6 v-7 v-8 
        display lb-ilk lb-son acc-01 acc-02 acc-03 acc-04 acc-05 acc-06  
        modify cb-gitme-cikma,visible = 0

        if tum-rez-girildi = 0
                perform baslik-yukle-tumrez
*                perform tumrez-cagir
            modify gd-6,
               mass-update = 0
        end-if
        move 1 to tum-rez-girildi


        move 4 to accept-control
        move 20 to control-id 
        modify gd-6,visible = 1
     end-evaluate           
     .
*
 filtre-aft.
    perform Form1-Ta-1-Aft-Tabchg-Display
    .
*
 dokcagir-call.
     call "/asya/ytl/obj/otel/dokcagir.asy" using dokcagir-tasi
          on exception 
             perform callerr-proc
          not on exception
             cancel "/asya/ytl/obj/otel/dokcagir.asy"
     end-call.
*
 kalekart-call.
     call "/asya/ytl/obj/otel/kalekart.asy" using link-kart-rezno
          on exception 
             perform callerr-proc
          not on exception
             cancel "/asya/ytl/obj/otel/kalekart.asy"
     end-call.
*
 gd-2-Ev-Other.
     evaluate event-type
     when msg-goto-cell-mouse
     when msg-goto-cell
          inquire gd-2(event-data-2,34), cell-data in cell-rez 
          perform not-goster 
          inquire gd-2(event-data-2,1), cell-data in temp-oda
          perform oda-tip-goster
     when msg-begin-entry
 
          if |event-data-2 not = 2 and 
             (event-data-1 not = 17 and event-data-1 not = 18)
             move event-action-fail to event-action
          end-if
     when msg-finish-entry
*        if (event-data-1 not = 16 and event-data-1 not = 17)              |firat ilk satir suzme kapatildi. 12/10/2020
*            inquire gd-2(event-data-2,event-data-1), 
*                    cell-data in grid-occ(event-data-1)
*            perform baslik-yukle-inhouse
*            perform inhose-cagir
*         else            
            inquire gd-2(event-data-2,17), cell-data in temp
            if temp > 24
               display message box "Hatali Saat Girdiniz.."
                               title "Uyari"
                               icon 1
                exit paragraph 
            end-if 
            inquire gd-2(event-data-2,18), cell-data in temp
            if temp > 59
               display message box "Hatali Dakika Girdiniz.."
                               title "Uyari"
                               icon 1
                exit paragraph 
            end-if 


            inquire gd-2(event-data-2,34), cell-data in cell-rez

            open i-o rez konuk
            initialize rez-rec
            move cell-rez   to rez-no
            read rez no lock invalid 
                display message box "Rezervasyon Bulunamadi.."
                                title "Uyari"
                                icon 1
                             close rez
                             exit paragraph 
            not invalid 
               evaluate event-data-1
               when 17
                   inquire gd-2(event-data-2,17), cell-data in rez-git-saat 
                   modify gd-2,cursor-y event-data-2 
                               cursor-x 17                 
               when 18
                   inquire gd-2(event-data-2,18), cell-data in rez-git-dak                
                   modify gd-2,cursor-y event-data-2  + 1
                               cursor-x 16                 
               end-evaluate 
                

               accept rez-edit-tarih from century-date  |firat amonra iin konuldu 03/11/2020
               accept rez-edit-zaman from time          |                           
               
               rewrite rez-rec end-rewrite 
               perform log-operation-rez

               initialize konuk-rec
               move rez-folio  to konuk-folio
               read konuk no lock invalid 
                   display message box "Folio Bulunamadi.."
                                   title "Uyari"
                                   icon 1
                    close konuk rez 
               not invalid 
                   evaluate event-data-1
                   when 17
                       inquire gd-2(event-data-2,17), cell-data in konuk-git-saat                
                   when 18
                       inquire gd-2(event-data-2,18), cell-data in konuk-git-dakika                
                   end-evaluate 
                   rewrite konuk-rec end-rewrite 
                   perform log-operation-konuk
               end-read 
            end-read 
            close rez konuk
*         end-if 
     end-evaluate.
*
 tarih-kontrol.
    open input takvim
    initialize takvim-rec
    move ilk-tarih      to takvim-anah
    read takvim no lock invalid
         display message box "ilk Tarih Tanimsiz..."
                         title "[ Uyari ]"
                         icon 1
            
    end-read
    close takvim

    open input takvim
    initialize takvim-rec
    move son-tarih      to takvim-anah
    read takvim no lock invalid
         display message box "Son Tarih Tanimsiz..."
                         title "[ Uyari ]"
                         icon 1            
    end-read
    close takvim

    .
*
 gd-3-Ev-Other.
    evaluate event-type
     when msg-goto-cell-mouse
     when msg-goto-cell

          inquire gd-3(event-data-2,34), cell-data in cell-rez 
          perform not-goster 

          inquire gd-3(event-data-2,1), cell-data in temp-oda
          perform oda-tip-goster
     when msg-begin-entry
 
*          if event-data-2 not = 2
             move event-action-fail to event-action
*          end-if
*     when msg-finish-entry
*
*         inquire gd-3(event-data-2,event-data-1),             |firat ilk satir suzme kapatildi. 12/10/2020
*                    cell-data in grid-occ(event-data-1)
*         perform baslik-yukle-git
*         perform git-cagir
    end-evaluate              
     
     .
*
 hotel-status.
    call "/asya/ytl/obj/otel/hstatus.asy" 
         on exception 
           perform callerr-proc
             exit paragraph
         not on exception 
    cancel "/asya/ytl/obj/otel/hstatus.asy"
    end-call 

     .
*
 gd-4-Ev-Other.
    evaluate event-type
     when msg-goto-cell-mouse
     when msg-goto-cell
          inquire gd-4(event-data-2,34), cell-data in cell-rez 
          perform not-goster  
          inquire gd-4(event-data-2,1), cell-data in temp-oda
          perform oda-tip-goster
     when msg-begin-entry
 
*          if event-data-2 not = 2
             move event-action-fail to event-action
*          end-if
*     when msg-finish-entry
*
*         inquire gd-4(event-data-2,event-data-1), 
*                    cell-data in grid-occ(event-data-1)
*         perform baslik-yukle-gercin
*         set inhouse to true            || history cinler cikmiyordu firat
*            perform gercin-cagir
*         set history to true 
*            perform gercin-cagir
    end-evaluate.
*
 gd-5-Ev-Other.
    evaluate event-type
     when msg-goto-cell-mouse
     when msg-goto-cell
          inquire gd-5(event-data-2,34), cell-data in cell-rez 
          perform not-goster
          inquire gd-5(event-data-2,1), cell-data in temp-oda
          perform oda-tip-goster
     when msg-begin-entry
 
*          if event-data-2 not = 2
             move event-action-fail to event-action
*          end-if
*     when msg-finish-entry

*         inquire gd-5(event-data-2,event-data-1), 
*                    cell-data in grid-occ(event-data-1)
*         perform baslik-yukle-gercout
*         perform gercout-cagir
    end-evaluate    
     
     .
*
 blokaj-menusu.
    call "/asya/ytl/obj/otel/blokyap.asy" 
        on exception 
        perform callerr-proc
            exit paragraph
        not on exception 
        cancel "/asya/ytl/obj/otel/blokyap.asy"
    end-call.
*
 teknik-rack.
    call "/asya/ytl/obj/otel/tekrack1.asy" 
       on exception 
       perform callerr-proc
          exit paragraph
       not on exception 
       cancel "/asya/ytl/obj/otel/tekrac1.asy"
    end-call.
*
 bos-oda-listesi.
    call "/asya/ytl/obj/otel/bosrack.asy" 
      on exception 
      perform callerr-proc
    not on exception
      cancel "/asya/ytl/obj/otel/bosrack.asy"
    end-call.
*
 cikis-listesi.
    call "/asya/ytl/obj/otel/fbakiye.asy" 
      on exception 
      perform callerr-proc
    not on exception
      cancel "/asya/ytl/obj/otel/fbakiye.asy"
    end-call.
*
 Form1-Tr-1-Ev-Other.
    evaluate event-type
    when MSG-TV-DBLCLICK 
         move event-data-2   to point
         modify Form1-Tr-1,item = point
         inquire Form1-Tr-1, hidden-data in hangi-agac 
         evaluate hangi-agac(1:5)
         when "for01"
              call "/asya/ytl/obj/otel/for02.asy" 
                on exception 
                perform callerr-proc
              not on exception
                cancel "/asya/ytl/obj/otel/for02.asy"
              end-call             
         when "for02"
              call "/asya/ytl/obj/otel/for03.asy" 
                on exception 
                perform callerr-proc
              not on exception
                cancel "/asya/ytl/obj/otel/for03.asy"
              end-call             
         when "for03"
              call "/asya/ytl/obj/otel/for04.asy" 
                on exception 
                perform callerr-proc
              not on exception
                cancel "/asya/ytl/obj/otel/for04.asy"
              end-call
         when "k01"
              call "/asya/ytl/obj/otel/kasarap1.asy" 
                on exception 
                perform callerr-proc
              not on exception
                cancel "/asya/ytl/obj/otel/kasarap1.asy"
              end-call
         when "k02"
              call "/asya/ytl/obj/otel/kasarap2.asy" 
                on exception 
                perform callerr-proc
              not on exception
                cancel "/asya/ytl/obj/otel/kasarap2.asy"
              end-call
         when "k03"
              call "/asya/ytl/obj/otel/dov-boz.asy" 
                on exception 
                perform callerr-proc
              not on exception
                cancel "/asya/ytl/obj/otel/dov-boz.asy"
              end-call
         when "k04"
              call "/asya/ytl/obj/otel/dov-bozr.asy" 
                on exception 
                perform callerr-proc
              not on exception
                cancel "/asya/ytl/obj/otel/dov-bozr.asy"
              end-call
         when "t01"
              call "/asya/ytl/obj/otel/fihrist.asy" 
                on exception 
                perform callerr-proc
              not on exception
                cancel "/asya/ytl/obj/otel/fihrist.asy"
              end-call
         when "t02"
              call "/asya/ytl/obj/otel/telrap2.asy" 
                on exception 
                perform callerr-proc
              not on exception
                cancel "/asya/ytl/obj/otel/telrap2.asy"
              end-call
         when "t03"
              call "/asya/ytl/obj/otel/telkim.asy" 
                on exception 
                perform callerr-proc
              not on exception
                cancel "/asya/ytl/obj/otel/telkim.asy"
              end-call
         end-evaluate
    end-evaluate
     
     .
*
 not-goster.

     move 3               to link-nereden 
     move "K"             to  link-not-islem
     move "REZ"           to  link-NOT-DOS    
     if cell-rez > 0
          move cell-rez   to link-not-dos-anah
     else
        move konuk-rez-no to link-NOT-DOS-ANAH   
     end-if
             move 3       to link-nereden 
             call "/asya/ytl/obj/otel/mesajgir.asy" 
                   using link-not
                    on exception 
                    perform callerr-proc
                    exit paragraph
                  not on exception 
                    cancel "/asya/ytl/obj/otel/mesajgir.asy"
              end-call
              move  link-not-donus  to  toplam-not
     display not-ac.
*
 oda-tip-goster.
     open input odalar kodlar02 konum 
     initialize odalar-rec kodlar02-rec
     move temp-oda     to odalar-anah
     read odalar no lock invalid
               initialize oda-tipi-1 oda-tipi-2 oda-tipi-3 oda-knm  oda-drm
               display Form1-Ef-tip1 Form1-Ef-tip2 Form1-Ef-tip3 Form1-Ef-oda-konumu Form1-Ef-1aaaa
     not invalid
         initialize kodlar02-rec 
         move house-durumu       to kodlar02-kodu
         move "C"                to kodlar02-tipi
         read kodlar02 no lock invalid
              initialize kodlar02-adi
         end-read
              move kodlar02-adi  to oda-drm

         initialize konum-rec
         move odalar-konumu      to konum-anahtar
         read konum no lock invalid
              initialize konum-adi  
         end-read
              move konum-adi     to oda-knm

         initialize kodlar02-rec
         move odalar-tipi        to kodlar02-kodu
         move "G"                to kodlar02-tipi
         read kodlar02 no lock invalid
              initialize  kodlar02-adi
         end-read
             move kodlar02-adi   to oda-tipi-1

         initialize kodlar02-rec
         move odalar-tipi2        to kodlar02-kodu
         move "H"                  to kodlar02-tipi
         read kodlar02 no lock invalid
              initialize  kodlar02-adi
         end-read
             move kodlar02-adi   to oda-tipi-2

         initialize kodlar02-rec
         move odalar-tipi3        to kodlar02-kodu
         move "I"                  to kodlar02-tipi
         read kodlar02 no lock invalid
              initialize  kodlar02-adi
         end-read
             move kodlar02-adi   to oda-tipi-3

     end-read
     close odalar kodlar02 konum 
     display Form1-Ef-tip1 Form1-Ef-tip2 Form1-Ef-tip3 Form1-Ef-oda-konumu Form1-Ef-1aaaa.
*
 tumrez-cagir.
     open input rez acenta kllnc kur kodlar02 cast konuk ozluk
                ulke yanrez doviz firma takvim konum odalar
     initialize gel-toplam      
                gel-toplam-buyuk
                gel-toplam-kucuk
                gel-toplam-free 
                gel-toplam-bebek top-kac-gece
     if yan-ciksin not = 1
             initialize rez-rec
             move 1   to xgel-toplam 
             initialize kayit-adet
             move filtre-ilk-tarih     to rez-gir-tar
             start rez key not < rez-gir invalid 
                  continue 
             not invalid 
             perform with test after until fs-rez = "10"
             read rez next no lock end move "10"  to fs-rez 
             not at end
                   perform tum-rez-detay-ata
             end-read
             end-perform
             end-start
     else
             initialize rez-rec
                     move 1   to xgel-toplam  
                     initialize kayit-adet
             move filtre-ilk-tarih     to rez-gir-tar
             MOVE "I"  TO REZ-DURUMU
             start rez key not < rez-gir invalid 
                  continue 
             not invalid 
             perform with test after until fs-rez = "10"
             read rez next no lock end move "10"  to fs-rez 
                     not at end
                        if rez-gir-tar > filtre-son-tarih
                                exit PERFORM  
                        end-if
                    
                     initialize yanrez-rec                       
                     move rez-no to yanrez-rezno
                     start yanrez key not < yanrez-anah invalid 
                          continue 
                     not invalid 
                     perform with test after until fs-yanrez = "10"
                     read yanrez next no lock end move "10"  to fs-yanrez 
                     not at end
                           if yanrez-rezno <> rez-no
                               exit perform 
                           end-if 
                        
                           move yanrez-adi    to rez-adi
                           move yanrez-soyadi to rez-soyadi

                           perform tum-rez-detay-ata                     
                            
                     end-read
                     end-perform
                     end-start

             end-read
             end-perform
             end-start

     end-if 
     close rez acenta kodlar02 kur kllnc firma konuk ozluk
           cast ulke yanrez doviz  takvim  konum odalar
     display acc-100 acc-99 acc-98 acc-97 acc-96 acc-95
 
     modify gd-6,
            mass-update = 0.
* 
 tum-rez-detay-ata.
        if rez-gir-tar < filtre-ilk-tarih or
           rez-gir-tar > filtre-son-tarih
                exit paragraph  
        end-if 
        if rez-durumu not = "I" and 
           silinmis-rez-goster = 0 
                exit paragraph  
        end-if

        if rez-k-g-b  not = "K"
                exit paragraph  
        end-if

        if rez-c-in = "E" and 
           cin-oda-cikmasin = 1
                exit paragraph  
        end-if
         if onkpara-referans-var = 1 then 
            perform ref-filtre
            if  not ref-gecti then 
                exit paragraph  
          end-if
        end-if                  
        perform toplam-rez-tutar

        initialize gd6-rec

*        if rez-vip not = "N" and 
*           rez-vip not = " "
*             modify gd-6(gel-toplam + 1), ROW-COLOR = 384
*        end-if        

        move rez-no      to gd-6-col-32
        if rez-grup-no > 0
                    move rez-grup-no to gd-6-col-19
        end-if

        move rez-adi     to gd-6-col-2
        move rez-soyadi  to gd-6-col-3
        initialize acenta-rec
        move rez-acenta  to acenta-kodu
        read acenta no lock invalid
             move "Tanimsiz..."     to gd-6-col-4
        not invalid
            move acenta-adi     to gd-6-col-4
        end-read
        move rez-gir-gun        to gd-6-col-5(1:2)
        move "/"                to gd-6-col-5(3:1)
        move rez-gir-ay         to gd-6-col-5(4:2)
        move "/"                to gd-6-col-5(6:1)
        move rez-gir-yil        to gd-6-col-5(7:4)  

        move rez-cik-gun        to gd-6-col-6(1:2)
        move "/"                to gd-6-col-6(3:1)
        move rez-cik-ay         to gd-6-col-6(4:2)
        move "/"                to gd-6-col-6(6:1)
        move rez-cik-yil        to gd-6-col-6(7:4)  
        if yan-ciksin not = 1
           move rez-buyuk          to ydk-buyuk
           move ydk-buyuk          to gd-6-col-7
           move rez-kucuk          to ydk-kucuk
           move ydk-kucuk          to gd-6-col-8
           move rez-free           to ydk-fre
           move ydk-fre            to gd-6-col-9
           move rez-bebek          to ydk-bebe
           move ydk-bebe           to gd-6-col-10
        else
           if yanrez-sirano = 1 
              move rez-buyuk          to ydk-buyuk
              move ydk-buyuk          to gd-6-col-7
              move rez-kucuk          to ydk-kucuk
              move ydk-kucuk          to gd-6-col-8
              move rez-free           to ydk-fre
              move ydk-fre            to gd-6-col-9
              move rez-bebek          to ydk-bebe
              move ydk-bebe           to gd-6-col-10
           end-if 
        end-if 
        move rez-voucher        to gd-6-col-11
        initialize konum-rec
        move rez-oda-konumu     to konum-anahtar
        read konum no lock invalid
              move "Hata"       to konum-adi
        end-read 
              move konum-adi    to gd-6-col-12(1:6)
              move "-"          to gd-6-col-12(7:1)
        initialize konum-rec
        move rez-fiyat-konumu     to konum-anahtar
        read konum no lock invalid
              move "Hata"       to konum-adi
        end-read 
              move konum-adi    to gd-6-col-12(8:)
*        initialize konum-rec
*        move rez-oda-konumu     to konum-anahtar
*        read konum no lock invalid 
*             move "Hata"    to konum-adi
*        end-read 
*            move konum-adi      to gd-6-col-12
*        move rez-rehber         to kodlar02-kodu 
*        move "R"                to kodlar02-tipi
*        read kodlar02 no lock invalid
*             move "          "  to gd-6-col-13
*        not invalid
*            move kodlar02-adi   to gd-6-col-13
*        end-read
        if rez-firma not = spaces
            initialize firma-rec
            move rez-firma      to firma-kodu
            read firma no lock invalid
                 move "Tanimsiz..."  to firma-adi
            end-read 
                move firma-adi       to gd-6-col-13
        end-if 
        move REZ-GEL-SAAT       to gd-6-col-14
        move REZ-GEL-dak        to gd-6-col-15
        move rez-git-saat       to gd-6-col-16
        move rez-git-dak        to gd-6-col-17
        initialize ulke-rec
        move rez-ulke           to ulke-anah1 
        read ulke no lock invalid
             move "Tanimsiz...."      to gd-6-col-18
        not invalid
            move ulke-adi             to gd-6-col-18        
        end-read
        move rez-odano                to o-kisa 
            perform oda-uzat
            move o-uzun to gd-6-col-1
        move rez-doviz                to doviz-kodu
        read doviz no lock invalid
             move "Tanimsiz Doviz Kodu" to gd-6-col-20
        end-read
        move d-adi-1                  to gd-6-col-20
        move rez-fiyati               to efiyat
        move efiyat                   to gd-6-col-21

        move doviz-alis              to zkur
        move zkur                    to gd-6-col-22

        move rez-not1                 to gd-6-col-23
        move rez-not2                 to gd-6-col-24
        move rez-folio                to gd-6-col-25
        if yan-ciksin not = 1
           perform geceleme-bul
           move kac-gece                 to z3
           move z3                       to gd-6-col-26
        else
          if yanrez-sirano = 1
           perform geceleme-bul
           move kac-gece                 to z3
           move z3                       to gd-6-col-26
          end-if 
        end-if 
        
        move rez-al-gun               to gd-6-col-27(1:2)
        move "/"                      to gd-6-col-27(3:1)
        move rez-al-ay                to gd-6-col-27(4:2)
        move "/"                      to gd-6-col-27(6:1)
        move rez-al-yil               to gd-6-col-27(7:4)
        move toplam-cast-fiyati       to z-15
        move z-15                     to gd-6-col-28
        move toplam-dv                to z-15
        move z-15                     to gd-6-col-29 
        perform kllnc-oku
        move k-adi                    to gd-6-col-30
        initialize kodlar02-rec
        move "A"                      to kodlar02-tipi
        move rez-pan-tipi             to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Hata"              to kodlar02-adi
        end-read 
        move kodlar02-adi             to gd-6-col-31

        initialize kodlar02-rec                                     |firat pazar kolonu ekleme 10/08/2020
        move "E"       to kodlar02-tipi
        move rez-pazar to kodlar02-kodu
        read kodlar02 no lock invalid 
             move rez-pazar to kodlar02-adi
        end-read
        move kodlar02-adi              to gd-6-col-35

           initialize kodlar02-rec
           move "v"      to kodlar02-tipi
           move rez-vip  to kodlar02-kodu
           read kodlar02 no lock invalid
               initialize kodlar02-rec
           end-read
           move kodlar02-adi to gd-6-col-40

        if konuk-late-zaman > 0                                         |firat late cout kolonu  12/08/2020
           move konuk-late-gel-saat    to gd-6-col-36(1:)
           move ":"                    to gd-6-col-36(3:)
           move konuk-late-gel-dak     to gd-6-col-36(4:)
        end-if

        if konuk-telefon-no <> spaces 
           move konuk-telefon-no      to rez-telefon-no
        end-if
        move rez-telefon-no           to gd-6-col-34

        initialize odalar-rec             |firat oda durum kolonu  12/08/2020
        move rez-odano to odalar-anah
        read odalar no lock invalid
             continue
        end-read 
        initialize kodlar02-rec                                     
        move "C"                to kodlar02-tipi
        move odalar-durumu      to kodlar02-kodu
        read kodlar02 no lock invalid 
             move odalar-durumu to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-6-col-37

        initialize kodlar02-rec                                     
        move "B"                to kodlar02-tipi
        move rez-odeme-tipi   to kodlar02-kodu
        read kodlar02 no lock invalid 
             move "Tanimsiz"    to kodlar02-adi
        end-read
        move kodlar02-adi       to gd-6-col-38

        if grid-occ(32) <> spaces
             move rez-no        to kelime
             move grid-occ(32)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(2) <> spaces  
             move function upper-case(rez-adi) to kelime
             move function upper-case(grid-occ(2))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if                
        end-if

        if grid-occ(3) <> spaces
             move function upper-case(rez-soyadi)   to kelime
             move function upper-case(grid-occ(3))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if

        if grid-occ(4) <> spaces  
             initialize acenta-rec 
             move rez-acenta   to acenta-kodu
             read acenta no lock invalid
                  move "Tanimsiz..."  to acenta-adi
             not invalid
                 move acenta-adi      to ydk-acenta-adi
             end-read
             move function upper-case(ydk-acenta-adi) to kelime
             move function upper-case(grid-occ(4))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(5) <> spaces
             move gd-6-col-5        to kelime
             move grid-occ(5)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0                                    
                exit paragraph  
             end-if
        end-if
        if grid-occ(6) <> spaces
             move gd-6-col-6        to kelime
             move grid-occ(6)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(7) <> spaces
             move rez-buyuk        to kelime
             move grid-occ(7)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(8) <> spaces
             move rez-kucuk        to kelime
             move grid-occ(8)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(9) <> spaces
             move rez-free        to kelime
             move grid-occ(9)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(10) <> spaces
             move rez-bebek        to kelime
             move grid-occ(10)       to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(11) <> spaces         
             move function upper-case(rez-voucher) to kelime
             move function upper-case(grid-occ(11))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy
             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(12) <> spaces         
             initialize konum-rec
             move rez-oda-konumu           to konum-anahtar
             read konum no lock invalid 
                  continue 
             end-read 
             move function upper-case(konum-adi) to kelime
             move function upper-case(grid-occ(12))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(13) <> spaces  
             initialize firma-rec ydk-firma-adi
             move rez-firma   to firma-kodu
             read firma no lock invalid
                  move "Tanimsiz..."  to firma-adi
             not invalid
                 move firma-adi      to ydk-firma-adi
             end-read
             move function upper-case(ydk-firma-adi) to kelime
             move function upper-case(grid-occ(13))  to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(14) <> spaces         
             move rez-gel-saat   to kelime
             move grid-occ(14)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if

        if grid-occ(15) <> spaces         
             move rez-gel-dak      to kelime
             move grid-occ(15)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if

        if grid-occ(16) <> spaces         
             move rez-git-saat   to kelime
             move grid-occ(16)   to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if

        if grid-occ(17) <> spaces         
             move rez-git-dak      to kelime
             move grid-occ(17)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(18) <> spaces
             initialize ulke-rec 
             move rez-ulke         to ulke-anah
             read ulke no lock invalid
                  move "   "       to ulke-adi
             end-read 
             move ulke-adi         to kelime
             move grid-occ(18)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if

        if grid-occ(1) <> spaces
             move rez-odano        to o-kisa 
            perform oda-uzat
            move o-uzun to kelime
             move grid-occ(1)     to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(20) <> spaces
             initialize doviz-rec
             move rez-doviz        to doviz-kodu
             read doviz no lock invalid 
                  move "  "        to D-KISA-ADI
             end-read 
             move D-KISA-ADI        to kelime
             move grid-occ(20)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if        

        if grid-occ(21) <> spaces
             move rez-fiyati        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(21)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(19) <> spaces
             move rez-grup-no        to z-fiyat
             move z-fiyat           to kelime
             move grid-occ(19)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0 
                exit paragraph  
             end-if
        end-if
        if grid-occ(23) <> spaces
             move rez-not1        to kelime
             move grid-occ(23)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0                 
                exit paragraph  
             end-if
        end-if
        if grid-occ(24) <> spaces
             move rez-not2        to kelime
             move grid-occ(24)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0               
                exit paragraph  
             end-if
        end-if
        if grid-occ(31) <> spaces
             initialize kodlar02-rec
             move rez-pan-tipi      to kodlar02-kodu
             move "A"               to kodlar02-tipi
             read kodlar02 no lock invalid
                  continue 
             end-read 
             move function upper-case(kodlar02-adi)          to kelime
             move grid-occ(31)      to aranan-kelime
             move 0 to aranan-i aranan-kelime-boy
             inspect aranan-kelime tallying aranan-kelime-boy
                     for trailing spaces 
             compute aranan-kelime-boy = function length(aranan-kelime) -
                                         aranan-kelime-boy

             inspect kelime tallying aranan-i 
                     for all aranan-kelime(1:aranan-kelime-boy)
             if aranan-i = 0              
                exit paragraph  
             end-if
        end-if
        initialize cast-rec 
        move rez-gir-tar to cast-tarih
        move rez-no      to cast-rez-no
        read cast no lock invalid
                exit paragraph  
        not invalid 
            if cast-share = 0 or spaces
                if yan-ciksin not = 1
                add 1            to gel-toplam
                add rez-buyuk    to gel-toplam-buyuk
                add rez-kucuk    to gel-toplam-kucuk
                add rez-free     to gel-toplam-free
                add rez-bebek    to gel-toplam-bebek
                add kac-gece     to top-kac-gece
                else
                if yanrez-sirano = 1
                add 1            to gel-toplam
                add rez-buyuk    to gel-toplam-buyuk
                add rez-kucuk    to gel-toplam-kucuk
                add rez-free     to gel-toplam-free
                add rez-bebek    to gel-toplam-bebek
                add kac-gece     to top-kac-gece

                end-if 
                end-if 
            end-if
        end-read 
 
        modify gd-6, RECORD-TO-ADD(gd6-rec)

        modify gd-6(kayit-adet + 2,1) hidden-data = rez-no
        modify gd-6(kayit-adet + 2,2) hidden-data = rez-folio
        if rez-durumu = "S"
           modify gd-6(xgel-toplam)ROW-COLOR = 416
        end-if
        if rez-c-in = "E" and 
           cin-oda-cikmasin not = 1
             modify gd-6(xgel-toplam)ROW-COLOR = 256
        end-if
         if rez-vip not = "N" and  
            rez-vip not = " "
            modify gd-6(xgel-toplam + 2) row-color = 385          
         else
            if rez-gr-olabilir = 1
               modify gd-6(xgel-toplam + 2) row-color = 480          
            end-if 
         end-if
         add 1 to kayit-adet
        .
*
 gd-6-Ev-Other.
    evaluate event-type
     when msg-goto-cell-mouse
     when msg-goto-cell
          inquire gd-6(event-data-2,34), cell-data in cell-rez 
          perform not-goster

          inquire gd-6(event-data-2,1), cell-data in temp-oda
          perform oda-tip-goster
     when msg-begin-entry
 
*          if event-data-2 not = 2
             move event-action-fail to event-action
*          end-if
*     when msg-finish-entry
*
*         inquire gd-6(event-data-2,event-data-1), 
*                    cell-data in grid-occ(event-data-1)
*         perform baslik-yukle-tumrez
*         perform tumrez-cagir
    end-evaluate.
*
 cb-otel-Ex-Ntf-Selchange.
    perform Form1-Ta-1-Aft-Tabchg-Display.
*
 yazdir.
     open i-o genelfis
     move 1 to genelfis-anahtar
     read genelfis no lock invalid
          accept print-no from time
     not invalid
          add 1 to print-no
          rewrite genelfis-rec end-rewrite
     end-read
     close genelfis
**************************
     initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya

     set  dokumer-asya-set to true
     move print-no         to dokumer-dosya-adi
     open output dokumer
*/WINDOW TITLE
     initialize dokumer-rec detay
     move "W"                  to det-dokumer-20(1:)
     move "Rezervasyon Arama Filtresi" to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR
     initialize dokumer-rec detay
     move "1"          to det-dokumer-20(10:1)
     move "B"                  to det-dokumer-20(1:1)

     evaluate Form1-Ta-1-Value
     when 1
        move "Gelmesi Beklenenler" to det-filler
     when 2
        move "Gitmesi Beklenenler" to det-filler
     when 3
        move "inhouse Listesi"     to det-filler
     when 4
        move "Gerceklesen C/in"    to det-filler
     when 5
        move "Gerceklesen C/out"   to det-filler
     when 6
        move "Tum Rezervasyonlar"  to det-filler
     end-evaluate 

     write dokumer-rec from detay

     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:1)
     write dokumer-rec from detay

*/ DOKUMER OZELLIKLER-REC
     initialize dokumer-rec detay
     move "O" to det-dokumer-20(1:)
     move "E" to dokumer-oto-sayfa-basi
     move 56  to dokumer-oto-sayfa-satir
     move "|" to dokumer-detay-kolon-ayirici
     move "LLLLLLLLLLLLLLLLLLLLLLLLLL" to dokumer-align-occ
     move dokumer-ozellikler-rec     to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR  

     initialize dokumer-rec detay 
     move "1"          to det-dokumer-20(10:1)
     move "D1"                          to det-dokumer-20(1:2) 
 
     evaluate Form1-Ta-1-Value
     when 1
         perform gel-rez-baslik-yazdir
     when 2
         perform git-rez-baslik-yazdir
     when 3
         perform inh-rez-baslik-yazdir
     when 4
         perform gercin-rez-baslik-yazdir
     when 5
         perform gercout-rez-baslik-yazdir
     when 6
         perform tum-rez-baslik-yazdir
     end-evaluate 
     
     move "|" to fil-1 fil-2 fil-3 fil-4  fil-5  fil-6
                 fil-7 fil-8 fil-9 fil-10 fil-11 fil-12 fil-13
                 fil-14 fil-15 fil-16 fil-17 fil-18 fil-19 fil-20
                 fil-21 fil-22 fil-23 fil-24 fil-25 fil-26 fil-27
                 fil-28 fil-29 fil-30 fil-31 fil-33 fil-34 fil-35
     write dokumer-rec from detay

     initialize dokumer-rec detay
     move "D2"           to det-dokumer-20(1:2)
     move "-"            to det-dokumer-20(5:1)
     move all "-" to det-1 det-2 det-3 det-4  det-5  det-6
                 det-7 det-8 det-9 det-10 det-11 det-12 det-13
                 det-14 det-15 det-16 det-17 det-18 det-19 det-20
                 det-21 det-22 det-23 det-24 det-25 det-26 det-27 
                 det-28 det-29 det-30 det-31 det-33 det-34 det-35
     write dokumer-rec from detay
**************************
     evaluate form1-ta-1-value
     when 1
        perform gel-rez-dokumer-yazdir
     when 2
        perform git-rez-dokumer-yazdir
     when 3
        perform inh-rez-dokumer-yazdir
     when 4
        perform gercin-rez-dokumer-yazdir
     when 5
        perform gercout-rez-dokumer-yazdir
     when 6
        perform tum-rez-dokumer-yazdir
     end-evaluate 


              initialize dokumer-rec detay 
              move "A"          to det-dokumer-20(3:1)
              move 481          to det-renk1
              move "1"          to det-dokumer-20(10:1)                         

              move gel-toplam   to z6
              move z6           to det-1
              move gel-toplam-buyuk   to z5
              move z5           to det-7
              move gel-toplam-kucuk   to z5
              move z5           to det-8
              move gel-toplam-free   to z5
              move z5           to det-9
              move gel-toplam-bebek   to z5
              move z5           to det-10

              write dokumer-rec from detay

              close dokumer
                 call dokumer-prog on exception
                      perform callerr-proc
              not on exception
                      cancel dokumer-prog
              end-call.
*
 gel-rez-baslik-yazdir.
     inquire gd-1,last-row in son-satir
     perform varying i from 1 by 1 until i > 1  
                 inquire gd-1(i),
                         record-data gd1-rec
                 move gd-1-col-1    to det-1
                 move gd-1-col-2    to det-2
                 move gd-1-col-3    to det-3
                 move gd-1-col-4    to det-4
                 move gd-1-col-5    to det-5
                 move gd-1-col-6    to det-6
                 move gd-1-col-7    to det-7
                 move gd-1-col-8    to det-8
                 move gd-1-col-9    to det-9
                 move gd-1-col-10   to det-10
                 move gd-1-col-11   to det-11
                 move gd-1-col-12   to det-12
                 move gd-1-col-13   to det-13
                 move gd-1-col-14   to det-14
                 move gd-1-col-15   to det-15
                 move gd-1-col-16   to det-16
                 move gd-1-col-17   to det-17
                 move gd-1-col-18   to det-18
                 move gd-1-col-19   to det-19
                 move gd-1-col-20   to det-20
                 move gd-1-col-21   to det-21
                 move gd-1-col-22   to det-22
                 move gd-1-col-23   to det-23
                 move gd-1-col-24   to det-24
                 move gd-1-col-25   to det-25  
                 move gd-1-col-26   to det-26  
                 move gd-1-col-27   to det-27  
                 move gd-1-col-28   to det-28  
                 move gd-1-col-29   to det-29  
                 move gd-1-col-30   to det-30
                 move gd-1-col-31   to det-31
                 move gd-1-col-33   to det-33
                 move gd-1-col-34   to det-34
                 move gd-1-col-35   to det-35
     end-perform.
*
 git-rez-baslik-yazdir.
     inquire gd-3,last-row in son-satir
     perform varying i 
            from 1
            by 1
            until i > 1  
                 |initialize dokumer-rec detay
                 inquire gd-3(i),
                         record-data gd3-rec
                 move gd-3-col-1    to det-1
                 move gd-3-col-2    to det-2
                 move gd-3-col-3    to det-3
                 move gd-3-col-4    to det-4
                 move gd-3-col-5    to det-5
                 move gd-3-col-6    to det-6
                 move gd-3-col-7    to det-7
                 move gd-3-col-8    to det-8
                 move gd-3-col-9    to det-9
                 move gd-3-col-10   to det-10
                 move gd-3-col-11   to det-11
                 move gd-3-col-12   to det-12
                 move gd-3-col-13   to det-13
                 move gd-3-col-14   to det-14
                 move gd-3-col-15   to det-15
                 move gd-3-col-16   to det-16
                 move gd-3-col-17   to det-17
                 move gd-3-col-18   to det-18
                 move gd-3-col-19   to det-19
                 move gd-3-col-20   to det-20
                 move gd-3-col-21   to det-21
                 move gd-3-col-22   to det-22
                 move gd-3-col-23   to det-23
                 move gd-3-col-24   to det-24
                 move gd-3-col-25   to det-25                
                 move gd-3-col-26   to det-26
                 move gd-3-col-27   to det-27                
                 move gd-3-col-28   to det-28  
                 move gd-3-col-29   to det-29  
                 move gd-3-col-30   to det-30
                 move gd-3-col-31   to det-31
                 move gd-3-col-33   to det-33
                 move gd-3-col-34   to det-34
                 move gd-3-col-35   to det-35
     end-perform.
*
 inh-rez-baslik-yazdir.
     inquire gd-2,last-row in son-satir
     perform varying i 
            from 1
            by 1
            until i > 1  
                 |initialize dokumer-rec detay
                 inquire gd-2(i),
                         record-data gd2-rec
                 move gd-2-col-1    to det-1
                 move gd-2-col-2    to det-2
                 move gd-2-col-3    to det-3
                 move gd-2-col-4    to det-4
                 move gd-2-col-5    to det-5
                 move gd-2-col-6    to det-6
                 move gd-2-col-7    to det-7
                 move gd-2-col-8    to det-8
                 move gd-2-col-9    to det-9
                 move gd-2-col-10   to det-10
                 move gd-2-col-11   to det-11
                 move gd-2-col-12   to det-12
                 move gd-2-col-13   to det-13
                 move gd-2-col-14   to det-14
                 move gd-2-col-15   to det-15
                 move gd-2-col-16   to det-16
                 move gd-2-col-17   to det-17
                 move gd-2-col-18   to det-18
                 move gd-2-col-19   to det-19
                 move gd-2-col-20   to det-20
                 move gd-2-col-21   to det-21
                 move gd-2-col-22   to det-22
                 move gd-2-col-23   to det-23
                 move gd-2-col-24   to det-24
                 move gd-2-col-25   to det-25                
                 move gd-2-col-26   to det-26
                 move gd-2-col-27   to det-27 
                 move gd-2-col-28   to det-28  
                 move gd-2-col-29   to det-29  
                 move gd-2-col-30   to det-30
                 move gd-2-col-31   to det-31
                 move gd-2-col-33   to det-33
                 move gd-2-col-34   to det-34
                 move gd-2-col-35   to det-35
     end-perform.
*
 gercin-rez-baslik-yazdir.
     inquire gd-4,last-row in son-satir
     perform varying i 
            from 1
            by 1
            until i > 1  
                 |initialize dokumer-rec detay
                 inquire gd-4(i),
                         record-data gd4-rec
                 move gd-4-col-1    to det-1
                 move gd-4-col-2    to det-2
                 move gd-4-col-3    to det-3
                 move gd-4-col-4    to det-4
                 move gd-4-col-5    to det-5
                 move gd-4-col-6    to det-6
                 move gd-4-col-7    to det-7
                 move gd-4-col-8    to det-8
                 move gd-4-col-9    to det-9
                 move gd-4-col-10   to det-10
                 move gd-4-col-11   to det-11
                 move gd-4-col-12   to det-12
                 move gd-4-col-13   to det-13
                 move gd-4-col-14   to det-14
                 move gd-4-col-15   to det-15
                 move gd-4-col-16   to det-16
                 move gd-4-col-17   to det-17
                 move gd-4-col-18   to det-18
                 move gd-4-col-19   to det-19
                 move gd-4-col-20   to det-20
                 move gd-4-col-21   to det-21
                 move gd-4-col-22   to det-22
                 move gd-4-col-23   to det-23
                 move gd-4-col-24   to det-24
                 move gd-4-col-25   to det-25                
                 move gd-4-col-26   to det-26
                 move gd-4-col-27   to det-27 
                 move gd-4-col-28   to det-28  
                 move gd-4-col-29   to det-29  
                 move gd-4-col-30   to det-30
                 move gd-4-col-31   to det-31
                 move gd-4-col-33   to det-33
                 move gd-4-col-34   to det-34
                 move gd-4-col-35   to det-35
     end-perform.
*
 gercout-rez-baslik-yazdir.
     inquire gd-5,last-row in son-satir
     perform varying i 
            from 1
            by 1
            until i > 1  
                 |initialize dokumer-rec detay
                 inquire gd-5(i),
                         record-data gd5-rec
                 move gd-5-col-1    to det-1
                 move gd-5-col-2    to det-2
                 move gd-5-col-3    to det-3
                 move gd-5-col-4    to det-4
                 move gd-5-col-5    to det-5
                 move gd-5-col-6    to det-6
                 move gd-5-col-7    to det-7
                 move gd-5-col-8    to det-8
                 move gd-5-col-9    to det-9
                 move gd-5-col-10   to det-10
                 move gd-5-col-11   to det-11
                 move gd-5-col-12   to det-12
                 move gd-5-col-13   to det-13
                 move gd-5-col-14   to det-14
                 move gd-5-col-15   to det-15
                 move gd-5-col-16   to det-16
                 move gd-5-col-17   to det-17
                 move gd-5-col-18   to det-18
                 move gd-5-col-19   to det-19
                 move gd-5-col-20   to det-20
                 move gd-5-col-21   to det-21
                 move gd-5-col-22   to det-22
                 move gd-5-col-23   to det-23
                 move gd-5-col-24   to det-24
                 move gd-5-col-25   to det-25                
                 move gd-5-col-26   to det-26
                 move gd-5-col-27   to det-27 
                 move gd-5-col-28   to det-28  
                 move gd-5-col-29   to det-29  
                 move gd-5-col-30   to det-30
                 move gd-5-col-31   to det-31
                 move gd-5-col-33   to det-33
                 move gd-5-col-34   to det-34
                 move gd-5-col-35   to det-35
     end-perform.
*
 tum-rez-baslik-yazdir.
         
     inquire gd-6,last-row in son-satir
     perform varying i 
            from 1
            by 1
            until i > 1  
                 |initialize dokumer-rec detay
                 inquire gd-6(i),
                         record-data gd6-rec
                 move gd-6-col-1    to det-1
                 move gd-6-col-2    to det-2
                 move gd-6-col-3    to det-3
                 move gd-6-col-4    to det-4
                 move gd-6-col-5    to det-5
                 move gd-6-col-6    to det-6
                 move gd-6-col-7    to det-7
                 move gd-6-col-8    to det-8
                 move gd-6-col-9    to det-9
                 move gd-6-col-10   to det-10
                 move gd-6-col-11   to det-11
                 move gd-6-col-12   to det-12
                 move gd-6-col-13   to det-13
                 move gd-6-col-14   to det-14
                 move gd-6-col-15   to det-15
                 move gd-6-col-16   to det-16
                 move gd-6-col-17   to det-17
                 move gd-6-col-18   to det-18
                 move gd-6-col-19   to det-19
                 move gd-6-col-20   to det-20
                 move gd-6-col-21   to det-21
                 move gd-6-col-22   to det-22
                 move gd-6-col-23   to det-23
                 move gd-6-col-24   to det-24
                 move gd-6-col-25   to det-25                
                 move gd-6-col-26   to det-26
                 move gd-6-col-27   to det-27 
                 move gd-6-col-28   to det-28  
                 move gd-6-col-29   to det-29  
                 move gd-6-col-30   to det-30
                 move gd-6-col-31   to det-31
                 move gd-6-col-33   to det-33
                 move gd-6-col-34   to det-34
                 move gd-6-col-35   to det-35
     end-perform.
*
 gel-rez-dokumer-yazdir.
     inquire gd-1,last-row in son-satir
              perform varying i 
                     from 2
                     by 1
                     until i > son-satir                           
                          initialize dokumer-rec detay
                          inquire gd-1(i),record-data gd1-rec

                          move gd-1-col-1    to det-1
                          move gd-1-col-2    to det-2
                          move gd-1-col-3    to det-3
                          move gd-1-col-4    to det-4
                          move gd-1-col-5    to det-5
                          move gd-1-col-6    to det-6
                          move gd-1-col-7    to det-7
                          move gd-1-col-8    to det-8
                          move gd-1-col-9    to det-9
                          move gd-1-col-10   to det-10
                          move gd-1-col-11   to det-11
                          move gd-1-col-12   to det-12
                          move gd-1-col-13   to det-13
                          move gd-1-col-14   to det-14
                          move gd-1-col-15   to det-15
                          move gd-1-col-16   to det-16
                          move gd-1-col-17   to det-17
                          move gd-1-col-18   to det-18
                          move gd-1-col-19   to det-19
                          move gd-1-col-20   to det-20
                          move gd-1-col-21   to det-21
                          move gd-1-col-22   to det-22
                          move gd-1-col-23   to det-23
                          move gd-1-col-24   to det-24
                          move gd-1-col-25   to det-25
                          move gd-1-col-26   to det-26
                          move gd-1-col-27   to det-27
                          move gd-1-col-28   to det-28  
                          move gd-1-col-29   to det-29  
                          move gd-1-col-30   to det-30
                          move gd-1-col-31   to det-31
                          move gd-1-col-33   to det-33
                          move gd-1-col-34   to det-34
                          move gd-1-col-35   to det-35

              move "|" to fil-1 fil-2 fil-3 fil-4  fil-5  fil-6
                          fil-7 fil-8 fil-9 fil-10 fil-11 fil-12 fil-13
                          fil-14 fil-15 fil-16 fil-17 fil-18 fil-19 fil-20
                          fil-21 fil-22 fil-23 fil-24 fil-25 fil-26 fil-27
                          fil-28 fil-29 fil-30 fil-31 fil-33 fil-34 fil-35
                          write dokumer-rec from detay
                        
              end-perform.
*
 git-rez-dokumer-yazdir.
     inquire gd-3,last-row in son-satir
              perform varying i 
                     from 2
                     by 1
                     until i > son-satir 

                          initialize dokumer-rec detay
                          inquire gd-3(i),record-data gd3-rec
              
                          move gd-3-col-1    to det-1
                          move gd-3-col-2    to det-2
                          move gd-3-col-3    to det-3
                          move gd-3-col-4    to det-4
                          move gd-3-col-5    to det-5

                          move gd-3-col-6    to det-6
                          move gd-3-col-7    to det-7
                          move gd-3-col-8    to det-8
                          move gd-3-col-9    to det-9
                          move gd-3-col-10   to det-10
                          move gd-3-col-11   to det-11
                          move gd-3-col-12   to det-12
                          move gd-3-col-13   to det-13
                          move gd-3-col-14   to det-14
                          move gd-3-col-15   to det-15
                          move gd-3-col-16   to det-16
                          move gd-3-col-17   to det-17
                          move gd-3-col-18   to det-18
                          move gd-3-col-19   to det-19
                          move gd-3-col-20   to det-20
                          move gd-3-col-21   to det-21
                          move gd-3-col-22   to det-22
                          move gd-3-col-23   to det-23
                          move gd-3-col-24   to det-24
                          move gd-3-col-25   to det-25
                          move gd-3-col-26   to det-26
                          move gd-3-col-27   to det-27
                          move gd-3-col-28   to det-28  
                          move gd-3-col-29   to det-29  
                          move gd-3-col-30   to det-30
                          move gd-3-col-31   to det-31
                          move gd-3-col-33   to det-33
                          move gd-3-col-34   to det-34
                          move gd-3-col-35   to det-35

              move "|" to fil-1 fil-2 fil-3 fil-4  fil-5  fil-6
                          fil-7 fil-8 fil-9 fil-10 fil-11 fil-12 fil-13
                          fil-14 fil-15 fil-16 fil-17 fil-18 fil-19 fil-20
                          fil-21 fil-22 fil-23 fil-24 fil-25 fil-26 fil-27
                          fil-28 fil-29 fil-30 fil-31 fil-33 fil-34 fil-35
                          write dokumer-rec from detay
                        
              end-perform.
*
 inh-rez-dokumer-yazdir.
     inquire gd-2,last-row in son-satir
              perform varying i 
                     from 2
                     by 1
                     until i > son-satir 

                          initialize dokumer-rec detay
                          inquire gd-2(i),record-data gd2-rec
               
                          move gd-2-col-1    to det-1
                          move gd-2-col-2    to det-2
                          move gd-2-col-3    to det-3
                          move gd-2-col-4    to det-4
                          move gd-2-col-5    to det-5
                          move gd-2-col-6    to det-6
                          move gd-2-col-7    to det-7
                          move gd-2-col-8    to det-8
                          move gd-2-col-9    to det-9
                          move gd-2-col-10   to det-10
                          move gd-2-col-11   to det-11
                          move gd-2-col-12   to det-12
                          move gd-2-col-13   to det-13
                          move gd-2-col-14   to det-14
                          move gd-2-col-15   to det-15
                          move gd-2-col-16   to det-16
                          move gd-2-col-17   to det-17
                          move gd-2-col-18   to det-18
                          move gd-2-col-19   to det-19
                          move gd-2-col-20   to det-20
                          move gd-2-col-21   to det-21
                          move gd-2-col-22   to det-22
                          move gd-2-col-23   to det-23
                          move gd-2-col-24   to det-24
                          move gd-2-col-25   to det-25
                          move gd-2-col-26   to det-26
                          move gd-2-col-27   to det-27
                          move gd-2-col-28   to det-28  
                          move gd-2-col-29   to det-29 
                          move gd-2-col-30   to det-30
                          move gd-2-col-31   to det-31
                          move gd-2-col-33   to det-33
                          move gd-2-col-34   to det-34
                          move gd-2-col-35   to det-35
              move "|" to fil-1 fil-2 fil-3 fil-4  fil-5  fil-6
                          fil-7 fil-8 fil-9 fil-10 fil-11 fil-12 fil-13
                          fil-14 fil-15 fil-16 fil-17 fil-18 fil-19 fil-20
                          fil-21 fil-22 fil-23 fil-24 fil-25 fil-26 fil-27
                          fil-28 fil-29 fil-30 fil-31 fil-33 fil-34 fil-35

                          write dokumer-rec from detay
                        
              end-perform.
*
 gercin-rez-dokumer-yazdir.
     inquire gd-4,last-row in son-satir
              perform varying i 
                     from 2
                     by 1
                     until i > son-satir 

                          initialize dokumer-rec detay
                          inquire gd-4(i),record-data gd4-rec
                
                          move gd-4-col-1    to det-1
                          move gd-4-col-2    to det-2
                          move gd-4-col-3    to det-3
                          move gd-4-col-4    to det-4
                          move gd-4-col-5    to det-5
                          move gd-4-col-6    to det-6
                          move gd-4-col-7    to det-7
                          move gd-4-col-8    to det-8
                          move gd-4-col-9    to det-9
                          move gd-4-col-10   to det-10
                          move gd-4-col-11   to det-11
                          move gd-4-col-12   to det-12
                          move gd-4-col-13   to det-13
                          move gd-4-col-14   to det-14
                          move gd-4-col-15   to det-15
                          move gd-4-col-16   to det-16
                          move gd-4-col-17   to det-17
                          move gd-4-col-18   to det-18
                          move gd-4-col-19   to det-19
                          move gd-4-col-20   to det-20
                          move gd-4-col-21   to det-21
                          move gd-4-col-22   to det-22
                          move gd-4-col-23   to det-23
                          move gd-4-col-24   to det-24
                          move gd-4-col-25   to det-25
                          move gd-4-col-26   to det-26
                          move gd-4-col-27   to det-27
                          move gd-4-col-28   to det-28  
                          move gd-4-col-29   to det-29 
                          move gd-4-col-30   to det-30
                          move gd-4-col-31   to det-31
                          move gd-4-col-33   to det-33
                          move gd-4-col-34   to det-34
                          move gd-4-col-35   to det-35

              move "|" to fil-1 fil-2 fil-3 fil-4  fil-5  fil-6
                          fil-7 fil-8 fil-9 fil-10 fil-11 fil-12 fil-13
                          fil-14 fil-15 fil-16 fil-17 fil-18 fil-19 fil-20
                          fil-21 fil-22 fil-23 fil-24 fil-25 fil-26 fil-27
                          fil-28 fil-29 fil-30 fil-31 fil-33 fil-34 fil-35
                          write dokumer-rec from detay
                        
              end-perform.
*
 gercout-rez-dokumer-yazdir.
     inquire gd-5,last-row in son-satir
              perform varying i 
                     from 2
                     by 1
                     until i > son-satir 

                          initialize dokumer-rec detay
                          inquire gd-5(i),record-data gd5-rec
                 
                          move gd-5-col-1    to det-1
                          move gd-5-col-2    to det-2
                          move gd-5-col-3    to det-3
                          move gd-5-col-4    to det-4
                          move gd-5-col-5    to det-5
                          move gd-5-col-6    to det-6
                          move gd-5-col-7    to det-7
                          move gd-5-col-8    to det-8
                          move gd-5-col-9    to det-9
                          move gd-5-col-10   to det-10
                          move gd-5-col-11   to det-11
                          move gd-5-col-12   to det-12
                          move gd-5-col-13   to det-13
                          move gd-5-col-14   to det-14
                          move gd-5-col-15   to det-15
                          move gd-5-col-16   to det-16
                          move gd-5-col-17   to det-17
                          move gd-5-col-18   to det-18
                          move gd-5-col-19   to det-19
                          move gd-5-col-20   to det-20
                          move gd-5-col-21   to det-21
                          move gd-5-col-22   to det-22
                          move gd-5-col-23   to det-23
                          move gd-5-col-24   to det-24
                          move gd-5-col-25   to det-25
                          move gd-5-col-26   to det-26
                          move gd-5-col-27   to det-27
                          move gd-5-col-28   to det-28  
                          move gd-5-col-29   to det-29 
                          move gd-5-col-30   to det-30
                          move gd-5-col-31   to det-31
                          move gd-5-col-33   to det-33
                          move gd-5-col-34   to det-34
                          move gd-5-col-35   to det-35
              move "|" to fil-1 fil-2 fil-3 fil-4  fil-5  fil-6
                          fil-7 fil-8 fil-9 fil-10 fil-11 fil-12 fil-13
                          fil-14 fil-15 fil-16 fil-17 fil-18 fil-19 fil-20
                          fil-21 fil-22 fil-23 fil-24 fil-25 fil-26 fil-27
                          fil-28 fil-29 fil-30 fil-31 fil-33 fil-34 fil-35
                          write dokumer-rec from detay
                        
              end-perform.
*
 tum-rez-dokumer-yazdir.
     inquire gd-6,last-row in son-satir
              perform varying i 
                     from 2
                     by 1
                     until i > son-satir 

                          initialize dokumer-rec detay
                          inquire gd-6(i),record-data gd6-rec
             

                          move gd-6-col-1    to det-1
                          move gd-6-col-2    to det-2
                          move gd-6-col-3    to det-3
                          move gd-6-col-4    to det-4
                          move gd-6-col-5    to det-5
                          move gd-6-col-6    to det-6
                          move gd-6-col-7    to det-7
                          move gd-6-col-8    to det-8
                          move gd-6-col-9    to det-9
                          move gd-6-col-10   to det-10
                          move gd-6-col-11   to det-11
                          move gd-6-col-12   to det-12
                          move gd-6-col-13   to det-13
                          move gd-6-col-14   to det-14
                          move gd-6-col-15   to det-15
                          move gd-6-col-16   to det-16
                          move gd-6-col-17   to det-17
                          move gd-6-col-18   to det-18
                          move gd-6-col-19   to det-19
                          move gd-6-col-20   to det-20
                          move gd-6-col-21   to det-21
                          move gd-6-col-22   to det-22
                          move gd-6-col-23   to det-23
                          move gd-6-col-24   to det-24
                          move gd-6-col-25   to det-25
                          move gd-6-col-26   to det-26
                          move gd-6-col-27   to det-27
                          move gd-6-col-28   to det-28  
                          move gd-6-col-29   to det-29 
                          move gd-6-col-30   to det-30 
                          move gd-6-col-31   to det-31
                          move gd-6-col-33   to det-33
                          move gd-6-col-34   to det-34
                          move gd-6-col-35   to det-35

              move "|" to fil-1 fil-2 fil-3 fil-4  fil-5  fil-6
                          fil-7 fil-8 fil-9 fil-10 fil-11 fil-12 fil-13
                          fil-14 fil-15 fil-16 fil-17 fil-18 fil-19 fil-20
                          fil-21 fil-22 fil-23 fil-24 fil-25 fil-26 fil-27
                          fil-28 fil-29 fil-30 fil-31 fil-33 fil-34 fil-35
                          write dokumer-rec from detay
                        
              end-perform.
*
 geceleme-bul.
      initialize kac-gece 
      move rez-gir-tar to takvim-anah
      start takvim key >= takvim-anah
      invalid
      continue
      not invalid
      perform until fs-takvim = "10"
            read takvim next no lock end move "10" to fs-takvim
              not end
                if takvim-anah < rez-cik-tar
                  add 1 to kac-gece
                  else
                  move "10" to fs-takvim
                end-if
             end-read      
      end-perform
      end-start.
*
 toplam-rez-tutar.
      initialize cast-rec toplam-cast-fiyati
      move rez-no            to cast-rez-no
      start cast key not < CAST-ANAH1 invalid 
          continue 
      not invalid 
      perform with test after until fs-cast = "10"
      read cast next no lock end move "10"  to fs-cast
      not at end 
              if cast-rez-no <> rez-no
                 exit perform 
              end-if
              if cast-tarih = rez-cik-tar 
                  exit perform cycle 
              end-if 
              add cast-fiyati        to toplam-cast-fiyati
      end-read 
      end-perform
      end-start

      initialize kur-rec toplam-dv
      move rez-gir-tar            to kur-tarih
      move rez-banka              to kur-banka
      move rez-doviz              to kur-doviz
      read kur no lock invalid 
            continue 

      not invalid 
            compute toplam-dv rounded = 
                    toplam-cast-fiyati * doviz-alis
      end-read.
*
 kllnc-oku.
      initialize kllnc-rec
      move rez-staf          to k-kodu
      read kllnc no lock invalid 
           move "Hata"   to k-adi
      end-read 
      .
 
*
 aft-yukle.
     evaluate Form1-Ta-1-Value
     when 1
        modify gd-1,visible = 0
        perform baslik-yukle
        perform gel-cagir 
        modify gd-1,visible = 1 
     when 2 
        modify gd-3,visible = 0
        perform baslik-yukle-git
        perform git-cagir 
        modify gd-3,visible = 1 
     when 3 
        modify gd-2,visible = 0 
        perform baslik-yukle-inhouse
        perform inhose-cagir 
        modify gd-2,visible = 1 
     when 4
        modify gd-4,visible =0 
        perform baslik-yukle-gercin
             set inhouse to true 
                perform gercin-cagir
             set history to true 
                perform gercin-cagir
*        perform gercin-cagir
        modify gd-4,visible = 1 
     when 5
        modify gd-5,visible = 0
        perform baslik-yukle-gercout
        perform gercout-cagir
         modify gd-5,visible = 1 
     when 6
        modify gd-1,visible = 0
        modify gd-2,visible = 0
        modify gd-3,visible = 0
        modify gd-4,visible = 0
        modify gd-5,visible = 0
        modify gd-6,visible = 0
        perform baslik-yukle-tumrez
        perform tumrez-cagir
        modify gd-6,
               mass-update = 0
        modify gd-6,visible = 1
     end-evaluate.  
*
 Form1-Aft-Routine.
     close odalar2
     .
*
 hucre-renk-bul.
     initialize hucre-renk
     evaluate form1-ta-1-value
         when 1
              evaluate odalar-durumu
                  when house-bt
                       move 464 to hucre-renk
                  when house-co
                  when house-bk
                       move 353 to hucre-renk
                  when house-dt
                  when house-dk
                  when house-ci
                       move 80  to hucre-renk
                  when house-ao
                       move 432 to hucre-renk
              end-evaluate   
*         when 2
*              evaluate odalar-durumu
*                  when house-dt
*                  when house-dk
*                  when house-ci
*                       move 80  to hucre-renk
*                  when house-ao
*                       move 385 to hucre-renk
*              end-evaluate   
*         when 3
*              evaluate odalar-durumu
*                  when house-dt
*                  when house-dk
*                  when house-ci
*                       move 80  to hucre-renk
*                  when house-ao
*                       move 385 to hucre-renk
*              end-evaluate   
*         when 4
*              evaluate odalar-durumu
*                  when house-dt
*                  when house-dk
*                  when house-ci
*                       move 80  to hucre-renk
*                  when house-ao
*                       move 385 to hucre-renk
*              end-evaluate   
*         when 5
*              evaluate odalar-durumu
*                  when house-dt
*                  when house-dk
*                  when house-ci
*                       move 80  to hucre-renk
*                  when house-ao
*                       move 432 to hucre-renk
*              end-evaluate   
     end-evaluate 

     .


 
