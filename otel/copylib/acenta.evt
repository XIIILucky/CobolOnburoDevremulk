* acenta.evt
* acenta.evt is generated from D:\asya\acugt.ytl\otel\acenta.Psf
* This is a generated file. DO NOT modify this file directly.


 Acu-tab-1-Cmd-Tabchanged.
     EVALUATE Event-Type
     WHEN Cmd-Tabchanged
        MOVE Event-Data-1 TO tab-1-value
        MOVE 0 TO Form1-Pg-1-Visible, Form1-Pg-2-Visible,
            Form1-Pg-3-Visible, Form1-Pg-4-Visible, Form1-Pg-5-Visible
        EVALUATE Event-Data-1
        WHEN 1
           MOVE 1 TO Form1-Pg-1-Visible
        WHEN 2
           MOVE 1 TO Form1-Pg-2-Visible
        WHEN 3
           MOVE 1 TO Form1-Pg-3-Visible
        WHEN 4
           MOVE 1 TO Form1-Pg-4-Visible
        WHEN 5
           MOVE 1 TO Form1-Pg-5-Visible
        END-EVALUATE
*       Before-Tabchg-Display
        DISPLAY Form1
        PERFORM after-tab
     END-EVALUATE
     .

 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM exception-procedure
     .

 Form1-Ta-1-Event-Proc.
* 
     EVALUATE Event-Type
     WHEN Cmd-Tabchanged
        PERFORM Tab-1-Ex-Cmd-Tabchanged
     END-EVALUATE
     .

 accept-0206a-Exception-Proc.
     PERFORM HEPSI-TEK
     .
***   start event editor code   ***
*
 Form1-Bef-Create.
     perform adresleri-tasi
     open i-o musteri close musteri
     open input genel
     move 1 to genel-anahtar
     read genel no lock invalid 
         continue
     end-read
     close genel
     move muha-sirketi to hesap-dosya-adres cari-dosya-adres.
     open input kllnc
     move k-kodu-tasi to K-KODU
     read kllnc no lock invalid 
         continue
     end-read
     close kllnc
     if k-fiy-sup not = 1 then 
        move 0 to fiy-enb
     else
        move 1 to fiy-enb
     end-if
     perform  acuserve-adres-aktar
     .     

*
 bef-procedure.
     evaluate control-id
          when 5
              evaluate true
                  when turkce 
                       move "Acenta kodunu giriniz  F1-Acenta yardimi" to mesaj
                  when ingilizce
                       move "Acenta kodunu giriniz  F1-Acenta yardimi" to mesaj
                  when almanca
                        move "Acenta kodunu giriniz  F1-Acenta yardimi" to mesaj
              end-evaluate
          when 9
              evaluate true
                   when turkce 
                        move "Acenta Adini giriniz   " to mesaj
                   when ingilizce
                        move "Acenta Adini giriniz   " to mesaj
                   when almanca
                        move "Acenta Adini giriniz   " to mesaj
              end-evaluate
          when 11                                                                          
              evaluate true
                   when turkce 
                        move "Acenta unvanini giriniz" to mesaj
                   when ingilizce
                        move "Acenta unvanini giriniz" to mesaj
                   when almanca
                        move "Acenta unvanini giriniz" to mesaj
              end-evaluate
          when 13
              evaluate true
                   when turkce 
                        move "Acenta sorumlusunu giriniz" to mesaj
                   when ingilizce
                        move "Acenta sorumlusunu giriniz" to mesaj
                   when almanca
                        move "Acenta sorumlusunu giriniz" to mesaj
              end-evaluate
          when 15
              evaluate true
                   when turkce 
                        move "Acenta muhasebe hesap kodunu giriniz    " to mesaj
                   when ingilizce
                        move "Acenta muhasebe hesap kodunu giriniz    " to mesaj
                   when almanca
                        move "Acenta muhasebe hesap kodunu giriniz    " to mesaj
              end-evaluate
          when 19
              evaluate true
                   when turkce 
                        move "Degisiklikleri kaydetmek icin tiklayiniz" to mesaj
                   when ingilizce
                        move "Degisiklikleri kaydetmek icin tiklayiniz" to mesaj
                   when almanca
                        move "Degisiklikleri kaydetmek icin tiklayiniz" to mesaj
              end-evaluate
          when 20
              evaluate true
                   when turkce 
                        move "Acenta kodunu silmek icin tiklayiniz" to mesaj
                   when ingilizce
                        move "Acenta kodunu silmek icin tiklayiniz" to mesaj
                   when almanca
                        move "Acenta kodunu silmek icin tiklayiniz" to mesaj
              end-evaluate
          when 21
              evaluate true
                   when turkce 
                        move "Acenta kodlari raporunu almak icin tiklayiniz" to mesaj
                   when ingilizce
                        move "Acenta kodlari raporunu almak icin tiklayiniz" to mesaj
                   when almanca
                        move "Acenta kodlari raporunu almak icin tiklayiniz" to mesaj
              end-evaluate
          when 24
              evaluate true
                   when turkce 
                        move "Acenta tipini seciniz" to mesaj
                   when ingilizce
                        move "Acenta tipini seciniz" to mesaj
                   when almanca
                        move "Acenta tipini seciniz" to mesaj
              end-evaluate
          when 22
              evaluate true
                   when turkce 
                        move "Acenta indirim oranini giriniz" to mesaj
                   when ingilizce
                        move "Acenta indirim oranini giriniz" to mesaj
                   when almanca
                        move "Acenta indirim oranini giriniz" to mesaj
              end-evaluate
          when 25
              evaluate true
                   when turkce 
                        move "Raporlarda pazar/ulke ayrimini gormek icin seciniz" to mesaj
                   when ingilizce
                        move "Raporlarda pazar/ulke ayrimini gormek icin seciniz" to mesaj
                   when almanca
                        move "Raporlarda pazar/ulke ayrimini gormek icin seciniz" to mesaj
              end-evaluate
          when 31
              evaluate true
                   when turkce 
                        move "Acentanin musteri getirdigi ulke kodunu giriniz" to mesaj
                   when ingilizce
                        move "Acentanin musteri getirdigi ulke kodunu giriniz" to mesaj
                   when almanca
                        move "Acentanin musteri getirdigi ulke kodunu giriniz" to mesaj
              end-evaluate
          when 32
              evaluate true
                   when turkce 
                        move "Farkli kodlarda yer alan acentalari birbirine raporsal olarak baglayacak pazar kodu" to mesaj
                   when ingilizce
                        move "Farkli kodlarda yer alan acentalari birbirine raporsal olarak baglayacak pazar kodu" to mesaj
                   when almanca
                        move "Farkli kodlarda yer alan acentalari birbirine raporsal olarak baglayacak pazar kodu" to mesaj
              end-evaluate
          when 38
              evaluate true
                   when turkce 
                        move "Acenta adresini giriniz" to mesaj
                   when ingilizce
                        move "Acenta adresini giriniz" to mesaj
                   when almanca
                        move "Acenta adresini giriniz" to mesaj
              end-evaluate
          when 40
              evaluate true
                   when turkce 
                        move "Acenta vergi dairesini giriniz  " to mesaj
                   when ingilizce
                        move "Acenta vergi dairesini giriniz  " to mesaj
                   when almanca
                        move "Acenta vergi dairesini giriniz  " to mesaj
              end-evaluate
          when 42
              evaluate true
                   when turkce 
                        move "Acenta vergi numarasini giriniz" to mesaj
                   when ingilizce
                        move "Acenta vergi numarasini giriniz" to mesaj
                   when almanca
                        move "Acenta vergi numarasini giriniz" to mesaj
              end-evaluate
          when 44
              evaluate true
                   when turkce 
                        move "Acenta ilcesini giriniz ardimi" to mesaj
                   when ingilizce
                        move "Acenta ilcesini giriniz ardimi" to mesaj
                   when almanca
                        move "Acenta ilcesini giriniz ardimi" to mesaj
              end-evaluate
          when 46
              evaluate true
                   when turkce 
                        move "Acenta ilini giriniz " to mesaj
                   when ingilizce
                        move "Acenta ilini giriniz " to mesaj
                   when almanca
                        move "Acenta ilini giriniz " to mesaj
              end-evaluate
          when 48
              evaluate true
                   when turkce 
                        move "Acenta ulkesini giriniz" to mesaj
                   when ingilizce
                        move "Acenta ulkesini giriniz" to mesaj
                   when almanca
                        move "Acenta ulkesini giriniz" to mesaj
              end-evaluate
          when 50
              evaluate true
                   when turkce 
                        move "Acenta telefon numarasini giriniz" to mesaj
                   when ingilizce
                        move "Acenta telefon numarasini giriniz" to mesaj
                   when almanca
                        move "Acenta telefon numarasini giriniz" to mesaj
              end-evaluate
          when 52
              evaluate true
                   when turkce 
                        move "Acenta fax numarasini giriniz" to mesaj
                   when ingilizce
                        move "Acenta fax numarasini giriniz" to mesaj
                   when almanca
                        move "Acenta fax numarasini giriniz" to mesaj
              end-evaluate
          when 54
              evaluate true
                   when turkce 
                        move "Acenta e-mail adresini giriniz" to mesaj
                   when ingilizce
                        move "Acenta e-mail adresini giriniz" to mesaj
                   when almanca
                        move "Acenta e-mail adresini giriniz" to mesaj
              end-evaluate
     end-evaluate.
     modify form1-st-1-handle,
            panel-index = 2
            panel-text = mesaj.
     .
*
 accept-0101-Bef-Procedure.
     initialize okundu
     initialize acenta-rec m-acenta.
     move 0 to combo-0101-value.
       move 0 to combo-0103-value.
     modify tab-1,value = 1
     perform tab-1-Ex-Cmd-Tabchanged.
     display accept-0102,accept-0103,accept-0104,accept-0105,  accept-0105A
             accept-0106,accept-0107 accept-m  accept-mb accept-ma acc-mis-no acc-ps1 acc-kr acc-kra 
             accept-0190 accept-0191 accept-0192 accept-0193 accept-0194 accept-0195  acc-cout
             accept-0196 accept-0197 accept-0198 accept-m-acenta. 
           
    
     perform ava-after 
     perform muh-after 
     perform muh2-after
      initialize   toplam-not
             
        
         display not-ac
     perform bef-procedure.
*
 accept-0101-Aft-Procedure.
    if acenta-kodu = spaces 
        modify button-0101,enabled = false
        modify button-0102,enabled = false
        perform fis-al
        move acenta-no     to acenta-kodu
        display accept-0101 
         modify button-0101,enabled = true
        modify button-0102,enabled = true
     else 
        modify button-0101,enabled = true
        modify button-0102,enabled = true
     end-if.
      initialize otomail-rec
      open i-o otomail acebavel acesch.
      close otomail acebavel acesch.
     open input acenta otomail acebavel acesch.
     read acenta no lock invalid
          initialize acenta-rec          
          initialize otomail-rec
          initialize acebavel-rec 
          initialize acesch-rec 
          inquire accept-0101 value in acenta-kodu
     end-read
     move 1 to okundu
     move acenta-kodu to otomail-acenta-kodu
     move "A" to otomail-tipi
    read otomail no lock invalid 
         continue
    end-read

    move acenta-kodu  to acebavel-acenta-kodu   acesch-acenta-kodu
    read acebavel no lock invalid 
         initialize acebavel-rec  
         move acenta-kodu  to acebavel-acenta-kodu
    end-read 
     read acesch no lock invalid 
         initialize acesch-rec  
         move acenta-kodu  to acesch-acenta-kodu
    end-read 
    move     otomail-acenta-ct       to     odeme-tipi(1:1)
    move     otomail-acenta-gun      to odeme-peryot 
    move     otomail-acenta-os       to once-sonra(1:1)


              display cb-once-sonra cb-odeme-tipi


     move acenta-profil-sirket to ps1
     move acenta-profil-no     to mis-no
     move acenta-tipi          to combo-0101-value.
     if   acenta-kv-tipi = 2 or acenta-kv-tipi =1 then 

     else
        move 0 to  acenta-kv-tipi
     end-if
      move acenta-kv-tipi         to combo-0103-value.
     close acenta otomail acebavel acesch.
     open input nt
     initialize not-rec 
     move "ACE" to not-dos
     move "Default" to not-dos-anah.
     move acenta-kodu to not-dos-anah(8:)
     read nt no lock 
        invalid
           initialize acen-dft
           move  REZPARA-BANKA      to acen-dft-banka
           move  REZPARA-DOVIZ      to acen-dft-doviz
           move  REZPARA-PAN-TIPI   to acen-dft-pan-tipi
           move  REZPARA-ODEME-TIPI to acen-dft-odeme-tipi
           move  rezpara-anlasma    to acen-dft-anlasma
           move  REZPARA-ULKE       to acen-dft-ulke
           move  rezpara-pazar      to acen-dft-pazar
        not invalid 
          move not1 to acen-dft
     end-read
     close nt
     if acen-dft-specialyok-sabit not = 1 then 
       move 0 to acen-dft-specialyok-sabit
       end-if
     display form1-pg-1 form1-pg-2 form1-pg-3 form1-pg-4 form1-pg-5.
     perform pansiyon-oku perform doviz-oku perform banka-oku 
     perform ulke-oku     perform pazar-oku 
     perform anlasma-oku perform odeme-oku
     PERFORM kaynak1-goster      PERFORM kaynak2-goster
     PERFORM kaynak3-goster
     perform not-goster
     perform ava-after 
     perform muh-after 
     perform muh2-after
     perform odaref-after
     perform accept-maa-Aft-Procedure

     initialize rapordayim
     perform merkod-acenta-goster
    .
*
 tab-1-Ex-Cmd-Tabchanged.
     inquire tab-1, value in tab-1-value
     evaluate tab-1-value 
      when  1
        modify tab-1,value = 1
        move 0 to form1-pg-2-visible  form1-pg-3-visible   form1-pg-4-visible form1-pg-5-visible
        move 1 to form1-pg-1-visible
        display form1-pg-2
                form1-pg-1  form1-pg-3   form1-pg-4 form1-pg-5
      when 2 
        modify tab-1,value = 2
        move 0 to form1-pg-1-visible  form1-pg-3-visible  form1-pg-4-visible form1-pg-5-visible
        move 1 to form1-pg-2-visible
        display form1-pg-1
                form1-pg-2  form1-pg-3 form1-pg-4 form1-pg-5
     when 3 
        modify tab-1,value = 3
        move 0 to form1-pg-1-visible  form1-pg-2-visible form1-pg-4-visible form1-pg-5-visible
        move 1 to form1-pg-3-visible
        display form1-pg-1
                form1-pg-2 form1-pg-3  form1-pg-4 form1-pg-5
    when 4 
        modify tab-1,value = 4
        move 0 to form1-pg-1-visible  form1-pg-2-visible form1-pg-3-visible form1-pg-5-visible
        move 1 to form1-pg-4-visible
        display form1-pg-1
                form1-pg-2 form1-pg-3  form1-pg-4 form1-pg-5
    when 5
        modify tab-1,value = 5
        move 0 to form1-pg-1-visible  form1-pg-2-visible form1-pg-3-visible form1-pg-4-visible
        move 1 to form1-pg-5-visible
        display form1-pg-1
                form1-pg-2 form1-pg-3  form1-pg-4 form1-pg-5
        

    end-evaluate     
     .
*
 Form1-Aft-Initdata.
 
     modify combo-0101,
            reset-list = 1
            mass-update = 1
     
              modify combo-0101,item-to-add("0-Normal Acenta","1-House use","2-Complimentary","3-Rate")
        
     modify combo-0101,
            value = "1"
            mass-update = 0

             modify combo-0103,
            reset-list = 1
            mass-update = 1
     
              modify combo-0103,item-to-add("0-Otel Oder","1-AcentaOder","2-MisafirOder")
        
     modify combo-0103,
            value = "1"
            mass-update = 0

      modify c-bag  reset-list = 1
            mass-update = 1. 
            
         initialize bag-value
        modify c-bag item-to-add bag-value
     open i-o baglanti
     close baglanti

     open input baglanti
        initialize baglanti-rec
        start baglanti key > baglanti-kodu invalid continue
            not invalid
               initialize fs-baglanti
               perform until fs-baglanti = "10"
                   read baglanti next no lock 
                      end move "10" to fs-baglanti
                      not end
                         if baglanti-guncel not = 1 then 
                           exit perform cycle
                         end-if
                           initialize bag-value
                         move baglanti-aciklama-1 to bag-value 
                         move baglanti-adi        to bag-value(31:)
                         modify c-bag item-to-add bag-value
                   end-read
               end-perform
         end-start
            initialize bag-value
        modify c-bag value = bag-value
          modify c-bag  
            mass-update = 0.  
     close baglanti
*     if k-kodu-tasi = "ASYA" or "X   "
*        modify pb-1301, visible = true
*        modify pb-1302, visible = true
*     end-if
     .

*
 ava-after. 
         if muha-sirketi = spaces exit paragraph end-if
                open input hesap
              move    ACENTA-avano  to hesap-kodu
              read hesap no lock invalid 
                modify l-ava color = 5
                move "Tanimsiz  Hesap" to hesap-adi
                not invalid 
                modify l-ava color = 2
             end-read
             move hesap-adi to label-avans
              display l-ava
              close hesap.
*
 muh-after. 
        if muha-sirketi = spaces exit paragraph end-if
              open input hesap
              move    ACENTA-muhno  to hesap-kodu
              read hesap no lock invalid 
                modify l-muh color = 5
                move "Tanimsiz  Hesap" to hesap-adi
                not invalid 
                modify l-muh color = 2
             end-read
             move hesap-adi to label-muh
              display l-muh
              close hesap.
*
 muh2-after. 
               if muha-sirketi = spaces exit paragraph end-if
              open input hesap
              move    ACENTA-muhno2  to hesap-kodu
              read hesap no lock invalid 
                modify l-muh2 color = 5
                move "Tanimsiz  Hesap" to hesap-adi
                not invalid 
                modify l-muh2 color = 2
             end-read
             move hesap-adi to label-muh2
              display l-muh2
              close hesap.
*
 f1ler.
       evaluate control-id
          when 144
             initialize acenta-cagir
             call "/asya/ytl/obj/otel/acenara.asy" using acenta-cagir
                 on exception perform callerr-proc
                 not on exception
                 cancel "/asya/ytl/obj/otel/acenara.asy" 
              end-call
              move acenta-cagir     to ACENTA-rate-acenta OF ACENTA
               display accept-maa
              perform rate-acenta-oku

          when 13
           initialize hesapara-link
           move MUHA-SIRKETI  to hesapara-isyeri
           move genel-muha-uzak-ip to hesapara-ip-no
           call "/asya/ytl/obj/otel/hesapara.asy" using hesapara-link
                  on exception 
                     perform callerr-proc
                  not on exception
                     if hesapara-hesap <> spaces 
                        move hesapara-hesap  to ACENTA-avano 
                        display accept-0104
                     end-if
                  cancel "/asya/ytl/obj/otel/hesapara.asy"
             end-call
          when 15
           initialize hesapara-link
           move MUHA-SIRKETI  to hesapara-isyeri
           move genel-muha-uzak-ip to hesapara-ip-no
           call "/asya/ytl/obj/otel/hesapara.asy" using hesapara-link
                  on exception 
                     perform callerr-proc
                  not on exception
                     if hesapara-hesap <> spaces 
                        move hesapara-hesap  to ACENTA-MUHNO 
                        display accept-0105
                     end-if
                  cancel "/asya/ytl/obj/otel/hesapara.asy"
             end-call
          when 73
           initialize hesapara-link
           move MUHA-SIRKETI  to hesapara-isyeri
           move genel-muha-uzak-ip to hesapara-ip-no
           call "/asya/ytl/obj/otel/hesapara.asy" using hesapara-link
                  on exception 
                     perform callerr-proc
                  not on exception
                     if hesapara-hesap <> spaces 
                        move hesapara-hesap  to ACENTA-MUHNO2 
                        display accept-0105a
                     end-if
                  cancel "/asya/ytl/obj/otel/hesapara.asy"
             end-call
          when 5
             initialize acenta-cagir
             call "/asya/ytl/obj/otel/acenara.asy" using acenta-cagir
                 on exception perform callerr-proc
                 not on exception
                 cancel "/asya/ytl/obj/otel/acenara.asy" 
              end-call
              move acenta-cagir     to acenta-kodu
               display accept-0101
               move 4 to accept-control
               move 5 to control-id
           when 1016 perform banka-ara
           when 1017 perform doviz-ara
           when 1018 perform pansiyon-ara
           when 1019 perform odeme-ara
           when 1020 perform anlasma-ara
           when 1021 perform pazar-ara
           when 1022 perform ulke-ara
           when 180 perform kaynak-1-ara
           when 183 perform kaynak-2-ara
           when 186 perform kaynak-3-ara
         end-evaluate
         .
 exception-procedure.
      perform kullandi.
     evaluate key-status
         when 17 
             move acenta-dosya         to link-logview-dosya-adi
             set link-logview-pointer  to address of acenta-rec
             set link-logview-rec-size to size of acenta-rec
             perform logview-call
             initialize key-status
         when 16
     
           move acenta-adi         to aranacak-adi  
           move acenta-unvani      to aranacak-soyadi
           move mis-no           to bulunan-profil-no
           move ps1              to bulunan-profil-sirket
           
           perform profil-cagir
         when 4001
              perform efatura-muh-al
         when 3166
              perform breakdown-form-cagir
         when  3151 
         if acenta-kodu not = spaces
          
               if acenta-yfiyat = 1 
                    move acenta-kodu to  acenta-gonder   
                if acenta-rate-acenta > spaces 
                          move acenta-rate-acenta to  acenta-gonder 
                end-if
                   call "/asya/ytl/obj/otel/webfiyat.asy" 
                         using acenta-gonder
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/webfiyat.asy"
                    end-call




               else
             move acenta-kodu to  acenta-gonder   
               if acenta-rate-acenta > spaces then 
                   move acenta-rate-acenta to  acenta-gonder   
               end-if
               initialize dokcagir-tasi
            set dokcagir-tasi-call-fiyatgir2    to true
            move acenta-gonder                to dokcagir-acenta
          
            perform dokcagir-call

                   

                    
             end-if
             end-if
          when  3188
          if acenta-kodu not = spaces
             move acenta-kodu to  acenta-gonder   
                if acenta-rate-acenta > spaces 
                          move acenta-rate-acenta to  acenta-gonder 
                end-if             
                   call "/asya/ytl/obj/otel/formul.asy" 
                         using acenta-gonder
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/formul.asy"
                    end-call
                    
             end-if
           when  3152 
          if acenta-kodu not = spaces
             move acenta-kodu to  acenta-gonder   
                if acenta-rate-acenta > spaces 
                          move acenta-rate-acenta to  acenta-gonder 
                end-if             
                   call "/asya/ytl/obj/otel/aksiyon.asy" 
                         using acenta-gonder
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/aksiyon.asy"
                    end-call
                    
             end-if
           when  3153
          if acenta-kodu not = spaces
                  
                  move acenta-kodu to  acenta-gonder   
                   if acenta-rate-acenta > spaces 
                           move acenta-rate-acenta to  acenta-gonder 
                   end-if             
                   call "/asya/ytl/obj/otel/aceanl.asy" 
                         using acenta-gonder
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/aceanl.asy"
                    end-call
                    
             end-if
            when  3268
             if acenta-kodu not = spaces   
           if acenta-yfiyat = 1 
                    move acenta-kodu to  acenta-gonder   
                if acenta-rate-acenta > spaces 
                          move acenta-rate-acenta to  acenta-gonder 
                end-if
                   call "/asya/ytl/obj/otel/webkont.asy" 
                         using acenta-gonder
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/webkont.asy"
                    end-call

               else
             move acenta-kodu to  acenta-gonder   
                if ACENTA-kontenjan > spaces then 
                   move ACENTA-kontenjan to  acenta-gonder   
               end-if
                   call "/asya/ytl/obj/otel/ykontrat.asy" 
                         using acenta-gonder
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/ykontrat.asy"
                    end-call
                    
             end-if

           when  3131 
             move acenta-kodu to  link-NOT-DOS-ANAH   
             if link-not-dos-anah not = spaces then
                move "U"     to  link-not-islem
                move "ACENTA"   to  link-NOT-DOS    
             move 99 to link-nereden 
             string Acenta-adi
                  " Acentasina " delimited by size
                  into link-dosya-aciklamasi
                   call "/asya/ytl/obj/otel/mesajgir.asy" 
                         using link-not
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/mesajgir.asy"
                    end-call
                    move  link-not-donus  to  toplam-not
                    display not-ac
                    exit paragraph 
             end-if
         when 1 
             PERFORM f1ler
        when 6
          open i-o acenta  otomail
          initialize acenta-rec
            start acenta key > acenta-anahtar
              invalid continue
              not invalid
               perform until fs-acenta ="10"
                   read acenta next no lock 
                      end move "10" to fs-acenta
                      not end
                        if acenta-muhno2 = spaces then 
                          move acenta-muhno to acenta-muhno2
                          initialize acenta-muhno
                          move "181-10-001-002 " to acenta-muhno
                          rewrite acenta-rec invalid stop " " end-rewrite
                        end-if
                     end-read
              end-perform 
            end-start             
          close acenta otomail
         when 7
            perform acenta-oto-profil-dagit 
         when 8
            perform folref-profil-no-sil
         when 159
        
            open i-o rez konuk  cast
            move "I" to rez-durumu
              move acenta-kodu to rez-acenta
              start rez key >= rez-acen invalid continue
                    not invalid 
                    perform until fs-rez = "10"
                       read rez next no lock end move "10" to fs-rez
                           not end
                             if rez-acenta not = acenta-kodu 
                               move "10" to fs-rez
                               else
                                  move acenta-kodu to REZ-GRUP-NO   
                                  initialize rez-grup-adi
                                  if rez-fiyat-konumu = "01" then move "08" to rez-fiyat-konumu end-if

                                  accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                                  accept rez-edit-zaman from time          |                           

                                  rewrite rez-rec invalid continue
                                  end-rewrite
                                  initialize cast-rec
                                  move rez-no to cast-rez-no
                                  start cast key >= cast-anah1 invalid continue
                                    not invalid
                                      perform until fs-cast = "10"
                                         read cast next no lock end move "10" to fs-cast
                                             not end 
                                               if cast-rez-no = rez-no
                                                 move acenta-kodu to cast-grup
                                                 move rez-fiyat-konumu to cast-fiyat-konumu
                                                 rewrite cast-rec invalid stop " " end-rewrite
                                                 else
                                                 move "10" to fs-cast
                                              end-if
                                          end-read
                                      end-perform 
                                   end-start
                                  
                                  if rez-folio > 0 then 
                                          move rez-folio to konuk-folio
                                          read konuk no lock invalid 
                                             stop " "
                                             not invalid 
                                                   move acenta-kodu to konuk-grup-no
                                                     if konuk-fiyat-konumu = "01" then move "08" to konuk-fiyat-konumu end-if
                                                   rewrite konuk-rec invalid stop " " end-rewrite
                                         end-read
                                         
                                   end-if
                               
                              end-if
                       end-read
                   end-perform 
              end-start
             close rez konuk  cast
             display message box "Islem Tamamlandi"
         when 72
             Display message box "Bu Islem Bu Acenta Koduna Ait Tum Rezervasyonlarin Pazar Kodunu " acen-dft-pazar " Olarak Degistirecektir." new-line
            "Devam Etmek Istiyor musunuz?"
            type 2
            default 2
            returning return-code
            if return-code <> 1
                  exit paragraph
            end-if

            open i-o rez konuk
            move "I" to rez-durumu
              move acenta-kodu to rez-acenta
              start rez key >= rez-acen invalid continue
                    not invalid 
                    perform until fs-rez = "10"
                       read rez next no lock end move "10" to fs-rez
                           not end
                             if rez-acenta not = acenta-kodu 
                               move "10" to fs-rez
                               else
                                  move acen-dft-pazar to rez-pazar

                                  accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                                  accept rez-edit-zaman from time          |                           

                                  rewrite rez-rec invalid continue
                                  end-rewrite
                                  if rez-folio > 0 then 
                                          move rez-folio to konuk-folio
                                          read konuk no lock invalid 
                                             stop " "
                                             not invalid 
                                                   move acen-dft-pazar to konuk-pazar
                                                   rewrite konuk-rec invalid stop " " end-rewrite
                                         end-read
                                         
                                   end-if



                               
                              end-if
                       end-read
                   end-perform 
              end-start
             close rez konuk
             display message box "Islem Tamamlandi"
         when 73
             Display message box "Bu Islem Bu Acenta Koduna Ait Tum Rezervasyonlarin Odeme Kodunu " acen-dft-odeme-tipi " Olarak Degistirecektir." new-line
            "Devam Etmek Istiyor musunuz?"
            type 2
            default 2
            returning return-code
            if return-code <> 1
                  exit paragraph
            end-if

            open i-o rez konuk
            move "I" to rez-durumu
              move acenta-kodu to rez-acenta
              start rez key >= rez-acen invalid continue
                    not invalid 
                    perform until fs-rez = "10"
                       read rez next no lock end move "10" to fs-rez
                           not end
                             if rez-acenta not = acenta-kodu 
                               move "10" to fs-rez
                               else
                                  move acen-dft-odeme-tipi to rez-ODEME-TIPI

                                  accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                                  accept rez-edit-zaman from time          |                           

                                  rewrite rez-rec invalid continue
                                  end-rewrite
                                  if rez-folio > 0 then 
                                          move rez-folio to konuk-folio
                                          read konuk no lock invalid 
                                             stop " "
                                             not invalid 
                                                   move acen-dft-odeme-tipi to KONUK-ODEME-TIPI
                                                   rewrite konuk-rec invalid stop " " end-rewrite
                                         end-read
                                         
                                   end-if
                               
                              end-if
                       end-read
                   end-perform 
              end-start
             close rez konuk
             display message box "Islem Tamamlandi"
          when 74
               display message box "Bu Islem Bu Acenta Koduna Ait Tum Rezervasyonlarin Pansiyon Kodunu " acen-dft-pan-tipi " Olarak Degistirecektir." new-line
                                   "Devam Etmek Istiyor musunuz?"
                              type 2
                           default 2
                         returning return-code
               if return-code <> 1
                  exit paragraph
               end-if

               open i-o rez konuk cast
               move "I" to rez-durumu
               move acenta-kodu to rez-acenta
               start rez key >= rez-acen invalid 
                     continue
               not invalid 
               perform until fs-rez = "10"
               read rez next no lock end move "10" to fs-rez
               not end
                   if rez-acenta not = acenta-kodu 
                      move "10" to fs-rez
                   else
                      move acen-dft-pan-tipi to rez-pan-TIPI

                      accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                      accept rez-edit-zaman from time          |                           

                      rewrite rez-rec invalid
                          continue
                      not invalid

                          initialize cast-rec          |firat cast pansiyon kodu yazdirdi. 05/03/2020
                          move rez-no to cast-rez-no
                          start cast key not < cast-anah1 invalid
                             continue
                          not invalid
                          perform with test after until fs-cast = "10"
                          read cast next no lock end move "10" to fs-cast 
                          not at end
                
                              if rez-no <> cast-rez-no
                
                                 exit perform 
                
                              end-if
                                
                              move acen-dft-pan-tipi to cast-pan-tipi
                              rewrite cast-rec invalid
                                  stop " "
                              end-rewrite 
                
                
                          end-read 
                          end-perform 
                          end-start 

                      end-rewrite 

                      if rez-folio > 0 then 
                         move rez-folio to konuk-folio
                         read konuk no lock invalid 
                              stop " "
                         not invalid 
                             move acen-dft-pan-tipi to KONUK-PAN-TIPI
                             rewrite konuk-rec invalid 
                                stop " " 
                             end-rewrite
                         end-read
                      end-if

                   end-if
               end-read
               end-perform 
               end-start
               close rez konuk cast
               display message box "Islem Tamamlandi"
          when 76
            Display message box "Bu Islem Bu Acenta Koduna Ait Tum Rezervasyonlarin Pansiyon Kodunu " acen-dft-ulke " Olarak Degistirecektir." new-line
            "Devam Etmek Istiyor musunuz?"
            type 2
            default 2
            returning return-code
            if return-code <> 1
                  exit paragraph
            end-if

            open i-o rez konuk 
            move "I" to rez-durumu
              move acenta-kodu to rez-acenta
              start rez key >= rez-acen invalid continue
                    not invalid 
                    perform until fs-rez = "10"
                       read rez next no lock end move "10" to fs-rez
                           not end
                             if rez-acenta not = acenta-kodu 
                               move "10" to fs-rez
                               else
                                  move acen-dft-ulke to rez-ulke

                                  accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                                  accept rez-edit-zaman from time          |                           

                                  rewrite rez-rec invalid continue
                                  end-rewrite 
                                  if rez-folio > 0 then 
                                          move rez-folio to konuk-folio
                                          read konuk no lock invalid 
                                             stop " "
                                             not invalid 
                                                   move acen-dft-ulke to konuk-ulke
                                                   rewrite konuk-rec invalid stop " " end-rewrite
                                         end-read
                                         
                                   end-if
                               
                              end-if
                       end-read
                   end-perform 
              end-start
             close rez konuk
             display message box "Islem Tamamlandi"
          when 75
            if not (k-kodu-tasi = "ASYA" or k-kodu-tasi = "X   " )
                  exit paragraph
            end-if
            Display message box "Bu Islem Tum Acentalarin Varsayilan Degerlerininin Pansiyon Kodunu " acen-dft-pan-tipi " Olarak Degistirecektir." new-line
            "Devam Etmek Istiyor musunuz?"
            type 2
            default 2
            returning return-code
            if return-code <> 1
                  exit paragraph
            end-if

            move acen-dft-pan-tipi to yedek-pans-tipi

            open i-o nt  
   
              initialize not-rec
              move "ACE"       to not-dos
              move "Default"   to not-dos-anah
              start nt key >= NOT-ANAH invalid continue
                    not invalid 
                    perform until fs-not= "10"
                       read nt next no lock end move "10" to fs-not
                           not end
                                if not-dos(1:3) <> "ACE"  
                                      exit perform
                                end-if
                                if not-dos-anah(1:7) <> "Default"
                                      exit perform 
                                end-if

                                move not1 to  acen-dft
                                move yedek-pans-tipi to acen-dft-pan-tipi
                                move acen-dft to not1 


                                rewrite not-rec invalid
                                        stop " "
                                end-rewrite
                                display not-rec
                       end-read
                   end-perform 
              end-start
             close nt  
             display message box "Islem Tamamlandi"
         when 2
              if okundu <> 1 
                  exit paragraph
              end-if
              if acenta-kodu not = spaces 
*                 open input ulke
*                 move acenta-ulke-kodu to ulke-anah
*                 read ulke no lock invalid
*                      inquire tab-1, value in tab-1-value
*                      if tab-1-value not = 1
*                         modify tab-1 , value = 1
*                         move 0 to form1-pg-2-visible
*                         move 1 to form1-pg-1-visible
*                         display form1-pg-2
*                                 form1-pg-1
*                      end-if
*                      move all "*" to ulke-adi
*                      move 4 to accept-control
*                      move 31 to control-id
*                      close ulke 
*                      exit paragraph
*                 end-read
*                 modify label-0107,title = ulke-adi
*                 close ulke
*                 open input kodlar02
*                 move "E" to kodlar02-tipi
*                 move acenta-pazar to kodlar02-kodu
*                 read kodlar02 no lock invalid
*                      inquire tab-1, value in tab-1-value
*                      if tab-1-value not = 1
*                         modify tab-1 , value = 1
*                         move 0 to form1-pg-2-visible
*                         move 1 to form1-pg-1-visible
*                         display form1-pg-2
*                                 form1-pg-1
*                      end-if
*                      move all "*" to kodlar02-adi
*                      move 4 to accept-control
*                      move 32 to control-id
*                      close kodlar02
*                      modify label-0108, title = kodlar02-adi
*                      exit paragraph
*                 end-read
*                 modify label-0108, title = kodlar02-adi
*                 close kodlar02
                 open i-o acenta nt otomail acebavel acesch
                 inquire combo-0101,value in acenta-tipi
                  inquire combo-0103,value in acenta-kv-tipi
                  initialize not-rec 
                  move "ACE"       to not-dos
                  move "Default"   to not-dos-anah
                  move acenta-kodu to not-dos-anah(8:)
                  move acen-dft to not1
                 write not-rec invalid 
                       rewrite not-rec invalid continue
                       end-rewrite 
                 end-write
                 
                 move k-kodu-tasi to acenta-staf
                 move ps1    to acenta-profil-sirket 
                 move mis-no to acenta-profil-no  
                
                    move  acenta-oto-proforma to otomail-aktif
                    move odeme-tipi(1:1) to otomail-acenta-ct
                    move odeme-peryot    to otomail-acenta-gun 
                    move once-sonra(1:1) to   otomail-acenta-os
                    write otomail-rec invalid rewrite otomail-rec   end-write
                   if genel-oto-cari-ac = 1
                         if ACENTA-MUHNO OF ACENTA = spaces
                            perform cari-hesap-ac
                            move hesap-kodu       to ACENTA-MUHNO OF ACENTA 
                         end-if                        
                   end-if 

                perform merkez-acenta-kontrol


                 if m-acenta <> spaces 
                    perform merkez-acenta-ekle
                 else
                    if tanimli-merkez <> spaces
                       perform merkez-acenta-cikar
                    end-if
                 end-if
                 write acenta-rec invalid 
                       rewrite acenta-rec invalid continue
                       end-rewrite 
                 end-write
                    perform log-operation-acenta
                 write acebavel-rec invalid 
                       rewrite acebavel-rec invalid continue
                       end-rewrite 
                 end-write
                  write acesch-rec invalid 
                       rewrite acesch-rec invalid continue
                       end-rewrite 
                 end-write
              
                 close acenta nt otomail acebavel acesch
              end-if
              move 4 to accept-control
              move 5 to control-id
         when 15
               open i-o  nt 
           
                  initialize not-rec 
                  move "ACE"       to not-dos
                  move "Default"   to not-dos-anah
                  move acenta-rate-acenta to not-dos-anah(8:)
                  read nt no lock invalid continue
                     not invalid 
                       move acenta-kodu to not-dos-anah(8:)
                        write not-rec invalid 
                            rewrite not-rec invalid continue
                       end-rewrite
                        move not1 to acen-dft


                        display form1
                        end-write
                  end-read  
                close nt
                 
             
         when 3
                 initialize mesaj-degiskenler
                 move " [ Sil Soru ] " to mmesaj-title
                 move " Bu Kayit Silinecektir ............  " to mmesaj-1
                 move " Emin Misiniz.....E->Evet, H->Hayir  " to mmesaj-2 
                 move 2           to mmesaj-type
                 move 1           to mmesaj-icon
                 move 2           to mmesaj-default
                 perform mmesaj-ver
                 if donus-kodu = 2 
                    move 4 to accept-control
                    move 5 to control-id
                    exit paragraph
                 end-if
              perform sil-kontrol thru sil-kontrol-ex
              if evet-hayir = "H" 
                 initialize mesaj-degiskenler
                 move " [ UYARI ] " to mmesaj-title
                 move " Bu Acenta Hareket Gormus .........  " to mmesaj-1
                 move " SILEMEZSINIZ......................  " to mmesaj-2 
                 move 1           to mmesaj-type
                 move 1           to mmesaj-icon
                 move 1           to mmesaj-default
                 perform mmesaj-ver
                    move 4 to accept-control
                    move 5 to control-id
                    exit paragraph
              end-if 

              if acenta-kodu not = spaces 
                 open i-o acenta acebavel  acesch
                 delete acenta invalid 
                     continue 
                 end-delete
                    perform log-operation-acenta
                 delete acebavel invalid 
                     continue 
                 end-delete
                 delete acesch invalid 
                     continue 
                 end-delete
                 close acenta acebavel acesch
              end-if
              move 4 to accept-control
              move 5 to control-id
         when 4
              open input acenta musteri cari nt kodlar02 ulke banka doviz onbkodlar10
              initialize acenta-rec
              start acenta key not < acenta-kodu invalid
                    initialize mesaj-link
                    move 04 to mesaj-no
                    perform mesaj-ver
                    close acenta musteri cari nt  kodlar02 ulke banka doviz onbkodlar10
                    exit paragraph
              end-start

              open i-o genelfis
              move 1 to genelfis-anahtar
              read genelfis no lock invalid
                   accept print-no from time
              not invalid
                   add 1 to print-no
                   rewrite genelfis-rec end-rewrite
              end-read
              close genelfis

**************************
     initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya

     set  dokumer-asya-set to true
     move print-no         to dokumer-dosya-adi
     open output dokumer
*/WINDOW TITLE
     initialize dokumer-rec detay
     move "W"                  to det-dokumer-20(1:)
     move "Acenta Kodlari Raporu" to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR
     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:1)
     move "1"          to det-dokumer-20(10:1)
     move "Acenta Kodlari Raporu" to det-filler
     write dokumer-rec from detay
     initialize dokumer-rec detay


     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:1)
     write dokumer-rec from detay

*/ DOKUMER OZELLIKLER-REC
     initialize dokumer-rec detay
     move "O" to det-dokumer-20(1:)
     move "E" to dokumer-oto-sayfa-basi
     move 56  to dokumer-oto-sayfa-satir
     move "|" to dokumer-detay-kolon-ayirici
     move "LLLLLLLLLLLLLLLLLL" to dokumer-align-occ
     move dokumer-ozellikler-rec     to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR  
     initialize dokumer-rec detay
     move "D1"             to det-dokumer-20(1:2)     
     move "1"          to det-dokumer-20(10:1)
     move "Kodu"           to det-1
     move "Kredi Kontrol"  to det-18
     move "Muh Hs. No"     to det-19
     move "Adi"            to det-2
     move "Kredi Dur"      to det-kr
     move "Unvani"         to det-3
     move "Adresi"         to det-4
     move "Ilce"           to det-5
     move "Il"             to det-6
     move "Rate "          to det-7
     move "Telefon"        to det-8
     move "Fax"            to det-9
     move "E-mail"         to det-10
     move "Pazar"          to det-11
     move "Ulke "          to det-12
     move "Vergi dairesi"  to det-13
     move "Vergi numarasi" to det-14
     move "Sorumlu"        to det-15 
     move "Tipi"           to det-16
     move "Per"            to det-16-1
     move "Ind"            to det-17
     move "C/L"            to det-20 
     move "Durum"          to det-13-1
     move "Karalist"       to det-21 
     move "Kaynak-1"       to det-22 
     move "Kaynak-2"       to det-23 
     move "Kaynak-3"       to det-24 
     move "Bnk"            to det-25
     move "Doviz"          to det-26
     move "Pns"            to det-27
     move "Odeme"          to det-28
     move "Anlasma"        to det-29
     move "Fix"            to det-30
     move "Ear"            to det-31
     move "Bil"            to det-32
     move "Spc"            to det-33
     move "Vip"            to det-34
     move "Ozl"            to det-35
     move "Merkez"         to det-36
     move "Fiyat"          to det-37
     move "MKod"           to det-38
     move "Av.Or"          to det-39
     move "Avans Hesap"    to det-40
     move "Acenta Unvani"  to det-41

     move "|" to fil-1  fil-2  fil-3  fil-4  fil-5  fil-6 fil-7 fil-8 fil-9 fil-10 
                 fil-11 fil-12 fil-13 fil-14 fil-18 fil-19 
                 fil-15 fil-16 fil-16-1 fil-17 fil-20 fil-21 fil-kr  fil-13-1
                 fil-22 fil-23 fil-24 fil-25 fil-26 fil-27 fil-28 fil-29 fil-30 
                 fil-31 fil-32 fil-33 fil-34 fil-35 fil-36 fil-37 fil-38 fil-39 fil-40 fil-41
     write dokumer-rec from detay
          open i-o otomail
     initialize dokumer-rec detay
     move "D2"           to det-dokumer-20(1:2)
     move "-"            to det-dokumer-20(5:1)
     move all "-"  to det-1 det-18 det-19 det-2 det-3 det-4 det-5 det-6 det-7 det-8
                      det-9 det-10 det-11 det-kr det-12 det-13 det-14 det-15
                      det-16 det-16-1 det-17  det-20 det-13-1 det-22 det-23 det-24
                      det-25 det-26 det-27 det-28 det-29 det-30 det-31 det-32 det-33 
                      det-34 det-35 det-36 det-37 det-38 det-39 det-40  det-41
     write dokumer-rec from detay

              initialize fs-acenta
              perform with test after until fs-acenta = "10"
                    read acenta next no lock end move "10" to fs-acenta
                    not at end
                         initialize dokumer-rec detay
                         move acenta-kodu        to det-1
                         move acenta-muhno       to det-18
                         move acenta-muhno2      to det-19
                         move acenta-adi         to det-2
                         if acenta-kara-liste = 1 then 
                           move "Karalist" to det-21
                           else
                           initialize det-21            
                           end-if
                         initialize musteri-rec
                         move acenta-profil-no     to musteri-no
                         move acenta-profil-sirket to musteri-sirket
                         read musteri no lock invalid
                              continue 
                         not invalid 
                              move musteri-unvan1   to det-3
                              move musteri-adres1   to det-4
                              move musteri-ilce     to det-5
                              move musteri-il       to det-6
                              move musteri-tel1     to det-8
                              move musteri-fax      to det-9
                              move musteri-e-mail   to det-10
                              move musteri-vdairesi to det-13
                              move musteri-vno      to det-14

                         end-read 
                              initialize cari-rec
                              move ACENTA-MUHNO2          to cari-kodu
                              read cari no lock invalid 
                                  continue 
                              not invalid 
                                  if musteri-unvan1 = spaces
                                     move C-UNVAN-1       to det-3
                                  end-if 
                                  if musteri-adres1 = spaces
                                     move C-ADRES-1       to det-4
                                  end-if 
                                  if musteri-vdairesi = spaces 
                                     move C-IL-ILCE(1:10) to det-5
                                     move C-IL-ILCE(11:)  to det-6
                                     move C-TELEFON       to det-8
                                     move C-FAX           to det-9
                                  
                                     move C-VERGI-DAIRE   to det-13
                                   
                                
                                     move C-VERGI-NO      to det-14
                                     move C-EMAIL         to det-10
                                   end-if
                              end-read 

                         move acenta-rate-acenta       to det-7
                         if acenta-kredili = 1 then 
                            move "KREDILI  " to det-kr
                            else
                            initialize det-kr
                         end-if
                                move acenta-unvani to det-41
                          initialize not-rec 
                          move "ACE" to not-dos
                          move "Default" to not-dos-anah
                          move acenta-kodu to not-dos-anah(8:)
                          read nt no lock invalid                              
                              initialize not-rec
                          not invalid 
                                  move not1 to acen-dft
                                  if acen-dft-ulke <> spaces 
                                     initialize ulke-rec
                                     move acen-dft-ulke to ulke-anah
                                     read ulke no lock invalid 
                                          move "Tanimsiz" to det-12
                                     not invalid
                                         move ulke-adi    to det-12
                                     end-read 
                                  end-if
                                  if acen-dft-ulke <> spaces 
                                     initialize kodlar02-rec
                                     move "E"            to kodlar02-tipi
                                     move acen-dft-pazar to kodlar02-kodu
                                     read kodlar02 no lock invalid 
                                          move "Tanimsiz"  to det-11 
                                     not invalid
                                         move kodlar02-adi to det-11
                                     end-read 
                                  end-if
                                  if acen-dft-kaynak-1 <> spaces 
                                     initialize onbkodlar10-rec
                                     move "AB"              to onbkodlar10-tipi
                                     move acen-dft-kaynak-1 to onbkodlar10-kodu1
                                     read onbkodlar10 no lock invalid
                                         move "Tanimsiz"      to det-22   
                                     not invalid 
                                         move onbkodlar10-adi to det-22   
                                     end-read
                                  end-if
                                  if acen-dft-kaynak-2 <> spaces 
                                     initialize onbkodlar10-rec
                                     move "AC"              to onbkodlar10-tipi
                                     move acen-dft-kaynak-2 to onbkodlar10-kodu1
                                     read onbkodlar10 no lock invalid
                                         move "Tanimsiz"      to det-23   
                                     not invalid 
                                         move onbkodlar10-adi to det-23   
                                     end-read
                                  end-if

                                  if acen-dft-kaynak-2 <> spaces 
                                     initialize onbkodlar10-rec
                                     move "AD"              to onbkodlar10-tipi
                                     move acen-dft-kaynak-3 to onbkodlar10-kodu1
                                     read onbkodlar10 no lock invalid
                                         move "Tanimsiz"      to det-24   
                                     not invalid 
                                         move onbkodlar10-adi to det-24   
                                     end-read
                                  end-if
                                  
                                  if acen-dft-banka <> spaces 
                                     move acen-dft-banka    to det-25 
                                  end-if

                                  if acen-dft-doviz <> spaces
                                     initialize doviz-rec 
                                     move acen-dft-doviz to doviz-kodu 
                                     read doviz no lock invalid
                                          continue
                                     not invalid
                                         move d-adi-1       to det-26
                                     end-read
                                  end-if

                                  if acen-dft-banka <> spaces 
                                     move acen-dft-pan-tipi    to det-27 
                                  end-if

                                  if acen-dft-odeme-tipi <> spaces 
                                     initialize kodlar02-rec
                                     move acen-dft-odeme-tipi to kodlar02-kodu
                                     move "B"                 to kodlar02-tipi
                                     read kodlar02 no lock invalid
                                          move "Tanimsiz.." to det-28
                                     not invalid
                                          move kodlar02-adi to det-28
                                     end-read    
                                  end-if

                                  if acen-dft-anlasma <> spaces
                                     initialize kodlar02-rec
                                     move acen-dft-anlasma to kodlar02-kodu
                                     move "D"              to kodlar02-tipi
                                     read kodlar02 no lock invalid
                                          move "Tanimsiz.." to det-29
                                     not invalid
                                          move kodlar02-adi to det-29
                                     end-read    
                                  end-if
                                  if acen-dft-fix = 1 
                                     move "XX" to det-30
                                  end-if
                                  if acen-dft-early = 1 
                                     move "XX" to det-31
                                  end-if
                                  if acen-dft-bilboard = 1 
                                     move "XX" to det-32
                                  end-if
                                  if acen-dft-special-yok = 1 
                                     move "XX" to det-33
                                  end-if
                                  if acen-dft-vip = 1 
                                     move "XX" to det-34
                                  end-if
                                  if acen-dft-ozl-drm = 1 
                                     move "XX" to det-35
                                  end-if
                          end-read


                         move acenta-avano       to det-15
                         evaluate acenta-tipi
                              when 0 move "Normal Acenta" to det-16
                              when 1 move "House use"     to det-16
                              when 2 move "Complimentary" to det-16
                              when 3 move "Rate"          to det-16
                              when other 
                                     move all "*" to det-16
                         end-evaluate
*                              initialize otomail-rec
*                              move acenta-kodu to otomail-acenta-kodu
*                                     move "A" to otomail-tipi
*                                    read otomail no lock invalid 
*                                         continue
*                                    end-read
*                             move otomail-kime to det-16
*
                         move acenta-performans  to det-16-1
                         move acenta-indirim     to det-17
                         if acenta-kredili =1 then 
                           move "C/L" to det-20
                           else
                           move spaces to det-20
                         end-if
                         if acenta-pasif = 1 
                            move "Pasif!.." to det-13-1
                         else
                            move " " to det-13-1
                         end-if
                         move acenta-rate-acenta to det-37

                         move 1 to rapordayim
                         perform merkod-acenta-goster


                         move acenta-av-oran to z-oran
                         move z-oran         to det-39

                         move ACENTA-AVANO   to det-40
                         write dokumer-rec from detay
                    end-read
              end-perform

              close dokumer otomail
              call  dokumer-prog on exception
                   perform callerr-proc
              not on exception
                   cancel dokumer-prog
              end-call
              close acenta musteri cari nt kodlar02 ulke banka doviz onbkodlar10

              delete file dokumer

     end-evaluate
     .
*
 accept-0107-Aft-Procedure.
     open input ulke.
     move acenta-ulke-kodu to ulke-anah.
     read ulke no lock invalid
          move all "*" to ulke-adi
          move 4 to accept-control
          move 31 to control-id
          inquire tab-1,value in tab-1-value
          if tab-1-value not = 1
             modify tab-1, value = 1
             move 1 to form1-pg-1-visible
             move 0 to form1-pg-2-visible
             display form1-pg-2
                     form1-pg-1
          end-if
     end-read
*     modify label-0107,title = ulke-adi
     close ulke.
     .
*
* accept-0108-Aft-Procedure.
*     open input kodlar02.
*     move "E" to kodlar02-tipi
*     move acenta-pazar to kodlar02-kodu
*     read kodlar02 no lock invalid
*          move all "*" to kodlar02-adi
*          move 4 to accept-control
*          move 32 to control-id
*          inquire tab-1,value in tab-1-value
*          if tab-1-value not = 1
*             modify tab-1, value = 1
*             move 1 to form1-pg-1-visible
*             move 0 to form1-pg-2-visible
*             display form1-pg-2
*                     form1-pg-1
*          end-if
*     end-read
*     modify label-0108, title = kodlar02-adi
*     close kodlar02.
*     modify tab-1,value = 2.
*     perform tab-1-Ex-Cmd-Tabchanged.
     .

*
 banka-ara.
      initialize banka-cagir.
      call "/asya/ytl/obj/otel/bankaara.asy" using banka-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/bankaara.asy" 
       end-call.
       move banka-cagir     to acen-dft-banka
       perform banka-oku.
 banka-oku.
       open input banka.
       initialize banka-rec adi-goster.
       move acen-dft-banka    to banka-kodu
       read banka        no lock invalid 
       move rezpara-banka to acen-dft-banka  banka-kodu
       read banka        no lock invalid 
            move spaces to banka-adi acen-dft-banka
            not invalid continue 
       end-read end-read.
       close banka.
       move banka-adi     to adi-goster.
       modify lb-banka-e, title = adi-goster.
       display accept-banka.
*
 doviz-ara.
      initialize doviz-cagir.
      call "/asya/ytl/obj/otel/dovizara.asy" using doviz-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/dovizara.asy" 
       end-call.
       move doviz-cagir     to acen-dft-doviz.
       perform doviz-oku.
 doviz-oku.
       open input doviz.
       initialize doviz-rec adi-goster.
       move acen-dft-doviz    to doviz-kodu
       read doviz         no lock invalid continue
            not invalid continue 
       end-read .
       close doviz.
       move d-adi-1       to adi-goster.
       modify lb-doviz-e, title = adi-goster.
   
       display accept-doviz.

*
 pansiyon-ara.
      initialize pansiyon-cagir.
      move "A" to pansiyon-tipi-cagir.
      call "/asya/ytl/obj/otel/panara.asy" using pansiyon-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/panara.asy" 
       end-call.
       move pansiyon-kodu-cagir     to acen-dft-pan-tipi.
       perform pansiyon-oku.
 pansiyon-oku.
       open input kodlar02.
       initialize kodlar02-rec adi-goster.
       move "A"              to kodlar02-tipi.
       move acen-dft-pan-tipi    to kodlar02-kodu
       read kodlar02         no lock invalid 
          continue
            not invalid continue 
       end-read   
       close kodlar02.
       move kodlar02-adi       to adi-goster.
       modify lb-pansiyon-e, title = adi-goster.
      
       display accept-pansiyon.
*
 odeme-ara.
      initialize odeme-cagir.
      move "B"   to odeme-tipi-cagir.
      call "/asya/ytl/obj/otel/odemeara.asy" using odeme-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/odemeara.asy" 
       end-call.
       move odeme-kodu-cagir     to acen-dft-odeme-tipi.
       perform odeme-oku.
 odeme-oku.
       open input kodlar02.
       initialize kodlar02-rec adi-goster.
       move "B"                to kodlar02-tipi.
       move acen-dft-odeme-tipi    to kodlar02-kodu
       read kodlar02         no lock invalid 
       move rezpara-odeme-tipi to acen-dft-odeme-tipi  kodlar02-kodu
       read kodlar02         no lock invalid 
            initialize kodlar02-rec
            not invalid continue 
       end-read end-read.
       close kodlar02.
       move kodlar02-adi       to adi-goster.
       modify lb-odeme-e, title = adi-goster.

       display accept-odeme.
*
 anlasma-ara.
      initialize infox-cagir .
      move "D"   to infox-tipi-cagir.
      call "/asya/ytl/obj/otel/infoxara.asy" using infox-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/infoxara.asy" 
       end-call.
       move infox-kodu-cagir     to acen-dft-anlasma.
       perform anlasma-oku.
 anlasma-oku.
       open input kodlar02.
       initialize kodlar02-rec adi-goster.
       move "D"                to kodlar02-tipi.
       move acen-dft-anlasma       to kodlar02-kodu
       read kodlar02         no lock invalid 
       move rezpara-anlasma  to acen-dft-anlasma kodlar02-kodu
       read kodlar02         no lock invalid 
            initialize kodlar02-rec
            not invalid continue 
       end-read  end-read.
       close kodlar02.
       move kodlar02-adi       to adi-goster.
       modify lb-anlasma-e, title = adi-goster.
     
       display accept-anlasma.
*
 pazar-ara.
      initialize pazar-cagir.
      move "E"   to pazar-tipi-cagir.
      call "/asya/ytl/obj/otel/pazarara.asy" using pazar-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/pazarara.asy" 
       end-call.
       move pazar-kodu-cagir     to acen-dft-pazar.
       perform pazar-oku  .
 pazar-oku.
       open input kodlar02 .
       initialize kodlar02-rec adi-goster.
       move "E"                to kodlar02-tipi.
       move acen-dft-pazar         to kodlar02-kodu
       read kodlar02         no lock invalid 
            move rezpara-pazar to acen-dft-pazar   kodlar02-kodu
       read kodlar02         no lock invalid 
            initialize kodlar02-rec
            not invalid continue 
       end-read end-read  .
       close kodlar02.
       move kodlar02-adi       to adi-goster.
       modify lb-pazar-e, title = adi-goster.

       display accept-pazar.
*
 ulke-ara.
      initialize ulke-cagir.
      call "/asya/ytl/obj/otel/ulkeara.asy" using ulke-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/ulkeara.asy" 
       end-call.
       move ulke-cagir     to acen-dft-ulke
       
       display accept-ulke.
       perform ulke-oku.
 ulke-oku.
       open input ulke.
       initialize ulke-rec adi-goster.
       move acen-dft-ulke    to ulke-anah1

       read ulke         no lock invalid
       move rezpara-ulke to acen-dft-ulke ulke-anah1
       read ulke         no lock invalid 
            initialize ulke-rec
            not invalid continue 
       end-read end-read
       close ulke.
       move ulke-adi     to adi-goster.
       modify lb-ulke-e, title = adi-goster.
       
       display accept-ulke.
 
*
*
*
 after-tab.
     
     .
 not-goster.
         initialize toplam-not
          move acenta-kodu to  link-NOT-DOS-ANAH   
       if link-not-dos-anah not = spaces  then
           move "K"     to  link-not-islem
           move "ACENTA"   to  link-NOT-DOS    
           move 99 to link-nereden 
                   call "/asya/ytl/obj/otel/mesajgir.asy" 
                         using link-not
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/mesajgir.asy"
                    end-call
                    move  link-not-donus  to  toplam-not
         end-if
         display not-ac
         .
*
sil-kontrol.
    move spaces to evet-hayir.
    open input rez.
    initialize rez-rec.
    move "I"         to rez-durumu
    move acenta-kodu to rez-acenta.
    start rez key not < rez-acen invalid continue
        not invalid,
        perform with test after until evet,
            read rez next no lock end move "E" to evet-hayir,
                not end,
              if rez-acenta not = acenta-kodu
                 exit perform 
              end-if
                 move "H" to evet-hayir,
                 close rez
                 exit paragraph
            end-read 
        end-perform 
    end-start.
    initialize rez-rec.
    move "S"         to rez-durumu
    move acenta-kodu to rez-acenta.
    start rez key not < rez-acen invalid continue
        not invalid,
        perform with test after until evet,
            read rez next no lock end move "E" to evet-hayir,
                not end,
              if rez-acenta not = acenta-kodu
                 exit perform 
              end-if
                 move "H" to evet-hayir,
                 exit perform
            end-read 
        end-perform 
    end-start.

         close rez.

sil-kontrol-ex.
    exit.

*
 mmesaj-ver.
      inspect mmesaj-1 replacing trailing spaces by low-values
      inspect mmesaj-2 replacing trailing spaces by low-values
      inspect mmesaj-3 replacing trailing spaces by low-values
      display message box mmesaj-1, new-line, mmesaj-2, new-line, mmesaj-3
              title   = mmesaj-title
              type    = mmesaj-type
              icon    = mmesaj-icon
              default = mmesaj-default
              returning donus-kodu.

*
 acuserve-adres-aktar.

    move muha-sirketi of genel-rec to CARI-DOSYA-adres         
                         ISLENEN-DOSYA-adres      
                         HESAP-DOSYA-adres        
                         MAHSUP-DOSYA-adres                                
                         REFERANS-DOSYA-adres     
                         mgenel-DOSYA-adres       
                       
                        
            

    move all low-values to      
                           CARI-ACUSERVE-DOSYA       
                           ISLENEN-ACUSERVE-DOSYA    
                           HESAP-ACUSERVE-DOSYA      
                           MAHSUP-ACUSERVE-DOSYA     
                           genelfis-ACUSERVE-DOSYA   
                           REFERANS-ACUSERVE-DOSYA   
                           Mgenel-ACUSERVE-DOSYA     
                           genelfis-ACUSERVE-DOSYA  
                           ip-no.


    inspect genel-muha-uzak-ip 
            replacing trailing spaces by low-values.

    if genel-muha-uzak-ip <> low-values
       move all low-values to ip-no
       string ip-no,
              "@" delimited by low-values
              genel-muha-uzak-ip delimited by low-values


              ":" delimited by low-values
              into ip-no
    end-if

    string mgenel-acuserve-dosya,
           ip-no                        delimited by low-values
           mgenel-dosya                    delimited by low-values
           into mgenel-acuserve-dosya.
  
    
    string hesap-acuserve-dosya,
           ip-no                        delimited by low-values
           hesap-dosya                 delimited by low-values
           into hesap-acuserve-dosya.
    string mahsup-acuserve-dosya,
           ip-no                        delimited by low-values
           mahsup-dosya                 delimited by low-values
           into mahsup-acuserve-dosya.
    string cari-acuserve-dosya,
           ip-no                        delimited by low-values
           cari-dosya                 delimited by low-values
           into cari-acuserve-dosya.
    string islenen-acuserve-dosya,
           ip-no                        delimited by low-values
           islenen-dosya               delimited by low-values
           into islenen-acuserve-dosya.
    string referans-acuserve-dosya,
           ip-no                        delimited by low-values
           referans-dosya                delimited by low-values
           into referans-acuserve-dosya.
    

    inspect CARI-ACUSERVE-DOSYA        replacing  all spaces by low-values
    inspect ISLENEN-ACUSERVE-DOSYA     replacing  all spaces by low-values
    inspect HESAP-ACUSERVE-DOSYA       replacing  all spaces by low-values
    inspect MAHSUP-ACUSERVE-DOSYA      replacing  all spaces by low-values
    inspect REFERANS-ACUSERVE-DOSYA    replacing  all spaces by low-values
    inspect mgenel-ACUSERVE-DOSYA      replacing  all spaces by low-values
    . 
*
 HEPSI-TEK.
       if key-status = 8 then 
        DISPLAY MESSAGE BOX "TUM ACENTALARDA VOUCHER ADEDINI FIKSLENECEK" NEW-LINE
        "DEVAM ETMEK ISTEDIGINIZE EMIN MISINIZ?"
              TITLE "DIKKAT GERI ALMANIZ MUMKUN OLMAYAN ISLEM"
              ICON 2 TYPE 2 DEFAULT 2 GIVING SONUC
           IF SONUC = 1 THEN
             open i-o acenta
            MOVE  acenta-faturada-voucher  TO YEDEK-VOUCHER
            MOVE SPACES TO ACENTA-KODU
             START ACENTA KEY > ACENTA-KODU 
               invalid continue
               not invalid
               perform until fs-acenta = "10"
                read acenta next no lock
                  end move "10" to fs-acenta
                  not end
                    MOVE  YEDEK-VOUCHER to acenta-faturada-voucher  
                    rewrite acenta-rec invalid stop " " end-rewrite
                 end-read
               end-perform
             end-start
             close acenta
          END-IF
          end-if
          .
*
 fis-al.
     open i-o genelfis
     initialize genelfis-rec yacenta-no
     move 2 to genelfis-anahtar
     read genelfis no lock invalid
          initialize genelfis-rec
          move 2 to genelfis-anahtar
          write genelfis-rec end-write
     end-read
          add 1 to acenta-no
          rewrite genelfis-rec end-rewrite                 
     close genelfis.

*
 acc-mis-no-Ev-Cmd-Goto.
        initialize mis-cagir
        move mis-no to mis-no-cagir2
        move ps1    to mis-sirket-cagir
        move 2      to mis-kim-cagir
       call "/asya/ytl/obj/otel/musteri.asy" using mis-cagir
            on exception perform callerr-proc
        not on exception
       cancel "/asya/ytl/obj/otel/musteri.asy" 
       end-call  .
        move  13 to control-id
        move 4 to accept-control,.
*
 profil-cagir.
       initialize aranan-rez-no
       move isyeri-adres-tasi         to bulunan-rez-sirketi
       
       call "/asya/ytl/obj/otel/profbuld.asy" using profbul-cagir
            on exception perform callerr-proc
        not on exception
       cancel "/asya/ytl/obj/otel/profbuld.asy" 
       end-call
    
       if secildi = 1 or 
          secildi = 2 OR 
          secildi = 3
           move bulunan-profil-no       to mis-no 
           move bulunan-profil-sirket   to ps1    
           
          
            display acc-mis-no acc-ps1 
           
          
       end-if.
*
 acenta-oto-profil-dagit.
     if k-kodu-tasi = "ASYA" or k-kodu-tasi = "X   "
       display message box "Profil Silme islemi baslayacaktýr."
                       title "siilme"
                       icon 1
                       type 2
                       default 2
                       returning return-code 
            if return-code = 2
               exit paragraph
            end-if 
       open i-o acenta musteri
       initialize acenta-rec
       start acenta key not < acenta-kodu invalid
             continue
       not invalid
       perform with test after until fs-acenta = "10"
       read acenta next no lock end move "10"  to fs-acenta
       not at end 
                if acenta-profil-no > 0 then 
                     initialize acenta-profil-no acenta-profil-sirket
                     rewrite acenta-rec end-rewrite
                     display acenta-adi
                end-if                                 
                 
       end-read
       end-perform
       end-start
       close acenta musteri
       display message box "Islem Tamamlandi..."
      end-if
        .

*
 folref-profil-no-sil.
     if k-kodu-tasi = "ASYA" or k-kodu-tasi = "X   "
       display message box "folref Profil Silme islemi baslayacaktýr."
                       title "siilme"
                       icon 1
                       type 2
                       default 2
                       returning return-code 
            if return-code = 2
               exit paragraph
            end-if 
       open i-o folref
       initialize folref-rec
       start folref key not < folref-anah invalid
             continue
       not invalid
       perform with test after until fs-folref = "10"
       read folref next no lock end move "10"  to fs-folref
       not at end 
                if folref-profil-no > 0 then 
                     initialize folref-profil-no folref-profil-sirket
                     rewrite folref-rec end-rewrite
                     display folref-anah
                end-if                                 
                 
       end-read
       end-perform
       end-start
       close folref  
       display message box "Islem Tamamlandi..."
      end-if
        .

*
 profil-fis-al.
      open i-o genelfis
      move 1 to genelfis-anahtar
      read genelfis no lock invalid  
        initialize genelfis-rec
        move 1 to genelfis-anahtar
        add  1 to profile-oto
        move profile-oto to oto-mis-no
        write genelfis-rec invalid
          rewrite genelfis-rec invalid continue
          end-rewrite 
        end-write
      not invalid
          add 1 to profile-oto
          move profile-oto to oto-mis-no
          rewrite genelfis-rec end-rewrite
      end-read
      close genelfis.
*
 efatura-muh-al.
      if muha-sirketi = spaces 
         exit paragraph 
      end-if




    open input cari
    initialize cari-kodu
    move ACENTA-muhno2      to cari-kodu
    read cari no lock invalid
         display message box "Cari karti Bulunamadi"
    not invalid      

              move all low-values to acebavel-company
              inspect c-unvan-1 replacing
                               trailing spaces by low-values
                string acebavel-company
                c-unvan-1 delimited by low-values
                " "      delimited by low-values
                c-unvan-2 delimited by low-values
                into acebavel-company

              move all low-values to acebavel-adress
              inspect c-adres-1 replacing
                               trailing spaces by low-values
                string acebavel-adress
                c-adres-1 delimited by low-values
                " "      delimited by low-values
                c-adres-2 delimited by low-values
                into acebavel-adress


              move all low-values to acebavel-tax-id
              inspect c-adres-1 replacing
                               trailing spaces by low-values
                string acebavel-tax-id
                c-vergi-daire delimited by low-values
                " "      delimited by low-values
                c-vergi-no delimited by low-values
                into acebavel-tax-id


        move c-il-ilce      to acebavel-city acebavel-province
 
        move c-ulke         to acebavel-country 
 
 
    end-read
    close cari
    display accept-0190 accept-0191 accept-0192 accept-0193 
            accept-0194 accept-0195 accept-0196 accept-0197
            accept-0198.
 wait-wnd-create.
     display floating window 
             handle in wait-handle
             title "Rapor Hazirlaniyor ..."
             size 50
             lines 10
             background-low
             user-white
             color 65793
             font traditional-font
     display label "Lutfen Bekleyiniz ..." transparent
             color 2 line 5 col 25 font traditional-font.
     display Bitmap, 
        COL 1.50, LINE 1.50, LINES 107, SIZE 175, 
        BITMAP-HANDLE cark-jpg, BITMAP-NUMBER 1, 
        BITMAP-START 1, BITMAP-End 4, BITMAP-TIMER 25, ID IS 3.
 wait-wnd-destroy.
     close window wait-handle.
*
 accept-0101a-Aft-Procedure.
    
     perform onb-adres-aktar
        open input acenta2
        read acenta2 no lock invalid move "*********" to acenta2-adi
        end-read
        move acenta2-adi to lb2-adi
            display Form1-La-4
        close acenta2
   
     .

*
 Form1-Pb-6-Link.
        if acenta2-kodu = spaces 
           display message box "Lutfen acenta kodu giriniz"
             exit paragraph 
        end-if
        if bag-value = spaces and acenta2-kodu  = acenta-kodu then 
            display message box "Lutfen  farkli acenta kodu giriniz" 
           exit paragraph
        end-if
         perform wait-wnd-create
           perform onb-adres-aktar
        open input acenta2
        read acenta2 no lock invalid move "*********" to acenta2-adi
        end-read
        move acenta2-adi to lb2-adi
            display Form1-La-4
        close acenta2
        if  v-actan    = 0 and "*********" = acenta2-adi(1:9)
           display message box "Kopyalanacak tarafta olmayan bir acentanin acenta tanimini " new-line
                                "kopyalamadan fiyatlari kopyalayamassiniz"
       end-if

      
        if  v-actan    = 1 then
          move acenta2-kodu to yedek-kodu
          open i-o acenta2
            read acenta2 no lock invalid 
                  display message box bag-value new-line
                      acenta2-adi new-line
                      "adli acenta ayni isimle tanimlanacaktir. Emin misiniz?"
                      type 2 icon 2 default 2
                      giving sonuc
                      if sonuc = 1 then 
                         move acenta-rec to acenta2-rec
                        move yedek-kodu to acenta2-kodu
                        rewrite acenta2-rec invalid write acenta2-rec  end-rewrite
                    end-if



                not invalid 
                move acenta2-adi to yedek-adi
                  display message box bag-value new-line
                      acenta2-adi new-line
                      "adli acenta tanimlamasi degisecektir. Emin misiniz?"
                      type 2 icon 2 default 2
                      giving sonuc
                      if sonuc = 1 then 
                         move acenta-rec to acenta2-rec
                        move yedek-kodu to acenta2-kodu
                        move yedek-adi to acenta2-adi
                        rewrite acenta2-rec invalid write acenta2-rec  end-rewrite
                    end-if
            end-read
          close acenta2
            open input nt 
            
               open i-o nt2
                initialize sonuc



                   initialize not2-rec 
                  move acenta2-kodu to   not2-dos-anah(8:) 
                  move "ACE"   to  not2-dos  
                    
           
          start nt2 key >= not2-anah   invalid continue
               not invalid 
               initialize fs-not
               perform until fs-not = "10" 
                  read nt2 next no lock  end 
                      move "10" to fs-not 
                      not end 
                      if   "ACE"        = not2-dos(1:3) and 
                        "       "    = not2-dos-anah(1:7)  and
                           acenta2-kodu = not2-dos-anah(8:4)
                          if sonuc = 0
                             display message box bag-value new-line
                                      acenta2-adi new-line
                                      "adli acenta tanimli varsayilan degerler ve notlari  silinecek" new-line
                                      "Yeni degerler kopyalanacaktir. Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                          end-if
                          if sonuc = 1 then 
                                 delete nt2 invalid stop " " end-delete  
                          end-if
                        else
                          move "10" to fs-not 

                      end-if
                  end-read
              end-perform 
          end-start
         
              
               initialize not-rec 
                 move acenta-kodu to   not-dos-anah(8:) 
                  move "ACE"   to  not-dos  
          start nt key >= not-anah   invalid continue
               not invalid 
               perform until fs-not = "10" 
                  read nt next no lock  end 
                      move "10" to fs-not 
                      not end 
                      if   "ACE"        = not-dos(1:3) and 
                           "       "    = not2-dos-anah(1:7)  and
                           acenta-kodu = not-dos-anah(8:4)
                          if sonuc = 0
                                display message box bag-value new-line
                                      acenta-adi new-line
                                      "adli acenta tanimli varsayilan degerler kopyalanacaktir" new-line
                                      "Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                           end-if
                           if sonuc = 1 then 
                                 move not-rec to not2-rec 
                                 move acenta2-kodu to not2-dos-anah(8:4)
                                 write not2-rec invalid stop " " end-write  
                          end-if
                        else
                          move "10" to fs-not 

                      end-if
                  end-read
              end-perform 
          end-start

*************************************************************               
               initialize not2-rec 
                move "FIY" to not2-dos
                move acenta2-kodu to not2-dos-anah(1:4)
          start nt2 key >= not2-anah   invalid continue
               not invalid 
               initialize fs-not
               perform until fs-not = "10" 
                  read nt2 next no lock  end 
                      move "10" to fs-not 
                      not end 
                      if   "FIY"        = not2-dos(1:3) and 
                          
                           acenta2-kodu = not2-dos-anah(1:4)
                          if sonuc = 0
                             display message box bag-value new-line
                                      acenta2-adi new-line
                                      "adli acenta tanimli varsayilan degerler ve notlari  silinecek" new-line
                                      "Yeni degerler kopyalanacaktir. Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                          end-if
                          if sonuc = 1 then 
                                 delete nt2 invalid stop " " end-delete  
                          end-if
                        else
                          move "10" to fs-not 

                      end-if
                  end-read
              end-perform 
          end-start
         
              
               
               
               
               initialize not-rec 
                move "FIY" to not-dos
               
                move acenta-kodu to not-dos-anah(1:)
          start nt key >= not-anah   invalid continue
               not invalid 
               perform until fs-not = "10" 
                  read nt next no lock  end 
                      move "10" to fs-not 
                      not end 
                      if   "FIY" = not-dos(1:3) and 
                         
                          acenta-kodu = not-dos-anah(1:4)
                          if sonuc = 0
                                display message box bag-value new-line
                                      acenta-adi new-line
                                      "adli acenta tanimli varsayilan degerler kopyalanacaktir" new-line
                                      "Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                           end-if
                           if sonuc = 1 then 
                                 move not-rec to not2-rec 
                                 move acenta2-kodu to not2-dos-anah(1:4)
                                 write not2-rec invalid stop " " end-write  
                          end-if
                        else
                          move "10" to fs-not 

                      end-if
                  end-read
              end-perform 
          end-start

*************************************************************               
               initialize not2-rec 
                move "ACE" to not2-dos
                 move "Default" to not2-dos-anah
                move acenta2-kodu to not2-dos-anah(8:)
          start nt2 key >= not2-anah   invalid continue
               not invalid 
               initialize fs-not
               perform until fs-not = "10" 
                  read nt2 next no lock  end 
                      move "10" to fs-not 
                      not end 
                      if   "ACE"        = not2-dos(1:3) and 
                           "Default"    = not2-dos-anah(1:7) and 
                           acenta2-kodu = not2-dos-anah(8:4)
                          if sonuc = 0
                             display message box bag-value new-line
                                      acenta2-adi new-line
                                      "adli acenta tanimli varsayilan degerler ve notlari  silinecek" new-line
                                      "Yeni degerler kopyalanacaktir. Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                          end-if
                          if sonuc = 1 then 
                                 delete nt2 invalid stop " " end-delete  
                          end-if
                        else
                          move "10" to fs-not 

                      end-if
                  end-read
              end-perform 
          end-start
               
               
               initialize not-rec 
                move "ACE" to not-dos
                 move "Default" to not-dos-anah
                move acenta-kodu to not-dos-anah(8:)
          start nt key >= not-anah   invalid continue
               not invalid 
               perform until fs-not = "10" 
                  read nt next no lock  end 
                      move "10" to fs-not 
                      not end 
                      if   "ACE" = not-dos(1:3) and 
                          "Default" = not-dos-anah(1:7) and 
                          acenta-kodu = not-dos-anah(8:4)
                          if sonuc = 0
                                display message box bag-value new-line
                                      acenta-adi new-line
                                      "adli acenta tanimli varsayilan degerler kopyalanacaktir" new-line
                                      "Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                           end-if
                           if sonuc = 1 then 
                                 move not-rec to not2-rec 
                                 move acenta2-kodu to not2-dos-anah(8:4)
                                 write not2-rec invalid stop " " end-write  
                          end-if
                        else
                          move "10" to fs-not 

                      end-if
                  end-read
              end-perform 
          end-start
          close nt nt2
       
               open input acebavel  
            
               open i-o acebavel2
               
                initialize acebavel2-rec sonuc
              
                move acenta2-kodu to acebavel2-acenta-kodu
          start acebavel2 key > acebavel2-anah   invalid continue
               not invalid 
               initialize fs-acebavel
               perform until fs-acebavel = "10" 
                  read acebavel2 next no lock  end 
                      move "10" to fs-acebavel
                      not end 
                      if   acenta2-kodu = acebavel2-acenta-kodu
                          if sonuc = 0
                             display message box bag-value new-line
                                      acenta2-adi new-line
                                      "adli acenta tanimli elektronik fatura tanimlamalari silinecek " new-line
                                      "Yeni degerler kopyalanacaktir. Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                          end-if
                          if sonuc = 1 then 
                                 delete acebavel2 invalid stop " " end-delete  
                          end-if
                        else
                          move "10" to fs-acebavel

                      end-if
                  end-read
              end-perform 
          end-start
               
               
               initialize acebavel-rec 
               
                move acenta-kodu to acebavel-acenta-kodu
            start acebavel key > acebavel-anah   invalid continue
               not invalid 
               perform until fs-acebavel = "10" 
                  read acebavel next no lock  end 
                      move "10" to fs-acebavel 
                      not end 
                      if  
                          acenta-kodu = acebavel-acenta-kodu
                          if sonuc = 0
                                display message box bag-value new-line
                                      acenta-adi new-line
                                      "adli acenta tanimli elektronik fatura bilgileri kopyalanacaktir" new-line
                                      "Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                           end-if
                           if sonuc = 1 then 
                                 move acebavel-rec to acebavel2-rec 
                                 move acenta2-kodu to acebavel2-acenta-kodu
                                 write acebavel2-rec invalid stop " " end-write  
                          end-if
                        else
                          move "10" to fs-acebavel

                      end-if
                  end-read
              end-perform 
          end-start
          close acebavel acebavel2
         end-if
    
         if  v-acdef    = 1 then
              
               open input aceanlas
            
               open i-o ace2
               
                initialize ace2-rec sonuc
              
                move acenta2-kodu to ace2-acenta
          start ace2 key > ace2-anah   invalid continue
               not invalid 
               initialize fs-aceanlas
               perform until fs-aceanlas = "10" 
                  read ace2 next no lock  end 
                      move "10" to fs-aceanlas
                      not end 
                      if   acenta2-kodu = ace2-acenta
                          if sonuc = 0
                             display message box bag-value new-line
                                      acenta2-adi new-line
                                      "adli acenta tanimli acenta kontrat kabul degerleri silinecek " new-line
                                      "Yeni degerler kopyalanacaktir. Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                          end-if
                          if sonuc = 1 then 
                                 delete ace2 invalid stop " " end-delete  
                          end-if
                        else
                          move "10" to fs-aceanlas

                      end-if
                  end-read
              end-perform 
          end-start
                
               initialize aceanlas-rec 
               
                move acenta-kodu to aceanlas-acenta
            start aceanlas key > aceanlas-anah   invalid continue
               not invalid 
               perform until fs-aceanlas = "10" 
                  read aceanlas next no lock  end 
                      move "10" to fs-aceanlas
                      not end 
                      if  
                          acenta-kodu = aceanlas-acenta
                          if sonuc = 0
                                display message box bag-value new-line
                                      acenta-adi new-line
                                      "adli acenta tanimli tanimli acenta kontrat kabul degerleri kopyalanacaktir" new-line
                                      "Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                           end-if
                           if sonuc = 1 then 
                                 move aceanlas-rec to ace2-rec 
                                 move acenta2-kodu to ace2-acenta
                                 write ace2-rec invalid stop " " end-write  
                          end-if
                        else
                          move "10" to fs-aceanlas

                      end-if
                  end-read
              end-perform 
          end-start
          close aceanlas ace2
        end-if
      
        if   v-acaks   = 1 then
             
               open input aksiyon aksiyon2
            
               open i-o aks2 aks22   open input aksiyhrk
            
            open i-o aksiyhrk2
                initialize  sonuc
            perform varying i from 1 by 1 until i > 6
                 evaluate i 
                   when 1   move "A" to atipi perform tek-aks
                   when 2   move "B" to atipi perform tek-aks
                   when 3   move "S" to atipi perform tek-aks
                   when 4   move "K" to atipi perform tek-aks
                   when 5   move "O" to atipi perform tek-aks
                   when 6   move "P" to atipi perform tek-aks
                    

                 end-evaluate 
             end-perform 

          close aksiyon aks2 aks22 aksiyon2    close aksiyhrk aksiyhrk2
        end-if

         if v-ackab   = 1 


              open input fiyatana
            
               open i-o fana2  find2 fiyatind 
               open input fiyat
            
               open i-o fiyat2
             
              
             initialize fana2-rec sonuc
              move acenta2-kodu to fana2-acenta
             move  k-tfiyat-bas-tar to      fana2-ilk-tarih 

          start fana2 key > fana2-anah   invalid continue
               not invalid 
               initialize fs-fiyatana
               perform until fs-fiyatana = "10" 
                  read fana2 next no lock  end 
                      move "10" to fs-fiyatana
                      not end 
                      if   acenta2-kodu = fana2-acenta
                          if sonuc = 0
                             display message box bag-value new-line
                                      acenta2-adi new-line
                                      "adli acenta tanimli fiyat tanimlari silinecek " new-line
                                      "Yeni degerler kopyalanacaktir. Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                          end-if
                          if sonuc = 1 then 
                                 delete fana2 invalid stop " " end-delete  
                          end-if
                        else
                          move "10" to fs-fiyatana

                      end-if
                  end-read
              end-perform 
          end-start
               
               
               initialize fiyatana-rec 
                  move  k-tfiyat-bas-tar to      fiyatana-ilk-tarih    
                move acenta-kodu to fiyatana-acenta
            start fiyatana key > fiyatana-anah   invalid continue
               not invalid 
               perform until fs-fiyatana = "10" 
                  read fiyatana next no lock  end 
                      move "10" to fs-fiyatana
                      not end 
                      if 
                          acenta-kodu = fiyatana-acenta
                          if sonuc = 0
                                display message box bag-value new-line
                                      acenta-adi new-line
                                      "adli acenta tanimli fiyatlar kopyalanacaktir" new-line
                                      "Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                           end-if
                           if sonuc = 1 then 
                                 move fiyatana-rec to fana2-rec 
                                 move acenta2-kodu to fana2-acenta
                                 write fana2-rec invalid stop " " end-write  
                          end-if
                        else
                          move "10" to fs-fiyatana

                      end-if
                  end-read
              end-perform 
          end-start
       

            initialize fiyatind-rec  fs-fiyatind
              move  k-tfiyat-bas-tar to      fiyatind-ilk-tarih    
                move acenta-kodu to fiyatind-acenta
            start fiyatind key >= fiyatind-anah   invalid continue
               not invalid 
               perform until fs-fiyatind = "10" 
                  read fiyatind next no lock  end 
                      move "10" to fs-fiyatind
                      not end 
                      if 
                          acenta-kodu = fiyatind-acenta
                          if sonuc = 0
                                display message box bag-value new-line
                                      acenta-adi new-line
                                      "adli acenta tanimli fiyatlar kopyalanacaktir" new-line
                                      "Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                           end-if
                           if sonuc = 1 then 
                                 move fiyatind-rec to find2-rec 
                                 move acenta2-kodu to find2-acenta
                                 write find2-rec invalid stop " " end-write  
 
                          end-if
                        else
                          move "10" to fs-fiyatind

                      end-if
                  end-read
              end-perform 
          end-start
 

          close fiyatana fana2    close fiyat fiyat2 find2 fiyatind

        end-if

       perform  wait-wnd-destroy .   


*
 tek-aks.
    display atipi

           initialize aks2-rec
                move atipi to aks2-tipi
                move acenta2-kodu to aks2-acenta
          start aks2 key > aks2-anah   invalid continue
               not invalid 
               initialize fs-aksiyon
               perform until fs-aksiyon = "10" 
                  read aks2 next no lock  end 
                      move "10" to fs-aksiyon
                      not end 
                      if   atipi =  aks2-tipi and  acenta2-kodu = aks2-acenta
                       if  k-tfiyat-bas-tar >  aks2-G-TARIH
                           exit perform cycle
                       end-if
                          if sonuc = 0
                             display message box bag-value new-line
                                      acenta2-adi new-line

                                      "adli acenta tanimli aksiyon stopsale tanimlari silinecek " new-line
                                      "Yeni degerler kopyalanacaktir. Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                          end-if
                          if sonuc = 1 then 
                            move aks2-anah to aks22-anah
                            read aks22 no lock invalid continue
                            end-read
                                 delete aks2 invalid stop " " end-delete  
                                 delete  aks22 invalid continue end-delete  
                          end-if
                        else
                          move "10" to fs-aksiyon

                      end-if
                  end-read
              end-perform 
          end-start
               
               
               initialize aksiyon-rec 
                     move atipi to aksiyon-tipi
                move acenta-kodu to aksiyon-acenta
            start aksiyon key > aksiyon-anah   invalid continue
               not invalid 
               perform until fs-aksiyon = "10" 
                  read aksiyon next no lock  end 
                      move "10" to fs-aksiyon
                      not end 
                      if   atipi =  aksiyon-tipi and
                          acenta-kodu = aksiyon-acenta
                           if  k-tfiyat-bas-tar >  AKSIYON-G-TARIH
                           exit perform cycle
                       end-if
                          if sonuc = 0
                                display message box bag-value new-line
                                      acenta-adi new-line
                                      "adli acenta tanimli aksiyon stopsale  degerleri kopyalanacaktir" new-line
                                      "Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                           end-if
                           if sonuc = 1 then 
                                 move aksiyon-rec to aks2-rec 
                                 move acenta2-kodu to aks2-acenta
                                 write aks2-rec invalid stop " " end-write 
                                 move aksiyon-anah to aksiyon2-anah
                                 read aksiyon2 no lock invalid continue
                                   not invalid 
                                      move aksiyon2-rec to aks22-rec
                                       move acenta2-kodu to aks22-acenta
                                      write aks22-rec invalid stop " " end-write 

                                end-read
                          end-if
                        else
                          move "10" to fs-aksiyon

                      end-if
                  end-read
              end-perform 
          end-start
       
                 .




 tek-akshrk.        
               
                initialize aksiyhrk2-rec 
                 move   atipi to  aksiyhrk2-tipi
*******************************                           
                move acenta2-kodu to aksiyhrk2-acenta
          start aksiyhrk2 key > aksiyhrk2-anah   invalid continue
               not invalid 
               initialize fs-aksiyhrk
               perform until fs-aksiyhrk = "10" 
                  read aksiyhrk2 next no lock  end 
                      move "10" to fs-aksiyhrk
                      not end 
                      if    atipi =  aksiyhrk2-tipi and acenta2-kodu = aksiyhrk2-acenta
                          if sonuc = 0
                             display message box bag-value new-line
                                      acenta2-adi new-line
                                      "adli acenta tanimli aksiyon stopsale tanimlari silinecek " new-line
                                      "Yeni degerler kopyalanacaktir. Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                          end-if
                          if sonuc = 1 then 
                                 delete aksiyhrk2 invalid stop " " end-delete  
                          end-if
                        else
                          move "10" to fs-aksiyhrk

                      end-if
                  end-read
              end-perform 
          end-start
        
              
               
               
               
               initialize aksiyhrk-rec 
                 move   atipi to  aksiyhrk-tipi 
                move acenta-kodu to aksiyhrk-acenta
            start aksiyhrk key > aksiyhrk-anah   invalid continue
               not invalid 
               perform until fs-aksiyhrk = "10" 
                  read aksiyhrk next no lock  end 
                      move "10" to fs-aksiyhrk
                      not end 
                      if   atipi =  aksiyhrk-tipi and
                          acenta-kodu = aksiyhrk-acenta
                          if sonuc = 0
                                display message box bag-value new-line
                                      acenta-adi new-line
                                      "adli acenta tanimli aksiyon stopsale  degerleri kopyalanacaktir" new-line
                                      "Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                           end-if
                           if sonuc = 1 then 
                                 move aksiyhrk-rec to aksiyhrk2-rec 
                                 move acenta2-kodu to aksiyhrk2-acenta
                                 write aksiyhrk2-rec invalid stop " " end-write  
                          end-if
                        else
                          move "10" to fs-aksiyhrk

                      end-if
                  end-read
              end-perform 
          end-start

     .

*
 tek-fiyat.
 
           
         
       
        
                initialize fiyat2-rec 
                 
*******************************                           
                move acenta2-kodu to fiyat2-acenta
          start fiyat2 key > fiyat2-anah   invalid continue
               not invalid 
               initialize fs-fiyat
               perform until fs-fiyat = "10" 
                  read fiyat2 next no lock  end 
                      move "10" to fs-fiyat
                      not end 
                      if   acenta2-kodu = fiyat2-acenta
                          if sonuc = 0
                             display message box bag-value new-line
                                      acenta2-adi new-line
                                      "adli acenta tanimli aksiyon stopsale tanimlari silinecek " new-line
                                      "Yeni degerler kopyalanacaktir. Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                          end-if
                          if sonuc = 1 then 
                                 delete fiyat2 invalid stop " " end-delete  
                          end-if
                        else
                          move "10" to fs-fiyat

                      end-if
                  end-read
              end-perform 
          end-start
        
              
               
               
               
               initialize fiyat-rec 
              
                move acenta-kodu to fiyat-acenta
            start fiyat key > fiyat-anah   invalid continue
               not invalid 
               perform until fs-fiyat = "10" 
                  read fiyat next no lock  end 
                      move "10" to fs-fiyat
                      not end 
                      if  
                          acenta-kodu = fiyat-acenta
                          if sonuc = 0
                                display message box bag-value new-line
                                      acenta-adi new-line
                                      "adli acenta tanimli fiyatlar kopyalanacaktir" new-line
                                      "Emin misiniz?"
                                      type 2 icon 2 default 2
                                      giving sonuc
                           end-if
                           if sonuc = 1 then 
                                 move fiyat-rec to fiyat2-rec 
                                 move acenta2-kodu to fiyat2-acenta
                                 write fiyat2-rec invalid stop " " end-write  
                          end-if
                        else
                          move "10" to fs-fiyat

                      end-if
                  end-read
              end-perform 
          end-start
    
     .

*
 breakdown-form-cagir.
    initialize link-hepsi
    move high-values              to gelen-break
    move acen-dft-pan-tipi        to  gelen-break(7:2) 
    move acenta-kodu of acenta    to  gelen-break(1:4)  
    
    call "/asya/ytl/obj/otel/break.asy" using link-hepsi
         on exception perform callerr-proc
         not on exception
    cancel "/asya/ytl/obj/otel/break.asy" 
    end-call
    initialize link-hepsi 
     .                
                
                 
*
 onb-adres-aktar.
     if bag-value = spaces then 
          move acenta-dosya       to acenta2-ACUSERVE-DOSYA       
          move fiyatana-dosya     to fana2-ACUSERVE-DOSYA         
          move aksiyon-dosya      to aks2-ACUSERVE-DOSYA   
          move aksiyon2-dosya     to aks22-ACUSERVE-DOSYA    
          move aceanlas-dosya     to ace2-ACUSERVE-DOSYA          
          move not-dosya          to not2-ACUSERVE-DOSYA          
          move acebavel-dosya     to acebavel2-ACUSERVE-DOSYA     
          move firma-dosya        to firma2-ACUSERVE-DOSYA        
          move aksiyhrk-dosya     to aksiyhrk2-ACUSERVE-DOSYA       
          move fiyat-dosya        to fiyat2-ACUSERVE-DOSYA  
          move fiyatind-dosya     to find2-ACUSERVE-DOSYA         
      

     else 

        move bag-value(31:) to       acenta-dosya-adres    
                                     fiyatana-dosya-adres  
                                     aksiyon-dosya-adres   
                                     aksiyon2-dosya-adres   
                                     aceanlas-dosya-adres  
                                     not-dosya-adres       
                                     acebavel-dosya-adres  
                                     firma-dosya-adres     
                                     aksiyhrk-dosya-adres  
                                     fiyat-dosya-adres     
                                     fiyatind-dosya-adres
 
            string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   acenta-dosya           delimited " "
                   into acenta2-ACUSERVE-DOSYA 
        
             string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   fiyatana-dosya           delimited " "
                   into fana2-ACUSERVE-DOSYA   

             string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   fiyatind-dosya           delimited " "
                   into find2-ACUSERVE-DOSYA   


           string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   aksiyon-dosya           delimited " "
                   into aks2-ACUSERVE-DOSYA   
            string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   aksiyon2-dosya           delimited " "
                   into aks22-ACUSERVE-DOSYA   

           string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   aceanlas-dosya           delimited " "
                   into ace2-ACUSERVE-DOSYA 

           string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   not-dosya           delimited " "
                   into not2-ACUSERVE-DOSYA 

          string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   acebavel-dosya           delimited " "
                   into acebavel2-ACUSERVE-DOSYA  

           string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   firma-dosya           delimited " "
                   into firma2-ACUSERVE-DOSYA  

           string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   aksiyhrk-dosya           delimited " "
                   into  aksiyhrk2-ACUSERVE-DOSYA
    
          string "@" delimited by low-values
                   bag-value(1:30)          delimited by " "
                    ":" delimited by low-values
                   fiyat-dosya           delimited " "
                   into  fiyat2-ACUSERVE-DOSYA     



        move isyeri-adres-tasi to      acenta-dosya-adres    
                                       fiyatana-dosya-adres  
                                       aksiyon-dosya-adres   
                                       aksiyon2-dosya-adres   
                                       aceanlas-dosya-adres  
                                       not-dosya-adres       
                                       acebavel-dosya-adres  
                                       firma-dosya-adres     
                                       aksiyhrk-dosya-adres  
                                       fiyat-dosya-adres 
                                       fiyatind-dosya-adres

       end-if



        
         .
*
 kaynak1-goster.
    open input onbkodlar10
    initialize onbkodlar10-rec
    move "AB" to onbkodlar10-tipi
    move acen-dft-kaynak-1 to onbkodlar10-kodu1
    read onbkodlar10 no lock
      invalid
        initialize onbkodlar10-rec
    end-read
    move onbkodlar10-adi to kaynak1-tipi-goster
    display accept-kaynak1 lb-kaynak1
    close onbkodlar10.

 kaynak2-goster.
    open input onbkodlar10
    initialize onbkodlar10-rec
    move "AC" to onbkodlar10-tipi
    move acen-dft-kaynak-2 to onbkodlar10-kodu1
    read onbkodlar10 no lock
      invalid
        initialize onbkodlar10-rec
    end-read
    move onbkodlar10-adi to kaynak2-tipi-goster
    display accept-kaynak2 lb-kaynak2
    close onbkodlar10.

 kaynak3-goster.
    open input onbkodlar10
    initialize onbkodlar10-rec
    move "AD" to onbkodlar10-tipi
    move acen-dft-kaynak-3 to onbkodlar10-kodu1
    read onbkodlar10 no lock
      invalid
        initialize onbkodlar10-rec
    end-read
    move onbkodlar10-adi to kaynak3-tipi-goster
    display accept-kaynak3 lb-kaynak3
    close onbkodlar10.

*
 kaynak-1-ara.
    initialize kaynak-cagir.
    move "AB"   to kaynak-tipi-cagir.
    call "/asya/ytl/obj/otel/kynk1ara.asy"
      using kaynak-cagir
      on exception
         perform callerr-proc
      not on exception
         cancel "/asya/ytl/obj/otel/kynk1ara.asy" 
    end-call
    move kaynak-kodu-cagir     to acen-dft-kaynak-1
    perform kaynak1-goster
    .

 kaynak-2-ara.
    initialize kaynak-cagir.
    move "AC"   to kaynak-tipi-cagir.
    call "/asya/ytl/obj/otel/kynk2ara.asy"
      using kaynak-cagir
      on exception
         perform callerr-proc
      not on exception
         cancel "/asya/ytl/obj/otel/kynk2ara.asy" 
    end-call
    move kaynak-kodu-cagir     to acen-dft-kaynak-2
    perform kaynak2-goster
    .
 kaynak-3-ara.
    initialize kaynak-cagir.
    move "AD"   to kaynak-tipi-cagir.
    call "/asya/ytl/obj/otel/kynk3ara.asy"
      using kaynak-cagir
      on exception
         perform callerr-proc
      not on exception
         cancel "/asya/ytl/obj/otel/kynk3ara.asy" 
    end-call
    move kaynak-kodu-cagir     to acen-dft-kaynak-3
    perform kaynak3-goster
    .
*
 rate-acenta-oku.
    if acenta-rate-acenta of acenta not = spaces
      perform onb-adres-aktar
     open input acenta2
     initialize acenta2-rec
     move acenta-rate-acenta of acenta to acenta2-kodu
     read acenta2 no lock invalid 
          move "Tanimsiz.."  to acenta2-adi
     end-read 
          move acenta2-adi   to rate-acenta-adi
     close acenta2
     
    else
      initialize  rate-acenta-adi
    end-if
    display lb-rate-adi.
*
 accept-maa-Aft-Procedure.    
    perform rate-acenta-oku 
     .
*
*
 odaref-after.
    if acenta-ref> 0
 
      if acenta-ref <= max-ref then
        move ref-adi(acenta-ref)  to oda-ref-adi
       else
        move "????????? "  to oda-ref-adi
      end-if
      else 
       move "Tumu "  to oda-ref-adi
     end-if
     display lb-oda
     .
*
*
 dokcagir-call.

     call "/asya/ytl/obj/otel/dokcagir.asy" using dokcagir-tasi
     on exception 
        perform callerr-proc
     not on exception
        cancel "/asya/ytl/obj/otel/dokcagir.asy"
     end-call.
    .
*
 cari-hesap-ac.
    open i-o cari hesap
    initialize cari-rec
    move "120.02."      to cari-kodu(1:7)
    move acenta-kodu    to cari-kodu(8:)
    move "12002"        to cari-NOKTASIZ(1:5)
    move acenta-kodu    to cari-NOKTASIZ(6:)
    read cari no lock invalid 
       move acenta-adi     to c-unvan-1
       write cari-rec invalid 
              display message box "Muhasebe Hesap Kodu Acilamadi.."
                              title "[ Uyari ]"
                              icon 1
       end-write 
    end-read 
    move cari-kodu    to acenta-muhno 

    initialize hesap-rec
    move "120.02."      to hesap-kodu(1:7)
    move acenta-kodu    to hesap-kodu(8:)
    move "12002"        to hesap-NOKTASIZ(1:5)
    move acenta-kodu    to hesap-NOKTASIZ(6:)
    read hesap no lock invalid 
         move acenta-adi     to hesap-adi
         set hesap-cari-islem to true 
         set hesap-bakiye-b to true 
         write hesap-rec invalid 
               display message box "Muhasebe Hesap Kodu Acilamadi.."
                               title "[ Uyari ]"
                               icon 1
         end-write 

    end-read 
    close cari hesap.

*
 merkez-acenta-ekle.
    open i-o merkod
    initialize merkod-rec xiii x-sira
    move "SK"  to merkod-tipi
    start merkod key not < merkod-anah invalid
          continue
    not invalid
    perform with test after until fs-merkod = "10"
    read merkod next no lock end move "10" to fs-merkod
    not at end
        if merkod-tipi <> "SK"
           exit perform
        end-if
        if merkod-sir-anah-kodu = isyeri-adres-tasi
           move merkod-sir-anah-sira to xiii
           exit perform 
        end-if

    end-read
    end-perform 
    end-start     
    if xiii = 0
       display message box isyeri-adres-tasi, 
                           " sirketinin merkez kodlamasi yapimamis." new-line
                           "Islem iptal edilecektir.."
                     title "[ Uyari ]"
                      icon 1
       close merkod
       exit paragraph
    end-if
    initialize merkod-rec 
    move "AC"              to merkod-tipi
    move m-acenta          to merkod-ace-anah-kodu
    read merkod no lock invalid
         display message box "Merkez Acenta Kodu tanimsiz." new-line
                             "Lutfen Kontrol ederek tekrar deneyiniz.."
                       title "[ Uyari ]"
                        icon 1
         close merkod
         exit paragraph
    end-read 
    move isyeri-adres-tasi to merkod-ace-anah-sirket
    start merkod key not < merkod-anah invalid
          continue
    not invalid
    perform with test after until fs-merkod = "10"
    read merkod next no lock end move "10" to fs-merkod
    not at end 
         if merkod-tipi <> "AC" or 
            merkod-ace-anah-kodu <> m-acenta or
            merkod-ace-anah-sirket <> isyeri-adres-tasi
            exit perform 
         end-if

         if merkod-tipi = "AC" and 
            merkod-ace-anah-kodu = m-acenta and
            merkod-ace-anah-sirket = isyeri-adres-tasi and 
            merkod-ace-dig-kodu = acenta-kodu
            close merkod
            exit paragraph
         end-if

         if merkod-ace-dig-kodu <> spaces 
            move merkod-ace-anah-sira to x-sira
         end-if
    
    end-read
    end-perform 
    end-start
    add 1 to x-sira
    initialize merkod-rec 
    move "AC"              to merkod-tipi
    move m-acenta          to merkod-ace-anah-kodu 
    move isyeri-adres-tasi to merkod-ace-anah-sirket
    move x-sira            to merkod-ace-anah-sira         
    read merkod no lock invalid 
         continue 
    end-read
    move acenta-kodu to merkod-ace-dig-kodu
    move acenta-adi  to merkod-ace-dig-adi
    write merkod-rec invalid
          rewrite merkod-rec end-rewrite 
    end-write
    close merkod.
*
 merkod-acenta-goster.
    open i-o merkod
    initialize merkod-rec xiii
    move "SK" to merkod-tipi
    start merkod key not < merkod-anah invalid
          continue
    not invalid
    perform with test after until fs-merkod = "10"
    read merkod next no lock end move "10" to fs-merkod
    not at end 
        if "SK" <> merkod-tipi
           exit perform 
        end-if
        if merkod-sir-anah-kodu = isyeri-adres-tasi
           move merkod-sir-anah-sira to xiii 
        end-if

    end-read 
    end-perform 
    end-start
    if xiii = 0
        close merkod
       exit paragraph
    end-if
    initialize merkod-rec 
    move "AC" to merkod-tipi
    start merkod key not < merkod-anah invalid
          continue
    not invalid
    perform with test after until fs-merkod= "10"
    read merkod next no lock end move "10" to fs-merkod
    not at end 
        if merkod-tipi <> "AC" 
           exit perform 
        end-if
        if merkod-ace-anah-sirket <> isyeri-adres-tasi 
           exit perform cycle
        end-if
        if merkod-ace-dig-kodu = acenta-kodu
           if rapordayim = 0
              move merkod-ace-anah-kodu to m-acenta |xm-acenta
           else
              move merkod-ace-anah-kodu to det-36 
           end-if
           exit perform 
        else 
           initialize m-acenta det-36
        end-if
    end-read 
    end-perform 
    end-start
    if rapordayim = 0
       display accept-m-acenta
    end-if
    close merkod.
*
 merkez-acenta-cikar.
    open i-o merkod
    initialize merkod-rec 
    move "AC"                to merkod-tipi
    move tanimli-merkez(4:4) to merkod-ace-anah-kodu
    move isyeri-adres-tasi   to merkod-ace-anah-sirket
    move tanimli-merkez(1:3) to merkod-ace-anah-sira
    read merkod no lock invalid
         continue
    not invalid
        delete merkod end-delete
    end-read 
    close merkod.
*
 merkez-acenta-kontrol.
    open i-o merkod
    initialize merkod-rec tanimli-merkez
    move "AC" to merkod-tipi
    start merkod key not < merkod-anah invalid
          continue
    not invalid
    perform with test after until fs-merkod = "10"
    read merkod next no lock end move "10" to fs-merkod
    not at end 
         if merkod-tipi <> "AC"
            exit perform 
         end-if
         if merkod-ace-anah-sirket = spaces 
            exit perform cycle
         else
            if merkod-ace-anah-sirket = isyeri-adres-tasi 
               if merkod-ace-dig-kodu = acenta-kodu
                  move merkod-ace-anah-sira to tanimli-merkez(1:3)
                  move merkod-ace-anah-kodu to tanimli-merkez(4:)
                  exit perform 
               end-if
            end-if
         end-if


    end-read 
    end-perform 
    end-start
    close merkod.

*
 pb-1301-Link.
     display message box "Dikkat !!!!! Dikkat!!!!! Dikkat!!!!!" x"0a0d"
                                                            " " x"0a0d"
                         "Bu islem tum acentalarin muhasebe hesap kodlari silecektir!!"
                   title "Uyari"
                
     open i-o acenta 
     initialize acenta-rec 
     start acenta key not < acenta-kodu invalid
          continue
     not invalid
     perform with test after until fs-acenta = "10"
     read acenta next no lock end move "10" to fs-acenta 
     not at end 


         initialize acenta-muhno2 acenta-muhno acenta-muhnok acenta-avano
         rewrite acenta-rec end-rewrite 


     end-read 
     end-perform
     end-start
     close acenta
     display message box "Islem tamamlanmistir.."
     .
*
 pb-1302-Link.
     display message box "Dikkat !!!!! Dikkat!!!!! Dikkat!!!!!" x"0a0d"
                                                            " " x"0a0d"
                         "Bu islem tum acentalarin muhasebe hesap kodlari silecektir!!" 
                   title "Uyari"
     open i-o rez  
     initialize rez-rec 
     move "I"    to rez-durumu 
     move "0002" to rez-acenta
     start rez key not < rez-acen invalid
           continue
     not invalid
     perform with test after until fs-rez = "10" 
     read rez next no lock end move "10" to fs-rez 
     not at end
         if rez-durumu not = "I" 
            exit perform 
         end-if

         if rez-acenta not = "0002" 
            exit perform 
         end-if

         if rez-tipi = zero or space
            move 1 to rez-tipi

            accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
            accept rez-edit-zaman from time          |                           

            rewrite rez-rec invalid stop " " end-rewrite 
         end-if

     end-read
     end-perform 
     end-start 
     close rez  
     display message box "Islem tamamlanmistir.."
     .

 
