* manager2.evt
* manager2.evt is generated from D:\asya\acugt.ytl\otel\manager2.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .
***   start event editor code   ***
*
 Form1-Bef-Create.
    perform adresleri-tasi.
    open input genel
    move 1 to genel-anahtar
    read genel no lock invalid continue
         not invalid continue
    end-read
    close genel.
    move ONKPARA-DOVIZ to butce-cev-doviz .
    move 1 to reel-gecmis
    open input kllnc
    initialize kllnc-rec
    move k-kodu-tasi  to k-kodu
    read kllnc no lock invalid 
         continue 
    end-read 
    close kllnc
    open i-o genelfis     
    move 1 to genelfis-anahtar
    read genelfis no lock
      invalid
        accept print-no from time
      not invalid
        add 1 to print-no
        rewrite genelfis-rec end-rewrite
    end-read
    close genelfis

    perform birlesik-ref-bul

    move print-no         to rapor-no
    open input genel2
    move 1 to genel2-anah
    read genel2 no lock invalid continue
         not invalid continue
    end-read
    close genel2
    if genel2-rapor-comp-durumu = spaces 
       move 2 to tumu
    else 
       move genel2-rapor-comp-durumu to tumu
    end-if
     .
*              
 Form1-Aft-Initdata.
    move tarih-tasi to ilk-tarih son-tarih.
    move "01" to ilk-ay ilk-gun
    move "N" to rap-tip.
    display acc-01 acc-02 acc-03 acc-04 acc-05 acc-06 .
    perform Form1-Ef-1-Aft-Procedure 
    perform Form1-Ef-2-Aft-Procedure
    move 2 to xx
    move 28 to sut-yer sutun(xx)
    move 1 to reel-gecmis
    perform varying i from 1 by 1 until i > 7
         add 1 to xx      add 7 to sut-yer     move sut-yer to sutun(xx)
         add 1 to xx      add 5 to sut-yer     move sut-yer to sutun(xx)
         add 1 to xx      add 9 to sut-yer     move sut-yer to sutun(xx)
         add 1 to xx      add 7 to sut-yer     move sut-yer to sutun(xx)
         add 1 to xx      add 9 to sut-yer     move sut-yer to sutun(xx)
         add 1 to xx      add 14 to sut-yer     move sut-yer to sutun(xx)
    end-perform

      modify c-bag  reset-list = 1
            mass-update = 1. 
            
         initialize bag-value 
        modify c-bag item-to-add bag-value
     open i-o baglanti
     close baglanti

     open input baglanti
        initialize baglanti-rec
        start baglanti key > baglanti-kodu invalid continue
            not invalid
               initialize fs-baglanti
               perform until fs-baglanti = "10"
                   read baglanti next no lock 
                      end move "10" to fs-baglanti
                      not end
                         if baglanti-guncel not = 1 then 
                           exit perform cycle
                         end-if
                         if baglanti-alt = spaces
                            exit perform cycle 
                         end-if
                         if baglanti-adi(1:8) = isyeri-adres-tasi
                            exit perform cycle 
                         end-if 
                           initialize bag-value
*                         move baglanti-aciklama-1 to bag-value 
                         move baglanti-adi        to bag-value(1:8)
                         modify c-bag item-to-add bag-value
                   end-read
               end-perform
         end-start
         initialize bag-value 
          modify c-bag value = bag-value
          modify c-bag  
                 mass-update = 0.  
     close baglanti.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 Form1-Ex-Other.
    evaluate key-status
       when 33 
            call "/asya/ytl/obj/otel/rezfilt.asy" 
                  using filtre-tasi  
                  on exception 
                     perform callerr-proc
                  not on exception
                     continue
             end-call
             display l-filtre
      
        
      when 4 
      
      when 2
       move son-yil to ilk-yil
        open input doviz isyeri
        initialize alt-toplam-dizi rez-adet
        perform takas-dosya-yaz thru takas-dosya-yaz-exit
        close doviz       
              initialize takas6-rec
              start takas6 key not < takas6-tarih invalid
                    initialize mesaj-link
                    move 04 to mesaj-no
                    perform mesaj-ver
                    close takas6 takas7 isyeri
                    exit paragraph
              end-start

              open i-o genelfis
              move 1 to genelfis-anahtar
              read genelfis no lock invalid
                   accept print-no from time
              not invalid
                   add 1 to print-no
                   rewrite genelfis-rec end-rewrite
              end-read
              close genelfis
**************************
     initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya
*****      display message box rez-adet " adet rezervasyon tarandi"
     set  dokumer-asya-set to true
     move print-no         to dokumer-dosya-adi
     open output dokumer
*/WINDOW TITLE
     initialize dokumer-rec detay
     move "W"                  to det-dokumer-20(1:)
*     move "YONETIM RAPORU "to det-filler
     move " MANAGEMENT REPORT  "to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR
     initialize dokumer-rec detay
     move "1"          to det-dokumer-20(10:1)
     move "B"                  to det-dokumer-20(1:1)
     move "Otel Yonetim Raporu"   to det-filler
     move "Tarih..:"     to det-filler(41:10)
     move ilk-gun        to det-filler(51:02)
     move "/"            to det-filler(53:01)
     move ilk-ay         to det-filler(54:02)
     move "/"            to det-filler(56:01)
     move ilk-yil        to det-filler(57:04)
     move "-"            to det-filler(61:01)
     move son-gun        to det-filler(62:02)
     move "/"            to det-filler(64:01)
     move son-ay         to det-filler(65:02)
     move "/"            to det-filler(67:01)
     move son-yil        to det-filler(68:04)
     write dokumer-rec from detay

     initialize dokumer-rec detay
     move "1"          to det-dokumer-20(10:1)
     move "B"                  to det-dokumer-20(1:1)
     move "Rapor Tipi..:"          to det-filler(01:15)

     
    
     write dokumer-rec from detay
      if onkpara-referans-var = 1 then 
            initialize dokumer-rec detay
             move "1"            to det-dokumer-20(10:1)
             move "B"            to det-dokumer-20(1:1)
             if oda-ref = 0 then 
             move "TUM KOMPLEX " TO DET-FILLER
             else
             MOVE ref-adi(oda-ref)to det-filler
             move "OTEL "  to det-filler(16:)
             move "KONAKLAMALARI" to det-filler(25:)
             end-if
             if fiyat-ref not = 0 
                MOVE ref-adi(fiyat-ref)to det-filler(40:)
             move "OTEL "  to det-filler(50:)
             move "SATISLARI" to det-filler(58:)
             end-if
              write dokumer-rec from detay
     end-if
     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:)
     write dokumer-rec from detay


*/ DOKUMER OZELLIKLER-REC
     initialize dokumer-rec detay
     move "O" to det-dokumer-20(1:)
     move "E" to dokumer-oto-sayfa-basi
     move 56  to dokumer-oto-sayfa-satir
     move "|" to dokumer-detay-kolon-ayirici
     move "LRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR" to dokumer-align-occ
      move "2"  to dokumer-align-occ(50:1)
     move dokumer-ozellikler-rec     to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR  
        
     initialize dokumer-rec detay  
     move "D1"           to det-dokumer-20(1:2)
      move "Konaklama "  to det11-baslik
      move "Gunluk"       to det11-oda1
      move "Gunluk "      to det11-pax1
      move "Gunluk "      to det11-chi1
      move "Gunluk "      to det11-free1
      move "Gunluk "      to det11-bebek1
      move "Gunluk "     to det11-doluluk1
      move "Gunluk "     to det11-oda-ort1
      move "Gunluk "     to det11-pax-ort1
      move "Gunluk "    to det11-tutar1
      move "Aylik  "    to det11-oda2
      move "Aylik "     to det11-pax2
      move "Aylik "     to det11-chi2
      move "Aylik "     to det11-free2
      move "Aylik "     to det11-bebek2
      move "Aylik "     to det11-doluluk2
      move "Aylik "     to det11-oda-ort2
      move "Aylik "     to det11-pax-ort2
      move "Aylik"      to det11-tutar2
      move "Yillik"       to det11-oda3
      move "Yillik "      to det11-pax3
      move "Yillik "      to det11-chi3
      move "Yillik "      to det11-free3
      move "Yillik "      to det11-bebek3
      move "Yillik "     to det11-doluluk3
      move "Yillik "     to det11-oda-ort3
      move "Yillik"     to det11-pax-ort3
      move "Yillik "    to det11-tutar3
      move "|"  TO      fil11-baslik   fil11-oda1      fil11-pax1      fil11-doluluk1 
                        fil11-oda-ort1   fil11-pax-ort1   fil11-tutar1   
                        fil11-oda2      fil11-pax2      fil11-doluluk2 
                        fil11-oda-ort2   fil11-pax-ort2   fil11-tutar2    fil11-oda3     
                        fil11-pax3      fil11-doluluk3 
                        fil11-oda-ort3   fil11-pax-ort3   fil11-tutar3  
                        fil11-chi1  fil11-chi2 fil11-chi3
                        fil11-free1  fil11-free2 fil11-free3
                        fil11-bebek1  fil11-bebek2 fil11-bebek3

      move det-11-rec to det-1
      write dokumer-rec from detay


       initialize dokumer-rec detay  
     move "D2"           to det-dokumer-20(1:2)
      move "Tipi"  to det11-baslik
      move "Oda Gc"       to det11-oda1
      move "Pax Gc "      to det11-pax1

      move "Chi Gc "      to det11-chi1
      move "Fre Gc "      to det11-free1
      move "Beb Gc "      to det11-bebek1

      move "Doluluk"     to det11-doluluk1
      move "OdaOrt "     to det11-oda-ort1
      move "PaxOrt "     to det11-pax-ort1
      move "Oda Geliri"    to det11-tutar1
      move "Oda Gc"       to det11-oda2
      move "Pax Gc"      to det11-pax2

      move "Chi Gc "      to det11-chi2
      move "Fre Gc "      to det11-free2
      move "Beb Gc "      to det11-bebek2

      move "Doluluk "     to det11-doluluk2
      move "OdaOrt "     to det11-oda-ort2
      move "PaxOrt "     to det11-pax-ort2
      move "Oda Geliri "    to det11-tutar2
      move "Oda Gc"       to det11-oda3
      move "Pax Gc"      to det11-pax3

      move "Chi Gc "      to det11-chi3
      move "Fre Gc "      to det11-free3
      move "Beb Gc "      to det11-bebek3

      move "Doluluk "     to det11-doluluk3
      move "OdaOrt "     to det11-oda-ort3
      move "PaxOrt "     to det11-pax-ort3
      move "Oda Geliri "    to det11-tutar3
      move "|"  TO     fil11-baslik   fil11-oda1      fil11-pax1      fil11-doluluk1 
                        fil11-oda-ort1   fil11-pax-ort1   fil11-tutar1   
                        fil11-oda2      fil11-pax2      fil11-doluluk2 
                        fil11-oda-ort2   fil11-pax-ort2   fil11-tutar2    fil11-oda3     
                        fil11-pax3      fil11-doluluk3 
                        fil11-oda-ort3   fil11-pax-ort3   fil11-tutar3   
                        fil11-chi1  fil11-chi2 fil11-chi3
                        fil11-free1  fil11-free2 fil11-free3
                        fil11-bebek1  fil11-bebek2 fil11-bebek3

      move det-11-rec to det-1
      write dokumer-rec from detay


     initialize dokumer-rec detay
     move "D3"           to det-dokumer-20(1:2)
     move "-"            to det-dokumer-20(5:1)
     
      move all "-" to det-1(01:364)
     write dokumer-rec from detay
*********************************
      initialize det-11-rec 
      initialize dokumer-rec detay
      move "|"  TO     fil11-baslik   fil11-oda1      fil11-pax1      fil11-doluluk1 
                        fil11-oda-ort1   fil11-pax-ort1   fil11-tutar1   
                        fil11-oda2      fil11-pax2      fil11-doluluk2 
                        fil11-oda-ort2   fil11-pax-ort2   fil11-tutar2    fil11-oda3     
                        fil11-pax3      fil11-doluluk3 
                        fil11-oda-ort3   fil11-pax-ort3   fil11-tutar3
                        fil11-chi1  fil11-chi2 fil11-chi3
                        fil11-free1  fil11-free2 fil11-free3
                        fil11-bebek1  fil11-bebek2 fil11-bebek3

      move "Ucretli"          to det11-baslik
      move takas3-ucr-oda(1)  to z-oda1 h1
      move z-oda1             to det11-oda1
      move takas3-ucr-pax(1)  to z-pax1
      move z-pax1             to det11-pax1 h7

      move takas3-ucr-chi(1)  to z-chi1
      move z-chi1             to det11-chi1  

      move takas3-ucr-free(1)  to z-free1
      move z-free1             to det11-free1  

      move takas3-ucr-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1  
      
      compute yuzde rounded = 
              ( takas3-ucr-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk h2
      move z-doluluk to det11-doluluk1
      compute yuzde rounded = 
              ( takas3-UCR-PAX(1) / takas3-hazir-yatak(1)  ) * 100

      move yuzde         to h8
     

      compute yuzde rounded = 
              ( takas3-ucr-tutar-1(1) / takas3-ucr-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort             to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-ucr-tutar-1(1) / takas3-ucr-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort             to det11-pax-ort1
      move takas3-ucr-tutar-1(1) to z-tutar2
      move z-tutar2              to det11-tutar1
*****************aylik
      move takas3-ucr-oda(2)  to z-oda2
      move z-oda2             to det11-oda2   h3
      move takas3-ucr-pax(2)  to z-pax2
      move z-pax2             to det11-pax2   h9

      move takas3-ucr-chi(2)  to z-chi2
      move z-chi2             to det11-chi2  
  
      move takas3-ucr-free(2)  to z-free2
      move z-free2             to det11-free2    
      
      move takas3-ucr-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2    

      compute yuzde rounded = 
              ( takas3-ucr-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk    h4
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-ucr-PAX(2) / takas3-hazir-yatak(2)  ) * 100

      move yuzde         to      h10


      compute yuzde rounded = 
              ( takas3-ucr-tutar-1(2) / takas3-ucr-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-ucr-tutar-1(2) / takas3-ucr-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-ucr-tutar-1(2)   to z-tutar3
      move z-tutar3                to det11-tutar2
********************************YILLIK
       move takas3-ucr-oda(3)  to z-oda3
      move z-oda3             to det11-oda3 h5
      move takas3-ucr-pax(3)  to z-pax3 H11
      move z-pax3             to det11-pax3 

      move takas3-ucr-chi(3)  to z-chi3  
      move z-chi3             to det11-chi3 

      move takas3-ucr-free(3)  to z-free3  
      move z-free3             to det11-free3 

      move takas3-ucr-bebek(3)  to z-bebek3  
      move z-bebek3             to det11-bebek3 
 


      compute yuzde rounded = 
              ( takas3-ucr-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk   H6
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-ucr-tutar-1(3) / takas3-ucr-oda(3)  )

 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      
      
      compute yuzde rounded = 
              ( takas3-ucr-PAX(3) / takas3-hazir-yatak(3)  ) * 100

      move yuzde         to      h12

      compute yuzde rounded = 
              ( takas3-ucr-tutar-1(3) / takas3-ucr-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-ucr-tutar-1(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay

******************************** COMP
      


      initialize det-11-rec 
      initialize dokumer-rec detay
      move "|"  TO     fil11-baslik   fil11-oda1      fil11-pax1      fil11-doluluk1 
                        fil11-oda-ort1   fil11-pax-ort1   fil11-tutar1   
                        fil11-oda2      fil11-pax2      fil11-doluluk2 
                        fil11-oda-ort2   fil11-pax-ort2   fil11-tutar2    fil11-oda3     
                        fil11-pax3      fil11-doluluk3 
                        fil11-oda-ort3   fil11-pax-ort3   fil11-tutar3

      move "COMP"          to det11-baslik
      move takas3-comp-oda(1)  to z-oda1  h13
      move z-oda1             to det11-oda1
      move takas3-comp-pax(1)  to z-pax1     h19
      move z-pax1             to det11-pax1

      move takas3-comp-chi(1)  to z-chi1      
      move z-chi1             to det11-chi1

      move takas3-comp-free(1)  to z-free1      
      move z-free1             to det11-free1
           
      move takas3-comp-bebek(1)  to z-bebek1      
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-comp-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk   h14
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-comp-tutar-1(1) / takas3-comp-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-comp-tutar-1(1) / takas3-comp-pax(1)  ) 


      

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
       
       compute yuzde rounded = 
              ( takas3-comp-pax(1) / takas3-hazir-yatak(1)  )  * 100
 
      move yuzde                 to h20


      move takas3-comp-tutar-1(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-comp-oda(2)  to z-oda2   h15
      move z-oda2             to det11-oda2
      move takas3-comp-pax(2)  to z-pax2   h21
      move z-pax2             to det11-pax2

      move takas3-comp-chi(2)  to z-chi2    
      move z-chi2             to det11-chi2

      move takas3-comp-free(2)  to z-free2    
      move z-free2             to det11-free2

      move takas3-comp-bebek(2)  to z-bebek2    
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-comp-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk  h16
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-comp-tutar-1(2) / takas3-comp-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-comp-tutar-1(2) / takas3-comp-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-comp-tutar-1(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
        compute yuzde rounded = 
              ( takas3-comp-pax(2) / takas3-hazir-yatak(2)  )  *  100
 
      move yuzde                 to h22


********************************YILLIK
       move takas3-comp-oda(3)  to z-oda3   h17
      move z-oda3             to det11-oda3
      move takas3-comp-pax(3)  to z-pax3  h23
      move z-pax3             to det11-pax3

      move takas3-comp-chi(3)  to z-chi3   
      move z-chi3             to det11-chi3

      move takas3-comp-free(3)  to z-free3   
      move z-free3             to det11-free3

      move takas3-comp-bebek(3)  to z-bebek3   
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-comp-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk   h18
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-comp-tutar-1(3) / takas3-comp-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-comp-tutar-1(3) / takas3-comp-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-comp-tutar-1(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
        compute yuzde rounded = 
              ( takas3-comp-pax(3) / takas3-hazir-yatak(3)  )  * 100
 
      move yuzde                 to h24


      move det-11-rec to det-1
           write dokumer-rec from detay
************************HOUSE
      


      initialize det-11-rec 
      initialize dokumer-rec detay
      move "|"  TO     fil11-baslik   fil11-oda1      fil11-pax1      fil11-doluluk1 
                        fil11-oda-ort1   fil11-pax-ort1   fil11-tutar1   
                        fil11-oda2      fil11-pax2      fil11-doluluk2 
                        fil11-oda-ort2   fil11-pax-ort2   fil11-tutar2    fil11-oda3     
                        fil11-pax3      fil11-doluluk3 
                        fil11-oda-ort3   fil11-pax-ort3   fil11-tutar3

      move "HOUSE USE"          to det11-baslik
      move takas3-hous-oda(1)  to z-oda1       h25
      move z-oda1             to det11-oda1
      move takas3-hous-pax(1)  to z-pax1       h31
      move z-pax1             to det11-pax1


      move takas3-hous-chi(1)  to z-chi1       
      move z-chi1             to det11-chi1

      move takas3-hous-free(1)  to z-free1       
      move z-free1             to det11-free1

      move takas3-hous-bebek(1)  to z-bebek1       
      move z-bebek1             to det11-bebek1
      
      compute yuzde rounded = 
              ( takas3-hous-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk             h26
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-hous-tutar-1(1) / takas3-hous-oda(1)  )
 
      move yuzde                 to z-pax-ort        
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-hous-tutar-1(1) / takas3-hous-pax(1)  ) 
               
      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-hous-tutar-1(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
        compute yuzde rounded = 
              ( takas3-hous-pax(1) / takas3-hazir-yatak(1)  )  * 100
 
      move yuzde                 to h32
*****************aylik
      move takas3-hous-oda(2)  to z-oda2            h27
      move z-oda2             to det11-oda2
      move takas3-hous-pax(2)  to z-pax2            h33
      move z-pax2             to det11-pax2

      move takas3-hous-chi(2)  to z-chi2           
      move z-chi2             to det11-chi2

      move takas3-hous-free(2)  to z-free2           
      move z-free2             to det11-free2

      move takas3-hous-bebek(2)  to z-bebek2           
      move z-bebek2             to det11-bebek2


      compute yuzde rounded = 
              ( takas3-hous-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk                  h28
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-hous-tutar-1(2) / takas3-hous-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-hous-tutar-1(2) / takas3-hous-pax(2)  ) 
       
      
      move yuzde           to z-pax-ort       
      move z-pax-ort                  to det11-pax-ort2

        compute yuzde rounded = 
              ( takas3-hous-pax(1) / takas3-hazir-yatak(1)  )  * 100
       move yuzde           to z-pax-ort       h34


      move takas3-hous-tutar-1(2)   to z-tutar3
      move z-tutar3              to det11-tutar2

       compute yuzde rounded = 
              ( takas3-hous-pax(2) / takas3-hazir-yatak(2)  )  * 100
 
      move yuzde                 to h34









********************************YILLIK
       move takas3-hous-oda(3)  to z-oda3        h29
      move z-oda3             to det11-oda3
      move takas3-hous-pax(3)  to z-pax3           h35
      move z-pax3             to det11-pax3

      move takas3-hous-chi(3)  to z-chi3          
      move z-chi3             to det11-chi3

      move takas3-hous-free(3)  to z-free3          
      move z-free3             to det11-free3

      move takas3-hous-bebek(3)  to z-bebek3          
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-hous-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk               h30
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-hous-tutar-1(3) / takas3-hous-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-hous-tutar-1(3) / takas3-hous-pax(3)  ) 

      move yuzde                      to z-pax-ort                
      move z-pax-ort                  to det11-pax-ort3
      move takas3-hous-tutar-1(3)     to z-tutar3
      move z-tutar3                   to det11-tutar3
      move det-11-rec to det-1
        compute yuzde rounded = 
              ( takas3-hous-pax(3) / takas3-hazir-yatak(3)  )  * 100
 
      move yuzde                 to h36

      write dokumer-rec from detay
     move takas3-vip-oda(1) to h37
     compute yuzde rounded = takas3-vip-oda(1) / takas3-oda(1) * 100
     move yuzde to h38
      compute yuzde rounded = takas3-vip-oda(2) / takas3-oda(2) * 100
     move yuzde to h40
      compute yuzde rounded = takas3-vip-oda(3) / takas3-oda(3) * 100
     move yuzde to h42

     move takas3-vip-oda(2) to h39
     move takas3-vip-oda(3) to h41


      move takas3-vip-pax(1) to h43
     compute yuzde rounded = takas3-vip-pax(1) / takas3-pax(1) * 100
     move yuzde to h44
      compute yuzde rounded = takas3-vip-pax(2) / takas3-pax(2) * 100
     move yuzde to h46
      compute yuzde rounded = takas3-vip-pax(3) / takas3-pax(3) * 100
     move yuzde to h48

     move takas3-vip-pax(2) to h45
     move takas3-vip-pax(3) to h47


      move takas3-chi(1) to h61
     compute yuzde rounded = takas3-chi(1) / ( takas3-chi(1) + takas3-fre(1) ) * 100
     move yuzde to h62
      compute yuzde rounded = takas3-chi(2) / ( takas3-chi(2) + takas3-fre(2) ) * 100
     move yuzde to h64
      compute yuzde rounded = takas3-chi(3) /( takas3-chi(3) + takas3-fre(3) ) * 100
     move yuzde to h66

     move takas3-chi(2) to h63
     move takas3-chi(3) to h65

       move takas3-fre(1) to h67
     compute yuzde rounded = takas3-fre(1) / ( takas3-chi(1) + takas3-fre(1) ) * 100
     move yuzde to h68
      compute yuzde rounded = takas3-fre(2) / ( takas3-chi(2) + takas3-fre(2) ) * 100
     move yuzde to h70
      compute yuzde rounded = takas3-fre(3) /( takas3-chi(3) + takas3-fre(3) ) * 100
     move yuzde to h72

     move takas3-fre(2) to h69
     move takas3-fre(3) to h71



***************toplam
    initialize det-11-rec 
      initialize dokumer-rec detay
              move "A"          to det-dokumer-20(3:1)
              move 481          to det11-renk
              
              move "1"          to det-dokumer-20(10:1)
     
      move "|"  TO     fil11-baslik   fil11-oda1      fil11-pax1      fil11-doluluk1 
                        fil11-oda-ort1   fil11-pax-ort1   fil11-tutar1   
                        fil11-oda2      fil11-pax2      fil11-doluluk2 
                        fil11-oda-ort2   fil11-pax-ort2   fil11-tutar2    fil11-oda3     
                        fil11-pax3      fil11-doluluk3 
                        fil11-oda-ort3   fil11-pax-ort3   fil11-tutar3

      move "TOPLAM "          to det11-baslik
      move takas3-oda(1)  to z-oda1      h49
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1       h55
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1        
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1        
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1        
      move z-bebek1             to det11-bebek1
      
      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk     h50
      move z-doluluk     to det11-doluluk1

       compute yuzde rounded = 
              ( takas3-pax(1) / takas3-hazir-yatak(1)  ) * 100

      move yuzde         to      h56
     

      compute yuzde rounded = 
              ( takas3-oda-tutar-1(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-oda-tutar-1(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-oda-tutar-1(1)   to z-tutar2
      move z-tutar2              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2   h51
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2     h57
      move z-pax2             to det11-pax2

      move takas3-chi(2)  to z-chi2      
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2      
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2      
      move z-bebek2             to det11-bebek2



      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100    

      move yuzde         to z-doluluk   h52
      move z-doluluk     to det11-doluluk2
       compute yuzde rounded = 
              ( takas3-pax(2) / takas3-hazir-yatak(2)  ) * 100   

      move yuzde         to z-doluluk  h58
      compute yuzde rounded = 
              ( takas3-oda-tutar-1(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-oda-tutar-1(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-oda-tutar-1(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3  h53
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3   h59
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3    
      move z-chi3             to det11-chi3


      move takas3-fre(3)  to z-free3    
      move z-free3             to det11-free3


      move takas3-bebek(3)  to z-bebek3    
      move z-bebek3             to det11-bebek3


      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk   h54
      move z-doluluk     to det11-doluluk3
      compute yuzde rounded = 
              ( takas3-pax(3) / takas3-hazir-yatak(3)  ) * 100

      move yuzde         to z-doluluk   h60
      compute yuzde rounded = 
              ( takas3-oda-tutar-1(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-oda-tutar-1(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-oda-tutar-1(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay



        initialize dokumer-rec detay  det-11-rec


        
               move "TL GELIRLER "          to det11-baslik
              move "A"          to det-dokumer-20(3:1)
              move 176         to det11-renk
              
              move "1"          to det-dokumer-20(10:1)
                move det-11-rec to det-1
                write dokumer-rec from detay
        initialize dokumer-rec detay  det-11-rec
         move "KONAKLAMA "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1


      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1


      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1



      compute yuzde rounded = 
              ( takas3-oda-tutar-1(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort   k2
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-oda-tutar-1(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort   k3
      move z-pax-ort            to det11-pax-ort1
      move takas3-oda-tutar-1(1)   to z-tutar1   k1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2

      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-oda-tutar-1(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort   k5
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-oda-tutar-1(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort   k6
      move z-pax-ort                  to det11-pax-ort2
      move takas3-oda-tutar-1(2)   to z-tutar3  k4
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-oda-tutar-1(3) / takas3-oda(3)  )
 
      move yuzde                  to z-pax-ort    k8
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-oda-tutar-1(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort      k9
      move z-pax-ort                  to det11-pax-ort3
      move takas3-oda-tutar-1(3)   to z-tutar3    k6
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay


******************************
        move    takas3-top-tutar-1(1)                                      to     k1
        compute yuzde rounded = 
              ( takas3-top-tutar-1(1) / takas3-oda(1)  )     move yuzde    to     k2
       compute yuzde rounded = 
              ( takas3-top-tutar-1(1) / takas3-pax(1)  )     move yuzde    to     k3


        move    takas3-top-tutar-1(2)                                      to     k4
        compute yuzde rounded = 
              ( takas3-top-tutar-1(2) / takas3-oda(2)  )     move yuzde    to     k5
       compute yuzde rounded = 
              ( takas3-top-tutar-1(2) / takas3-pax(2)  )     move yuzde    to     k6    
     


        move    takas3-top-tutar-1(3)                                      to     k7
        compute yuzde rounded = 
              ( takas3-top-tutar-1(3) / takas3-oda(3)  )     move yuzde    to     k8
       compute yuzde rounded = 
              ( takas3-top-tutar-1(3) / takas3-pax(3)  )     move yuzde    to     k9

        move    takas3-oda-tutar-1(1)                                      to     k11
        compute yuzde rounded = 
              ( takas3-oda-tutar-1(1) / takas3-oda(1)  )     move yuzde    to     k12
       compute yuzde rounded = 
              ( takas3-oda-tutar-1(1) / takas3-pax(1)  )     move yuzde    to     k13


        move    takas3-oda-tutar-1(2)                                      to     k14
        compute yuzde rounded = 
              ( takas3-oda-tutar-1(2) / takas3-oda(2)  )     move yuzde    to     k15
       compute yuzde rounded = 
              ( takas3-oda-tutar-1(2) / takas3-pax(2)  )     move yuzde    to     k16    
     


        move    takas3-oda-tutar-1(3)                                      to     k17
        compute yuzde rounded = 
              ( takas3-oda-tutar-1(3) / takas3-oda(3)  )     move yuzde    to     k18
       compute yuzde rounded = 
              ( takas3-oda-tutar-1(3) / takas3-pax(3)  )     move yuzde    to     k19



        move    takas3-extra-tutar-1(1)                                      to     k21
        compute yuzde rounded = 
              ( takas3-extra-tutar-1(1) / takas3-oda(1)  )     move yuzde    to     k22
       compute yuzde rounded = 
              ( takas3-extra-tutar-1(1) / takas3-pax(1)  )     move yuzde    to     k23


        move    takas3-extra-tutar-1(2)                                      to     k24
        compute yuzde rounded = 
              ( takas3-extra-tutar-1(2) / takas3-oda(2)  )     move yuzde    to     k25
       compute yuzde rounded = 
              ( takas3-extra-tutar-1(2) / takas3-pax(2)  )     move yuzde    to     k26    
     


        move    takas3-extra-tutar-1(3)                                      to     k27
        compute yuzde rounded = 
              ( takas3-extra-tutar-1(3) / takas3-oda(3)  )     move yuzde    to     k28
       compute yuzde rounded = 
              ( takas3-extra-tutar-1(3) / takas3-pax(3)  )     move yuzde    to     k29


****************************************


        move    takas3-top-tutar-2(1)                                      to     k31
        compute yuzde rounded = 
              ( takas3-top-tutar-2(1) / takas3-oda(1)  )     move yuzde    to     k32
       compute yuzde rounded = 
              ( takas3-top-tutar-2(1) / takas3-pax(1)  )     move yuzde    to     k33


        move    takas3-top-tutar-2(2)                                      to     k34
        compute yuzde rounded = 
              ( takas3-top-tutar-2(2) / takas3-oda(2)  )     move yuzde    to     k35
       compute yuzde rounded = 
              ( takas3-top-tutar-2(2) / takas3-pax(2)  )     move yuzde    to     k36   
     


        move    takas3-top-tutar-2(3)                                      to     k37
        compute yuzde rounded = 
              ( takas3-top-tutar-2(3) / takas3-oda(3)  )     move yuzde    to     k38
       compute yuzde rounded = 
              ( takas3-top-tutar-2(3) / takas3-pax(3)  )     move yuzde    to     k39

        move    takas3-oda-tutar-2(1)                                      to     k41


        compute yuzde rounded = 
              ( takas3-oda-tutar-2(1) / takas3-oda(1)  )     move yuzde    to     k42
       compute yuzde rounded = 
              ( takas3-oda-tutar-2(1) / takas3-pax(1)  )     move yuzde    to     k43


        move    takas3-oda-tutar-2(2)                                      to     k44
        compute yuzde rounded = 
              ( takas3-oda-tutar-2(2) / takas3-oda(2)  )     move yuzde    to     k45
       compute yuzde rounded = 
              ( takas3-oda-tutar-2(2) / takas3-pax(2)  )     move yuzde    to     k46    
     


        move    takas3-oda-tutar-2(3)                                      to     k47
        compute yuzde rounded = 
              ( takas3-oda-tutar-2(3) / takas3-oda(3)  )     move yuzde    to     k48
       compute yuzde rounded = 
              ( takas3-oda-tutar-2(3) / takas3-pax(3)  )     move yuzde    to     k49



        move    takas3-extra-tutar-2(1)                                      to     k51
        compute yuzde rounded = 
              ( takas3-extra-tutar-2(1) / takas3-oda(1)  )     move yuzde    to     k52
       compute yuzde rounded = 
              ( takas3-extra-tutar-2(1) / takas3-pax(1)  )     move yuzde    to     k53


        move    takas3-extra-tutar-2(2)                                      to     k54
        compute yuzde rounded = 
              ( takas3-extra-tutar-2(2) / takas3-oda(2)  )     move yuzde    to     k55
       compute yuzde rounded = 
              ( takas3-extra-tutar-2(2) / takas3-pax(2)  )     move yuzde    to     k56    
     


        move    takas3-extra-tutar-2(3)                                      to     k57
        compute yuzde rounded = 
              ( takas3-extra-tutar-2(3) / takas3-oda(3)  )     move yuzde    to     k58
       compute yuzde rounded = 
              ( takas3-extra-tutar-2(3) / takas3-pax(3)  )     move yuzde    to     k59

*******************************************************


        move    takas3-top-tutar-3(1)                                      to     k61
        compute yuzde rounded = 
              ( takas3-top-tutar-3(1) / takas3-oda(1)  )     move yuzde    to     k62
       compute yuzde rounded = 
              ( takas3-top-tutar-3(1) / takas3-pax(1)  )     move yuzde    to     k63


        move    takas3-top-tutar-3(2)                                      to     k64
        compute yuzde rounded = 
              ( takas3-top-tutar-3(2) / takas3-oda(2)  )     move yuzde    to     k65
       compute yuzde rounded = 
              ( takas3-top-tutar-3(2) / takas3-pax(2)  )     move yuzde    to     k66   
     


        move    takas3-top-tutar-3(3)                                      to     k67
        compute yuzde rounded = 
              ( takas3-top-tutar-3(3) / takas3-oda(3)  )     move yuzde    to     k68
       compute yuzde rounded = 
              ( takas3-top-tutar-3(3) / takas3-pax(3)  )     move yuzde    to     k69

        move    takas3-oda-tutar-3(1)                                      to     k71
        compute yuzde rounded = 
              ( takas3-oda-tutar-3(1) / takas3-oda(1)  )     move yuzde    to     k72
       compute yuzde rounded = 
              ( takas3-oda-tutar-3(1) / takas3-pax(1)  )     move yuzde    to     k73


        move    takas3-oda-tutar-3(2)                                      to     k74
        compute yuzde rounded = 
              ( takas3-oda-tutar-3(2) / takas3-oda(2)  )     move yuzde    to     k75
       compute yuzde rounded = 
              ( takas3-oda-tutar-3(2) / takas3-pax(2)  )     move yuzde    to     k76    
     


        move    takas3-oda-tutar-3(3)                                      to     k77
        compute yuzde rounded = 
              ( takas3-oda-tutar-3(3) / takas3-oda(3)  )     move yuzde    to     k78
       compute yuzde rounded = 
              ( takas3-oda-tutar-3(3) / takas3-pax(3)  )     move yuzde    to     k79



        move    takas3-extra-tutar-3(1)                                      to     k81
        compute yuzde rounded = 
              ( takas3-extra-tutar-3(1) / takas3-oda(1)  )     move yuzde    to     k82
       compute yuzde rounded = 
              ( takas3-extra-tutar-3(1) / takas3-pax(1)  )     move yuzde    to     k83


        move    takas3-extra-tutar-3(2)                                      to     k84
        compute yuzde rounded = 
              ( takas3-extra-tutar-3(2) / takas3-oda(2)  )     move yuzde    to     k85
       compute yuzde rounded =      
              ( takas3-extra-tutar-3(2) / takas3-pax(2)  )     move yuzde    to     k86    
     


        move    takas3-extra-tutar-3(3)                                      to     k87
        compute yuzde rounded = 
              ( takas3-extra-tutar-3(3) / takas3-oda(3)  )     move yuzde    to     k88
       compute yuzde rounded = 
              ( takas3-extra-tutar-3(3) / takas3-pax(3)  )     move yuzde    to     k89




       move "YIYECEK "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-yiy-tutar-1(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-yiy-tutar-1(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-yiy-tutar-1(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2


      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2
      

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-yiy-tutar-1(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-yiy-tutar-1(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-yiy-tutar-1(2)   to z-tutar3
      move z-tutar3             to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3


      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-yiy-tutar-1(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-yiy-tutar-1(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-yiy-tutar-1(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay




******************************
       move "ICECEK "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-ice-tutar-1(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-ice-tutar-1(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-ice-tutar-1(1)   to z-tutar1
      move z-tutar1              to det11-tutar1


 
 

*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2


      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-ice-tutar-1(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-ice-tutar-1(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-ice-tutar-1(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3


      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-ice-tutar-1(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-ice-tutar-1(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-ice-tutar-1(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay

***-**********************************-*-*-*-
******************************
       move "A.ICECEK "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-aice-tutar-1(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-aice-tutar-1(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-aice-tutar-1(1)   to z-tutar1
      move z-tutar1              to det11-tutar1


 
 

*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2


      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-aice-tutar-1(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-aice-tutar-1(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-aice-tutar-1(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3


      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-aice-tutar-1(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-aice-tutar-1(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-aice-tutar-1(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay
*****************************
  
******************************
       move "DIGER "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1


      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-dig-tutar-1(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-dig-tutar-1(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-dig-tutar-1(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2

      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-dig-tutar-1(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-dig-tutar-1(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-dig-tutar-1(2)   to z-tutar3
      move z-tutar3             to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-dig-tutar-1(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-dig-tutar-1(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-dig-tutar-1(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay


******************************
          move "A"          to det-dokumer-20(3:1)
              move 176         to det11-renk
              
              move "1"          to det-dokumer-20(10:1)
      MOVE "481" TO DET11-RENK
       move "TOPLAM "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-top-tutar-1(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-top-tutar-1(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      
      move takas3-top-tutar-1(1)   to z-tutar2
      move z-tutar2                to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2

      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-top-tutar-1(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-top-tutar-1(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-top-tutar-1(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-top-tutar-1(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-top-tutar-1(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-top-tutar-1(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay

********************************22222222222222222222222222222************



          initialize dokumer-rec detay  det-11-rec
            move  kur-adi(1:4) to      det11-baslik
              
              move "A"          to det-dokumer-20(3:1)
              move 176         to det11-renk
              
              move "1"          to det-dokumer-20(10:1)
                move det-11-rec to det-1
                write dokumer-rec from detay
        initialize dokumer-rec detay  det-11-rec
         move "KONAKLAMA "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-oda-tutar-2(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-oda-tutar-2(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-oda-tutar-2(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2

      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-oda-tutar-2(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-oda-tutar-2(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-oda-tutar-2(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-oda-tutar-2(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-oda-tutar-2(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-oda-tutar-2(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay


******************************
       move "YIYECEK "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-yiy-tutar-2(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-yiy-tutar-2(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-yiy-tutar-2(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2

      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-yiy-tutar-2(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-yiy-tutar-2(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-yiy-tutar-2(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-yiy-tutar-2(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-yiy-tutar-2(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-yiy-tutar-2(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay


******************************
       move "ICECEK "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-ice-tutar-2(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-ice-tutar-2(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-ice-tutar-2(1)   to z-tutar1
      move z-tutar1              to det11-tutar1 
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2


      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-ice-tutar-2(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-ice-tutar-2(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-ice-tutar-2(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-ice-tutar-2(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-ice-tutar-2(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-ice-tutar-2(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay



******************************
       move "A.ICECEK "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-aice-tutar-2(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-aice-tutar-2(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-aice-tutar-2(1)   to z-tutar1
      move z-tutar1              to det11-tutar1 
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2


      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-aice-tutar-2(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-aice-tutar-2(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-aice-tutar-2(2)   to z-tutar3
      move z-tutar3             to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-aice-tutar-2(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-aice-tutar-2(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-aice-tutar-2(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay

  
******************************
       move "DIGER "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-dig-tutar-2(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-dig-tutar-2(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-dig-tutar-2(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2


      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-dig-tutar-2(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-dig-tutar-2(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-dig-tutar-2(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-dig-tutar-2(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-dig-tutar-2(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-dig-tutar-2(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay


******************************
        move "A"          to det-dokumer-20(3:1)
             
              
              move "1"          to det-dokumer-20(10:1)
      MOVE "481" TO DET11-RENK
       move "TOPLAM "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-top-tutar-2(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-top-tutar-2(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-top-tutar-2(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2

      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-top-tutar-2(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-top-tutar-2(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-top-tutar-2(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-top-tutar-2(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-top-tutar-2(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-top-tutar-2(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay



*************************3333333333333333333333
        


          initialize dokumer-rec detay  det-11-rec
            move  kur-adi2(1:4) to      det11-baslik
              
              move "A"          to det-dokumer-20(3:1)
              move 176         to det11-renk
              
              move "1"          to det-dokumer-20(10:1)
                move det-11-rec to det-1
                write dokumer-rec from detay
        initialize dokumer-rec detay  det-11-rec
         move "KONAKLAMA "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-oda-tutar-3(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-oda-tutar-3(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-oda-tutar-3(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2

      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-oda-tutar-3(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-oda-tutar-3(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-oda-tutar-3(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-oda-tutar-3(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-oda-tutar-3(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-oda-tutar-3(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay


******************************
       move "YIYECEK "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-yiy-tutar-3(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-yiy-tutar-3(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-yiy-tutar-3(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2

      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-yiy-tutar-3(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-yiy-tutar-3(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-yiy-tutar-3(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-yiy-tutar-3(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-yiy-tutar-3(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-yiy-tutar-3(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay




******************************
       move "ICECEK "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-ice-tutar-3(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-ice-tutar-3(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-ice-tutar-3(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
******************************
 
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2


      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-ice-tutar-3(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-ice-tutar-3(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-ice-tutar-3(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-ice-tutar-3(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-ice-tutar-3(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-ice-tutar-3(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay

******************************
       move "A.ICECEK "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-aice-tutar-3(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-aice-tutar-3(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-aice-tutar-3(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
******************************
 
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2


      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-aice-tutar-3(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-aice-tutar-3(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-aice-tutar-3(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3

      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-aice-tutar-3(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-aice-tutar-3(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-aice-tutar-3(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay
  
******************************
       move "DIGER "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1

      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-dig-tutar-3(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-dig-tutar-3(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      move takas3-dig-tutar-3(1)   to z-tutar1
      move z-tutar1              to det11-tutar1
*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2


      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-dig-tutar-3(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-dig-tutar-3(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-dig-tutar-3(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3


      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-dig-tutar-3(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-dig-tutar-3(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-dig-tutar-3(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay


******************************
        move "A"          to det-dokumer-20(3:1)
             
              
              move "1"          to det-dokumer-20(10:1)
      MOVE "481" TO DET11-RENK
       move "TOPLAM "          to det11-baslik
        move takas3-oda(1)  to z-oda1
      move z-oda1             to det11-oda1
      move takas3-pax(1)  to z-pax1
      move z-pax1             to det11-pax1


      move takas3-chi(1)  to z-chi1
      move z-chi1             to det11-chi1

      move takas3-fre(1)  to z-free1
      move z-free1             to det11-free1

      move takas3-bebek(1)  to z-bebek1
      move z-bebek1             to det11-bebek1

      compute yuzde rounded = 
              ( takas3-oda(1) / takas3-hazir(1)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk1

      compute yuzde rounded = 
              ( takas3-top-tutar-3(1) / takas3-oda(1)  )
 
      move yuzde                 to z-pax-ort
      move z-pax-ort           to det11-oda-ort1
      compute yuzde rounded = 
              ( takas3-top-tutar-3(1) / takas3-pax(1)  ) 

      move yuzde                 to z-pax-ort
      move z-pax-ort            to det11-pax-ort1
      
      move takas3-top-tutar-3(1)   to z-tutar1
      move z-tutar1              to det11-tutar1

*****************aylik
      move takas3-oda(2)  to z-oda2
      move z-oda2             to det11-oda2
      move takas3-pax(2)  to z-pax2
      move z-pax2             to det11-pax2

      move takas3-chi(2)  to z-chi2
      move z-chi2             to det11-chi2

      move takas3-fre(2)  to z-free2
      move z-free2             to det11-free2

      move takas3-bebek(2)  to z-bebek2
      move z-bebek2             to det11-bebek2

      compute yuzde rounded = 
              ( takas3-oda(2) / takas3-hazir(2)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk2

      compute yuzde rounded = 
              ( takas3-top-tutar-3(2) / takas3-oda(2)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort2
      compute yuzde rounded = 
              ( takas3-top-tutar-3(2) / takas3-pax(2)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort2
      move takas3-top-tutar-3(2)   to z-tutar3
      move z-tutar3              to det11-tutar2
********************************YILLIK
       move takas3-oda(3)  to z-oda3
      move z-oda3             to det11-oda3
      move takas3-pax(3)  to z-pax3
      move z-pax3             to det11-pax3


      move takas3-chi(3)  to z-chi3
      move z-chi3             to det11-chi3

      move takas3-fre(3)  to z-free3
      move z-free3             to det11-free3

      move takas3-bebek(3)  to z-bebek3
      move z-bebek3             to det11-bebek3

      compute yuzde rounded = 
              ( takas3-oda(3) / takas3-hazir(3)  ) * 100

      move yuzde         to z-doluluk
      move z-doluluk     to det11-doluluk3

      compute yuzde rounded = 
              ( takas3-top-tutar-3(3) / takas3-oda(3)  )
 
      move yuzde               to z-pax-ort
      move z-pax-ort              to det11-oda-ort3
      compute yuzde rounded = 
              ( takas3-top-tutar-3(3) / takas3-pax(3)  ) 

      move yuzde           to z-pax-ort
      move z-pax-ort                  to det11-pax-ort3
      move takas3-top-tutar-3(3)   to z-tutar3
      move z-tutar3              to det11-tutar3
      move det-11-rec to det-1
      write dokumer-rec from detay


      
***************************************555555555555555555555555*************
    

          initialize dokumer-rec detay  det-11-rec
            move  "GENEL BILGILER" to      det11-baslik
              
              move "A"          to det-dokumer-20(3:1)
              move 176         to det11-renk
              
              move "1"          to det-dokumer-20(10:1)
                move det-11-rec to det-1
                write dokumer-rec from detay
        initialize dokumer-rec detay  det-11-rec
        move "A"          to det-dokumer-20(3:1)
              move 481         to det11-renk
              
              move "1"          to det-dokumer-20(10:1)
         move "KISI DAGILIM "          to det11-baslik


          
   
    move "Gunluk" to det11-pax1      
    
    move "%"    to  det11-doluluk1  
   
    move "Aylik"  to  det11-oda-ort1   
     move "%"    to  det11-pax-ort1    
   
    move "Yillik" to det11-tutar1   
    
    move "%"    to  det11-oda2    


    move "OPERASY"  to det11-pax2       
    move "Gun"      to det11-doluluk2   
    move "Aylik"    to det11-oda-ort2  
    move "Yillik"   to det11-pax-ort2   

    move "ODA HAREKET" to  det11-tutar2    
    move "Oda " to det11-oda3   
    move "Kisi " to det11-pax3     
    move "KURLAR " to det11-doluluk3    
    move "Gunluk"  to det11-oda-ort3   
    move "Aylik "     to det11-pax-ort3  
    move "Yillik Ort" to  det11-tutar3    

   
      move det-11-rec to det-1
      write dokumer-rec from detay




******************************
    initialize det-11-rec dokumer-rec detay
       move "Single "          to det11-baslik
       move t-single(1)   to z-oda1
       move z-oda1 to det11-pax1
       compute yuzde rounded = t-single(1)  / takas3-hazir(1) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-doluluk1
       move t-single(2)   to z-oda2
       move z-oda2 to det11-oda-ort1
       compute yuzde rounded = t-single(2)  / takas3-hazir(2) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-pax-ort1

         move t-single(3)   to z-oda3
       move z-oda3 to det11-tutar1
       compute yuzde rounded = t-single(3)  / takas3-hazir(3) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-oda2
       
       move "Out of Order"  to det11-pax2
        move "CheckIn"  to det11-tutar2 

       move   bugun-cin-oda to z-oda1
       move z-oda1          to det11-oda3


       move bugun-cin-kisi  to z-oda1
       move z-oda1         to  det11-pax3




        move kur-adi to det11-doluluk3 
        compute kur rounded = takas3-top-tutar-1(1) /  takas3-top-tutar-2(1)
        move kur to z-kur1 k91
        move z-kur1 to  det11-oda-ort3  
        compute kur rounded = takas3-top-tutar-1(2) /  takas3-top-tutar-2(2)
        move kur to z-kur1 k93
        move z-kur1 to  det11-pax-ort3  
        compute kur rounded = takas3-top-tutar-1(3) /  takas3-top-tutar-2(3)
        move kur to z-kur1   k95
        move z-kur1 to  det11-tutar3 
         move det-11-rec to det-1
      write dokumer-rec from detay

     
   
    initialize det-11-rec dokumer-rec detay
       move "Double  "          to det11-baslik

         move t-double(1)   to z-oda1
       move z-oda1 to det11-pax1
       compute yuzde rounded = t-double(1)  / takas3-hazir(1) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-doluluk1
       move t-double(2)   to z-oda2
       move z-oda2 to det11-oda-ort1
       compute yuzde rounded = t-double(2)  / takas3-hazir(2) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-pax-ort1

         move t-double(3)   to z-oda3
       move z-oda3 to det11-tutar1
       compute yuzde rounded = t-double(3)  / takas3-hazir(3) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-oda2
      move "Extention"  to det11-pax2  
        move t-extention(3)  to z-oda1
        move z-oda1       to  det11-pax-ort2     
         move t-extention(1)  to z-oda1
        move z-oda1       to  det11-doluluk2 
         move t-extention(2)  to z-oda1
        move z-oda1       to  det11-oda-ort2 







       move "CheckOut"  to det11-tutar2 
       move   bugun-cout-oda to z-oda1
       move z-oda1          to det11-oda3


       move bugun-cout-kisi  to z-oda1
       move z-oda1         to  det11-pax3

       move kur-adi2 to det11-doluluk3 
        
        compute kur rounded = takas3-top-tutar-1(1) /  takas3-top-tutar-3(1)
        move kur to z-kur1      k92
        move z-kur1 to  det11-oda-ort3  
        compute kur rounded = takas3-top-tutar-1(2) /  takas3-top-tutar-3(2)
        move kur to z-kur1     k94
        move z-kur1 to  det11-pax-ort3  
        compute kur rounded = takas3-top-tutar-1(3) /  takas3-top-tutar-3(3)
        move kur to z-kur1     k96
        move z-kur1 to  det11-tutar3 
         move det-11-rec to det-1
         move det-11-rec to det-1
      write dokumer-rec from detay

    initialize det-11-rec dokumer-rec detay
       move "Triple "          to det11-baslik

       
       move t-triple(1)   to z-oda1
       move z-oda1 to det11-pax1
       compute yuzde rounded = t-triple(1)  / takas3-hazir(1) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-doluluk1
       move t-triple(2)   to z-oda2
       move z-oda2 to det11-oda-ort1
       compute yuzde rounded = t-triple(2)  / takas3-hazir(2) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-pax-ort1

         move t-triple(3)   to z-oda3
       move z-oda3 to det11-tutar1
       compute yuzde rounded = t-triple(3)  / takas3-hazir(3) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-oda2
      move "Early COUT"  to det11-pax2 
       move t-earlycout(3)  to z-oda1
        move z-oda1       to  det11-pax-ort2     
         move t-earlycout(1)  to z-oda1
        move z-oda1       to  det11-doluluk2 
         move t-earlycout(2)  to z-oda1
        move z-oda1       to  det11-oda-ort2 


       move "Iptal Rez"  to det11-tutar2 
       move   bugun-iptal-oda to z-oda1
       move z-oda1          to det11-oda3
       
       move bugun-iptal-kisi  to z-oda1
       move z-oda1         to  det11-pax3
         move det-11-rec to det-1
      write dokumer-rec from detay

       initialize det-11-rec dokumer-rec detay
       move "Top Oda "          to det11-baslik
       move takas3-oda(1)   to z-oda1
       move z-oda1 to det11-pax1
       compute yuzde rounded = takas3-oda(1)  / takas3-hazir(1) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-doluluk1
       move takas3-oda(2)   to z-oda2
       move z-oda2 to det11-oda-ort1

       compute yuzde rounded = takas3-oda(2)  / takas3-hazir(2) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-pax-ort1

         move takas3-oda(3)   to z-oda3
       move z-oda3 to det11-tutar1
       compute yuzde rounded = takas3-oda(3)  / takas3-hazir(3) *100
       move yuzde to z-doluluk
       move z-doluluk to det11-oda2


       move "Room Change"  to det11-pax2 
        move t-rchange(3)  to z-oda1
        move z-oda1       to  det11-pax-ort2     
         move t-rchange(1)  to z-oda1
        move z-oda1       to  det11-doluluk2 
         move t-rchange(2)  to z-oda1
        move z-oda1       to  det11-oda-ort2 
       move "Islenen Rez"  to det11-tutar2 
       move   bugun-islen-oda to z-oda1
       move z-oda1          to det11-oda3
       
       move bugun-islen-kisi  to z-oda1
       move z-oda1         to  det11-pax3



         move det-11-rec to det-1
      write dokumer-rec from detay

     initialize det-11-rec dokumer-rec detay
       move "Top Pax "          to det11-baslik
        move takas3-pax(1)   to z-oda1
       move z-oda1 to det11-pax1
      move takas3-pax(2)   to z-oda1
       move z-oda1 to det11-oda-ort1
     
         move takas3-pax(3)   to z-oda3
       move z-oda3 to det11-tutar1
      
       
         move "No Show"  to det11-tutar2  
         move det-11-rec to det-1
         write dokumer-rec from detay

       initialize det-11-rec dokumer-rec detay
       move "Dbl Occ "          to det11-baslik
       compute dblocc rounded = takas3-pax(1) / takas3-oda(1)
       move dblocc    to z-dblocc  g60
       move z-dblocc  to det11-pax1

        compute dblocc rounded = takas3-pax(2) / takas3-oda(2)
        move dblocc    to z-dblocc   g62
        move z-dblocc  to det11-oda-ort1

        compute dblocc rounded = takas3-pax(3) / takas3-oda(3)
        move dblocc    to z-dblocc      g63
        move z-dblocc  to det11-tutar1

          move  t-extention(1)  to g1
          move  t-Earlycout(1)  to g9   
          move  t-rchange(1)    to g17  
    
          move  t-extention(2)  to g2
          move  t-Earlycout(2)  to g10   
          move  t-rchange(2)    to g18   

          move  t-extention(3)  to g3
          move  t-Earlycout(3)  to g11  
          move  t-rchange(3)    to g19
  
       move takas3-oda(1)        to   g104
       compute yuzde rounded = takas3-oda(1) / takas3-hazir(1)   * 100
       move yuzde                to g105 g106
       move takas3-oda(2)        to  g107
       move takas3-oda(3)        to  g108

       compute sayi = takas3-hazir(1) - takas3-oda(1)
       move sayi            to g4
       compute yuzde rounded = sayi / takas3-hazir(1) * 100
       move yuzde           to g5 g6
       compute sayi = takas3-hazir(2) - takas3-oda(2)
       move sayi            to  g7
       compute sayi = takas3-hazir(3) - takas3-oda(3)
       move sayi            to  g8

       compute sayi =  takas3-oda(1) - takas3-hous-oda(1)
       move sayi            to g12
       compute yuzde rounded = sayi / takas3-hazir(1)  * 100
       move yuzde           to g13 g14
       compute sayi =  takas3-oda(2) - takas3-hous-oda(2)
       move sayi            to  g15
       compute sayi =  takas3-oda(3) - takas3-hous-oda(3)
       move sayi            to  g16

        compute sayi =  takas3-oda(1) - takas3-hous-oda(1)  - takas3-comp-oda(1)
       move sayi            to g20
       compute yuzde rounded = sayi / takas3-hazir(1) * 100
       move yuzde           to g21 g22
       compute sayi = takas3-oda(2) - takas3-hous-oda(2)  - takas3-comp-oda(2)
       move sayi            to  g23
       compute sayi = takas3-oda(3) - takas3-hous-oda(3)  - takas3-comp-oda(3)
       move sayi            to  g24



         move det-11-rec to det-1
      write dokumer-rec from detay

************************************* FORECAST

       initialize dokumer-rec detay  det-11-rec  top-pax-cocuk
            move  "FORECAST" to      det11-baslik
              
              move "A"          to det-dokumer-20(3:1)
              move 176         to det11-renk
              
              move "1"          to det-dokumer-20(10:1)
                move det-11-rec to det-1
                write dokumer-rec from detay
        initialize dokumer-rec detay  det-11-rec
        move "A"          to det-dokumer-20(3:1)
              move 481         to det11-renk
              
              move "1"          to det-dokumer-20(10:1)
         move "GUN "          to det11-baslik


     move "Oda " to det11-oda1       
   
    move "Pax" to det11-pax1      
    
    move "Child"    to  det11-doluluk1  
   
    move "Free"  to  det11-oda-ort1   
     move "Bebek"    to  det11-pax-ort1    
   
    move "Tutar" to det11-tutar1   
    
    move "Forecast"    to  det11-oda2    


    move "Doluluk"  to det11-pax2       
    move "Hazir"      to det11-doluluk2   
    move "%"    to det11-oda-ort2  
    move "Birlesen"   to det11-pax-ort2   

    move "Net Doluluk" to  det11-tutar2    
    move "% " to det11-oda3   
    move "CIN-O " to det11-pax3     
    move "CIN-K " to det11-doluluk3    
    move "COUT-O"  to det11-oda-ort3   
    move "COUT_K "     to det11-pax-ort3  
  
   
      move det-11-rec to det-1
      write dokumer-rec from detay
        
    perform varying i from 1 by 1 until i > 7 
            initialize dokumer-rec detay  det-11-rec

      
      move   for-tarih(i) to    det11-baslik
      move for-oda(i)       to z-for-sayi-6  move z-for-sayi-6 to  det11-oda1        
      move for-pax(i)         to z-for-sayi-5  move z-for-sayi-5 to  det11-pax1        
      move for-chi(i)         to z-for-sayi  move z-for-sayi to det11-doluluk1    
       move for-fre(i)         to z-for-sayi  move z-for-sayi to det11-oda-ort1    
       move for-beb(i)          to z-for-sayi  move z-for-sayi to det11-pax-ort1    
       move for-tutar(i)        to z-for-sayi  move z-for-sayi to det11-tutar1      
     move   for-forecast(i)     to z-for-sayi-6  move z-for-sayi-6 to det11-oda2        
     move   for-doluluk(i)      to z-for-sayi-6  move z-for-sayi-6 to det11-pax2        
     move   for-hazir(i)        to z-for-sayi-6  move z-for-sayi-6 to det11-doluluk2    
      move  for-yuzde(i)       to  z-doluluk  move z-doluluk  to det11-oda-ort2    
      move  for-birles(i)      to z-for-sayi   move z-for-sayi to det11-pax-ort2    
      move  for-netdolu(i)      to z-for-sayi-6   move z-for-sayi-6 to det11-tutar2      
      move  for-netyuzde(i)      to  z-doluluk  move z-doluluk to det11-oda3        
      move  for-cinoda(i)        to z-for-sayi  move z-for-sayi to det11-pax3        
      move  for-cinpax(i)         to z-for-sayi move z-for-sayi to det11-doluluk3    
      move  for-coutoda(i)        to z-for-sayi-6 move z-for-sayi-6 to det11-oda-ort3    
      move  for-coutpax(i)        to z-for-sayi-6 move z-for-sayi-6 to det11-pax-ort3    
                                               


           move det-11-rec to det-1
          write dokumer-rec from detay
    end-perform 

          compute yuzde rounded =  for-hazir(1) - for-oda(1)                         
          move   for-tarih(1)(1:5)                to  k100
           move   for-hazir(1)                    to  k101
          move for-oda(1)                         to  k102
          move yuzde                              to  k103
          move takas3-hazir-yatak(1)              to  k104
          compute yuzde rounded =  
          takas3-hazir-yatak(1) - for-pax(1) - 
          for-chi(1) - for-fre(1)       
           move yuzde                             to  k105
         move   for-forecast(1)                   to  k106
         move   for-doluluk(1)                    to  k107
          move  for-pax(1)                        to  k108
          move  for-chi(1)                        to  k110
          move  for-fre(1)                        to  k111 
          move  for-beb(1)                        to  k112 
          compute top-pax-cocuk = for-pax(1) + for-chi(1)
          move  top-pax-cocuk                             to  k113
          
          move  for-cinoda(1)                     to  k114
        
          move  for-coutoda(1)                    to  k115
           compute yuzde rounded =  
           for-doluluk(1) / for-hazir(1) * 100        
          move  yuzde                             to  k116
            
          compute yuzde rounded =  for-hazir(2) - for-oda(2)                         
          move   for-tarih(2)(1:5)                to  k200
           move   for-hazir(2)                    to  k201
          move for-oda(2)                         to  k202
          move yuzde                              to  k203
          move takas3-hazir-yatak(1)              to  k204
          compute yuzde rounded =  
          takas3-hazir-yatak(1) - for-pax(2) - 
          for-chi(2) - for-fre(2)       
           move yuzde                             to  k205
         move   for-forecast(2)                   to  k206
         move   for-doluluk(2)                    to  k207
          move  for-pax(2)                        to  k208
          move  for-chi(2)                        to  k210
          move  for-fre(2)                        to  k211 
          move  for-beb(2)                        to  k212 
          compute top-pax-cocuk = for-pax(2) + for-chi(2)
          move  top-pax-cocuk                             to  k213
          
          move  for-cinoda(2)                     to  k214
        
          move  for-coutoda(2)                    to  k215
           compute yuzde rounded =  
           for-doluluk(2) / for-hazir(2) * 100        
          move  yuzde                             to  k216



***********************
    compute yuzde rounded =  for-hazir(3) - for-oda(3)                         
          move   for-tarih(3)(1:5)                to  k300
           move   for-hazir(3)                    to  k301
          move for-oda(3)                         to  k302
          move yuzde                              to  k303
          move takas3-hazir-yatak(1)              to  k304
          compute yuzde rounded =  
          takas3-hazir-yatak(1) - for-pax(3) - 
          for-chi(3) - for-fre(3)       
           move yuzde                             to  k305
         move   for-forecast(3)                   to  k306
         move   for-doluluk(3)                    to  k307
          move  for-pax(3)                        to  k308
          move  for-chi(3)                        to  k310
          move  for-fre(3)                        to  k311 
          move  for-beb(3)                        to  k312 
          compute top-pax-cocuk = for-pax(3) + for-chi(3)
          move  top-pax-cocuk                             to  k313
          
          move  for-cinoda(3)                     to  k314
        
          move  for-coutoda(3)                    to  k315
           compute yuzde rounded =  
           for-doluluk(3) / for-hazir(3) * 100        
          move  yuzde                             to  k316



********************************
    compute yuzde rounded =  for-hazir(4) - for-oda(4)                         
          move   for-tarih(4)(1:5)                to  k400
           move   for-hazir(4)                    to  k401
          move for-oda(4)                         to  k402
          move yuzde                              to  k403
          move takas3-hazir-yatak(1)              to  k404
          compute yuzde rounded =                       
          takas3-hazir-yatak(1) - for-pax(4) - 
          for-chi(4) - for-fre(4)       
           move yuzde                             to  k405
         move   for-forecast(4)                   to  k406
         move   for-doluluk(4)                    to  k407
          move  for-pax(4)                        to  k408
          move  for-chi(4)                        to  k410
          move  for-fre(4)                        to  k411 
          move  for-beb(4)                        to  k412 
          compute top-pax-cocuk = for-pax(4) + for-chi(4)
          move  top-pax-cocuk                             to  k413
          
          move  for-cinoda(4)                     to  k414
        
          move  for-coutoda(4)                    to  k415
           compute yuzde rounded =  
           for-doluluk(4) / for-hazir(4) * 100        
          move  yuzde                             to  k416



*****************************
    compute yuzde rounded =  for-hazir(5) - for-oda(5)                         
          move   for-tarih(5)(1:5)                to  k500
           move   for-hazir(5)                    to  k501
          move for-oda(5)                         to  k502
          move yuzde                              to  k503
          move takas3-hazir-yatak(1)              to  k504
          compute yuzde rounded =  
          takas3-hazir-yatak(1) - for-pax(5) - 
          for-chi(5) - for-fre(5)       
           move yuzde                             to  k505
         move   for-forecast(5)                   to  k506
         move   for-doluluk(5)                    to  k507
          move  for-pax(5)                        to  k508
          move  for-chi(5)                        to  k510
          move  for-fre(5)                        to  k511 
          move  for-beb(5)                        to  k512 
          compute top-pax-cocuk = for-pax(5) + for-chi(5)
          move  top-pax-cocuk                             to  k513
          
          move  for-cinoda(5)                     to  k514
        
          move  for-coutoda(5)                    to  k515
           compute yuzde rounded =  
           for-doluluk(5) / for-hazir(5) * 100        
          move  yuzde                             to  k516



***********************************
        compute yuzde rounded =  for-hazir(6) - for-oda(6)                         
          move   for-tarih(6)(1:5)                to  k600
           move   for-hazir(6)                    to  k601
          move for-oda(6)                         to  k602
          move yuzde                              to  k603
          move takas3-hazir-yatak(1)              to  k604
          compute yuzde rounded =  
          takas3-hazir-yatak(1) - for-pax(6) - 
          for-chi(6) - for-fre(6)       
           move yuzde                             to  k605
         move   for-forecast(6)                   to  k606
         move   for-doluluk(6)                    to  k607
          move  for-pax(6)                        to  k608
          move  for-chi(6)                        to  k610
          move  for-fre(6)                        to  k611 
          move  for-beb(6)                        to  k612 
          compute top-pax-cocuk = for-pax(6) + for-chi(6)
          move  top-pax-cocuk                             to  k613
          
          move  for-cinoda(6)                     to  k614
        
          move  for-coutoda(6)                    to  k615
           compute yuzde rounded =  
           for-doluluk(6) / for-hazir(6) * 100        
          move  yuzde                             to  k616


             

***********************************
        compute yuzde rounded =  for-hazir(7) - for-oda(7)                         
          move   for-tarih(7)(1:5)                to  k700
           move   for-hazir(7)                    to  k701






          move for-oda(7)                         to  k702
          move yuzde                              to  k703
          move takas3-hazir-yatak(1)              to  k704
          compute yuzde rounded =  
          takas3-hazir-yatak(1) - for-pax(7) - 
          for-chi(7) - for-fre(7)       
           move yuzde                             to  k705
         move   for-forecast(7)                   to  k706
         move   for-doluluk(7)                    to  k707
          move  for-pax(7)                        to  k708
          move  for-chi(7)                        to  k710
          move  for-fre(7)                        to  k711 
          move  for-beb(7)                        to  k712 
          compute top-pax-cocuk = for-pax(7) + for-chi(7)
          move  top-pax-cocuk                             to  k713
          
          move  for-cinoda(7)                     to  k714
        
          move  for-coutoda(7)                    to  k715
           compute yuzde rounded =  
           for-doluluk(7) / for-hazir(7) * 100        
          move  yuzde                             to  k716

          MOVE SON-AY TO E-AY 
          MOVE SON-GUN TO E-GUN 
          MOVE SON-YIL TO E-YIL
          MOVE E-TARIH TO K1000

          accept son-zaman from time
          move son-saat to esaat
          move son-dakika to edakika
          move son-saniye to esaniye
          move ezaman     to ktime
          initialize kuser-adi
          string kuser-adi
               k-adi delimited by spaces " "
               k-soyadi delimited by size 
          into kuser-adi
          
            initialize isyeri-rec  tesis-adi2
            move isyeri-no-tasi   to isyeri-no
            read isyeri no lock invalid 
                 move "Tanimsiz..."  to isyeri-unvan
            end-read 
                move isyeri-unvan   to tesis-adi
          if bag-value not = spaces
             initialize isyeri-rec 
             move bag-value(1:8)  to ISYERI-ADRES
             start isyeri key = ISYERI-ADRES invalid 
                  continue 
             not invalid
             perform until fs-isyeri = "10"
             read isyeri next no lock end move "10" to fs-isyeri
             not at end 
                   if isyeri-adres = bag-value(1:8)
                      move isyeri-unvan  to tesis-adi2
                      move "10"  to fs-isyeri
                      exit perform 
                   end-if 
             end-read 
             end-perform
             end-start
             string 
                  tesis-adi delimited by "   "
                  "-" delimited by "   "
                  tesis-adi2 delimited by size 
             into tesis-adi
          end-if 

          if kdv-haric = 1
             move "Kdv Haric"   to html-kdv-haric
          else
             move "Kdv Dahil"   to html-kdv-haric
          end-if 
     
      MOVE BUGUN-CIN-ODA     TO G29
      MOVE BUGUN-CIN-kisi    TO G30
      MOVE bugun-cout-oda    TO G35
      MOVE bugun-cout-kisi   TO G36
      MOVE bugun-iptal-oda   TO G41
      MOVE bugun-iptal-kisi  TO G42
      MOVE bugun-islen-oda   TO G47
      MOVE  bugun-islen-kisi TO G48

      move    bugun-dayuse-kisi    TO G201
      MOVE    bugun-dayuse-oda     TO g200


        compute yuzde rounded  = 
           t-single(1) / takas3-oda(1) * 100
            move yuzde            to g26
        compute yuzde rounded  = 
           t-double(1) / takas3-oda(1) * 100
            move yuzde            to g32
        compute yuzde rounded  = 
           t-triple(1) / takas3-oda(1) * 100
            move yuzde            to g38
        compute yuzde rounded  = 
           takas3-oda(1) / takas3-hazir(1) * 100
            move yuzde            to g44
        compute yuzde rounded  = 
           takas3-pax(1) /  takas3-hazir-yatak(1) * 100
            move yuzde            to g50

     
      move    t-single(1)          to g25
      move    t-single(2)          to g27
      move    t-single(3)          to g28

      move    t-double(1)          to g31
      move    t-double(2)          to g33
      move    t-double(3)          to g34

      move    t-triple(1)          to g37
      move    t-triple(2)          to g39
      move    t-triple(3)          to g40

      move    takas3-oda(1)        to g43
      move    takas3-oda(2)        to g45
      move    takas3-oda(3)        to g46

      move    takas3-pax(1)        to g49
      move    takas3-pax(2)        to g51
      move    takas3-pax(3)        to g52
   


             
             initialize dokumer-rec detay
            
              move "A"          to det-dokumer-20(3:1)
              move 481          to det-1(200  :3)
              
              move "1"          to det-dokumer-20(10:1)
                inspect det-1(12:) replacing all space by high-values
                write dokumer-rec from detay
              initialize dokumer-rec detay
                move "-"            to det-dokumer-20(5:1)
                move all "-"   to det-1(1:364),
              write dokumer-rec from detay

              close isyeri dokumer takas6 takas7 takasfiyat
              
              if key-status = 2 then 
              call dokumer-prog on exception
                   perform callerr-proc
              not on exception
                   cancel dokumer-prog
              end-call
                 else
*                 perform Acu-Report1-Print-ToFile
***                 perform Acu-Report1-Preview
***********************apo burasi
                  perform dll-gonder



                 end-if


                  move isyeri-adres-tasi   to rez-dosya-adres cast-dosya-adres grup-dosya-adres aksiyhrk-dosya-adres 
                                       fiyat-dosya-adres fiyatana-dosya-adres kur-dosya-adres konuk-dosya-adres
                                       romhrk-dosya-adres  kodlar02-dosya-adres gelist-dosya-adres    gelist2-dosya-adres
                                       odalar-dosya-adres bilbord-dosya-adres uzatma-dosya-adres 
                                       odadegis-dosya-adres onkasa-dosya-adres  onkasar-dosya-adres depkod-dosya-adres 
                                       depkod2-dosya-adres  cast3-dosya-adres takvim-dosya-adres takvim2-dosya-adres
        
                  open input  rez cast grup aksiyhrk fiyat fiyatana kur konuk romhrk kodlar02 gelist 
                               odalar bilbord uzatma odadegis onkasa onkasar depkod depkod2 cast3  takvim takvim2
                   open i-o gelist2
                  close   rez cast grup aksiyhrk fiyat fiyatana kur konuk romhrk kodlar02 gelist gelist2
                               odalar bilbord uzatma odadegis onkasa onkasar depkod depkod2 cast3  takvim takvim2


              delete file dokumer takas6 takas7 takasfiyat
    end-evaluate.
     .

 takas-dosya-yaz.
    initialize doviz-tablo
    perform varying xx from 1 by 1 until xx > 7
        move xx         to doviz-sira(xx)
        move spaces     to doviz-kodu2(xx)
    end-perform.

    open i-o genelfis.
    move 1 to genelfis-anahtar.
    read genelfis no lock invalid 
         move 1 to ekran-fis-1
    end-read.
   
    add 1 to ekran-fis-1.
   
    move ekran-fis-1(2:) to takas6-no takas7-no takasfiyat-no.
    rewrite genelfis-rec invalid 
            write genelfis-rec invalid continue
            end-write
    end-rewrite.
    close genelfis.

    initialize tum-data-rec
    open output takas6 close takas6
    open output takas7 close takas7
    open output takasfiyat close takasfiyat
    open i-o takas6 with mass-update.
    open i-o takas7 with mass-update.
    open i-o takasfiyat.
    
    if bag-value not = spaces
*/*/*go ' lu program oldugu icin buras bu sekilde yapld.
       initialize g ikinci-sirkete-gecildi
       perform varying g from 1 by 1 until g > 2
          if g = 1             
             perform olay-baslasin
          end-if 
          if g = 2
                initialize ikinci-sirkete-gecildi
                move 1     to ikinci-sirkete-gecildi

                initialize takas3-top-tutar-1(1)  takas3-top-tutar-1(2)  takas3-top-tutar-1(3) 
                           takas3-top-tutar-2(1)  takas3-top-tutar-2(2)  takas3-top-tutar-2(3) 
                           takas3-top-tutar-3(1)  takas3-top-tutar-3(2)  takas3-top-tutar-3(3)
                           takas3-extra-tutar-1(1) takas3-extra-tutar-1(2) takas3-extra-tutar-1(3)
                           takas3-extra-tutar-2(1) takas3-extra-tutar-2(2) takas3-extra-tutar-2(3)
                           takas3-extra-tutar-3(1) takas3-extra-tutar-3(2) takas3-extra-tutar-3(3)

                  move bag-value   to rez-dosya-adres cast-dosya-adres grup-dosya-adres aksiyhrk-dosya-adres 
                                       fiyat-dosya-adres fiyatana-dosya-adres kur-dosya-adres konuk-dosya-adres
                                       romhrk-dosya-adres  kodlar02-dosya-adres gelist-dosya-adres gelist2-dosya-adres
                                       odalar-dosya-adres bilbord-dosya-adres uzatma-dosya-adres 
                                       odadegis-dosya-adres onkasar-dosya-adres onkasa-dosya-adres  depkod-dosya-adres 
                                       depkod2-dosya-adres  cast3-dosya-adres takvim-dosya-adres takvim2-dosya-adres
        
                  open input  rez cast grup aksiyhrk fiyat fiyatana kur konuk romhrk kodlar02 gelist  
                               odalar bilbord uzatma odadegis onkasa onkasar depkod depkod2 cast3  takvim takvim2
                   open i-o gelist2
                  close   rez cast grup aksiyhrk fiyat fiyatana kur konuk romhrk kodlar02 gelist  gelist2
                               odalar bilbord uzatma odadegis onkasa onkasar depkod depkod2 cast3  takvim takvim2
               
          end-if                
       end-perform
       if ikinci-sirkete-gecildi = 1 and g = 3
          exit paragraph 
       end-if 
    end-if.
*
 olay-baslasin. 
    open input takvim takvim2.
    initialize takvim-rec.
    move ilk-tarih to takvim-anah kur-tarih.      
    move son-tarih to takvim-anah
    start takvim key not < takvim-anah invalid 
          close takvim go takas-dosya-yaz-exit,
          not invalid,         
          open input  rez cast grup aksiyhrk fiyat fiyatana kur konuk romhrk kodlar02 gelist 
                       odalar bilbord uzatma odadegis onkasa onkasar depkod depkod2 cast3
          open i-o gelist2
          move spaces to eh,                          
          perform with test after until evet,
              read takvim next no lock end move "E" to eh,
                   not end,
                   if takvim-anah > son-tarih,
                                    move "E" to eh,
                       else,
                            if takvim-anah not > son-tarih
                               initialize takas6-rec,
                               move takvim-anah to takas6-tarih,
                               write takas6-rec invalid 
                                     rewrite takas6-rec invalid continue
                                     end-rewrite,
                               end-write,
                            end-if,
                   end-if,
              end-read,
          end-perform,

              if ikinci-sirkete-gecildi not = 1 
                 perform forecast-bul
                 perform islenen-bul
                 perform diger-bul
              end-if
 
              perform tum-bas-bul

        add takas3-oda-tutar-1(1) takas3-yiy-tutar-1(1) takas3-ice-tutar-1(1) takas3-aice-tutar-1(1) takas3-dig-tutar-1(1) 
               to takas3-top-tutar-1(1)
       add takas3-oda-tutar-2(1) takas3-yiy-tutar-2(1) takas3-ice-tutar-2(1) takas3-aice-tutar-2(1) takas3-dig-tutar-2(1) 
               to takas3-top-tutar-2(1)
       add takas3-oda-tutar-3(1) takas3-yiy-tutar-3(1) takas3-ice-tutar-3(1) takas3-aice-tutar-3(1) takas3-dig-tutar-3(1) 
               to takas3-top-tutar-3(1)

        add takas3-oda-tutar-1(2) takas3-yiy-tutar-1(2) takas3-ice-tutar-1(2) takas3-aice-tutar-1(2) takas3-dig-tutar-1(2) 
               to takas3-top-tutar-1(2)
       add takas3-oda-tutar-2(2) takas3-yiy-tutar-2(2) takas3-ice-tutar-2(2) takas3-aice-tutar-2(2) takas3-dig-tutar-2(2) 
               to takas3-top-tutar-2(2)
       add takas3-oda-tutar-3(2) takas3-yiy-tutar-3(2) takas3-ice-tutar-3(2) takas3-aice-tutar-3(2) takas3-dig-tutar-3(2) 
               to takas3-top-tutar-3(2)

       add takas3-oda-tutar-1(3) takas3-yiy-tutar-1(3) takas3-ice-tutar-1(3) takas3-aice-tutar-1(3) takas3-dig-tutar-1(3) 
               to takas3-top-tutar-1(3)
       add takas3-oda-tutar-2(3) takas3-yiy-tutar-2(3) takas3-ice-tutar-2(3) takas3-aice-tutar-2(3) takas3-dig-tutar-2(3) 
               to takas3-top-tutar-2(3)
       add takas3-oda-tutar-3(3) takas3-yiy-tutar-3(3) takas3-ice-tutar-3(3) takas3-aice-tutar-3(3) takas3-dig-tutar-3(3) 
               to takas3-top-tutar-3(3)
      
**********************************
        add  takas3-yiy-tutar-1(1) takas3-ice-tutar-1(1) takas3-aice-tutar-1(1) takas3-dig-tutar-1(1) 
               to takas3-extra-tutar-1(1)
       add  takas3-yiy-tutar-2(1) takas3-ice-tutar-2(1) takas3-aice-tutar-2(1) takas3-dig-tutar-2(1) 
               to takas3-extra-tutar-2(1)
       add  takas3-yiy-tutar-3(1) takas3-ice-tutar-3(1) takas3-aice-tutar-3(1) takas3-dig-tutar-3(1) 
               to takas3-extra-tutar-3(1)

        add  takas3-yiy-tutar-1(2) takas3-ice-tutar-1(2) takas3-aice-tutar-1(2) takas3-dig-tutar-1(2) 
               to takas3-extra-tutar-1(2)
       add  takas3-yiy-tutar-2(2) takas3-ice-tutar-2(2) takas3-aice-tutar-2(2) takas3-dig-tutar-2(2) 
               to takas3-extra-tutar-2(2)
       add  takas3-yiy-tutar-3(2) takas3-ice-tutar-3(2) takas3-aice-tutar-3(2) takas3-dig-tutar-3(2) 
               to takas3-extra-tutar-3(2)

        add  takas3-yiy-tutar-1(3) takas3-ice-tutar-1(3) takas3-aice-tutar-1(3) takas3-dig-tutar-1(3) 
               to takas3-extra-tutar-1(3)
       add  takas3-yiy-tutar-2(3) takas3-ice-tutar-2(3) takas3-aice-tutar-2(3) takas3-dig-tutar-2(3) 
               to takas3-extra-tutar-2(3)
       add  takas3-yiy-tutar-3(3) takas3-ice-tutar-3(3) takas3-aice-tutar-3(3) takas3-dig-tutar-3(3) 
               to takas3-extra-tutar-3(3)

    end-start.

    close takvim takvim2 rez cast grup aksiyhrk kodlar02
       konuk romhrk fiyat fiyatana kur gelist odalar gelist2
       bilbord uzatma odadegis onkasa onkasar depkod depkod2 cast3 .

 takas-dosya-yaz-exit.
    exit.
*
 diger-bul.
       initialize konuk-rec
       move "H" to konuk-durumu
       
       start konuk key > konuk-git invalid continue
          not invalid
          perform until fs-konuk ="10"
               read konuk next no lock end move "10" to fs-konuk
                 not end
                  if konuk-fol-kodu not ="R" then
                     exit perform cycle
                  end-if
                  if ONKPARA-REFERANS-VAR = 1
                  perform  sifir-coz
                                        if xkonum-ref(konuk-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(konuk-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         exit perform cycle
                    end-if
                    end-if
                  if konuk-durumu not = "H"  or konuk-git-tar > son-tarih then
                            move "10" to fs-konuk
                            else
                        if Konuk-Erken-Cik = "E" then
                            if konuk-git-tar = son-tarih
                                add 1 to  t-Earlycout(1)


                            end-if
                            if konuk-git-yil = son-yil and konuk-git-ay = son-ay then 
                                     add 1 to  t-Earlycout(2)

                             end-if
                             if konuk-git-yil = son-yil then

                                   add 1 to  t-Earlycout(3)

                             end-if
                        end-if   
                  end-if
                end-read
          end-perform
      end-start
      initialize odadegis-rec
      move ilk-tarih to odadegis-tarih 
       start odadegis key >= odadegis-anah
         invalid continue
         not invalid
         perform until fs-odadegis = "10"
            read odadegis next no lock end move "10" to fs-odadegis
              not end
              move odadegis-folio to konuk-folio
              read konuk  no lock invalid continue
                not invalid
                 if konuk-fol-kodu = "R" then
                      if ONKPARA-REFERANS-VAR = 1
                      perform  sifir-coz
                                        if xkonum-ref(konuk-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(konuk-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         exit perform cycle
                    end-if
                    end-if
                       if odadegis-tarih = son-tarih
                                add 1 to  t-rchange(1)


                            end-if
                            if odadegis-yil = son-yil and odadegis-ay = son-ay then 
                                     add 1 to  t-rchange(2)

                             end-if
                             if odadegis-yil = son-yil then

                                   add 1 to  t-rchange(3)

                             end-if
         
                 end-if
              end-read
            end-read
         end-perform
      end-start
       initialize uzatma-rec
      move ilk-tarih to uzatma-tarih 
       start uzatma key >= uzatma-anah
         invalid continue
         not invalid
         perform until fs-uzatma = "10"
            read uzatma next no lock end move "10" to fs-uzatma
              not end
              move uzatma-folio to konuk-folio
              read konuk  no lock invalid continue
                not invalid
                 if konuk-fol-kodu = "R" then
                 if ONKPARA-REFERANS-VAR = 1
                 perform  sifir-coz
                                        if xkonum-ref(konuk-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(konuk-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         exit perform cycle
                    end-if
                    end-if
                       if uzatma-tarih = son-tarih
                                add 1 to  t-extention(1)


                            end-if
                            if uzatma-yil = son-yil and uzatma-ay = son-ay then 
                                    add 1 to  t-extention(2)

                             end-if
                             if uzatma-yil = son-yil then
                                   add 1 to  t-extention(3)

                             end-if
         
                 end-if
              end-read
            end-read
         end-perform
      end-start



         .
*
 tum-bas-bul.
    initialize gelist-rec
    move ilk-tarih to gelist-tarih    
    start gelist key not < gelist-anah invalid 
           continue
    not invalid,           
          perform with test after until fs-gelist = "10",
              read gelist next no lock end move "10" to fs-gelist,
                   not end,
                   if gelist-tarih > son-tarih,
                      move "10" to fs-gelist
                   else
*                         if k-kodu-tasi = "ASYA" and gelist-folio = 615101 then stop " " end-if
                         move gelist-folio to konuk-folio
                         read konuk no lock invalid
                            continue
                         not invalid 
                              move konuk-odeme-tipi to kodlar02-kodu
                              move "B" to kodlar02-tipi
                              read kodlar02 no lock invalid 
                                 continue
                              end-read  
                         end-read
                            initialize rez-rec
                            if konuk-fol-kodu = "R"
                               move konuk-rez-no  to rez-no
                            else
                               move konuk-extra-rez-no to rez-no
                            end-if 
                            read rez no lock invalid 
                                 continue 
                            not invalid
                            if tumu > 1 then
                                  move "B" to kodlar02-tipi
                                  move rez-odeme-tipi to kodlar02-kodu
                                  read kodlar02 no lock invalid 
                                      move spaces to kodlar02-adi
                                  end-read
                                 if ( ode-tipi = "D" or  ode-tipi = "F" or  ode-tipi = "O")   and tumu = 2 then
                                   exit perform cycle
                                  end-if
                                  if ( ode-tipi not = "D" and ode-tipi not = "F" and ode-tipi not = "O") and tumu = 3 then
                                   exit perform cycle
                                  end-if
                            end-if
                                if filtre-var = 1 then 
                                   perform filtre
                                   if filtre-gecti not = 1 then 
                                         exit perform cycle 
                                   end-if
                                end-if                                

                            end-read 

                         initialize cast-rec
                         move gelist-tarih to cast-tarih
                         move rez-no       to cast-rez-no
                         read cast no lock invalid 
                              move rez-fiyat-konumu to cast-fiyat-konumu
                             move rez-oda-konumu to cast-oda-konumu
                         not invalid 
                             move cast-oda-no to rez-odano
                             move cast-fiyat-konumu to rez-fiyat-konumu
                             move cast-oda-konumu to rez-oda-konumu
                         end-read 
                          if ONKPARA-REFERANS-VAR = 1
                          perform  sifir-coz
                                        if xkonum-ref(cast-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(cast-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         exit perform cycle
                          end-if
                          end-if
                         if ikinci-sirkete-gecildi = 1
                            initialize odalar-rec
                            move rez-odano  to odalar-anah
                            read odalar no lock invalid 
                                 exit perform cycle 
                            not invalid 
                                if odalar-hayali not = "H" 
                                     exit perform cycle  
                                end-if 
                            end-read 
                         end-if 

                         if rez-odano not = spaces and 
                               ( hayali-haric = 1 or dis-haric = 1 ) then 
                                      move rez-odano to odalar-anah
                                      read odalar no lock invalid 
                                          continue
                                      not invalid
                                      if ( odalar-hayali = "H" and hayali-haric = 1 )  then
                                               move 0 to eklenecek-oda
                                      end-if
                                       if ( dis-haric = 1 and odalar-dis = 1 )  then
                                               exit perform cycle
                                      end-if 
                                      end-read
                         end-if  

                         move "01" to kur-banka
                         move butce-cev-doviz  to kur-doviz
                         move gelist-tarih     to kur-tarih
                         read kur no lock invalid 
                             move 1 to doviz-alis
                         end-read
                         move doviz-alis to cev1


                         move butce-cev-doviz2 to kur-doviz
                         read kur no lock invalid 
                                 move 1 to doviz-alis
                         end-read
                         move doviz-alis to cev2
                        initialize gelist2-rec
                                move gelist-ANAH to gelist2-ANAH
                                read gelist2 no lock invalid
                                    continue 
                                end-read    
                         if kdv-haric = 1
***                            compute gelist-oda rounded = gelist-oda / 1.08
                          move gelist-tarih to kdv-rap-tarih 
                          perform genel2-cinkdv-ayarla


                                    | move CINPARA-MUS-KDV to depkod-kdv  
                    move 0 to oran-top   oran2-top

                    add   CINPARA-MUS-KDV to   oran-top
                    if   kv-gecis-tar <= gelist-tarih
                       add kv-orani to oran-top
                     end-if
                     
                     if kdv-haric = 0 
                          add  CINPARA-MUS-KDV to     oran2-top
                     end-if
                     if kv-haric = 0   and  (  kv-gecis-tar <= gelist-tarih )
                          add  kv-orani to     oran2-top
                     end-if

                   
                      compute carpankv = (100 + oran2-top) / (oran-top + 100 )














                            compute gelist-oda rounded = gelist-oda * carpankv
                             
                            compute gelist-yiy rounded = gelist-yiy / ext-kdv
                            compute gelist-ice rounded = gelist-ice / ext-kdv
                            compute gelist-dig rounded = gelist-dig / ext-kdv
                            compute gelist2-alk rounded = gelist2-alk / 1.18    
                         end-if 

                         if gelist-tarih = son-tarih
*                            if k-kodu-tasi = "ASYA" stop " " end-if
                            evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-tutar-1(1) rounded = 
                                                 takas3-hous-tutar-1(1)  + gelist-oda
                                    compute takas3-hous-tutar-2(1) rounded = 
                                                 takas3-hous-tutar-2(1)  + ( gelist-oda /cev1)
                                    compute takas3-hous-tutar-3(1) rounded = 
                                                 takas3-hous-tutar-3(1)  + ( gelist-oda /cev2)
                                 when "C"    
                                 when "D"
                                 when "O"
                                    compute takas3-comp-tutar-1(1) rounded = 
                                                 takas3-comp-tutar-1(1)  + gelist-oda
                                    compute takas3-comp-tutar-2(1) rounded = 
                                                 takas3-comp-tutar-2(1)  + ( gelist-oda /cev1)
                                    compute takas3-comp-tutar-3(1) rounded = 
                                                 takas3-comp-tutar-3(1)  + ( gelist-oda /cev2)
                                    
                                 when other
                                    compute takas3-ucr-tutar-1(1) rounded = 
                                                 takas3-ucr-tutar-1(1)  + gelist-oda
                                    compute takas3-ucr-tutar-2(1) rounded = 
                                                 takas3-ucr-tutar-2(1)  + ( gelist-oda / cev1 )
                                    compute takas3-ucr-tutar-3(1) rounded = 
                                                 takas3-ucr-tutar-3(1)  + ( gelist-oda / cev2 )
                            end-evaluate      
                            compute takas3-oda-tutar-1(1) rounded = 
                                                 takas3-oda-tutar-1(1)  + gelist-oda
                            compute takas3-oda-tutar-2(1) rounded = 
                                                 takas3-oda-tutar-2(1)  + ( gelist-oda / cev1 )
                            compute takas3-oda-tutar-3(1) rounded = 
                                                 takas3-oda-tutar-3(1)  + ( gelist-oda / cev2 )

                            if ikinci-sirkete-gecildi not = 1
                            compute takas3-yiy-tutar-1(1) rounded = 
                                                 takas3-yiy-tutar-1(1)  + gelist-yiy
                            compute takas3-yiy-tutar-2(1) rounded = 
                                                 takas3-yiy-tutar-2(1)  + (gelist-yiy / cev1 )
                            compute takas3-yiy-tutar-3(1) rounded = 
                                                 takas3-yiy-tutar-3(1)  + (gelist-yiy / cev2 )
                                                 
                                                 
                             compute takas3-ice-tutar-1(1) rounded = 
                                                 takas3-ice-tutar-1(1)  + gelist-ice
                             compute takas3-ice-tutar-2(1) rounded = 
                                                 takas3-ice-tutar-2(1)  + (gelist-ice / cev1 )
                            compute takas3-ice-tutar-3(1) rounded = 
                                                 takas3-ice-tutar-3(1)  + (gelist-ice / cev2 )


                             compute takas3-aice-tutar-1(1) rounded = 
                                                 takas3-aice-tutar-1(1)  + gelist2-alk
                             compute takas3-aice-tutar-2(1) rounded = 
                                                 takas3-aice-tutar-2(1)  + (gelist2-alk / cev1 )
                            compute takas3-aice-tutar-3(1) rounded = 
                                                 takas3-aice-tutar-3(1)  + (gelist2-alk / cev2 )

                             compute takas3-dig-tutar-1(1) rounded = 
                                                 takas3-dig-tutar-1(1)  + gelist-dig
                            compute takas3-dig-tutar-2(1) rounded = 
                                                 takas3-dig-tutar-2(1)  + (gelist-dig / cev1 )
                            compute takas3-dig-tutar-3(1) rounded = 
                                                 takas3-dig-tutar-3(1)  + (gelist-dig / cev2 ) 
                            end-if  
                         end-if
********************************AYLIK

                          if gelist-ay = son-ay and gelist-yil = son-yil then
                                evaluate ode-tipi
                                when "F"
                                    compute takas3-hous-tutar-1(2) rounded = 
                                                 takas3-hous-tutar-1(2)  + gelist-oda
                                    compute takas3-hous-tutar-2(2) rounded = 
                                                 takas3-hous-tutar-2(2)  + ( gelist-oda /cev1)
                                    compute takas3-hous-tutar-3(2) rounded = 
                                                 takas3-hous-tutar-3(2)  + ( gelist-oda /cev2)
                                 when "C"  
                                 when "D"
                                 when "O"
                                    compute takas3-comp-tutar-1(2) rounded = 
                                                 takas3-comp-tutar-1(2)  + gelist-oda
                                    compute takas3-comp-tutar-2(2) rounded = 
                                                 takas3-comp-tutar-2(2)  + ( gelist-oda /cev1)
                                    compute takas3-comp-tutar-3(2) rounded = 
                                                 takas3-comp-tutar-3(2)  + ( gelist-oda /cev2)
                                    
                                 when other
                                    compute takas3-ucr-tutar-1(2) rounded = 
                                                 takas3-ucr-tutar-1(2)  + gelist-oda
                                    compute takas3-ucr-tutar-2(2) rounded = 
                                                 takas3-ucr-tutar-2(2)  + ( gelist-oda / cev1 )
                                    compute takas3-ucr-tutar-3(2) rounded = 
                                                 takas3-ucr-tutar-3(2)  + ( gelist-oda / cev2 )
                            end-evaluate

                            compute takas3-oda-tutar-1(2) rounded = 
                                                 takas3-oda-tutar-1(2)  + gelist-oda
                            compute takas3-oda-tutar-2(2) rounded = 
                                                 takas3-oda-tutar-2(2)  + ( gelist-oda / cev1 )
                            compute takas3-oda-tutar-3(2) rounded = 
                                                 takas3-oda-tutar-3(2)  + ( gelist-oda / cev2 )

                            if ikinci-sirkete-gecildi not = 1
                            compute takas3-yiy-tutar-1(2) rounded = 
                                                 takas3-yiy-tutar-1(2)  + gelist-yiy
                            compute takas3-yiy-tutar-2(2) rounded = 
                                                 takas3-yiy-tutar-2(2)  + (gelist-yiy / cev1 )
                            compute takas3-yiy-tutar-3(2) rounded = 
                                                 takas3-yiy-tutar-3(2)  + (gelist-yiy / cev2 )
                                                 
                                                 
                             compute takas3-ice-tutar-1(2) rounded = 
                                                 takas3-ice-tutar-1(2)  + gelist-ice
                             compute takas3-ice-tutar-2(2) rounded = 
                                                 takas3-ice-tutar-2(2)  + (gelist-ice / cev1 )
                             compute takas3-ice-tutar-3(2) rounded = 
                                                 takas3-ice-tutar-3(2)  + (gelist-ice / cev2 )


                             compute takas3-aice-tutar-1(2) rounded = 
                                                 takas3-aice-tutar-1(2)  + gelist2-alk
                             compute takas3-aice-tutar-2(2) rounded = 
                                                 takas3-aice-tutar-2(2)  + (gelist2-alk / cev1 )
                             compute takas3-aice-tutar-3(2) rounded = 
                                                 takas3-aice-tutar-3(2)  + (gelist2-alk / cev2 )









                             compute takas3-dig-tutar-1(2) rounded = 
                                                 takas3-dig-tutar-1(2)  + gelist-dig
                             compute takas3-dig-tutar-2(2) rounded = 
                                                 takas3-dig-tutar-2(2)  + (gelist-dig / cev1 )
                             compute takas3-dig-tutar-3(2) rounded = 
                                                 takas3-dig-tutar-3(2)  + (gelist-dig / cev2 )
                             end-if 
                          end-if
                          if  gelist-yil = son-yil then
                                evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-tutar-1(3) rounded = 
                                                 takas3-hous-tutar-1(3)  + gelist-oda
                                    compute takas3-hous-tutar-2(3) rounded = 
                                                 takas3-hous-tutar-2(3)  + ( gelist-oda /cev1)
                                    compute takas3-hous-tutar-3(3) rounded = 
                                                 takas3-hous-tutar-3(3)  + ( gelist-oda /cev2)
                                 when "C"  
                                 when "D"
                                 when "O"
                                    compute takas3-comp-tutar-1(3) rounded = 
                                                 takas3-comp-tutar-1(3)  + gelist-oda
                                    compute takas3-comp-tutar-2(3) rounded = 
                                                 takas3-comp-tutar-2(3)  + ( gelist-oda /cev1)
                                    compute takas3-comp-tutar-3(3) rounded = 
                                                 takas3-comp-tutar-3(3)  + ( gelist-oda /cev2)
                                    
                                 when other
                                    compute takas3-ucr-tutar-1(3) rounded = 
                                                 takas3-ucr-tutar-1(3)  + gelist-oda
                                    compute takas3-ucr-tutar-2(3) rounded = 
                                                 takas3-ucr-tutar-2(3)  + ( gelist-oda / cev1 )
                                    compute takas3-ucr-tutar-3(3) rounded = 
                                                 takas3-ucr-tutar-3(3)  + ( gelist-oda / cev2 )
                            end-evaluate
                            compute takas3-oda-tutar-1(3) rounded = 
                                                 takas3-oda-tutar-1(3)  + gelist-oda
                            compute takas3-oda-tutar-2(3) rounded = 
                                                 takas3-oda-tutar-2(3)  + ( gelist-oda / cev1 )
                            compute takas3-oda-tutar-3(3) rounded = 
                                                 takas3-oda-tutar-3(3)  + ( gelist-oda / cev2 )
                            if ikinci-sirkete-gecildi not = 1
                            compute takas3-yiy-tutar-1(3) rounded = 
                                                 takas3-yiy-tutar-1(3)  + gelist-yiy
                            compute takas3-yiy-tutar-2(3) rounded = 
                                                 takas3-yiy-tutar-2(3)  + (gelist-yiy / cev1 )
                            compute takas3-yiy-tutar-3(3) rounded = 
                                                 takas3-yiy-tutar-3(3)  + (gelist-yiy / cev2 )
                                                 
                                                 
                             compute takas3-ice-tutar-1(3) rounded = 
                                                 takas3-ice-tutar-1(3)  + gelist-ice
                             compute takas3-ice-tutar-2(3) rounded = 
                                                 takas3-ice-tutar-2(3)  + (gelist-ice / cev1 )
                             compute takas3-ice-tutar-3(3) rounded = 
                                                 takas3-ice-tutar-3(3)  + (gelist-ice / cev2 )


                             compute takas3-aice-tutar-1(3) rounded = 
                                                 takas3-aice-tutar-1(3)  + gelist2-alk
                             compute takas3-aice-tutar-2(3) rounded = 
                                                 takas3-aice-tutar-2(3)  + (gelist2-alk / cev1 )
                             compute takas3-aice-tutar-3(3) rounded = 
                                                 takas3-aice-tutar-3(3)  + (gelist2-alk / cev2 )

                             compute takas3-dig-tutar-1(3) rounded = 
                                                 takas3-dig-tutar-1(3)  + gelist-dig
                             compute takas3-dig-tutar-2(3) rounded = 
                                                 takas3-dig-tutar-2(3)  + (gelist-dig / cev1 )
                             compute takas3-dig-tutar-3(3) rounded = 
                                                 takas3-dig-tutar-3(3)  + (gelist-dig / cev2 ) 
                             end-if 
                          end-if
                          
                   end-if
              end-read
          end-perform,
    end-start.



 cast-oku.
    if merkez = 1 then 
      move "01" to kur-banka
      move butce-cev-doviz  to kur-doviz
      move cast-tarih to kur-tarih
      read kur no lock invalid
         move tarih-tasi to kur-tarih
         read kur no lock invalid 
          move 1 to doviz-alis
         end-read
      end-read
      move doviz-alis to mer-cev
    end-if
    initialize cast-rec.
    move takvim-anah to cast-tarih.
    start cast key not < cast-tarih invalid continue,
        not invalid,
        move spaces to var-yok,
        perform with test after until var,
            read cast next no lock end move "V" to var-yok,
                 not end,
                 if cast-tarih > takvim-anah move "V" to var-yok,
                     else,
                     if cast-tarih not > takvim-anah,
                        initialize rez-rec,
                        move cast-rez-no to rez-no,
                        read rez no lock invalid 
                          continue,
                        not invalid
                    evaluate true
                     when rap-tip = "N"
                         if rez-durumu <> "I"
                            exit perform cycle
                         end-if
                         if rez-k-g-b <> "K"
                              if rez-k-g-b   = "O" and info-dahil = 1
                                 continue
                              else
                                 exit perform cycle
                              end-if
                         end-if
                     end-evaluate
                            if filtre-var = 1 then 
                               perform filtre
                               if filtre-gecti not = 1 then 
                                     exit perform cycle 
                               end-if
                            end-if
                            if ONKPARA-REFERANS-VAR = 1
                                 perform  sifir-coz
                                        if xkonum-ref(cast-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(cast-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         exit perform cycle
                          end-if
                          end-if
                         move cast-oda-no to rez-odano
                      move cast-fiyat-konumu to rez-fiyat-konumu
                      move cast-oda-konumu to rez-oda-konumu
                       if rez-kisi not = cast-kisi
                          move cast-kisi to rez-kisi
                       
                 
                
                
                
                       end-if
                         move cast-share to rez-share
       


                      if filtre-var = 1 then 
                        perform filtre
                        if filtre-gecti = 1 then 
                          perform takas-kaydet thru takas-kaydet-exit
                        end-if
                      else
                        perform takas-kaydet thru takas-kaydet-exit 
                    end-if
                        end-read,
                     end-if,
                 end-if,
            end-read,
        end-perform,
    end-start.
 cast-oku-exit.
  
    exit.
 takas-kaydet.
       if tumu > 1 then
             move "B" to kodlar02-tipi
             move rez-odeme-tipi to kodlar02-kodu
             read kodlar02 no lock invalid 
                 move spaces to kodlar02-adi
             end-read
            if ( ode-tipi = "D" or  ode-tipi = "F" or  ode-tipi = "O")   and tumu = 2 then
              go takas-kaydet-exit
             end-if
             if ( ode-tipi not = "D" and ode-tipi not = "F" and ode-tipi not = "O") and tumu = 3 then
              go takas-kaydet-exit
             end-if
       end-if       
       initialize kodlar02-rec.
       move "B"                to kodlar02-tipi.
       move rez-odeme-tipi    to kodlar02-kodu
       read kodlar02         no lock invalid 
           go takas-kaydet-exit
       end-read
     
        if ode-posting = "H" then          
           go takas-kaydet-exit 
        end-if
        if onkpara-referans-var = 1 then 
           perform ref-filtre
           if  not ref-gecti then 
               exit paragraph
           end-if
        end-if
    evaluate true
    when rap-tip = "N"
         if rez-durumu not = "I" 
            go takas-kaydet-exit,
         end-if,
         if info-dahil = 0
         if rez-k-g-b  not = "K" 
            go takas-kaydet-exit,
         end-if
         end-if
    when rap-tip = "W"
         if rez-durumu not = "I" go takas-kaydet-exit,
         end-if,
         if rez-k-g-b      = "K" go takas-kaydet-exit,
         end-if,
    when rap-tip = "S"
         if rez-durumu not = "S" go takas-kaydet-exit,
         end-if.

    

*** Grup Filtresi

    if acn-grup-kod not = spaces
      initialize grup-rec
      set grup-acenta to true
      move acn-grup-kod to grup-kodu
      move rez-acenta   to grup-alt
      read grup no lock
        invalid
          go takas-kaydet-exit
      end-read
    end-if

*** Grup Filtresi
*   TRACE Uygulamasi Acik ise kisi sayilari cast'tan alinacak

 
    move 1 to eklenecek-oda
    if rezpara-trace = 1
      move cast-oda-no to rez-odano
      move cast-fiyat-konumu to rez-fiyat-konumu
      move cast-oda-konumu to rez-oda-konumu
       if rez-kisi not = cast-kisi
          move cast-kisi to rez-kisi               
       end-if
         move cast-share to rez-share
       
       if rez-share = 1 then 
         
             move 0 to eklenecek-oda 
            else
              move 1 to eklenecek-oda
          end-if
      else 
          move 1 to eklenecek-oda
    end-if

     if rez-odano not = spaces and 
       ( hayali-haric = 1 or dis-haric = 1 ) then 
              move rez-odano to odalar-anah
              read odalar no lock invalid continue
              not invalid
              if ( odalar-hayali = "H" and hayali-haric = 1 )  then
                       move 0 to eklenecek-oda
              end-if
               if ( dis-haric = 1 and odalar-dis = 1 )  then
                          go takas-kaydet-exit
              end-if 
              end-read
    end-if  
    initialize xx sira-sakla.
    move "H" to eh.
    perform varying xx from 1 by 1 until xx > 6 or evet,
        if doviz-kodu2(xx) not = spaces
              if rez-doviz = doviz-kodu2(xx),
                 move doviz-sira(xx) to sira-sakla,
                 move "E" to eh,
              end-if,
          else
              if not evet
                 move rez-doviz      to doviz-kodu2(xx),
                 move doviz-sira(xx) to sira-sakla,
                 move tarih-tasi to kur-tarih
                 move rez-banka to kur-banka
                 move rez-doviz     to kur-doviz
                 read kur no lock invalid 
                     move 1 to doviz-alis
                 end-read
                 move doviz-alis to doviz-kuru(xx) butce-kurlari(butce-cev-doviz)
                 move "E" to eh,
              end-if
        end-if,
    end-perform.
    
    if hayir go takas-kaydet-exit.
       evaluate ychild(1:1)
       when 1 
        compute pax-sayisi = rez-buyuk + ( rez-kucuk / 2 )
       when 0
        compute pax-sayisi = rez-buyuk
       when 2 
           compute pax-sayisi = rez-buyuk +  rez-kucuk  + rez-free
       when 3
         compute pax-sayisi = rez-buyuk +  rez-kucuk  + rez-free + rez-bebek
       when 4
          compute pax-sayisi = rez-buyuk +  rez-kucuk 
       when other
            compute pax-sayisi = rez-buyuk + ( rez-kucuk / 2 )   
      end-evaluate

      if rez-cik-tar = takvim-anah 
        move 0 to eklenecek-oda pax-sayisi

      end-if
       initialize takas7-rec
       move cast-tarih to takas7-tarih
       move rez-no     to takas7-rez
       
***************************************
             move rez-no  to takasfiyat-rez-no
             move takvim-anah to takasfiyat-tarih
             
             read takasfiyat no lock 
                invalid
                
                   perform  peryot-fiyat-bul
                   if  rez-cik-tar  = takvim-anah then 
                     initialize pax-sayisi
                  end-if
              perform varying jj from 1 by 1 until  jj > 200
                      
                if fiyatt-tar(jj) = takvim-anah
                
                  if gercek-cin-kuru = 1 then 
                      compute cevrilmis-deger rounded =  fiyatt-fiy(jj) * 
                       fiyatt-kur(jj) / butce-kurlari(butce-cev-doviz)
                       compute cevrilmis-tl rounded =  fiyatt-fiy(jj) * 
                       fiyatt-kur(jj)
                       if merkez = 1 then 
                         if rez-doviz = butce-cev-doviz and rez-banka = "01" then 
                           move  fiyatt-fiy(jj) to cevrilmis-deger
                           else
                          compute cevrilmis-deger rounded =  fiyatt-fiy(jj) * 
                             fiyatt-kur(jj) / mer-cev

                         end-if

                       end-if
                    else
                       compute cevrilmis-deger =  fiyatt-fiy(jj) *  
                       butce-kurlari(rez-doviz) / butce-kurlari(butce-cev-doviz)
                       compute cevrilmis-tl rounded =  fiyatt-fiy(jj) * 
                       butce-kurlari(rez-doviz)  
                       if merkez = 1 then 
                         if rez-doviz = butce-cev-doviz and rez-banka = "01" then 
                           move  fiyatt-fiy(jj) to cevrilmis-deger
                           else
                          compute cevrilmis-deger rounded =  fiyatt-fiy(jj) * 
                             fiyatt-kur(jj) / mer-cev

                         end-if

                       end-if
                  end-if
                     move fiyatt-fiy(jj) to  takasfiyat-fiyat

                       

                      
                end-if
              end-perform  
             
              
              not invalid 
                  if  rez-cik-tar  = takvim-anah then 
                     initialize pax-sayisi
                  end-if
                  if gercek-cin-kuru = 1 then 
                      compute cevrilmis-deger rounded =  takasfiyat-fiyat * 
                       takasfiyat-kur / butce-kurlari(butce-cev-doviz)
                       compute cevrilmis-tl rounded =  takasfiyat-fiyat * 
                       takasfiyat-kur
                       if merkez = 1 then 
                         if rez-doviz = butce-cev-doviz and rez-banka = "01" then 
                           move  takasfiyat-fiyat to cevrilmis-deger
                           else
                          compute cevrilmis-deger rounded =  takasfiyat-fiyat * 
                             takasfiyat-kur / mer-cev

                         end-if

                       end-if
                    else
                       
                       compute cevrilmis-deger =  takasfiyat-fiyat *  
                       butce-kurlari(rez-doviz) / butce-kurlari(butce-cev-doviz)
                       compute cevrilmis-tl =  takasfiyat-fiyat *  
                       butce-kurlari(rez-doviz)
                       if merkez = 1 then 
                         if rez-doviz = butce-cev-doviz and rez-banka = "01" then 
                           move  takasfiyat-fiyat to cevrilmis-deger
                           else
                          compute cevrilmis-deger rounded =  takasfiyat-fiyat * 
                             takasfiyat-kur / mer-cev

                         end-if

                       end-if
                  end-if
                    
             end-read






         




****************************
        move    sira-sakla to xx
        move    doviz-kodu2(xx) to takas6-kod(xx)
        move  takasfiyat-fiyat to takas7-tut  rez-fiyati
      
        compute takas6-tut(xx) = takas6-tut(xx) + takasfiyat-fiyat
        add pax-sayisi to takas6-pax(xx)
        add eklenecek-oda         to takas6-oda(xx)
        compute alt-tut(xx)   rounded = alt-tut(xx)     + takas7-tut
        add pax-sayisi to alt-pax(xx)
        add eklenecek-oda          to alt-oda(xx)
      

         


         compute takas6-tut(7) rounded = takas6-tut(7) + 
                                   cevrilmis-deger 
         compute takas6-oda(7) rounded = takas6-oda(7) + 
                                   eklenecek-oda
         compute takas6-pax(7) rounded = takas6-pax(7) + 
                                   pax-sayisi
         compute alt-tut(7)    rounded = alt-tut(7)     +
                                   cevrilmis-deger 
         compute alt-oda(7)    rounded = alt-oda(7)     +
                                   eklenecek-oda 
         compute alt-pax(7)    rounded = alt-pax(7)     +
                                   pax-sayisi
         
    rewrite takas6-rec invalid write takas6-rec end-rewrite
    move "H" to eh.
 takas-kaydet-exit.
    exit.
 kaydet.
    rewrite takas6-rec invalid 
            write takas6-rec invalid continue
            end-write
    end-rewrite.
*
 takas7-doldur.
       perform peryot-fiyat-bul.

*
 gun-sayisi-bul.
      initialize g-bul-gun-sayisi
                takvim2-rec 
     move rez-gir-tar   to takvim2-anah
     start takvim2 key not < takvim2-anah
           invalid
                move 1 to g-bul-gun-sayisi
     not invalid
     initialize fs-takvim2
     perform with test after until fs-takvim2 = "10"
     read takvim2 next no lock end move "10" to fs-takvim2
     not at end
          if takvim2-anah = rez-cik-tar
             move "10" to fs-takvim2
             exit perform cycle
          end-if
          if takvim2-anah not > rez-cik-tar
             add 1 to g-bul-gun-sayisi
          else
             move "10" to fs-takvim2
          end-if
     end-read
     end-perform
     end-start.

*
 Form2-Ex-Other.
       evaluate key-status
          when 2 
            set exit-pushed to true
       end-evaluate
     .
*
 Form2-Bef-Create.
     .
*
 Form1-Ef-1-Aft-Procedure.
          open input kur doviz 
         move butce-cev-doviz to DOVIZ-KODU
         read doviz no lock invalid
            display message box  "Tanimsiz Doviz Girdiniz"
            move "Tanimsiz " to d-kisa-adi
         end-read
         move  d-kisa-adi to kur-adi

        move ilk-tarih to kur-tarih
        move "87" to kur-banka
        move doviz-kodu to kur-doviz
           read kur no lock invalid
                move 1 to merkez
                display Form1-Cb-1
                move "01" to kur-banka
                read kur no lock invalid
                  move 1 to doviz-alis
                end-read
            end-read
           move doviz-alis to cevrim-kuru
         display kdov adov 
        close kur doviz
     .

*
 Form1-Ef-2-Aft-Procedure.
          open input kur doviz 
         move butce-cev-doviz2 to DOVIZ-KODU
         read doviz no lock invalid
            display message box  "Tanimsiz Doviz Girdiniz"
            move "Tanimsiz " to d-kisa-adi
         end-read
         move  d-kisa-adi to kur-adi2

        move ilk-tarih to kur-tarih
        move "87" to kur-banka
        move doviz-kodu to kur-doviz
           read kur no lock invalid
                move 1 to merkez
                display Form1-Cb-1
                move "01" to kur-banka
                read kur no lock invalid
                  move 1 to doviz-alis
                end-read
            end-read
           move doviz-alis to cevrim-kuru
         display kdova adova 
        close kur doviz
     .


 forecast-bul.
*      open output trnot
      initialize ilerisi
      move ilk-tarih to takvim-anah
      start takvim key >= takvim-anah invalid 
             continue
      not invalid
          perform until fs-takvim = "10"
              read takvim next no lock 
                 end move "10" to fs-takvim
                 not end

                   if takvim-anah < son-tarih
                           if fiyat-ref > 0 then 
                                move takvim-ref-hazir-oda (fiyat-ref) to  takvim-hazir-oda                     
                                move takvim-ref-hazir-yatak (fiyat-ref) to  takvim-hazir-yatak
                            end-if
                            if oda-ref > 0 then 
                                move takvim-ref-hazir-oda (oda-ref) to  takvim-hazir-oda  
                                move takvim-ref-hazir-yatak (oda-ref) to  takvim-hazir-yatak
                            end-if
                           if takvim-anah = son-tarih
                              add  TAKVIM-HAZIR-ODA  to takas3-hazir(1)
                              add takvim-hazir-yatak to takas3-hazir-yatak(1)
                           end-if
                           if takvim-ay = son-ay   and takvim-yil = son-yil
                             add  TAKVIM-HAZIR-ODA  to takas3-hazir(2)
                                   add takvim-hazir-yatak   to takas3-hazir-yatak(2)
                       
                           end-if
                           if takvim-yil = son-yil   
                             add  TAKVIM-HAZIR-ODA  to takas3-hazir(3)
                             add takvim-hazir-yatak   to takas3-hazir-yatak(3)                       
                           end-if
                     perform gece-bul
                   else
****************************ileriya dogru
                   if fiyat-ref > 0 then 
                        move takvim-ref-hazir-oda (fiyat-ref) to  takvim-hazir-oda                     
                        move takvim-ref-hazir-yatak (fiyat-ref) to  takvim-hazir-yatak
                    end-if
                    if oda-ref > 0 then 
                        move takvim-ref-hazir-oda (oda-ref) to  takvim-hazir-oda  
                        move takvim-ref-hazir-yatak (oda-ref) to  takvim-hazir-yatak
                    end-if
                       if ilerisi = 0
                             if takvim-anah = son-tarih
                              add  TAKVIM-HAZIR-ODA  to takas3-hazir(1)
                              add takvim-hazir-yatak to takas3-hazir-yatak(1)
                             end-if
                           if takvim-ay = son-ay   and takvim-yil = son-yil
                             add  TAKVIM-HAZIR-ODA  to takas3-hazir(2)
                                   add takvim-hazir-yatak   to takas3-hazir-yatak(2)
                       
                           end-if
                           if takvim-yil = son-yil   
                             add  TAKVIM-HAZIR-ODA  to takas3-hazir(3)
                             add takvim-hazir-yatak   to takas3-hazir-yatak(3)                       
                           end-if
                           perform gece-bul
                       end-if 

                       add 1 to ilerisi
                       if ilerisi < 8 then
                          perform bilbord-al
                          move takvim-ay  to e-ay
                          move takvim-yil to e-yil
                          move takvim-gun to e-gun
                          move e-tarih    to for-tarih(ilerisi)
                          move takvim-hazir-oda to for-hazir(ilerisi)
                           perform igece-bul
                           compute for-doluluk(ilerisi) = for-oda(ilerisi) + for-forecast(ilerisi)
                           compute for-yuzde(ilerisi) rounded  =  for-doluluk(ilerisi) / for-hazir(ilerisi) * 100
                           compute for-netdolu(ilerisi) = for-doluluk(ilerisi)  - for-birles(ilerisi)
                           compute for-netyuzde(ilerisi) rounded  =  for-netdolu(ilerisi) / for-hazir(ilerisi) * 100
                          





                           else
                          move "10" to fs-takvim
                        end-if


                      
                   end-if

                end-read
          end-perform
     end-start   .
*     close trnot.
*****************************************
 bilbord-al.
    initialize bilbord-rec son-acenta acenta-bilb
    move takvim-anah to bilbord-tarih 
    start bilbord key > bilbord-anah2 invalid continue
      not invalid
       perform until fs-bilbord = "10"
           read bilbord next no lock
             end move "10" to fs-bilbord
              not end
                if son-acenta  = spaces 
                   move bilbord-acenta to son-acenta 
                end-if
                if  son-acenta not = bilbord-acenta
                   if acenta-bilb > 0 then
                       compute for-forecast(ilerisi) = 
                          for-forecast(ilerisi) + acenta-bilb

                    end-if
                    initialize acenta-bilb
                    move bilbord-acenta to son-acenta
                end-if
              if bilbord-tarih  = takvim-anah 
               if  bilbord-oda not = bilbord-sat-oda
              compute acenta-bilb =  acenta-bilb +
                 bilbord-oda - bilbord-sat-oda
               end-if
                else
                move "10" to fs-bilbord
               end-if 
           end-read
       end-perform
    end-start
              if  son-acenta not = bilbord-acenta
                   if acenta-bilb > 0 then
                       compute for-forecast(ilerisi) = 
                          for-forecast(ilerisi) + acenta-bilb

                    end-if
                    initialize acenta-bilb
                    move bilbord-acenta to son-acenta
                end-if


    .

 gece-bul.
     initialize cast-rec var-yok.
    move takvim-anah to cast-tarih.
    start cast key not < cast-tarih invalid continue
      not invalid
        perform with test after until var
          read cast next no lock end move "V" to var-yok
            not end
              if cast-tarih > takvim-anah
                        move "V" to var-yok
               else
                        initialize rez-rec
                        move cast-rez-no to rez-no
                        read rez no lock invalid continue
                          not invalid
                                if rez-durumu not = "I"
                                     exit perform cycle,
                                 end-if
                            if filtre-var = 1 then 
                               perform filtre
                               if filtre-gecti not = 1 then 
                                     exit perform cycle 
                               end-if
                            end-if
                                 if ONKPARA-REFERANS-VAR = 1
                                       perform  sifir-coz
                                        if xkonum-ref(cast-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(cast-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         continue
                                 else
                                        perform gece-bul2
                                 end-if
                             else
                                 perform gece-bul2
                            end-if
                        end-read
              end-if
          end-read
        end-perform
    end-start.
 
*
 gece-bul2.
        
          if tumu > 1 then
             move "B" to kodlar02-tipi
             move rez-odeme-tipi to kodlar02-kodu
             read kodlar02 no lock invalid 
                 move spaces to kodlar02-adi
             end-read
            if ( ode-tipi = "D" or  ode-tipi = "F" or  ode-tipi = "O")   and tumu = 2 then
              exit paragraph
             end-if
             if ( ode-tipi not = "D" and ode-tipi not = "F" and ode-tipi not = "O") and tumu = 3 then
              exit paragraph
             end-if
       end-if    
           
        
          move "B" to kodlar02-tipi
          move rez-odeme-tipi to kodlar02-kodu
          read kodlar02 no lock invalid 
              move spaces to kodlar02-adi
          end-read

*** Grup Filtresi
   
     move 1 to eklenecek-oda
    if rezpara-trace = 1
      move cast-oda-no to rez-odano
      move cast-fiyat-konumu to rez-fiyat-konumu
      move cast-oda-konumu to rez-oda-konumu
       if rez-kisi not = cast-kisi
          move cast-kisi to rez-kisi
       
       end-if
          move cast-share to rez-share
       if rez-share = 1 then 
             move 0 to eklenecek-oda 
            else
              move 1 to eklenecek-oda
       end-if
      else 
          move 1 to eklenecek-oda
    end-if
    if rez-odano not = spaces and 
       ( hayali-haric = 1 or dis-haric = 1 ) then 
              move rez-odano to odalar-anah
              read odalar no lock invalid continue
              not invalid
              if ( odalar-hayali = "H" and hayali-haric = 1 )  then
                       move 0 to eklenecek-oda
              end-if
               if ( dis-haric = 1 and odalar-dis = 1 )  then
                           exit paragraph
              end-if 
              end-read
    end-if  

     if cast-tarih = rez-cik-tar  and
          cast-tarih = son-tarih then 
           add eklenecek-oda to bugun-cout-oda
            



           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               bugun-cout-kisi

          if cast-tarih = rez-gir-tar then
           
               add eklenecek-oda to bugun-dayuse-oda

               add rez-buyuk rez-kucuk rez-free rez-bebek  to bugun-dayuse-kisi
          end-if

    end-if
    if cast-tarih >= rez-cik-tar
          exit paragraph
    end-if
      if cast-tarih = rez-gir-tar  and
          cast-tarih = son-tarih then 
           add eklenecek-oda to bugun-cin-oda 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               bugun-cin-kisi
    end-if
    
    
     
     evaluate ychild(1:1)
       when 0
        compute geceleme = rez-buyuk
       when 1 
        compute geceleme = rez-buyuk + ( rez-kucuk / 2 )
            initialize rez-kucuk     
       when 2 
           compute geceleme = rez-buyuk +  rez-kucuk  + rez-free
           initialize rez-kucuk   rez-free  
       when 3
         compute geceleme = rez-buyuk +  rez-kucuk  + rez-free + rez-bebek
          initialize rez-kucuk   rez-free  rez-bebek
       when 4
          compute geceleme = rez-buyuk +  rez-kucuk
           initialize rez-kucuk
       when other
            compute geceleme = rez-buyuk + ( rez-kucuk / 2 ) 
            initialize rez-kucuk
      end-evaluate


      

          if cast-tarih = son-tarih
                   if eklenecek-oda = 1 
                     evaluate rez-buyuk
                         when 1
                             add 1 to t-single(1)
                         when 2
                             add 1 to t-double(1)
                         when 3 when 4   when 5 when 6  when 7 when 8    when 9
                             add 1 to t-triple(1)

                     end-evaluate
                    end-if
                    
                            evaluate ode-tipi

                                 when "F"
                                    compute takas3-hous-oda(1) rounded = 
                                                 takas3-hous-oda(1)  + eklenecek-oda
                                    compute takas3-hous-pax(1) rounded = 
                                                 takas3-hous-pax(1)  + geceleme

                                    compute takas3-hous-chi(1) rounded = 
                                                 takas3-hous-chi(1)  + rez-kucuk
                                    compute takas3-hous-free(1) rounded = 
                                                 takas3-hous-free(1)  + rez-free
                                    compute takas3-hous-bebek(1) rounded = 
                                                 takas3-hous-bebek(1)  + rez-bebek
                                    
                                 when "C"      
                                 when "D"
                                 when "O"
                                    compute takas3-comp-oda(1) rounded = 
                                                 takas3-comp-oda(1)  + eklenecek-oda
                                    compute takas3-comp-pax(1) rounded = 
                                                 takas3-comp-pax(1)  + geceleme

                                    compute takas3-comp-chi(1) rounded = 
                                                 takas3-comp-chi(1)  + rez-kucuk
                                    compute takas3-comp-free(1) rounded = 
                                                 takas3-comp-free(1)  + rez-free
                                    compute takas3-comp-bebek(1) rounded = 
                                                 takas3-comp-bebek(1)  + rez-bebek

                                    
                                 when other
                                     compute takas3-ucr-oda(1) rounded = 
                                                 takas3-ucr-oda(1)  + eklenecek-oda
                                    compute takas3-ucr-pax(1) rounded = 
                                                 takas3-ucr-pax(1)  + geceleme
                                    compute takas3-ucr-chi(1) rounded = 
                                                 takas3-ucr-chi(1)  + rez-kucuk
                                    compute takas3-ucr-free(1) rounded = 
                                                 takas3-ucr-free(1)  + rez-free
                                    compute takas3-ucr-bebek(1) rounded = 
                                                 takas3-ucr-bebek(1)  + rez-bebek

                            end-evaluate
                            compute takas3-oda(1) rounded = 
                                                 takas3-oda(1)  + eklenecek-oda
                            
                            compute takas3-pax(1) rounded = 
                                                 takas3-pax(1)  + geceleme
                            
                            compute takas3-chi(1) rounded = 
                                                 takas3-chi(1)  + rez-kucuk
                            compute takas3-fre(1) rounded = 
                                                 takas3-fre(1)  + rez-free 
                                                 
                            compute takas3-bebek(1) rounded = 
                                                 takas3-bebek(1)  + rez-bebek 

                                                 

                             if rez-vip  not = " " and rez-vip  not = "N"
                               add 1        to takas3-vip-oda(1)
                               add geceleme to takas3-vip-pax(1)
                             end-if
                          end-if
********************************AYLIK

                          if cast-ay = son-ay and cast-yil = son-yil then
                          if eklenecek-oda = 1 
                     evaluate rez-buyuk
                         when 1
                             add 1 to t-single(2)
                         when 2
                             add 1 to t-double(2)
                         when 3 when 4   when 5 when 6  when 7 when 8    when 9
                             add 1 to t-triple(2)

                     end-evaluate
                    end-if


                                 evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-oda(2) rounded = 
                                                 takas3-hous-oda(2)  + eklenecek-oda
                                    compute takas3-hous-pax(2) rounded = 
                                                 takas3-hous-pax(2)  + geceleme 

                                    compute takas3-hous-chi(2) rounded = 
                                                 takas3-hous-chi(2)  + rez-kucuk
                                    compute takas3-hous-free(2) rounded = 
                                                 takas3-hous-free(2)  + rez-free 
                                    compute takas3-hous-bebek(2) rounded = 
                                                 takas3-hous-bebek(2)  + rez-bebek 
                                    
                                 when "C"   when "D"
                                 when "O"
                                    compute takas3-comp-oda(2) rounded = 
                                                 takas3-comp-oda(2)  + eklenecek-oda
                                    compute takas3-comp-pax(2) rounded = 
                                                 takas3-comp-pax(2)  + geceleme
                                    
                                    compute takas3-comp-chi(2) rounded = 
                                                 takas3-comp-chi(2)  + rez-kucuk
                                    compute takas3-comp-free(2) rounded = 
                                                 takas3-comp-free(2)  + rez-free
                                    compute takas3-comp-bebek(2) rounded = 
                                                 takas3-comp-bebek(2)  + rez-bebek

                                 when other
                                     compute takas3-ucr-oda(2) rounded = 
                                                 takas3-ucr-oda(2)  + eklenecek-oda
                                    compute takas3-ucr-pax(2) rounded = 
                                                 takas3-ucr-pax(2)  + geceleme
                                    compute takas3-ucr-chi(2) rounded = 
                                                 takas3-ucr-chi(2)  + rez-kucuk
                                    compute takas3-ucr-free(2) rounded = 
                                                 takas3-ucr-free(2)  + rez-free
                                    compute takas3-ucr-bebek(2) rounded = 
                                                 takas3-ucr-bebek(2)  + rez-bebek

                            end-evaluate
                            compute takas3-oda(2) rounded = 
                                                 takas3-oda(2)  + eklenecek-oda
                            
                            compute takas3-pax(2) rounded = 
                                                 takas3-pax(2)  + geceleme
                            
                            compute takas3-chi(2) rounded = 
                                                 takas3-chi(2)  + rez-kucuk
                            compute takas3-fre(2) rounded = 
                                                 takas3-fre(2)  + rez-free 
                                                 
                            compute takas3-bebek(2) rounded = 
                                                 takas3-bebek(2)  + rez-bebek 
                                                 
                                                 

                            if rez-vip not = " " and rez-vip  not = "N"
                               add 1        to takas3-vip-oda(2)
                               add geceleme to takas3-vip-pax(2)
                             end-if

                          end-if
                          if  cast-yil = son-yil then
                                if eklenecek-oda = 1 
                     evaluate rez-buyuk
                         when 1
                             add 1 to t-single(3)
                         when 2
                             add 1 to t-double(3)
                         when 3 when 4   when 5 when 6  when 7 when 8    when 9
                             add 1 to t-triple(3)

                     end-evaluate
                    end-if
                                       evaluate ode-tipi
                                 when "F"
                                    compute takas3-hous-oda(3) rounded = 
                                                 takas3-hous-oda(3)  + eklenecek-oda
                                    compute takas3-hous-pax(3) rounded = 
                                                 takas3-hous-pax(3)  + geceleme
                                    

                                    compute takas3-hous-chi(3) rounded = 
                                                 takas3-hous-chi(3)  + rez-kucuk
                                    compute takas3-hous-free(3) rounded = 
                                                 takas3-hous-free(3)  + rez-free
                                    compute takas3-hous-bebek(3) rounded = 
                                                 takas3-hous-bebek(3)  + rez-bebek
                                 when "C"      when "D"
                                 when "O"
                                    compute takas3-comp-oda(3) rounded = 
                                                 takas3-comp-oda(3)  + eklenecek-oda
                                    compute takas3-comp-pax(3) rounded = 
                                                 takas3-comp-pax(3)  + geceleme
                                    
                                    compute takas3-comp-chi(3) rounded = 
                                                 takas3-comp-chi(3)  + rez-kucuk
                                    compute takas3-comp-free(3) rounded = 
                                                 takas3-comp-free(3)  + rez-free
                                    compute takas3-comp-bebek(3) rounded = 
                                                 takas3-comp-bebek(3)  + rez-bebek

                                 when other
                                     compute takas3-ucr-oda(3) rounded = 
                                                 takas3-ucr-oda(3)  + eklenecek-oda
                                    compute takas3-ucr-pax(3) rounded = 
                                                 takas3-ucr-pax(3)  + geceleme

                                    compute takas3-ucr-chi(3) rounded = 
                                                 takas3-ucr-chi(3)  + rez-kucuk
                                    compute takas3-ucr-free(3) rounded = 
                                                 takas3-ucr-free(3)  + rez-free
                                    compute takas3-ucr-bebek(3) rounded = 
                                                 takas3-ucr-bebek(3)  + rez-bebek

                            end-evaluate
                            compute takas3-oda(3) rounded = 
                                                 takas3-oda(3)  + eklenecek-oda
*                                  if takvim-anah = "20100425" then 
*                                  initialize trnot-rec
*                                     move rez-no to trnot-rec
*                                     move rez-buyuk to   trnot-rec(15:)
*                                     write trnot-rec end-write
*                                  end-if
 
                            compute takas3-pax(3) rounded = 
                                                 takas3-pax(3)  + geceleme
                            
                             compute takas3-chi(3) rounded = 
                                                 takas3-chi(3)  + rez-kucuk
                            compute takas3-fre(3) rounded = 
                                                 takas3-fre(3)  + rez-free  
                                                 
                            compute takas3-bebek(3) rounded = 
                                                 takas3-bebek(3)  + rez-bebek  
                                                 
                                                 

                            if rez-vip not = " " and rez-vip  not = "N"
                               add 1        to takas3-vip-oda(3)
                               add geceleme to takas3-vip-pax(3)
                             end-if
                          end-if

              .
   
*****************************************
 igece-bul.
     
    initialize cast-rec var-yok.
    move takvim-anah to cast-tarih.
    start cast key not < cast-tarih invalid continue
      not invalid
        perform with test after until var
          read cast next no lock end move "V" to var-yok
            not end
              if cast-tarih > takvim-anah
                move "V" to var-yok
               else
                initialize rez-rec
                move cast-rez-no to rez-no
                read rez no lock invalid continue
                  not invalid
                          if rez-durumu not = "I"
                             exit perform cycle,         
                          end-if

                            if filtre-var = 1 then 
                               perform filtre
                               if filtre-gecti not = 1 then 
                                     exit perform cycle 
                               end-if
                            end-if

                            
                             if ONKPARA-REFERANS-VAR = 1
                                       perform  sifir-coz
                                        if xkonum-ref(cast-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(cast-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         continue
                                 else
                                perform igece-bul2
                             end-if
                            else
                                 perform igece-bul2
                         end-if

                    
                end-read
              end-if
          end-read
        end-perform
    end-start.
 
*
 igece-bul2.
       if tumu > 1 then
             move "B" to kodlar02-tipi
             move rez-odeme-tipi to kodlar02-kodu
             read kodlar02 no lock invalid 
                 move spaces to kodlar02-adi
             end-read
            if ( ode-tipi = "D" or  ode-tipi = "F" or  ode-tipi = "O")   and tumu = 2 then
              exit paragraph
             end-if
             if ( ode-tipi not = "D" and ode-tipi not = "F" and ode-tipi not = "O") and tumu = 3 then
              exit paragraph
             end-if
       end-if          
     move 1 to eklenecek-oda
    if rezpara-trace = 1
      move cast-oda-no to rez-odano
      move cast-fiyat-konumu to rez-fiyat-konumu
      move cast-oda-konumu to rez-oda-konumu

       if rez-kisi not = cast-kisi
          move cast-kisi to rez-kisi
     
       end-if
            move cast-share to  rez-share
       if rez-share = 1 then 
             move 0 to eklenecek-oda 
            else

              move 1 to eklenecek-oda
          end-if
      else 
          move 1 to eklenecek-oda
    end-if

     if rez-odano not = spaces and 
       ( hayali-haric = 1 or dis-haric = 1 ) then 
              move rez-odano to odalar-anah
              read odalar no lock invalid continue
              not invalid
              if ( odalar-hayali = "H" and hayali-haric = 1 )  then
                       move 0 to eklenecek-oda
              end-if
               if ( dis-haric = 1 and odalar-dis = 1 )  then
                         exit paragraph
              end-if 
              end-read
    end-if  

     if cast-tarih = rez-cik-tar  
          then 
           add eklenecek-oda to for-coutoda(ilerisi) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               for-coutpax(ilerisi)
    end-if
    if cast-tarih >= rez-cik-tar
          exit paragraph
    end-if
      if cast-tarih = rez-gir-tar 
           then 
           add eklenecek-oda to for-cinoda(ilerisi) 
           add rez-buyuk rez-kucuk rez-free rez-bebek  to 
               for-cinpax(ilerisi)
    end-if
    
        add eklenecek-oda to for-oda(ilerisi)
        add rez-buyuk  to for-pax(ilerisi)
        add rez-kucuk  to for-chi(ilerisi)
        add rez-free   to for-fre(ilerisi)
        add rez-bebek  to for-beb(ilerisi)
       move cast-oda-no to odalar-anah
        read odalar no lock invalid
          continue
          not invalid
          if odalar-hayali = "H" then
            add eklenecek-oda  to for-birles(ilerisi)
          end-if
       end-read
            .
*
  sifir-coz.                       | firat hayali cash folio referans gelmiyordu.
       initialize tmp-o-kon tmp-f-kon
       if cast-oda-konumu = 0 and rez-oda-konumu = 0         
          move konuk-oda-konumu to tmp-o-kon
       end-if

       if cast-fiyat-konumu = 0 and rez-fiyat-konumu = 0
          move konuk-fiyat-konumu to tmp-f-kon
       end-if
                                  |||||||||||||||||||||||||||||||||-
       if rez-oda-konumu = 0 then move 1 to rez-oda-konumu end-if
       if konuk-oda-konumu = 0 then move  rez-oda-konumu to konuk-oda-konumu end-if
       if konuk-oda-konumu = 0 then move 1 to konuk-oda-konumu end-if

        if cast-oda-konumu = 0 then move  rez-oda-konumu to cast-oda-konumu end-if
       if cast-oda-konumu  = 0 then move 1 to cast-oda-konumu end-if

        if rez-fiyat-konumu = 0 then move 1 to rez-fiyat-konumu end-if
       if konuk-fiyat-konumu = 0 then move  rez-fiyat-konumu to konuk-fiyat-konumu end-if
       if konuk-fiyat-konumu = 0 then move 1 to konuk-fiyat-konumu end-if

       if cast-fiyat-konumu = 0 then move  rez-fiyat-konumu to cast-fiyat-konumu end-if
       if cast-fiyat-konumu  = 0 then move 1 to cast-fiyat-konumu end-if


       if tmp-o-kon > 0
          move tmp-o-kon to cast-oda-konumu
       end-if
       if tmp-f-kon > 0 
          move tmp-f-kon to cast-fiyat-konumu
       end-if
        .
*
 islenen-bul.
     if ONKPARA-REFERANS-VAR = 1 and oda-ref > 0
       perform  onkasar-oku
       else
       perform onkasa-oku
       end-if
      initialize rez-rec
      move "I" to rez-durumu
      move son-tarih to rez-isl-tar
      start rez key >= rez-isl invalid continue
        not invalid
          perform until fs-rez = "10"
               read rez next no lock end move "10" to fs-rez
                  not end
                    if rez-durumu  = "I" and rez-isl-tar  = son-tarih
                    if ONKPARA-REFERANS-VAR = 1
                                       perform  sifir-coz
                                        if xkonum-ref(rez-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(rez-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         exit perform cycle
                    end-if
                    end-if
               if tumu > 1 then
                     move "B" to kodlar02-tipi
                     move rez-odeme-tipi to kodlar02-kodu
                     read kodlar02 no lock invalid 
                         move spaces to kodlar02-adi
                     end-read
                    if ( ode-tipi = "D" or  ode-tipi = "F" or  ode-tipi = "O")   and tumu = 2 then
                      exit perform cycle 
                     end-if
                     if ( ode-tipi not = "D" and ode-tipi not = "F" and ode-tipi not = "O") and tumu = 3 then
                      exit perform cycle 
                     end-if
               end-if                                   
                      add 1 to bugun-islen-oda 
                      add rez-buyuk to bugun-islen-kisi
                    else
                       move "10" to fs-rez
                    end-if
                end-read
          end-perform
      end-start .
      initialize rez-rec
      move "S" to rez-durumu
      move son-tarih to rez-isl-tar
      start rez key >= rez-isl invalid continue
        not invalid
          perform until fs-rez = "10"
               read rez next no lock end move "10" to fs-rez
                  not end
                    if rez-durumu  = "S" and rez-isl-tar  = son-tarih
                    if ONKPARA-REFERANS-VAR = 1
                    perform  sifir-coz
                                        if xkonum-ref(rez-oda-konumu) not = oda-ref and oda-ref > 0  
                                        or   XKONUM-ref(rez-fiyat-konumu) not = fiyat-ref and fiyat-ref > 0
                                         exit perform cycle
                    end-if
                    end-if
                       if tumu > 1 then
                             move "B" to kodlar02-tipi
                             move rez-odeme-tipi to kodlar02-kodu
                             read kodlar02 no lock invalid 
                                 move spaces to kodlar02-adi
                             end-read
                            if ( ode-tipi = "D" or  ode-tipi = "F" or  ode-tipi = "O")   and tumu = 2 then
                              exit perform cycle 
                             end-if
                             if ( ode-tipi not = "D" and ode-tipi not = "F" and ode-tipi not = "O") and tumu = 3 then
                                exit perform cycle 
                             end-if
                       end-if  
                      add 1 to bugun-iptal-oda 
                      add rez-buyuk to bugun-iptal-kisi
                      else
                       move "10" to fs-rez
                    end-if
                end-read
          end-perform
      end-start .

 onkasar-oku.
     
     initialize onkasar-rec
     move son-tarih to onkasar-tarih
     if oda-ref > 0 then 
        move oda-ref to onkasar-ref 
        else
        perform onkasa-oku
        exit paragraph
     end-if
     start onkasar key >= onkasar-anah invalid continue
        not invalid
     perform until fs-onkasar = "10"
     read onkasar next no lock end move "10" to fs-onkasa
              not end
              if onkasar-tarih not = son-tarih or onkasar-ref not = oda-ref
                exit perform
              end-if
             
              evaluate onkasar-dep
              when "888" 
                move onkasar-tutar-tl to takas3-dunden
              when "999"
                continue

              when other

              move onkasar-dep to depkod2-kodu depkod-kodu
              read depkod2 no lock invalid
                  move "01" to depkod2-alt-kate
              end-read
              read depkod no lock 
                   invalid 
                   continue
              end-read
              if depkod-turu = 2 then
                 exit perform cycle
              end-if
              if depkod2-alt-kate <= "04"
                 if depkod-ba = "B"
                   add       onkasar-tutar-tl        to   takas3-gelir
                   subtract  ONKASAr-CORR-TUTAR-TL   from takas3-gelir
                   else
                   add       ONKASAr-CORR-TUTAR-TL       to   takas3-gelir
                   subtract  onkasar-tutar-tl            from takas3-gelir
                 end-if
                else
                 if depkod-ba = "A"
                   add       onkasar-tutar-tl        to   takas3-gider
                   subtract  ONKASAr-CORR-TUTAR-TL   from takas3-gider
                   else
                   add       ONKASAr-CORR-TUTAR-TL       to   takas3-gider
                   subtract  onkasar-tutar-tl            from takas3-gider
                end-if

              end-if
              end-evaluate
     end-read
     end-perform
     end-start
     compute takas3-yarin = takas3-dunden + takas3-gelir - takas3-gider
     move takas3-gelir  to g53
     move takas3-gider  to g54
     move takas3-dunden to g56
     move takas3-yarin  to g57

     .

 onkasa-oku.
     
     initialize onkasa-rec
     move son-tarih to onkasa-tarih
     start onkasa key >= onkasa-anah invalid continue
        not invalid
     perform until fs-onkasa = "10"
     read onkasa next no lock end move "10" to fs-onkasa
              not end
              if onkasa-tarih not = son-tarih
                exit perform
              end-if
             
              evaluate onkasa-dep
              when "888" 
                move onkasa-tutar-tl to takas3-dunden
              when "999"
                continue

              when other

              move onkasa-dep to depkod2-kodu depkod-kodu
              read depkod2 no lock invalid
                  move "01" to depkod2-alt-kate
              end-read
              read depkod no lock 
                   invalid 
                   continue
              end-read
              if depkod-turu = 2 then
                 exit perform cycle
              end-if
              if depkod2-alt-kate <= "04"
                 if depkod-ba = "B"
                   add       onkasa-tutar-tl        to   takas3-gelir
                   subtract  ONKASA-CORR-TUTAR-TL   from takas3-gelir
                   else
                   add       ONKASA-CORR-TUTAR-TL       to   takas3-gelir
                   subtract  onkasa-tutar-tl            from takas3-gelir
                 end-if
                else
                 if depkod-ba = "A"
                   add       onkasa-tutar-tl        to   takas3-gider
                   subtract  ONKASA-CORR-TUTAR-TL   from takas3-gider
                   else
                   add       ONKASA-CORR-TUTAR-TL       to   takas3-gider
                   subtract  onkasa-tutar-tl            from takas3-gider
                end-if

              end-if
              end-evaluate
     end-read
     end-perform
     end-start
     compute takas3-yarin = takas3-dunden + takas3-gelir - takas3-gider
     move takas3-gelir  to g53
     move takas3-gider  to g54
     move takas3-dunden to g56
     move takas3-yarin  to g57



     .
*
 dll-gonder.
    initialize winprint-selection
    call "Win$printer" using winprint-setup-old
         returning return-code
    end-call

    call "win$printer" using winprint-get-current-info-ex
                             winprint-selection
    end-call

     perform acu-report1-print-tofile
     set environment "dll_convention" to "1" 
    if is-remote       
*/ rapor dosyaya gonderildi
       call "@[DISPLAY]:asyadll.dll" on exception
                       display message box 

                               "asyadll.dll bulunamadi !"
                               icon mb_error_icon
                               title "Hata"
 
                       goback
       end-call
       move all low-values to win-temp
       call "@[DISPLAY]:ASYA_GetEnvVar" using by reference env-name
                                              by reference win-temp
                                              by value 255
            on exception
                       display message box 
                               "asyadll.dll bulunamadi !"
                               icon mb_error_icon
                               title "Hata"
 
                       goback
       end-call


       inspect win-temp replacing trailing spaces by low-values
       move all low-values to html-rapor
       string html-rapor
              "@[DISPLAY]:"     delimited by low-values
              win-temp          delimited by low-values
              "\"               delimited by low-values
              rapor-dosya-adres delimited by low-values
              into html-rapor
             
       call "c$copy" using rapor-dosya html-rapor
       perform acu-report1-print-para 
       move all low-values to prt-fullfilename
       string prt-fullfilename
              win-temp delimited by low-values
              "\"               delimited by low-values
              rapor-dosya-adres delimited by low-values
              into prt-fullfilename

       call "@[DISPLAY]:AcuBenchPrintDummy" 
              on exception 
                 call "@[display]:acubenchprint.dll" on exception
                       display message box 
                               "Print.dll bulunamadi !"
                               icon mb_error_icon
                               title "Hata"
                       goback
                 end-call 
       end-call   
       move winprint-name                to acu-printer-name
       call "@[DISPLAY]:AcuBenchPrintExecWBPrint" using by content prt-fullfilename,
                                                     omitted,
                                                     by content print-browser-para,
                                                     by content acu-paper-header, 
                                                     by content acu-paper-footer, 
                                                     by content acu-paper-size, 
                                                     by value acu-paper-orientationint,
                                                     by value acu-paper-copies,
                                                     by content acu-printer-name
       end-call
       delete file printf
       move 0 to acu-setupprint
    else
*/ LOCAL ISE
       perform acu-report1-print-para 
       move rapor-dosya         to prt-fullfilename
       inspect prt-fullfilename replacing trailing spaces by low-values
       inspect prt-fullfilename replacing all "/" by "\"
   
       set environment "dll_convention" to "1"
       call "AcuBenchPrintDummy" 
              on exception 
                 call "acubenchprint.dll" on exception
                       display message box 
                               "Print.dll bulunamadi !"
                               icon mb_error_icon
                               title "Hata"
                       goback
                 end-call 
       end-call
       move winprint-name                to acu-printer-name
       call "AcuBenchPrintExecWBPrint" USING by content prt-fullfilename,
                                                omitted,
                                                by content print-browser-para,
                                                by content acu-paper-header, 
                                                by content acu-paper-footer, 
                                                by content acu-paper-size, 
                                                by value acu-paper-orientationint,
                                                by value acu-paper-copies,
                                                by content acu-printer-name
      end-call
      move 0 to acu-setupprint
      delete file printf
    end-if.

*
 genel2-cinkdv-ayarla. 
      move 1.18 to ext-kdv
     if genel2-kdv-gecerlilik-tar not = spaces and genel2-kdv-gecerlilik-tar not = zeroes
*             if kdv-rap-tarih < genel2-kdv-gecerlilik-tar or kdv-rap-tarih >= 20210601 |firat 26/04/2021 dzeltme
*             if kdv-rap-tarih < genel2-kdv-gecerlilik-tar or kdv-rap-tarih >= 20210630
*             if kdv-rap-tarih < genel2-kdv-gecerlilik-tar or kdv-rap-tarih >= 20210601
            if genel2-kdv-bit-tar = spaces or genel2-kdv-bit-tar = zeroes then
                  move 20210731 to genel2-kdv-bit-tar
            end-if
            if kdv-rap-tarih < genel2-kdv-gecerlilik-tar or kdv-rap-tarih >= genel2-kdv-bit-tar 
                  move 8    to CINPARA-MUS-KDV
                  move 1.18 to ext-kdv                  
             else
                  move 1    to CINPARA-MUS-KDV
                  move 1.08 to ext-kdv                   
             end-if
      end-if
      if son-tarih >= 20220401
          move 1.08 to ext-kdv  
      end-if.
        if  kdv-rap-tarih >= 20230710
                   move 10 to CINPARA-MUS-KDV
                  move 1.10 to ext-kdv   
                end-if.

 
