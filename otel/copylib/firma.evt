* firma.evt
* firma.evt is generated from D:\asya\acugt.ytl\otel\firma.Psf
* This is a generated file. DO NOT modify this file directly.


 Acu-tab-1-Cmd-Tabchanged.
     EVALUATE Event-Type
     WHEN Cmd-Tabchanged
        MOVE Event-Data-1 TO tab-1-value
        MOVE 0 TO Form1-Pg-1-Visible, Form1-Pg-2-Visible,
            Form1-Pg-3-Visible
        EVALUATE Event-Data-1
        WHEN 1
           MOVE 1 TO Form1-Pg-1-Visible
        WHEN 2
           MOVE 1 TO Form1-Pg-2-Visible
        WHEN 3
           MOVE 1 TO Form1-Pg-3-Visible
        END-EVALUATE
*       Before-Tabchg-Display
        DISPLAY Form1
        PERFORM after-tab
     END-EVALUATE
     .

 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM exception-procedure
     .

 Form1-Ta-1-Event-Proc.
* 
     EVALUATE Event-Type
     WHEN Cmd-Tabchanged
        PERFORM Tab-1-Ex-Cmd-Tabchanged
     END-EVALUATE
     .

 Form1-Pb-3-Event-Proc.
     .

 accept-0206a-Exception-Proc.
     PERFORM HEPSI-TEK
     .
***   start event editor code   ***
*
 Form1-Bef-Create.
     perform adresleri-tasi.
        open input genel
    move 1 to genel-anahtar
    read genel no lock invalid continue
         not invalid continue
    end-read
    close genel.
     move muha-sirketi to hesap-dosya-adres.
     open input kllnc
      move k-kodu-tasi to K-KODU
     read kllnc no lock invalid continue
       end-read
       close kllnc
     perform  acuserve-adres-aktar.     

*
 bef-procedure.
     evaluate control-id
          when 5
              evaluate true
                   when turkce 
                         move "firma kodunu giriniz  F1-firma yardimi" to mesaj
                   when ingilizce
                        move "firma kodunu giriniz  F1-firma yardimi" to mesaj
                   when almanca
                        move "firma kodunu giriniz  F1-firma yardimi" to mesaj
              end-evaluate
          when 9
              evaluate true
                   when turkce 
                        move "firma Adini giriniz   " to mesaj
                   when ingilizce
                        move "firma Adini giriniz   " to mesaj
                   when almanca
                        move "firma Adini giriniz   " to mesaj
              end-evaluate
          when 11
              evaluate true
                   when turkce 
                        move "firma unvanini giriniz" to mesaj
                   when ingilizce
                        move "firma unvanini giriniz" to mesaj
                   when almanca
                        move "firma unvanini giriniz" to mesaj
              end-evaluate
          when 13
              evaluate true
                   when turkce 
                        move "firma sorumlusunu giriniz" to mesaj
                   when ingilizce
                        move "firma sorumlusunu giriniz" to mesaj
                   when almanca
                        move "firma sorumlusunu giriniz" to mesaj
              end-evaluate
          when 15
              evaluate true
                   when turkce 
                        move "firma muhasebe hesap kodunu giriniz    " to mesaj
                   when ingilizce
                        move "firma muhasebe hesap kodunu giriniz    " to mesaj
                   when almanca
                        move "firma muhasebe hesap kodunu giriniz    " to mesaj
              end-evaluate
          when 19
              evaluate true
                   when turkce 
                        move "Degisiklikleri kaydetmek icin tiklayiniz" to mesaj
                   when ingilizce
                        move "Degisiklikleri kaydetmek icin tiklayiniz" to mesaj
                   when almanca
                        move "Degisiklikleri kaydetmek icin tiklayiniz" to mesaj
              end-evaluate
          when 20
              evaluate true
                   when turkce 
                        move "firma kodunu silmek icin tiklayiniz" to mesaj
                   when ingilizce
                        move "firma kodunu silmek icin tiklayiniz" to mesaj
                   when almanca
                        move "firma kodunu silmek icin tiklayiniz" to mesaj
              end-evaluate
          when 21
              evaluate true
                   when turkce 
                        move "firma kodlari raporunu almak icin tiklayiniz" to mesaj
                   when ingilizce
                        move "firma kodlari raporunu almak icin tiklayiniz" to mesaj
                   when almanca
                        move "firma kodlari raporunu almak icin tiklayiniz" to mesaj
              end-evaluate
          when 24
              evaluate true
                   when turkce 
                        move "firma tipini seciniz" to mesaj
                   when ingilizce
                        move "firma tipini seciniz" to mesaj
                   when almanca
                        move "firma tipini seciniz" to mesaj
              end-evaluate
          when 22
              evaluate true
                   when turkce 
                        move "firma indirim oranini giriniz" to mesaj
                   when ingilizce
                        move "firma indirim oranini giriniz" to mesaj
                   when almanca
                        move "firma indirim oranini giriniz" to mesaj
              end-evaluate
          when 25
              evaluate true
                   when turkce 
                        move "Raporlarda pazar/ulke ayrimini gormek icin seciniz" to mesaj
                   when ingilizce
                        move "Raporlarda pazar/ulke ayrimini gormek icin seciniz" to mesaj
                   when almanca
                        move "Raporlarda pazar/ulke ayrimini gormek icin seciniz" to mesaj
              end-evaluate
          when 31
              evaluate true
                   when turkce 
                        move "firmanin musteri getirdigi ulke kodunu giriniz" to mesaj
                   when ingilizce
                        move "firmanin musteri getirdigi ulke kodunu giriniz" to mesaj
                   when almanca
                        move "firmanin musteri getirdigi ulke kodunu giriniz" to mesaj
              end-evaluate
          when 32
              evaluate true
                   when turkce 
                        move "Farkli kodlarda yer alan firmalari birbirine raporsal olarak baglayacak pazar kodu" to mesaj
                   when ingilizce
                        move "Farkli kodlarda yer alan firmalari birbirine raporsal olarak baglayacak pazar kodu" to mesaj
                   when almanca
                        move "Farkli kodlarda yer alan firmalari birbirine raporsal olarak baglayacak pazar kodu" to mesaj
              end-evaluate
          when 38
              evaluate true
                   when turkce 
                        move "firma adresini giriniz" to mesaj
                   when ingilizce
                        move "firma adresini giriniz" to mesaj
                   when almanca
                        move "firma adresini giriniz" to mesaj
              end-evaluate
          when 40
              evaluate true
                   when turkce 
                        move "firma vergi dairesini giriniz  " to mesaj
                   when ingilizce
                        move "firma vergi dairesini giriniz  " to mesaj
                   when almanca
                        move "firma vergi dairesini giriniz  " to mesaj
              end-evaluate
          when 42
              evaluate true
                   when turkce 
                        move "firma vergi numarasini giriniz" to mesaj
                   when ingilizce
                        move "firma vergi numarasini giriniz" to mesaj
                   when almanca
                        move "firma vergi numarasini giriniz" to mesaj
              end-evaluate
          when 44
              evaluate true
                   when turkce 
                        move "firma ilcesini giriniz ardimi" to mesaj
                   when ingilizce
                        move "firma ilcesini giriniz ardimi" to mesaj
                   when almanca
                        move "firma ilcesini giriniz ardimi" to mesaj
              end-evaluate
          when 46
              evaluate true
                   when turkce 
                        move "firma ilini giriniz " to mesaj
                   when ingilizce
                        move "firma ilini giriniz " to mesaj
                   when almanca
                        move "firma ilini giriniz " to mesaj
              end-evaluate
          when 48
              evaluate true
                   when turkce 
                        move "firma ulkesini giriniz" to mesaj
                   when ingilizce
                        move "firma ulkesini giriniz" to mesaj
                   when almanca
                        move "firma ulkesini giriniz" to mesaj
              end-evaluate
          when 50
              evaluate true
                   when turkce 
                        move "firma telefon numarasini giriniz" to mesaj
                   when ingilizce
                        move "firma telefon numarasini giriniz" to mesaj
                   when almanca
                        move "firma telefon numarasini giriniz" to mesaj
              end-evaluate
          when 52
              evaluate true
                   when turkce 
                        move "firma fax numarasini giriniz" to mesaj
                   when ingilizce
                        move "firma fax numarasini giriniz" to mesaj
                   when almanca
                        move "firma fax numarasini giriniz" to mesaj
              end-evaluate
          when 54
              evaluate true
                   when turkce 
                        move "firma e-mail adresini giriniz" to mesaj
                   when ingilizce
                        move "firma e-mail adresini giriniz" to mesaj
                   when almanca
                        move "firma e-mail adresini giriniz" to mesaj
              end-evaluate
     end-evaluate.
     modify form1-st-1-handle,
            panel-index = 2
            panel-text = mesaj.
     .
*
 accept-0101-Bef-Procedure.
     initialize okundu
     initialize firma-rec.
     move 0 to combo-0101-value.
     modify tab-1,value = 1
     perform tab-1-Ex-Cmd-Tabchanged.
     display accept-0102,accept-0103,accept-0104,accept-0105,  accept-0105A
             accept-0106,accept-0107 accept-m  accept-mb accept-ma acc-mis-no
     modify button-0101,enabled = false
     modify button-0102,enabled = false.
     perform ava-after 
     perform muh-after 
     perform muh2-after
      initialize   toplam-not
             
        
         display not-ac
     perform bef-procedure.
*
 accept-0101-Aft-Procedure.
    if firma-kodu = spaces 
        modify button-0101,enabled = false
        modify button-0102,enabled = false
        perform fis-al
        move firma-no     to firma-kodu
        display accept-0101
         modify button-0101,enabled = true
        modify button-0102,enabled = true

     else 
        if firma-kodu(5:1) = spaces then 
                   display message box "KOD 5 haneli olmalidir"
                  
            
         end-if
        modify button-0101,enabled = true
        modify button-0102,enabled = true
         
     end-if.
     move 1 to okundu
     open input firma.
    
     read firma no lock invalid
          initialize firma-rec
          inquire accept-0101 value in firma-kodu
     end-read
      move firma-profil-sirket to ps1
     move firma-profil-no     to mis-no
     move firma-tipi to combo-0101-value.
     close firma.
     perform rate-oku
     open input nt
     initialize not-rec 
     move "FIR" to not-dos
     move "Default" to not-dos-anah.
     move firma-kodu to not-dos-anah(8:)
     read nt no lock 
        invalid
           initialize acen-dft
           move  REZPARA-BANKA      to acen-dft-banka
           move  REZPARA-DOVIZ      to acen-dft-doviz
           move  REZPARA-PAN-TIPI   to acen-dft-pan-tipi
           move  REZPARA-ODEME-TIPI to acen-dft-odeme-tipi
           move  rezpara-anlasma    to acen-dft-anlasma
           move  REZPARA-ULKE       to acen-dft-ulke
           move  rezpara-pazar      to acen-dft-pazar
        not invalid 
          move not1 to acen-dft
     end-read
     close nt
     if acen-dft-specialyok-sabit not = 1 then 
       move 0 to acen-dft-specialyok-sabit
       end-if
     display form1-pg-1 form1-pg-2 form1-pg-3.
     perform pansiyon-oku perform doviz-oku perform banka-oku 
     perform ulke-oku     perform pazar-oku 
     perform anlasma-oku perform odeme-oku
     perform kaynak1-goster perform kaynak2-goster perform kaynak3-goster 
     perform not-goster
     perform ava-after 
     perform muh-after 
     perform muh2-after

    .
*
 tab-1-Ex-Cmd-Tabchanged.
     inquire tab-1, value in tab-1-value
     evaluate tab-1-value 
      when  1
        modify tab-1,value = 1
        move 0 to form1-pg-2-visible  form1-pg-3-visible
        move 1 to form1-pg-1-visible
        display form1-pg-2
                form1-pg-1  form1-pg-3
      when 2 
        modify tab-1,value = 2
        move 0 to form1-pg-1-visible  form1-pg-3-visible
        move 1 to form1-pg-2-visible
        display form1-pg-1
                form1-pg-2  form1-pg-3
     when 3 
        modify tab-1,value = 2
        move 0 to form1-pg-1-visible  form1-pg-2-visible
        move 1 to form1-pg-3-visible
        display form1-pg-1
                form1-pg-2 form1-pg-3
    end-evaluate     
     .
*
 Form1-Aft-Initdata.
     open i-o firma close firma
     modify combo-0101,
            reset-list = 1
            mass-update = 1
     
              modify combo-0101,item-to-add  ("0-Pesin Odemeli", "1-Visa Garantili", "2-Acik Hesap    ", "3-Konfirmede Odeme" )       
     modify combo-0101,
            value = "1"
            mass-update = 0.
*
 ava-after. 
         if muha-sirketi = spaces exit paragraph end-if
                open input hesap
              move    firma-avano  to hesap-kodu
              read hesap no lock invalid 
                modify l-ava color = 5
                move "Tanimsiz  Hesap" to hesap-adi
                not invalid 
                modify l-ava color = 2
             end-read
             move hesap-adi to label-avans
              display l-ava
              close hesap.
*
 muh-after. 
        if muha-sirketi = spaces exit paragraph end-if
              open input hesap
              move    firma-muhno  to hesap-kodu
              read hesap no lock invalid 
                modify l-muh color = 5
                move "Tanimsiz  Hesap" to hesap-adi
                not invalid 
                modify l-muh color = 2
             end-read
             move hesap-adi to label-muh
              display l-muh
              close hesap.
*
 muh2-after. 
               if muha-sirketi = spaces exit paragraph end-if
              open input hesap
              move    firma-muhno2  to hesap-kodu
              read hesap no lock invalid 
                modify l-muh2 color = 5
                move "Tanimsiz  Hesap" to hesap-adi
                not invalid 
                modify l-muh2 color = 2
             end-read
             move hesap-adi to label-muh2
              display l-muh2
              close hesap.
*
 f1ler.
       evaluate control-id
          when 72
             initialize acenta-cagir
             call "/asya/ytl/obj/otel/rateara.asy" using acenta-cagir
                 on exception perform callerr-proc
                 not on exception
                 cancel "/asya/ytl/obj/otel/rateara.asy" 
              end-call
              move acenta-cagir     to firma-rate OF firma
               display accept-mb
               move 4 to accept-control
               move 72 to control-id
          when 13
           initialize hesapara-link
           move MUHA-SIRKETI  to hesapara-isyeri
           move genel-muha-uzak-ip to hesapara-ip-no
           call "/asya/ytl/obj/otel/hesapara.asy" using hesapara-link
                  on exception 
                     perform callerr-proc
                  not on exception
                     if hesapara-hesap <> spaces 
                        move hesapara-hesap  to firma-avano 
                        display accept-0104
                     end-if
                  cancel "/asya/ytl/obj/otel/hesapara.asy"
             end-call
          when 15
           initialize hesapara-link
           move MUHA-SIRKETI  to hesapara-isyeri
           move genel-muha-uzak-ip to hesapara-ip-no
           call "/asya/ytl/obj/otel/hesapara.asy" using hesapara-link
                  on exception 
                     perform callerr-proc
                  not on exception
                     if hesapara-hesap <> spaces 
                        move hesapara-hesap  to firma-MUHNO 
                        display accept-0105
                     end-if
                  cancel "/asya/ytl/obj/otel/hesapara.asy"
             end-call
          when 73
           initialize hesapara-link
           move MUHA-SIRKETI  to hesapara-isyeri
           move genel-muha-uzak-ip to hesapara-ip-no
           call "/asya/ytl/obj/otel/hesapara.asy" using hesapara-link
                  on exception 
                     perform callerr-proc
                  not on exception
                     if hesapara-hesap <> spaces 
                        move hesapara-hesap  to firma-MUHNO2 
                        display accept-0105a
                     end-if
                  cancel "/asya/ytl/obj/otel/hesapara.asy"
             end-call
          when 5
             initialize firma-cagir
             call "/asya/ytl/obj/otel/firmara.asy" using firma-cagir
                 on exception perform callerr-proc
                 not on exception
                 cancel "/asya/ytl/obj/otel/firmara.asy" 
              end-call
              move firma-cagir     to firma-kodu
               display accept-0101
               move 4 to accept-control
               move 5 to control-id
           when 1016 perform banka-ara
           when 1017 perform doviz-ara
           when 1018 perform pansiyon-ara
           when 1019 perform odeme-ara
           when 1020 perform anlasma-ara
           when 1021 perform pazar-ara
           when 1022 perform ulke-ara
           when 180 perform kaynak-1-ara
           when 183 perform kaynak-2-ara
           when 186 perform kaynak-3-ara

         end-evaluate
         .
 exception-procedure.
     evaluate key-status
         when 1245
              perform konuk-kdv-dagit
         when 16
     
           move firma-adi         to aranacak-adi  
           move firma-UNVANI      to aranacak-soyadi
           move mis-no           to bulunan-profil-no
           move ps1              to bulunan-profil-sirket
           
           perform profil-cagir
         when 17 
             move firma-dosya         to link-logview-dosya-adi
             set link-logview-pointer  to address of firma-rec
             set link-logview-rec-size to size of firma-rec
             perform logview-call
             initialize key-status
         when  3151 
          if firma-rate not = spaces
            
             move firma-rate to  firma-gonder   
             
                   call "/asya/ytl/obj/otel/fiyatgir.asy" 
                         using firma-gonder
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/fiyatgir.asy"
                    end-call
                    
             end-if
           when  3152 
          if firma-rate not = spaces
             move firma-rate to  firma-gonder   
             
                   call "/asya/ytl/obj/otel/aksiyon.asy" 
                         using firma-gonder
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/aksiyon.asy"
                    end-call
                    
             end-if
           when  3153
          if firma-rate not = spaces
             move firma-rate to  firma-gonder   
             
                   call "/asya/ytl/obj/otel/aceanl.asy" 
                         using firma-gonder
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/aceanl.asy"
                    end-call
                    
             end-if
           when  3131 
             move firma-kodu to  link-NOT-DOS-ANAH   
             if link-not-dos-anah not = spaces then
                move "U"     to  link-not-islem
                move "firma"   to  link-NOT-DOS    
             move 98 to link-nereden 
             string firma-adi
                  " firmasina " delimited by size
                  into link-dosya-aciklamasi
                   call "/asya/ytl/obj/otel/mesajgir.asy" 
                         using link-not
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/mesajgir.asy"
                    end-call
                    move  link-not-donus  to  toplam-not
                    display not-ac
                    exit paragraph 
             end-if
         when 1 
             PERFORM f1ler
        when 6
          open i-o firma
          initialize firma-rec
            start firma key > firma-anahtar
              invalid continue
              not invalid
               perform until fs-firma ="10"
                   read firma next no lock 
                      end move "10" to fs-firma
                      not end
                        if firma-muhno2 = spaces then 
                          move firma-muhno to firma-muhno2
                          initialize firma-muhno
                          move "182-03 " to firma-muhno
                          rewrite firma-rec invalid stop " "
                        end-if
                     end-read
              end-perform 
            end-start

          close firma
         when 2
              if okundu <> 1
                    exit paragraph
              end-if
              if firma-kodu not = spaces
               if firma-kodu(5:1) = spaces then 
                   display message box "KOD 5 haneli olmalidir"
                   exit paragraph
                 end-if
*                 open input ulke
*                 move firma-ulke-kodu to ulke-anah
*                 read ulke no lock invalid
*                      inquire tab-1, value in tab-1-value
*                      if tab-1-value not = 1
*                         modify tab-1 , value = 1
*                         move 0 to form1-pg-2-visible
*                         move 1 to form1-pg-1-visible
*                         display form1-pg-2
*                                 form1-pg-1
*                      end-if
*                      move all "*" to ulke-adi
*                      move 4 to accept-control
*                      move 31 to control-id
*                      close ulke 
*                      exit paragraph
*                 end-read
*                 modify label-0107,title = ulke-adi
*                 close ulke
*                 open input kodlar02
*                 move "E" to kodlar02-tipi
*                 move firma-pazar to kodlar02-kodu
*                 read kodlar02 no lock invalid
*                      inquire tab-1, value in tab-1-value
*                      if tab-1-value not = 1
*                         modify tab-1 , value = 1
*                         move 0 to form1-pg-2-visible
*                         move 1 to form1-pg-1-visible
*                         display form1-pg-2
*                                 form1-pg-1
*                      end-if
*                      move all "*" to kodlar02-adi
*                      move 4 to accept-control
*                      move 32 to control-id
*                      close kodlar02
*                      modify label-0108, title = kodlar02-adi
*                      exit paragraph
*                 end-read
*                 modify label-0108, title = kodlar02-adi
*                 close kodlar02
                 open i-o firma nt
                 inquire combo-0101,value in firma-tipi
                  initialize not-rec 
                  move "FIR"       to not-dos
                  move "Default"   to not-dos-anah
                  move firma-kodu to not-dos-anah(8:)
                  move acen-dft to not1
                 write not-rec invalid 
                       rewrite not-rec invalid continue
                       end-rewrite 
                 end-write
                 move ps1    to firma-profil-sirket 
                 move mis-no to firma-profil-no     
                 move k-kodu-tasi to firma-staf
                 
                 write firma-rec invalid 
                       rewrite firma-rec invalid continue
                       end-rewrite 
                 end-write
                 perform log-operation-firma
                 close firma nt
              end-if
              move 4 to accept-control
              move 5 to control-id
         when 3
                 initialize mesaj-degiskenler
                 move " [ Sil Soru ] " to mmesaj-title
                 move " Bu Kayit Silinecektir ............  " to mmesaj-1
                 move " Emin Misiniz.....E->Evet, H->Hayir  " to mmesaj-2 
                 move 2           to mmesaj-type
                 move 1           to mmesaj-icon
                 move 2           to mmesaj-default
                 perform mmesaj-ver
                 if donus-kodu = 2 
                    move 4 to accept-control
                    move 5 to control-id
                    exit paragraph
                 end-if
              perform sil-kontrol thru sil-kontrol-ex
              if evet-hayir = "H" 
                 initialize mesaj-degiskenler
                 move " [ UYARI ] " to mmesaj-title
                 move " Bu firma Hareket Gormus .........  " to mmesaj-1
                 move " SILEMEZSINIZ......................  " to mmesaj-2 
                 move 1           to mmesaj-type
                 move 1           to mmesaj-icon
                 move 1           to mmesaj-default
                 perform mmesaj-ver
                    move 4 to accept-control
                    move 5 to control-id
                    exit paragraph
              end-if 

              if firma-kodu not = spaces 
                 open i-o firma
                 delete firma invalid continue 
                 end-delete
                 perform log-operation-firma
                 close firma
              end-if
              move 4 to accept-control
              move 5 to control-id
         when 4
              open input firma cari musteri
              initialize firma-rec
              start firma key not < firma-kodu invalid
                    initialize mesaj-link
                    move 04 to mesaj-no
                    perform mesaj-ver
                    close firma cari musteri
                    exit paragraph
              end-start

              open i-o genelfis
              move 1 to genelfis-anahtar
              read genelfis no lock invalid
                   accept print-no from time
              not invalid
                   add 1 to print-no
                   rewrite genelfis-rec end-rewrite
              end-read
              close genelfis

**************************
     initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya

     set  dokumer-asya-set to true
     move print-no         to dokumer-dosya-adi
     open output dokumer
*/WINDOW TITLE
     initialize dokumer-rec detay
     move "W"                  to det-dokumer-20(1:)
     move "Firma Kodlari Raporu" to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR
     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:1)
     move "1"          to det-dokumer-20(10:1)
     move "Firma Kodlari Raporu" to det-filler
     write dokumer-rec from detay
     initialize dokumer-rec detay


     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:1)
     write dokumer-rec from detay

*/ DOKUMER OZELLIKLER-REC
     initialize dokumer-rec detay
     move "O" to det-dokumer-20(1:)
     move "E" to dokumer-oto-sayfa-basi
     move 56  to dokumer-oto-sayfa-satir
     move "|" to dokumer-detay-kolon-ayirici
     move "LLLLLLLLLLLLLLLLLL" to dokumer-align-occ
     move dokumer-ozellikler-rec     to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR  
     initialize dokumer-rec detay
     move "D1"             to det-dokumer-20(1:2)     
     move "1"          to det-dokumer-20(10:1)
     move "Kodu"           to det-1
     move "Muh Hs. No"     to det-18
     move "Adi"            to det-2
     move "Unvani"         to det-3
     move "Adresi"         to det-4
     move "Ilce"           to det-5
     move "Il"             to det-6
     move "Ulke"           to det-7
     move "Telefon"        to det-8
     move "Fax"            to det-9
     move "E-mail"         to det-10
     move "Kredi Dur"      to det-kr
     move "Pazar"          to det-11
     move "Ulke "          to det-12
     move "Vergi dairesi"  to det-13
     move "Vergi numarasi" to det-14
     move "Sorumlu"        to det-15 
     move "Tipi"           to det-16
     move "Per"            to det-16-1
     move "Ind"            to det-17
     move "Rate"           to det-19
     move "C/L"            to det-20
     move "|" to fil-1 fil-18 fil-2 fil-3 fil-4 fil-5 fil-6
              fil-7 fil-8 fil-9 fil-10 fil-11 fil-12 fil-13 fil-14
              fil-15 fil-16 fil-16-1 fil-17 fil-20 fil-kr fil-19
     write dokumer-rec from detay

     initialize dokumer-rec detay
     move "D2"           to det-dokumer-20(1:2)
     move "-"            to det-dokumer-20(5:1)
     move all "-"  to det-1 det-18 det-2 det-3 det-4 det-5 det-6 det-7 det-8
                      det-9 det-10 det-11 det-12 det-13 det-14 det-15
                      det-16 det-16-1 det-17 fil-kr det-19 det-20
                      write dokumer-rec from detay
               open input acenta 
              initialize fs-firma
              perform with test after until fs-firma = "10"
                    read firma next no lock end move "10" to fs-firma
                    not at end
                         initialize dokumer-rec detay
                         move firma-kodu        to det-1
                         move firma-muhno       to det-18
                         move firma-adi         to det-2
                         initialize musteri-rec
                         move firma-profil-no   to musteri-no
                         move firma-profil-sirket to musteri-sirket
                         read musteri no lock invalid 
                              continue 
                         not invalid 
                              move musteri-unvan1   to det-3
                              move musteri-adres1   to det-4
                              move musteri-ilce     to det-5
                              move musteri-il       to det-6
                              move musteri-tel1     to det-8
                              move musteri-fax      to det-9
                              move musteri-e-mail   to det-10
                              move musteri-vdairesi to det-13
                              move musteri-vno      to det-14                              
                         end-read 
                              initialize cari-rec
                              move firma-MUHNO          to cari-kodu
                              read cari no lock invalid 
                                  continue 
                              not invalid 
                                  if musteri-unvan1 = spaces
                                     move C-UNVAN-1       to det-3
                                  end-if 
                                  if musteri-adres1 = spaces
                                     move C-ADRES-1       to det-4
                                  end-if 
                                  if musteri-vdairesi = spaces 
                                     move C-IL-ILCE(1:10) to det-5
                                     move C-IL-ILCE(11:)  to det-6
                                     move C-TELEFON       to det-8
                                     move C-FAX           to det-9
                                  
                                     move C-VERGI-DAIRE   to det-13
                                   
                                
                                     move C-VERGI-NO      to det-14
                                     move C-EMAIL         to det-10
                                   end-if
                              end-read 
*                         move firma-unvani      to det-3
*                         move firma-adresim     to det-4
*                         move firma-ilce        to det-5
*                         move firma-il          to det-6
*                         move firma-ulke        to det-7
*                         move firma-telefon     to det-8
*                         move firma-fax         to det-9
*                         move firma-e-mail      to det-10
                         if firma-kredili = 1 then 
                            move "KREDILI  " to det-kr
                         else
                            initialize det-kr
                         end-if
*                         move firma-v-daire     to det-13
*                         move firma-v-no        to det-14
                         move firma-avano       to det-15
                         evaluate firma-tipi
                              when 0 move "Pesin Odemeli" to det-16
                              when 1 move "Visa Garantili"     to det-16
                              when 2 move "Acik Hesap    " to det-16
                              when 3 move "Konfirmede Odeme"         to det-16
                              when other 
                                     move all "*" to det-16
                         end-evaluate
                         move firma-performans  to det-16-1
                         move firma-indirim     to det-17
                          if firma-kredili = 1 then 
                           move "C/L" to det-20
                           else
                           move spaces to det-20
                         end-if
                         if firma-rate not = spaces
                            initialize acenta-rec
                            move firma-rate   to acenta-kodu
                            read acenta no lock invalid 
                                initialize acenta-adi
                            end-read 
                                move acenta-kodu    to det-19(1:4)
                                move "-"            to det-19(5:1)
                                move acenta-adi     to det-19(6:)
                         end-if 
                         write dokumer-rec from detay
                    end-read
              end-perform

              close dokumer
              call dokumer-prog on exception
                   perform callerr-proc
              not on exception
                   cancel dokumer-prog
              end-call
              close firma acenta cari musteri
              delete file dokumer

     end-evaluate
     .
*
 accept-0107-Aft-Procedure.
     open input ulke.
     move firma-ulke-kodu to ulke-anah.
     read ulke no lock invalid
          move all "*" to ulke-adi
          move 4 to accept-control
          move 31 to control-id
          inquire tab-1,value in tab-1-value
          if tab-1-value not = 1
             modify tab-1, value = 1
             move 1 to form1-pg-1-visible
             move 0 to form1-pg-2-visible
             display form1-pg-2
                     form1-pg-1
          end-if
     end-read
*     modify label-0107,title = ulke-adi
     close ulke.
     .
*
* accept-0108-Aft-Procedure.
*     open input kodlar02.
*     move "E" to kodlar02-tipi
*     move firma-pazar to kodlar02-kodu
*     read kodlar02 no lock invalid
*          move all "*" to kodlar02-adi
*          move 4 to accept-control
*          move 32 to control-id
*          inquire tab-1,value in tab-1-value
*          if tab-1-value not = 1
*             modify tab-1, value = 1
*             move 1 to form1-pg-1-visible
*             move 0 to form1-pg-2-visible
*             display form1-pg-2
*                     form1-pg-1
*          end-if
*     end-read
*     modify label-0108, title = kodlar02-adi
*     close kodlar02.
*     modify tab-1,value = 2.
*     perform tab-1-Ex-Cmd-Tabchanged.
     .

*
 banka-ara.
      initialize banka-cagir.
      call "/asya/ytl/obj/otel/bankaara.asy" using banka-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/bankaara.asy" 
       end-call.
       move banka-cagir     to acen-dft-banka
       perform banka-oku.
 banka-oku.
       open input banka.
       initialize banka-rec adi-goster.
       move acen-dft-banka    to banka-kodu
       read banka        no lock invalid 
       move rezpara-banka to acen-dft-banka  banka-kodu
       read banka        no lock invalid 
            move spaces to banka-adi acen-dft-banka
            not invalid continue 
       end-read end-read.
       close banka.
       move banka-adi     to adi-goster.
       modify lb-banka-e, title = adi-goster.
       display accept-banka.
*
 doviz-ara.
      initialize doviz-cagir.
      call "/asya/ytl/obj/otel/dovizara.asy" using doviz-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/dovizara.asy" 
       end-call.
       move doviz-cagir     to acen-dft-doviz.
       perform doviz-oku.
 doviz-oku.
       open input doviz.
       initialize doviz-rec adi-goster.
       move acen-dft-doviz    to doviz-kodu
       read doviz         no lock invalid 
       move rezpara-doviz to acen-dft-doviz   doviz-kodu
       read doviz         no lock invalid 
            initialize  doviz-rec
            not invalid continue 
       end-read end-read.
       close doviz.
       move d-adi-1       to adi-goster.
       modify lb-doviz-e, title = adi-goster.
   
       display accept-doviz.
*
 pansiyon-ara.
      initialize pansiyon-cagir.
      move "A" to pansiyon-tipi-cagir.
      call "/asya/ytl/obj/otel/panara.asy" using pansiyon-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/panara.asy" 
       end-call.
       move pansiyon-kodu-cagir     to acen-dft-pan-tipi.
       perform pansiyon-oku.
 pansiyon-oku.
       open input kodlar02.
       initialize kodlar02-rec adi-goster.
       move "A"              to kodlar02-tipi.
       move acen-dft-pan-tipi    to kodlar02-kodu
       read kodlar02         no lock invalid 
       move rezpara-pan-tipi to acen-dft-pan-tipi   kodlar02-kodu
       
       read kodlar02         no lock invalid 
            initialize kodlar02-rec
            not invalid continue 
       end-read    end-read
       close kodlar02.
       move kodlar02-adi       to adi-goster.
       modify lb-pansiyon-e, title = adi-goster.
      
       display accept-pansiyon.
*
 odeme-ara.
      initialize odeme-cagir.
      move "B"   to odeme-tipi-cagir.
      call "/asya/ytl/obj/otel/odemeara.asy" using odeme-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/odemeara.asy" 
       end-call.
       move odeme-kodu-cagir     to acen-dft-odeme-tipi.
       perform odeme-oku.
 odeme-oku.
       open input kodlar02.
       initialize kodlar02-rec adi-goster.
       move "B"                to kodlar02-tipi.
       move acen-dft-odeme-tipi    to kodlar02-kodu
       read kodlar02         no lock invalid 
       move rezpara-odeme-tipi to acen-dft-odeme-tipi  kodlar02-kodu
       read kodlar02         no lock invalid 
            initialize kodlar02-rec
            not invalid continue 
       end-read end-read.
       close kodlar02.
       move kodlar02-adi       to adi-goster.
       modify lb-odeme-e, title = adi-goster.

       display accept-odeme.
*
 anlasma-ara.
      initialize infox-cagir .
      move "D"   to infox-tipi-cagir.
      call "/asya/ytl/obj/otel/infoxara.asy" using infox-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/infoxara.asy" 
       end-call.
       move infox-kodu-cagir     to acen-dft-anlasma.
       perform anlasma-oku.
 anlasma-oku.
       open input kodlar02.
       initialize kodlar02-rec adi-goster.
       move "D"                to kodlar02-tipi.
       move acen-dft-anlasma       to kodlar02-kodu
       read kodlar02         no lock invalid 
       move rezpara-anlasma  to acen-dft-anlasma kodlar02-kodu
       read kodlar02         no lock invalid 
            initialize kodlar02-rec
            not invalid continue 
       end-read  end-read.
       close kodlar02.
       move kodlar02-adi       to adi-goster.
       modify lb-anlasma-e, title = adi-goster.
     
       display accept-anlasma.
*
 pazar-ara.
      initialize pazar-cagir.
      move "E"   to pazar-tipi-cagir.
      call "/asya/ytl/obj/otel/pazarara.asy" using pazar-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/pazarara.asy" 
       end-call.
       move pazar-kodu-cagir     to acen-dft-pazar.
       perform pazar-oku  .
 pazar-oku.
       open input kodlar02 .
       initialize kodlar02-rec adi-goster.
       move "E"                to kodlar02-tipi.
       move acen-dft-pazar         to kodlar02-kodu
       read kodlar02         no lock invalid 
            move rezpara-pazar to acen-dft-pazar   kodlar02-kodu
       read kodlar02         no lock invalid 
            initialize kodlar02-rec
            not invalid continue 
       end-read end-read  .
       close kodlar02.
       move kodlar02-adi       to adi-goster.
       modify lb-pazar-e, title = adi-goster.

       display accept-pazar.
*
 ulke-ara.
      initialize ulke-cagir.
      call "/asya/ytl/obj/otel/ulkeara.asy" using ulke-cagir
            on exception perform callerr-proc
               not on exception
               cancel "/asya/ytl/obj/otel/ulkeara.asy" 
       end-call.
       move ulke-cagir     to acen-dft-ulke
       
       display accept-ulke.
       perform ulke-oku.
 ulke-oku.
       open input ulke.
       initialize ulke-rec adi-goster.
       move acen-dft-ulke    to ulke-anah1

       read ulke         no lock invalid
       move rezpara-ulke to acen-dft-ulke ulke-anah1
       read ulke         no lock invalid 
            initialize ulke-rec
            not invalid continue 
       end-read end-read
       close ulke.
       move ulke-adi     to adi-goster.
       modify lb-ulke-e, title = adi-goster.
       
       display accept-ulke.
 
*
*
*
 after-tab.
     
     .
 not-goster.
         initialize toplam-not
          move firma-kodu to  link-NOT-DOS-ANAH   
       if link-not-dos-anah not = spaces  then
           move "K"     to  link-not-islem
           move "firma"   to  link-NOT-DOS    
           move 98 to link-nereden 
                   call "/asya/ytl/obj/otel/mesajgir.asy" 
                         using link-not
                          on exception 
                          perform callerr-proc
                          exit paragraph
                        not on exception 
                          cancel "/asya/ytl/obj/otel/mesajgir.asy"
                    end-call
                    move  link-not-donus  to  toplam-not
         end-if
         display not-ac
         .
*
sil-kontrol.
    move spaces to evet-hayir.
    open input rez.
    initialize rez-rec.
    

    start rez key not < rez-acen invalid continue
        not invalid,
        perform with test after until evet,
            read rez next no lock end move "E" to evet-hayir,
                not end,
              if rez-firma  = firma-kodu
                 move "H" to evet-hayir,
                 exit perform
              end-if
                
                 
            end-read 
        end-perform 
    end-start
    .
   

         close rez.

sil-kontrol-ex.
    exit.

*
 mmesaj-ver.
      inspect mmesaj-1 replacing trailing spaces by low-values
      inspect mmesaj-2 replacing trailing spaces by low-values
      inspect mmesaj-3 replacing trailing spaces by low-values
      display message box mmesaj-1, new-line, mmesaj-2, new-line, mmesaj-3
              title   = mmesaj-title
              type    = mmesaj-type
              icon    = mmesaj-icon
              default = mmesaj-default
              returning donus-kodu.

*
 acuserve-adres-aktar.

    move muha-sirketi of genel-rec to CARI-DOSYA-adres         
                         ISLENEN-DOSYA-adres      
                         HESAP-DOSYA-adres        
                         MAHSUP-DOSYA-adres       
                         
                         REFERANS-DOSYA-adres     
                         mgenel-DOSYA-adres       
                                                           
    move all low-values to      
                           CARI-ACUSERVE-DOSYA       
                           ISLENEN-ACUSERVE-DOSYA    
                           HESAP-ACUSERVE-DOSYA      
                           MAHSUP-ACUSERVE-DOSYA     
                           genelfis-ACUSERVE-DOSYA   
                           REFERANS-ACUSERVE-DOSYA   
                           Mgenel-ACUSERVE-DOSYA     
                           genelfis-ACUSERVE-DOSYA  
                           ip-no.


    inspect genel-muha-uzak-ip 
            replacing trailing spaces by low-values.

    if genel-muha-uzak-ip <> low-values
       move all low-values to ip-no
       string ip-no,
              "@" delimited by low-values
              genel-muha-uzak-ip delimited by low-values
              ":" delimited by low-values
              into ip-no
    end-if

    string mgenel-acuserve-dosya,
           ip-no                        delimited by low-values
           mgenel-dosya                    delimited by low-values
           into mgenel-acuserve-dosya.
  
    
    string hesap-acuserve-dosya,
           ip-no                        delimited by low-values
           hesap-dosya                 delimited by low-values
           into hesap-acuserve-dosya.
    string mahsup-acuserve-dosya,
           ip-no                        delimited by low-values
           mahsup-dosya                 delimited by low-values
           into mahsup-acuserve-dosya.
    string cari-acuserve-dosya,
           ip-no                        delimited by low-values
           cari-dosya                 delimited by low-values
           into cari-acuserve-dosya.
    string islenen-acuserve-dosya,
           ip-no                        delimited by low-values
           islenen-dosya               delimited by low-values
           into islenen-acuserve-dosya.
    string referans-acuserve-dosya,
           ip-no                        delimited by low-values
           referans-dosya                delimited by low-values
           into referans-acuserve-dosya.
    

    inspect CARI-ACUSERVE-DOSYA        replacing  all spaces by low-values
    inspect ISLENEN-ACUSERVE-DOSYA     replacing  all spaces by low-values
    inspect HESAP-ACUSERVE-DOSYA       replacing  all spaces by low-values
    inspect MAHSUP-ACUSERVE-DOSYA      replacing  all spaces by low-values
    inspect REFERANS-ACUSERVE-DOSYA    replacing  all spaces by low-values
    inspect mgenel-ACUSERVE-DOSYA      replacing  all spaces by low-values
    . 
*
 HEPSI-TEK.
       if key-status = 8 then 
        DISPLAY MESSAGE BOX "TUM firmaLARDA VOUCHER ADEDINI FIKSLENECEK" NEW-LINE
        "DEVAM ETMEK ISTEDIGINIZE EMIN MISINIZ?"
              TITLE "DIKKAT GERI ALMANIZ MUMKUN OLMAYAN ISLEM"
              ICON 2 TYPE 2 DEFAULT 2 GIVING SONUC
           IF SONUC = 1 THEN
             open i-o firma
            MOVE  firma-faturada-voucher  TO YEDEK-VOUCHER
            MOVE SPACES TO firma-KODU
             START firma KEY > firma-KODU 
               invalid continue
               not invalid
               perform until fs-firma = "10"
                read firma next no lock
                  end move "10" to fs-firma
                  not end
                    MOVE  YEDEK-VOUCHER to firma-faturada-voucher  
                    rewrite firma-rec invalid stop " " end-rewrite
                 end-read
               end-perform
             end-start
             close firma
          END-IF
          end-if
          .
*
 fis-al.
     open i-o genelfis
     initialize genelfis-rec 
     move 2 to genelfis-anahtar
     read genelfis no lock invalid
          initialize genelfis-rec
          move 2 to genelfis-anahtar
          write genelfis-rec end-write
     end-read
          add 1 to firma-no
          rewrite genelfis-rec end-rewrite                 
     close genelfis.

*
 acc-mis-no-Bef-Procedure.
        initialize mis-cagir
        move mis-no to mis-no-cagir2
        move ps1 to mis-sirket-cagir
        move 2    to mis-kim-cagir
       call "/asya/ytl/obj/otel/musteri.asy" using mis-cagir
            on exception perform callerr-proc
        not on exception
       cancel "/asya/ytl/obj/otel/musteri.asy" 
       end-call.
       move  13 to control-id
        move 4 to accept-control.
*
 profil-cagir.
       initialize aranan-rez-no
       move isyeri-adres-tasi         to bulunan-rez-sirketi
       
       call "/asya/ytl/obj/otel/profbuld.asy" using profbul-cagir
            on exception perform callerr-proc
        not on exception
       cancel "/asya/ytl/obj/otel/profbuld.asy" 
       end-call
    
       if secildi = 1 or 
          secildi = 2 OR 
          secildi = 3
           move bulunan-profil-no       to mis-no 
           move bulunan-profil-sirket   to ps1    
           
          
            display acc-mis-no acc-ps1 
           
          
       end-if.
*
 accept-mb-Aft-Procedure. 
        perform rate-oku.
*
 rate-oku.
       open input acenta
       initialize acenta-rec
       move firma-rate OF firma  to acenta-kodu
       read acenta no lock invalid
            move "Tanimsiz Rate Kodu..."      to label-rate-adi
       not invalid 
            move acenta-adi                   to label-rate-adi
       end-read
       close acenta
       display l-rate
     
     .
*
 konuk-kdv-dagit.
     open i-o konuk REZ
     initialize konuk-rec
     start konuk key not < konuk-oda invalid 
         continue 
     not invalid
     perform with test after until fs-konuk = "10"
     read konuk next no lock end move "10" to fs-konuk
     not at end
            if konuk-firma <> firma-KODU OF firma 
                exit perform cycle 
            end-if 
            if konuk-fol-kodu not = "R"
              if firma-room-kdv-yok = 1
                 move firma-room-kdv-yok  to konuk-room-kdv-yok
              end-if 
              if firma-extra-kdv-yok = 1
                 move firma-extra-kdv-yok  to konuk-extra-kdv-yok               
              end-if 
              rewrite konuk-rec end-rewrite
            else
              if firma-room-kdv-yok = 1
                 move firma-room-kdv-yok  to konuk-room-kdv-yok
              end-if 
              if firma-extra-kdv-yok = 1
                 move firma-extra-kdv-yok  to konuk-extra-kdv-yok               
              end-if
              rewrite konuk-rec end-rewrite

              initialize rez-rec
              move konuk-rez-no to rez-no
              read rez no lock invalid 
                   continue 
              not invalid 
                 if firma-room-kdv-yok = 1
                    move firma-room-kdv-yok  to rez-room-kdv-yok
                 end-if 
                 if firma-extra-kdv-yok = 1
                    move firma-extra-kdv-yok to rez-extra-kdv-yok               
                 end-if

                 accept rez-edit-tarih from century-date  |firat amonra iin konuldu 03/11/2020
                 accept rez-edit-zaman from time          |                           

                 rewrite rez-rec end-rewrite   
              end-read               
            end-if 
     end-read
     end-perform
     end-start
     close konuk rez
     display message box "Islem Tamamlandi.." 
     .
*
 kaynak1-goster.
    open input onbkodlar10
    initialize onbkodlar10-rec
    move "AB" to onbkodlar10-tipi
    move acen-dft-kaynak-1 to onbkodlar10-kodu1
    read onbkodlar10 no lock
      invalid
        initialize onbkodlar10-rec
    end-read
    move onbkodlar10-adi to kaynak1-tipi-goster
    display accept-kaynak1 lb-kaynak1
    close onbkodlar10.

 kaynak2-goster.
    open input onbkodlar10
    initialize onbkodlar10-rec
    move "AC" to onbkodlar10-tipi
    move acen-dft-kaynak-2 to onbkodlar10-kodu1
    read onbkodlar10 no lock
      invalid
        initialize onbkodlar10-rec
    end-read
    move onbkodlar10-adi to kaynak2-tipi-goster
    display accept-kaynak2 lb-kaynak2
    close onbkodlar10.

 kaynak3-goster.
    open input onbkodlar10
    initialize onbkodlar10-rec
    move "AD" to onbkodlar10-tipi
    move acen-dft-kaynak-3 to onbkodlar10-kodu1
    read onbkodlar10 no lock
      invalid
        initialize onbkodlar10-rec
    end-read
    move onbkodlar10-adi to kaynak3-tipi-goster
    display accept-kaynak3 lb-kaynak3
    close onbkodlar10.

*
 kaynak-1-ara.
    initialize kaynak-cagir.
    move "AB"   to kaynak-tipi-cagir.
    call "/asya/ytl/obj/otel/kynk1ara.asy"
      using kaynak-cagir
      on exception
         perform callerr-proc
      not on exception
         cancel "/asya/ytl/obj/otel/kynk1ara.asy" 
    end-call
    move kaynak-kodu-cagir     to acen-dft-kaynak-1
    perform kaynak1-goster
    .

 kaynak-2-ara.
    initialize kaynak-cagir.
    move "AC"   to kaynak-tipi-cagir.
    call "/asya/ytl/obj/otel/kynk2ara.asy"
      using kaynak-cagir
      on exception
         perform callerr-proc
      not on exception
         cancel "/asya/ytl/obj/otel/kynk2ara.asy" 
    end-call
    move kaynak-kodu-cagir     to acen-dft-kaynak-2
    perform kaynak2-goster
    .
 kaynak-3-ara.
    initialize kaynak-cagir.
    move "AD"   to kaynak-tipi-cagir.
    call "/asya/ytl/obj/otel/kynk3ara.asy"
      using kaynak-cagir
      on exception
         perform callerr-proc
      not on exception
         cancel "/asya/ytl/obj/otel/kynk3ara.asy" 
    end-call
    move kaynak-kodu-cagir     to acen-dft-kaynak-3
    perform kaynak3-goster
    .

 
