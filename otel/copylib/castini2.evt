* castini2.evt
* castini2.evt is generated from D:\asya\acugt.ytl\otel\castini2.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Exception-Proc.
     PERFORM exception-procedure
     .
***   start event editor code   ***
*
 Form1-Bef-Create.
      call "c$narg" using link-var.
       perform adresleri-tasi.
       
     .
*
 before-procedure.
     initialize mesaj.
     evaluate control-id
          when 11
              evaluate true
                  when turkce
                       move "Islemi Baslat  "   to mesaj
                  when ingilizce 
                       move "Islemi Baslat  "   to mesaj
                  when almanca
                       move "Islemi Baslat  "   to mesaj
              end-evaluate
     end-evaluate.

     modify form1-st-1-handle,
            panel-index = 1 
            panel-text = mesaj.

 Form1-Aft-Initdata.
    open input genel
    move 1 to genel-anahtar
    read genel no lock invalid
          initialize mesaj-link
          move 03 to mesaj-no
          perform mesaj-ver
    not invalid
        continue
    end-read
    close genel
    open input konum
     initialize konum-rec
     start konum key not < konum-anahtar invalid
           continue
     not invalid
     perform  with test after until fs-konum = "10"
           read konum next no lock end move "10" to fs-konum
           not at end
                if konum-anahtar > 0 and konum-anahtar not > 19
                   move konum-anahtar to son-konum
                end-if
           end-read
     end-perform
     close konum.
    if link-var = 1 then 
       move 0 to hizli-value
       display form1-cb-1
        perform islem-yap thru islem-yap-exit
        set exit-pushed to true
    end-if

     .
 exception-procedure.
     evaluate key-status
          when 2 
             modify Form1-Ef-1, enabled = false
             if isyeri-adres-tasi(1:7) = "trainin" and 
                 xxx1-sirketi not = "training" 
                 and xxx1-sirketi not = spaces then
                  display message box "Sartlar saglandi"
                        perform hayali-oda-bul
                  perform veri-duzenle
                  
                  perform extralar-duzenle
                  perform islem-yap thru islem-yap-exit
                  
                  perform tum-onkasa
*                  perform tum-his
                  perform devir-yap thru devir-yap-exit
                  else

                perform islem-yap thru islem-yap-exit
                
             end-if
             perform loga-yaz
             display message box "Islem Tamamlandi...."
                     move 27 to key-status
     
           when 123
               open i-o fiyatana 
               initialize fiyatana-rec
               start fiyatana key > fiyatana-anah  
               invalid   continue
               not invalid
                  perform until fs-fiyatana = "10"
                   read fiyatana next
                     end move "10" to fs-fiyatana
                     not end
                       move fiyatana-anah to son-kalinan
                        perform until fs-fiyatana = "10"
                          move son-kalinan to fiyatana-anah son-bakilan
                          initialize degisti
                          start fiyatana key = fiyatana-anah  
                               invalid
                                 stop " "
                               not invalid
                             perform until degisti = "10"
                               read fiyatana next
                                  end move "10" to fs-fiyatana  degisti
                                  not end
                                  if fiyatana-anah(1:31) not = son-bakilan
                                      move fiyatana-anah to son-kalinan
                                      
                                      perform varying m from 1 by 1 until m > 19  
                                         if cocuksuz(m) = 0 and arti1(m) = 0 and  arti2(m) = 0
                                            move arti3(m) to cocuksuz(m)
                                            
                                            initialize arti3(m) arti2(m) arti1(m)
                                         else
                                         if cocuksuz(m) = 0 and arti1(m) = 0
                                            move arti2(m) to cocuksuz(m)
                                            move arti3(m) to arti1(m)
                                            initialize arti3(m) arti2(m) 
                                         else
                                         if cocuksuz(m) = 0 then
                                            move arti1(m) to cocuksuz(m)
                                            move arti2(m) to arti1(m)
                                            move arti3(m) to arti2(m)
                                            initialize arti3(m)
                                         else
                                         if cocuksuz(m) = arti1(m) then
                                            move arti1(m) to cocuksuz(m)
                                            move arti2(m) to arti1(m)
                                            move arti3(m) to arti2(m)
                                            initialize arti3(m)
                                          end-if
                                          end-if
                                          end-if
                                          end-if
                                      end-perform

                                      if cocuksuz(20) = 1 
                                        move son-bakilan to fiyatana-anah
                                        move 0 to fiyatana-kucuk
                                        read fiyatana no lock 
                                          invalid stop " "
                                          not invalid
                                           perform varying m from 1 by 1 until m > 19 
                                              move cocuksuz(m) to FIYATANA-ODA-FIYATI(m)

                                           end-perform 
                                           rewrite fiyatana-rec invalid stop " " end-rewrite
                                          end-read
                                      end-if
                                      if arti1(20) = 1 
                                        move son-bakilan to fiyatana-anah
                                        move 1 to fiyatana-kucuk
                                        read fiyatana no lock 
                                          invalid stop " "
                                          not invalid
                                           perform varying m from 1 by 1 until m > 19 
                                              move arti1(m) to FIYATANA-ODA-FIYATI(m)

                                           end-perform 
                                           rewrite fiyatana-rec invalid stop " " end-rewrite
                                          end-read
                                      end-if
                                       if arti2(20) = 1 
                                        move son-bakilan to fiyatana-anah
                                        move 2 to fiyatana-kucuk
                                        read fiyatana no lock 
                                          invalid stop " "
                                          not invalid
                                           perform varying m from 1 by 1 until m > 19 
                                              move arti2(m) to FIYATANA-ODA-FIYATI(m)

                                           end-perform 
                                           rewrite fiyatana-rec invalid stop " " end-rewrite
                                          end-read
                                      end-if
                                      if arti3(20) = 1 
                                        move son-bakilan to fiyatana-anah
                                        move 3 to fiyatana-kucuk
                                        read fiyatana no lock 
                                          invalid stop " "
                                          not invalid
                                           perform varying m from 1 by 1 until m > 19 
                                              move arti3(m) to FIYATANA-ODA-FIYATI(m)

                                           end-perform 
                                           rewrite fiyatana-rec invalid stop " " end-rewrite
                                          end-read
                                      end-if
                                      move "10" to degisti
                                      initialize fiyatlar
                                      else
                                        evaluate fiyatana-kucuk
                                          when 0
                                           move 1 to cocuksuz(20)
                                           perform varying m from 1 by 1 until m > 19
                                             move FIYATANA-ODA-FIYATI(m) to cocuksuz(m)
                                           end-perform
                                          when 1
                                           move 1 to arti1(20)
                                           perform varying m from 1 by 1 until m > 19
                                             move FIYATANA-ODA-FIYATI(m) to arti1(m)
                                           end-perform
                                          when 2
                                           move 1 to arti2(20)
                                           perform varying m from 1 by 1 until m > 19
                                             move FIYATANA-ODA-FIYATI(m) to arti2(m)
                                           end-perform
                                          when 3
                                           move 1 to arti3(20)
                                           perform varying m from 1 by 1 until m > 19
                                             move FIYATANA-ODA-FIYATI(m) to arti3(m)
                                           end-perform
                                        end-evaluate
                                  end-if
                               end-read
                             end-perform    
                          end-start
                        end-perform  
                   end-read
                  end-perform
               end-start
               close fiyatana
           when 6
                 open input  fiyatana   takvim
                open i-o   fiyat   
                 perform fiyat-isle thru fiyat-isle-exit
                 close fiyat fiyatana takvim
           
                 
              
               
           when 7          
               
               open i-o rez  konuk
               initialize rez-rec
               start rez key > rez-anah
                  not invalid
                     perform test after until fs-rez = "10"
                       read rez next no lock
                              end move "10" to fs-rez
                              not end
                                if rez-fiyat-konumu(1:1) = spaces  or
                                   rez-fiyat-konumu(2:1) = spaces  or
                                   ( rez-fiyat-konumu(2:1) = zeroes  and
                                   rez-fiyat-konumu(1:1) = zeroes ) 
                                   then
                                    
                                   move  rez-oda-konumu to rez-fiyat-konumu

                                  accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                                  accept rez-edit-zaman from time          |                           

                                   rewrite rez-rec invalid 
                                   continue
                                   end-rewrite
                                 end-if

                                   if rez-folio > 0 then
                                   move rez-folio to konuk-folio
                                   read konuk no lock 
                                         invalid
                                           continue
                                        not invalid
                                      if konuk-fiyat-konumu(1:1) = spaces  or
                                         
                                         konuk-fiyat-konumu(2:1) = spaces  or
                                         ( konuk-fiyat-konumu(2:1) = zeroes  and 
                                         konuk-fiyat-konumu(1:1) = zeroes )
                                         then

                                        move konuk-oda-konumu to konuk-fiyat-konumu
                                        rewrite konuk-rec invalid 
                                         continue
                                        end-rewrite
                                     end-if
                                     
                                     end-read
                                  end-if
                               

                          end-read                     
                     end-perform   
                end-start         
                close rez             konuk
                display message box "Tum rezervasyonlarin fiyat konumlari olusturuldu" 
                perform konuk-rez-kontrol
         end-evaluate.
*
 sirk-copyala.
     display lb-isl-durumu
     accept system-information   from system-info
     accept terminal-abilities   from terminal-info
        move xxx1-sirketi      to copya2-adres copya-adres
        move isyeri-adres-tasi        to paste2-adres paste-adres
        delete file onkasa takvim 
        if operating-system = "Unix"
           call "system" using kopyala-unix giving sonuc
            
           else  
           call "system" using kopyala-dos giving sonuc
        end-if,
          
*           display message box kopyala-unix
          if sonuc not = zeroes then 
          
            display message box "Kopyalama islemi basarilamadi" 
         end-if 
        .
            open i-o genel
            move 1 to genel-anahtar
            read genel no lock invalid
                  initialize mesaj-link
                  move 03 to mesaj-no
                  perform mesaj-ver
            not invalid
                move copya-adres to xxx1-sirketi
                rewrite genel-rec
        
            end-read
            close genel .
*
 veri-duzenle.
     perform sirk-copyala
     perform rez-duzenle
            .
 tekrez-duzenle.
    display rez-no
     
    initialize acenta-rec silinsinmi
    move rez-acenta to acenta-kodu
   
    read acenta no lock invalid
         continue
       not invalid
         if acenta-tipi = 3 then
            set  kayitsilinecek to true
            else 
             perform  konuk-kontrol
         end-if
         if not kayitsilinecek 
            and acenta-indirim > 0 then
            set kayitindirilecek to true

         end-if

    end-read
    if kayitsilinecek   
       perform kayit-sil 
    end-if
    if kayitindirilecek 
       perform kayit-indir     
    end-if   
         .
*            
 kayit-sil.
       if rez-folio > 0  then 
        initialize romhrk-rec                                           
       move rez-folio to romhrk-folio  
       start romhrk key > ROMHRK-ANAH1 
          invalid continue
          not invalid
          perform until fs-romhrk = "10"
             read romhrk next no lock 
                end move "10" to fs-romhrk
                not end
                 if romhrk-folio not = rez-folio
                      move "10" to fs-romhrk
                   else
                      delete romhrk 
                 end-if
             end-read
          end-perform
       end-start
       move rez-folio to konuk-folio
      read konuk no lock invalid continue
           not invalid
               if konuk-durumu = "I" then
                  open i-o odalar
                  initialize odalar-rec
                  move konuk-odano to odalar-anah
                  read odalar no lock 
                     invalid 
                       display message box  "Oda Bulunmadi"
                     not invalid 
                        
                         initialize house-buyuk house-kucuk house-free
                                    house-bebek
                        rewrite odalar-rec
                   end-read
                   close odalar
               end-if    
               delete konuk
      end-read   
    
      end-if
      delete rez
         .
*
 kayit-indir.
      if rez-folio > 0  then 
       initialize romhrk-rec
       move rez-folio to romhrk-folio  
       start romhrk key > romhrk-anah1 
          invalid continue
          not invalid
          perform until fs-romhrk = "10"
             read romhrk next no lock 
                end move "10" to fs-romhrk
                not end
                 if romhrk-folio not = rez-folio
                      move "10" to fs-romhrk
                   else
                      
                      compute romhrk-tl-tutar rounded = romhrk-tl-tutar -
                                    ((romhrk-tl-tutar / 100) * acenta-indirim)
                      compute romhrk-dv-tutar rounded = romhrk-dv-tutar -
                                    ((romhrk-dv-tutar / 100) * acenta-indirim)
                      rewrite romhrk-rec
               end-if
             end-read
          end-perform
       end-start
       move rez-folio to konuk-folio
      read konuk no lock invalid continue
           not invalid
               compute konuk-oda-tutar = konuk-oda-tutar -
                                    ((konuk-oda-tutar / 100) * acenta-indirim)
               compute konuk-extbed-tutar = konuk-extbed-tutar -
                                    ((konuk-extbed-tutar / 100) * acenta-indirim)
               compute konuk-kahvalti-tutar = konuk-kahvalti-tutar -
                                    ((konuk-kahvalti-tutar / 100) * acenta-indirim)
               compute konuk-ogle-tutar = konuk-ogle-tutar -
                                    ((konuk-ogle-tutar / 100) * acenta-indirim)
               compute konuk-aksam-tutar = konuk-aksam-tutar -
                                    ((konuk-aksam-tutar / 100) * acenta-indirim)
               compute konuk-icecek-tutar = konuk-icecek-tutar -
                                    ((konuk-icecek-tutar / 100) * acenta-indirim)
               compute konuk-extra-tutar = konuk-extra-tutar -
                                    ((konuk-Extra-tutar / 100) * acenta-indirim)
               compute konuk-top-borc = konuk-top-borc -
                                    ((konuk-top-borc / 100) * acenta-indirim)
               compute konuk-top-alac = konuk-top-alac -
                                    ((konuk-top-alac / 100) * acenta-indirim)
               compute konuk-dv-degeri = konuk-dv-degeri -
                                    ((konuk-dv-degeri / 100) * acenta-indirim)
                  
              rewrite konuk-rec
      end-read   
      
      end-if
        compute rez-fiyati = rez-fiyati -
                ((rez-fiyati / 100) * acenta-indirim)

        accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
        accept rez-edit-zaman from time          |                           

        rewrite rez-rec
         .

 konuk-kontrol.
    move rez-folio to konuk-folio.
    read konuk no lock 
           invalid continue
           not invalid
               move "B" to kodlar02-tipi.
               move konuk-odeme-tipi to kodlar02-kodu.
                read kodlar02 no lock invalid continue end-read

              if konuk-cik-cikma  = "H" or (not
                  (konuk-fol-kodu = "R" or 
                   konuk-fol-kodu = "G" )) or 
                   ode-posting = "H" 
                   then 
                    set kayitsilinecek to true
               end-if
            .
*
 extralar-duzenle.
        modify lb-isl-durumu, title = "Extra Foliolar duzenleniyor " .
*       open output exthrk 
*       close exthrk.
       open input acenta
       open i-o   konuk exthrk
       initialize acenta-rec
       start   acenta key > acenta-kodu 
          invalid 
              continue
          not invalid
            perform until fs-acenta = "10"  
              read acenta next no lock
                 end move "10" to fs-acenta
                 not end
*                   if acenta-tipi = 3 then 
                      perform ext-sil
*                   end-if
              end-read
            end-perform
       end-start
       close acenta konuk exthrk  .
       .
*
 ext-sil.
       initialize konuk-rec
       move acenta-kodu to konuk-acenta
       move "I" to konuk-durumu
       perform ext-fol-sil.
       initialize konuk-rec
       move acenta-kodu to konuk-acenta
       move "H" to konuk-durumu.
       perform ext-fol-sil.
       .
       
 hayali-oda-bul.
       open input odalar   
       move high-values to odalar-rec
       start odalar key < odalar-anah
          invalid
            continue
          not invalid
             perform test after until fs-odalar = "10" or odalar-hayali = "H"
               read odalar backward no lock end move "10" to fs-odalar end-read
             end-perform  
       end-start.
       move odalar-no to gr-hayali.
       close odalar.
 ext-fol-sil.

     
       start konuk key >= konuk-acen
         invalid continue
         not invalid
            perform until fs-konuk = "10"
              read konuk next no lock 
                end move "10" to fs-konuk
                not end
                  if konuk-acenta not = acenta-kodu then
                      move "10" to fs-konuk
                    else
                      if konuk-fol-kodu = "E"
                      if acenta-tipi = 3 then 
                         move "9999" to konuk-acenta
                         move "E=> Telefon Pesin Folio" to konuk-adi
                         move gr-hayali to konuk-odano
                         move "E=> Telefon Pesin Folio" to konuk-soyadi
                        rewrite konuk-rec 
                            invalid
                            display message box "Hata No:567777744"
                        end-rewrite 
                         end-if
*                         perform exthrk-sil
*                         delete konuk
*                       else 
*                         display message box "ROOM FOLIO KALMIS-" konuk-folio 
                     end-if
                 end-if
               end-read
            end-perform
       end-start
       .
*
 exthrk-sil.
       initialize exthrk-rec
       move konuk-folio to exthrk-folio

       start exthrk key > extHRK-ANAH1 
          invalid continue
          not invalid
          perform until fs-exthrk = "10"
             read exthrk next no lock 
                end move "10" to fs-exthrk
                not end
                 if exthrk-folio not = konuk-folio
                      move "10" to fs-exthrk
                   else
                     if exthrk-ba = "B" then 
                         move 010 to exthrk-depkod
                         rewrite exthrk-rec invalid  
                         display message box "Hata No:123455567"
                         end-rewrite
                     end-if
                 end-if
             end-read
          end-perform
       end-start
    .
    
*
 rez-duzenle.
    
    open i-o acenta rez konuk romhrk kodlar02 exthrk
    initialize rez-rec 
    start rez key > rez-anah invalid continue
         not invalid
         perform until fs-rez ="10"
         read rez next no lock
            end move "10" to fs-rez
            not end 
               
               perform tekrez-duzenle
         end-read
         end-perform
    end-start
    close acenta rez konuk romhrk kodlar02 exthrk.
    .
*
 islem-yap.
 
 dosyalari-ac.
       open output cast 
       close       cast  
       if hizli-value = 0 then
       open    output  acenhrk fiyat  aksiyhrk
       close           acenhrk fiyat   aksiyhrk
       open input kontrat fiyatana   aksiyon
       open i-o   acenhrk fiyat bilbord  aksiyhrk
       end-if
       open input rez.
       open i-o   cast  takvim.
       if  hizli-value = 0 then perform aksiyon-yeniden-olustur end-if.
 bilbord-bosalt.
       if hizli-value = 1 then go bilbord-bosalt-exit end-if
       modify lb-isl-durumu, title = "Bilbord Hazirlaniyor...  " .
       initialize bilbord-rec.
       start bilbord key not < bilbord-anah invalid 
             go bilbord-bosalt-exit.
 bilbord-bosalt-oku.
       read bilbord next no lock end 
            go bilbord-bosalt-exit.
       if fs-bilbord = 99 go bilbord-bosalt-oku.
*          modify lb-isl-durumu-1, title = bilbord-anah 
          initialize bilbord-sat-oda bilbord-sat-buyuk.
         rewrite bilbord-rec invalid continue.
         go bilbord-bosalt-oku.  
 bilbord-bosalt-exit.
       exit.  
*
 takvim-bosalt.
       modify lb-isl-durumu, title = "Takvim Hazirlaniyor...  " .
       initialize takvim-rec.
       start takvim key not < takvim-anah invalid 
             go takvim-bosalt-exit.
 takvim-bosalt-oku.
       read takvim next no lock end 
            go takvim-bosalt-exit.
       if fs-takvim = 99 go takvim-bosalt-oku.
          modify lb-isl-durumu-1, title = takvim-anah 
          perform varying  m from 1 by 1 until m > 19
          initialize takvim-satilan(m)
          
          end-perform .
          
         rewrite takvim-rec invalid continue.
         go takvim-bosalt-oku.  
 takvim-bosalt-exit.
       exit.  
 kontrat-isle.  
       if hizli-value = 1 then go fiyat-isle-exit end-if
         perform ykontrat-isle
        .
 kontrat-isle-exit.  
    exit. 

 fiyat-isle.  
        modify lb-isl-durumu, title = "Fiyatlar Hazirlaniyor...  ".
        initialize fiyatana-rec.
        start fiyatana key not < fiyatana-anah invalid 
              go fiyat-isle-exit. 
 fiyat-oku.  
        read fiyatana next no lock end 
             go fiyat-isle-exit.
        if fs-fiyatana = 99 go fiyat-oku.
        modify lb-isl-durumu-1, title = fiyatana-anah.
        perform fiyat-yaz  thru fiyat-yaz-exit.
        go fiyat-oku.
 fiyat-yaz. 
    move spaces to evet-hayir.
    initialize takvim-rec.
    move fiyatana-ilk-tarih to takvim-anah.
    start takvim key not < takvim-anah 
          invalid go fiyat-oku.  
    if takvim-anah not = fiyatana-ilk-tarih    
       go fiyat-oku.  

    perform with test after until evet,
        read takvim next no lock end,
                        move "E" to evet-hayir,
                 not end,
                        if takvim-anah > fiyatana-son-tarih
                                  move "E" to evet-hayir,
                        end-if,
                        if takvim-anah not > fiyatana-son-tarih
                           display takvim-anah ,
                           perform fiyat-kaydet thru fiyat-kaydet-exit,
                        end-if,
        end-read,
    end-perform.
 fiyat-yaz-exit.
    exit.
 fiyat-kaydet.
    initialize fiyat-rec
    move fiyatana-acenta           to fiyat-acenta
    move fiyatana-anlasma          to fiyat-anlasma
    move takvim-anah               to fiyat-tarih
    move fiyatana-banka            to fiyat-banka
    move fiyatana-doviz            to fiyat-doviz
    move fiyatana-pan-tipi         to fiyat-pan-tipi
    move fiyatana-rez-tipi         to fiyat-rez-tipi
    move fiyatana-buyuk            to fiyat-buyuk
    move fiyatana-kucuk            to fiyat-kucuk
    move fiyatana-ilk-tarih        to fiyat-bas-tarih
    move fiyatana-son-tarih        to fiyat-bit-tarih
    write fiyat-rec invalid
          rewrite fiyat-rec invalid continue 
          end-rewrite
    end-write.
 fiyat-kaydet-exit.
      exit.
 fiyat-isle-exit.  
      exit.
 rez-isle.  
       
            modify lb-isl-durumu, 
               title = "Forecastlar Hazirlaniyor "
               .
        initialize rez-rec.
        start rez key not < rez-anah invalid 
              go rez-isle-exit. 
 rez-oku.  
        read rez next no lock end 
             go rez-isle-exit.
        if fs-rez = 99 go rez-oku.
*        modify lb-isl-durumu-1, title = rez-anah.
        if hizli-value = 0 
           modify form1-handle title  = rez-anah
         else 
             display "forecastlar hazirlaniyor -" rez-anah
        end-if.
            perform cast-isle    thru cast-isle-exit.
        if hizli-value = 0 then 
            perform acenhrk-isle 
        end-if.
            perform takvim-isle  thru takvim-isle-exit.
        go rez-oku.
 cast-isle. 
        move rez-gir-tar to takvim-anah.
        start takvim key not < takvim-anah invalid 
              go cast-isle-bitti.
 cast-yaz-oku.
        read takvim next no lock end go cast-isle-bitti.
        if fs-takvim = 99 go cast-yaz-oku.
*           modify lb-isl-durumu-1, title =  takvim-anah ,
        if takvim-anah > rez-cik-tar go cast-isle-bitti. 
                initialize cast-rec.
           move takvim-anah      to cast-tarih.
           move rez-no           to cast-rez-no.
           move rez-odano        to cast-oda-no.
        write cast-rec invalid 
              rewrite cast-rec invalid continue
              end-rewrite 
        end-write.
            go cast-yaz-oku.
 cast-isle-bitti.
 cast-isle-exit. 
     exit.
 takvim-isle.
        if rez-durumu = "I" 
           continue
        else 
           go takvim-isle-exit
        end-if.
        if rez-k-g-b  = "K" 
           continue
        else 
           go takvim-isle-exit
        end-if.
        move rez-gir-tar to takvim-anah.
        start takvim key not < takvim-anah invalid 
              go takvim-isle-exit.
 takvim-oku-yaz.
        read takvim next no lock end 
             go takvim-isle-exit.
        if fs-takvim = 99 go takvim-oku-yaz.
*           modify lb-isl-durumu-1, title = takvim-anah,
        if takvim-anah = rez-cik-tar go takvim-isle-exit.
        if takvim-anah > rez-cik-tar go takvim-isle-exit.

          compute Takvim-Sat-Oda(rez-oda-konumu,rez-s-d-t-g)   = 
                  takvim-sat-oda(rez-oda-konumu,rez-s-d-t-g)   + 1.
          compute takvim-sat-buyuk(rez-oda-konumu,rez-s-d-t-g) = 
                  takvim-sat-buyuk(rez-oda-konumu,rez-s-d-t-g) + rez-buyuk.
          compute takvim-sat-kucuk(rez-oda-konumu,rez-s-d-t-g) = 
                  takvim-sat-kucuk(rez-oda-konumu,rez-s-d-t-g) + rez-kucuk.
          compute takvim-sat-free(rez-oda-konumu,rez-s-d-t-g)  = 
                  takvim-sat-free(rez-oda-konumu,rez-s-d-t-g)  + rez-free.
          compute takvim-sat-free(rez-oda-konumu,rez-s-d-t-g)  = 
                  takvim-sat-free(rez-oda-konumu,rez-s-d-t-g)  + rez-bebek.
        rewrite takvim-rec invalid go takvim-oku-yaz. 
            go takvim-oku-yaz.
 takvim-isle-exit. 
     exit.
 bilbord-isle. 
          initialize bilbord-rec.
          move rez-acenta      to bilbord-acenta. 
          move takvim-anah     to bilbord-tarih. 
          move rez-oda-konumu  to bilbord-oda-tip. 

         read bilbord no lock invalid 
              initialize bilbord-rec
              move rez-acenta      to bilbord-acenta
              move takvim-anah     to bilbord-tarih 
              move rez-oda-konumu  to bilbord-oda-tip 
              write bilbord-rec invalid continue
              end-write
         end-read.
          compute  bilbord-sat-oda   = bilbord-sat-oda   + 1. 
          compute  bilbord-sat-buyuk = bilbord-sat-buyuk + rez-buyuk. 
         rewrite bilbord-rec invalid continue
         end-rewrite.
 bilbord-isle-exit. 
      exit. 

 rez-isle-exit.
      exit.

  
 son.
     if hizli-value = 0
       close  kontrat fiyatana aksiyon
       close  acenhrk fiyat bilbord   aksiyhrk
     end-if
    close  rez.
    close  cast  takvim . 
 islem-yap-exit.
      exit.
 dkkkxkxjhjj.
      .
 tum-onkasa.
     move 0 to vis-1
     display form1
     open output onkasa 
     close onkasa
     open input takvim romhrk  exthrk
     open i-o onkasa konuk 
     initialize takvim-rec
     move yil-tasi to takvim-yil
     start takvim key > takvim-anah
          not invalid
             perform until fs-takvim = "10"
             
             read takvim next 
                 at end move "10" to fs-takvim
                 not end 
                 display "Onkasa Olusturuluyor --" takvim-anah at 0202
                 move takvim-anah to ilk-tarih
                 perform onkasa-olustur thru onkasa-olustur-exit
             end-read
             end-perform
     end-start
     display message box " Tum Onkasa Olusturuldu...Transfer Tamam.....".
     close takvim onkasa romhrk konuk exthrk
      
     . 
      
 onkasa-olustur.

    initialize onkasa-rec.
    move ilk-tarih to onkasa-tarih.
    start onkasa key not < onkasa-anah invalid
          go onkasa-bitti. 
 onkasa-oku.
    
    read onkasa next no lock end go onkasa-bitti.
    if fs-onkasa = 99 go onkasa-oku.
    if onkasa-tarih > ilk-tarih go onkasa-bitti.  
    if onkasa-dep   = 888 go onkasa-oku. 
    if onkasa-dep   = 999 go onkasa-oku. 
       initialize onkasa-tutar-tl onkasa-tutar-dv.
       rewrite onkasa-rec invalid go onkasa-oku.
       go onkasa-oku.
 onkasa-bitti. 
 folio-oku.
    move "I"  to konuk-durumu.  
    move spaces to konuk-odano.
    start konuk key not < konuk-oda invalid 
          go folio-oku-exit.
 konuk-oku.
    read konuk next no lock end go folio-oku-exit.
    if fs-konuk = 99 go konuk-oku.
    if konuk-durumu not = "I" go folio-oku-exit. 
*       display konuk-odano line 05 col 15 color palet-07.
       initialize borc-tutar-tl alac-tutar-tl konuk-top-borc konuk-top-alac.
       if konuk-fol-kodu = "R" perform romhrk-bolumu thru romhrk-bolumu-exit
                         else  perform exthrk-bolumu thru exthrk-bolumu-exit.
      move borc-tutar-tl     to konuk-top-borc.
      move alac-tutar-tl     to konuk-top-alac.
      rewrite konuk-rec invalid go konuk-oku.
      go konuk-oku.
 folio-oku-exit.  
      exit.
 folio-gec.  
 oda-bul.
       initialize romhrk-rec.
       move ilk-tarih     to romhrk-tarih.
       move spaces        to romhrk-depkod.
      start romhrk key not < romhrk-anah2 invalid 
            go oda-bul-exit.
 oda-oku.
        read romhrk next no lock end go oda-bul-exit.
        if fs-romhrk = 99 go oda-oku.
*           display romhrk-anah line 05 col 15 color palet-07.
        if romhrk-tarih > ilk-tarih go oda-bul-exit.
        if romhrk-tarih = ilk-tarih 
           continue
        else 
           go oda-oku
        end-if.
           initialize hrkgir-rec.
           move romhrk-rec   to hrkgir-rec.
             perform onkasa-artir   thru onkasa-artir-exit.
*/Dovizler icin
           go oda-oku.
 oda-bul-exit. 
    exit.
 ext-bul.
       initialize exthrk-rec.
       move ilk-tarih     to exthrk-tarih.
       move spaces        to exthrk-depkod.
      start exthrk key not < exthrk-anah2 invalid 
            go ext-bul-exit.
 ext-oku.
        read exthrk next no lock end go ext-bul-exit.
        if fs-exthrk = 99 go ext-oku.
*           display exthrk-anah line 05 col 15 color palet-07.
        if exthrk-tarih > ilk-tarih go ext-bul-exit.
        if exthrk-tarih = ilk-tarih 
           continue
        else 
           go ext-oku
        end-if.
           initialize hrkgir-rec.
           move exthrk-rec   to hrkgir-rec.
             perform onkasa-artir   thru onkasa-artir-exit.
            go ext-oku.
 ext-bul-exit. 
       exit.
 islem-bitti. 
       go onkasa-olustur-exit.
 
 romhrk-bolumu. 
       initialize romhrk-rec.
       move konuk-folio   to romhrk-folio.
       move spaces        to romhrk-islem.
      start romhrk key not < romhrk-anah invalid go romhrk-bolumu-exit.
 romhrk-oku.
        read romhrk next no lock end go romhrk-bolumu-exit.
        if fs-romhrk = 99 go romhrk-oku.
*           display romhrk-anah line 05 col 15 color palet-07.
        if romhrk-folio > konuk-folio go romhrk-bolumu-exit.
        if romhrk-folio = konuk-folio 
           continue
        else 
           go romhrk-oku
        end-if.
           initialize hrkgir-rec.
           move romhrk-rec   to hrkgir-rec.
          if hrkgir-ba = "B" 
             compute borc-tutar-tl = borc-tutar-tl + hrkgir-tl-tutar.
          if hrkgir-ba = "A" 
             compute alac-tutar-tl = alac-tutar-tl + hrkgir-tl-tutar.
           go romhrk-oku. 
 romhrk-bolumu-exit. 
       exit.
 exthrk-bolumu. 
       initialize exthrk-rec.
       move konuk-folio   to exthrk-folio.
       move spaces        to exthrk-islem.
      start exthrk key not < exthrk-anah invalid go exthrk-bolumu-exit.
 exthrk-oku.
        read exthrk next no lock end go exthrk-bolumu-exit.
        if fs-exthrk = 99 go exthrk-oku.
*           display exthrk-anah line 05 col 15 color palet-07.
        if exthrk-folio > konuk-folio go exthrk-bolumu-exit.
        if exthrk-folio = konuk-folio 
           continue
        else 
           go exthrk-oku
        end-if.
        initialize hrkgir-rec.
        move exthrk-rec   to hrkgir-rec.
         if hrkgir-ba = "B" 
            compute borc-tutar-tl = borc-tutar-tl + hrkgir-tl-tutar.
         if hrkgir-ba = "A" 
            compute alac-tutar-tl = alac-tutar-tl + hrkgir-tl-tutar.
         go exthrk-oku. 
 exthrk-bolumu-exit. 
       exit.
 
 onkasa-artir. 
       move hrkgir-tarih    to onkasa-tarih.
       move hrkgir-depkod   to onkasa-dep.

       read onkasa no lock invalid go onkasa-yeni-isle.
       compute onkasa-tutar-tl   = onkasa-tutar-tl + hrkgir-tl-tutar. 
       compute onkasa-tutar-dv   = onkasa-tutar-dv + hrkgir-dv-tutar.
       rewrite onkasa-rec invalid write onkasa-rec end-rewrite. 
       go onkasa-artir-exit.
 onkasa-yeni-isle. 
       initialize onkasa-rec.
       move hrkgir-tarih      to onkasa-tarih.
       move hrkgir-depkod     to onkasa-dep.
       move hrkgir-tl-tutar   to onkasa-tutar-tl.
       move hrkgir-dv-tutar   to onkasa-tutar-dv.
       write onkasa-rec invalid rewrite onkasa-rec end-write. 
 onkasa-artir-exit. 
       exit.
 onkasa-olustur-exit.
       exit.
 tum-his.
     open input konuk rez cast kodlar02 romhrk takvim. 
     open i-o   istdata turizm detist
     initialize takvim-rec
     start takvim key > takvim-anah
          not invalid
            
             
             read takvim next 
                 at end move "10" to fs-takvim
                 not end 
                 move takvim-anah to ilk-tarih
                 perform his-islem-yap thru his-islem-yap-exit
             end-read
            
     end-start

     display message box " History Istatistikler Olusturuldu...Transfer Tamam.....".
     close konuk rez cast kodlar02 romhrk takvim. 
     close istdata turizm detist .
 his-islem-yap.
 istatistik-basla.
     modify lb-isl-durumu, title = "Gunsonu Istatistigi Olusturuluyor Bekleyiniz.:" .
     initialize takvim-rec.
     move ilk-tarih   to takvim-anah.
     start takvim key not < takvim-anah 
           invalid go transfer-bitti.
 takvim-oku.
     read takvim next no lock end go transfer-bitti. 
     if fs-takvim = 99 go takvim-oku.
         modify lb-isl-durumu, title = "Tarih".
         modify lb-isl-durumu-1, title = takvim-anah.

 ist-bosalt.
          initialize istdata-rec.
          move takvim-anah      to ist-tarih. 
          move spaces           to ist-acenta ist-rez-tipi.  
        start istdata key not < istdata-anah invalid go ist-bosalt-bitti.
 ist-bosalt-oku.
         read istdata next no lock end go ist-bosalt-bitti.
         if fs-istdata = 99 go ist-bosalt-oku.
         modify lb-isl-durumu-1, title = istdata-anah.
         if ist-tarih > takvim-anah    go ist-bosalt-bitti.
         if ist-tarih = takvim-anah    
            continue
         else 
            go ist-bosalt-oku
         end-if.   
            delete istdata invalid continue.
            go ist-bosalt-oku.   
 ist-bosalt-bitti.
 det-bosalt.
          initialize detist-rec.
          move takvim-anah      to detist-tarih. 
          move spaces           to detist-acenta detist-rez-tipi.  
        start detist key not < detist-anah invalid go det-bosalt-bitti.
 det-bosalt-oku.
         read detist  next no lock end go det-bosalt-bitti.
         if fs-detist  = 99 go det-bosalt-oku.
         if detist-tarih > takvim-anah    go det-bosalt-bitti.
         if detist-tarih = takvim-anah    
            continue
            else 
            go det-bosalt-oku
         end-if.   
         modify lb-isl-durumu-1, title = detist-anah.
            delete detist invalid continue.
            go det-bosalt-oku.   
 det-bosalt-bitti.
 tur-bosalt.
          initialize turizm-rec.
          move takvim-anah      to turizm-tarih. 
          move spaces           to turizm-ulke. 
        start turizm key not < turizm-anah1 invalid go tur-bosalt-bitti.
 tur-bosalt-oku.
         read turizm  next no lock end go tur-bosalt-bitti.
         if fs-turizm = 99 go tur-bosalt-oku.
         modify lb-isl-durumu-1, title = turizm-anah.
         if turizm-tarih > takvim-anah    go tur-bosalt-bitti.
         if turizm-tarih = takvim-anah    
            continue
         else 
            go tur-bosalt-oku
         end-if.   
            delete turizm invalid continue.
            go tur-bosalt-oku.   
 tur-bosalt-bitti.
 cast-basla.   
          initialize cast-rec.
          move takvim-anah to cast-tarih.
        start cast key not < cast-anah invalid go yeni-gun.
 cast-oku.    
        read cast next no lock end go yeni-gun.
        if fs-cast = 99 go cast-oku.   
        modify lb-isl-durumu-1, title = cast-anah.
        if cast-tarih > takvim-anah go yeni-gun.
        if cast-tarih = takvim-anah 
           continue
        else 
           go cast-oku
        end-if. 
        move cast-rez-no   to rez-no.
        read rez no lock invalid go cast-oku.
        if rez-durumu not = "I" go cast-oku.   
        move rez-folio   to konuk-folio.
        read konuk no lock invalid go cast-oku.   
        if konuk-fol-kodu not = "R" go cast-oku.
        if konuk-git-tar = cast-tarih go cast-oku.
        modify lb-isl-durumu-1, title = konuk-odano.

       initialize kodlar02-rec.
       move "A"                to kodlar02-tipi.
       move konuk-pan-tipi     to kodlar02-kodu.
       read kodlar02 no lock invalid continue
       end-read.

       initialize corr-tutarlar
       perform basilan-bul  thru basilan-bul-exit.

       initialize kodlar02-rec.
       move "B"                to kodlar02-tipi.
       move konuk-odeme-tipi   to kodlar02-kodu.
       read kodlar02 no lock invalid
            move spaces  to ode-tipi
       end-read.

        initialize istdata-rec.
        move takvim-anah       to ist-tarih.
        move konuk-rez-tipi    to ist-rez-tipi.  
        move konuk-acenta      to ist-acenta. 
        read istdata   no lock invalid 
             initialize istdata-rec
             move takvim-anah       to ist-tarih 
             move konuk-rez-tipi    to ist-rez-tipi  
             move konuk-acenta      to ist-acenta
        end-read. 

          compute ist-top-oda     = ist-top-oda    + 1.
          compute ist-top-buyuk   = ist-top-buyuk  + konuk-buyuk. 
          compute ist-top-kucuk   = ist-top-kucuk  + konuk-kucuk. 
          compute ist-top-free    = ist-top-free   + konuk-free.  
          compute ist-top-free    = ist-top-free   + konuk-bebek. 
          compute ist-top-tutar   = ist-top-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.

          if konuk-oda-tutar not = 0
          compute ist-oda-oda     = ist-oda-oda    + 1
          compute ist-oda-buyuk   = ist-oda-buyuk  + konuk-buyuk
          compute ist-oda-kucuk   = ist-oda-kucuk  + konuk-kucuk
          compute ist-oda-free    = ist-oda-free   + konuk-free  
          compute ist-oda-free    = ist-oda-free   + konuk-bebek 
          compute ist-oda-tutar   = ist-oda-tutar  + konuk-oda-tutar .
          
          if konuk-kahvalti-tutar not = 0
          compute ist-kah-oda     = ist-kah-oda    + 1
          compute ist-kah-buyuk   = ist-kah-buyuk  + konuk-buyuk
          compute ist-kah-kucuk   = ist-kah-kucuk  + konuk-kucuk
          compute ist-kah-free    = ist-kah-free   + konuk-free  
          compute ist-kah-free    = ist-kah-free   + konuk-bebek 
          compute ist-kah-tutar   = ist-kah-tutar  + konuk-kahvalti-tutar .
          if konuk-ogle-tutar not = 0
          compute ist-ogl-oda     = ist-ogl-oda    + 1
          compute ist-ogl-buyuk   = ist-ogl-buyuk  + konuk-buyuk
          compute ist-ogl-kucuk   = ist-ogl-kucuk  + konuk-kucuk
          compute ist-ogl-free    = ist-ogl-free   + konuk-free  
          compute ist-ogl-free    = ist-ogl-free   + konuk-bebek 
          compute ist-ogl-tutar   = ist-ogl-tutar  + konuk-ogle-tutar .
          if konuk-aksam-tutar not = 0
          compute ist-aks-oda     = ist-aks-oda    + 1
          compute ist-aks-buyuk   = ist-aks-buyuk  + konuk-buyuk
          compute ist-aks-kucuk   = ist-aks-kucuk  + konuk-kucuk
          compute ist-aks-free    = ist-aks-free   + konuk-free  
          compute ist-aks-free    = ist-aks-free   + konuk-bebek 
          compute ist-aks-tutar   = ist-aks-tutar  + konuk-aksam-tutar.
          if konuk-icecek-tutar not = 0
          compute ist-ice-oda     = ist-ice-oda    + 1
          compute ist-ice-buyuk   = ist-ice-buyuk  + konuk-buyuk
          compute ist-ice-kucuk   = ist-ice-kucuk  + konuk-kucuk
          compute ist-ice-free    = ist-ice-free   + konuk-free  
          compute ist-ice-free    = ist-ice-free   + konuk-bebek 
          compute ist-ice-tutar   = ist-ice-tutar  + konuk-icecek-tutar.
          if konuk-extra-tutar not = 0
          compute ist-ext-oda     = ist-ext-oda    + 1
          compute ist-ext-buyuk   = ist-ext-buyuk  + konuk-buyuk
          compute ist-ext-kucuk   = ist-ext-kucuk  + konuk-kucuk
          compute ist-ext-free    = ist-ext-free   + konuk-free  
          compute ist-ext-free    = ist-ext-free   + konuk-bebek 
          compute ist-ext-tutar   = ist-ext-tutar  + konuk-extra-tutar.
          if konuk-extbed-tutar not = 0
          compute ist-exb-oda     = ist-exb-oda    + 1
          compute ist-exb-buyuk   = ist-exb-buyuk  + konuk-buyuk
          compute ist-exb-kucuk   = ist-exb-kucuk  + konuk-kucuk
          compute ist-exb-free    = ist-exb-free   + konuk-free  
          compute ist-exb-free    = ist-exb-free   + konuk-bebek 
          compute ist-exb-tutar   = ist-exb-tutar  + konuk-extbed-tutar.

          compute ist-sdt-oda(konuk-s-d-t-g) =
                  ist-sdt-oda(konuk-s-d-t-g) + 1.
          compute ist-sdt-buyuk(konuk-s-d-t-g) =
                  ist-sdt-buyuk(konuk-s-d-t-g) + konuk-buyuk. 
          compute ist-sdt-kucuk(konuk-s-d-t-g) =
                  ist-sdt-kucuk(konuk-s-d-t-g) + konuk-kucuk. 
          compute ist-sdt-free(konuk-s-d-t-g) =
                  ist-sdt-free(konuk-s-d-t-g) + konuk-free. 
          compute ist-sdt-free(konuk-s-d-t-g) =
                  ist-sdt-free(konuk-s-d-t-g) + konuk-bebek.
          compute ist-sdt-tutar(konuk-s-d-t-g) =
                  ist-sdt-tutar(konuk-s-d-t-g) + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
************Complimentary bolumu......
          if ode-tipi = "D" 
          compute ist-com-oda     = ist-com-oda    + 1
          compute ist-com-buyuk   = ist-com-buyuk  + konuk-buyuk
          compute ist-com-kucuk   = ist-com-kucuk  + konuk-kucuk
          compute ist-com-free    = ist-com-free   + konuk-free  
          compute ist-com-free    = ist-com-free   + konuk-bebek 
          compute ist-com-tutar   = ist-com-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
************House Use     bolumu......
          if ode-tipi = "F" 
          compute ist-hou-oda     = ist-hou-oda    + 1
          compute ist-hou-buyuk   = ist-hou-buyuk  + konuk-buyuk
          compute ist-hou-kucuk   = ist-hou-kucuk  + konuk-kucuk
          compute ist-hou-free    = ist-hou-free   + konuk-free  
          compute ist-hou-free    = ist-hou-free   + konuk-bebek 
          compute ist-hou-tutar   = ist-hou-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
          rewrite istdata-rec invalid write istdata-rec end-rewrite.
************>Istatiklere yazildi.......

*******>Detist  Bolumu
        initialize detist-rec.
        move takvim-anah       to detist-tarih.
        move konuk-acenta      to detist-acenta. 
        move konuk-ulke        to detist-ulke-kodu. 
        move konuk-pan-tipi    to detist-pan-tipi. 
        move konuk-rez-tipi    to detist-rez-tipi.  
        move konuk-oda-konumu  to detist-oda-konumu.
        move konuk-anlasma     to detist-anlasma-kodu
        read detist no lock invalid 
             initialize detist-rec
             move takvim-anah       to detist-tarih
             move konuk-acenta      to detist-acenta 
             move konuk-ulke        to detist-ulke-kodu 
             move konuk-pan-tipi    to detist-pan-tipi 
             move konuk-rez-tipi    to detist-rez-tipi  
             move konuk-oda-konumu  to detist-oda-konumu
             move konuk-anlasma     to detist-anlasma-kodu
        end-read. 

          compute detist-top-oda     = detist-top-oda    + 1.
          compute detist-top-buyuk   = detist-top-buyuk  + konuk-buyuk. 
          compute detist-top-kucuk   = detist-top-kucuk  + konuk-kucuk. 
          compute detist-top-free    = detist-top-free   + konuk-free.  
          compute detist-top-bebek   = detist-top-bebek  + konuk-bebek. 
          compute detist-top-tutar   = detist-top-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.

          if konuk-oda-tutar not = 0
             compute detist-oda-oda     = detist-oda-oda    + 1
             compute detist-oda-buyuk   = detist-oda-buyuk  + konuk-buyuk
             compute detist-oda-kucuk   = detist-oda-kucuk  + konuk-kucuk 
             compute detist-oda-free    = detist-oda-free   + konuk-free
             compute detist-oda-bebek   = detist-oda-bebek  + konuk-bebek
             compute detist-oda-tutar  = detist-oda-tutar  + konuk-oda-tutar
          end-if.
          if konuk-kahvalti-tutar not = 0
             compute detist-kah-oda     = detist-kah-oda    + 1
             compute detist-kah-buyuk   = detist-kah-buyuk  + konuk-buyuk
             compute detist-kah-kucuk   = detist-kah-kucuk  + konuk-kucuk 
             compute detist-kah-free    = detist-kah-free   + konuk-free
             compute detist-kah-bebek   = detist-kah-bebek  + konuk-bebek
             compute detist-kah-tutar   = 
                     detist-kah-tutar  + konuk-kahvalti-tutar
          end-if.
          if konuk-ogle-tutar not = 0
             compute detist-ogl-oda     = detist-ogl-oda    + 1
             compute detist-ogl-buyuk   = detist-ogl-buyuk  + konuk-buyuk
             compute detist-ogl-kucuk   = detist-ogl-kucuk  + konuk-kucuk 
             compute detist-ogl-free    = detist-ogl-free   + konuk-free
             compute detist-ogl-bebek   = detist-ogl-bebek  + konuk-bebek
             compute detist-ogl-tutar   = detist-ogl-tutar  + konuk-ogle-tutar
          end-if.
          if konuk-aksam-tutar not = 0
             compute detist-aks-oda     = detist-aks-oda    + 1
             compute detist-aks-buyuk   = detist-aks-buyuk  + konuk-buyuk
             compute detist-aks-kucuk   = detist-aks-kucuk  + konuk-kucuk 
             compute detist-aks-free    = detist-aks-free   + konuk-free
             compute detist-aks-bebek   = detist-aks-bebek  + konuk-bebek
             compute detist-aks-tutar   = detist-aks-tutar  + konuk-aksam-tutar
          end-if.
          if konuk-icecek-tutar not = 0
             compute detist-ice-oda     = detist-ice-oda    + 1
             compute detist-ice-buyuk   = detist-ice-buyuk  + konuk-buyuk
             compute detist-ice-kucuk   = detist-ice-kucuk  + konuk-kucuk 
             compute detist-ice-free    = detist-ice-free   + konuk-free
             compute detist-ice-bebek   = detist-ice-bebek  + konuk-bebek
             compute detist-ice-tutar   = detist-ice-tutar  + konuk-icecek-tutar
          end-if.
          if konuk-extra-tutar not = 0
             compute detist-ext-oda     = detist-ext-oda    + 1
             compute detist-ext-buyuk   = detist-ext-buyuk  + konuk-buyuk
             compute detist-ext-kucuk   = detist-ext-kucuk  + konuk-kucuk 
             compute detist-ext-free    = detist-ext-free   + konuk-free
             compute detist-ext-bebek   = detist-ext-bebek  + konuk-bebek
             compute detist-ext-tutar   = detist-ext-tutar  + konuk-extra-tutar
          end-if.
          if konuk-extbed-tutar not = 0
             compute detist-exb-oda     = detist-exb-oda    + 1
             compute detist-exb-buyuk   = detist-exb-buyuk  + konuk-buyuk
             compute detist-exb-kucuk   = detist-exb-kucuk  + konuk-kucuk 
             compute detist-exb-free    = detist-exb-free   + konuk-free
             compute detist-exb-bebek   = detist-exb-bebek  + konuk-bebek
             compute detist-exb-tutar   = detist-exb-tutar  + konuk-extbed-tutar
          end-if.

          compute detist-sdt-oda(konuk-s-d-t-g) =
                  (konuk-s-d-t-g) + 1.
          compute detist-sdt-buyuk(konuk-s-d-t-g) =
                  detist-sdt-buyuk(konuk-s-d-t-g) + konuk-buyuk. 
          compute detist-sdt-kucuk(konuk-s-d-t-g) =
                  detist-sdt-kucuk(konuk-s-d-t-g) + konuk-kucuk. 
          compute detist-sdt-free(konuk-s-d-t-g) =
                  detist-sdt-free(konuk-s-d-t-g) + konuk-free. 
          compute detist-sdt-bebek(konuk-s-d-t-g) =
                  detist-sdt-bebek(konuk-s-d-t-g) + konuk-bebek.
          compute detist-sdt-tutar(konuk-s-d-t-g) =
                  detist-sdt-tutar(konuk-s-d-t-g) + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
************Complimentary bolumu......
          if ode-tipi = "D" 
             compute detist-com-oda     = detist-com-oda    + 1
             compute detist-com-buyuk   = detist-com-buyuk  + konuk-buyuk
             compute detist-com-kucuk   = detist-com-kucuk  + konuk-kucuk
             compute detist-com-free    = detist-com-free   + konuk-free  
             compute detist-com-bebek   = detist-com-bebek  + konuk-bebek 
             compute detist-com-tutar   = detist-com-tutar  + konuk-oda-tutar +
                 konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                 konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar
          end-if.
************House Use     bolumu......
          if ode-tipi = "F" 
             compute detist-hou-oda     = detist-hou-oda    + 1
             compute detist-hou-buyuk   = detist-hou-buyuk  + konuk-buyuk
             compute detist-hou-kucuk   = detist-hou-kucuk  + konuk-kucuk
             compute detist-hou-free    = detist-hou-free   + konuk-free  
             compute detist-hou-bebek   = detist-hou-bebek  + konuk-bebek 
             compute detist-hou-tutar   = detist-hou-tutar  + konuk-oda-tutar +
                 konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                 konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar
          end-if.
          rewrite detist-rec invalid 
                  write detist-rec 
                  end-write continue
          end-rewrite.
*******>Detist  Bolumu

        initialize turizm-rec.
        move takvim-anah       to turizm-tarih.   
        move konuk-ulke        to turizm-ulke. 
        read turizm   no lock invalid continue.

        compute Kalan-Oda   = kalan-oda   + 1. 
        compute kalan-buyuk = kalan-buyuk + konuk-buyuk. 
        compute kalan-kucuk = kalan-kucuk + konuk-kucuk. 
        compute kalan-free  = kalan-free  + konuk-free.  
        compute kalan-bebek = kalan-bebek + konuk-bebek. 

        if konuk-gel-tar = takvim-anah      
        compute gelen-oda   = gelen-oda   + 1
        compute gelen-buyuk = gelen-buyuk + konuk-buyuk
        compute gelen-kucuk = gelen-kucuk + konuk-kucuk 
        compute gelen-free  = gelen-free  + konuk-free  
        compute gelen-bebek = gelen-bebek + konuk-bebek. 

        compute turizm-toplam-tutar = turizm-toplam-tutar  + konuk-oda-tutar +
                 konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                 konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.


        rewrite turizm-rec invalid 
                write turizm-rec 
                end-write
        end-rewrite.
                 go cast-oku.  
 yeni-gun.
        go takvim-oku.
 transfer-bitti. 
     go his-son.  
 dfkdkdkdk.  
 basilan-bul. 
        initialize  konuk-oda-tutar       konuk-extra-tutar
                    konuk-kahvalti-tutar  konuk-ogle-tutar
                    konuk-aksam-tutar     konuk-icecek-tutar.
         move konuk-folio    to romhrk-folio.
         move takvim-anah    to romhrk-tarih.
         start romhrk key not < romhrk-anah1 
               invalid go basilan-bul-exit.
 basilan-oku. 
         read romhrk next no lock end 
              go basilan-bul-exit.
         if fs-romhrk = 99 go basilan-oku.
         if romhrk-tarih > takvim-anah 
            go basilan-bul-exit.
         if romhrk-folio not = konuk-folio 
            go basilan-bul-exit.


*/ CORRECTION
         perform correction-kontrol
*/ CORRECTION


         evaluate true 
          when pan-oda         = "X" and oda-dep      = romhrk-depkod
               compute konuk-oda-tutar      = 
                       konuk-oda-tutar + romhrk-tl-tutar
          when pan-kahvalti    = "X" and kahvalti-dep = romhrk-depkod
               compute konuk-kahvalti-tutar = 
                       konuk-kahvalti-tutar + romhrk-tl-tutar
          when pan-ogle        = "X" and ogle-dep     = romhrk-depkod
               compute konuk-ogle-tutar     = 
                       konuk-ogle-tutar     + romhrk-tl-tutar
          when pan-aksam       = "X" and aksam-dep    = romhrk-depkod
               compute konuk-aksam-tutar    = 
                       konuk-aksam-tutar    + romhrk-tl-tutar
          when pan-icecek      = "X" and icecek-dep   = romhrk-depkod
               compute konuk-icecek-tutar   = 
                       konuk-icecek-tutar   + romhrk-tl-tutar
          when pan-extra       = "X" and extra-dep    = romhrk-depkod
               compute konuk-extra-tutar    = 
                       konuk-extra-tutar    + romhrk-tl-tutar
         end-evaluate. 
              go basilan-oku.
 basilan-bul-exit. 
        exit.


 correction-kontrol.
         move romhrk-depkod     to depkod-kodu
         read depkod no lock invalid
              continue
         end-read
         if depkod-turu <> 2 or romhrk-corr-depkod = zeroes
            exit paragraph.

         move romhrk-corr-depkod    to depkod-kodu
         read depkod no lock invalid
              exit paragraph
         end-read

         evaluate true 
          when pan-oda         = "X" and oda-dep      = romhrk-corr-depkod
               compute corr-oda-tutar      = 
                       corr-oda-tutar + romhrk-tl-tutar
          when pan-kahvalti    = "X" and kahvalti-dep = romhrk-corr-depkod
               compute corr-kahvalti-tutar = 
                       corr-kahvalti-tutar + romhrk-tl-tutar
          when pan-ogle        = "X" and ogle-dep     = romhrk-corr-depkod
               compute corr-ogle-tutar     = 
                       corr-ogle-tutar     + romhrk-tl-tutar
          when pan-aksam       = "X" and aksam-dep    = romhrk-corr-depkod
               compute corr-aksam-tutar    = 
                       corr-aksam-tutar    + romhrk-tl-tutar
          when pan-icecek      = "X" and icecek-dep   = romhrk-corr-depkod
               compute corr-icecek-tutar   = 
                       corr-icecek-tutar   + romhrk-tl-tutar
          when pan-extra       = "X" and extra-dep    = romhrk-corr-depkod
               compute corr-extra-tutar    = 
                       corr-extra-tutar    + romhrk-tl-tutar
         end-evaluate. 



 his-son.
 his-islem-yap-exit.
      exit.
 devir-yap.
       open i-o onkasa.
       open input depkod takvim.
 tarih-kontrol.
    initialize degiskenler okuma-sayisi.
    initialize takvim-anah.
    start takvim key not < takvim-anah 
          invalid go son-1. 
 tarih-oku.  
    read takvim next no lock end 
         go tarih-kontrol-exit. 
    if fs-takvim = 99 go tarih-oku.  
       add 1 to okuma-sayisi.
     if okuma-sayisi = 1 go  devir-basla.
    initialize onkasa-rec.
    move takvim-anah   to onkasa-tarih.
    move 888           to onkasa-dep.   
    move bakiye-tl     to onkasa-tutar-tl.
    move bakiye-dv     to onkasa-tutar-dv.
    write onkasa-rec invalid 
          rewrite onkasa-rec 
          end-rewrite
    end-write. 
 devir-basla. 
    initialize onkasa-rec degiskenler
******** 888 dunden devir departmanidir..........
    move takvim-anah   to onkasa-tarih.
    move 888       to onkasa-dep.   
    read  onkasa no lock invalid 
          initialize onkasa-rec. 
        move onkasa-tutar-tl    to borc-tutar-tl.
        move onkasa-tutar-dv    to borc-tutar-dv.
    initialize onkasa-rec.
    move takvim-anah to onkasa-tarih.
    start onkasa key not < onkasa-anah 
          invalid go devir-bitti. 
 devir-oku.   
    read onkasa next no lock end go devir-bitti.
    if fs-onkasa = 99 go devir-oku.
    if onkasa-tarih > takvim-anah go devir-bitti.  
    if onkasa-tarih = takvim-anah 
       continue
    else 
       go devir-oku
    end-if. 
    if onkasa-dep   = 888 go devir-oku. 
    if onkasa-dep   = 999 go devir-oku. 
****if onkasa-tutar-tl = 0 and onkasa-tutar-dv = 0
****   delete onkasa invalid continue
       move onkasa-dep  to depkod-kodu. 
            read depkod no lock 
               invalid 
               display depkod-kodu "-bulamadim" 
                  move "B" to depkod-ba
                  move "Silinmis" to depkod-adi
                  write depkod-rec
              end-read . 
       if depkod-ba = "B" 
          compute borc-tutar-tl = borc-tutar-tl + onkasa-tutar-tl
          compute borc-tutar-dv = borc-tutar-dv + onkasa-tutar-dv.
       if depkod-ba = "A" 
          compute alac-tutar-tl = alac-tutar-tl + onkasa-tutar-tl
          compute alac-tutar-dv = alac-tutar-dv + onkasa-tutar-dv.
       go devir-oku.
 devir-bitti. 
    compute bakiye-tl  = borc-tutar-tl - alac-tutar-tl.
    compute bakiye-dv  = borc-tutar-dv - alac-tutar-dv.
******** 999 Yarina devir departmanidir..........
         initialize onkasa-rec.
    move takvim-anah to onkasa-tarih.
    move 999       to onkasa-dep.   
    move bakiye-tl      to onkasa-tutar-tl.
    move bakiye-dv      to onkasa-tutar-dv.
    write onkasa-rec invalid 
          rewrite onkasa-rec 
          end-rewrite
    end-write.
****move rapor-bit-tarih to onkasa-tarih.
****move 888       to onkasa-dep.   
****move bakiye-tl      to onkasa-tutar-tl.
****move bakiye-dv      to onkasa-tutar-dv.
****write onkasa-rec invalid rewrite onkasa-rec end-write. 
            go tarih-oku.
 tarih-kontrol-exit.
      exit.  
 krkrkrk.
          display message box "Devir Yapildi...Islem Tamam.".
           go devir-yap-exit.
 son-1.
          display message box "Devir Basarisiz.[ENTER].".

 devir-yap-exit.
       close onkasa.
       close depkod takvim.
       .
*
 loga-yaz.
********** PROGRAMA GIRIS LOGA GONDERILIYOR
               initialize call-alan1
                          call-alan2
                          call-alan3
                          call-alan4
                          call-alan5
                          call-alan6
               perform log-no-al
               move genelfis-log-no   to call-anah
               move "Tarih: "         to call-alan1
               move gun-tasi          to call-alan1(10:)
               move "/"               to call-alan1(12:)
               move ay-tasi           to call-alan1(13:)
               move "/"               to call-alan1(15:)
               move yil-tasi          to call-alan1(16:)
               move "Forecastlar Yeniden Olusturuldu...."    to call-alan2

               perform log-operation-calling               
         .
*
 aksiyon-yeniden-olustur.
         initialize aksiyon-rec.
         start aksiyon key > aksiyon-anah 
            invalid 
               continue
            not invalid
              perform until fs-aksiyon = "10"
                read aksiyon next no lock
                   at end
                      move "10" to fs-aksiyon
                   not at end
                      perform tek-aksiyon-yaz
                end-read
              end-perform
          end-start  .
*
 tek-aksiyon-yaz.
       
       initialize takvim-rec
       move aksiyon-g-tarih   to takvim-anah
       start takvim key not < takvim-anah invalid
               close aksiyhrk
               exit paragraph
         not invalid
               move zeroes to fs-takvim
          perform with test after until fs-takvim = "10"
           read takvim next no lock end move "10" to fs-takvim
           not at end
               if takvim-anah > aksiyon-c-tarih
                  
                  exit paragraph
               end-if

           move aksiyon-tipi     to aksiyhrk-tipi
           move aksiyon-acenta   to aksiyhrk-acenta
           move aksiyon-pan-tipi to aksiyhrk-pan-tipi
           move takvim-anah      to aksiyhrk-tarih
           move aksiyon-gecele   to aksiyhrk-gecele
           move aksiyon-ode      to aksiyhrk-ode 
           move aksiyon-sondan   to aksiyhrk-sondan 
           if aksiyon-tipi = "S"
              initialize aksiyhrk-gecele aksiyhrk-ode 
           end-if 
           write aksiyhrk-rec invalid 
                 rewrite aksiyhrk-rec
                end-rewrite continue
           end-write
           end-read

          end-perform
         end-start.
      
 acenhrk-isle.
         

        if rez-durumu not = "I" or rez-k-g-b not  = "K" 
           exit paragraph
        end-if.
        move rez-gir-tar to takvim-anah.
        start takvim key not < takvim-anah 
           invalid 
                continue
           not invalid
             perform until fs-takvim = "10"
                 read takvim next no lock 
                        end  move "10" to fs-takvim
                    not end 
                     if takvim-anah >= rez-cik-tar 
                       move "10" to fs-takvim
                       else
                        if rez-bilbord-eh = "E"
                             perform bilbord-isle thru bilbord-isle-exit
                        end-if
                           perform acenhrk-tek-gun
                      end-if
                   end-read
              end-perform
       end-start.


*
 acenhrk-tek-gun.
    
     move rez-acenta      to acenhrk-acenta  
     move takvim-anah     to acenhrk-tarih
     move rez-fiyat-konumu  to acenhrk-oda-konumu   
     move rez-s-d-t-g     to acenhrk-s-d-t-g   
     read acenhrk no lock 
         invalid 
              initialize acenhrk-sat-oda  acenhrk-sat-buyuk  
              acenhrk-sat-free acenhrk-sat-kucuk
              move 99999 to acenhrk-kontrat-oda
              compute  acenhrk-sat-oda   = acenhrk-sat-oda + 1  
              compute  acenhrk-sat-buyuk = acenhrk-sat-buyuk + rez-buyuk  
              compute  acenhrk-sat-kucuk = acenhrk-sat-kucuk + rez-kucuk  
              compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-free   
              compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-bebek   
              write acenhrk-rec 
                invalid display message box "Hata:acnhrkhhhh"
             end-write

         not invalid
             compute  acenhrk-sat-oda   = acenhrk-sat-oda + 1  
             compute  acenhrk-sat-buyuk = acenhrk-sat-buyuk + rez-buyuk  
             compute  acenhrk-sat-kucuk = acenhrk-sat-kucuk + rez-kucuk  
             compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-free   
             compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-bebek   
             rewrite acenhrk-rec 
                invalid display message box "Hata:acnhrkhhhh"
             end-rewrite
    end-read
       
         move rez-acenta      to acenhrk-acenta   
     move takvim-anah     to acenhrk-tarih 
     move 20  to acenhrk-oda-konumu   
     move rez-s-d-t-g     to acenhrk-s-d-t-g   
     read acenhrk no lock 
         invalid 
             initialize acenhrk-sat-oda  acenhrk-sat-buyuk  
              acenhrk-sat-free acenhrk-sat-kucuk
               move 99999 to acenhrk-kontrat-oda
              compute  acenhrk-sat-oda   = acenhrk-sat-oda + 1  
              compute  acenhrk-sat-buyuk = acenhrk-sat-buyuk + rez-buyuk  
              compute  acenhrk-sat-kucuk = acenhrk-sat-kucuk + rez-kucuk  
              compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-free   
              compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-bebek   
              write acenhrk-rec 
                invalid display message box "Hata:acnhrkhhhh"
             end-write

         not invalid
             compute  acenhrk-sat-oda   = acenhrk-sat-oda + 1  
             compute  acenhrk-sat-buyuk = acenhrk-sat-buyuk + rez-buyuk  
             compute  acenhrk-sat-kucuk = acenhrk-sat-kucuk + rez-kucuk  
             compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-free   
             compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-bebek   
             rewrite acenhrk-rec 
                invalid display message box "Hata:acnhrkhhhh"
             end-rewrite
    end-read
       
     move rez-acenta      to acenhrk-acenta   
     move takvim-anah     to acenhrk-tarih 
     move rez-fiyat-konumu  to acenhrk-oda-konumu   
     move 5     to acenhrk-s-d-t-g   
     read acenhrk no lock 
         invalid 
              initialize acenhrk-sat-oda  acenhrk-sat-buyuk  
              acenhrk-sat-free acenhrk-sat-kucuk
              move 99999 to acenhrk-kontrat-oda
              compute  acenhrk-sat-oda   = acenhrk-sat-oda + 1  
              compute  acenhrk-sat-buyuk = acenhrk-sat-buyuk + rez-buyuk  
              compute  acenhrk-sat-kucuk = acenhrk-sat-kucuk + rez-kucuk  
              compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-free   
              compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-bebek   
              write acenhrk-rec 
                invalid display message box "Hata:acnhrkhhhh"
             end-write

         not invalid
             
              compute  acenhrk-sat-oda   = acenhrk-sat-oda + 1  
             compute  acenhrk-sat-buyuk = acenhrk-sat-buyuk + rez-buyuk  
             compute  acenhrk-sat-kucuk = acenhrk-sat-kucuk + rez-kucuk  
             compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-free   
             compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-bebek   
             rewrite acenhrk-rec 
                invalid display message box "Hata:acnhrkhhhh"
             end-rewrite
    end-read   
     move rez-acenta      to acenhrk-acenta   
     move takvim-anah     to acenhrk-tarih 
     move 20  to acenhrk-oda-konumu   
     move 5     to acenhrk-s-d-t-g   
     read acenhrk no lock 
         invalid 
             initialize acenhrk-sat-oda  acenhrk-sat-buyuk  
              acenhrk-sat-free acenhrk-sat-kucuk
               move 99999 to acenhrk-kontrat-oda
              compute  acenhrk-sat-oda   = acenhrk-sat-oda + 1  
              compute  acenhrk-sat-buyuk = acenhrk-sat-buyuk + rez-buyuk  
              compute  acenhrk-sat-kucuk = acenhrk-sat-kucuk + rez-kucuk  
              compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-free   
              compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-bebek   
              write acenhrk-rec 
                invalid display message box "Hata:acnhrkhhhh"
             end-write

         not invalid
             compute  acenhrk-sat-oda   = acenhrk-sat-oda + 1  
             compute  acenhrk-sat-buyuk = acenhrk-sat-buyuk + rez-buyuk  
             compute  acenhrk-sat-kucuk = acenhrk-sat-kucuk + rez-kucuk  
             compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-free   
             compute  acenhrk-sat-free  = acenhrk-sat-free  + rez-bebek   
             rewrite acenhrk-rec 
                invalid display message box "Hata:acnhrkhhhh"
             end-rewrite
    end-read  
    .
*       
 ykontrat-isle.
      initialize kontrat-rec
  
    start kontrat key > kontrat-anah
      invalid 
        continue
      not invalid
         perform until fs-kontrat = "10"
             read kontrat next no lock 
               end move "10" to fs-kontrat
               not end
                 
                  perform tek-kont-yaz
                 
            end-read
         end-perform
    end-start
    .

*
 tek-kont-yaz.

     move kontrat-ilk-tarih    to takvim-anah
     start takvim key not < takvim-anah invalid
           continue
     not invalid
     perform with test after until fs-takvim = "10"
           read takvim next no lock end move "10" to fs-takvim
           not at end
                if takvim-anah > kontrat-Son-tarih
                   exit perform
                end-if
                perform varying i from 1 by 1 until i > 20
                     if i > son-konum and i < 20
                        exit perform cycle
                     end-if 
                        initialize acenhrk-rec
                        move kontrat-acenta          to acenhrk-acenta
                        move takvim-anah               to acenhrk-tarih
                        move kontrat-tipi               to acenhrk-s-d-t-g
                        move i                         to acenhrk-oda-konumu
                        read acenhrk no lock invalid continue end-read
                          
                        if kontrat-eksi = "-" then
                             subtract kontrat-oda(i)  from acenhrk-kontrat-oda
                            
                            else
                             add kontrat-oda(i)   to acenhrk-kontrat-oda
                            
                        end-if
                        compute acenhrk-kontrat-buyuk = 
                                            acenhrk-kontrat-oda * acenhrk-s-d-t-g
                        
                        write acenhrk-rec invalid
                              rewrite acenhrk-rec end-rewrite
                        end-write 
                end-perform
           end-read
     end-perform
     end-start.
     

*
 konuk-rez-kontrol.
        open i-o rez  konuk
               initialize rez-rec
               start rez key > rez-anah
                  not invalid
                     perform test after until fs-rez = "10"
                       read rez next no lock
                              end move "10" to fs-rez
                              not end
                                 if rez-folio = 0 then 
                                    move " " to REZ-C-IN
                                 end-if

                                   if rez-folio > 0 then
                                      move rez-folio to konuk-folio
                                      read konuk no lock 
                                         invalid
                                           
                                           initialize REZ-C-IN rez-folio
                                       end-read
                                    end-if


                                  accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
                                  accept rez-edit-zaman from time          |                           

                                        rewrite rez-rec invalid 
                                         continue
                                        end-rewrite
                              

                          end-read                     
                     end-perform   
                end-start  
                             close rez             konuk .
*


 
