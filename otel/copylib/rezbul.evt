* rezbul.evt
* rezbul.evt is generated from D:\asya\acugt.ytl\otel\rezbul.Psf
* This is a generated file. DO NOT modify this file directly.


 Form1-Event-Proc.
     .

 Form1-Exception-Proc.
     PERFORM Form1-Ex-Other
     .

 combo-rapor-baslik-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM combo-rapor-baslik-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1a-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1a-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaaaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaaaaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form1-Cb-1aaaaaaa-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Cmd-Clicked
           PERFORM Form1-Cb-1aaaaaaa-Ex-Cmd-Clicked
        END-EVALUATE
     END-IF
     .

 Form2-Event-Proc.
     .

 Form2-Exception-Proc.
     PERFORM Form2-Ex-Other
     .

 combo-toplamlar-Exception-Proc.
* 
     IF Event-Occurred
        EVALUATE Event-Type
        WHEN Ntf-Selchange
           PERFORM combo-toplamlar-Ex-Ntf-Selchange
        END-EVALUATE
     END-IF
     .

 Form3-Event-Proc.
     .

 Form3-Exception-Proc.
     PERFORM Form3-Ex-Other
     .

 Form3-Gd-1-Event-Proc.
     PERFORM Form3-Gd-1-Ev-Other
     .

 Form4-Event-Proc.
     .

 Form4-Gd-1-Event-Proc.
* 
     EVALUATE Event-Type
     WHEN Msg-Begin-Entry
        PERFORM Form4-Gd-1-Ev-Msg-Begin-Entry
     END-EVALUATE
     .

 Form5-Event-Proc.
     .

 Form6-Event-Proc.
     .

 Form6-Exception-Proc.
     PERFORM Form6-Ex-Other
     .

 Form6-Gd-1-Event-Proc.
     PERFORM Form6-Gd-1-Ev-Other
     .

 Form7-Event-Proc.
     .

 Form7-Exception-Proc.
     PERFORM Form7-Ex-Other
     .
***   start event editor code   ***
* 1-Check box rapordan deger geldigi zaman renk ve
*   disable enable
* 2-duzenle'de silme'de hata var ...
****************************************************
 Form1-Bef-Create.
     perform adresleri-tasi.
     open input genel odalar2
     move 1 to genel-anahtar
     read genel no lock invalid continue
          not invalid continue
     end-read
     close genel.
     move tarih-tasi       to bas-islem-tarih
                              bit-islem-tarih
                              bas-cin-tarih
                              bit-cin-tarih
                              bas-cout-tarih
                              bit-cout-tarih.
*
 Form1-Cb-1-Ex-Cmd-Clicked.
     display acc-bas-numara acc-bit-numara.
     if ilk-secilen = zeroes
        move 1 to ilk-secilen
        perform cb-renklendir
     else 
        if numara-eh = 0
           if ilk-secilen = 1
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.
*
 Form1-Cb-1a-Ex-Cmd-Clicked.
     display acc-bas-islem-gun acc-bas-islem-ay acc-bas-islem-yil
             acc-bit-islem-gun acc-bit-islem-ay acc-bit-islem-yil.
     if ilk-secilen = zeroes
        move 2 to ilk-secilen
        perform cb-renklendir
     else 
        if islem-tarih-eh = 0
           if ilk-secilen = 2
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aa-Ex-Cmd-Clicked.
     display acc-bas-acenta acc-bit-acenta.
     if ilk-secilen = zeroes
        move 3 to ilk-secilen
        perform cb-renklendir
     else 
        if acenta-eh = 0
           if ilk-secilen = 3
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aaa-Ex-Cmd-Clicked.
     display acc-bas-musteri-adi acc-bit-musteri-adi.
     if ilk-secilen = zeroes
        move 4 to ilk-secilen
        perform cb-renklendir
     else 
        if musteri-adi-eh = 0
           if ilk-secilen = 4
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aaaa-Ex-Cmd-Clicked.
     display acc-bas-musteri-soy acc-bit-musteri-soy.
     if ilk-secilen = zeroes
        move 5 to ilk-secilen
        perform cb-renklendir
     else 
        if musteri-soyadi-eh = 0
           if ilk-secilen = 5
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aaaaa-Ex-Cmd-Clicked.
     display acc-bas-cin-gun acc-bas-cin-ay acc-bas-cin-yil
             acc-bit-cin-gun acc-bit-cin-ay acc-bit-cin-yil.
     if ilk-secilen = zeroes
        move 6 to ilk-secilen
        perform cb-renklendir
     else 
        if c-in-tarih-eh = 0
           if ilk-secilen = 6
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aaaaaa-Ex-Cmd-Clicked.
     display acc-bas-cout-gun acc-bas-cout-ay acc-bas-cout-yil
             acc-bit-cout-gun acc-bit-cout-ay acc-bit-cout-yil.
     if ilk-secilen = zeroes
        move 7 to ilk-secilen
        perform cb-renklendir
     else 
        if c-out-tarih-eh = 0
           if ilk-secilen = 7
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Cb-1aaaaaaa-Ex-Cmd-Clicked.
     display acc-bas-voucher acc-bit-voucher.
     if ilk-secilen = zeroes
        move 8 to ilk-secilen
        perform cb-renklendir
     else 
        if voucher-eh = 0
           if ilk-secilen = 8
              move 99 to ilk-secilen
              perform cb-renklendir
           end-if
        end-if
     end-if.

*
 Form1-Ex-Other.
     if key-status = 1
        perform yardimlar
     end-if      
     if key-status = 2001
        perform acu-form2-routine
        exit paragraph
     end-if.

     if key-status = 2 or key-status = 2003 or key-status = 2 or key-status = 7 or
        key-status = 2004
        continue
     else
        exit paragraph
     end-if.
     if key-status = 2004
        perform acu-form6-routine
        exit paragraph
     end-if.

     if numara-eh = 0 and islem-tarih-eh = 0 and
        acenta-eh = 0 and musteri-adi-eh = 0 and
        musteri-soyadi-eh = 0 and c-in-tarih-eh = 0 and
        c-out-tarih-eh = 0 and voucher-eh = 0
            display message box 
                    "Raporu alabilmeniz icin ana secimlerden birini secmek zorundasiniz !!!"
                    icon mb_warning_icon
                    title "Uyari"
                    move 4 to accept-control
                    move 12 to control-id
                    exit paragraph
     end-if.

     perform Acc-Bit-Numara-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 21 to control-id
        exit paragraph.

     perform Acc-Bas-Islem-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 22 to control-id
        exit paragraph.

     perform Acc-Bit-Islem-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 25 to control-id
        exit paragraph.

     perform Acc-Bas-Acenta-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 28 to control-id
        exit paragraph.

     perform Acc-Bit-Acenta-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 29 to control-id
        exit paragraph.

     perform Acc-Bit-Musteri-Adi-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 31 to control-id
        exit paragraph.

     perform Acc-Bit-Musteri-Soy-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 33 to control-id
        exit paragraph.

     perform Acc-Bas-Cin-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 34 to control-id
        exit paragraph.

     perform Acc-Bit-Cin-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 37 to control-id
        exit paragraph.

     perform Acc-Bas-Cout-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 40 to control-id
        exit paragraph.

     perform Acc-Bit-Cout-Yil-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 43 to control-id
        exit paragraph.

     perform Acc-Bit-Voucher-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 47 to control-id
        exit paragraph.

     perform Acc-Bas-Banka-Kodu-Aft-Procedure.
     if gec-gecme = 1  
        move 4 to accept-control
        move 54 to control-id
        exit paragraph.

     perform Acc-Bas-Doviz-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 58 to control-id
        exit paragraph.

     perform Acc-Bas-Anlasma-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 62 to control-id
        exit paragraph.

     perform Acc-Bas-Odeme-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 66 to control-id
        exit paragraph.

     perform Acc-Bas-Ulke-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 74 to control-id
        exit paragraph.
     perform acc-bas-kaynak1-kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4   to accept-control
        move 105 to control-id
        exit paragraph.
     perform acc-bas-kaynak2-kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4   to accept-control
        move 109 to control-id
        exit paragraph.
     perform acc-bas-kaynak3-kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4   to accept-control
        move 113 to control-id
        exit paragraph.
         
     perform Acc-Bas-Pazar-Kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 82 to control-id
        exit paragraph.
     perform acc-bas-ozel-durum-kodu-Aft-Procedure.
     if gec-gecme = 1 
        move 4 to accept-control
        move 119 to control-id
        exit paragraph.

     perform Acc-Bas-Pansiyon-Kodu-Aft-Procedure.
     if gec-gecme = 1
        move 0 to gayriresmi
        move 4 to accept-control
        move 70 to control-id
        exit paragraph.
       if key-status = 2 or key-status = 7 then 
            move 2 to rapor-sekil 
            if key-status = 7 then 
                  move 1 to gayriresmi 
               else
                  move 0 to gayriresmi
             end-if
        else
             move key-status to rapor-sekil
         end-if.
     if dosya-yok = 1
         open i-o genelfis
         initialize genelfis-rec
         move 1 to genelfis-anahtar
         read genelfis no lock invalid
              continue 
         not invalid 
               add 1 to print-no
               rewrite genelfis-rec end-rewrite 
         end-read
         close genelfis
         open output takdosya close takdosya open i-o takdosya
         perform pdf-dosya-bul
         close takdosya
     end-if
     if dokumere-yolla 
        perform dokumer-islem
     else
        perform duzenle-islem
     end-if.
     initialize esleme-i.

     exit paragraph.
*
 pdf-dosya-bul.
     move all low-values to sildir
     string sildir,
            "/asya/ytl/data/otel/bmp" delimited by low-values
            into sildir.
            
     call "c$list-directory" using 
                             listdir-open, 
                             sildir,
                             "*". 
    move return-code to sildir-handle.
    if sildir-handle = 0
       destroy Form1-Handle
       goback
    end-if.

    initialize sildir-filename

    perform with test after until sildir-filename = spaces
            call "c$list-directory" using 
                                    listdir-next, 
                                    sildir-handle, 
                                    sildir-filename,
                                    listdir-file-information
            if sildir-filename <> spaces and 
               listdir-file-type-regular-file
               

                
                initialize takdosya-rec 
                unstring sildir-filename delimited by "."                                 
                    into takdosya-rez-no pdf-uzanti
                  read takdosya no lock invalid 
                      continue 
                  end-read 
                  write takdosya-rec invalid 
                     rewrite takdosya-rec end-rewrite
                  end-write 
              


                   
            end-if
    end-perform.

    call "c$list-directory" using 
                            listdir-close,
                            sildir-handle.
*
 Form1-Aft-Initdata.
     initialize degiskenler degiskenler-1.
     modify combo-rezervasyon-turu, reset-list = 1
                                    mass-update = 1
     modify combo-musteri-turu,     reset-list = 1
                                    mass-update = 1
     modify combo-rezervasyon-durumu, reset-list = 1
                                      mass-update = 1
     modify combo-kur-tipi,         reset-list = 1
                                    mass-update = 1
     modify combo-rapor-baslik      reset-list = 1 
                                    mass-update = 1

     modify combo-rezervasyon-turu,
     item-to-add("0-Hepsi","1-Alotment","2-It","3-Fit","4-Grup")
     modify combo-rezervasyon-turu,
     item-to-add("5-Munferit","6-Walk-in","7-Sirket/Firma","8-Ozel")
     move "0-Hepsi" to combo-rezervasyon-turu-value

     modify combo-musteri-turu,
     item-to-add("N-Normal","B-Balayi",
     "G->Gu.Repeat", "V-Vip","1->V.I.P1","2->V.I.P2", "3->V.I.P3",
      "T-Top Vip", "H-Hepsi")
     move "N-Normal" to combo-musteri-turu-value

     modify combo-rezervasyon-durumu,
     item-to-add("I-Icerdeki","S-Silinmis ")
     move "I-Icerdeki" to combo-rezervasyon-durumu-value.

     modify combo-kur-tipi,
     item-to-add("H-Hepsi","G-Gunluk","A-Aybasi")
     move "H-Hepsi" to combo-kur-tipi-value

*/ form2 => degiskenleri
     move "0-Hepsi" to combo-oda-tipi-value
     move "00-Hepsi" to combo-oda-konumu-value
        move "00-Hepsi" to combo-fiyat-konumu-value

     move "00-Degistirme" to combo-oda-konumu-value-a
     move "H-Hepsi" to combo-rezervasyon-k-w-value
     move "Hepsi"   to combo-kullanici-kodu-value
     move 1         to cin-rezler-ciksin 
     move 0         to eb-rezler-ciksin
     move 0         to eb-de-aksiyon-hesaplama
     move "A-Toplamsiz"  to combo-toplamlar-value

*/ Raporlarin isimleri aliniyor ...
     open input rapor.
     initialize rapor-rec
     move "A"         to rapor-tipi
     start rapor key not < rapor-anahtar invalid
           continue
     not invalid
     initialize fs-rapor i
     perform with test after until fs-rapor = "10"
     read rapor next no lock end move "10" to fs-rapor
     not at end
          if rapor-tipi = "A" 
             initialize rapor-baslik
             move rapor-no       to rapor-baslik
             move "-"            to rapor-baslik(5:)
             move rapor-adi      to rapor-baslik(6:)
             add 1 to i
             if i = 1 
                move rapor-baslik to gecici-rapor-baslik
             end-if
             modify combo-rapor-baslik,
                    item-to-add(rapor-baslik)
          else
             move "10" to fs-rapor
             exit perform
          end-if
     end-read
     end-perform
     end-start
     close rapor.

     modify combo-rezervasyon-turu, mass-update = 0
                                    value combo-rezervasyon-turu-value
     modify combo-musteri-turu,     mass-update = 0
                                    value combo-musteri-turu-value
     modify combo-rezervasyon-durumu,mass-update = 0 
                                    value combo-rezervasyon-durumu-value
     modify combo-kur-tipi,         mass-update = 0
                                    value combo-kur-tipi-value.
     modify combo-oda-tipi,         mass-update = 0
                                    value combo-oda-tipi-value.
     modify combo-rapor-baslik      mass-update = 0
                                    value gecici-rapor-baslik.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 acc-bit-numara-Aft-Procedure.
     initialize gec-gecme
     if numara-eh = 0 
        exit paragraph.
     if bas-numara <> 0 and bit-numara <> 0
        if bas-numara > bit-numara 
           move 1 to gec-gecme
           exit paragraph
        end-if
     end-if.
     .
*
 acc-bas-islem-yil-Aft-Procedure.
     initialize gec-gecme.
     if islem-tarih-eh = 0
        exit paragraph.
     if bas-islem-tarih <> 0
        open input takvim
        move bas-islem-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.
*
 acc-bit-islem-yil-Aft-Procedure.
     initialize gec-gecme.
     if islem-tarih-eh = 0
        exit paragraph.
     if bit-islem-tarih <> 0
        open input takvim
        move bit-islem-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.

     if bas-islem-tarih <> 0 and bit-islem-tarih <> 0
        if bas-islem-tarih > bit-islem-tarih
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-acenta-Aft-Procedure.
     initialize gec-gecme.
     if acenta-eh = 0
        exit paragraph.

     if bas-acenta <> spaces
        open input acenta 
        move bas-acenta  to acenta-kodu
        read acenta no lock invalid 
             move "Tanimsiz" to acenta-adi
             move 1 to gec-gecme
        end-read
        close acenta
     else
        move "Tumu ... " to acenta-adi
     end-if.
     display lb-bas-acenta-adi.
*
 acc-bit-acenta-Aft-Procedure.
     initialize gec-gecme.
     if acenta-eh = 0
        exit paragraph.

     if bit-acenta = spaces
        move "Tumu ..." to acenta-adi
        display lb-bit-acenta-adi
        exit paragraph.

     open input acenta
     move bit-acenta to acenta-kodu
     read acenta no lock invalid
          move "Tanimsiz ..."  to acenta-adi
          move 1 to gec-gecme
     end-read
     close acenta.
     display lb-bit-acenta-adi.

     if bas-acenta <> spaces and bit-acenta <> spaces
        if bas-acenta > bit-acenta
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-degis-acenta-Aft-Procedure.
     if degis-acenta <> spaces
        open input acenta 
        move degis-acenta  to acenta-kodu
        read acenta no lock invalid 
             move "Tanimsiz" to acenta-adi
             move 4 to accept-control
             move 28 to control-id
             display lb-degis-acenta-adi
        end-read
        close acenta
     else
        move "Degistirme ... " to acenta-adi
     end-if.
     display lb-degis-acenta-adi.
*
 acc-bit-musteri-adi-Aft-Procedure.
     initialize gec-gecme.
     if musteri-adi-eh = 0
        exit paragraph.
     if bas-musteri-adi <> spaces and bit-musteri-adi <> spaces
        if bas-musteri-adi > bit-musteri-adi
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bit-musteri-soy-Aft-Procedure.
     initialize gec-gecme.
     if musteri-soyadi-eh = 0 
        exit paragraph.
     if bas-musteri-soy <> spaces and bit-musteri-soy <> spaces
        if bas-musteri-soy > bit-musteri-soy
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-cin-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-in-tarih-eh = 0
        exit paragraph.
     if bas-cin-tarih <> 0
        open input takvim
        move bas-cin-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.
*
 acc-bit-cin-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-in-tarih-eh = 0
        exit paragraph.
     if bit-cin-tarih <> 0
        open input takvim
        move bit-cin-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.

     if bas-cin-tarih <> 0 and bas-cin-tarih <> 0
        if bas-cin-tarih > bit-cin-tarih
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-cout-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-out-tarih-eh = 0
        exit paragraph.
     if bas-cout-tarih <> 0
        open input takvim
        move bas-cout-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.
*
 acc-bit-cout-yil-Aft-Procedure.
     initialize gec-gecme.
     if c-out-tarih-eh = 0
        exit paragraph.
     if bit-cout-tarih <> 0
        open input takvim
        move bit-cout-tarih      to takvim-anah
        read takvim no lock invalid
             move 1 to gec-gecme
        end-read
        close takvim
     end-if.

     if bas-cout-tarih <> 0 and bas-cout-tarih <> 0
        if bas-cout-tarih > bit-cout-tarih
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bit-voucher-Aft-Procedure.
     initialize gec-gecme.
     if voucher-eh = 0 
        exit paragraph.
     if bas-voucher <> 0 and bit-voucher <> 0
        if bas-voucher > bit-voucher
           move 1 to gec-gecme
        end-if
     end-if.
*
 acc-bas-banka-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-banka-kodu <> 0
        open input banka
        move bas-banka-kodu   to banka-kodu
        read banka no lock invalid
             move 1 to gec-gecme
             move "Tanimsiz ..." to banka-adi
        end-read
        close banka
     else
        move "Tumu ..."  to banka-adi
     end-if.
     display lb-banka-adi.
*
 acc-bas-doviz-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-doviz-kodu <> 0
        open input doviz
        move bas-doviz-kodu   to doviz-kodu
        read doviz no lock invalid
             move 1 to gec-gecme
             move "Tanimsiz ..."  to d-adi-1
        end-read
        close doviz
     else
        move "Tumu ..." to d-adi-1
     end-if.
     display lb-doviz-adi.
*
 acc-bas-anlasma-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-anlasma-kodu <> spaces
        open input kodlar02
        move "D"              to kodlar02-tipi
        move bas-anlasma-kodu to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-anlasma-adi.
*
 acc-bas-odeme-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-odeme-kodu <> spaces
        open input kodlar02
        move "B"              to kodlar02-tipi
        move bas-odeme-kodu   to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-odeme-adi.
*
 acc-bas-kaynak1-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-kaynak1-kodu <> spaces 
        open input onbkodlar10
        initialize onbkodlar10-rec
        move "AB"                to onbkodlar10-tipi
        move bas-kaynak1-kodu    to onbkodlar10-kodu1
        read onbkodlar10 no lock invalid
             move "Tanimsiz ..." to onbkodlar10-adi
             move 1 to gec-gecme
        end-read
        close onbkodlar10
     else
        move "Tumu ..."       to onbkodlar10-adi
     end-if.
     display lb-kaynak1-adi.
*
 acc-bas-kaynak2-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-kaynak2-kodu <> spaces 
        open input onbkodlar10
        initialize onbkodlar10-rec
        move "AC"                to onbkodlar10-tipi
        move bas-kaynak2-kodu    to onbkodlar10-kodu1
        read onbkodlar10 no lock invalid
             move "Tanimsiz ..." to onbkodlar10-adi
             move 1 to gec-gecme
        end-read
        close onbkodlar10
     else
        move "Tumu ..."       to onbkodlar10-adi
     end-if.
     display lb-kaynak2-adi.
*
 acc-bas-kaynak3-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-kaynak3-kodu <> spaces 
        open input onbkodlar10
        initialize onbkodlar10-rec
        move "AD"                to onbkodlar10-tipi
        move bas-kaynak3-kodu    to onbkodlar10-kodu1
        read onbkodlar10 no lock invalid
             move "Tanimsiz ..." to onbkodlar10-adi
             move 1 to gec-gecme
        end-read
        close onbkodlar10
     else
        move "Tumu ..."       to onbkodlar10-adi
     end-if.
     display lb-kaynak3-adi.
*
 acc-bas-ulke-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-ulke-kodu <> spaces
        open input ulke
        move bas-ulke-kodu   to ulke-anah
        read ulke no lock invalid
             move "Tanimsiz ..." to ulke-adi
             move 1 to gec-gecme
        end-read
        close ulke
     else
        move "Tumu ..." to ulke-adi
     end-if.
     display lb-ulke-adi.
*
 acc-bas-pazar-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-pazar-kodu <> spaces 
        open input kodlar02
        move "E"              to kodlar02-tipi
        move bas-pazar-kodu   to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-pazar-adi.
*
 acc-bas-pansiyon-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-pansiyon-kodu <> spaces
        open input kodlar02
        move "A"                 to kodlar02-tipi
        move bas-pansiyon-kodu   to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-pansiyon-adi.
     .
*
 Form2-Aft-Initdata.
     modify combo-oda-tipi,          reset-list = 1 mass-update = 1.
     modify combo-oda-konumu,        reset-list = 1 mass-update = 1.
     modify combo-rezervasyon-e-b,   reset-list = 1 mass-update = 1.
     modify combo-rezervasyon-k-w,   reset-list = 1 mass-update = 1.
     modify combo-kullanici-kodu,    reset-list = 1 mass-update = 1.
     modify combo-toplamlar,         reset-list = 1 mass-update = 1.
     modify combo-oda-tipi,
     item-to-add("0-Hepsi","1-Single","2-Double","3-Double","4-Triple")
     modify combo-oda-konumu,
     item-to-add("00-Hepsi")
      modify combo-fiyat-konumu,
     item-to-add("00-Hepsi")
     modify combo-rezervasyon-e-b,
     item-to-add("0-Dahil","1-Sadece","2-Cikmasin")
     modify combo-rezervasyon-k-w,
     item-to-add("H-Hepsi","K-Konfirme","B-Beklemede","O-InFox")
     modify combo-kullanici-kodu,
     item-to-add("Hepsi").
     modify combo-toplamlar,
     item-to-add("A-Toplamsiz","B-Pazar","C-Pansiyon","D-Ulke","E-Anlasma")
     modify combo-toplamlar,
     item-to-add("F-Oda tipi","G-Oda konumu","H-Odeme kodu","I-Doviz kodu")
     modify combo-toplamlar,
     item-to-add("J-Erken rezervasyon","K-Acenta")

     open input konum
     initialize konum-rec
     start konum key not < konum-anahtar invalid
           continue
     not invalid
     initialize fs-konum
     perform with test after until fs-konum = "10"
     read konum next no lock end move "10" to fs-konum
     not at end
          initialize temp-x
          move konum-anahtar to temp-x
          move "-"           to temp-x(3:)
          move konum-adi     to temp-x(4:)
          modify combo-oda-konumu,
                 item-to-add(temp-x)
          modify combo-fiyat-konumu,
                 item-to-add(temp-x)
     end-read
     end-perform
     end-start
     close konum.

     move combo-kullanici-kodu-value to temp-x-50
     open input kllnc
     initialize kllnc-rec
     start kllnc key not < k-kodu invalid
           continue
     not invalid
     initialize fs-kllnc
     perform with test after until fs-kllnc = "10"
     read kllnc next no lock end move "10" to fs-kllnc
     not at end
          initialize combo-kullanici-kodu-value
          string k-adi delimited by space
                 " "   delimited by size 
                 k-soyadi delimited by size 
                 into combo-kullanici-adi
          move k-kodu          to combo-kullanici-no
          modify combo-kullanici-kodu,
                 item-to-add(combo-kullanici-kodu-value)
     end-read
     end-perform
     end-start
     close kllnc.
     move temp-x-50  to combo-kullanici-kodu-value

     modify combo-oda-tipi,     mass-update = 0
                                value combo-oda-tipi-value.
     modify combo-oda-konumu,   mass-update = 0
                                value combo-oda-konumu-value.
     modify combo-fiyat-konumu,   mass-update = 0
                                value combo-fiyat-konumu-value.
     modify combo-rezervasyon-k-w,   mass-update = 0
                                value combo-rezervasyon-k-w-value.
     modify combo-rezervasyon-e-b,   mass-update = 0
                                value eb-rezler-ciksin
     modify combo-kullanici-kodu,   mass-update = 0
                                 value combo-kullanici-kodu-value.
     modify combo-toplamlar     ,   mass-update = 0
                                 value combo-toplamlar-value.

     if combo-toplamlar-value(1:1) = "A"
        modify form2-pb-2,enabled = false
     else
        modify form2-pb-2,enabled = true
     end-if.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         

 dokumer-islem.
     initialize genel-share 
     open i-o genelfis takdosya.
     move 1 to genelfis-anahtar.
     read genelfis no lock invalid
          accept print-no from time
     end-read
     add 1 to print-no
     rewrite genelfis-rec invalid continue end-rewrite
     close genelfis.
**************************
     initialize dokumer-rec dokumer-anah dokumer-ozellikler-rec
                dokumer-dosya

     set  dokumer-asya-set to true
     move print-no         to dokumer-dosya-adi
     open output dokumer
*/WINDOW TITLE
     initialize dokumer-rec detay
     move "W"                  to det-dokumer-20(1:)
     move rapor-baslik   to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR
     initialize dokumer-rec detay
     move "1"            to det-dokumer-20(10:1)
     move "B"            to det-dokumer-20(1:1)
     move rapor-baslik   to det-filler
     write dokumer-rec from detay


     initialize dokumer-rec detay
     move "B"                  to det-dokumer-20(1:1)
     write dokumer-rec from detay


*/ DOKUMER OZELLIKLER-REC
     initialize dokumer-rec detay
     move "O" to det-dokumer-20(1:)
     move "E" to dokumer-oto-sayfa-basi
     move 56  to dokumer-oto-sayfa-satir
     move "|" to dokumer-detay-kolon-ayirici
     move "LLLLRRRRLLLLLLLLLLLLRRRRRLLLLLLRLRRLLLLLLLLLLLLLLLLLL" to dokumer-align-occ
     move dokumer-ozellikler-rec     to det-filler
     write dokumer-rec from detay
*/ BASLIKLAR  

     initialize dokumer-rec detay 
     move "1"          to det-dokumer-20(10:1)
     move "D1"         to det-dokumer-20(1:2)
     move "Rez.no"            to det-1
     move "#"                 to det-1-1
     move "Adi"               to det-2
     move "Soyadi"            to det-3
     move "Pax"               to det-4
     move "Chi"               to det-5
     move "Free"              to det-6
     move "Beb."              to det-66
     move "C/in"              to det-7
     move "C/out"             to det-8
     move "Rez.T"             to det-9
     move "Odeme"             to det-10
     move "A.Ko"              to det-10-10
     move "Acenta"            to det-11
     move "Sirket"            to det-fir
     move "Ulke"              to det-12
     move "Voucher"           to det-13
     move "Anlas"             to det-14
     move "Bn"                to det-15
     move "Dv"                to det-16
     move "Doviz Adi"         to det-16-1
     move "Rez.Fiyati"        to det-17
     move "Gun"               to det-18
     move "Eski Rez.Fiyati"   to det-19
     move "Toplam Rez.Fiyati" to det-19-1
     move "Pazar"            to det-20
     move "X"                to det-21
     move "Pk"               to det-22
     move "K"                to det-23
     move "FKonum"            to det-24
     move "OKonum"            to det-24-1
     move "Tip"              to det-25
     move "Oda"              to det-26
     move "Grup"             to det-27
     move "IO"               to det-28
     move "KO"               to det-29
     move "Staff"            to det-30
     move "F"                to det-31
     move "Rez Al Tar"       to det-32
     move "Notlar-I"         to det-33
     move "Notlar-II"        to det-34
     move "Banka Siparis No" to det-35
     move "Kaynak-I"         to det-36
     move "Kaynak-II"        to det-37
     move "Kaynak-III"       to det-38
     move "|" to fil-1 fil-1-1 fil-2 fil-3 fil-4
     fil-5 fil-6 fil-66 fil-7 fil-8 fil-9 fil-10 fil-10-10 fil-11
     fil-12 fil-13 fil-14 fil-15 fil-16 fil-17 fil-16-1
     fil-18 fil-19 fil-20 fil-21 fil-22 fil-23
     fil-24 fil-25 fil-26 fil-27 fil-28 fil-29 fil-35
     fil-30 fil-31 fil-33 fil-34 fil-19-1 fil-fir fil-32  fil-24-1
     fil-36 fil-37 fil-38 
     write dokumer-rec from detay

     initialize dokumer-rec detay
     move "D2"           to det-dokumer-20(1:2)
     move "-"            to det-dokumer-20(5:1)
     move all "-" to det-1 det-1-1 det-2 det-3 det-4
     det-5 det-6 det-66 det-7 det-8 det-9 det-10 det-10-10 det-11
     det-12 det-13 det-14 det-15 det-16 det-17 det-16-1
     det-18 det-19 det-20 det-21 det-22 det-23
     det-24 det-25 det-26 det-27 det-28 det-29 det-35
     det-30 det-31 det-19-1 det-fir det-32 det-33 det-34 det-24-1
     det-36 det-37 det-38
     write dokumer-rec from detay
*********************************
     perform islem.
     close dokumer takas takdosya
     call dokumer-prog on exception
          perform callerr-proc
     not on exception
          cancel dokumer-prog
     end-call
     delete file dokumer takas takdosya.
*
 duzenle-islem.
     perform acu-form3-routine.
     close takas
     delete file takas.

 islem.
     initialize toplam
     open i-o genelfis.
     move 1 to genelfis-anahtar
     read genelfis no lock invalid
          move 1 to ekran-fis-1
     end-read
     add 1 to ekran-fis-1
     rewrite genelfis-rec invalid
             write genelfis-rec end-write
     end-rewrite
     close genelfis.

     move ekran-fis-1(2:)     to takas-no
     open output takas close takas open i-o takas with mass-update.
                   
     open input rez  yanrez cast kodlar02 acenta ulke konum kllnc
                fiyat fiyatana aksiyhrk firma ODALAR grup onbkodlar10 doviz.
        open i-o rezweb
     initialize rez-rec fs-rez  top-gece
     move combo-rezervasyon-durumu-value(1:1)  to rez-durumu
     evaluate true
          when ilk-secilen = 1
**********               stop "aaa"
               move bas-numara to rez-anah
               start rez key not < rez-anah invalid
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 2   

                   move bas-islem-tarih   to rez-isl-tar
                   initialize rez-isl-tar 
                   start rez key not < rez-isl invalid
                         move "89" to fs-rez
                   end-start

          when ilk-secilen = 3 
               move bas-acenta to rez-acenta 
               start rez key not < rez-acen invalid
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 4
               move bas-musteri-adi to rez-adi
               start rez key not < rez-ad invalid 
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 5
               move bas-musteri-soy to rez-soyadi
               start rez key not < rez-soy invalid 
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 6
               move bas-cin-tarih to rez-gir-tar
               start rez key not < rez-gir invalid 
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 7
               move bas-cout-tarih to rez-cik-tar
               start rez key not < rez-cik invalid 
                     move "89" to fs-rez
               end-start
          when ilk-secilen = 8
               move bas-voucher    to rez-voucher
               start rez key not < rez-vouc invalid 
                     move "89" to fs-rez
               end-start
     end-evaluate.

     if fs-rez = "89"
           display message box
                   "Kayit bulunamadi ..."
           close rez yanrez cast kodlar02 acenta ulke konum kllnc
                fiyat fiyatana aksiyhrk firma ODALAR grup rezweb doviz
***                takas
****           delete file takas
           exit paragraph.

     initialize fs-rez
     perform with test after until fs-rez = "10"
     read rez next no lock end move "10" to fs-rez
     not at end
          if onkpara-referans-var = 1 then 
             perform ref-filtre
             if  not ref-gecti then 
               exit perform cycle
             end-if
          end-if
          
             if combo-rezervasyon-durumu-value(1:1) <> rez-durumu
                exit perform cycle
             end-if

          if ilk-secilen not = 01 
             if combo-rezervasyon-durumu-value(1:1) <> rez-durumu
                move "10" to fs-rez
                exit perform
             end-if
          end-if 
          if ilk-secilen = 01 and bit-numara not = 0
             if rez-anah > bit-numara 
                move "10" to fs-rez
                exit perform
             end-if
          end-if
          if ilk-secilen = 02 and bit-islem-tarih not = 0
*             if rez-isl-tar > bit-islem-tarih
*                move "10" to fs-rez
*                exit perform
*             end-if
               continue
          end-if
          if ilk-secilen = 03 and bit-acenta not = spaces
             if rez-acenta > bit-acenta
                move "10" to fs-rez
                exit perform 
             end-if
          end-if
          if ilk-secilen = 04 and bit-musteri-adi not = spaces
             if rez-adi > bit-musteri-adi
                move "10" to fs-rez
                exit perform


             end-if
          end-if
          if ilk-secilen = 05 and bit-musteri-soy not = spaces
             if rez-soyadi > bit-musteri-soy
                move "10" to fs-rez
                exit perform
             end-if
          end-if
          if ilk-secilen = 06 and bit-cin-tarih not = 0
             if rez-gir-tar > bit-cin-tarih
                move "10" to fs-rez
                exit perform
             end-if
          end-if
          if ilk-secilen = 07 and bit-cout-tarih not = 0
             if rez-cik-tar > bit-cout-tarih
                move "10" to fs-rez
                exit perform
             end-if
          end-if
          if ilk-secilen = 08 and bit-voucher not = spaces
             if rez-voucher > bit-voucher
                move "10" to fs-rez
                exit perform
             end-if
          end-if
*/ ana filtreler tekrar sorgulaniyor ...
*-------------------------------------------------------
          if numara-eh > 0
             if (bas-numara <> 0 and rez-anah < bas-numara) or
                (bit-numara <> 0 and rez-anah > bit-numara)
                     exit perform cycle
             end-if
          end-if
          if islem-tarih-eh > 0  or islem-tarih-eh = 1  
              if satis-tarihi-var = 1 
                     if (bas-islem-tarih <> 0 and rez-al-tar < bas-islem-tarih) or
                        (bit-islem-tarih <> 0 and rez-al-tar > bit-islem-tarih)
                           exit perform cycle
                     end-if
              else

                      if (bas-islem-tarih <> 0 and rez-isl-tar < bas-islem-tarih) or
                         (bit-islem-tarih <> 0 and rez-isl-tar > bit-islem-tarih)
                              exit perform cycle
                     end-if
             end-if
          end-if
                evaluate sadece-call-center(1:1)
                 when "1"
                    if rez-call-center = spaces
                        exit perform cycle 
                    end-if 
                    if rez-call-center(1:4) not = "call"
                       exit perform cycle
                    end-if 
                 when "0"
                    continue 
                 when "2"
                    if rez-call-center(1:4) = "call"
                       exit perform cycle 
                    end-if 
                 end-evaluate     
          if odasiz = 1 
             if rez-share not = 1 then
                   exit perform cycle
             end-if
          end-if

          if fix-ver = 1
             if rez-fiyat-fix <> "E"
                   exit perform cycle
              end-if
          end-if
          
          if acenta-eh > 0
             if (bas-acenta <> spaces and rez-acenta < bas-acenta) or 
                (bit-acenta <> spaces and rez-acenta > bit-acenta)
                   exit perform cycle
             end-if
          end-if
          if musteri-adi-eh > 0
             if (bas-musteri-adi <> spaces and rez-adi < bas-musteri-adi) or
                (bit-musteri-adi <> spaces and rez-adi > bit-musteri-adi)   
                     exit perform cycle
             end-if
          end-if
          if musteri-soyadi-eh > 0
             if (bas-musteri-soy <> spaces and rez-soyadi < bas-musteri-soy) or
                (bit-musteri-soy <> spaces and rez-soyadi > bit-musteri-soy)   
                     exit perform cycle
             end-if
          end-if
          if c-in-tarih-eh > 0
             if (bas-cin-tarih <> 0 and rez-gir-tar < bas-cin-tarih) or
                (bit-cin-tarih <> 0 and rez-gir-tar > bit-cin-tarih)
                     exit perform cycle
             end-if
          end-if
          if c-out-tarih-eh > 0
             if (bas-cout-tarih <> 0 and rez-cik-tar < bas-cout-tarih) or
                (bit-cout-tarih <> 0 and rez-cik-tar > bit-cout-tarih)
                     exit perform cycle
             end-if
          end-if
          if voucher-eh > 0
             if (bas-voucher <> spaces and rez-voucher < bas-voucher) or 
                (bit-voucher <> spaces and rez-voucher > bit-voucher)
                     exit perform cycle                 
             end-if
          end-if
*/ yardimci filtreler sorgulaniyor ... 
*-------------------------------------------------------
          if combo-rezervasyon-turu-value(1:1) <> 0
             if combo-rezervasyon-turu-value(1:1) <> rez-tipi
                exit perform cycle
             end-if
          end-if
          if bas-grup-kodu <> zeroes and spaces
             if bas-grup-kodu <> rez-grup-no
                exit perform cycle
             end-if
          end-if
          if combo-kur-tipi-value(1:1) <> "H"
             if combo-kur-tipi-value(1:1) <> rez-kur-aygun
                exit perform cycle
             end-if
          end-if
          if bas-banka-kodu <> 0
             if bas-banka-kodu > rez-banka or 
                bas-banka-kodu < rez-banka
                    exit perform cycle
             end-if
          end-if
          if bas-doviz-kodu <> 0
             if bas-doviz-kodu > rez-doviz or 
                bas-doviz-kodu < rez-doviz
                    exit perform cycle
             end-if
          end-if
          if bas-anlasma-kodu <> spaces
             if bas-anlasma-kodu > rez-anlasma or 
                bas-anlasma-kodu < rez-anlasma
                     exit perform cycle
             end-if
          end-if
          if bas-odeme-kodu <> spaces
             if bas-odeme-kodu > rez-odeme-tipi or 
                bas-odeme-kodu < rez-odeme-tipi
                     exit perform cycle
             end-if
          end-if
          if bas-ulke-kodu <> spaces
             if bas-ulke-kodu > rez-ulke or 
                bas-ulke-kodu < rez-ulke
                     exit perform cycle
             end-if
          end-if
          if bas-pazar-kodu <> spaces
             if bas-pazar-kodu > rez-pazar or 
                bas-pazar-kodu < rez-pazar
                     exit perform cycle
             end-if
          end-if
          if bas-pansiyon-kodu <> spaces
             if bas-pansiyon-kodu > rez-pan-tipi or 
                bas-pansiyon-kodu < rez-pan-tipi
                     exit perform cycle
             end-if
          end-if
          if bas-opetaror-kodu not = spaces and bas-opetaror-kodu not =  rez-operator
                     exit perform cycle
          end-if

          if bas-ozel-durum-kodu <> spaces
             if bas-ozel-durum-kodu > REZ-OZEL-DURUM or 
                bas-ozel-durum-kodu < REZ-OZEL-DURUM
                     exit perform cycle
             end-if
          end-if

          if bas-kaynak1-kodu <> spaces
             if bas-kaynak1-kodu > rez-kaynak-1 or 
                bas-kaynak1-kodu < rez-kaynak-1
                     exit perform cycle
             end-if
          end-if
          if bas-kaynak2-kodu <> spaces
             if bas-kaynak2-kodu > rez-kaynak-2 or 
                bas-kaynak2-kodu < rez-kaynak-2
                     exit perform cycle
             end-if
          end-if
          if bas-kaynak3-kodu <> spaces
             if bas-kaynak3-kodu > rez-kaynak-3 or 
                bas-kaynak3-kodu < rez-kaynak-3
                     exit perform cycle
             end-if
          end-if
          if acentagrup not = spaces 
            initialize grup-rec
            move rez-acenta to grup-alt
            move "A" to grup-tipi
            move acentagrup to grup-kodu
            read grup no lock 
               invalid
                 if acentagrupharic = 0 
                   exit perform cycle
                 end-if
            not invalid
                  if acentagrupharic = 1 
                   exit perform cycle
                 end-if
            end-read 

          end-if

*          if combo-musteri-turu-value(1:1) = "N" or 
*             combo-musteri-turu-value(1:1) = rez-vip
*                   continue
*          else 
*             exit perform cycle
*          end-if


          if ((rez-vip = "N" or rez-vip = " ") and cb-nor-v = 0 ) or
             ((rez-vip   not = "N" and rez-vip not = " ") and cb-vip2-v = 0)
              exit perform cycle
          end-if

*/ gelismis filtreler sorgulaniyor
*-------------------------------------------------------
          if combo-oda-tipi-value(1:1) <> "0" 
             if combo-oda-tipi-value(1:1) <> rez-s-d-t-g
                   exit perform cycle
             end-if
          end-if
          if combo-oda-konumu-value(1:2) <> "00"
             if combo-oda-konumu-value(1:2) <> rez-oda-konumu
                exit perform cycle
             end-if
          end-if
          if combo-fiyat-konumu-value(1:2) <> "00"
             if combo-fiyat-konumu-value(1:2) <> rez-fiyat-konumu
                exit perform cycle
             end-if
          end-if
          if combo-kullanici-no <> spaces 
             if combo-kullanici-no <> rez-staf
                exit perform cycle
             end-if
          end-if
          if combo-rezervasyon-k-w-value(1:1) <> "H"
             if combo-rezervasyon-k-w-value(1:1) <> rez-k-g-b
                exit perform cycle
             end-if
          end-if
          if cin-rezler-ciksin = 0
             if rez-c-in = "E"
                exit perform cycle
             end-if
          end-if
          evaluate rap-bilboard
            when 1
               if rez-bilbord-eh not = "E" 
                  exit perform cycle
               end-if
            when 2
                if rez-bilbord-eh = "E" 
                  exit perform cycle
               end-if
          end-evaluate
          
          evaluate eb-rezler-ciksin
*/ sadece ebler cikiyor
          when 1
               if rez-eb <> "E"
                  exit perform cycle
               end-if
*/ ebler cikmasin
          when 2
               if rez-eb = "E"
                  exit perform cycle
               end-if
          end-evaluate
          if buyuk-sayi <> 0
             if buyuk-sayi <> rez-buyuk
                exit perform cycle
             end-if
          end-if
          if kucuk-sayi <> 0
             if kucuk-sayi <> rez-kucuk
                exit perform cycle
             end-if
          end-if
          if free-sayi <> 0
             if free-sayi <> rez-free
                exit perform cycle
             end-if
          end-if
          if komisyon-orani <> 0
             if komisyon-orani <> rez-komisyon
                exit perform cycle
             end-if
          end-if
          if indirim-orani <> 0
             if indirim-orani <> rez-nor-indirim
                exit perform cycle
             end-if
          end-if
          if sadece-trgel = 1 and rez-gel-sirket  = spaces 
                 exit perform cycle 
          end-if
          if sadece-trgit = 1 and rez-git-sirket  = spaces 
                 exit perform cycle 
          end-if

          if dis = 1 or disharic = 1 then 
              initialize odalar-rec
               move rez-odano to odalar-anah
               read odalar no lock invalid 
                  if dis = 1   then 
                      exit perform cycle
                   end-if
                 not invalid
                 if odalar-dis not = 1 and dis = 1  
                     exit perform cycle
                 end-if
                  if odalar-dis  = 1 and disharic  = 1  
                     exit perform cycle
                 end-if
               end-read

          end-if
*------------------sy 19-09-2014-------------------------------------
          if yan-ver = 1
             initialize yanrez-rec
             move rez-no to yanrez-rezno
             start yanrez key not < yanrez-anah invalid
                     continue
             not invalid
             perform until fs-yanrez = "10"
             read yanrez next no lock end move "10" to fs-yanrez
             not end
                      if yanrez-rezno <> rez-no then
                            exit perform
                      end-if
                      if yanrez-sirano = 1 then
                            perform detay-ata
                      else
                             if dokumere-yolla
                                    initialize dokumer-rec detay
                                    move "       *"                to det-1
                                    move yanrez-adi         to det-2
                                    move yanrez-soyadi      to det-3

                                    move "|" to fil-1 fil-2 fil-3 fil-4
                                    fil-5 fil-6 fil-66 fil-7 fil-8 fil-9 fil-10 fil-10-10 fil-11
                                    fil-12 fil-13 fil-14 fil-15 fil-16 fil-17
                                    fil-18 fil-19 fil-20 fil-21 fil-22 fil-23  fil-16-1
                                    fil-24 fil-25 fil-26 fil-27 fil-28 fil-29  fil-35
                                    fil-30 fil-31 fil-19-1 fil-32 fil-33 fil-34 fil-24-1 
                                    fil-36 fil-37 fil-38
                                    write dokumer-rec from detay
                            end-if
                      end-if
             end-read
             end-perform
             end-start

          else
                 perform detay-ata
          end-if
         
     end-read
     end-perform.
     if dokumere-yolla 
        perform liste-toplam
     end-if

     close rez yanrez kodlar02 rezweb cast acenta ulke konum kllnc
           fiyat fiyatana aksiyhrk firma ODALAR grup onbkodlar10 doviz.
 detay-ata.
     if dokumere-yolla
        initialize dokumer-rec detay

**************************************kaya istanbul share start block******************************
            initialize cast-rec
                evaluate TRUE
                   when tarih-tasi <= rez-gir-tar 
                      move rez-gir-tar to cast-tarih
                   when tarih-tasi >= rez-cik-tar
                     move rez-cik-tar to cast-tarih 
                  when  other 
                     move tarih-tasi to cast-tarih
                end-evaluate
            move rez-no              to cast-rez-no
            read cast no lock invalid
                 continue 
            not invalid 
                 if cast-share = 1
                    move 0           to det-1-1
                 else
                    move 1           to det-1-1            
                    compute genel-share = genel-share + 1
                 end-if
            end-read 
**************************************kaya istanbul share end block  ******************************
        move rez-anah                to det-1
        move rez-adi                 to det-2
        move rez-soyadi              to det-3
        move rez-buyuk               to 4-z
        move 4-z                     to det-4
        move rez-kucuk               to 4-z
        move 4-z                     to det-5
        move rez-free                to 4-z
        move 4-z                     to det-6
        move rez-bebek               to 4-z
        move 4-z                     to det-66
        move rez-gir-gun             to egun
        move rez-gir-ay              to eay
        move rez-gir-yil             to eyil
        move etarih                  to det-7
        move rez-cik-gun             to egun
        move rez-cik-ay              to eay
        move rez-cik-yil             to eyil
        move etarih                  to det-8
        evaluate rez-tipi
             when 1  move "Alotment" to det-9
             when 2  move "It"       to det-9
             when 3  move "Fit"      to det-9
             when 4  move "Grup"     to det-9
             when 5  move "Munferit" to det-9
             when 6  move "Walk/in"  to det-9
             when 7  move "Sirket"   to det-9
             when 8  move "Ozel"     to det-9
        end-evaluate
        move rez-odeme-tipi          to kodlar02-kodu
        move "B"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"  to kodlar02-adi
        end-read
        move kodlar02-adi            to det-10
        move rez-acenta              to acenta-anahtar 
        read acenta no lock invalid
             move "Tanimsiz"   to acenta-adi
        end-read
        move acenta-kodu             to det-10-10
        move acenta-adi              to det-11
        move rez-ulke                to ulke-anah
        read ulke no lock invalid 
             move "Tanimsiz"         to ulke-adi
        end-read
        move ulke-adi                to det-12
        move rez-voucher             to det-13
        move rez-anlasma             to kodlar02-kodu
        move "D"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"     to kodlar02-adi
        end-read
        move kodlar02-adi            to det-14
        move rez-banka               to det-15
        move rez-doviz               to det-16

        initialize doviz-rec
        move rez-doviz to doviz-kodu
        read doviz no lock invalid
            move "Tanimsiz" to d-kisa-adi
        end-read 
           move d-kisa-adi to det-16-1

        move rez-fiyati              to 15-z
        move 15-z                    to det-17
        move rez-gir-tar             to g-bul-ilk-tarih
        move rez-cik-tar             to g-bul-son-tarih
        perform g-bul thru g-bul-exit
        move g-bul-gun-sayisi        to 3-z
        move 3-z                     to det-18

        compute top-gece =  top-gece + g-bul-gun-sayisi

        move rez-al-gun to det-32(1:2)
        move "/"           to det-32(3:1)
        move rez-al-ay to det-32(4:2)
        move "/"           to det-32(6:1)
        move rez-al-yil to det-32(7:5)
        move rez-not1      to det-33
        move rez-not2      to det-34
        initialize rezweb-rec
        move rez-no  to REZweb-rezno
        read rezweb no lock invalid 
            continue 
        end-read 
           if rezweb-adres not = spaces
              move rezweb-adres to det-35
           end-if 
         if dosya-yok = 1
            initialize takdosya-rec 
            move rez-no to takdosya-anahtar
            read takdosya no lock invalid 
                 continue 
            not invalid 
                move "DOSYA VAR"   to det-35
            end-read 
               
         end-if 

        if gayriresmi = 1 then 
           add 1 to ilk
           move rez-acenta to buffer-acenta acenta-kodu
           move "AL" to acenta-kodu(1:2)
           read acenta no lock invalid
                if ilk not = 1 then
                   move 1 to ilk
                  display message box "Bu acentanin alternatifi yok"
                end-if
              not invalid
                move acenta-kodu   to  rez-acenta
           end-read
        end-if
        perform peryot-fiyat-bul
         if sadece-aksiyon = 1 and
            (not aksiyon-var)
           exit paragraph
             
          end-if
        if sadece-special = 1 and
            (not special-var)
           exit paragraph
             
          end-if 
        if gayriresmi = 1 then 
           move buffer-acenta to rez-acenta
        end-if
        

        if top-rez-fiyati <> zeroes
           move top-rez-fiyati    to temp-sayi
        else
           compute temp-sayi = g-bul-gun-sayisi * rez-fiyati
        end-if
        
       compute t-tutar   = t-tutar + temp-sayi
        move temp-sayi               to 15-z
        move 15-z                    to det-19
        if d-hesapla = 1 then 
          if plan-kaldir = 1 then
            perform cast-plan-kaldir
          end-if
           perform  yeniden-hesapla
        end-if
        perform casttan-fiyat-bul
         add  rez-top-tut          to  t-rez-top-tut
        compute fiyat-farki =  temp-sayi - rez-top-tut
        if sadece-farkli = 1 and
            fiyat-farki < 0.10
           exit paragraph
             
        end-if 
        move rez-top-tut               to 15-z
        move 15-z                    to det-19-1
        if rez-firma not = spaces 
                move rez-firma to firma-kodu
                read firma no lock invalid continue end-read
             move firma-adi to det-fir

        end-if
        move rez-pazar               to kodlar02-kodu
        move "E"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"      to kodlar02-adi
        end-read
        move kodlar02-adi            to det-20
        move rez-eb                  to det-21
        move rez-pan-tipi            to det-22
        move rez-kur-aygun           to det-23
        initialize konum-rec
        move rez-fiyat-konumu          to konum-anahtar
        read konum no lock invalid
             move "Tanimsiz" to konum-adi
        end-read
        move konum-adi               to det-24
        initialize konum-rec
        move rez-oda-konumu          to konum-anahtar
        read konum no lock invalid
             move "Tanimsiz" to konum-adi
        end-read
        move konum-adi               to det-24-1

        
        evaluate rez-s-d-t-g
             when 1 move "Single"    to det-25
             when 2 move "Double"    to det-25
             when 3 move "Triple"    to det-25
             when 4 move "Grup"      to det-25
        end-evaluate
        move rez-odano                to o-kisa 
            perform oda-uzat
            move o-uzun to  det-26
        if rez-grup-no > 0
           move rez-grup-no             to det-27
        end-if 
        move rez-nor-indirim         to 2-z
        move 2-z                     to det-28
        move rez-komisyon            to det-29
        move rez-staf                to k-kodu
        read kllnc no lock invalid
             move "Tanimsiz"     to k-adi
        end-read
        move k-adi                   to det-30
        move rez-fiyat-konumu        to det-31

        initialize onbkodlar10-rec 
        set onbkodlar10-tipi-kaynak-1 to true
        move rez-kaynak-1             to onbkodlar10-kodu1
        read onbkodlar10 no lock invalid
             move "Tanimsiz" to det-36
        not invalid
            move onbkodlar10-adi to det-36
        end-read

        initialize onbkodlar10-rec 
        set onbkodlar10-tipi-kaynak-2 to true
        move rez-kaynak-2             to onbkodlar10-kodu1
        read onbkodlar10 no lock invalid
             move "Tanimsiz" to det-37
        not invalid
            move onbkodlar10-adi to det-37
        end-read

        initialize onbkodlar10-rec 
        set onbkodlar10-tipi-kaynak-3 to true
        move rez-kaynak-3             to onbkodlar10-kodu1
        read onbkodlar10 no lock invalid                 
             move "Tanimsiz" to det-38
        not invalid
            move onbkodlar10-adi to det-38
        end-read

        if rez-kaynak-1 = spaces 
           initialize det-36
        end-if
        if rez-kaynak-2 = spaces 
           initialize det-37
        end-if
        if rez-kaynak-3 = spaces 
           initialize det-38
        end-if

        compute t-oda   = t-oda   + 1
        compute t-pax   = t-pax   + rez-buyuk
        compute t-chi   = t-chi   + rez-kucuk
        compute t-fre   = t-fre   + rez-free
        compute t-beb   = t-beb   + rez-bebek


        move "|" to fil-1 fil-1-1 fil-2 fil-3 fil-4
        fil-5 fil-6 fil-66 fil-7 fil-8 fil-9 fil-10 fil-10-10 fil-11
        fil-12 fil-13 fil-14 fil-15 fil-16 fil-17 fil-fir
        fil-18 fil-19 fil-20 fil-21 fil-22 fil-23  fil-16-1
        fil-24 fil-25 fil-26 fil-27 fil-28 fil-29
        fil-30 fil-31 fil-19-1  fil-32   fil-24-1 
        fil-33 fil-34 fil-35 fil-36 fil-37 fil-38
        write dokumer-rec from detay
     else
        initialize form3-gd-1-record
        move rez-anah                to gd-1-col-1
        move rez-adi                 to gd-1-col-2
        move rez-soyadi              to gd-1-col-3
        move rez-buyuk               to 4-z
        move 4-z                     to gd-1-col-4
        move rez-kucuk               to 4-z
        move 4-z                     to gd-1-col-5
        move rez-free                to 4-z
        move 4-z                     to gd-1-col-6
        move rez-bebek               to 4-z
        move 4-z                     to gd-1-col-66
        move rez-gir-gun             to egun
        move rez-gir-ay              to eay
        move rez-gir-yil             to eyil
        move etarih                  to gd-1-col-7
        move rez-cik-gun             to egun
        move rez-cik-ay              to eay
        move rez-cik-yil             to eyil
        move etarih                  to gd-1-col-8
        evaluate rez-tipi
             when 1  move "Alotment" to gd-1-col-9
             when 2  move "It"       to gd-1-col-9
             when 3  move "Fit"      to gd-1-col-9
             when 4  move "Grup"     to gd-1-col-9
             when 5  move "Munferit" to gd-1-col-9
             when 6  move "Walk/in"  to gd-1-col-9
             when 7  move "Sirket"   to gd-1-col-9
             when 8  move "Ozel"     to gd-1-col-9
        end-evaluate
        move rez-odeme-tipi          to kodlar02-kodu
        move "B"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"  to kodlar02-adi
        end-read
        move kodlar02-adi            to gd-1-col-10
        move rez-acenta              to acenta-anahtar
        read acenta no lock invalid
             move "Tanimsiz"   to acenta-adi
        end-read
        move acenta-adi              to gd-1-col-11
        move rez-ulke                to ulke-anah
        read ulke no lock invalid 
             move "Tanimsiz"         to ulke-adi
        end-read
        move ulke-adi                to gd-1-col-12
        move rez-voucher             to gd-1-col-13
        move rez-anlasma             to kodlar02-kodu
        move "D"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"     to kodlar02-adi
        end-read
        move kodlar02-adi            to gd-1-col-14
        move rez-banka               to gd-1-col-15
        move rez-doviz               to gd-1-col-16
        move rez-fiyati              to 15-z
        move 15-z                    to gd-1-col-17
        move rez-gir-tar             to g-bul-ilk-tarih
        move rez-cik-tar             to g-bul-son-tarih
        perform g-bul thru g-bul-exit
        move g-bul-gun-sayisi        to 4-z
        move 4-z                     to gd-1-col-18
        perform peryot-fiyat-bul
        if top-rez-fiyati <> zeroes
           move top-rez-fiyati    to temp-sayi
        else
           compute temp-sayi = g-bul-gun-sayisi * rez-fiyati
        end-if
        move temp-sayi               to 15-z
        move 15-z                    to gd-1-col-19
        move rez-pazar               to kodlar02-kodu
        move "E"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"      to kodlar02-adi
        end-read
        move kodlar02-adi            to gd-1-col-20
        move rez-eb                  to gd-1-col-21
        move rez-pan-tipi            to gd-1-col-22
        move rez-kur-aygun           to gd-1-col-23
        move rez-oda-konumu          to konum-anahtar
        read konum no lock invalid
             move "Tanimsiz" to konum-adi
        end-read
        move konum-adi               to gd-1-col-24
        evaluate rez-s-d-t-g
             when 1 move "Single"    to gd-1-col-25
             when 2 move "Double"    to gd-1-col-25
             when 3 move "Triple"    to gd-1-col-25
             when 4 move "Grup"      to gd-1-col-25
        end-evaluate
        move rez-odano               to gd-1-col-26
        move rez-grup-no             to gd-1-col-27
        move rez-nor-indirim         to 2-z
        move 2-z                     to gd-1-col-28
        move rez-komisyon            to gd-1-col-29
        move rez-staf                to k-kodu
        read kllnc no lock invalid
             move "Tanimsiz"     to k-adi
        end-read
        move k-adi                   to gd-1-col-30

        modify form3-gd-1,
               record-to-add(form3-gd-1-record)
        initialize takas-rec
        if combo-toplamlar-value(1:1) <> "A"
           evaluate combo-toplamlar-value(1:1)
               when "B"  move rez-pazar        to takas-anahtar1
               when "C"  move rez-pan-tipi     to takas-anahtar1
               when "D"  move rez-ulke         to takas-anahtar1
               when "E"  move rez-anlasma      to takas-anahtar1
               when "F"  move rez-s-d-t-g      to takas-anahtar1
               when "G"  move rez-oda-konumu   to takas-anahtar1
               when "H"  move rez-odeme-tipi   to takas-anahtar1
               when "I"  move rez-doviz        to takas-anahtar1
               when "J"  move rez-eb           to takas-anahtar1
               when "K"  move rez-acenta       to takas-anahtar1
           end-evaluate
           move low-values                     to takas-anahtar2
           read takas no lock invalid 
                continue
           end-read
           add rez-buyuk         to takas-pax
           add rez-kucuk         to takas-child
           add rez-free          to takas-free
           add rez-bebek         to takas-bebek
           add temp-sayi         to takas-fiyat 
           add 1                 to takas-adet
           write takas-rec invalid
                 rewrite takas-rec end-rewrite
           end-write
           if esleme-i > 0
              initialize takas-rec
              evaluate combo-toplamlar-value(1:1)
                  when "B"  move rez-pazar        to takas-anahtar1
                  when "C"  move rez-pan-tipi     to takas-anahtar1
                  when "D"  move rez-ulke         to takas-anahtar1
                  when "E"  move rez-anlasma      to takas-anahtar1
                  when "F"  move rez-s-d-t-g      to takas-anahtar1
                  when "G"  move rez-oda-konumu   to takas-anahtar1
                  when "H"  move rez-odeme-tipi   to takas-anahtar1
                  when "I"  move rez-doviz        to takas-anahtar1
                  when "J"  move rez-eb           to takas-anahtar1
                  when "K"  move rez-acenta       to takas-anahtar1
              end-evaluate

              evaluate esleme-i
                  when 01 move rez-acenta       to takas-anahtar2
                  when 02 move rez-pan-tipi     to takas-anahtar2
                  when 03 move rez-anlasma      to takas-anahtar2
                  when 04 move rez-oda-konumu   to takas-anahtar2
                  when 05 move rez-doviz        to takas-anahtar2
                  when 06 move rez-pazar        to takas-anahtar2
                  when 07 move rez-ulke         to takas-anahtar2
                  when 08 move rez-s-d-t-g      to takas-anahtar2
                  when 09 move rez-odeme-tipi   to takas-anahtar2
                  when 10 move rez-eb           to takas-anahtar2
              end-evaluate
              read takas no lock invalid 
                   continue
              end-read
              add rez-buyuk         to takas-pax
              add rez-kucuk         to takas-child
              add rez-free          to takas-free
              add rez-bebek         to takas-bebek
              add temp-sayi         to takas-fiyat 
              add 1                 to takas-adet
              write takas-rec invalid
                    rewrite takas-rec end-rewrite
              end-write
           end-if
        end-if
     end-if.
 casttan-fiyat-bul.
             
             initialize cast-rec  rez-top-tut
            move rez-no to cast-rez-no 
            
            start cast key > cast-anah1 
               invalid continue

               not invalid
                 perform until fs-cast = "10" 
                      read cast next no lock 
                         end move "10" to fs-cast
                         not end
                         if cast-rez-no not = rez-no 
                             move "10" to fs-cast
                             else
                             if cast-tarih >= rez-cik-tar then 
                               move "10" to fs-cast
                              else
                               if reel-gecmis = 1
                                       if cast-tarih < rez-cik-tar and cast-tarih >= tarih-tasi
                                           add cast-fiyati to rez-top-tut                                        
                                       end-if
                                         add cast-basilan-fiyat to rez-top-tut                                            
                                       if duzeltme-dahil = 1 and cast-tarih = rez-cik-tar then        
                                           add cast-duzeltme to rez-top-tut 
                                       end-if                                   
                               else
                                  add cast-anlasma-fiyati to rez-top-tut
                               end-if 
                             end-if
                          end-if
                      end-read
                 end-perform 
            end-start.
             



*
 cast-plan-kaldir.

          open i-o cast
             initialize cast-rec  rez-top-tut
            move rez-no to cast-rez-no 
            
            start cast key > cast-anah1 
               invalid continue

               not invalid
                 perform until fs-cast = "10" 
                      read cast next no lock 
                         end move "10" to fs-cast
                         not end
                         if cast-rez-no not = rez-no 
                             move "10" to fs-cast
                             else
                             if rez-fiyat-konumu not = cast-fiyat-konumu  or
                                  rez-anlasma not = cast-anlasma  or
                                  rez-kisi not = cast-kisi
                                   move rez-fiyat-konumu to cast-fiyat-konumu 
                                   move  rez-anlasma   to  cast-anlasma
                                   if rez-gir-tar not < tarih-tasi then 
                                      move rez-kisi to cast-kisi
                                   end-if
                                   rewrite cast-rec invalid stop " " end-rewrite
                             end-if
                            
                          end-if
                      end-read
                 end-perform 
            end-start
             close cast.










            .
*
 liste-toplam.
     set dokumere-yolla to true.
     if dokumere-yolla
        initialize dokumer-rec detay
        move "-"            to det-dokumer-20(5:1)
        move all "-" to det-1 det-1-1 det-2 det-3 det-4
        det-5 det-6 det-66 det-7 det-8 det-9 det-10 det-10-10 det-11
        det-12 det-13 det-14 det-15 det-16 det-17  det-16-1
        det-18 det-19 det-20 det-21 det-22 det-23
        det-24 det-25 det-26 det-27 det-28 det-29
        det-30 det-31  det-19-1 det-32  det-24-1 det-33 det-34 det-35
        det-36 det-37 det-38
        write dokumer-rec from detay
        initialize dokumer-rec detay
        move "Genel"                 to det-2
        move "Toplam"                to det-3

        move top-gece       to 4-z
        move 4-z           to det-18
        move t-oda                   to 4-z   
        move 4-z                     to det-26
        move t-pax                   to 4-z
        move 4-z                     to det-4
        move t-chi                   to 4-z
        move 4-z                     to det-5
        move t-fre                   to 4-z
        move 4-z                     to det-6
        move t-beb                   to 4-z
        move 4-z                     to det-66
        move t-tutar                 to 15-z
        move 15-z                    to det-19
         move t-rez-top-tut          to 15-z
        move 15-z                    to det-19-1
        move genel-share             to 4-z
        move 4-z                     to det-7
        move "A"          to det-dokumer-20(3:1)
        move 481          to det-renk1
        move "1"          to det-dokumer-20(10:1)
        move "|" to fil-1 fil-2 fil-3 fil-4
        fil-5 fil-6 fil-66 fil-7 fil-8 fil-9 fil-10 fil-10-10 fil-11
        fil-12 fil-13 fil-14 fil-15 fil-16 fil-17
        fil-18 fil-19 fil-20 fil-21 fil-22 fil-23  fil-16-1
        fil-24 fil-25 fil-26 fil-27 fil-28 fil-29
        fil-30 fil-31 fil-19-1  fil-32  fil-24-1
        fil-33 fil-34 fil-35 fil-36 fil-37 fil-38
        write dokumer-rec from detay
        initialize dokumer-rec detay
        move "-"            to det-dokumer-20(5:1)
        move all "-" to det-1 det-2 det-3 det-4
        det-5 det-6 det-66 det-7 det-8 det-9 det-10 det-10-10 det-11
        det-12 det-13 det-14 det-15 det-16 det-17
        det-18 det-19 det-20 det-21 det-22 det-23 det-16-1
        det-24 det-25 det-26 det-27 det-28 det-29
        det-30 det-31 det-19-1 det-32  det-24-1 det-33 det-34 det-35
        det-36 det-37 det-38
        write dokumer-rec from detay
     end-if.

*
 Form3-Aft-Initdata.
     if combo-toplamlar-value(1:1) = "A"
        modify button-toplamlar,enabled = false
     else
        modify button-toplamlar,enabled = true
     end-if.
     modify form3-gd-1,
            reset-grid  = 1 
            mass-update = 1
     initialize form3-gd-1-record
     move "Rez.no"           to gd-1-col-1
     move "Adi"              to gd-1-col-2
     move "Soyadi"           to gd-1-col-3
     move "Pax"              to gd-1-col-4
     move "Chi"              to gd-1-col-5
     move "Free"             to gd-1-col-6
     move "Beb."             to gd-1-col-66
     move "C/in"             to gd-1-col-7
     move "C/out"            to gd-1-col-8
     move "Rez.T"            to gd-1-col-9
     move "Odeme"            to gd-1-col-10
     move "Acenta"           to gd-1-col-11
     move "Ulke"             to gd-1-col-12
     move "Voucher"          to gd-1-col-13
     move "Anlas"            to gd-1-col-14
     move "Bn"               to gd-1-col-15
     move "Dv"               to gd-1-col-16
     move "Rez.Fiyati"       to gd-1-col-17
     move "Gun"              to gd-1-col-18
     move "Toplam Rez.Fiyati" to gd-1-col-19
     move "Pazar"            to gd-1-col-20
     move "X"                to gd-1-col-21
     move "Pk"               to gd-1-col-22
     move "K"                to gd-1-col-23
     move "Konum"            to gd-1-col-24
     move "Tip"              to gd-1-col-25
     move "Oda"              to gd-1-col-26
     move "Grup"             to gd-1-col-27
     move "IO"               to gd-1-col-28
     move "KO"               to gd-1-col-29
     move "Staff"            to gd-1-col-30.
     modify form3-gd-1,
            record-to-add(form3-gd-1-record).

     perform islem.

     modify form3-gd-1,
            mass-update = 0.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 Form3-Gd-1-Ev-Other.
    evaluate event-type
        when msg-begin-entry
             move event-action-fail to event-action
             exit paragraph
        when msg-goto-cell
        when msg-goto-cell-mouse
        when msg-begin-drag
        when msg-end-drag
        when msg-goto-cell-drag
             inquire form3-gd-1,y in yeni-y
             if yeni-y < 2
                move 2 to yeni-y eski-y
             end-if
             if eski-y > zeroes 
                modify form3-gd-1(eski-y),
                       x = 2
                       row-color = 0
                       cell-color = 0
             end-if
             modify form3-gd-1,
                    y = yeni-y,
                    x = 2,
                    row-color = 480
                    cell-color = 480
             move yeni-y to eski-y
    end-evaluate.
*
 Form4-Aft-Initdata.
    open input acenta ulke kodlar02 konum doviz.
    modify form4-gd-1,reset-grid = 1 mass-update = 1 
    initialize form4-gd-1-record
    move "Kodu"       to gd-4-col-1
    move "Adi"        to gd-4-col-2
    move "Pax"        to gd-4-col-3
    move "Child"      to gd-4-col-4
    move "Free"       to gd-4-col-5
    move "Beb."       to gd-4-col-55
    move "Rez.Fiyati" to gd-4-col-6
    modify form4-gd-1,
           record-to-add(form4-gd-1-record)
    initialize takas-rec
    start takas key not < takas-anahtar invalid
          continue
    not invalid
    initialize fs-takas esleme-kayit-sayi
    perform with test after until fs-takas = "10"
    read takas next no lock end move "10" to fs-takas
    not at end
         initialize form4-gd-1-record
         move takas-anahtar1      to gd-4-col-1
         evaluate combo-toplamlar-value(1:1)
              when "B"
                   move takas-anahtar1 to kodlar02-kodu
                   move "E"           to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi  to gd-4-col-2
              when "C"
                   move takas-anahtar1 to kodlar02-kodu
                   move "A"           to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi     to gd-4-col-2
              when "D"
                   move takas-anahtar1    to ulke-anah
                   read ulke no lock invalid
                        move "Tanimsiz"  to ulke-adi
                   end-read
                   move ulke-adi         to gd-4-col-2
              when "E"
                   move takas-anahtar1    to kodlar02-kodu
                   move "D"              to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi     to gd-4-col-2
              when "F"
                   evaluate takas-anahtar1(1:1)
                       when "1" move "Single"   to gd-4-col-2
                       when "2" move "Double"   to gd-4-col-2
                       when "3" move "Triple"   to gd-4-col-2
                       when "4" move "Grup"     to gd-4-col-2
                   end-evaluate
              when "G"
                   move takas-anahtar1           to konum-anahtar
                   read konum no lock invalid
                        move "Tanimsiz"         to konum-adi
                   end-read
                   move konum-adi               to gd-4-col-2
              when "H"
                   move takas-anahtar1           to kodlar02-kodu
                   move "B"                     to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"         to kodlar02-adi
                   end-read
                   move kodlar02-adi            to gd-4-col-2
              when "I"
                   move takas-anahtar1           to doviz-kodu
                   read doviz no lock invalid
                        move "Tanimsiz"         to d-adi-1
                   end-read
                   move d-adi-1                 to gd-4-col-2
              when "J"
                   evaluate takas-anahtar1(1:1)
                       when "E" move "Erken  Rezervasyon"   to gd-4-col-2
                       when "H" move "Normal Rezervasyon"   to gd-4-col-2
                       when other move "Normal Rezervasyon"   to gd-4-col-2
                   end-evaluate
              when "K"
                   move takas-anahtar1           to acenta-kodu
                   read acenta no lock invalid
                        move "Tanimsiz"         to acenta-adi
                   end-read
                   move acenta-adi              to gd-4-col-2
         end-evaluate

         if takas-anahtar2 <> low-values and esleme-i <> 0
            initialize form4-gd-1-record
            evaluate esleme-i
                when 01
                   move takas-anahtar2           to acenta-kodu
                   read acenta no lock invalid
                        move "Tanimsiz"          to acenta-adi
                   end-read
                   move acenta-adi                to gd-4-col-2
                when 02
                   move takas-anahtar2 to kodlar02-kodu
                   move "A"           to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi     to gd-4-col-2
                when 03
                   move takas-anahtar2    to kodlar02-kodu
                   move "D"              to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read
                   move kodlar02-adi     to gd-4-col-2
                when 04
                   move takas-anahtar2           to konum-anahtar
                   read konum no lock invalid
                        move "Tanimsiz"         to konum-adi
                   end-read
                   move konum-adi               to gd-4-col-2
                when 05
                   move takas-anahtar2           to doviz-kodu
                   read doviz no lock invalid
                        move "Tanimsiz"         to d-adi-1
                   end-read
                   move d-adi-1                 to gd-4-col-2
                when 06
                   move takas-anahtar2 to kodlar02-kodu
                   move "E"           to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"  to kodlar02-adi
                   end-read

                   move kodlar02-adi  to gd-4-col-2
                when 07
                   move takas-anahtar2    to ulke-anah
                   read ulke no lock invalid
                        move "Tanimsiz"  to ulke-adi
                   end-read
                   move ulke-adi         to gd-4-col-2
                when 08
                   evaluate takas-anahtar2(1:1)
                       when "1" move "Single"   to gd-4-col-2
                       when "2" move "Double"   to gd-4-col-2
                       when "3" move "Triple"   to gd-4-col-2
                       when "4" move "Grup"     to gd-4-col-2
                   end-evaluate
                when 09
                   move takas-anahtar2           to kodlar02-kodu
                   move "B"                     to kodlar02-tipi
                   read kodlar02 no lock invalid
                        move "Tanimsiz"         to kodlar02-adi
                   end-read
                   move kodlar02-adi            to gd-4-col-2
                when 10
                   evaluate takas-anahtar2(1:1)
                       when "E" move "Erken  Rezervasyon"   to gd-4-col-2
                       when "H" move "Normal Rezervasyon"   to gd-4-col-2
                       when other move "Normal Rezervasyon"   to gd-4-col-2
                   end-evaluate
            end-evaluate
         end-if
         move takas-pax          to 5-z
         move 5-z                to gd-4-col-3
         move takas-child        to 5-z
         move 5-z                to gd-4-col-4
         move takas-free         to 5-z
         move 5-z                to gd-4-col-5
         move takas-bebek        to 5-z
         move 5-z                to gd-4-col-55
         move takas-fiyat        to 15-z
         move 15-z               to gd-4-col-6
         add 1 to esleme-kayit-sayi
         modify form4-gd-1,
                record-to-add(form4-gd-1-record)
         if esleme-i <> 0
            if takas-anahtar2 <> low-values
                modify form4-gd-1(esleme-kayit-sayi + 1)
                       x = 3
                       row-color = 480
                       cell-color = 480
            end-if
         end-if
    end-read
    end-perform
    end-start
    modify form4-gd-1,
           mass-update = 0.
    close acenta ulke kodlar02 konum doviz.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 Form3-Ex-Other.
    if key-status = 1 or 2 or 3 or 4 or 5 or 6 or 8
       continue
    else 
       exit paragraph
    end-if.

    evaluate key-status
       when 1 
            inquire form3-gd-1,cursor-y in form3-gd-y
            inquire form3-gd-1(form3-gd-y,1),
                    record-data in form3-gd-1-record
                    hidden-data in dummy
            if dummy <> "E"
               open input rez
               move gd-1-col-1      to rez-anah
               read rez no lock invalid
                    continue
               not invalid
               if rez-c-in <> "E"
                  modify form3-gd-1(form3-gd-y,1)
                         hidden-data = "E"
                         bitmap = check-bmp
                         bitmap-number = 2 
                         bitmap-width = 16
                         bitmap-trailing = 1
               end-if
               end-read
               close rez
            else
               modify form3-gd-1(form3-gd-y,1),
                      bitmap = null
                      hidden-data = "H"
            end-if
       when 2 
            inquire form3-gd-1,
                    last-row in esleme-kayit-sayi
            if esleme-kayit-sayi = 1 
               exit paragraph
            end-if
            open input rez
            initialize frame-degiskenler
            move esleme-kayit-sayi to frame-kayit-sayi
            move 20                to frame-win-line
            move 20                to frame-win-pos
            move "Bekleyiniz..."   to frame-title
            perform frame-ac
            perform varying form3-gd-y from 2 by 1 until form3-gd-y > esleme-kayit-sayi
                    perform frame-goster
                    inquire form3-gd-1(form3-gd-y,1),
                            record-data in form3-gd-1-record
                            hidden-data in dummy
                    evaluate dummy
                        when "E"
                             modify form3-gd-1(form3-gd-y,1),
                                    hidden-data = "H"
                                    bitmap = null
                        when other
                             move gd-1-col-1 to rez-anah
                             read rez no lock invalid
                                  continue
                             not invalid
*                             if rez-c-in <> "E"
                                modify form3-gd-1(form3-gd-y,1),
                                       hidden-data = "E"
                                       bitmap = check-bmp
                                       bitmap-number = 2 
                                       bitmap-width = 16
                                       bitmap-trailing = 1 
*                     end-if
                             end-read
                    end-evaluate
            end-perform
            perform frame-kapat
            close rez
       when 3
            open i-o rez takvim acenhrk cast
            inquire form3-gd-1,
                    last-row in sil-son
            initialize frame-degiskenler
            move sil-son           to frame-kayit-sayi
            move 20                to frame-win-line
            move 20                to frame-win-pos
            move "Siliniyor ..."   to frame-title
            perform frame-ac

            perform varying sil-i from 2 by 1 until sil-i > sil-son
                    perform frame-goster
                    initialize sil-eh
                    inquire form3-gd-1(sil-i,1),
                            hidden-data in sil-eh
                    if sil-eh <> "E"
                       exit perform cycle
                    end-if
                    inquire form3-gd-1(sil-i,2),
                            cell-data in rez-anah
                    read rez no lock invalid
                         exit perform cycle
                    end-read
                    evaluate rez-durumu
                       when "I"
*                            perform acenhrk-takvim-sil
*                            move "S"            to rez-durumu
*
*                            move k-kodu-tasi    to rez-staf
*                           accept rez-isl-tar  from century-date
*                            rewrite rez-rec invalid continue 
*                            end-rewrite
*                            perform log-operation-rez
                       when "S"
*                            perform cast-iptal
*                            delete rez invalid continue 
*                            end-delete
*                            perform log-operation-rez
                    end-evaluate
            end-perform
            close rez takvim acenhrk cast
            perform frame-kapat
            set exit-pushed to true
       when 5
            if combo-toplamlar-value(1:1) <> "A"
               perform acu-form4-routine
            end-if
       when 6
            open i-o rez 
            open input aksiyhrk fiyat fiyatana
            inquire form3-gd-1,
                    last-row in sil-son
            initialize frame-degiskenler
            move sil-son           to frame-kayit-sayi
            move 20                to frame-win-line
            move 20                to frame-win-pos
            move "Hesaplaniyor."   to frame-title
            perform frame-ac

            perform varying sil-i from 2 by 1 until sil-i > sil-son
                    perform frame-goster
                    initialize sil-eh
                    inquire form3-gd-1(sil-i,1),
                            hidden-data in sil-eh
                    if sil-eh <> "E"
                       exit perform cycle
                    end-if
                    inquire form3-gd-1(sil-i,2),
                            cell-data in rez-anah
                    read rez no lock invalid
                         exit perform cycle
                    end-read
                        perform peryot-fiyat-bul-1 

                        move ilk-rez-fiyati to rez-fiyati
                        move k-kodu-tasi    to rez-staf
                         
                        accept rez-edit-tarih from century-date  |firat amonra iin konuldu 03/11/2020
                        accept rez-edit-zaman from time          |                           
                
                        rewrite rez-rec invalid continue
                        end-rewrite
*                        perform log-operation-rez
            end-perform
            close rez aksiyhrk fiyat fiyatana
            perform frame-kapat
            set exit-pushed to true
       when 8 
        perform acu-form7-routine
        exit paragraph
    end-evaluate.
*
 Form2-Ex-Other.
    if key-status = 5001
       perform acu-form5-routine
    end-if.
*
 combo-toplamlar-Ex-Ntf-Selchange.
    if combo-toplamlar-value(1:1) = "A"
       modify form2-pb-2,enabled = false
    else
       modify form2-pb-2,enabled = true
    end-if.
*
 Form4-Gd-1-Ev-Msg-Begin-Entry.
    move event-action-fail to event-action.
*
 cb-renklendir.
    evaluate ilk-secilen
         when 01  modify cb-numara,color = 5 
                  move 2 to numara-eh
         when 02  modify cb-islem-tarihi,color = 5 
                  move 2 to islem-tarih-eh
         when 03  modify cb-acenta,color = 5 
                  move 2 to acenta-eh
         when 04  modify cb-musteri-adi,color = 5 
                  move 2 to musteri-adi-eh
         when 05  modify cb-musteri-soyadi,color = 5 
                  move 2 to musteri-soyadi-eh
         when 06  modify cb-cin-tarihi,color = 5 
                  move 2 to c-in-tarih-eh
         when 07  modify cb-cout-tarihi,color = 5 
                  move 2 to c-out-tarih-eh
         when 08  modify cb-voucher,color = 5 
                  move 2 to voucher-eh
         when 99
                  if numara-eh = 1 
                     move 01 to ilk-secilen
                  else
                  if islem-tarih-eh = 1 
                     move 02 to ilk-secilen
                  else
                  if acenta-eh = 1 
                     move 03 to ilk-secilen
                  else
                  if musteri-adi-eh = 1 
                     move 04 to ilk-secilen
                  else
                  if musteri-soyadi-eh = 1 
                     move 05 to ilk-secilen
                  else
                  if c-in-tarih-eh = 1
                     move 06 to ilk-secilen
                  else
                  if c-out-tarih-eh = 1 
                     move 07 to ilk-secilen
                  else
                  if voucher-eh = 1 
                     move 08 to ilk-secilen
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  end-if
                  modify cb-numara,      color = 2 
                  modify cb-islem-tarihi,color  = 2
                  modify cb-acenta      ,color  = 2
                  modify cb-musteri-adi ,color  = 2
                  modify cb-musteri-soyadi,color  = 2
                  modify cb-cin-tarihi,color  = 2
                  modify cb-cout-tarihi,color  = 2
                  modify cb-voucher    ,color  = 2
                  if ilk-secilen = 99
                     move 0 to ilk-secilen
                  end-if
                  if ilk-secilen <> 0  
                     perform cb-renklendir
                  end-if
         when other
              exit paragraph
    end-evaluate.
*
 Form6-Aft-Initdata.
    modify form6-gd-1,
           mass-update = 1 
           reset-grid  = 1
    initialize form6-gd-1-record
    move "No."       to gd-6-col-1
    move "Rapor adi" to gd-6-col-2
    modify form6-gd-1,
           record-to-add(form6-gd-1-record)

    open input rapor
    initialize rapor-rec
    move "A"   to rapor-tipi
    start rapor key not < rapor-anahtar invalid
          continue
    not invalid
    initialize fs-rapor
    perform with test after until fs-rapor = "10"
    read rapor next no lock end move "10" to fs-rapor
    not at end
         if rapor-tipi <> "A"
            move "10" to fs-rapor
            exit perform
         end-if
         initialize form6-gd-1-record
         move rapor-no         to gd-6-col-1
         move rapor-adi        to gd-6-col-2
         modify form6-gd-1,
                record-to-add(form6-gd-1-record)

    end-read
    end-perform
    end-start
    close rapor.

    modify form6-gd-1,
           mass-update = 0.
     .
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 Form6-Ef-1-Aft-Procedure.
     if rapor-no = zeroes 
        modify button-0101,enabled = false
        modify button-0102,enabled = false
     else 
        modify button-0101,enabled = true
        modify button-0102,enabled = true
     end-if.
     open input rapor.
     move "A"      to rapor-tipi
     read rapor no lock invalid
          initialize rapor-adi rapor-gelecek
     end-read
     display accept-0102.
     close rapor.
*
 Form6-Ef-1-Bef-Procedure.
     initialize rapor-rec.
     display accept-0102.
     modify button-0101,enabled = false
     modify button-0102,enabled = false.
*
 Form6-Ex-Other.
     evaluate key-status
           when 7
           when 2
              if numara-eh = 0 and islem-tarih-eh = 0 and
                acenta-eh = 0 and musteri-adi-eh = 0 and
                musteri-soyadi-eh = 0 and c-in-tarih-eh = 0 and
                c-out-tarih-eh = 0 and voucher-eh = 0
                    display message box 
                            "Raporu kaydedebilmeniz icin ana secimlerden birini secmek zorundasiniz !!!"
                            icon mb_warning_icon
                            title "Uyari"
                            move 4 to accept-control
                            move 5 to control-id
                            exit paragraph
              end-if
              open i-o rapor
              move "A" to rapor-tipi
              read rapor no lock invalid
                   continue
              end-read
              move numara-eh         to rapor-cb-1
              move islem-tarih-eh    to rapor-cb-2
              move acenta-eh         to rapor-cb-3
              move musteri-adi-eh    to rapor-cb-4
              move musteri-soyadi-eh to rapor-cb-5
              move c-in-tarih-eh     to rapor-cb-6
              move c-out-tarih-eh    to rapor-cb-7
              move voucher-eh        to rapor-cb-8
              write rapor-rec invalid
                    rewrite rapor-rec end-rewrite
              end-write
              close rapor
              initialize rapor-rec
              display accept-0101 accept-0102
              move 4 to accept-control
              move 4 to control-id
              perform Form6-Aft-Initdata
         when 3
              open i-o rapor
              move "A" to rapor-tipi
              delete rapor invalid continue end-delete
              close rapor
              initialize rapor-rec
              display accept-0101 accept-0102
              move 4 to accept-control
              move 4 to control-id
              perform Form6-Aft-Initdata
     end-evaluate.
*
 Form6-Gd-1-Ev-Other.
    evaluate event-type
        when msg-begin-entry
             move event-action-fail to event-action
             inquire form6-gd-1,y in form6-y
             inquire form6-gd-1(form6-y),
                     record-data in form6-gd-1-record
             move gd-6-col-1     to rapor-no
             display accept-0101
             perform Form6-Ef-1-Aft-Procedure
             move 4 to accept-control
             move 4 to control-id
             exit paragraph
        when msg-goto-cell
        when msg-goto-cell-mouse
        when msg-begin-drag
        when msg-end-drag
        when msg-goto-cell-drag
             inquire form6-gd-1,y in form6-yeni-y
             if form6-yeni-y < 2
                move 2 to form6-yeni-y form6-eski-y
             end-if
             if form6-eski-y > zeroes 
                modify form6-gd-1(form6-eski-y),
                       x = 2
                       row-color = 0

                       cell-color = 0
             end-if
             modify form6-gd-1,
                    y = form6-yeni-y,
                    x = 2,
                    row-color = 480
                    cell-color = 480
             move form6-yeni-y to form6-eski-y
    end-evaluate.
*
 combo-rapor-baslik-Ex-Ntf-Selchange.
    open input rapor.
    move "A" to rapor-tipi
    move rapor-baslik(1:4) to rapor-no
    read rapor no lock invalid
         display message box
                 "Tanimsiz rapor ...."
                 title "Uyari"
                 icon mb_error_icon
         close rapor
         exit paragraph
    end-read
    move rapor-cb-1          to numara-eh
    move rapor-cb-2          to islem-tarih-eh
    move rapor-cb-3          to acenta-eh
    move rapor-cb-4          to musteri-adi-eh
    move rapor-cb-5          to musteri-soyadi-eh
    move rapor-cb-6          to c-in-tarih-eh
    move rapor-cb-7          to c-out-tarih-eh
    move rapor-cb-8          to voucher-eh
    close rapor.

*    display cb-numara cb-islem-tarihi cb-acenta
*    cb-musteri-adi cb-musteri-soyadi cb-cin-tarihi
*    cb-cout-tarihi cb-voucher.
 acenhrk-takvim-sil.
     if rez-k-g-b <> "K"
        exit paragraph
     end-if
     initialize takvim-rec
     move rez-gir-tar to takvim-anah
     start takvim key not < takvim-anah invalid
           continue
     not invalid
     initialize fs-takvim
     perform with test after until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end
          if takvim-anah = rez-cik-tar or 
             takvim-anah > rez-cik-tar
                 move "10" to fs-takvim
                 exit perform
          end-if
          compute takvim-sat-oda(rez-oda-konumu )   =
                  takvim-sat-oda(rez-oda-konumu )   - 1
          compute takvim-sat-buyuk(rez-oda-konumu ) =
                  takvim-sat-buyuk(rez-oda-konumu ) - rez-buyuk
          compute takvim-sat-kucuk(rez-oda-konumu ) =
                  takvim-sat-kucuk(rez-oda-konumu ) - rez-kucuk
          compute takvim-sat-free(rez-oda-konumu )  =
                  takvim-sat-free(rez-oda-konumu )  - rez-free
          compute takvim-sat-free(rez-oda-konumu )  =
                  takvim-sat-free(rez-oda-konumu )  - rez-bebek
          rewrite takvim-rec invalid continue end-rewrite

          move rez-acenta       to acenhrk-acenta
          move takvim-anah      to acenhrk-tarih
          move rez-oda-konumu   to acenhrk-oda-konumu
          move rez-s-d-t-g      to acenhrk-s-d-t-g
          read acenhrk invalid 
               exit perform cycle
          end-read
          compute acenhrk-sat-oda   = acenhrk-sat-oda   - 1
          compute acenhrk-sat-buyuk = acenhrk-sat-buyuk - rez-buyuk
          compute acenhrk-sat-kucuk = acenhrk-sat-kucuk - rez-kucuk
          compute acenhrk-sat-free  = acenhrk-sat-free  - rez-free
          compute acenhrk-sat-free  = acenhrk-sat-free  - rez-bebek
          rewrite acenhrk-rec invalid continue end-rewrite
     end-read
     end-perform
     end-start.

 cast-iptal.
     initialize cast-rec
     move rez-no          to cast-rez-no
     start cast key not < cast-anah1 invalid
           continue
     not invalid
     initialize fs-cast
     perform with test after until fs-cast = "10"
     read cast next no lock end move "10" to fs-cast
     not at end
          if cast-rez-no > rez-no
             move "10" to fs-cast
             exit perform
          end-if
          if cast-rez-no <> rez-no
             exit perform cycle
          end-if
          delete cast end-delete
          perform log-operation-cast
     end-read
     end-perform
     end-start.
*
* 
 peryot-fiyat-bul.
       move rez-odeme-tipi          to kodlar02-kodu
        move "B"                     to kodlar02-tipi
        read kodlar02 no lock invalid
             move "Tanimsiz"  to kodlar02-adi
        end-read
       
      if ode-posting = "H" then        
          initialize top-rez-fiyati
          exit paragraph
      end-if 
     open input takvim
     initialize aksiyhrk-rec special-var-yok
     move "O"              to aksiyhrk-tipi
     move rez-acenta       to aksiyhrk-acenta
     move rez-gir-tar      to aksiyhrk-tarih
     move rez-pan-tipi     to aksiyhrk-pan-tipi
     move g-bul-gun-sayisi to aksiyhrk-gecele

     read aksiyhrk no lock
       invalid
         continue
       not invalid
         set special-var to true
         move aksiyhrk-gecele   to special-gece 
         move aksiyhrk-ode      to special-tahsil 
         move aksiyhrk-hes-tipi to special-hes-tipi
         move aksiyhrk-ekle     to special-ekle
     end-read
     
     initialize aksiyhrk-rec aksiyon-durumu
     move "A"              to aksiyhrk-tipi
     move rez-acenta       to aksiyhrk-acenta
     move rez-gir-tar      to aksiyhrk-tarih
     move rez-pan-tipi     to aksiyhrk-pan-tipi
     move g-bul-gun-sayisi to aksiyhrk-gecele
     read aksiyhrk no lock invalid
          continue
     not invalid
          set aksiyon-var to true
     end-read
      if rez-aksiyon-eh = "H" then
       set aksiyon-yok to true
     end-if
     if rez-special-eh = 1 
       set special-yok to true
     end-if
     move rez-fiyati    to ilk-rez-fiyati

     initialize g-bul-gun-sayisi  kacinci-gece
                takvim-rec top-rez-fiyati
     move rez-gir-tar   to takvim-anah
     start takvim key not < takvim-anah
           invalid
                move 1 to g-bul-gun-sayisi
     not invalid
     initialize fs-takvim
     perform with test after until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end
          if takvim-anah = rez-cik-tar
             move "10" to fs-takvim
             exit perform cycle
          end-if
          if takvim-anah not > rez-cik-tar
             perform fiyat-bul thru fiyat-bul-exit
             if takvim-anah = rez-gir-tar 
                      and fiyatana-fiks = 1 then
                           move "E" to rez-fiyat-fix 
                  end-if
             add 1 to g-bul-gun-sayisi kacinci-gece
              if kacinci-gece > aksiyhrk-ode and aksiyon-var 
              and aksiyhrk-sondan = 1 then
                  if special-var

                    if special-ekle = 1 then move -1 to special-eksi-car
                     else move 1 to special-eksi-car
                     end-if
                     evaluate special-hes-tipi
                       when 1
                           compute top-rez-fiyati rounded = top-rez-fiyati - 
                                 (((special-tahsil) * (rez-buyuk + ( rez-kucuk / 2 ) ) / special-gece)
                                 * special-eksi-car )
                       when 2
                           compute top-rez-fiyati rounded = top-rez-fiyati - 
                                 (((special-tahsil) * (rez-buyuk + ( rez-kucuk ) ) / special-gece)
                                  * special-eksi-car )
                       when 3
                           compute top-rez-fiyati rounded = top-rez-fiyati - 
                                 (((special-tahsil) / special-gece)
                                  * special-eksi-car )
                       when 4
                           compute top-rez-fiyati rounded = top-rez-fiyati - 
                                 (((special-tahsil) * rez-buyuk)
                                  * special-eksi-car )
                       when 5
                           compute top-rez-fiyati rounded = top-rez-fiyati - 
                                 (((special-tahsil) * (rez-buyuk + ( rez-kucuk / 2 ) ) )
                                  * special-eksi-car )
                       when 6
                           compute top-rez-fiyati rounded = top-rez-fiyati - 
                                 (((special-tahsil) * (rez-buyuk + ( rez-kucuk ) ) )
                                  * special-eksi-car )
                       when 7
                           compute top-rez-fiyati rounded = top-rez-fiyati - 
                                 (((special-tahsil))
                                  * special-eksi-car )
        
                       when other
                           compute top-rez-fiyati rounded = top-rez-fiyati - 
                                 (((special-tahsil) * rez-buyuk / special-gece)
                                  * special-eksi-car )
                      end-evaluate 

                     
                     end-if
                  else
                  compute top-rez-fiyati
                        = top-rez-fiyati + ilk-rez-fiyati
                  end-if
          else
             move "10" to fs-takvim
          end-if
     end-read
     end-perform.

     close takvim.

 peryot-fiyat-bul-1.
     open input takvim
     move rez-fiyati    to ilk-rez-fiyati

     initialize g-bul-gun-sayisi
                takvim-rec top-rez-fiyati
     move rez-gir-tar   to takvim-anah
     start takvim key not < takvim-anah
           invalid
                move 1 to g-bul-gun-sayisi
     not invalid
     initialize fs-takvim
     perform with test after until fs-takvim = "10"
     read takvim next no lock end move "10" to fs-takvim
     not at end
          if takvim-anah = rez-cik-tar
             move "10" to fs-takvim
             exit perform cycle
          end-if
          if takvim-anah not > rez-cik-tar
             add 1 to g-bul-gun-sayisi
          else
             move "10" to fs-takvim
          end-if
     end-read
     end-perform.

     close takvim.
     initialize aksiyhrk-rec aksiyon-durumu
     move "O"              to aksiyhrk-tipi
     move rez-acenta       to aksiyhrk-acenta
     move rez-gir-tar      to aksiyhrk-tarih
     move rez-pan-tipi     to aksiyhrk-pan-tipi
     move g-bul-gun-sayisi to aksiyhrk-gecele

     read aksiyhrk no lock
       invalid
         continue
       not invalid
         set special-var to true
         move aksiyhrk-gecele   to special-gece 
         move aksiyhrk-hes-tipi to special-hes-tipi
            move aksiyhrk-ekle     to special-ekle
         move aksiyhrk-ode      to special-tahsil 
     end-read
     
     initialize aksiyhrk-rec aksiyon-durumu
     move "A"              to aksiyhrk-tipi
     move rez-acenta       to aksiyhrk-acenta
     move rez-gir-tar      to aksiyhrk-tarih
     move rez-pan-tipi     to aksiyhrk-pan-tipi
     move g-bul-gun-sayisi to aksiyhrk-gecele
     read aksiyhrk no lock invalid
          continue
     not invalid
          set aksiyon-var to true
     end-read.
*****>Ayni yer perform edildigi icin giris tarihindeki fiyati bulmasi icin konuldu
        move rez-gir-tar   to takvim-anah.
*****>Ayni yer perform edildigi icin giris tarihindeki fiyati bulmasi icin konuldu
     perform fiyat-bul thru fiyat-bul-exit.

 fiyat-bul.
    if rez-fiyat-fix = "E"
       go fiyat-bulundu
    end-if.

     move 0 to oda-fiyati. 
     move rez-acenta        to fiyat-acenta. 
     move takvim-anah       to fiyat-tarih. 
     move rez-tipi          to fiyat-rez-tipi. 
     move rez-pan-tipi      to fiyat-pan-tipi. 
     move rez-banka         to fiyat-banka. 
     move rez-doviz         to fiyat-doviz. 
     move rez-anlasma       to fiyat-anlasma. 
     move rez-buyuk         to fiyat-buyuk.
     move rez-kucuk         to fiyat-kucuk.
     read fiyat no lock invalid
          go fiyat-bulundu.
     move fiyat-acenta    to fiyatana-acenta. 
     move fiyat-bas-tarih to fiyatana-ilk-tarih.
     move fiyat-bit-tarih to fiyatana-son-tarih.
     move fiyat-rez-tipi  to fiyatana-rez-tipi. 
     move fiyat-pan-tipi  to fiyatana-pan-tipi. 
     move fiyat-banka     to fiyatana-banka. 
     move fiyat-doviz     to fiyatana-doviz. 
     move fiyat-anlasma   to fiyatana-anlasma. 
     move fiyat-buyuk     to fiyatana-buyuk.
     move fiyat-kucuk     to fiyatana-kucuk.
     read fiyatana no lock invalid 
          go fiyat-bulundu.

     move fiyatana-oda-fiyati(rez-oda-konumu) to oda-fiyati. 

     if rez-fiyat-konumu not = spaces and
        rez-fiyat-konumu not = zeroes
        move fiyatana-oda-fiyati(rez-fiyat-konumu) to oda-fiyati 
     end-if

*/********* 
       if rez-nor-indirim not = 0 
       compute oda-fiyati rounded = 
              (((oda-fiyati * rez-nor-indirim) / 100) - oda-fiyati)
       end-if.
*/Early booking orani var ve early booking uygulanacak ise 
     if (rez-eb = "E" or rez-eb = "1" ) and fiyatana-eb-oran not = 0 
     compute oda-fiyati rounded = 
            (((oda-fiyati * (fiyatana-eb-oran + (fiyatana-eb-kusur / 100)) / 100) - oda-fiyati))
     end-if. 

     if rez-ug-ind = 1 and fiyatana-ug-oran not = 0 
      
     compute oda-fiyati rounded = 
            (((oda-fiyati * (fiyatana-ug-oran + (fiyatana-ug-kusur / 100)) / 100) - oda-fiyati))
     end-if. 
      if rez-ozel-durum-car > 0
       
       compute oda-fiyati rounded = 
              (oda-fiyati * rez-ozel-durum-car) / 100
       end-if.

*/Kick back
     
     if fiyatana-kick-back not = 0 
     compute oda-fiyati rounded = 
            (((oda-fiyati * fiyatana-kick-back) / 1000) - oda-fiyati)
     end-if. 
      if fiyatana-kick-back2 <> 0
       compute oda-fiyati rounded = 
              (((oda-fiyati * fiyatana-kick-back2) / 1000) - oda-fiyati)
       end-if.
      
 aksiyonlu-uyar. 
*     if rez-eb = "E" and fiyatana-eb-oran not = 0 
*        and eb-de-aksiyon-hesaplama = 1
*        set aksiyon-yok to true
*     end-if

     if rez-aksiyon-eh = "H" 
        set aksiyon-yok to true
     else
        if (rez-eb = "E" or rez-eb = "1" )  and fiyatana-eb-oran not = 0 
           and eb-de-aksiyon-hesaplama = 1
           set aksiyon-yok to true
        end-if
     end-if

     if aksiyon-var
        if aksiyhrk-sondan not = 1 then 
          compute oda-fiyati rounded = ((oda-fiyati * aksiyhrk-ode) / aksiyhrk-gecele)
          end-if   
        end-if
        
        if rez-special-eh = 1 
        set special-yok to true
        initialize special-tahsil
*     else
*        if rez-eb = "E" and fiyatana-eb-oran not = 0
*           set aksiyon-yok to true
*        end-if
     end-if
       
     if special-var
        if special-ekle = 1 then move -1 to special-eksi-car
             else move 1 to special-eksi-car
             end-if
             evaluate special-hes-tipi
               when 1
                   compute oda-fiyati rounded = oda-fiyati - 
                         (((special-tahsil) * (rez-buyuk + ( rez-kucuk / 2 ) ) / special-gece)
                         * special-eksi-car )
               when 2
                   compute oda-fiyati rounded = oda-fiyati - 
                         (((special-tahsil) * (rez-buyuk + ( rez-kucuk ) ) / special-gece)
                          * special-eksi-car )
               when 3
                   compute oda-fiyati rounded = oda-fiyati - 
                         (((special-tahsil) / special-gece)
                          * special-eksi-car )
               when 4
                   compute oda-fiyati rounded = oda-fiyati - 
                         (((special-tahsil) * rez-buyuk)
                          * special-eksi-car )
               when 5
                   compute oda-fiyati rounded = oda-fiyati - 
                         (((special-tahsil) * (rez-buyuk + ( rez-kucuk / 2 ) ) )
                          * special-eksi-car )
               when 6
                   compute oda-fiyati rounded = oda-fiyati - 
                         (((special-tahsil) * (rez-buyuk + ( rez-kucuk ) ) )
                          * special-eksi-car )
               when 7
                   compute oda-fiyati rounded = oda-fiyati - 
                         (((special-tahsil))
                          * special-eksi-car )

               when other
                   compute oda-fiyati rounded = oda-fiyati - 
                         (((special-tahsil) * rez-buyuk / special-gece)
                          * special-eksi-car )
              end-evaluate 
          
     
         
         
    end-if
         
*****if oda-fiyati <> rez-fiyati 
        move oda-fiyati  to ilk-rez-fiyati.
 aksiyonlu-uyar-exit. 
     exit. 

 fiyat-bulundu. 
 fiyat-bul-exit. 
     exit.
*
 Form7-Ex-Other.
    evaluate key-status
       when 2010 
            open i-o rez 

            inquire form3-gd-1,
                    last-row in sil-son
            initialize frame-degiskenler
            move sil-son           to frame-kayit-sayi
            move 20                to frame-win-line
            move 20                to frame-win-pos
            move "Hesaplaniyor."   to frame-title
            perform frame-ac

            perform varying sil-i from 2 by 1 until sil-i > sil-son
                    perform frame-goster
                    initialize sil-eh
                    inquire form3-gd-1(sil-i,1),
                            hidden-data in sil-eh
                    if sil-eh <> "E"
                       exit perform cycle
                    end-if
                    inquire form3-gd-1(sil-i,2),
                            cell-data in rez-anah
                    read rez no lock invalid
                         exit perform cycle
                    end-read
                        initialize acen-degis yeni-konum
                        if degis-acenta not = spaces
                           move degis-acenta to rez-acenta
                           move 1 to acen-degis
                        end-if

                        inquire combo-oda-konumu-a value in yeni-konum
                        if yeni-konum not = 0 
                           move yeni-konum to rez-oda-konumu rez-fiyat-konumu
                           move 2 to acen-degis
                        end-if
                        if acen-degis not = 0
                            
                           accept rez-edit-tarih from century-date  |firat amonra iin konuldu 03/11/2020
                           accept rez-edit-zaman from time          |                           
                
                           rewrite rez-rec invalid continue
                           end-rewrite
*                           perform log-operation-rez
                        end-if
            end-perform
            close rez 
            perform frame-kapat
            set exit-pushed to true
       when 2009 
            set exit-pushed to true
     .
*
 Form7-Aft-Initdata.
     modify combo-oda-konumu,        reset-list = 1 mass-update = 1.
     modify combo-oda-konumu-a,
     item-to-add("00-Degistirme")
    
     open input konum
     initialize konum-rec
     start konum key not < konum-anahtar invalid
           continue
     not invalid
     initialize fs-konum
     perform with test after until fs-konum = "10"
     read konum next no lock end move "10" to fs-konum
     not at end
          initialize temp-x
          move konum-anahtar to temp-x
          move "-"           to temp-x(3:)
          move konum-adi     to temp-x(4:)
          modify combo-oda-konumu-a,
                 item-to-add(temp-x)
          
     end-read
     end-perform
     end-start
     close konum.
     modify combo-oda-konumu-a,   mass-update = 0
                                value combo-oda-konumu-value-a.
   
     .
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 yardimlar.
     evaluate control-id
       when 129
       when 130
        initialize acn-grup-kod
             call "/asya/ytl/obj/otel/grupara.asy" 
                  using "A", acn-grup-kod  
                  on exception 
                     perform callerr-proc
                  not on exception
                  if  acn-grup-kod not = spaces 
                     MOVE acn-grup-kod to  acentagrup
                     display acc-acenta-grup
                  end-if
             end-call          
       when 28
       when 48 perform ilk-acenta-ara
       when 29
       when 49 perform son-acenta-ara
       when 54
       when 55 perform banka-ara
       when 58
       when 59 perform doviz-ara
       when 62
       when 63 perform anlasma-ara
       when 66
       when 67 perform odeme-ara
       when 74
       when 75 perform ulke-ara
       when 82
       when 83 perform pazar-ara
       when 70
       when 71 perform pansiyon-ara
       when 105 perform kaynak1-ara
       when 109 perform kaynak2-ara
       when 113 perform kaynak3-ara
       when 120 when 119 perform ozel-durum-ara
       when 125 when 126 perform op-ara
     end-evaluate
     .
*
 ilk-acenta-ara.
     perform acenta-ara
     move acenta-cagir to bas-acenta
     display acc-bas-acenta
     .
*
 son-acenta-ara.
     perform acenta-ara
     move acenta-cagir to bit-acenta
     display acc-bit-acenta
     .
*
 acenta-ara.
     initialize acenta-cagir
     call "/asya/ytl/obj/otel/acenara.asy" 
       using acenta-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/acenara.asy"
     end-call
     .
*
 banka-ara.
     call "/asya/ytl/obj/otel/bankaara.asy" 
       using bas-banka-kodu  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/bankaara.asy"
     end-call
     display acc-bas-banka-kodu
     .
*
 doviz-ara.
     call "/asya/ytl/obj/otel/dovizara.asy" 
       using bas-doviz-kodu  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/dovizara.asy"
     end-call
     display acc-bas-doviz-kodu
     .
*
 anlasma-ara.
     move "D" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/infoxara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/infoxara.asy"
     end-call
     move infox-kodu-cagir to bas-anlasma-kodu
     display acc-bas-anlasma-kodu
     .
*
 odeme-ara.
     move "B" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/odemeara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/odemeara.asy"
     end-call
     move infox-kodu-cagir to bas-odeme-kodu
     display acc-bas-odeme-kodu
     .
*
 ulke-ara.
     call "/asya/ytl/obj/otel/ulkeara.asy" 
       using bas-ulke-kodu  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/ulkeara.asy"
     end-call
     display acc-bas-ulke-kodu
     .
*
 pazar-ara.
     move "E" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/pazarara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/pazarara.asy"
     end-call
     move infox-kodu-cagir to bas-pazar-kodu
     display acc-bas-pazar-kodu
     .
*
 pansiyon-ara.
     move "A" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/panara.asy" 
       using infox-cagir  
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/panara.asy"
     end-call
     move infox-kodu-cagir to bas-pansiyon-kodu
     display acc-bas-pansiyon-kodu
     .
*
 op-ara.
    initialize infox-cagir.
    move "O"   to infox-tipi-cagir
    call "/asya/ytl/obj/otel/opara.asy"
      using infox-cagir
      on exception
         perform callerr-proc
      not on exception
         cancel "/asya/ytl/obj/otel/opara.asy" 
    end-call
    move infox-kodu-cagir     to bas-opetaror-kodu
     display acc-bas-operator-kodu.
    
*
 ozel-durum-ara.
     move "Z" to infox-tipi-cagir
     call "/asya/ytl/obj/otel/ozelara.asy" 
       using infox-cagir                                       
       on exception 
          perform callerr-proc
       not on exception
          cancel "/asya/ytl/obj/otel/ozelara.asy"
     end-call
     move infox-kodu-cagir to bas-ozel-durum-kodu
     display acc-bas-ozel-durum-kodu
     .

*
 kaynak1-ara.
    initialize kaynak-cagir.
    move "AB"   to kaynak-tipi-cagir.
    call "/asya/ytl/obj/otel/kynk1ara.asy"
      using kaynak-cagir
      on exception
         perform callerr-proc
      not on exception
         cancel "/asya/ytl/obj/otel/kynk1ara.asy" 
    end-call
    move kaynak-kodu-cagir     to bas-kaynak1-kodu
    display acc-bas-kaynak1-kodu.
*
 kaynak2-ara.
    initialize kaynak-cagir.
    move "AC"   to kaynak-tipi-cagir.
    call "/asya/ytl/obj/otel/kynk2ara.asy"
      using kaynak-cagir
      on exception
         perform callerr-proc
      not on exception
         cancel "/asya/ytl/obj/otel/kynk2ara.asy" 
    end-call
    move kaynak-kodu-cagir     to bas-kaynak2-kodu
    display acc-bas-kaynak2-kodu.
*
 kaynak3-ara.
    initialize kaynak-cagir.
    move "AD"   to kaynak-tipi-cagir.
    call "/asya/ytl/obj/otel/kynk3ara.asy"
      using kaynak-cagir
      on exception
         perform callerr-proc
      not on exception
         cancel "/asya/ytl/obj/otel/kynk3ara.asy" 
    end-call
    move kaynak-kodu-cagir     to bas-kaynak3-kodu
    display acc-bas-kaynak3-kodu.
*
*
 Form5-Aft-Initdata.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
     .
 yeniden-hesapla.
       initialize linkh-odahes
        move rez-no to  linkh-rez-no     
         move 7 to linkh-nereden  
         move 1 to linkh-anl-yaz
        
*         if XREZ-FIYAT-FIX not = "E"
           move  1 to linkh-cast-yaz
*         end-if
          call "/asya/ytl/obj/otel/odahes.asy" 
                        using  rez-rec   linkh-odahes
                        on exception 
                        perform callerr-proc
                        exit paragraph
                        not on exception 
                   cancel "/asya/ytl/obj/otel/odahes.asy"
         end-call
         .
            

 
 
 
 
          .
*
 acc-bas-ozel-durum-kodu-Aft-Procedure.
     initialize gec-gecme.
     if bas-ozel-durum-kodu <> spaces
        open input kodlar02
        move "Z"                 to kodlar02-tipi
        move bas-ozel-durum-kodu   to kodlar02-kodu
        read kodlar02 no lock invalid
             move "Tanimsiz ..." to kodlar02-adi
             move 1 to gec-gecme
        end-read
        close kodlar02
     else
        move "Tumu ..."       to kodlar02-adi
     end-if.
     display lb-ozel-durum-adi.
*
 acc-bas-operator-kodu-Aft-Procedure.
       if bas-opetaror-kodu not = spaces
       open input kodlar02
           initialize kodlar02-rec     
           move "O" to kodlar02-tipi
           move  bas-opetaror-kodu to kodlar02-kodu
           read kodlar02 no lock invalid
               move "Tanimsiz ..." to kodlar02-adi
               move 1 to gec-gecme
           end-read
           display lb-pansiyon-adia
        close kodlar02 
       end-if.
*
 acc-bas-kaynak3-kodua-Aft-Procedure.
     if acentagrup <> spaces
        open input grup
        initialize grup-rec
        move "A" to grup-tipi 
        move acentagrup to grup-kodu
        
          read grup   no lock 
             invalid
               move "Tanimsiz" to grup-adi
             not  invalid
              continue
        end-read
        close grup
     else
        move "Tumu ... " to grup-adi
     end-if.
     display l-grup.     
     .
*
 Form1-Aft-Routine.
     close odalar2
     .

 
