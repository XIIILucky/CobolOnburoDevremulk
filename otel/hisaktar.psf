; CASEMaker AcuBench Program Structure File, Version 9.2
; WARNING: DO NOT MODIFY THIS FILE!

[PROGRAM_CONTENT]
QUIT_CONFIRM=0
MAIN_SCREEN_NAME=Form1

{{@DESCRIPTION:

@}}

[WORKING_STORAGE]
m_nType=1
m_strName=Working Storage
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionWK

@}}
[FDITEM0_WK]
m_strName=mesaj
m_strRawPic=x(60)
m_strPic=x(60)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_WK

@}}
[FDITEM1_WK]
m_strName=pan-toplam
m_strRawPic=9(9)v99
m_strPic=9(9)v99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_WK

@}}
[FDITEM2_WK]
m_strName=gidis-id
m_strRawPic=9(04)
m_strPic=9(04)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM2_WK

@}}
[FDITEM3_WK]
m_strName=rapor-bas-tarih
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM3_WK

@}}
[FDITEM4_WK]
m_nType=10
m_strName=rapor-bas-yil
m_strRawPic=9(04)
m_strPic=9(04)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_rapor_b__2
{{@DataItem_m_strDescriptionFDITEM4_WK

@}}
[FDITEM5_WK]
m_nType=10
m_strName=rapor-bas-ay
m_strRawPic=9(02)
m_strPic=9(02)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_rapor_b__1
{{@DataItem_m_strDescriptionFDITEM5_WK

@}}
[FDITEM6_WK]
m_nType=10
m_strName=rapor-bas-gun
m_strRawPic=9(02)
m_strPic=9(02)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM6_WK

@}}
[FDITEM7_WK]
m_strName=rapor-bit-tarih
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM7_WK

@}}
[FDITEM8_WK]
m_nType=10
m_strName=rapor-bit-yil
m_strRawPic=9(04)
m_strPic=9(04)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_rapor_b__2
{{@DataItem_m_strDescriptionFDITEM8_WK

@}}
[FDITEM9_WK]
m_nType=10
m_strName=rapor-bit-ay
m_strRawPic=9(02)
m_strPic=9(02)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=Copy_of_rapor_b__1
{{@DataItem_m_strDescriptionFDITEM9_WK

@}}
[FDITEM10_WK]
m_nType=10
m_strName=rapor-bit-gun
m_strRawPic=9(02)
m_strPic=9(02)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=rapor_bas_gun__1
{{@DataItem_m_strDescriptionFDITEM10_WK

@}}
[FDITEM11_WK]
m_strName=gec-gecme
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM11_WK

@}}
[FDITEM12_WK]
m_strName=carpan
m_strRawPic=s9
m_strPic=s9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM12_WK

@}}
[FDITEM13_WK]
m_strName=fs-takas
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM13_WK

@}}
[FDITEM14_WK]
m_strName=takas-dosya
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM14_WK

@}}
[FDITEM15_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=x(20)
m_strDefaultValue="/asya/ytl/liste/hakt"
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM15_WK

@}}
[FDITEM16_WK]
m_strName=takas-k
m_strRawPic=x(4)
m_strPic=x(4)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM16_WK

@}}
[FDITEM17_WK]
m_strName=d
m_strRawPic=9
m_strPic=9
m_strDefaultValue=0
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM17_WK

@}}
[FDITEM18_WK]
m_strName=pan-dagilim
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM18_WK

@}}
[FDITEM19_WK]
m_strName=kahvalti-var
m_strRawPic=x
m_strPic=x
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM19_WK

@}}
[FDITEM20_WK]
m_strName=ogle-var
m_strRawPic=x
m_strPic=X
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM20_WK

@}}
[FDITEM21_WK]
m_strName=aksam-var
m_strRawPic=x
m_strPic=X
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM21_WK

@}}
[FDITEM22_WK]
m_strName=icecek-var
m_strRawPic=x
m_strPic=X
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM22_WK

@}}
[FDITEM23_WK]
m_strName=extra-var
m_strRawPic=x
m_strPic=X
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM23_WK

@}}
[FDITEM24_WK]
m_nType=10
m_strName=Small-Font
m_nUsage=37
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM24_WK

@}}
[FDITEM25_WK]
m_nType=10
m_strName=Form1-Handle
m_nUsage=24
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM25_WK

@}}
[FDITEM26_WK]
m_nType=10
m_strName=Default-Font
m_nUsage=38
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM26_WK

@}}
[FDITEM27_WK]
m_nType=10
m_strName=Form1-St-1-Handle
m_nUsage=51
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM27_WK

@}}
[FDITEM28_WK]
m_strName=son-gun
m_strRawPic=x
m_strPic=x
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM28_WK

@}}
[FDITEM29_WK]
m_strName=oda-sayi
m_strRawPic=9
m_strPic=9
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM29_WK

@}}
[FDITEM30_WK]
m_strName=link-var
m_strRawPic=9
m_strPic=9
m_nUsage=2
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM30_WK

@}}
[FDITEM31_WK]
m_strName=corr-tutarlar
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM31_WK

@}}
[FDITEM32_WK]
m_strName=corr-oda-tutar
m_strRawPic=s9(9)v99
m_strPic=s9(9)v99
m_nUsage=4
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM32_WK

@}}
[FDITEM33_WK]
m_strName=corr-extbed-tutar
m_strRawPic=s9(9)v99
m_strPic=s9(9)v99
m_nUsage=4
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM33_WK

@}}
[FDITEM34_WK]
m_strName=corr-kahvalti-tutar
m_strRawPic=s9(9)v99
m_strPic=s9(9)v99
m_nUsage=4
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM34_WK

@}}
[FDITEM35_WK]
m_strName=corr-ogle-tutar
m_strRawPic=s9(9)v99
m_strPic=s9(9)v99
m_nUsage=4
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM35_WK

@}}
[FDITEM36_WK]
m_strName=corr-aksam-tutar
m_strRawPic=s9(9)v99
m_strPic=s9(9)v99
m_nUsage=4
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM36_WK

@}}
[FDITEM37_WK]
m_strName=corr-icecek-tutar
m_strRawPic=s9(9)v99
m_strPic=s9(9)v99
m_nUsage=4
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM37_WK

@}}
[FDITEM38_WK]
m_strName=corr-extra-tutar
m_strRawPic=s9(9)v99
m_strPic=s9(9)v99
m_nUsage=4
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM38_WK

@}}
[FDITEM39_WK]
m_strName=i
m_strRawPic=99
m_strPic=99
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM39_WK

@}}
[FDITEM40_WK]
m_strName=oda-var
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM40_WK

@}}
[FDITEM41_WK]
m_strName=ilk-break-tar
m_strRawPic=x(8)
m_strPic=x(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM41_WK

@}}
[FDITEM42_WK]
m_nType=10
m_strName=cb-1-val
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM42_WK

@}}
[FDITEM43_WK]
m_nType=10
m_strName=break-ayir
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM43_WK

@}}
[FDITEM44_WK]
m_nType=10
m_strName=share-bul
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM44_WK

@}}
[FDITEM45_WK]
m_nType=10
m_strName=break-ayir-yeni
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM45_WK

@}}


[LINKAGE_SECTION]
m_nType=1
m_strName=Linkage Section
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionLK

@}}
[FDITEM0_LK]
m_strName=link-1
m_strRawPic=9
m_strPic=9
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_LK

@}}


{{@SCREEN:
*   Screen Painter Data
*   Schema 6.0
*
BEGIN-SPDATA

GRAPHICAL-SCREEN

Begin Screen Form1
   PREFIX            = Form1
   LOCK-CONTROL      = FALSE
   (Name)            = Form1
   Absolute Column   = 0
   Absolute Line     = 0
   Action            = (None)
   Auto Minimize     = FALSE
   Auto Resize       = FALSE
   Bind To Thread    = FALSE
   Boxed             = FALSE
   Cell              = TRUE
   Cell Height       = 10
   Cell Measure      = Pixels
   Cell Width        = 10
   Color             = 65793
   Controls Uncropped = FALSE
   Erase Screen      = FALSE
   Font              = Small Font
   Font Variable     = Small-Font
   Handle Variable   = Form1-Handle
   Help ID           = 301002
   Label Offset      = 0
   Layout Manager    = None
   Lines             = 22.50
   Link To Thread    = TRUE
   Max Lines         = 0.00
   Max Size          = 0.00
   Measuring Control = Label
   Measuring Font    = Default Font
   Measuring Style   = [None]
   Min Lines         = 0.00
   Min Size          = 0.00
   Modeless          = FALSE
   No Close          = FALSE
   Resizable         = FALSE
   Scroll            = FALSE
   Size              = 41.50
   System Menu       = TRUE
   Title             = "History Istatistikleri Olustur ..."
   Title Bar         = TRUE
   Unit              = Cells
   User Gray         = TRUE
   User White        = TRUE
   Visible           = 1:TRUE
   Window Type       = Floating
   Wrap              = FALSE
   Exception Procedure = Form1-Exception-Proc
   Other(ex)         = exception-procedure
   Before Create     = Form1-Bef-Create
   After Initdata    = Form1-Aft-Initdata
   After Routine     = Form1-Aft-Routine
   Begin Frame Form1-Fr-1
      SCREEN-COL        = 1.50
      SCREEN-LINE       = 1.50
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Fr-1
      3D Style          = Raised
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 1.50
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 1
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.50
      Lines             = 15.50
      Low Color         = 0
      Size              = 40.50
      Tab Order         = 1
      Thickness         = Default
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Frame Form1-Fr-2
         SCREEN-COL        = 2.00
         SCREEN-LINE       = 2.00
         LOCK-CONTROL      = FALSE
         (Name)            = Form1-Fr-2
         3D Style          = Lowered
         Alternate         = FALSE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 1.50
         Csize             = 0
         Destroy Type      = Automatic
         Font              = Default Font
         Full Height       = FALSE
         Help ID           = 0
         High Color        = 0
         ID                = 2
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 1.50
         Lines             = 14.50
         Low Color         = 0
         Size              = 39.50
         Tab Order         = 1
         Thickness         = Default
         Title Position    = 0:Unaligned
         Visible           = 1:TRUE
         Begin Label Form1-La-1
            SCREEN-COL        = 3.00
            SCREEN-LINE       = 3.50
            LOCK-CONTROL      = TRUE
            (Name)            = Form1-La-1
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 2.00
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 3
            Justification     = Right
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.50
            Lines             = 2.00
            No Key Letter     = FALSE
            Size              = 10.50
            Tab Order         = 1
            Title             = "Baslangic Tarihi :"
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Entry-Field Form1-Ef-1
            SCREEN-COL        = 15.00
            SCREEN-LINE       = 3.50
            LOCK-CONTROL      = TRUE
            (Name)            = Form1-Ef-1
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 14.00
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 4
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.50
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 2
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 2.50
            Style             = Singleline
            Tab Order         = 2
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = rapor-bas-gun
            Visible           = 1:TRUE
            Before Procedure  = Before-Procedure
         End
         Begin Entry-Field Form1-Ef-1a
            SCREEN-COL        = 18.50
            SCREEN-LINE       = 3.50
            LOCK-CONTROL      = TRUE
            (Name)            = Form1-Ef-1a
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 17.50
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 5
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.50
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 2
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 2.50
            Style             = Singleline
            Tab Order         = 3
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = rapor-bas-ay
            Visible           = 1:TRUE
            Before Procedure  = Before-Procedure
         End
         Begin Entry-Field Form1-Ef-1aa
            SCREEN-COL        = 22.00
            SCREEN-LINE       = 3.50
            LOCK-CONTROL      = TRUE
            (Name)            = Form1-Ef-1aa
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 21.00
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 6
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.50
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 4
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 4.00
            Style             = Singleline
            Tab Order         = 4
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = rapor-bas-yil
            Visible           = 1:TRUE
            Before Procedure  = Before-Procedure
         End
         Begin Label Form1-La-1a
            SCREEN-COL        = 3.00
            SCREEN-LINE       = 6.00
            LOCK-CONTROL      = TRUE
            (Name)            = Form1-La-1a
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 2.00
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 7
            Justification     = Right
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 5.00
            Lines             = 2.00
            No Key Letter     = FALSE
            Size              = 10.50
            Tab Order         = 5
            Title             = "Bitis Tarihi :"
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Entry-Field Form1-Ef-1b
            SCREEN-COL        = 15.00
            SCREEN-LINE       = 6.00
            LOCK-CONTROL      = TRUE
            (Name)            = Form1-Ef-1b
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 14.00
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 8
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 5.00
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 2
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 2.50
            Style             = Singleline
            Tab Order         = 6
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = rapor-bit-gun
            Visible           = 1:TRUE
            Before Procedure  = Before-Procedure
         End
         Begin Entry-Field Form1-Ef-1ab
            SCREEN-COL        = 18.50
            SCREEN-LINE       = 6.00
            LOCK-CONTROL      = TRUE
            (Name)            = Form1-Ef-1ab
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 17.50
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 9
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 5.00
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 2
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 2.50
            Style             = Singleline
            Tab Order         = 7
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = rapor-bit-ay
            Visible           = 1:TRUE
            Before Procedure  = Before-Procedure
         End
         Begin Entry-Field Form1-Ef-1aaa
            SCREEN-COL        = 22.00
            SCREEN-LINE       = 6.00
            LOCK-CONTROL      = TRUE
            (Name)            = Form1-Ef-1aaa
            Auto              = TRUE
            Auto Decimal      = 0
            Border            = 3D
            Case              = Mixed
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 21.00
            Csize             = 0
            Cursor            = 0
            Cursor Col        = 0
            Cursor Row        = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 10
            Justification     = Unaligned
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 5.00
            Lines             = 2.00
            Max Lines         = 0
            Max Text          = 4
            Max Value         = 0
            Min Value         = 0
            No AutoSel        = FALSE
            No Tab            = FALSE
            Notify Change     = FALSE
            Numeric           = TRUE
            Read Only         = FALSE
            Required          = FALSE
            Secure            = FALSE
            Size              = 4.00
            Style             = Singleline
            Tab Order         = 8
            Use Return        = FALSE
            Use Tab           = FALSE
            Value Multiple    = FALSE
            Value Variable    = rapor-bit-yil
            Visible           = 1:TRUE
            Before Procedure  = Before-Procedure
         End
         Begin Label Form1-La-2
            SCREEN-COL        = 2.90
            SCREEN-LINE       = 9.20
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-La-2
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 5
            Column            = 1.90
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 12
            Justification     = Unaligned
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 8.20
            Lines             = 1.50
            No Key Letter     = FALSE
            Size              = 8.00
            Tab Order         = 9
            Title             = "Islem Durumu :"
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Label lb-isl-durumu
            SCREEN-COL        = 12.00
            SCREEN-LINE       = 9.20
            LOCK-CONTROL      = FALSE
            (Name)            = lb-isl-durumu
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 11.00
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 13
            Justification     = Unaligned
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 8.20
            Lines             = 1.50
            No Key Letter     = FALSE
            Size              = 14.00
            Tab Order         = 10
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Label lb-isl-durumu-1
            SCREEN-COL        = 30.10
            SCREEN-LINE       = 9.20
            LOCK-CONTROL      = FALSE
            (Name)            = lb-isl-durumu-1
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 29.10
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 14
            Justification     = Unaligned
            Label Offset      = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 8.20
            Lines             = 1.50
            No Key Letter     = FALSE
            Size              = 10.00
            Tab Order         = 11
            Transparent       = TRUE
            Visible           = 1:TRUE
         End
         Begin Check-Box cb-1
            SCREEN-COL        = 15.10
            SCREEN-LINE       = 10.80
            LOCK-CONTROL      = FALSE
            (Name)            = cb-1
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 14.10
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Default Font
            Help ID           = 0
            ID                = 16
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 9.80
            Lines             = 1.50
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 24.20
            Tab Order         = 12
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Hareketler Kaynak Folio'dan"
            Value             = 1:TRUE
            Value Variable    = cb-1-val
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box cb-1a
            SCREEN-COL        = 15.10
            SCREEN-LINE       = 12.60
            LOCK-CONTROL      = FALSE
            (Name)            = cb-1a
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 14.10
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Default Font
            Help ID           = 0
            ID                = 17
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 11.60
            Lines             = 1.50
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 24.20
            Tab Order         = 13
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Breakdown Ayir"
            Value             = 1:TRUE
            Value Variable    = break-ayir
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
         Begin Check-Box cb-1aa
            SCREEN-COL        = 15.10
            SCREEN-LINE       = 9.00
            LOCK-CONTROL      = FALSE
            (Name)            = cb-1aa
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 14.10
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Default Font
            Help ID           = 0
            ID                = 18
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 8.00
            Lines             = 1.50
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 24.20
            Tab Order         = 14
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Share ata"
            Value             = 1:TRUE
            Value Variable    = share-bul
            Visible           = 1:TRUE
            Visible Variable  = asyami
            Vtop              = FALSE
         End
         Begin Check-Box cb-1ab
            SCREEN-COL        = 15.10
            SCREEN-LINE       = 14.40
            LOCK-CONTROL      = FALSE
            (Name)            = cb-1ab
            Bitmap Frame      = FALSE
            Bitmap Number     = 1
            Bitmap Square     = TRUE
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 0
            Column            = 14.10
            Copy Resource     = TRUE
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Exception Value   = 0
            Flat              = FALSE
            Font              = Default Font
            Help ID           = 0
            ID                = 19
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Left Text         = FALSE
            Line              = 13.40
            Lines             = 1.50
            Multiline         = FALSE
            No Tab            = FALSE
            Notify            = FALSE
            Self Act          = FALSE
            Size              = 24.20
            Tab Order         = 15
            Termination Value = 0
            Text Only         = FALSE
            Title             = "Breakdown Ayir [Yeni Hesaplama]"
            Value             = 1:TRUE
            Value Variable    = break-ayir-yeni
            Visible           = 1:TRUE
            Vtop              = FALSE
         End
      End
   End
   Begin Status-Bar Form1-St-1
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-St-1
      Font              = Default Font
      Font Variable     = Default-Font
      Grip              = TRUE
      Handle Variable   = Form1-St-1-Handle
      PANEL-WIDTHS      = ( 100 )
      PANEL-STYLE       = ( 1 )
      Tab Order         = 2
   End
   Begin Push-Button Form1-Pb-1
      SCREEN-COL        = 15.20
      SCREEN-LINE       = 17.50
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Pb-1
      Bitmap Frame      = FALSE
      Bitmap Number     = 1
      Bitmap Square     = TRUE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 15.20
      Copy Resource     = TRUE
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Exception Value   = 2
      Flat              = FALSE
      Font              = Default Font
      Help ID           = 0
      ID                = 11
      Is Link           = FALSE
      Key               = 4
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 17.50
      Lines             = 3.00
      Multiline         = FALSE
      No Auto Default   = FALSE
      No Tab            = FALSE
      Self Act          = FALSE
      Size              = 13.00
      Style             = Other
      Tab Order         = 3
      Termination Value = 0
      Title             = "F2->Islem &Basla       "
      Transparent Color = -1
      Visible           = 1:TRUE
      Before Procedure  = Before-Procedure
   End
   Begin Label lb-ref
      SCREEN-COL        = 30.10
      SCREEN-LINE       = 13.50
      LOCK-CONTROL      = FALSE
      (Name)            = lb-ref
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 30.10
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Font              = Default Font
      Help ID           = 0
      ID                = 15
      Justification     = Unaligned
      Label Offset      = 0
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 13.50
      Lines             = 2.00
      No Key Letter     = FALSE
      Size              = 3.90
      Tab Order         = 4
      Transparent       = TRUE
      Visible           = 1:TRUE
   End
End

END-SPDATA

@}}

{{@REPORT:
*   Report Writer Data
*   Schema 6.0
*
BEGIN-RWDATA-6.0A

END-RWDATA

@}}

{{@PARAGRAPH:
*
 Form1-Bef-Create.
       perform adresleri-tasi.
       open input konuk  kodlar02 romhrk takvim depkod exthrk depkod2 odalar .
       open i-o rez turizm detist istdata gelist gelist2 yromhrk  cast ozluk
       open i-o turizmr detistr istdatar.
       call "c$narg" using link-var.
       open input dagilim   
       move 99 to DAGILIM-ANAHTAR
       read dagilim no lock invalid 
          continue
       end-read. 
       close dagilim.
       move tarih-tasi to ilk-break-tar
       if k-kodu-tasi = "ASYA" or "X" then 
         move 1 to asyami
       end-if .

*
 before-procedure.
     initialize mesaj.   
     evaluate control-id
          when 4
          when 5
          when 6
              evaluate true
                  when turkce
                       move "Islem Baslangic Tarihini Giriniz " to mesaj
                  when ingilizce
                       move "Islem Baslangic Tarihini Giriniz " to mesaj
                  when almanca
                       move "Islem Baslangic Tarihini Giriniz " to mesaj
              end-evaluate
          when 8
          when 9
          when 10
              evaluate true
                  when turkce
                       move "Islem Bitis Tarihini Giriniz " to mesaj
                  when ingilizce
                       move "Islem Bitis Tarihini Giriniz " to mesaj
                  when almanca
                       move "Islem Bitis Tarihini Giriniz " to mesaj
              end-evaluate
          when 11
              evaluate true
                  when turkce
                       move "Islemi Baslat  "   to mesaj
                  when ingilizce
                       move "Islemi Baslat  "   to mesaj
                  when almanca
                       move "Islemi Baslat  "   to mesaj
              end-evaluate
     end-evaluate.

     modify form1-st-1-handle,
            panel-index = 1 
            panel-text = mesaj.
 dogrula.
    initialize gec-gecme gidis-id
    move rapor-bas-tarih  to takvim-anah
   
    read takvim no lock invalid
          move 1 to gec-gecme
          initialize mesaj-link
          move 13 to mesaj-no
          perform mesaj-ver
          move 4 to accept-control
          move 6 to control-id gidis-id
    not invalid
        continue
    end-read
    move rapor-bit-tarih  to takvim-anah
    read takvim no lock invalid
          move 1 to gec-gecme
          initialize mesaj-link
          move 13 to mesaj-no
          perform mesaj-ver
          move 4  to accept-control
          move 10 to control-id gidis-id
    not invalid
        continue
    end-read
    if rapor-bit-tarih < rapor-bas-tarih
          move 1 to gec-gecme
          initialize mesaj-link
          move 14 to mesaj-no
          perform mesaj-ver
          move 4  to accept-control
          move 10 to control-id gidis-id
    end-if. 

 Form1-Aft-Initdata.
    open input genel
    move 1 to genel-anahtar
    read genel no lock invalid
          initialize mesaj-link
          move 03 to mesaj-no
          perform mesaj-ver
    not invalid
        continue
    end-read
    close genel
    move calis-gun   to rapor-bas-gun rapor-bit-gun
    move calis-ay    to rapor-bas-ay  rapor-bit-ay
    move calis-yil   to rapor-bas-yil rapor-bit-yil
    display form1.
       move 0 to hisaktardan-geldi
    if link-var = 1 then 
      move 1 to hisaktardan-geldi
     if rapor-bas-ay = 1 then 
        move 12 to rapor-bas-ay
        subtract 1 from rapor-bas-yil
     else
        if rapor-bas-ay = 3
           move 28 to rapor-bas-gun
        end-if
        subtract 1 from rapor-bas-ay
     end-if
     if onkpara-cout-kuru = 1 then 
          move 1 to rapor-bas-gun rapor-bas-ay         
     end-if
/////////////the vault için yapýldý kaldýrmayýn Ramazan
     if isyeri-adres-tasi = "hotel020" 
          move 1 to rapor-bas-gun 
          move 3 to rapor-bas-ay 
     end-if 
/////////////the vault için yapýldý kaldýrmayýn Ramazan
         move 0 to share-bul
         modify Form1-Pb-1 visible = 0
           display form1
       move 2 to key-status
       perform  exception-procedure 


        move calis-gun   to rapor-bas-gun rapor-bit-gun
         move calis-ay    to rapor-bas-ay  rapor-bit-ay
         move calis-yil   to rapor-bas-yil rapor-bit-yil
         move 1 to share-bul
          modify Form1-Pb-1 visible = 0
         display form1
         move 2 to key-status
        perform  exception-procedure 



         set exit-pushed to true
    end-if
     .
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
 exception-procedure.
     evaluate key-status

         when 2 
              perform dogrula
              if gec-gecme = 0
                 perform islem-yap thru islem-yap-exit
                 if cb-1-val = 1
                    perform tum-bas-bul-y
                 else
                    perform tum-bas-bul
                 end-if
                 perform casta-basilan
                 if onkpara-referans-var = 1 
                    perform varying i from 1 by 1 until i > max-ref
                         perform islem-yapr thru islem-yap-exitr 
                    end-perform
                 end-if
                 if share-bul = 1 then 
                    perform share-bul-islem

                 end-if
                 if break-ayir-yeni = 1
                     perform break-ayir-yeni-hesaplama
                 end-if 
                 perform loga-yaz
                         display message box "Gun Sonu Istatistikleri Olusturuldu."
                         move 27 to key-status
              else
                  move 4         to accept-control
                  move gidis-id  to control-id
              end-if
     end-evaluate.
*
 tum-bas-bul.
     move  rapor-bas-tarih to takvim-anah gelist-tarih gelist2-tarih cast-tarih
     start gelist key >= gelist-anah invalid continue
       not invalid
        perform until fs-gelist = "10"
         read gelist next end 
            move "10" to fs-gelist
           not end 
            if gelist-tarih <= rapor-bit-tarih 
               delete gelist end-delete
               else 
               move "10" to fs-gelist
            end-if
         end-read
        end-perform
     end-start
***********************************************************************firat ekleme 06/08/2020 gelist2
     start gelist2 key >= gelist2-anah invalid continue
       not invalid
        perform until fs-gelist2 = "10"
         read gelist2 next end 
            move "10" to fs-gelist
           not end 
            if gelist2-tarih <= rapor-bit-tarih 
               delete gelist2 end-delete
               else 
               move "10" to fs-gelist2
            end-if
         end-read
        end-perform
     end-start
***********************************************************************firat ekleme 06/08/2020 gelist2
      start cast key >= cast-anah invalid continue
       not invalid
        perform until fs-cast = "10"
         read cast next end 
            move "10" to fs-cast
           not end 
            if cast-tarih <= rapor-bit-tarih 
                initialize CAST-basilan-fiyat
                initialize cast-duzeltme
                rewrite cast-rec invalid write cast-rec  end-rewrite
              
               else 
               move "10" to fs-cast
            end-if
         end-read
        end-perform
     end-start
     initialize romhrk-rec exthrk-rec
     move rapor-bas-tarih to romhrk-tarih   exthrk-tarih
     
     start romhrk key >= romhrk-anah2
       invalid 
        continue
        not invalid
        perform until fs-romhrk = "10"
            read romhrk next end move "10" to fs-romhrk
                not end
                  if romhrk-tarih > rapor-bit-tarih 
                    move "10" to fs-romhrk
                    exit perform
                  end-if
        
                  move romhrk-depkod to depkod-anah 
                    read depkod no lock invalid
                       continue
                       not invalid
                         if depkod-turu = 2 then
                              move -1 to carpan
                              move ROMHRK-CORR-DEPKOD to depkod2-anah
                            else
                              move 1 to carpan
                              move romhrk-depkod to depkod2-anah
                         end-if
                    end-read
                       read depkod2 no lock invalid
                         move "01" to  depkod2-alt-kate
                          
                         end-read
                         initialize gelist-rec gelist2-rec
                         move romhrk-folio to gelist-folio gelist2-folio
                         move romhrk-tarih to gelist-tarih gelist2-tarih
                         read gelist no lock invalid continue
                         end-read
                         read gelist2 no lock invalid continue               |firat ekleme 06/08/2020
                         end-read

                        evaluate depkod2-alt-kate
                             when "01" 
                                compute gelist-oda   = gelist-oda  + ( romhrk-tl-tutar * carpan )
                                compute gelist2-oda  = gelist2-oda + ( romhrk-tl-tutar * carpan )
                             when "02" 
                                compute gelist-yiy   = gelist-yiy  + ( romhrk-tl-tutar * carpan  )
                                compute gelist2-yiy  = gelist2-yiy + ( romhrk-tl-tutar * carpan  )
                             when "03" 
                                compute gelist-ice   = gelist-ice  + ( romhrk-tl-tutar * carpan  )
                                compute gelist2-ice  = gelist2-ice + ( romhrk-tl-tutar * carpan  )
                             when "04" 
                                compute gelist-dig   = gelist-dig  + ( romhrk-tl-tutar * carpan  )
                                compute gelist2-dig  = gelist2-dig + ( romhrk-tl-tutar * carpan  )
                             when "08" 
                                compute gelist2-alk  = gelist2-alk + ( romhrk-tl-tutar * carpan  )
                        end-evaluate
                        write gelist-rec  invalid rewrite gelist-rec  end-write
                        write gelist2-rec invalid rewrite gelist2-rec end-write
                  
            end-read
        end-perform
      end-start.
       initialize romhrk-rec exthrk-rec
       move rapor-bas-tarih to exthrk-tarih 
        start exthrk key >= exthrk-anah2
       invalid 
        continue
        not invalid
        perform until fs-exthrk = "10"
            read exthrk next end move "10" to fs-exthrk
                not end
                  if exthrk-tarih > rapor-bit-tarih 
                    move "10" to fs-exthrk
                    exit perform
                  end-if
             
                  move exthrk-depkod to depkod-anah 
                    read depkod no lock invalid
                       continue
                       not invalid
                         if depkod-turu = 2 then
                            move -1 to carpan
                            move extHRK-CORR-DEPKOD to depkod2-anah
                            else
                            move 1 to carpan
                              move exthrk-depkod to depkod2-anah
                         end-if
                    end-read
                  read depkod2 no lock invalid
                         move "01" to  depkod2-alt-kate
                   end-read
                   initialize gelist-rec gelist2-rec
                   move exthrk-folio to gelist-folio gelist2-folio
                   move exthrk-tarih to gelist-tarih gelist2-tarih
                        
                   read gelist  no lock invalid continue end-read
                   read gelist2 no lock invalid continue end-read
                        evaluate depkod2-alt-kate
                             when "01" 
                                compute gelist-oda   = gelist-oda  + ( exthrk-tl-tutar * carpan )
                                compute gelist2-oda  = gelist2-oda + ( exthrk-tl-tutar * carpan )
                             when "02" 
                                compute gelist-yiy   = gelist-yiy  + ( exthrk-tl-tutar * carpan  )
                                compute gelist2-yiy  = gelist2-yiy + ( exthrk-tl-tutar * carpan  )
                             when "03" 
                                compute gelist-ice   = gelist-ice  + ( exthrk-tl-tutar * carpan  )
                                compute gelist2-ice  = gelist2-ice + ( exthrk-tl-tutar * carpan  )
                             when "04" 
                                compute gelist-dig   = gelist-dig  + ( exthrk-tl-tutar * carpan  )
                                compute gelist2-dig  = gelist2-dig + ( exthrk-tl-tutar * carpan  )
                             when "08" 
                                compute gelist2-alk  = gelist2-alk + ( exthrk-tl-tutar * carpan  )
                        end-evaluate
                        write gelist-rec  invalid rewrite gelist-rec end-write
                        write gelist2-rec invalid rewrite gelist2-rec end-write
              end-read
        end-perform
      end-start.
 


*
 casta-basilan.
  

      initialize gelist-REC.
      move rapor-bas-tarih to gelist-tarih
      start gelist key > gelist-anah invalid
         continue
         not invalid
          perform until fs-gelist =  "10"
            read gelist next no lock end move "10"  to fs-gelist
                 not end
                 if gelist-tarih > rapor-bit-tarih then 
                    move "10" to fs-gelist
                    else
                      
***                      if k-kodu-tasi = "ASYA" and gelist-folio = 1137 then stop " " end-if
                    move gelist-folio to konuk-folio
                    read konuk no lock invalid
                         
                       continue  
                       not invalid
                       
                         if konuk-rez-no > 0 then 
                           
                             move gelist-tarih to cast-tarih
                             move konuk-rez-no to cast-rez-no
                             read cast no lock invalid
                                   initialize cast-rec
                                   move konuk-git-tar to cast-tarih                                 
                                   move konuk-rez-no to cast-rez-no 
                                      read cast no lock invalid
                                         display message box konuk-rez-no " nolu rezervasyonun " cast-tarih " tarihli gecelemesi yok"
                                       not invalid                                                                                 
*                                              if isyeri-adres-tasi = "hotel020"
*                                                if gelist-tarih >= "20200313"
                                                   compute CAST-duzeltme rounded = CAST-duzeltme + (gelist-oda / KONUK-KUR-DEGERI) 
*                                                else
*                                                  compute CAST-duzeltme rounded = gelist-oda / KONUK-KUR-DEGERI ||||eski hali bu þekilde
*                                                end-if 
*                                              else
*                                                compute CAST-duzeltme rounded = gelist-oda / KONUK-KUR-DEGERI ||||eski hali bu þekilde
*                                              end-if 

///// ramazan ekleme the vault otel için ör: mis. cout tarihi 13.03 ancak 14.03 - 15.03 tarihlerinde room rate basiliyor.
                                                rewrite cast-rec invalid stop " " end-rewrite

                                       end-read
                               continue
                            not invalid
                               compute CAST-BASILAN-FIYAT rounded = gelist-oda / KONUK-KUR-DEGERI 
                               rewrite cast-rec invalid stop " " end-rewrite

                             end-read

                          else

                         continue

                        end-if
                   end-read
                 end-if
            end-read        
          end-perform
       end-start.
      .
       






*
 tum-bas-bul-y.
     initialize cast-rec gelist-rec gelist2-rec
     move rapor-bas-tarih to cast-tarih
     start cast key >= cast-anah invalid continue
      not invalid
      perform until fs-cast = "10" 
      read cast next end move "10" to fs-cast
           not end
           if cast-tarih <= rapor-bit-tarih 
               initialize cast-basilan-fiyat 
                initialize cast-duzeltme
               rewrite cast-rec invalid continue end-rewrite
           else
             move "10" to fs-cast
           end-if
     end-read
     end-perform
    end-start

     
     move  rapor-bas-tarih to takvim-anah gelist-tarih gelist2-tarih
     start gelist key >= gelist-anah invalid continue
       not invalid
        perform until fs-gelist = "10"
         read gelist next end 
            move "10" to fs-gelist
           not end 
            if gelist-tarih <= rapor-bit-tarih 
               delete gelist end-delete
               else 
               move "10" to fs-gelist
            end-if
         end-read
        end-perform
     end-start
************************************************************firat ekleme 06/08/2020 gelist2 
     start gelist2 key >= gelist2-anah invalid continue
       not invalid
        perform until fs-gelist2 = "10"
         read gelist2 next end 
            move "10" to fs-gelist2
           not end 
            if gelist2-tarih <= rapor-bit-tarih 
               delete gelist2 end-delete
               else 
               move "10" to fs-gelist2
            end-if
         end-read
        end-perform
     end-start
************************************************************firat ekleme 06/08/2020 gelist2 
     initialize yromhrk-rec
     move rapor-bas-tarih to yromhrk-tarih 
     start yromhrk key >= yromhrk-anah2
       invalid 
        continue
        not invalid
        perform until fs-yromhrk = "10"
            read yromhrk next end move "10" to fs-yromhrk
                not end
                  if yromhrk-tarih > rapor-bit-tarih 
                    move "10" to fs-yromhrk
                    exit perform
                  end-if
           
*                  if k-kodu-tasi = "X   " and yromhrk-islem = 180 then stop " " end-if
                  move yromhrk-depkod to depkod-anah 
                    read depkod no lock invalid
                       continue
                       not invalid
                         if depkod-turu = 2 then
                              move -1 to carpan
                              move yROMHRK-CORR-DEPKOD to depkod2-anah
                            else
                              move 1 to carpan
                              move yromhrk-depkod to depkod2-anah
                         end-if
                    end-read
                       read depkod2 no lock invalid
                         move "01" to  depkod2-alt-kate
                          
                         end-read
                         initialize gelist-rec gelist2-rec
                         move yromhrk-folio to gelist-folio gelist2-folio
                         move yromhrk-tarih to gelist-tarih gelist2-tarih
                         read gelist  no lock invalid continue end-read
                         read gelist2 no lock invalid continue end-read
*                         if yromhrk-folio = 444579 then stop " " end-if
*                         if yromhrk-islem = 11160193 then stop " " end-if
                        evaluate depkod2-alt-kate
                             when "01" 
                                compute gelist-oda   = gelist-oda  + ( yromhrk-tl-tutar * carpan )
                                compute gelist2-oda  = gelist2-oda + ( yromhrk-tl-tutar * carpan )
                             when "02" 
                                compute gelist-yiy   = gelist-yiy  + ( yromhrk-tl-tutar * carpan )
                                compute gelist2-yiy  = gelist2-yiy + ( yromhrk-tl-tutar * carpan )
                             when "03" 
                                compute gelist-ice   = gelist-ice  + ( yromhrk-tl-tutar * carpan )
                                compute gelist2-ice  = gelist2-ice + ( yromhrk-tl-tutar * carpan )
                             when "04" 
                                compute gelist-dig   = gelist-dig  + ( yromhrk-tl-tutar * carpan )
                                compute gelist2-dig  = gelist2-dig + ( yromhrk-tl-tutar * carpan )
                             when "08" 
                                compute gelist2-alk  = gelist2-alk + ( yromhrk-tl-tutar * carpan )
                        end-evaluate
                        write gelist-rec  invalid rewrite gelist-rec end-write
                        write gelist2-rec invalid rewrite gelist2-rec end-write                        
                  
            end-read
        end-perform
      end-start.
       initialize romhrk-rec
       move rapor-bas-tarih to romhrk-tarih 

       start romhrk key >= romhrk-anah2
       invalid 
        continue
        not invalid
        perform until fs-romhrk = "10"
            read romhrk next end move "10" to fs-romhrk
                not end
                  if romhrk-tarih > rapor-bit-tarih 
                    move "10" to fs-romhrk
                    exit perform
                    else
                       initialize ozluk-rec
                       move romhrk-folio to ozluk-folio
                       read ozluk  no lock invalid
                         continue
                       end-read
                            if ozluk-ilk-har > "20000000"  
                                if 
                               ozluk-ilk-har > romhrk-tarih

                                 move romhrk-tarih to ozluk-ilk-har
                                 rewrite ozluk-rec invalid write ozluk-rec end-rewrite
                                 end-if
                                 else
                                    move romhrk-tarih to ozluk-ilk-har
                                 rewrite ozluk-rec invalid write ozluk-rec end-rewrite
                            end-if
                           if ozluk-son-har-tar > "20000000"  
                                if 
                               ozluk-son-har-tar < romhrk-tarih

                                 move romhrk-tarih to ozluk-son-har-tar
                                 rewrite ozluk-rec invalid write ozluk-rec end-rewrite
                                 end-if
                                 else
                                    move romhrk-tarih to ozluk-son-har-tar
                                 rewrite ozluk-rec invalid write ozluk-rec end-rewrite
                            end-if

                       
                  end-if
           end-read
       end-perform 
     end-start.
       initialize exthrk-rec
       move rapor-bas-tarih to exthrk-tarih 

       start exthrk key >= exthrk-anah2
       invalid 
        continue
        not invalid
        perform until fs-exthrk = "10"
            read exthrk next end move "10" to fs-exthrk
                not end
                  if exthrk-tarih > rapor-bit-tarih 
                    move "10" to fs-exthrk
                    exit perform
                    else
                       initialize ozluk-rec
                       move exthrk-folio to ozluk-folio
                       read ozluk  no lock invalid
                        continue
                        end-read
                            if ozluk-ilk-har > "20000000"  
                              if
                               ozluk-ilk-har > exthrk-tarih

                                 move exthrk-tarih to ozluk-ilk-har
                                 rewrite ozluk-rec invalid write ozluk-rec end-rewrite
                              end-if
                                 else
                                  move exthrk-tarih to ozluk-ilk-har
                                 rewrite ozluk-rec invalid write ozluk-rec end-rewrite
                            end-if
                            if ozluk-son-har-tar > "20000000"  
                              if
                               ozluk-son-har-tar < exthrk-tarih

                                 move exthrk-tarih to ozluk-son-har-tar
                                 rewrite ozluk-rec invalid write ozluk-rec end-rewrite
                              end-if
                                 else
                                  move exthrk-tarih to ozluk-son-har-tar
                                 rewrite ozluk-rec invalid write ozluk-rec end-rewrite
                            end-if

                       
                  end-if
           end-read
       end-perform 
     end-start.

 islem-yap.
 istatistik-basla.
     modify lb-isl-durumu, title = "Gunsonu Istatistigi Olusturuluyor Bekleyiniz.:" .
     initialize takvim-rec.
     move rapor-bas-tarih   to takvim-anah.
     start takvim key not < takvim-anah 
           invalid go transfer-bitti.
 takvim-oku.
     read takvim next no lock end go transfer-bitti. 
     if fs-takvim = 99 go takvim-oku.
     modify lb-isl-durumu, title = "Tarih".
     modify lb-isl-durumu-1, title = takvim-anah.
     if takvim-anah > rapor-bit-tarih 
        go transfer-bitti.
 ist-bosalt.
         initialize istdata-rec.
         move takvim-anah      to ist-tarih. 
         move spaces           to ist-acenta  ist-rez-tipi.  
         start istdata key not < istdata-anah invalid go ist-bosalt-bitti.
 ist-bosalt-oku.
         read istdata next no lock end go ist-bosalt-bitti.
         if fs-istdata = 99 go ist-bosalt-oku.
        
         if ist-tarih > takvim-anah    go ist-bosalt-bitti.
         if ist-tarih = takvim-anah    
            continue
         else 
            go ist-bosalt-oku
         end-if.   
            delete istdata invalid continue.
            go ist-bosalt-oku.   
 ist-bosalt-bitti.
 det-bosalt.
          initialize detist-rec.
          move takvim-anah      to detist-tarih. 
          move spaces           to detist-acenta  detist-rez-tipi.  
        start detist key not < detist-anah invalid go det-bosalt-bitti.
 det-bosalt-oku.
         read detist  next no lock end go det-bosalt-bitti.
         if fs-detist  = 99 go det-bosalt-oku.
         if detist-tarih > takvim-anah    go det-bosalt-bitti.
         if detist-tarih = takvim-anah    
            continue
         else 
            go det-bosalt-oku
         end-if.   
       
         delete detist invalid continue.
         go det-bosalt-oku.   
 det-bosalt-bitti.
 tur-bosalt.
        initialize turizm-rec.
        move takvim-anah      to turizm-tarih. 
        move spaces           to turizm-ulke. 
        start turizm key not < turizm-anah1 invalid go tur-bosalt-bitti.
 tur-bosalt-oku.
         read turizm  next no lock end go tur-bosalt-bitti.
         if fs-turizm = 99 go tur-bosalt-oku.
     
         if turizm-tarih > takvim-anah    go tur-bosalt-bitti.
         if turizm-tarih = takvim-anah    
            continue
         else 
            go tur-bosalt-oku
         end-if.   
            delete turizm invalid continue.
            go tur-bosalt-oku.   
 tur-bosalt-bitti.
 cast-basla.   
          initialize cast-rec.
          move takvim-anah to cast-tarih.
        start cast key not < cast-anah invalid go yeni-gun.
 cast-oku.    
        read cast next no lock end 
           go yeni-gun.
        if fs-cast = 99 go cast-oku.   
     
        if cast-tarih > takvim-anah go yeni-gun.
        if cast-tarih = takvim-anah 
           continue
        else 
           go cast-oku
        end-if. 
        move cast-rez-no   to rez-no.
        read rez no lock invalid go cast-oku.
        if rez-durumu not = "I" go cast-oku.   
        move rez-folio   to konuk-folio.
        read konuk no lock invalid go cast-oku.   
        if konuk-fol-kodu not = "R" go cast-oku.
************* SON GUN FIYAT BASILDIGINDA OKUSUN************
*   TRACE Uygulamasi Acik ise kisi sayilari cast'tan alinacak
    MOVE 1 TO ODA-SAYI
    if rezpara-trace = 1
       if konuk-kisi not = cast-kisi
          move cast-kisi to konuk-kisi
       end-if
       if konuk-fiyat-konumu not = cast-fiyat-konumu
          move cast-fiyat-konumu to konuk-fiyat-konumu
       end-if 
       if konuk-pan-tipi not = cast-pan-tipi
          move cast-pan-tipi to konuk-pan-tipi
       end-if 
       if konuk-anlasma not = cast-anlasma
          move cast-anlasma to konuk-anlasma
       end-if 
       move cast-share to konuk-share
       if konuk-share = 1 then 
         
             move 0 to oda-sayi
            else
              move 1 to oda-sayi
        end-if
      else 
          move 1 to oda-sayi
    end-if
*
    evaluate true
       when konuk-buyuk < 2
            move 1 to konuk-s-d-t-g
       when konuk-buyuk = 2
            move 2 to konuk-s-d-t-g
       when konuk-buyuk = 3
            move 3 to konuk-s-d-t-g
       when konuk-buyuk > 3
            move 4 to konuk-s-d-t-g
    end-evaluate. 
      
       if konuk-git-tar = cast-tarih 
          initialize oda-sayi konuk-buyuk konuk-kucuk 
                              konuk-free  konuk-bebek
       end-if. 
***********************************************************
    

       initialize kodlar02-rec.
       move "A"                to kodlar02-tipi.
       move konuk-pan-tipi     to kodlar02-kodu.
       read kodlar02 no lock invalid continue
       end-read.

*/ Room Foliodan Oda tutari transfer oldugunda kisi sayisini odaya
*/ atsin diye konuldu....Hangisi dogru tartisilir
         initialize pan-dagilim
          if pan-oda         = "X" 
             move "E"   to oda-var
          end-if
          if pan-kahvalti    = "X" 
             move "E"   to kahvalti-var
          end-if
          if pan-ogle        = "X" 
             move "E"   to ogle-var
          end-if
          if pan-aksam       = "X" 
             move "E"   to aksam-var
          end-if
          if pan-icecek      = "X" 
             move "E"   to icecek-var
          end-if
          if pan-extra       = "X" 
             move "E"   to extra-var
          end-if

       initialize corr-tutarlar
   
       if cb-1-val = 1
          perform basilan-bul-y  thru basilan-bul-y-exit
       else
          perform basilan-bul  thru basilan-bul-exit
       end-if

       initialize kodlar02-rec.
       move "B"                to kodlar02-tipi.
       move konuk-odeme-tipi   to kodlar02-kodu.
       read kodlar02 no lock invalid
            move spaces  to ode-tipi
       end-read.

        initialize istdata-rec.
        move takvim-anah       to ist-tarih.
        move konuk-rez-tipi    to ist-rez-tipi.  
        move konuk-acenta      to ist-acenta. 
      
        read istdata   no lock invalid 
             initialize istdata-rec
             move takvim-anah       to ist-tarih 
             move konuk-rez-tipi    to ist-rez-tipi  
             move konuk-acenta      to ist-acenta
       
        end-read. 

          compute ist-top-oda     = ist-top-oda    + oda-sayi.
          compute ist-top-buyuk   = ist-top-buyuk  + konuk-buyuk. 
          compute ist-top-kucuk   = ist-top-kucuk  + konuk-kucuk. 
          compute ist-top-free    = ist-top-free   + konuk-free.  
          compute ist-top-free    = ist-top-free   + konuk-bebek. 
          compute ist-top-tutar   = ist-top-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
          compute ist-top-corr-tutar   = ist-top-corr-tutar  + + corr-oda-tutar +
                  corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                  corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar.
          if konuk-oda-tutar not = 0 or oda-var not = spaces
          compute ist-oda-oda     = ist-oda-oda    + oda-sayi
          compute ist-oda-buyuk   = ist-oda-buyuk  + konuk-buyuk
          compute ist-oda-kucuk   = ist-oda-kucuk  + konuk-kucuk
          compute ist-oda-free    = ist-oda-free   + konuk-free  
          compute ist-oda-free    = ist-oda-free   + konuk-bebek 
          compute ist-oda-tutar   = ist-oda-tutar  + konuk-oda-tutar .
          
          if konuk-kahvalti-tutar not = 0 or kahvalti-var not = spaces
          compute ist-kah-oda     = ist-kah-oda    + oda-sayi
          compute ist-kah-buyuk   = ist-kah-buyuk  + konuk-buyuk
          compute ist-kah-kucuk   = ist-kah-kucuk  + konuk-kucuk
          compute ist-kah-free    = ist-kah-free   + konuk-free  
          compute ist-kah-free    = ist-kah-free   + konuk-bebek 
          compute ist-kah-tutar   = ist-kah-tutar  + konuk-kahvalti-tutar .
          if konuk-ogle-tutar not = 0 or ogle-var not = spaces
          compute ist-ogl-oda     = ist-ogl-oda    + oda-sayi
          compute ist-ogl-buyuk   = ist-ogl-buyuk  + konuk-buyuk
          compute ist-ogl-kucuk   = ist-ogl-kucuk  + konuk-kucuk
          compute ist-ogl-free    = ist-ogl-free   + konuk-free  
          compute ist-ogl-free    = ist-ogl-free   + konuk-bebek 
          compute ist-ogl-tutar   = ist-ogl-tutar  + konuk-ogle-tutar .
          if konuk-aksam-tutar not = 0 or aksam-var not = spaces
          compute ist-aks-oda     = ist-aks-oda    + oda-sayi
          compute ist-aks-buyuk   = ist-aks-buyuk  + konuk-buyuk
          compute ist-aks-kucuk   = ist-aks-kucuk  + konuk-kucuk
          compute ist-aks-free    = ist-aks-free   + konuk-free  
          compute ist-aks-free    = ist-aks-free   + konuk-bebek 
          compute ist-aks-tutar   = ist-aks-tutar  + konuk-aksam-tutar.
          if konuk-icecek-tutar not = 0 or icecek-var not = spaces
          compute ist-ice-oda     = ist-ice-oda    + oda-sayi
          compute ist-ice-buyuk   = ist-ice-buyuk  + konuk-buyuk
          compute ist-ice-kucuk   = ist-ice-kucuk  + konuk-kucuk
          compute ist-ice-free    = ist-ice-free   + konuk-free  
          compute ist-ice-free    = ist-ice-free   + konuk-bebek 
          compute ist-ice-tutar   = ist-ice-tutar  + konuk-icecek-tutar.
          if konuk-extra-tutar not = 0 or extra-var not = spaces
          compute ist-ext-oda     = ist-ext-oda    + oda-sayi
          compute ist-ext-buyuk   = ist-ext-buyuk  + konuk-buyuk
          compute ist-ext-kucuk   = ist-ext-kucuk  + konuk-kucuk
          compute ist-ext-free    = ist-ext-free   + konuk-free  
          compute ist-ext-free    = ist-ext-free   + konuk-bebek 
          compute ist-ext-tutar   = ist-ext-tutar  + konuk-extra-tutar.
          if konuk-extbed-tutar not = 0 
          compute ist-exb-oda     = ist-exb-oda    + oda-sayi
          compute ist-exb-buyuk   = ist-exb-buyuk  + konuk-buyuk
          compute ist-exb-kucuk   = ist-exb-kucuk  + konuk-kucuk
          compute ist-exb-free    = ist-exb-free   + konuk-free  
          compute ist-exb-free    = ist-exb-free   + konuk-bebek 
          compute ist-exb-tutar   = ist-exb-tutar  + konuk-extbed-tutar.

          compute ist-sdt-oda(konuk-s-d-t-g) =
                  ist-sdt-oda(konuk-s-d-t-g) + oda-sayi.
          compute ist-sdt-buyuk(konuk-s-d-t-g) =
                  ist-sdt-buyuk(konuk-s-d-t-g) + konuk-buyuk. 
          compute ist-sdt-kucuk(konuk-s-d-t-g) =
                  ist-sdt-kucuk(konuk-s-d-t-g) + konuk-kucuk. 
          compute ist-sdt-free(konuk-s-d-t-g) =
                  ist-sdt-free(konuk-s-d-t-g) + konuk-free. 
          compute ist-sdt-free(konuk-s-d-t-g) =
                  ist-sdt-free(konuk-s-d-t-g) + konuk-bebek.
          compute ist-sdt-tutar(konuk-s-d-t-g) =
                  ist-sdt-tutar(konuk-s-d-t-g) + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
************Complimentary bolumu......
          if ode-tipi = "D" 
          compute ist-com-oda     = ist-com-oda    + oda-sayi
          compute ist-com-buyuk   = ist-com-buyuk  + konuk-buyuk
          compute ist-com-kucuk   = ist-com-kucuk  + konuk-kucuk
          compute ist-com-free    = ist-com-free   + konuk-free  
          compute ist-com-free    = ist-com-free   + konuk-bebek 
          compute ist-com-tutar   = ist-com-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
************House Use     bolumu......
          if ode-tipi = "F" 
          compute ist-hou-oda     = ist-hou-oda    + oda-sayi
          compute ist-hou-buyuk   = ist-hou-buyuk  + konuk-buyuk
          compute ist-hou-kucuk   = ist-hou-kucuk  + konuk-kucuk
          compute ist-hou-free    = ist-hou-free   + konuk-free  
          compute ist-hou-free    = ist-hou-free   + konuk-bebek 
          compute ist-hou-tutar   = ist-hou-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
          rewrite istdata-rec invalid write istdata-rec end-rewrite.
************>Istatiklere yazildi.......

*******>Detist  Bolumu
        initialize detist-rec.
        move takvim-anah         to detist-tarih.
        move konuk-acenta        to detist-acenta. 
     
        move konuk-ulke          to detist-ulke-kodu. 
        move konuk-pan-tipi      to detist-pan-tipi. 
        move konuk-rez-tipi      to detist-rez-tipi.  
        move konuk-fiyat-konumu  to detist-oda-konumu.
        move konuk-anlasma       to detist-anlasma-kodu.
        read detist no lock invalid 
             initialize detist-rec
             move takvim-anah         to detist-tarih
             move konuk-acenta        to detist-acenta 
      
             move konuk-ulke          to detist-ulke-kodu 
             move konuk-pan-tipi      to detist-pan-tipi 
             move konuk-rez-tipi      to detist-rez-tipi  
             move konuk-fiyat-konumu  to detist-oda-konumu
             move konuk-anlasma       to detist-anlasma-kodu
        end-read. 

          compute detist-top-oda     = detist-top-oda    + oda-sayi.
          compute detist-top-buyuk   = detist-top-buyuk  + konuk-buyuk. 
          compute detist-top-kucuk   = detist-top-kucuk  + konuk-kucuk. 
          compute detist-top-free    = detist-top-free   + konuk-free.  
          compute detist-top-bebek   = detist-top-bebek  + konuk-bebek. 
          compute detist-top-tutar   = detist-top-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
          compute detist-top-corr    = detist-top-corr   + corr-oda-tutar +
                  corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                  corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar.

*          if konuk-oda-tutar not = 0
          if konuk-oda-tutar not = 0 or corr-oda-tutar not = 0
             or oda-var not = spaces
             compute detist-oda-oda     = detist-oda-oda    + oda-sayi
             compute detist-oda-buyuk   = detist-oda-buyuk  + konuk-buyuk
             compute detist-oda-kucuk   = detist-oda-kucuk  + konuk-kucuk 
             compute detist-oda-free    = detist-oda-free   + konuk-free
             compute detist-oda-bebek   = detist-oda-bebek  + konuk-bebek
             compute detist-oda-tutar   = detist-oda-tutar  + konuk-oda-tutar
             compute detist-oda-corr    = detist-oda-corr   + corr-oda-tutar
          end-if.

*          if konuk-kahvalti-tutar not = 0
          if konuk-kahvalti-tutar not = 0 or corr-kahvalti-tutar not = 0
             or kahvalti-var not = spaces
             compute detist-kah-oda     = detist-kah-oda    + oda-sayi
             compute detist-kah-buyuk   = detist-kah-buyuk  + konuk-buyuk
             compute detist-kah-kucuk   = detist-kah-kucuk  + konuk-kucuk 
             compute detist-kah-free    = detist-kah-free   + konuk-free
             compute detist-kah-bebek   = detist-kah-bebek  + konuk-bebek
             compute detist-kah-tutar   = 
                     detist-kah-tutar  + konuk-kahvalti-tutar
             compute detist-kah-corr    = 
                     detist-kah-corr   + corr-kahvalti-tutar
          end-if.

*          if konuk-ogle-tutar not = 0
          if konuk-ogle-tutar not = 0 or corr-ogle-tutar not = 0
             or ogle-var not = spaces
             compute detist-ogl-oda     = detist-ogl-oda    + oda-sayi
             compute detist-ogl-buyuk   = detist-ogl-buyuk  + konuk-buyuk
             compute detist-ogl-kucuk   = detist-ogl-kucuk  + konuk-kucuk 
             compute detist-ogl-free    = detist-ogl-free   + konuk-free
             compute detist-ogl-bebek   = detist-ogl-bebek  + konuk-bebek
             compute detist-ogl-tutar   = detist-ogl-tutar  + konuk-ogle-tutar
             compute detist-ogl-corr    = detist-ogl-corr   + corr-ogle-tutar
          end-if.
*          if konuk-aksam-tutar not = 0
          if konuk-aksam-tutar not = 0 or corr-aksam-tutar not = 0
             or aksam-var not = spaces
             compute detist-aks-oda     = detist-aks-oda    + oda-sayi
             compute detist-aks-buyuk   = detist-aks-buyuk  + konuk-buyuk
             compute detist-aks-kucuk   = detist-aks-kucuk  + konuk-kucuk 
             compute detist-aks-free    = detist-aks-free   + konuk-free
             compute detist-aks-bebek   = detist-aks-bebek  + konuk-bebek
             compute detist-aks-tutar   = detist-aks-tutar  + konuk-aksam-tutar
             compute detist-aks-corr    = detist-aks-corr   + corr-aksam-tutar
          end-if.
*          if konuk-icecek-tutar not = 0
          if konuk-icecek-tutar not = 0 or corr-icecek-tutar not = 0
             or icecek-var not = spaces
             compute detist-ice-oda     = detist-ice-oda    + oda-sayi
             compute detist-ice-buyuk   = detist-ice-buyuk  + konuk-buyuk
             compute detist-ice-kucuk   = detist-ice-kucuk  + konuk-kucuk 
             compute detist-ice-free    = detist-ice-free   + konuk-free
             compute detist-ice-bebek   = detist-ice-bebek  + konuk-bebek
             compute detist-ice-tutar   = detist-ice-tutar  + konuk-icecek-tutar
             compute detist-ice-corr    = detist-ice-corr   + corr-icecek-tutar
          end-if.
*          if konuk-extra-tutar not = 0
          if konuk-extra-tutar not = 0 or corr-extra-tutar not = 0
             or extra-var not = spaces
             compute detist-ext-oda     = detist-ext-oda    + oda-sayi
             compute detist-ext-buyuk   = detist-ext-buyuk  + konuk-buyuk
             compute detist-ext-kucuk   = detist-ext-kucuk  + konuk-kucuk 
             compute detist-ext-free    = detist-ext-free   + konuk-free
             compute detist-ext-bebek   = detist-ext-bebek  + konuk-bebek
             compute detist-ext-tutar   = detist-ext-tutar  + konuk-extra-tutar
             compute detist-ext-corr    = detist-ext-corr   + corr-extra-tutar
          end-if.
*          if konuk-extbed-tutar not = 0
          if konuk-extbed-tutar not = 0 or corr-extbed-tutar not = 0
             compute detist-exb-oda     = detist-exb-oda    + oda-sayi
             compute detist-exb-buyuk   = detist-exb-buyuk  + konuk-buyuk
             compute detist-exb-kucuk   = detist-exb-kucuk  + konuk-kucuk 
             compute detist-exb-free    = detist-exb-free   + konuk-free
             compute detist-exb-bebek   = detist-exb-bebek  + konuk-bebek
             compute detist-exb-tutar   = detist-exb-tutar  + konuk-extbed-tutar
             compute detist-exb-corr    = detist-exb-corr   + corr-extbed-tutar
          end-if.

          compute detist-sdt-oda(konuk-s-d-t-g) =
                  detist-sdt-oda(konuk-s-d-t-g) + oda-sayi.
          compute detist-sdt-buyuk(konuk-s-d-t-g) =
                  detist-sdt-buyuk(konuk-s-d-t-g) + konuk-buyuk. 
          compute detist-sdt-kucuk(konuk-s-d-t-g) =
                  detist-sdt-kucuk(konuk-s-d-t-g) + konuk-kucuk. 
          compute detist-sdt-free(konuk-s-d-t-g) =
                  detist-sdt-free(konuk-s-d-t-g) + konuk-free. 
          compute detist-sdt-bebek(konuk-s-d-t-g) =
                  detist-sdt-bebek(konuk-s-d-t-g) + konuk-bebek.
          compute detist-sdt-tutar(konuk-s-d-t-g) =
                  detist-sdt-tutar(konuk-s-d-t-g) + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
          compute detist-sdt-corr(konuk-s-d-t-g) =
                  detist-sdt-corr(konuk-s-d-t-g) + corr-oda-tutar +
                  corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                  corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar.
************Complimentary bolumu......
          if ode-tipi = "D" 
             compute detist-com-oda     = detist-com-oda    + oda-sayi
             compute detist-com-buyuk   = detist-com-buyuk  + konuk-buyuk
             compute detist-com-kucuk   = detist-com-kucuk  + konuk-kucuk
             compute detist-com-free    = detist-com-free   + konuk-free  
             compute detist-com-bebek   = detist-com-bebek  + konuk-bebek 
             compute detist-com-tutar   = detist-com-tutar  + konuk-oda-tutar +
                 konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                 konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar
             compute detist-com-corr    = detist-com-corr   + corr-oda-tutar +
                 corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                 corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar
          end-if.
************House Use     bolumu......
          if ode-tipi = "F" 
             compute detist-hou-oda     = detist-hou-oda    + oda-sayi
             compute detist-hou-buyuk   = detist-hou-buyuk  + konuk-buyuk
             compute detist-hou-kucuk   = detist-hou-kucuk  + konuk-kucuk
             compute detist-hou-free    = detist-hou-free   + konuk-free  
             compute detist-hou-bebek   = detist-hou-bebek  + konuk-bebek 
             compute detist-hou-tutar   = detist-hou-tutar  + konuk-oda-tutar +
                 konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                 konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar
             compute detist-hou-corr    = detist-hou-corr  + corr-oda-tutar +
                 corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                 corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar
          end-if.
          rewrite detist-rec invalid 
                  write detist-rec 
                  end-write continue
          end-rewrite.
*******>Detist  Bolumu

        initialize turizm-rec.
        move takvim-anah       to turizm-tarih.   
        move konuk-ulke        to turizm-ulke.
        move konuk-sehir       to turizm-sehir.
        read turizm   no lock invalid continue.

        compute kalan-oda   = kalan-oda   + oda-sayi. 
        compute kalan-buyuk = kalan-buyuk + konuk-buyuk. 
        compute kalan-kucuk = kalan-kucuk + konuk-kucuk. 
        compute kalan-free  = kalan-free  + konuk-free.  
        compute kalan-bebek = kalan-bebek + konuk-bebek. 
        if konuk-gel-tar = takvim-anah      
        compute gelen-oda   = gelen-oda   + oda-sayi
        compute gelen-buyuk = gelen-buyuk + konuk-buyuk
        compute gelen-kucuk = gelen-kucuk + konuk-kucuk 
        compute gelen-free  = gelen-free  + konuk-free
        compute gelen-bebek = gelen-bebek + konuk-bebek. 

        compute turizm-toplam-tutar = turizm-toplam-tutar  + konuk-oda-tutar +
                konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.

        compute turizm-corr-tutar   = turizm-corr-tutar    + corr-oda-tutar +
                corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar.

        rewrite turizm-rec invalid 
                write turizm-rec 
                end-write
        end-rewrite.
                 go cast-oku.  
 yeni-gun.
        go takvim-oku.
 transfer-bitti. 
     go son.  
 dfkdkdkdk.  
 basilan-bul. 
        initialize  konuk-oda-tutar       konuk-extra-tutar
                    konuk-kahvalti-tutar  konuk-ogle-tutar
                    konuk-aksam-tutar     konuk-icecek-tutar.
         move konuk-folio    to romhrk-folio.
         move takvim-anah    to romhrk-tarih.
         start romhrk key not < romhrk-anah1 
               invalid go basilan-bul-exit.
 basilan-oku. 
         read romhrk next no lock end 
              go basilan-bul-exit.
         if fs-romhrk = 99 go basilan-oku.
         if romhrk-tarih > takvim-anah 
            go basilan-bul-exit.
         if romhrk-folio not = konuk-folio 
            go basilan-bul-exit.
         
*/ CORRECTION

         perform correction-kontrol
*/ CORRECTION
         evaluate true 
          when pan-oda         = "X" and oda-dep      = romhrk-depkod
               compute konuk-oda-tutar      = 
                       konuk-oda-tutar + romhrk-tl-tutar  
          when pan-kahvalti    = "X" and kahvalti-dep = romhrk-depkod
               compute konuk-kahvalti-tutar = 
                       konuk-kahvalti-tutar + romhrk-tl-tutar
          when pan-ogle        = "X" and ogle-dep     = romhrk-depkod
               compute konuk-ogle-tutar     = 
                       konuk-ogle-tutar     + romhrk-tl-tutar
          when pan-aksam       = "X" and aksam-dep    = romhrk-depkod
               compute konuk-aksam-tutar    = 
                       konuk-aksam-tutar    + romhrk-tl-tutar
          when pan-icecek      = "X" and icecek-dep   = romhrk-depkod
               compute konuk-icecek-tutar   = 
                       konuk-icecek-tutar   + romhrk-tl-tutar
          when pan-extra       = "X" and extra-dep    = romhrk-depkod
               compute konuk-extra-tutar    = 
                       konuk-extra-tutar    + romhrk-tl-tutar
         end-evaluate. 
         go basilan-oku.
 basilan-bul-exit. 
        exit.

*
 correction-kontrol.
        
         move romhrk-depkod     to depkod-kodu
         read depkod no lock invalid
              continue
         end-read
         if depkod-turu <> 2 or romhrk-corr-depkod = zeroes
            exit paragraph.

         move romhrk-corr-depkod    to depkod-kodu
         read depkod no lock invalid
              exit paragraph
         end-read

         evaluate true 
          when pan-oda         = "X" and oda-dep      = romhrk-corr-depkod
               compute corr-oda-tutar      = 
                       corr-oda-tutar + romhrk-tl-tutar
          when pan-kahvalti    = "X" and kahvalti-dep = romhrk-corr-depkod
               compute corr-kahvalti-tutar = 
                       corr-kahvalti-tutar + romhrk-tl-tutar
          when pan-ogle        = "X" and ogle-dep     = romhrk-corr-depkod
               compute corr-ogle-tutar     = 
                       corr-ogle-tutar     + romhrk-tl-tutar
          when pan-aksam       = "X" and aksam-dep    = romhrk-corr-depkod
               compute corr-aksam-tutar    = 
                       corr-aksam-tutar    + romhrk-tl-tutar
          when pan-icecek      = "X" and icecek-dep   = romhrk-corr-depkod
               compute corr-icecek-tutar   = 
                       corr-icecek-tutar   + romhrk-tl-tutar
          when pan-extra       = "X" and extra-dep    = romhrk-corr-depkod
               compute corr-extra-tutar    = 
                       corr-extra-tutar    + romhrk-tl-tutar
         end-evaluate. 

 basilan-bul-y. 
        initialize  konuk-oda-tutar       konuk-extra-tutar
                    konuk-kahvalti-tutar  konuk-ogle-tutar
                    konuk-aksam-tutar     konuk-icecek-tutar konuk-extbed-tutar
                    .
         move konuk-folio    to yromhrk-folio.
         move takvim-anah    to yromhrk-tarih.
         start yromhrk key not < yromhrk-anah1 
               invalid go basilan-bul-y-exit.
 basilan-oku-y. 
         read yromhrk next no lock end 
              go basilan-bul-y-exit.
         if fs-yromhrk = 99 go basilan-oku-y.
         if yromhrk-tarih > takvim-anah 
            go basilan-bul-y-exit.
         if yromhrk-folio not = konuk-folio 
            go basilan-bul-y-exit.
         
*/ CORRECTION
             
         perform correction-kontrol-y

*/ CORRECTION     
*         if d = 1 then stop " " end-if
         evaluate true 
          when pan-oda         = "X" and oda-dep      = yromhrk-depkod
           initialize pan-toplam
            if break-ayir = 1
             if dagilim-tipi = "O"
              
               if  pan-extra    = "X"
               compute konuk-extra-tutar  rounded   = 
                       konuk-extra-tutar    + ( yromhrk-tl-tutar * DAGILIM-extra / 100 )
               compute pan-toplam rounded  =  pan-toplam + 
                             ( yromhrk-tl-tutar * DAGILIM-extra / 100 )
                end-if
               if  pan-icecek   = "X"
               compute konuk-ICECEK-tutar  rounded   = 
                       konuk-ICECEK-tutar    + ( yromhrk-tl-tutar * DAGILIM-ICECEK / 100 )
               compute pan-toplam rounded  =  pan-toplam + 
                                ( yromhrk-tl-tutar * DAGILIM-ICECEK / 100 )
                 end-if
               if  pan-aksam    = "X"
               compute konuk-aksam-tutar  rounded   = 
                       konuk-aksam-tutar    + ( yromhrk-tl-tutar * DAGILIM-aksam / 100 )
               compute pan-toplam rounded  =  pan-toplam + 
                                ( yromhrk-tl-tutar * DAGILIM-aksam / 100 )
                  end-if
               if  pan-ogle    = "X"
               compute konuk-ogle-tutar  rounded   = 
                       konuk-ogle-tutar    + ( yromhrk-tl-tutar * DAGILIM-ogle / 100 )
               compute pan-toplam rounded  =  pan-toplam + 
                                ( yromhrk-tl-tutar * DAGILIM-ogle / 100 )
                  end-if
               if  pan-kahvalti    = "X"
                compute konuk-kahvalti-tutar  rounded   = 
                       konuk-kahvalti-tutar    + ( yromhrk-tl-tutar * DAGILIM-kahvalti / 100 )
               compute pan-toplam rounded  =  pan-toplam + 
                                ( yromhrk-tl-tutar * DAGILIM-kahvalti / 100 )
                end-if
                   compute konuk-oda-tutar  rounded   = 
                       konuk-oda-tutar    + ( yromhrk-tl-tutar - pan-toplam )
                  
              else
*********************SABITLER YAZILACAK ******************************
                   compute konuk-oda-tutar      = 
                       konuk-oda-tutar + yromhrk-tl-tutar 
                continue
              end-if
             else

               compute konuk-oda-tutar      = 
                       konuk-oda-tutar + yromhrk-tl-tutar 

            end-if
          when pan-kahvalti    = "X" and kahvalti-dep = yromhrk-depkod
               compute konuk-kahvalti-tutar = 
                       konuk-kahvalti-tutar + yromhrk-tl-tutar
          when pan-ogle        = "X" and ogle-dep     = yromhrk-depkod
               compute konuk-ogle-tutar     = 
                       konuk-ogle-tutar     + yromhrk-tl-tutar
          when pan-aksam       = "X" and aksam-dep    = yromhrk-depkod
               compute konuk-aksam-tutar    = 
                       konuk-aksam-tutar    + yromhrk-tl-tutar
          when pan-icecek      = "X" and icecek-dep   = yromhrk-depkod
               compute konuk-icecek-tutar   = 
                       konuk-icecek-tutar   + yromhrk-tl-tutar
          when pan-extra       = "X" and extra-dep    = yromhrk-depkod
               compute konuk-extra-tutar    = 
                       konuk-extra-tutar    + yromhrk-tl-tutar
         end-evaluate. 
         go basilan-oku-y.
 basilan-bul-y-exit. 
        exit.

*
 correction-kontrol-y.
        
         move yromhrk-depkod     to depkod-kodu
         read depkod no lock invalid
              continue
         end-read
         if depkod-turu <> 2 or yromhrk-corr-depkod = zeroes
            exit paragraph.
*****            if yromhrk-corr-depkod not = "x100" stop " " end-if     
         move yromhrk-corr-depkod    to depkod-kodu
         read depkod no lock invalid
              exit paragraph
         end-read


           
         evaluate true 
          when pan-oda         = "X" and oda-dep      = yromhrk-corr-depkod

                 initialize pan-toplam
            if break-ayir = 1
             if dagilim-tipi = "O"
              
               if  pan-extra    = "X"
               compute corr-extra-tutar  rounded   = 
                       corr-extra-tutar    + ( yromhrk-tl-tutar * DAGILIM-extra / 100 )
               compute pan-toplam rounded  =  pan-toplam + 
                             ( yromhrk-tl-tutar * DAGILIM-extra / 100 )
                end-if
               if  pan-icecek   = "X"
               compute corr-ICECEK-tutar  rounded   = 
                       corr-ICECEK-tutar    + ( yromhrk-tl-tutar * DAGILIM-ICECEK / 100 )
               compute pan-toplam rounded  =  pan-toplam + 
                                ( yromhrk-tl-tutar * DAGILIM-ICECEK / 100 )
                 end-if
               if  pan-aksam    = "X"
               compute corr-aksam-tutar  rounded   = 
                       corr-aksam-tutar    + ( yromhrk-tl-tutar * DAGILIM-aksam / 100 )
               compute pan-toplam rounded  =  pan-toplam + 
                                ( yromhrk-tl-tutar * DAGILIM-aksam / 100 )
                  end-if
               if  pan-ogle    = "X"
               compute corr-ogle-tutar  rounded   = 
                       corr-ogle-tutar    + ( yromhrk-tl-tutar * DAGILIM-ogle / 100 )
               compute pan-toplam rounded  =  pan-toplam + 
                                ( yromhrk-tl-tutar * DAGILIM-ogle / 100 )
                  end-if
               if  pan-kahvalti    = "X"
                compute corr-kahvalti-tutar  rounded   = 
                       corr-kahvalti-tutar    + ( yromhrk-tl-tutar * DAGILIM-kahvalti / 100 )
               compute pan-toplam rounded  =  pan-toplam + 
                                ( yromhrk-tl-tutar * DAGILIM-kahvalti / 100 )
                end-if
                   compute corr-oda-tutar  rounded   = 
                       corr-oda-tutar   + ( yromhrk-tl-tutar - pan-toplam )
                  
              else
                  compute corr-oda-tutar      = 
                       corr-oda-tutar + yromhrk-tl-tutar

              end-if
             else

                 compute corr-oda-tutar      = 
                       corr-oda-tutar + yromhrk-tl-tutar

            end-if



             
          when pan-kahvalti    = "X" and kahvalti-dep = yromhrk-corr-depkod
               compute corr-kahvalti-tutar = 
                       corr-kahvalti-tutar + yromhrk-tl-tutar
          when pan-ogle        = "X" and ogle-dep     = yromhrk-corr-depkod
               compute corr-ogle-tutar     = 
                       corr-ogle-tutar     + yromhrk-tl-tutar
          when pan-aksam       = "X" and aksam-dep    = yromhrk-corr-depkod
               compute corr-aksam-tutar    = 
                       corr-aksam-tutar    + romhrk-tl-tutar
          when pan-icecek      = "X" and icecek-dep   = yromhrk-corr-depkod
               compute corr-icecek-tutar   = 
                       corr-icecek-tutar   + yromhrk-tl-tutar
          when pan-extra       = "X" and extra-dep    = yromhrk-corr-depkod
               compute corr-extra-tutar    = 
                       corr-extra-tutar    + yromhrk-tl-tutar
         end-evaluate. 






 son.
 islem-yap-exit.
      exit.

*
 Form1-Aft-Routine.
    close      konuk rez cast kodlar02 romhrk takvim depkod depkod2 yromhrk odalar .
    close      istdata turizm detist gelist gelist2 ozluk
    close      turizmr detistr istdatar.  
     .   
*
 loga-yaz.
********** PROGRAMA GIRIS LOGA GONDERILIYOR
               initialize call-alan1
                          call-alan2
                          call-alan3
                          call-alan4
                          call-alan5
                          call-alan6
               perform log-no-al
               move genelfis-log-no   to call-anah
               move "Tarih: "         to call-alan1
               move gun-tasi          to call-alan1(10:)
               move "/"               to call-alan1(12:)
               move ay-tasi           to call-alan1(13:)
               move "/"               to call-alan1(15:)
               move yil-tasi          to call-alan1(16:)
               move "Tarihler Arasi History Istatistikler Olusturuldu."    to call-alan2

               move "Tarih Araligi:"      to call-alan3
               move rapor-bas-gun     to call-alan3(16:)
               move "/"               to call-alan3(18:)
               move rapor-bas-ay      to call-alan3(19:)
               move "/"               to call-alan3(21:)
               move rapor-bas-yil     to call-alan3(22:)
               move "<->"             to call-alan3(26:)

               move rapor-bit-gun     to call-alan3(29:)
               move "/"               to call-alan3(31:)
               move rapor-bit-ay      to call-alan3(32:)
               move "/"               to call-alan3(34:)
               move rapor-bit-yil     to call-alan3(35:)

               perform log-operation-calling               
                              .
*
 islem-yapr.
 istatistik-baslar.
     modify lb-isl-durumu, title = "Gunsonu Istatistigi Olusturuluyor Bekleyiniz.:" .
     initialize takvim-rec.
     move rapor-bas-tarih   to takvim-anah.
     start takvim key not < takvim-anah 
           invalid go transfer-bittir.
 takvim-okur.
     read takvim next no lock end go transfer-bittir. 
     if fs-takvim = 99 go takvim-okur.
     modify lb-isl-durumu, title = "Tarih".
     modify lb-isl-durumu-1, title = takvim-anah.
     if takvim-anah > rapor-bit-tarih 
        go transfer-bittir.
 ist-bosaltr.
         initialize istdatar-rec.
         move takvim-anah      to istr-tarih. 
         move spaces           to istr-acenta istr-rez-tipi.  
         move i                to istr-ref
         start istdatar key not < istdatar-anah invalid 
               go ist-bosalt-bittir.
 ist-bosalt-okur.
         read istdatar next no lock end go ist-bosalt-bittir.
         if fs-istdatar = 99 go ist-bosalt-okur.
         modify lb-isl-durumu-1, title = istdatar-anah.
         if istr-tarih > takvim-anah    or 
            istr-ref not = i
            go ist-bosalt-bittir.

         if istr-tarih = takvim-anah and 
            istr-ref = i   
            continue
         else 
            go ist-bosalt-okur
         end-if.   

         delete istdatar invalid continue.
            go ist-bosalt-okur.   
 ist-bosalt-bittir.
 det-bosaltr.
          initialize detistr-rec.
          move takvim-anah      to detistr-tarih. 
          move spaces           to detistr-acenta detistr-rez-tipi.  
          move i                to detistr-ref
          start detistr key not < detistr-anah invalid 
                go det-bosalt-bittir.
 det-bosalt-okur.
         read detistr  next no lock end go det-bosalt-bittir.
         if fs-detistr  = 99 go det-bosalt-okur.
         if detistr-tarih > takvim-anah  or
            detistr-ref not = i
            go det-bosalt-bittir.
         if detistr-tarih = takvim-anah and detistr-ref = i   
            continue
         else 
            go det-bosalt-okur
         end-if.   
         modify lb-isl-durumu-1, title = detistr-anah.
         delete detistr invalid continue.
              go det-bosalt-okur.   
 det-bosalt-bittir.
 tur-bosaltr.
        initialize turizmr-rec.
        move takvim-anah      to turizmr-tarih. 
        move spaces           to turizmr-ulke. 
        move i                to turizmr-ref
        start turizmr key not < turizmr-anah1 invalid 
             go tur-bosalt-bittir.
 tur-bosalt-okur.
         read turizmr  next no lock end go tur-bosalt-bittir.
         if fs-turizmr = 99 go tur-bosalt-okur.
         modify lb-isl-durumu-1, title = turizmr-anah.
         if turizmr-tarih > takvim-anah  or 
            turizmr-ref not = i
            go tur-bosalt-bittir.
         if turizmr-tarih = takvim-anah and
            turizmr-ref = i
            continue
         else 
            go tur-bosalt-okur
         end-if.   
            delete turizmr invalid continue.
            go tur-bosalt-okur.   
 tur-bosalt-bittir.
 cast-baslar.   
          initialize cast-rec.
          move takvim-anah to cast-tarih.
          start cast key not < cast-anah invalid 
                go yeni-gunr.
 cast-okur.    
        read cast next no lock end go yeni-gunr.
        if fs-cast = 99 go cast-okur.   
        modify lb-isl-durumu-1, title = cast-anah.
        modify lb-ref, title = i
        if cast-tarih > takvim-anah 
           go yeni-gunr.

        if cast-tarih = takvim-anah 
           continue
        else 
           go cast-okur
        end-if.
 
        move cast-rez-no   to rez-no.
        read rez no lock invalid 
             go cast-okur.

        if rez-durumu not = "I" 
             go cast-okur.

        move rez-folio   to konuk-folio.
        read konuk no lock invalid 
             go cast-okur.   
        if konuk-fol-kodu not = "R" 
             go cast-okur.
********************************RAMADA KUSADASI REF ODA ICIN KONULDU*************************

        if onkpara-referans-nerden = 2
            initialize ODALAR-ANAH
            move rez-odano to odalar-no
            if rez-odano <> cast-oda-no and cast-oda-no <> spaces
                  move cast-oda-no to odalar-no
            end-if
            read odalar no lock invalid
                    continue
            end-read
        end-if
        
        if odalar-referans not = i and onkpara-referans-nerden = 2
                     go cast-okur.
************************************************************************

         if xkonum-ref(cast-oda-konumu) not = i and onkpara-referans-nerden = 1
                     go cast-okur.
    
        
************* SON GUN FIYAT BASILDIGINDA OKUSUN************
*   TRACE Uygulamasi Acik ise kisi sayilari cast'tan alinacak
    MOVE 1 TO ODA-SAYI
    if rezpara-trace = 1
       if konuk-kisi not = cast-kisi
          move cast-kisi to konuk-kisi
       end-if
       if konuk-fiyat-konumu not = cast-fiyat-konumu
          move cast-fiyat-konumu to konuk-fiyat-konumu
       end-if 
       if konuk-pan-tipi not = cast-pan-tipi
          move cast-pan-tipi to konuk-pan-tipi
       end-if 
       if konuk-anlasma not = cast-anlasma
          move cast-anlasma to konuk-anlasma
       end-if 
       if konuk-share = 1 then          
             move 0 to oda-sayi
            else
              move 1 to oda-sayi
        end-if
      else 
          move 1 to oda-sayi
    end-if
*
    evaluate true
       when konuk-buyuk < 2
            move 1 to konuk-s-d-t-g
       when konuk-buyuk = 2
            move 2 to konuk-s-d-t-g
       when konuk-buyuk = 3
            move 3 to konuk-s-d-t-g
       when konuk-buyuk > 3
            move 4 to konuk-s-d-t-g
    end-evaluate. 
      
       if konuk-git-tar = cast-tarih 
          initialize oda-sayi konuk-buyuk konuk-kucuk 
                              konuk-free  konuk-bebek
       end-if. 
***********************************************************
        modify lb-isl-durumu-1, title = konuk-odano.

       initialize kodlar02-rec.
       move "A"                to kodlar02-tipi.
       move konuk-pan-tipi     to kodlar02-kodu.
       read kodlar02 no lock invalid continue
       end-read.

*/ Room Foliodan Oda tutari transfer oldugunda kisi sayisini odaya
*/ atsin diye konuldu....Hangisi dogru tartisilir
         initialize pan-dagilim
          if pan-oda         = "X" 
             move "E"   to oda-var
          end-if
          if pan-kahvalti    = "X" 

             move "E"   to kahvalti-var
          end-if
          if pan-ogle        = "X" 
             move "E"   to ogle-var
          end-if
          if pan-aksam       = "X" 
             move "E"   to aksam-var
          end-if
          if pan-icecek      = "X" 
             move "E"   to icecek-var
          end-if
          if pan-extra       = "X" 
             move "E"   to extra-var
          end-if

       initialize corr-tutarlar
       perform basilan-bulr  thru basilan-bul-exitr.

       initialize kodlar02-rec.
       move "B"                to kodlar02-tipi.
       move konuk-odeme-tipi   to kodlar02-kodu.
       read kodlar02 no lock invalid
            move spaces  to ode-tipi
       end-read.

        initialize istdatar-rec.
        move takvim-anah       to istr-tarih.
        move konuk-rez-tipi    to istr-rez-tipi.  
        move konuk-acenta      to istr-acenta.
        move i                 to istr-ref
        read istdatar   no lock invalid 
             initialize istdatar-rec
             move takvim-anah       to istr-tarih 
             move konuk-rez-tipi    to istr-rez-tipi  
             move konuk-acenta      to istr-acenta
             move i                 to istr-ref
        end-read. 

          compute istr-top-oda     = istr-top-oda    + oda-sayi.
          compute istr-top-buyuk   = istr-top-buyuk  + konuk-buyuk. 
          compute istr-top-kucuk   = istr-top-kucuk  + konuk-kucuk. 
          compute istr-top-free    = istr-top-free   + konuk-free.  
          compute istr-top-free    = istr-top-free   + konuk-bebek. 
          compute istr-top-tutar   = istr-top-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
          compute istr-top-corr-tutar   = istr-top-corr-tutar  + + corr-oda-tutar +
                  corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                  corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar.
          if konuk-oda-tutar not = 0 or oda-var not = spaces
          compute istr-oda-oda     = istr-oda-oda    + oda-sayi
          compute istr-oda-buyuk   = istr-oda-buyuk  + konuk-buyuk
          compute istr-oda-kucuk   = istr-oda-kucuk  + konuk-kucuk
          compute istr-oda-free    = istr-oda-free   + konuk-free  
          compute istr-oda-free    = istr-oda-free   + konuk-bebek 
          compute istr-oda-tutar   = istr-oda-tutar  + konuk-oda-tutar .
          
          if konuk-kahvalti-tutar not = 0 or kahvalti-var not = spaces
          compute istr-kah-oda     = istr-kah-oda    + oda-sayi
          compute istr-kah-buyuk   = istr-kah-buyuk  + konuk-buyuk
          compute istr-kah-kucuk   = istr-kah-kucuk  + konuk-kucuk
          compute istr-kah-free    = istr-kah-free   + konuk-free  
          compute istr-kah-free    = istr-kah-free   + konuk-bebek 
          compute istr-kah-tutar   = istr-kah-tutar  + konuk-kahvalti-tutar .
          if konuk-ogle-tutar not = 0 or ogle-var not = spaces
          compute istr-ogl-oda     = istr-ogl-oda    + oda-sayi
          compute istr-ogl-buyuk   = istr-ogl-buyuk  + konuk-buyuk
          compute istr-ogl-kucuk   = istr-ogl-kucuk  + konuk-kucuk
          compute istr-ogl-free    = istr-ogl-free   + konuk-free  
          compute istr-ogl-free    = istr-ogl-free   + konuk-bebek 
          compute istr-ogl-tutar   = istr-ogl-tutar  + konuk-ogle-tutar .
          if konuk-aksam-tutar not = 0 or aksam-var not = spaces
          compute istr-aks-oda     = istr-aks-oda    + oda-sayi
          compute istr-aks-buyuk   = istr-aks-buyuk  + konuk-buyuk

          compute istr-aks-kucuk   = istr-aks-kucuk  + konuk-kucuk
          compute istr-aks-free    = istr-aks-free   + konuk-free  
          compute istr-aks-free    = istr-aks-free   + konuk-bebek 
          compute istr-aks-tutar   = istr-aks-tutar  + konuk-aksam-tutar.
          if konuk-icecek-tutar not = 0 or icecek-var not = spaces
          compute istr-ice-oda     = istr-ice-oda    + oda-sayi
          compute istr-ice-buyuk   = istr-ice-buyuk  + konuk-buyuk
          compute istr-ice-kucuk   = istr-ice-kucuk  + konuk-kucuk
          compute istr-ice-free    = istr-ice-free   + konuk-free  
          compute istr-ice-free    = istr-ice-free   + konuk-bebek 
          compute istr-ice-tutar   = istr-ice-tutar  + konuk-icecek-tutar.
          if konuk-extra-tutar not = 0 or extra-var not = spaces
          compute istr-ext-oda     = istr-ext-oda    + oda-sayi
          compute istr-ext-buyuk   = istr-ext-buyuk  + konuk-buyuk
          compute istr-ext-kucuk   = istr-ext-kucuk  + konuk-kucuk
          compute istr-ext-free    = istr-ext-free   + konuk-free  
          compute istr-ext-free    = istr-ext-free   + konuk-bebek 
          compute istr-ext-tutar   = istr-ext-tutar  + konuk-extra-tutar.
          if konuk-extbed-tutar not = 0 
          compute istr-exb-oda     = istr-exb-oda    + oda-sayi
          compute istr-exb-buyuk   = istr-exb-buyuk  + konuk-buyuk
          compute istr-exb-kucuk   = istr-exb-kucuk  + konuk-kucuk
          compute istr-exb-free    = istr-exb-free   + konuk-free  
          compute istr-exb-free    = istr-exb-free   + konuk-bebek 
          compute istr-exb-tutar   = istr-exb-tutar  + konuk-extbed-tutar.

          compute istr-sdt-oda(konuk-s-d-t-g) =
                  istr-sdt-oda(konuk-s-d-t-g) + oda-sayi.
          compute istr-sdt-buyuk(konuk-s-d-t-g) =
                  istr-sdt-buyuk(konuk-s-d-t-g) + konuk-buyuk. 
          compute istr-sdt-kucuk(konuk-s-d-t-g) =
                  istr-sdt-kucuk(konuk-s-d-t-g) + konuk-kucuk. 
          compute istr-sdt-free(konuk-s-d-t-g) =
                  istr-sdt-free(konuk-s-d-t-g) + konuk-free. 
          compute istr-sdt-free(konuk-s-d-t-g) =
                  istr-sdt-free(konuk-s-d-t-g) + konuk-bebek.
          compute istr-sdt-tutar(konuk-s-d-t-g) =
                  istr-sdt-tutar(konuk-s-d-t-g) + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
************Complimentary bolumu......
          if ode-tipi = "D" 
          compute istr-com-oda     = istr-com-oda    + oda-sayi
          compute istr-com-buyuk   = istr-com-buyuk  + konuk-buyuk
          compute istr-com-kucuk   = istr-com-kucuk  + konuk-kucuk

          compute istr-com-free    = istr-com-free   + konuk-free  
          compute istr-com-free    = istr-com-free   + konuk-bebek 
          compute istr-com-tutar   = istr-com-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
************House Use bolumu......
          if ode-tipi = "F" 
          compute istr-hou-oda     = istr-hou-oda    + oda-sayi
          compute istr-hou-buyuk   = istr-hou-buyuk  + konuk-buyuk
          compute istr-hou-kucuk   = istr-hou-kucuk  + konuk-kucuk
          compute istr-hou-free    = istr-hou-free   + konuk-free  
          compute istr-hou-free    = istr-hou-free   + konuk-bebek 
          compute istr-hou-tutar   = istr-hou-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
          rewrite istdatar-rec invalid write istdatar-rec end-rewrite.
************>Istatiklere yazildi.......

*******>Detist  Bolumu
        initialize detistr-rec.
        move takvim-anah         to detistr-tarih.
        move konuk-acenta        to detistr-acenta. 
        move konuk-ulke          to detistr-ulke-kodu. 
        move konuk-pan-tipi      to detistr-pan-tipi. 

        move konuk-rez-tipi      to detistr-rez-tipi.  
        move konuk-fiyat-konumu  to detistr-oda-konumu.
        move konuk-anlasma       to detistr-anlasma-kodu.
        move i                   to detistr-ref
        read detistr no lock invalid 
             initialize detistr-rec
             move takvim-anah         to detistr-tarih
             move konuk-acenta        to detistr-acenta 
             move konuk-ulke          to detistr-ulke-kodu 
             move konuk-pan-tipi      to detistr-pan-tipi 
             move konuk-rez-tipi      to detistr-rez-tipi  
             move konuk-fiyat-konumu  to detistr-oda-konumu
             move konuk-anlasma       to detistr-anlasma-kodu
             move i                   to detistr-ref
        end-read. 

          compute detistr-top-oda     = detistr-top-oda    + oda-sayi.
          compute detistr-top-buyuk   = detistr-top-buyuk  + konuk-buyuk. 
          compute detistr-top-kucuk   = detistr-top-kucuk  + konuk-kucuk. 
          compute detistr-top-free    = detistr-top-free   + konuk-free.  
          compute detistr-top-bebek   = detistr-top-bebek  + konuk-bebek. 
          compute detistr-top-tutar   = detistr-top-tutar  + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
          compute detistr-top-corr    = detistr-top-corr   + corr-oda-tutar +
                  corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +


                  corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar.

*          if konuk-oda-tutar not = 0
          if konuk-oda-tutar not = 0 or corr-oda-tutar not = 0
             or oda-var not = spaces
             compute detistr-oda-oda     = detistr-oda-oda    + oda-sayi
             compute detistr-oda-buyuk   = detistr-oda-buyuk  + konuk-buyuk
             compute detistr-oda-kucuk   = detistr-oda-kucuk  + konuk-kucuk 
             compute detistr-oda-free    = detistr-oda-free   + konuk-free
             compute detistr-oda-bebek   = detistr-oda-bebek  + konuk-bebek
             compute detistr-oda-tutar   = detistr-oda-tutar  + konuk-oda-tutar
             compute detistr-oda-corr    = detistr-oda-corr   + corr-oda-tutar
          end-if.

*          if konuk-kahvalti-tutar not = 0
          if konuk-kahvalti-tutar not = 0 or corr-kahvalti-tutar not = 0
             or kahvalti-var not = spaces
             compute detistr-kah-oda     = detistr-kah-oda    + oda-sayi
             compute detistr-kah-buyuk   = detistr-kah-buyuk  + konuk-buyuk
             compute detistr-kah-kucuk   = detistr-kah-kucuk  + konuk-kucuk 
             compute detistr-kah-free    = detistr-kah-free   + konuk-free
             compute detistr-kah-bebek   = detistr-kah-bebek  + konuk-bebek
             compute detistr-kah-tutar   = 
                     detistr-kah-tutar  + konuk-kahvalti-tutar
             compute detistr-kah-corr    = 
                     detistr-kah-corr   + corr-kahvalti-tutar
          end-if.

*          if konuk-ogle-tutar not = 0
          if konuk-ogle-tutar not = 0 or corr-ogle-tutar not = 0
             or ogle-var not = spaces
             compute detistr-ogl-oda     = detistr-ogl-oda    + oda-sayi
             compute detistr-ogl-buyuk   = detistr-ogl-buyuk  + konuk-buyuk
             compute detistr-ogl-kucuk   = detistr-ogl-kucuk  + konuk-kucuk 
             compute detistr-ogl-free    = detistr-ogl-free   + konuk-free
             compute detistr-ogl-bebek   = detistr-ogl-bebek  + konuk-bebek
             compute detistr-ogl-tutar   = detistr-ogl-tutar  + konuk-ogle-tutar
             compute detistr-ogl-corr    = detistr-ogl-corr   + corr-ogle-tutar
          end-if.
*          if konuk-aksam-tutar not = 0
          if konuk-aksam-tutar not = 0 or corr-aksam-tutar not = 0
             or aksam-var not = spaces
             compute detistr-aks-oda     = detistr-aks-oda    + oda-sayi
             compute detistr-aks-buyuk   = detistr-aks-buyuk  + konuk-buyuk
             compute detistr-aks-kucuk   = detistr-aks-kucuk  + konuk-kucuk 
             compute detistr-aks-free    = detistr-aks-free   + konuk-free
             compute detistr-aks-bebek   = detistr-aks-bebek  + konuk-bebek
             compute detistr-aks-tutar   = detistr-aks-tutar  + konuk-aksam-tutar
             compute detistr-aks-corr    = detistr-aks-corr   + corr-aksam-tutar
          end-if.
*          if konuk-icecek-tutar not = 0
          if konuk-icecek-tutar not = 0 or corr-icecek-tutar not = 0
             or icecek-var not = spaces
             compute detistr-ice-oda     = detistr-ice-oda    + oda-sayi
             compute detistr-ice-buyuk   = detistr-ice-buyuk  + konuk-buyuk
             compute detistr-ice-kucuk   = detistr-ice-kucuk  + konuk-kucuk 
             compute detistr-ice-free    = detistr-ice-free   + konuk-free
             compute detistr-ice-bebek   = detistr-ice-bebek  + konuk-bebek
             compute detistr-ice-tutar   = detistr-ice-tutar  + konuk-icecek-tutar
             compute detistr-ice-corr    = detistr-ice-corr   + corr-icecek-tutar
          end-if.
*          if konuk-extra-tutar not = 0
          if konuk-extra-tutar not = 0 or corr-extra-tutar not = 0
             or extra-var not = spaces
             compute detistr-ext-oda     = detistr-ext-oda    + oda-sayi
             compute detistr-ext-buyuk   = detistr-ext-buyuk  + konuk-buyuk
             compute detistr-ext-kucuk   = detistr-ext-kucuk  + konuk-kucuk 
             compute detistr-ext-free    = detistr-ext-free   + konuk-free
             compute detistr-ext-bebek   = detistr-ext-bebek  + konuk-bebek
             compute detistr-ext-tutar   = detistr-ext-tutar  + konuk-extra-tutar
             compute detistr-ext-corr    = detistr-ext-corr   + corr-extra-tutar
          end-if.
*          if konuk-extbed-tutar not = 0
          if konuk-extbed-tutar not = 0 or corr-extbed-tutar not = 0
             compute detistr-exb-oda     = detistr-exb-oda    + oda-sayi
             compute detistr-exb-buyuk   = detistr-exb-buyuk  + konuk-buyuk
             compute detistr-exb-kucuk   = detistr-exb-kucuk  + konuk-kucuk 
             compute detistr-exb-free    = detistr-exb-free   + konuk-free
             compute detistr-exb-bebek   = detistr-exb-bebek  + konuk-bebek
             compute detistr-exb-tutar   = detistr-exb-tutar  + konuk-extbed-tutar
             compute detistr-exb-corr    = detistr-exb-corr   + corr-extbed-tutar
          end-if.

          compute detistr-sdt-oda(konuk-s-d-t-g) =
                  detistr-sdt-oda(konuk-s-d-t-g) + oda-sayi.
          compute detistr-sdt-buyuk(konuk-s-d-t-g) =
                  detistr-sdt-buyuk(konuk-s-d-t-g) + konuk-buyuk. 
          compute detistr-sdt-kucuk(konuk-s-d-t-g) =
                  detistr-sdt-kucuk(konuk-s-d-t-g) + konuk-kucuk. 
          compute detistr-sdt-free(konuk-s-d-t-g) =
                  detistr-sdt-free(konuk-s-d-t-g) + konuk-free. 
          compute detistr-sdt-bebek(konuk-s-d-t-g) =
                  detistr-sdt-bebek(konuk-s-d-t-g) + konuk-bebek.
          compute detistr-sdt-tutar(konuk-s-d-t-g) =
                  detistr-sdt-tutar(konuk-s-d-t-g) + konuk-oda-tutar +
                  konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                  konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.
          compute detistr-sdt-corr(konuk-s-d-t-g) =
                  detistr-sdt-corr(konuk-s-d-t-g) + corr-oda-tutar +
                  corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                  corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar.
************Complimentary bolumu......
          if ode-tipi = "D" 
             compute detistr-com-oda     = detistr-com-oda    + oda-sayi
             compute detistr-com-buyuk   = detistr-com-buyuk  + konuk-buyuk
             compute detistr-com-kucuk   = detistr-com-kucuk  + konuk-kucuk
             compute detistr-com-free    = detistr-com-free   + konuk-free  
             compute detistr-com-bebek   = detistr-com-bebek  + konuk-bebek 
             compute detistr-com-tutar   = detistr-com-tutar  + konuk-oda-tutar +
                 konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                 konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar
             compute detistr-com-corr    = detistr-com-corr   + corr-oda-tutar +
                 corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                 corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar
          end-if.
************House Use     bolumu......
          if ode-tipi = "F" 
             compute detistr-hou-oda     = detistr-hou-oda    + oda-sayi
             compute detistr-hou-buyuk   = detistr-hou-buyuk  + konuk-buyuk
             compute detistr-hou-kucuk   = detistr-hou-kucuk  + konuk-kucuk
             compute detistr-hou-free    = detistr-hou-free   + konuk-free  
             compute detistr-hou-bebek   = detistr-hou-bebek  + konuk-bebek 
             compute detistr-hou-tutar   = detistr-hou-tutar  + konuk-oda-tutar +
                 konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                 konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar
             compute detistr-hou-corr    = detistr-hou-corr  + corr-oda-tutar +
                 corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                 corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar
          end-if.
          rewrite detistr-rec invalid 
                  write detistr-rec 
                  end-write continue
          end-rewrite.
*******>Detist  Bolumu
        initialize turizmr-rec.
        move takvim-anah       to turizmr-tarih.   
        move konuk-ulke        to turizmr-ulke.
        move konuk-sehir       to turizmr-sehir.
        move i                 to turizmr-ref
        read turizmr   no lock invalid 
             continue.

        compute kalanr-oda   = kalanr-oda   + oda-sayi. 
        compute kalanr-buyuk = kalanr-buyuk + konuk-buyuk. 
        compute kalanr-kucuk = kalanr-kucuk + konuk-kucuk. 
        compute kalanr-free  = kalanr-free  + konuk-free.  
        compute kalanr-bebek = kalanr-bebek + konuk-bebek. 

        if konuk-gel-tar = takvim-anah      
        compute gelenr-oda   = gelenr-oda   + oda-sayi
        compute gelenr-buyuk = gelenr-buyuk + konuk-buyuk
        compute gelenr-kucuk = gelenr-kucuk + konuk-kucuk 
        compute gelenr-free  = gelenr-free  + konuk-free
        compute gelenr-bebek = gelenr-bebek + konuk-bebek. 

        compute turizmr-toplam-tutar = turizmr-toplam-tutar  + konuk-oda-tutar +
                konuk-kahvalti-tutar + konuk-ogle-tutar  + konuk-aksam-tutar +
                konuk-icecek-tutar   + konuk-extra-tutar + konuk-extbed-tutar.

        compute turizmr-corr-tutar   = turizmr-corr-tutar    + corr-oda-tutar +
                corr-kahvalti-tutar + corr-ogle-tutar  + corr-aksam-tutar +
                corr-icecek-tutar   + corr-extra-tutar + corr-extbed-tutar.

        rewrite turizmr-rec invalid 
                write turizmr-rec 
                end-write
        end-rewrite.
                 go cast-okur.  
 yeni-gunr.
        go takvim-okur.
 transfer-bittir. 
     go sonr.  
 dfkdkdkdkr.  
 basilan-bulr. 
        initialize  konuk-oda-tutar       konuk-extra-tutar
                    konuk-kahvalti-tutar  konuk-ogle-tutar
                    konuk-aksam-tutar     konuk-icecek-tutar.
         move konuk-folio    to romhrk-folio.
         move takvim-anah    to romhrk-tarih.
         start romhrk key not < romhrk-anah1 
               invalid go basilan-bul-exitr.
 basilan-okur. 
         read romhrk next no lock end 
              go basilan-bul-exitr.
         if fs-romhrk = 99 go basilan-okur.
         if romhrk-tarih > takvim-anah 
            go basilan-bul-exitr.
         if romhrk-folio not = konuk-folio 
            go basilan-bul-exitr.         
*/ CORRECTION
         perform correction-kontrolr
*/ CORRECTION
         evaluate true 
          when pan-oda         = "X" and oda-dep      = romhrk-depkod
               compute konuk-oda-tutar      = 
                       konuk-oda-tutar + romhrk-tl-tutar  
          when pan-kahvalti    = "X" and kahvalti-dep = romhrk-depkod
               compute konuk-kahvalti-tutar = 
                       konuk-kahvalti-tutar + romhrk-tl-tutar
          when pan-ogle        = "X" and ogle-dep     = romhrk-depkod
               compute konuk-ogle-tutar     = 
                       konuk-ogle-tutar     + romhrk-tl-tutar
          when pan-aksam       = "X" and aksam-dep    = romhrk-depkod
               compute konuk-aksam-tutar    = 
                       konuk-aksam-tutar    + romhrk-tl-tutar
          when pan-icecek      = "X" and icecek-dep   = romhrk-depkod
               compute konuk-icecek-tutar   = 
                       konuk-icecek-tutar   + romhrk-tl-tutar
          when pan-extra       = "X" and extra-dep    = romhrk-depkod

               compute konuk-extra-tutar    = 
                       konuk-extra-tutar    + romhrk-tl-tutar
         end-evaluate. 
         go basilan-okur.
 basilan-bul-exitr. 
        exit.
*
 correction-kontrolr.
         move romhrk-depkod     to depkod-kodu
         read depkod no lock invalid
              continue
         end-read
         if depkod-turu <> 2 or romhrk-corr-depkod = zeroes
            exit paragraph.

         move romhrk-corr-depkod    to depkod-kodu
         read depkod no lock invalid
              exit paragraph
         end-read

         evaluate true 
          when pan-oda         = "X" and oda-dep      = romhrk-corr-depkod
               compute corr-oda-tutar      = 
                       corr-oda-tutar + romhrk-tl-tutar
          when pan-kahvalti    = "X" and kahvalti-dep = romhrk-corr-depkod
               compute corr-kahvalti-tutar = 
                       corr-kahvalti-tutar + romhrk-tl-tutar
          when pan-ogle        = "X" and ogle-dep     = romhrk-corr-depkod
               compute corr-ogle-tutar     = 
                       corr-ogle-tutar     + romhrk-tl-tutar
          when pan-aksam       = "X" and aksam-dep    = romhrk-corr-depkod
               compute corr-aksam-tutar    = 
                       corr-aksam-tutar    + romhrk-tl-tutar
          when pan-icecek      = "X" and icecek-dep   = romhrk-corr-depkod
               compute corr-icecek-tutar   = 
                       corr-icecek-tutar   + romhrk-tl-tutar
          when pan-extra       = "X" and extra-dep    = romhrk-corr-depkod
               compute corr-extra-tutar    = 
                       corr-extra-tutar    + romhrk-tl-tutar
         end-evaluate. 
 sonr.
 islem-yap-exitr.
      exit.



 Share-Bul-Islem.
      open i-o acast arez  konu2
       move k-kodu-tasi to takas-k
      initialize takvim-rec fs-takvim

      move rapor-bas-tarih to takvim-anah 
      start takvim key >= takvim-anah invalid 
            continue
      not invalid 
          perform until fs-takvim = "10"
               read takvim next no lock end move "10" to fs-takvim
                   not end
                     if takvim-anah > rapor-bit-tarih then
                        move "10" to fs-takvim
                        else
                          open output takas close takas open i-o takas
                           initialize cast-rec fs-cast  
                           move takvim-anah to cast-tarih
                           start cast key > cast-anah invalid continue
                             not invalid
                               perform until fs-cast = "10"
                                   read cast next no lock end move "10" to fs-cast
                                       not end
                                       if cast-tarih not = takvim-anah 
                                            move "10" to fs-cast
                                            else  
                                         
                                            if cast-sharenum not > 0 then 
                                                 if cast-share = 1 then
                                                    move 0 to cast-share
                                                   rewrite cast-rec invalid stop " " end-rewrite 
                                                  end-if
                                            else
                                                  move cast-oda-no   to takas-odano
                                                  move cast-sharenum to takas-sharenum
                                                   
                                                  write takas-rec invalid rewrite takas-rec end-write

                                            end-if
                                       end-if
                                    end-read
                               end-perform
                            end-start
                             perform tek-share-bul
                          close takas
                          
                     end-if
                     end-read
          end-perform 
       end-start
      
                              perform arez-at
         close acast arez  konu2
                         
     .
*
 tek-share-bul.
     
     initialize takas-rec   fs-takas
     start takas key >= takas-anah invalid continue
        not invalid 
        perform until fs-takas = "10" 
             read takas next no lock
                  end 
                      move "10" to fs-takas
                  not end
                    
                      perform tek-tek-share-bul
              end-read
        end-perform
     end-start .

*
 tek-tek-share-bul.
       move takvim-anah to takvim2-anah
       initialize ana-oda-verildi acast-rec   fs-acast
        move 1 to ish 
        move  takas-odano     to   acast-oda-no share-oda(ish)   
        move  takas-sharenum  to   acast-sharenum    rez-sharenum
        move   takvim-anah     to acast-tarih
        move high-values to acast-fiyati  acast-buyuk
               initialize fs-acast
        start acast key < acast-anah6 invalid 
               continue
          not invalid
            perform until fs-acast = "10" 
                read acast previous no lock  
                    end
                     move "10" to fs-acast
                     if ana-oda-verildi not = 1 
                                   move 1 to  ana-oda-verildi
                                    if  acast-share not = 0
                                         move 0 to acast-share
                                       rewrite acast-rec invalid stop " " end-rewrite
                                       else
                                       display message box "Hataaaaa"
                                    end-if
                       end-if
                     not end
                     if   takvim2-anah not = acast-tarih  or
                          rez-sharenum not = acast-sharenum  or
                          share-oda(ish) not = acast-oda-no
                            move "10" to fs-acast
                             if ana-oda-verildi not = 1 
                               read   acast next no lock 
                               end   display message box "Hataaaaa"
                               exit perform cycle
                               end-read
                                   if   takvim2-anah not = acast-tarih  or
                                          rez-sharenum not = acast-sharenum  or
                                          share-oda(ish) not = acast-oda-no
                                       display message box "Hataaaaa25666"
                                        exit perform cycle
                                  end-if
                                   move 1 to  ana-oda-verildi
                                    if  acast-share not = 0
                                         move 0 to acast-share
                                       rewrite acast-rec invalid stop " " end-rewrite
                                       else
                                       display message box "Hataaaaa"
                                    end-if
                              end-if
                            exit perform cycle
                     end-if
                     move acast-rez-no to arez-no
                     move acast-rez-no to arez-no 
                         read arez no lock invalid 
                           display message  box "Hata Bakim icin arayiniz Castttt "
                               end-read
                                 if arez-durumu  = "S" then
                                       |****display message box "Silinmis Share gorunuyor " acast-rez-no
                                       |****if k-kodu-tasi = "ASYA" or "X   " then 
                                       |****    stop " "
                                           |///delete acast end-delete
                                       |****end-if 
                                       exit perform cycle
                                       
                                 end-if
                        if arez-cik-tar <= acast-tarih
                            if  acast-share not = 1
                                 move 1 to acast-share
                                 rewrite acast-rec invalid stop " " end-rewrite
                            end-if
                         else
                             if ana-oda-verildi not = 1 
                                   move 1 to  ana-oda-verildi
                                    if  acast-share not = 0
                                         move 0 to acast-share
                                       rewrite acast-rec invalid stop " " end-rewrite
                                   end-if
                             else
                                      if  acast-share not = 1
                                            move 1 to acast-share
                                           rewrite acast-rec invalid stop " " end-rewrite
                                      end-if
                       end-if
                  end-if

                end-read
            end-perform
       end-start  .
*
 arez-at.
       initialize arez-rec fs-arez
       move "I" to arez-durumu
       move 0   to arez-sharenum
         
       start arez key >= aREZ-anah-share invalid continue
          not invalid
          perform until fs-arez = "10" 
              read arez next no lock end                        
                     move "10" to fs-arez
                 not end
                        
                    if arez-durumu not = "I"
                            move "10" to fs-arez
                        exit perform cycle
                    end-if
                    if arez-cik-tar < tarih-tasi 
                         exit perform cycle
                    end-if
                   if arez-gir-tar <= tarih-tasi
                       move   tarih-tasi to acast-tarih
                       move   arez-no   to  acast-rez-no
                       read acast no lock invalid 
**                                   display message  box "Hata Bakim icin arayiniz Cast444tt "
                                continue
                             not invalid 
                             if acast-share not = arez-share 
                                     move acast-share to arez-share
                                     rewrite arez-rec invalid stop " " end-rewrite
                                    if arez-folio > 0 then 
                                       move arez-folio to konu2-folio
                                       read konu2 no lock invalid continue
                                       not invalid
                                          move acast-share to konu2-share
                                          rewrite konu2-rec invalid continue end-rewrite
                                       end-read

                                     end-if



                             end-if
                       end-read
                   else
                        move   arez-gir-tar  to acast-tarih
                         move   arez-no        to  acast-rez-no
                       read acast no lock invalid 
                                continue
**                                   display message  box "Hata Bakim icin arayiniz Cast444tt2 "
                             not invalid 
                             if acast-share not = arez-share 
                                     move acast-share to arez-share
                                     rewrite arez-rec invalid stop " " end-rewrite
                             end-if
                       end-read


                   end-if
              end-read
          end-perform 
       end-start .
*
 break-ayir-yeni-hesaplama.      
       open input  break
       initialize cast-rec 
       move rapor-bas-tarih          to cast-tarih
       if ilk-break-tar >   rapor-bas-tarih
         move rapor-bas-tarih to ilk-break-tar
       end-if
      move ilk-break-tar  to  cast-tarih
       start cast key not < cast-anah invalid 
            continue 
       not invalid 
       perform with test after until fs-cast = "10"
       read cast next no lock end move "10"  to fs-cast
       not at end
                 if cast-tarih > rapor-bit-tarih
                      exit perform
                 end-if
                 initialize rez-rec 
                 move cast-rez-no  to rez-no
                 read rez no lock invalid 
                      continue 
                 not invalid 
                      move cast-kisi      to rez-kisi
                      move cast-pan-tipi  to rez-pan-tipi
                      perform break-mami
                      
                      rewrite cast-rec invalid 
                          write cast-rec end-write 
                      end-rewrite 
                 end-read
       end-read 
       end-perform
       end-start
       close   break
      .

@}}

[KEY_STATUS_FIELD_FORMAT]
PIC=9(4)
USAGE=[None]

[KEYSTATUS_CONTENT:KS1]
CONDITION=Exit-Pushed
VALUE=27

[KEYSTATUS_CONTENT:KS2]
CONDITION=Message-Received
VALUE=95

[KEYSTATUS_CONTENT:KS3]
CONDITION=Event-Occurred
VALUE=96

[KEYSTATUS_CONTENT:KS4]
CONDITION=Screen-No-Input-Field
VALUE=97

[CODE_GENERATION_OPTIONS]
FOLLOW_PROJECT_OPTIONS=1
GENERATE_PROGRAM_FILE=1
GENERATE_WORKING_STORAGE=1
GENERATE_EVENT_PARAGRAPH=1
GENERATE_SCREEN_SECTION=1
GENERATE_REPORT_SECTION=1
GENERATE_PROCEDURE_DIVISION=1
GENERATE_MENU_PARAGRAPH=1
GENERATE_LINKAGE_SECTION=1
REPLACE_REMARK_PART=1
EXCLUDE_PROGRAM_VARIABLE=1
EXCLUDE_PROGRAM_PARAGRAPH=1
PROGRAM_EXTENSION=.cbl
WORKINGSTORAGE_EXTENSION=.wrk
EVENT_EXTENSION=.evt
SCREEN_EXTENSION=.scr
REPORT_EXTENSION=.rpt
PROCEDURE_EXTENSION=.prd
MENU_EXTENSION=.mnu
LINKAGE_EXTENSION=.lks
PROGRAM_FILE_READ_ONLY=0
LINK_CLOSE_TO_OPEN=0
COPYBOOK_READ_ONLY=0
GENERATE_COPY_FILES=1
ACCEPT_CONTROL=1
ANSI_DOCUMENT_FORMAT=1