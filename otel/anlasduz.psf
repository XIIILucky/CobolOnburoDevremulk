; CASEMaker AcuBench Program Structure File, Version 9.2
; WARNING: DO NOT MODIFY THIS FILE!

[PROGRAM_CONTENT]
QUIT_CONFIRM=0
MAIN_SCREEN_NAME=Form1

{{@DESCRIPTION:

@}}

[WORKING_STORAGE]
m_nType=1
m_strName=Working Storage
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionWK

@}}
[FDITEM0_WK]
m_nType=10
m_strName=Small-Font
m_nUsage=37
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_WK

@}}
[FDITEM1_WK]
m_nType=10
m_strName=Form1-Handle
m_nUsage=24
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_WK

@}}
[FDITEM2_WK]
m_nType=10
m_strName=Form1-St-1-Handle
m_nUsage=51
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM2_WK

@}}
[FDITEM3_WK]
m_nType=10
m_strName=Fixed-Font
m_nUsage=39
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM3_WK

@}}
[FDITEM4_WK]
m_strName=takas-adres
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM4_WK

@}}
[FDITEM5_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=x(20)
m_strDefaultValue="/asya/ytl/liste/pphz"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__3
{{@DataItem_m_strDescriptionFDITEM5_WK

@}}
[FDITEM6_WK]
m_strName=FILLER
m_strRawPic=x
m_strPic=x
m_strDefaultValue="."
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__10
{{@DataItem_m_strDescriptionFDITEM6_WK

@}}
[FDITEM7_WK]
m_strName=takas-no
m_strRawPic=xxx
m_strPic=xxx
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=takas1_no__1
{{@DataItem_m_strDescriptionFDITEM7_WK

@}}
[FDITEM8_WK]
m_strName=fs-takas
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM8_WK

@}}
[FDITEM9_WK]
m_nType=10
m_strName=Form1-Gd-1-Record
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM9_WK

@}}
[FDITEM10_WK]
m_nType=10
m_strName=Gd-1-Col-1
m_strRawPic=X(08)
m_strPic=X(08)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM10_WK

@}}
[FDITEM11_WK]
m_nType=10
m_strName=Gd-1-Col-2
m_strRawPic=X(250)
m_strPic=X(250)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM11_WK

@}}
[FDITEM12_WK]
m_nType=10
m_strName=Gd-1-Col-3
m_strRawPic=X(08)
m_strPic=X(08)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM12_WK

@}}
[FDITEM13_WK]
m_nType=10
m_strName=Gd-1-Col-4
m_strRawPic=X(100)
m_strPic=X(100)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM13_WK

@}}
[FDITEM14_WK]
m_nType=10
m_strName=Gd-1-Col-5
m_strRawPic=X(08)
m_strPic=X(08)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM14_WK

@}}
[FDITEM15_WK]
m_nType=10
m_strName=Form1-LM
m_nUsage=54
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM15_WK

@}}
[FDITEM16_WK]
m_strName=ydk-anlasma-kodu
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM16_WK

@}}
[FDITEM17_WK]
m_strName=ydk-acenta-kodu
m_strRawPic=x(4)
m_strPic=x(4)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM17_WK

@}}
[FDITEM18_WK]
m_strName=kaynak-anlasma-kodu
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM18_WK

@}}
[FDITEM19_WK]
m_strName=z-adet
m_strRawPic=z(5)
m_strPic=z(5)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM19_WK

@}}
[FDITEM20_WK]
m_strName=d
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM20_WK

@}}


[LINKAGE_SECTION]
m_nType=1
m_strName=Linkage Section
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionLK

@}}


{{@SCREEN:
*   Screen Painter Data
*   Schema 6.0
*
BEGIN-SPDATA

GRAPHICAL-SCREEN

Begin Screen Form1
   PREFIX            = Form1
   LOCK-CONTROL      = TRUE
   (Name)            = Form1
   Absolute Column   = 0
   Absolute Line     = 0
   Action            = Action-Maximize
   Auto Minimize     = FALSE
   Auto Resize       = FALSE
   Bind To Thread    = FALSE
   Boxed             = FALSE
   Cell              = TRUE
   Cell Height       = 10
   Cell Measure      = Pixels
   Cell Width        = 10
   Color             = 65793
   Controls Uncropped = FALSE
   Erase Screen      = FALSE
   Font              = Small Font
   Font Variable     = Small-Font
   Handle Variable   = Form1-Handle
   Help ID           = 0
   Label Offset      = 0
   Layout Manager    = LM_RESIZE
   Layout Manager Handle = Form1-LM
   Lines             = 48.00
   Link To Thread    = TRUE
   Max Lines         = 0.00
   Max Size          = 0.00
   Measuring Control = Label
   Measuring Font    = Default Font
   Measuring Style   = [None]
   Min Lines         = 0.00
   Min Size          = 0.00
   Modeless          = TRUE
   No Close          = FALSE
   Resizable         = TRUE
   Scroll            = FALSE
   Size              = 67.90
   System Menu       = TRUE
   Title             = "Anlasma Duzenleme... "
   Title Bar         = TRUE
   Unit              = Cells
   User Gray         = TRUE
   User White        = TRUE
   Visible           = 1:TRUE
   Window Type       = Floating
   Wrap              = FALSE
   Event Procedure   = Form1-Event-Proc
   Before Create     = Form1-Bef-Create
   After Initdata    = Form1-Aft-Initdata
   Begin Status-Bar Form1-St-1
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-St-1
      Font              = Small Font
      Font Variable     = Small-Font
      Grip              = TRUE
      Handle Variable   = Form1-St-1-Handle
      PANEL-WIDTHS      = ( 100 )
      PANEL-STYLE       = ( 1 )
      Tab Order         = 1
   End
   Begin Frame Form1-Fr-1
      SCREEN-COL        = 1.00
      SCREEN-LINE       = 1.50
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Fr-1
      3D Style          = Raised
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 176
      Column            = 1.00
      Csize             = 0
      Destroy Type      = Automatic
      FILL-COLOR        = 5
      FILL-PERCENT      = 100
      Font              = Fixed Font
      Font Variable     = Fixed-Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 1
      Layout Data       = 1
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.50
      Lines             = 2.50
      Low Color         = 0
      Size              = 67.90
      Tab Order         = 2
      Thickness         = Default
      Title             = "ANLASMA DUZENLEME PROGRAMI [REZERVASYON - ANLASMA - ANLASMA KABUL GIRISI - KONUK ]"
      Title Position    = 7:Centered vertically and horizontally
      Visible           = 1:TRUE
   End
   Begin Frame Form1-Fr-2
      SCREEN-COL        = 1.50
      SCREEN-LINE       = 4.50
      LOCK-CONTROL      = TRUE
      (Name)            = Form1-Fr-2
      3D Style          = Rimmed
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 1.50
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = TRUE
      Help ID           = 0
      High Color        = 0
      ID                = 2
      Layout Data       = 17
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 4.50
      Lines             = 42.00
      Low Color         = 0
      Size              = 67.40
      Tab Order         = 3
      Thickness         = Very Heavy
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Grid Form1-Gd-1
         SCREEN-COL        = 2.00
         SCREEN-LINE       = 5.00
         LOCK-CONTROL      = TRUE
         (Name)            = Form1-Gd-1
         Action            = (None)
         Adjustable Columns = TRUE
         Auto load         = 0
         Auto load ReadDirection = next
         Auto load StartDirection = >=
         Auto load StartValue = low-value
         Border            = 3D
         Centered Headings = TRUE
         Color             = 0
         Column            = 1.50
         Column Headings   = TRUE
         Columns' Setting  = ( X = 1, Name = Gd-1-Col-1 )
         Columns' Setting  = ( Column Protection = 1 )
         Columns' Setting  = ( PIC = "X(08)", ALIGN = "U" )
         Columns' Setting  = ( DISP = 8, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 2, Name = Gd-1-Col-2 )
         Columns' Setting  = ( Column Protection = 1 )
         Columns' Setting  = ( PIC = "X(250)", ALIGN = "L" )
         Columns' Setting  = ( DISP = 30, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 3, Name = Gd-1-Col-3 )
         Columns' Setting  = ( Column Protection = 1 )
         Columns' Setting  = ( PIC = "X(08)", ALIGN = "U" )
         Columns' Setting  = ( DISP = 8, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 4, Name = Gd-1-Col-4 )
         Columns' Setting  = ( PIC = "X(100)", ALIGN = "U" )
         Columns' Setting  = ( DISP = 10, SEPA = 5, DIVI = 1 )
         Columns' Setting  = ( X = 5, Name = Gd-1-Col-5 )
         Columns' Setting  = ( PIC = "X(08)", ALIGN = "U" )
         Columns' Setting  = ( DISP = 8, SEPA = 5, DIVI = 1 )
         Cursor Color      = 0
         Cursor Frame Width = 3
         Cursor X          = 0
         Cursor Y          = 0
         Destroy Type      = Automatic
         Divider Color     = 1
         Drag Color        = 1
         Enable            = 1:TRUE
         End Color         = 0
         Font              = Small Font
         Font Variable     = Small-Font
         Heading Color     = 208
         Heading Divider Color = 1
         Heading Font      = Small Font
         Heading Font Variable = Small-Font
         Help ID           = 0
         Hscroll           = TRUE
         ID                = 3
         Last Row          = 0
         Layout Data       = 17
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 1.50
         Lines             = 41.10
         No Cell Drag      = FALSE
         No Tab            = FALSE
         Num Column Headings = 1
         Num Columns       = 5
         Num Rows          = 0
         Paged             = FALSE
         Record Data       = Form1-Gd-1-Record
         Row Dividers      = 1
         Row Headings      = TRUE
         Size              = 66.60
         Tab Order         = 1
         Tiled Headings    = TRUE
         Use Tab           = FALSE
         Virtual Width     = 0
         Visible           = 1:TRUE
         Vpadding          = 50
         Vscroll           = TRUE
         Event Procedure   = Form1-Gd-1-Event-Proc
         Msg-Finish-Entry  = Form1-Gd-1-Ev-Msg-Finish-Entry
      End
   End
End

END-SPDATA

@}}

{{@REPORT:
*   Report Writer Data
*   Schema 6.0
*
BEGIN-RWDATA-6.0A

END-RWDATA

@}}

{{@PARAGRAPH:
*
 Form1-Aft-Initdata.
      open i-o genelfis
      initialize genelfis-rec 
      move 1          to genelfis-anahtar
      read genelfis no lock invalid 
           continue 
      not invalid 
           add 1        to EKRAN-FIS-1
      end-read          
      close genelfis
      move EKRAN-FIS-1        to takas-no

      open output takas close takas open i-o takas 

      open input rez
      initialize rez-rec
      start rez key not < rez-anah invalid 
           continue 
      not invalid 
      perform with test after until fs-rez = "10"
      read rez next no lock end move "10"  to fs-rez 
      not at end

              initialize takas-rec 
              move rez-acenta   to takas-acenta 
              move rez-anlasma  to takas-anlasma 
              read takas no lock invalid  
                   move 1       to takas-rez-adet
                   write takas-rec invalid 
                      stop " " 
                   end-write
              not invalid 
                    add 1       to takas-rez-adet
                    rewrite takas-rec invalid 
                       stop " " 
                    end-rewrite 
              end-read 
      end-read 
      end-perform
      end-start
      close rez takas 
         perform grid-baslik-yukle
      open input takas acenta 
      initialize takas-rec
      start takas key not < takas-anahtar invalid 
          continue 
      not invalid 
      perform with test after until fs-takas = "10"
      read takas next no lock end move "10"  to fs-takas
      not at end 
             initialize form1-gd-1-record
             move takas-acenta            to gd-1-col-1
             initialize acenta-rec
             move takas-acenta            to acenta-kodu
             read acenta no lock invalid 
                  move "Silinmis Acenta " to acenta-adi
             end-read 
                  move acenta-adi         to gd-1-col-2
             move takas-anlasma           to gd-1-col-3
             move takas-rez-adet          to z-adet
             move z-adet                  to gd-1-col-5
             modify form1-gd-1,record-to-add(form1-gd-1-record)
      end-read 
      end-perform
      end-start 
      close takas acenta
      modify form1-gd-1,mass-update = 0
     
     .
*
 grid-baslik-yukle.
      modify form1-gd-1,reset-grid = 1
                        mass-update = 1
      initialize form1-gd-1-record
      move "Kodu"          to gd-1-col-1
      move "Adi"           to gd-1-col-2
      move "Anlasma"       to gd-1-col-3
      move "Duzeltilecek Anlasma" to gd-1-col-4
      move "Rez Adet"             to gd-1-col-5
      modify form1-gd-1,record-to-add(form1-gd-1-record)

     .
*
 Form1-Bef-Create.
      perform adresleri-tasi
     
     .
*
 Form1-Gd-1-Ev-Msg-Finish-Entry.   
          
      initialize ydk-anlasma-kodu ydk-acenta-kodu kaynak-anlasma-kodu

      inquire form1-gd-1(event-data-2,event-data-1), 
                              cell-data in ydk-anlasma-kodu

      inquire form1-gd-1(event-data-2,3), 
                              cell-data in kaynak-anlasma-kodu

      inquire form1-gd-1(event-data-2,1), 
                              cell-data in ydk-acenta-kodu

      if event-data-1 = 4
          perform rez-duzelt
          perform fiyat-duzelt
          perform anlasma-kabul-duzelt
          perform konuk-duzelt
      end-if.
*
 rez-duzelt.
         open input kodlar02 
         initialize kodlar02-rec 
         move "D"              to kodlar02-tipi
         move ydk-anlasma-kodu to kodlar02-kodu
         read kodlar02 no lock invalid 
              display message box "Anlasma Kodu Tanimsiz..."
                              title "[ Uyari ]"
                              icon 1
                   modify form1-gd-1(event-data-2,event-data-1), 
                                     cell-data "  "
                   close kodlar02
                   exit paragraph 
         end-read          
         close kodlar02
 
      display message box "Anlasmalar Duzeltilecek Eminmisiniz??"
                      title "[ Uyari ]"
                      icon 1
                      type 2
                      default 2
                      returning return-code 
     if return-code = 2
        modify form1-gd-1(event-data-2,event-data-1), 
                         cell-data "  "
         exit paragraph 
     end-if 

     open i-o rez
     initialize rez-rec
     start rez key not < rez-anah invalid
          continue 
     not invalid 
     perform with test after until fs-rez = "10"
     read rez next no lock end move "10"  to fs-rez
     not at end 
             if rez-acenta not = ydk-acenta-kodu
                   exit perform cycle    
             end-if 
             if rez-anlasma not = kaynak-anlasma-kodu
                 exit perform cycle 
             end-if 
                
             move ydk-anlasma-kodu     to rez-anlasma

             accept rez-edit-tarih from century-date  |firat amonra için konuldu 03/11/2020
             accept rez-edit-zaman from time          |                           

             rewrite rez-rec invalid stop " " end-rewrite 

     end-read 
     end-perform
     end-start
     close rez
     display message box "Transfer Islemi Tamamlandi." new-line
                         "Kontrol Ediniz."
                     title "[ Uyari ]"
                     icon 1.
*
 konuk-duzelt.
         open input kodlar02 
         initialize kodlar02-rec 
         move "D"              to kodlar02-tipi
         move ydk-anlasma-kodu to kodlar02-kodu
         read kodlar02 no lock invalid 
              display message box "Anlasma Kodu Tanimsiz..."
                              title "[ Uyari ]"
                              icon 1
                   modify form1-gd-1(event-data-2,event-data-1), 
                                     cell-data "  "
                   close kodlar02
                   exit paragraph 
         end-read          
         close kodlar02
 
*      display message box "Anlasmalar Duzeltilecek Eminmisiniz??"
*                      title "[ Uyari ]"
*                      icon 1
*                      type 2
*                      default 2
*                      returning return-code 
*     if return-code = 2
*        modify form1-gd-1(event-data-2,event-data-1), 
*                         cell-data "  "
*         exit paragraph 
*     end-if 

     open i-o konuk
     initialize konuk-rec
     start konuk key not < konuk-anah invalid
          continue 
     not invalid 
     perform with test after until fs-konuk = "10"
     read konuk next no lock end move "10"  to fs-konuk
     not at end 
             if konuk-acenta not = ydk-acenta-kodu
                   exit perform cycle    
             end-if 
             if konuk-anlasma not = kaynak-anlasma-kodu
                 exit perform cycle 
             end-if 
                
             move ydk-anlasma-kodu     to konuk-anlasma
                     
             rewrite konuk-rec invalid stop " " end-rewrite 

     end-read 
     end-perform
     end-start
     close konuk.
*     display message box "Transfer Islemi Tamamlandi." new-line
*                         "Kontrol Ediniz."
*                     title "[ Uyari ]"
*                     icon 1.
*
 fiyat-duzelt.
     open i-o fiyatana
     initialize fiyatana-rec
     start fiyatana key not < fiyatana-anah invalid
          continue 
     not invalid 
     perform with test after until fs-fiyatana = "10"
     read fiyatana next no lock end move "10"  to fiyatana-rec 
     not at end 
             if fiyatana-acenta not = ydk-acenta-kodu
                 exit perform cycle 
             end-if

             if fiyatana-anlasma not = kaynak-anlasma-kodu
                 exit perform cycle 
             end-if
           
             delete fiyatana end-delete 
             perform log-operation-fiyatana          ||| firat 19-10-2019

             move ydk-anlasma-kodu     to fiyatana-anlasma
             write fiyatana-rec invalid 
*              if d = 1 stop " " end-if 
                  rewrite fiyatana-rec end-rewrite 
             end-write  

     end-read 
     end-perform
     end-start
     close fiyatana
         .
*
 anlasma-kabul-duzelt.
     open i-o aceanlas
     initialize aceanlas-rec 
     move ydk-acenta-kodu     to aceanlas-acenta
     move kaynak-anlasma-kodu to aceanlas-anlasma
     read aceanlas no lock invalid 
          if d = 1 stop " "  end-if 
     not invalid
          delete aceanlas end-delete 
          move ydk-anlasma-kodu to aceanlas-anlasma
          write aceanlas-rec invalid 
               rewrite aceanlas-rec end-rewrite 
          end-write 
     end-read 
     close aceanlas
        .

@}}

[KEY_STATUS_FIELD_FORMAT]
PIC=9(4)
USAGE=[None]

[KEYSTATUS_CONTENT:KS1]
CONDITION=Exit-Pushed
VALUE=27

[KEYSTATUS_CONTENT:KS2]
CONDITION=Message-Received
VALUE=95

[KEYSTATUS_CONTENT:KS3]
CONDITION=Event-Occurred
VALUE=96

[KEYSTATUS_CONTENT:KS4]
CONDITION=Screen-No-Input-Field
VALUE=97

[KEYSTATUS_CONTENT:KS5]
CONDITION=Screen-Time-Out
VALUE=99

[CODE_GENERATION_OPTIONS]
FOLLOW_PROJECT_OPTIONS=1
GENERATE_PROGRAM_FILE=1
GENERATE_WORKING_STORAGE=1
GENERATE_EVENT_PARAGRAPH=1
GENERATE_SCREEN_SECTION=1
GENERATE_REPORT_SECTION=1
GENERATE_PROCEDURE_DIVISION=1
GENERATE_MENU_PARAGRAPH=1
GENERATE_LINKAGE_SECTION=1
REPLACE_REMARK_PART=1
EXCLUDE_PROGRAM_VARIABLE=0
EXCLUDE_PROGRAM_PARAGRAPH=0
PROGRAM_EXTENSION=.cbl
WORKINGSTORAGE_EXTENSION=.wrk
EVENT_EXTENSION=.evt
SCREEN_EXTENSION=.scr
REPORT_EXTENSION=.rpt
PROCEDURE_EXTENSION=.prd
MENU_EXTENSION=.mnu
LINKAGE_EXTENSION=.lks
PROGRAM_FILE_READ_ONLY=0
LINK_CLOSE_TO_OPEN=0
COPYBOOK_READ_ONLY=0
GENERATE_COPY_FILES=1
ACCEPT_CONTROL=4
ANSI_DOCUMENT_FORMAT=0