; CASEMaker AcuBench Program Structure File, Version 9.2
; WARNING: DO NOT MODIFY THIS FILE!

[PROGRAM_CONTENT]
QUIT_CONFIRM=0
MAIN_SCREEN_NAME=Form1

{{@DESCRIPTION:

@}}

[WORKING_STORAGE]
m_nType=1
m_strName=Working Storage
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionWK

@}}
[FDITEM0_WK]
m_strName=etarih
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_WK

@}}
[FDITEM1_WK]
m_strName=egun
m_strRawPic=9(2)
m_strPic=9(2)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_WK

@}}
[FDITEM2_WK]
m_strName=FILLER
m_strRawPic=x
m_strPic=x
m_strDefaultValue="/"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM2_WK

@}}
[FDITEM3_WK]
m_strName=eay
m_strRawPic=9(2)
m_strPic=9(2)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM3_WK

@}}
[FDITEM4_WK]
m_strName=FILLER
m_strRawPic=x
m_strPic=x
m_strDefaultValue="/"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
m_strAlias=FILLER__2
{{@DataItem_m_strDescriptionFDITEM4_WK

@}}
[FDITEM5_WK]
m_strName=eyil
m_strRawPic=9(4)
m_strPic=9(4)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM5_WK

@}}
[FDITEM6_WK]
m_nType=10
m_strName=Small-Font
m_nUsage=37
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM6_WK

@}}
[FDITEM7_WK]
m_nType=10
m_strName=Form1-Handle
m_nUsage=24
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM7_WK

@}}
[FDITEM8_WK]
m_nType=10
m_strName=Form3-St-1-Handle
m_nUsage=51
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM8_WK

@}}
[FDITEM9_WK]
m_nType=10
m_strName=Traditional-Font
m_nUsage=40
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM9_WK

@}}
[FDITEM10_WK]
m_nType=10
m_strName=lb-value
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM10_WK

@}}
[FDITEM11_WK]
m_nType=10
m_strName=Lb-kart-no
m_strRawPic=X(07)
m_strPic=X(07)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM11_WK

@}}
[FDITEM12_WK]
m_nType=10
m_strName=Lb-bas-tarih
m_strRawPic=X(10)
m_strPic=X(10)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM12_WK

@}}
[FDITEM13_WK]
m_nType=10
m_strName=Lb-bit-tarih
m_strRawPic=X(10)
m_strPic=X(10)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM13_WK

@}}
[FDITEM14_WK]
m_nType=10
m_strName=Lb-adi
m_strRawPic=X(12)
m_strPic=X(12)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM14_WK

@}}
[FDITEM15_WK]
m_nType=10
m_strName=Lb-soyadi
m_strRawPic=X(12)
m_strPic=X(12)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM15_WK

@}}


[LINKAGE_SECTION]
m_nType=1
m_strName=Linkage Section
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionLK

@}}
[FDITEM0_LK]
m_strName=kartara-cagir
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_LK

@}}
[FDITEM1_LK]
m_strName=kartara-kart
m_strRawPic=x(7)
m_strPic=x(7)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_LK

@}}


{{@SCREEN:
*   Screen Painter Data
*   Schema 6.0
*
BEGIN-SPDATA

GRAPHICAL-SCREEN

Begin Screen Form1
   PREFIX            = Form3
   LOCK-CONTROL      = FALSE
   (Name)            = Form1
   Absolute Column   = 0
   Absolute Line     = 0
   Action            = (None)
   Auto Minimize     = FALSE
   Auto Resize       = FALSE
   Bind To Thread    = FALSE
   Boxed             = FALSE
   Cell              = TRUE
   Cell Height       = 10
   Cell Measure      = Pixels
   Cell Width        = 10
   Color             = 65793
   Controls Uncropped = FALSE
   Erase Screen      = FALSE
   Font              = Small Font
   Font Variable     = Small-Font
   Handle Variable   = Form1-Handle
   Help ID           = 0
   Label Offset      = 0
   Layout Manager    = None
   Lines             = 29.10
   Link To Thread    = TRUE
   Max Lines         = 0.00
   Max Size          = 0.00
   Measuring Control = Label
   Measuring Font    = Default Font
   Measuring Style   = [None]
   Min Lines         = 0.00
   Min Size          = 0.00
   Modeless          = TRUE
   No Close          = FALSE
   Resizable         = FALSE
   Scroll            = FALSE
   Size              = 45.00
   System Menu       = TRUE
   Title             = "Kart numarasi ..."
   Title Bar         = TRUE
   Unit              = Cells
   User Gray         = TRUE
   User White        = TRUE
   Visible           = 1:TRUE
   Window Type       = Floating
   Wrap              = FALSE
   Exception Procedure = Form1-Exception-Proc
   Other(ex)         = Form1-Ex-Other
   After Create      = Form1-Aft-Create
   After Initdata    = Form1-Aft-Initdata
   Begin Status-Bar Form3-St-1
      LOCK-CONTROL      = FALSE
      (Name)            = Form3-St-1
      Font              = Default Font
      Grip              = TRUE
      Handle Variable   = Form3-St-1-Handle
      Tab Order         = 1
   End
   Begin List-Box lb-kartlar
      SCREEN-COL        = 1.00
      SCREEN-LINE       = 3.20
      LOCK-CONTROL      = FALSE
      (Name)            = lb-kartlar
      Auto load         = 0
      Auto load ReadDirection = next
      Auto load StartDirection = >=
      Auto load StartValue = low-value
      Border            = 3D
      Case              = Mixed
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 1.00
      COLUMN-NAME       = ( Lb-kart-no, Lb-bas-tarih, Lb-bit-tarih, Lb-adi, Lb-soyadi )
      COLUMN-PICTURE    = ( "X(07)", "X(10)", "X(10)", "X(12)", "X(12)" )
      COLUMN-DISPLAY    = ( 8, 11, 11, 12, 12 )
      ALIGNMENT         = ( "U", "U", "U", "U", "U" )
      DIVIDERS          = ( 1, 1, 1, 1 )
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Exception Value   = 0
      Font              = Traditional Font
      Font Variable     = Traditional-Font
      Help ID           = 0
      ID                = 9
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 3.20
      Lines             = 22.60
      Mass Update       = 0:Fast-Update
      No Search         = FALSE
      No Tab            = FALSE
      Notify DblClick   = FALSE
      Notify SelChange  = TRUE
      Paged             = FALSE
      Selection Index   = 0
      Size              = 45.00
      Tab Order         = 2
      Termination Value = 0
      Unsorted          = TRUE
      Value Picture     = X(51)
      Value Variable    = lb-value
      Visible           = 1:TRUE
   End
   Begin Push-Button Form3-Pb-2
      SCREEN-COL        = 11.30
      SCREEN-LINE       = 25.80
      LOCK-CONTROL      = FALSE
      (Name)            = Form3-Pb-2
      Bitmap Frame      = FALSE
      Bitmap Number     = 1
      Bitmap Square     = TRUE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 11.30
      Copy Resource     = TRUE
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Exception Value   = 13
      Flat              = FALSE
      Font              = Default Font
      Help ID           = 0
      ID                = 7
      Is Link           = FALSE
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 25.80
      Lines             = 2.30
      Multiline         = FALSE
      No Auto Default   = FALSE
      No Tab            = FALSE
      Self Act          = FALSE
      Size              = 9.50
      Style             = Other
      Tab Order         = 3
      Termination Value = 0
      Title             = "&Kart sec"
      Transparent Color = -1
      Visible           = 1:TRUE
   End
   Begin Push-Button Form3-Pb-2a
      SCREEN-COL        = 26.20
      SCREEN-LINE       = 25.80
      LOCK-CONTROL      = FALSE
      (Name)            = Form3-Pb-2a
      Bitmap Frame      = FALSE
      Bitmap Number     = 1
      Bitmap Square     = TRUE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 26.20
      Copy Resource     = TRUE
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Exception Value   = 27
      Flat              = FALSE
      Font              = Default Font
      Help ID           = 0
      ID                = 8
      Is Link           = FALSE
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 25.80
      Lines             = 2.20
      Multiline         = FALSE
      No Auto Default   = FALSE
      No Tab            = FALSE
      Self Act          = FALSE
      Size              = 9.50
      Style             = Other
      Tab Order         = 4
      Termination Value = 0
      Title             = "Esc-> Cikis"
      Transparent Color = -1
      Visible           = 1:TRUE
   End
   Begin Label Form3-La-2
      SCREEN-COL        = 1.30
      SCREEN-LINE       = 1.40
      LOCK-CONTROL      = FALSE
      (Name)            = Form3-La-2
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 304
      Column            = 1.30
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Font              = Default Font
      Help ID           = 0
      ID                = 6
      Justification     = Center
      Label Offset      = 0
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.40
      Lines             = 1.50
      No Key Letter     = FALSE
      Size              = 6.30
      Tab Order         = 5
      Title             = "Kart no"
      Transparent       = FALSE
      Visible           = 1:TRUE
   End
   Begin Label Form3-La-2a
      SCREEN-COL        = 8.20
      SCREEN-LINE       = 1.40
      LOCK-CONTROL      = FALSE
      (Name)            = Form3-La-2a
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 304
      Column            = 8.20
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Font              = Default Font
      Help ID           = 0
      ID                = 10
      Justification     = Center
      Label Offset      = 0
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.40
      Lines             = 1.50
      No Key Letter     = FALSE
      Size              = 8.00
      Tab Order         = 6
      Title             = "Bas.Tarih"
      Transparent       = FALSE
      Visible           = 1:TRUE
   End
   Begin Label Form3-La-2aa
      SCREEN-COL        = 16.80
      SCREEN-LINE       = 1.40
      LOCK-CONTROL      = FALSE
      (Name)            = Form3-La-2aa
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 304
      Column            = 16.80
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Font              = Default Font
      Help ID           = 0
      ID                = 11
      Justification     = Center
      Label Offset      = 0
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.40
      Lines             = 1.50
      No Key Letter     = FALSE
      Size              = 8.00
      Tab Order         = 7
      Title             = "Bit.Tarih"
      Transparent       = FALSE
      Visible           = 1:TRUE
   End
   Begin Label Form3-La-2aaa
      SCREEN-COL        = 25.40
      SCREEN-LINE       = 1.40
      LOCK-CONTROL      = FALSE
      (Name)            = Form3-La-2aaa
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 304
      Column            = 25.40
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Font              = Default Font
      Help ID           = 0
      ID                = 12
      Justification     = Center
      Label Offset      = 0
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.40
      Lines             = 1.50
      No Key Letter     = FALSE
      Size              = 8.90
      Tab Order         = 8
      Title             = "Adi"
      Transparent       = FALSE
      Visible           = 1:TRUE
   End
   Begin Label Form3-La-2aaaa
      SCREEN-COL        = 34.90
      SCREEN-LINE       = 1.40
      LOCK-CONTROL      = FALSE
      (Name)            = Form3-La-2aaaa
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 304
      Column            = 34.90
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Font              = Default Font
      Help ID           = 0
      ID                = 13
      Justification     = Center
      Label Offset      = 0
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.40
      Lines             = 1.50
      No Key Letter     = FALSE
      Size              = 10.40
      Tab Order         = 9
      Title             = "Soyadi"
      Transparent       = FALSE
      Visible           = 1:TRUE
   End
End

END-SPDATA

@}}

{{@REPORT:
*   Report Writer Data
*   Schema 6.0
*
BEGIN-RWDATA-6.0A

END-RWDATA

@}}

{{@PARAGRAPH:
*
 Form1-Aft-Initdata.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
     .
*
 Form1-Aft-Create.
     perform adresleri-tasi
     open input genel
     move 1 to genel-anahtar
     read genel no lock invalid
          display message box 
               "Onburo genel parametresi tanimsiz ..."
               icon mb_error_icon
               title "Hata"
               close genel
               goback
     end-read.
     close genel
     move "/asya/ytl/data/cost/" to takvim-adresi
     move cost-sirketi of genel to cst-genel-dosya-adres
                                  kart-dosya-adres
                                  odenmez-dosya-adres
                                  errorlog-dosya-adres
                                  
     open input cst-genel
     move 1 to cst-genel-anahtar.
     read cst-genel no lock invalid
          display message box 
               "Cost genel parametresi tanimsiz ..."
               icon mb_error_icon
               title "Hata"
               close cst-genel
               goback
     end-read.
     close cst-genel.
    
     perform kart-listele

     .
*
 Form1-Ex-Other.
     evaluate key-status
       when 13
         move lb-kart-no to kartara-kart
         set exit-pushed to true
       when other
         continue
     end-evaluate
     .
*
 kart-listele.
    modify lb-kartlar,
            reset-list  = 1
            mass-update = 1
    open input kart odenmez konuk
    initialize kart-rec
    start kart key not < kart-no
      invalid
        continue
      not invalid
        initialize fs-kart
        perform with test after
                until fs-kart = "10"
          read kart next no lock
            end
              move "10" to fs-kart
            not at end
              initialize lb-value
              move kart-no            to lb-kart-no
              move kart-cin-gun       to egun
              move kart-cin-ay        to eay
              move kart-cin-yil       to eyil
              move etarih             to lb-bas-tarih
              move kart-cot-gun       to egun
              move kart-cot-ay        to eay
              move kart-cot-yil       to eyil
              move etarih             to lb-bit-tarih
              evaluate kart-tipi
                when "M"
                when "I"
                  initialize konuk-rec
                  move kart-folio to konuk-folio
                  read konuk record no lock
                    key is konuk-anah
                    invalid
                      move all "*" to konuk-rec
                  end-read
                  move konuk-adi          to lb-adi
                  move konuk-soyadi       to lb-soyadi
                when "O"
                  initialize odenmez-rec
                  move "O"        to odenmez-ilk
                  move kart-folio to odenmez-kodu
                  read odenmez record no lock
                    key is odenmez-anah
                    invalid
                      move all "*" to konuk-rec
                  end-read
                  move odenmez-adi(1:20)  to lb-adi
                  move odenmez-adi(21:)   to lb-soyadi
              end-evaluate
              modify lb-kartlar,
                     item-to-add(lb-value)
          end-read
        end-perform
    end-start
    close kart odenmez konuk
    modify lb-kartlar,
           selection-index = 1
           mass-update = 0.
    .
*
@}}

[KEY_STATUS_FIELD_FORMAT]
PIC=9(4)
USAGE=[None]

[KEYSTATUS_CONTENT:KS1]
CONDITION=Exit-Pushed
VALUE=27

[KEYSTATUS_CONTENT:KS2]
CONDITION=Message-Received
VALUE=95

[KEYSTATUS_CONTENT:KS3]
CONDITION=Event-Occurred
VALUE=96

[KEYSTATUS_CONTENT:KS4]
CONDITION=Screen-No-Input-Field
VALUE=97

[KEYSTATUS_CONTENT:KS5]
CONDITION=Screen-Time-Out
VALUE=99

[CODE_GENERATION_OPTIONS]
FOLLOW_PROJECT_OPTIONS=1
GENERATE_PROGRAM_FILE=1
GENERATE_WORKING_STORAGE=1
GENERATE_EVENT_PARAGRAPH=1
GENERATE_SCREEN_SECTION=1
GENERATE_REPORT_SECTION=1
GENERATE_PROCEDURE_DIVISION=1
GENERATE_MENU_PARAGRAPH=1
GENERATE_LINKAGE_SECTION=1
REPLACE_REMARK_PART=1
EXCLUDE_PROGRAM_VARIABLE=0
EXCLUDE_PROGRAM_PARAGRAPH=0
PROGRAM_EXTENSION=.cbl
WORKINGSTORAGE_EXTENSION=.wrk
EVENT_EXTENSION=.evt
SCREEN_EXTENSION=.scr
REPORT_EXTENSION=.rpt
PROCEDURE_EXTENSION=.prd
MENU_EXTENSION=.mnu
LINKAGE_EXTENSION=.lks
PROGRAM_FILE_READ_ONLY=0
LINK_CLOSE_TO_OPEN=0
COPYBOOK_READ_ONLY=0
GENERATE_COPY_FILES=1
ACCEPT_CONTROL=4
ANSI_DOCUMENT_FORMAT=0