; CASEMaker AcuBench Program Structure File, Version 9.2
; WARNING: DO NOT MODIFY THIS FILE!

[PROGRAM_CONTENT]
QUIT_CONFIRM=0
MAIN_SCREEN_NAME=Form1

{{@DESCRIPTION:

@}}

[WORKING_STORAGE]
m_nType=1
m_strName=Working Storage
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionWK

@}}
[FDITEM0_WK]
m_nType=10
m_strName=Small-Font
m_nUsage=37
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_WK

@}}
[FDITEM1_WK]
m_nType=10
m_strName=Form1-Handle
m_nUsage=24
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_WK

@}}
[FDITEM2_WK]
m_nType=10
m_strName=Form1-St-1-Handle
m_nUsage=51
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM2_WK

@}}
[FDITEM3_WK]
m_nType=10
m_strName=Form1-Gd-1-Record
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM3_WK

@}}
[FDITEM4_WK]
m_nType=10
m_strName=Gd-1-Col-1
m_strRawPic=X(05)
m_strPic=X(05)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM4_WK

@}}
[FDITEM5_WK]
m_nType=10
m_strName=Gd-1-Col-2
m_strRawPic=X(20)
m_strPic=X(20)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM5_WK

@}}
[FDITEM6_WK]
m_nType=10
m_strName=Gd-1-Col-3
m_strRawPic=X(20)
m_strPic=X(20)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM6_WK

@}}
[FDITEM7_WK]
m_nType=10
m_strName=Gd-1-Col-4
m_strRawPic=X(500)
m_strPic=X(500)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM7_WK

@}}
[FDITEM8_WK]
m_nType=10
m_strName=Gd-1-Col-5
m_strRawPic=X(08)
m_strPic=X(08)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM8_WK

@}}
[FDITEM9_WK]
m_nType=10
m_strName=Form1-Gd-2-Record
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM9_WK

@}}
[FDITEM10_WK]
m_nType=10
m_strName=Gd-2-Col-1
m_strRawPic=X(03)
m_strPic=X(03)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM10_WK

@}}
[FDITEM11_WK]
m_nType=10
m_strName=Gd-2-Col-2
m_strRawPic=X(15)
m_strPic=X(15)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM11_WK

@}}
[FDITEM12_WK]
m_nType=10
m_strName=Gd-2-Col-3
m_strRawPic=X(08)
m_strPic=X(08)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM12_WK

@}}
[FDITEM13_WK]
m_nType=10
m_strName=Gd-2-Col-4
m_strRawPic=X(08)
m_strPic=X(08)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM13_WK

@}}
[FDITEM14_WK]
m_nType=10
m_strName=Gd-2-Col-5
m_strRawPic=X(08)
m_strPic=X(08)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM14_WK

@}}
[FDITEM15_WK]
m_strName=giden-dosya
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM15_WK

@}}
[FDITEM16_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=x(20)
m_strDefaultValue="/asya/ytl/liste/rkgi"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM16_WK

@}}
[FDITEM17_WK]
m_strName=giden-no
m_strRawPic=999
m_strPic=999
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM17_WK

@}}
[FDITEM18_WK]
m_strName=gelen-dosya
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM18_WK

@}}
[FDITEM19_WK]
m_strName=FILLER
m_strRawPic=x(20)
m_strPic=x(20)
m_strDefaultValue="/asya/ytl/liste/rkge"
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM19_WK

@}}
[FDITEM20_WK]
m_strName=gelen-no
m_strRawPic=999
m_strPic=999
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM20_WK

@}}
[FDITEM21_WK]
m_strName=fs-giden
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM21_WK

@}}
[FDITEM22_WK]
m_strName=fs-gelen
m_strRawPic=xx
m_strPic=xx
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM22_WK

@}}
[FDITEM23_WK]
m_strName=dep-birlesen
m_strRawPic=x(100)
m_strPic=x(100)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM23_WK

@}}
[FDITEM24_WK]
m_strName=birlesecek-dep
m_strRawPic=x(3)
m_strPic=x(3)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM24_WK

@}}
[FDITEM25_WK]
m_strName=kayit-sayi
m_strRawPic=9(9)
m_strPic=9(9)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM25_WK

@}}


[LINKAGE_SECTION]
m_nType=1
m_strName=Linkage Section
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionLK

@}}
[FDITEM0_LK]
m_strName=link-rez-no
m_strRawPic=9(08)
m_strPic=9(08)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_LK

@}}
[FDITEM1_LK]
m_strName=link-folio-no
m_strRawPic=9(08)
m_strPic=9(08)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_LK

@}}


{{@SCREEN:
*   Screen Painter Data
*   Schema 6.0
*
BEGIN-SPDATA

GRAPHICAL-SCREEN

Begin Screen Form1
   PREFIX            = Form1
   LOCK-CONTROL      = TRUE
   (Name)            = Form1
   Absolute Column   = 0
   Absolute Line     = 0
   Action            = (None)
   Auto Minimize     = FALSE
   Auto Resize       = FALSE
   Bind To Thread    = FALSE
   Boxed             = FALSE
   Cell              = TRUE
   Cell Height       = 10
   Cell Measure      = Pixels
   Cell Width        = 10
   Color             = 65793
   Controls Uncropped = FALSE
   Erase Screen      = FALSE
   Font              = Small Font
   Font Variable     = Small-Font
   Handle Variable   = Form1-Handle
   Help ID           = 0
   Label Offset      = 0
   Layout Manager    = None
   Lines             = 50.20
   Link To Thread    = TRUE
   Max Lines         = 0.00
   Max Size          = 0.00
   Measuring Control = Label
   Measuring Font    = Default Font
   Measuring Style   = [None]
   Min Lines         = 0.00
   Min Size          = 0.00
   Modeless          = TRUE
   No Close          = FALSE
   Resizable         = FALSE
   Scroll            = FALSE
   Size              = 89.00
   System Menu       = TRUE
   Title             = "Routing Kontrol Listesi..."
   Title Bar         = TRUE
   Unit              = Cells
   User Gray         = TRUE
   User White        = TRUE
   Visible           = 1:TRUE
   Window Type       = Floating
   Wrap              = FALSE
   Event Procedure   = Form1-Event-Proc
   Before Create     = Form1-Bef-Create
   After Initdata    = Form1-Aft-Initdata
   After Routine     = Form1-Aft-Routine
   Begin Status-Bar Form1-St-1
      LOCK-CONTROL      = TRUE
      (Name)            = Form1-St-1
      Font              = Small Font
      Font Variable     = Small-Font
      Grip              = TRUE
      Handle Variable   = Form1-St-1-Handle
      PANEL-WIDTHS      = ( 100 )
      PANEL-STYLE       = ( 1 )
      Tab Order         = 1
   End
   Begin Frame Form1-Fr-1
      SCREEN-COL        = 1.00
      SCREEN-LINE       = 1.50
      LOCK-CONTROL      = TRUE
      (Name)            = Form1-Fr-1
      3D Style          = Rimmed
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 1.00
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = TRUE
      Help ID           = 0
      High Color        = 0
      ID                = 1
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.50
      Lines             = 47.50
      Low Color         = 0
      Size              = 88.70
      Tab Order         = 2
      Thickness         = Default
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Frame Form1-Fr-2
         SCREEN-COL        = 1.50
         SCREEN-LINE       = 2.00
         LOCK-CONTROL      = FALSE
         (Name)            = Form1-Fr-2
         3D Style          = Raised
         Alternate         = FALSE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 16
         Column            = 1.50
         Csize             = 0
         Destroy Type      = Automatic
         FILL-COLOR        = 3
         FILL-PERCENT      = 100
         Font              = Default Font
         Full Height       = TRUE
         Help ID           = 0
         High Color        = 0
         ID                = 2
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 1.50
         Lines             = 4.50
         Low Color         = 0
         Size              = 46.00
         Tab Order         = 1
         Thickness         = Default
         Title             = "GELEN"
         Title Position    = 7:Centered vertically and horizontally
         Visible           = 1:TRUE
      End
      Begin Frame Form1-Fr-2a
         SCREEN-COL        = 50.40
         SCREEN-LINE       = 2.00
         LOCK-CONTROL      = FALSE
         (Name)            = Form1-Fr-2a
         3D Style          = Raised
         Alternate         = FALSE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 16
         Column            = 50.40
         Csize             = 0
         Destroy Type      = Automatic
         FILL-COLOR        = 5
         FILL-PERCENT      = 100
         Font              = Default Font
         Full Height       = TRUE
         Help ID           = 0
         High Color        = 0
         ID                = 3
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 1.50
         Lines             = 4.50
         Low Color         = 0
         Size              = 38.80
         Tab Order         = 2
         Thickness         = Default
         Title             = "GIDEN"
         Title Position    = 7:Centered vertically and horizontally
         Visible           = 1:TRUE
      End
      Begin Frame Form1-Fr-3
         SCREEN-COL        = 1.50
         SCREEN-LINE       = 7.00
         LOCK-CONTROL      = FALSE
         (Name)            = Form1-Fr-3
         3D Style          = Rimmed
         Alternate         = FALSE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 1.50
         Csize             = 0
         Destroy Type      = Automatic
         Font              = Default Font
         Full Height       = TRUE
         Help ID           = 0
         High Color        = 0
         ID                = 4
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 6.50
         Lines             = 41.50
         Low Color         = 0
         Size              = 46.50
         Tab Order         = 3
         Thickness         = Default
         Title Position    = 0:Unaligned
         Visible           = 1:TRUE
         Begin Grid Form1-Gd-1
            SCREEN-COL        = 1.80
            SCREEN-LINE       = 7.30
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Gd-1
            Action            = (None)
            Adjustable Columns = TRUE
            Auto load         = 0
            Auto load ReadDirection = next
            Auto load StartDirection = >=
            Auto load StartValue = low-value
            Border            = Boxed
            Centered Headings = TRUE
            Color             = 0
            Column            = 1.30
            Column Headings   = TRUE
            Columns' Setting  = ( X = 1, Name = Gd-1-Col-1 )
            Columns' Setting  = ( PIC = "X(05)", ALIGN = "U" )
            Columns' Setting  = ( DISP = 6, SEPA = 5, DIVI = 1 )
            Columns' Setting  = ( X = 2, Name = Gd-1-Col-2 )
            Columns' Setting  = ( PIC = "X(20)", ALIGN = "L" )
            Columns' Setting  = ( DISP = 25, SEPA = 5, DIVI = 1 )
            Columns' Setting  = ( X = 3, Name = Gd-1-Col-3 )
            Columns' Setting  = ( PIC = "X(20)", ALIGN = "L" )
            Columns' Setting  = ( DISP = 25, SEPA = 5, DIVI = 1 )
            Columns' Setting  = ( X = 4, Name = Gd-1-Col-4 )
            Columns' Setting  = ( PIC = "X(500)", ALIGN = "L" )
            Columns' Setting  = ( DISP = 100, SEPA = 5, DIVI = 1 )
            Columns' Setting  = ( X = 5, Name = Gd-1-Col-5 )
            Columns' Setting  = ( PIC = "X(08)", ALIGN = "U" )
            Columns' Setting  = ( DISP = 8, SEPA = 5, DIVI = 1 )
            Cursor Color      = 0
            Cursor Frame Width = 3
            Cursor X          = 0
            Cursor Y          = 0
            Destroy Type      = Automatic
            Divider Color     = 1
            Drag Color        = 1
            Enable            = 1:TRUE
            End Color         = 0
            Font              = Small Font
            Font Variable     = Small-Font
            Heading Color     = 97
            Heading Divider Color = 1
            Heading Font      = Small Font
            Heading Font Variable = Small-Font
            Help ID           = 0
            Hscroll           = TRUE
            ID                = 6
            Last Row          = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 1.30
            Lines             = 40.70
            No Cell Drag      = FALSE
            No Tab            = FALSE
            Num Column Headings = 1
            Num Columns       = 5
            Num Rows          = 0
            Paged             = FALSE
            Record Data       = Form1-Gd-1-Record
            Row Dividers      = 1
            Row Headings      = TRUE
            Size              = 45.70
            Tab Order         = 1
            Tiled Headings    = TRUE
            Use Tab           = FALSE
            Virtual Width     = 0
            Visible           = 1:TRUE
            Vpadding          = 50
            Vscroll           = TRUE
            Event Procedure   = Form1-Gd-1-Event-Proc
         End
      End
      Begin Frame Form1-Fr-3a
         SCREEN-COL        = 50.40
         SCREEN-LINE       = 7.00
         LOCK-CONTROL      = FALSE
         (Name)            = Form1-Fr-3a
         3D Style          = Rimmed
         Alternate         = FALSE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 50.40
         Csize             = 0
         Destroy Type      = Automatic
         Font              = Default Font
         Full Height       = TRUE
         Help ID           = 0
         High Color        = 0
         ID                = 5
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 6.50
         Lines             = 41.50
         Low Color         = 0
         Size              = 38.60
         Tab Order         = 4
         Thickness         = Default
         Title Position    = 0:Unaligned
         Visible           = 1:TRUE
         Begin Grid Form1-Gd-2
            SCREEN-COL        = 50.70
            SCREEN-LINE       = 7.20
            LOCK-CONTROL      = FALSE
            (Name)            = Form1-Gd-2
            Action            = (None)
            Adjustable Columns = TRUE
            Auto load         = 0
            Auto load ReadDirection = next
            Auto load StartDirection = >=
            Auto load StartValue = low-value
            Border            = Boxed
            Centered Headings = TRUE
            Color             = 0
            Column            = 1.30
            Column Headings   = TRUE
            Columns' Setting  = ( X = 1, Name = Gd-2-Col-1 )
            Columns' Setting  = ( PIC = "X(03)", ALIGN = "U" )
            Columns' Setting  = ( DISP = 4, SEPA = 5, DIVI = 1 )
            Columns' Setting  = ( X = 2, Name = Gd-2-Col-2 )
            Columns' Setting  = ( PIC = "X(15)", ALIGN = "L" )
            Columns' Setting  = ( DISP = 16, SEPA = 5, DIVI = 1 )
            Columns' Setting  = ( X = 3, Name = Gd-2-Col-3 )
            Columns' Setting  = ( PIC = "X(08)", ALIGN = "U" )
            Columns' Setting  = ( DISP = 9, SEPA = 5, DIVI = 1 )
            Columns' Setting  = ( X = 4, Name = Gd-2-Col-4 )
            Columns' Setting  = ( PIC = "X(08)", ALIGN = "U" )
            Columns' Setting  = ( DISP = 9, SEPA = 5, DIVI = 1 )
            Columns' Setting  = ( X = 5, Name = Gd-2-Col-5 )
            Columns' Setting  = ( PIC = "X(08)", ALIGN = "U" )
            Columns' Setting  = ( DISP = 8, SEPA = 5, DIVI = 1 )
            Cursor Color      = 0
            Cursor Frame Width = 3
            Cursor X          = 0
            Cursor Y          = 0
            Destroy Type      = Automatic
            Divider Color     = 1
            Drag Color        = 1
            Enable            = 1:TRUE
            End Color         = 0
            Font              = Small Font
            Font Variable     = Small-Font
            Heading Color     = 161
            Heading Divider Color = 1
            Heading Font      = Small Font
            Heading Font Variable = Small-Font
            Help ID           = 0
            Hscroll           = TRUE
            ID                = 7
            Last Row          = 0
            Layout Data       = 0
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 1.20
            Lines             = 40.70
            No Cell Drag      = FALSE
            No Tab            = FALSE
            Num Column Headings = 1
            Num Columns       = 5
            Num Rows          = 0
            Paged             = FALSE
            Record Data       = Form1-Gd-2-Record
            Row Dividers      = 1
            Row Headings      = TRUE
            Size              = 38.00
            Tab Order         = 1
            Tiled Headings    = TRUE
            Use Tab           = FALSE
            Virtual Width     = 0
            Visible           = 1:TRUE
            Vpadding          = 50
            Vscroll           = TRUE
            Event Procedure   = Form1-Gd-2-Event-Proc
         End
      End
      Begin Bar Form1-Br-1
         SCREEN-COL        = 48.80
         SCREEN-LINE       = 2.00
         LOCK-CONTROL      = TRUE
         (Name)            = Form1-Br-1
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 48.80
         Csize             = 0
         Destroy Type      = Automatic
         Help ID           = 0
         ID                = 8
         Kind              = Vertical
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 1.50
         Line Styles       = Solid
         Position Shift    = 0
         Size (Lines)      = 46.50
         Size (Lines) in Pixels = 465
         Tab Order         = 5
         Visible           = 1:TRUE
         Width             = 3
      End
   End
End

END-SPDATA

@}}

{{@REPORT:
*   Report Writer Data
*   Schema 6.0
*
BEGIN-RWDATA-6.0A

END-RWDATA

@}}

{{@PARAGRAPH:
*
 Form1-Bef-Create.
        perform adresleri-tasi 
        open i-o odalar2.
     
     .
*
 Form1-Aft-Initdata.
              
        open i-o genelfis
        move 1 to genelfis-anahtar
        read genelfis no lock invalid
             accept print-no from time
        not invalid
            add 1 to print-no
            rewrite genelfis-rec end-rewrite
        end-read
        close genelfis
        move print-no         to gelen-no giden-no

        open output gelen close gelen open i-o gelen 
        open output giden close giden open i-o giden
        open input route depkod rez konuk
*/gelen
           perform reze-gore-gelen
           perform folioya-gore-gelen
           perform gelen-grid-yukle
*/giden
           perform reze-gore-giden
           perform folioya-gore-giden
           perform giden-grid-yukle

        close route gelen giden depkod rez konuk.
*
 reze-gore-giden.         
        initialize route-rec      
        move link-rez-no     to route-rezno
        start route key not < route-anah invalid
              continue
        not invalid
        perform with test after until fs-route = "10"
        read route next no lock end move "10"  to fs-route
        not at end 
                if route-rezno <> link-rez-no
                   exit perform 
                end-if
                initialize giden-rec
                move route-depkod          to giden-anah
                read giden no lock invalid
                   if  route-tip = "R" 
                     move route-no         to giden-rez-no
                   else
                      move route-no        to giden-folio-no
                   end-if
                     write giden-rec end-write                     
                end-read
        end-read
        end-perform
        end-start      
     .
*
 folioya-gore-giden.
        initialize route-rec
       
        move link-folio-no     to route-folio 
        start route key not < route-anah invalid
              continue
        not invalid
        perform with test after until fs-route = "10"
        read route next no lock end move "10"  to fs-route
        not at end 
                if route-folio <> link-folio-no
                   exit perform 
                end-if
                initialize giden-rec
                move route-depkod             to giden-anah
                read giden no lock invalid
                     if  route-tip = "R" 
                     move route-no         to giden-rez-no
                     else
                      move route-no         to giden-folio-no
                   end-if
                     write giden-rec end-write                     
                end-read
        end-read
        end-perform
        end-start
      .
*
 giden-grid-yukle.
        modify Form1-Gd-2, RESET-GRID = 1
                           mass-update = 1
        move "Dep"             to gd-2-col-1
        move "Adi"             to gd-2-col-2
        move "Rez No"          to gd-2-col-3
        move "Folio No"        to gd-2-col-4
        modify form1-gd-2,
                        record-to-add(form1-gd-2-record)
        move 1   to kayit-sayi
        initialize giden-rec
        start giden key not < giden-anah invalid
              continue
        not invalid
        perform with test after until fs-giden = "10"
        read giden next no lock end move "10"  to fs-giden
        not at end
                 initialize form1-gd-2-record  
                 move giden-depkod             to gd-2-col-1 depkod-anah
                 read depkod no lock invalid
                      move "Tanimsiz...."   to depkod-adi
                 end-read
                      move depkod-adi       to gd-2-col-2
                 move giden-rez-no          to gd-2-col-3
                 move giden-folio-no        to gd-2-col-4
                 add 1 to kayit-sayi
                 modify form1-gd-2(1,kayit-sayi),
                                 record-to-add(form1-gd-2-record)
                                 hidden-data = gelen-rec
        end-read
        end-perform
        end-start
        modify form1-gd-2,mass-update = 0

      .
*
 reze-gore-gelen.
 
        initialize route-rec
        move "R"             to route-tip
        move link-rez-no     to route-no
        start route key not < route-data invalid
              continue
        not invalid
        perform with test after until fs-route = "10"
        read route next no lock end move "10"  to fs-route
        not at end 
                if route-no <> link-rez-no
                   exit perform 
                end-if
                initialize gelen-rec

                move route-rezno     to gelen-rez-no
                move route-folio     to gelen-folio-no
                read gelen no lock invalid
                                
                     move route-depkod to  gelen-dep
                     write gelen-rec end-write 
                not invalid
                                      
                     move route-depkod         to birlesecek-dep

                     inspect dep-birlesen replacing trailing spaces by low-values
                     inspect birlesecek-dep replacing trailing spaces by low-values
                    string gelen-dep delimited by spaces
                           "-" delimited by size
                            birlesecek-dep  delimited by spaces
                     into dep-birlesen
                     move dep-birlesen   to gelen-dep
                     rewrite gelen-rec end-rewrite 
                end-read
        end-read
        end-perform
        end-start
        .

*
 folioya-gore-gelen.
        initialize route-rec
        move "F"             to route-tip
        move link-folio-no   to route-no
        start route key not < route-data invalid
              continue
        not invalid
        perform with test after until fs-route = "10"
        read route next no lock end move "10"  to fs-route
        not at end 
                if route-no <> link-folio-no
                   exit perform
                end-if
                initialize gelen-rec dep-birlesen
                move route-rezno     to gelen-rez-no
                move route-folio     to gelen-folio-no
                read gelen no lock invalid
                                
                     move route-depkod to  gelen-dep
                     write gelen-rec end-write 
                not invalid
                                      
                     move route-depkod         to birlesecek-dep

                     inspect dep-birlesen replacing trailing spaces by low-values
                     inspect birlesecek-dep replacing trailing spaces by low-values
                     string gelen-dep delimited by spaces
                           "-" delimited by size
                            birlesecek-dep  delimited by spaces
                     into dep-birlesen
                     move dep-birlesen   to gelen-dep
                     rewrite gelen-rec end-rewrite 
                end-read
        end-read
        end-perform
        end-start.
*
 gelen-grid-yukle.
        modify Form1-Gd-1, RESET-GRID = 1
                           mass-update = 1
        move "Oda"             to gd-1-col-1
        move "Adi"             to gd-1-col-2
        move "Soyadi"          to gd-1-col-3
        move "Departmanlar"    to gd-1-col-4
        modify form1-gd-1,
                        record-to-add(form1-gd-1-record)
        move 1   to kayit-sayi
        initialize gelen-rec
        start gelen key not < gelen-anah invalid
              continue
        not invalid
        perform with test after until fs-gelen = "10"
        read gelen next no lock end move "10"  to fs-gelen
        not at end
                 initialize form1-gd-1-record rez-rec 
                 move gelen-rez-no            to rez-no
                 read rez no lock invalid
                      continue
                 not invalid
                      move rez-odano          to o-kisa 
            perform oda-uzat
            move o-uzun to  gd-1-col-1
                      move rez-adi            to gd-1-col-2
                      move rez-soyadi         to gd-1-col-3
                      move gelen-dep          to gd-1-col-4
                 end-read

                 initialize konuk-rec
                 move gelen-folio-no          to konuk-folio
                 read konuk no lock invalid
                      continue
                 not invalid
                      move konuk-odano        to o-kisa 
            perform oda-uzat
            move o-uzun to  gd-1-col-1
                      move konuk-adi          to gd-1-col-2
                      move konuk-soyadi       to gd-1-col-3
                      move gelen-dep          to gd-1-col-4
                 end-read
                 add 1 to kayit-sayi
                 modify form1-gd-1(1,kayit-sayi),
                                 record-to-add(form1-gd-1-record)
                                 hidden-data = gelen-rec
        end-read
        end-perform
        end-start
        modify form1-gd-1,mass-update = 0
        .    
*
 Form1-Aft-Routine.
     close odalar2
     .

@}}

[KEY_STATUS_FIELD_FORMAT]
PIC=9(4)
USAGE=[None]

[KEYSTATUS_CONTENT:KS1]
CONDITION=Exit-Pushed
VALUE=27

[KEYSTATUS_CONTENT:KS2]
CONDITION=Message-Received
VALUE=95

[KEYSTATUS_CONTENT:KS3]
CONDITION=Event-Occurred
VALUE=96

[KEYSTATUS_CONTENT:KS4]
CONDITION=Screen-No-Input-Field
VALUE=97

[KEYSTATUS_CONTENT:KS5]
CONDITION=Screen-Time-Out
VALUE=99

[CODE_GENERATION_OPTIONS]
FOLLOW_PROJECT_OPTIONS=1
GENERATE_PROGRAM_FILE=1
GENERATE_WORKING_STORAGE=1
GENERATE_EVENT_PARAGRAPH=1
GENERATE_SCREEN_SECTION=1
GENERATE_REPORT_SECTION=1
GENERATE_PROCEDURE_DIVISION=1
GENERATE_MENU_PARAGRAPH=1
GENERATE_LINKAGE_SECTION=1
REPLACE_REMARK_PART=1
EXCLUDE_PROGRAM_VARIABLE=0
EXCLUDE_PROGRAM_PARAGRAPH=0
PROGRAM_EXTENSION=.cbl
WORKINGSTORAGE_EXTENSION=.wrk
EVENT_EXTENSION=.evt
SCREEN_EXTENSION=.scr
REPORT_EXTENSION=.rpt
PROCEDURE_EXTENSION=.prd
MENU_EXTENSION=.mnu
LINKAGE_EXTENSION=.lks
PROGRAM_FILE_READ_ONLY=0
LINK_CLOSE_TO_OPEN=0
COPYBOOK_READ_ONLY=0
GENERATE_COPY_FILES=1
ACCEPT_CONTROL=4
ANSI_DOCUMENT_FORMAT=0