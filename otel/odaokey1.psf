; CASEMaker AcuBench Program Structure File, Version 9.2
; WARNING: DO NOT MODIFY THIS FILE!

[PROGRAM_CONTENT]
QUIT_CONFIRM=0
MAIN_SCREEN_NAME=Form1

{{@DESCRIPTION:

@}}

[WORKING_STORAGE]
m_nType=1
m_strName=Working Storage
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionWK

@}}
[FDITEM0_WK]
m_strName=kayit-sayi
m_strRawPic=9(5)
m_strPic=9(5)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_WK

@}}
[FDITEM1_WK]
m_strName=i
m_strRawPic=9(10)
m_strPic=9(10)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_WK

@}}
[FDITEM2_WK]
m_strName=ii
m_strRawPic=9(10)
m_strPic=9(10)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM2_WK

@}}
[FDITEM3_WK]
m_strName=oda-num
m_strRawPic=x(4)
m_strPic=x(4)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM3_WK

@}}
[FDITEM4_WK]
m_strName=kay-say
m_strRawPic=9(5)
m_strPic=9(5)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM4_WK

@}}
[FDITEM5_WK]
m_strName=oda-dizi
m_nItemLevel=1
m_nSync=-1
m_bOccurs=1
m_bFixed=1
m_strRawSize=30
m_nSize=30
{{@DataItem_m_strDescriptionFDITEM5_WK

@}}
[FDITEM6_WK]
m_strName=oda-kod
m_strRawPic=x(2)
m_strPic=x(2)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM6_WK

@}}
[FDITEM7_WK]
m_strName=oda-key
m_strRawPic=9(4)
m_strPic=9(4)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM7_WK

@}}
[FDITEM8_WK]
m_nType=10
m_strName=Small-Font
m_nUsage=37
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM8_WK

@}}
[FDITEM9_WK]
m_nType=10
m_strName=Form1-Handle
m_nUsage=24
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM9_WK

@}}
[FDITEM10_WK]
m_nType=10
m_strName=Form1-Gd-1-Record
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM10_WK

@}}
[FDITEM11_WK]
m_nType=10
m_strName=Gd-1-Col-1
m_strRawPic=X(10)
m_strPic=X(10)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM11_WK

@}}
[FDITEM12_WK]
m_nType=10
m_strName=Gd-1-Col-2
m_strRawPic=x(25)
m_strPic=x(25)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM12_WK

@}}
[FDITEM13_WK]
m_nType=10
m_strName=Form1-Mn-1-Handle
m_nUsage=48
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM13_WK

@}}


[LINKAGE_SECTION]
m_nType=1
m_strName=Linkage Section
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionLK

@}}


{{@SCREEN:
*   Screen Painter Data
*   Schema 6.0
*
BEGIN-SPDATA

GRAPHICAL-SCREEN

Begin Screen Form1
   PREFIX            = Form1
   LOCK-CONTROL      = FALSE
   (Name)            = Form1
   Absolute Column   = 0
   Absolute Line     = 0
   Action            = (None)
   Auto Minimize     = FALSE
   Auto Resize       = FALSE
   Bind To Thread    = FALSE
   Boxed             = FALSE
   Cell              = TRUE
   Cell Height       = 10
   Cell Measure      = Pixels
   Cell Width        = 10
   Color             = 65793
   Controls Uncropped = FALSE
   Erase Screen      = FALSE
   Font              = Small Font
   Font Variable     = Small-Font
   Handle Variable   = Form1-Handle
   Help ID           = 3004
   Label Offset      = 0
   Layout Manager    = None
   Lines             = 44.50
   Link To Thread    = TRUE
   Max Lines         = 0.00
   Max Size          = 0.00
   Measuring Control = Label
   Measuring Font    = Default Font
   Measuring Style   = [None]
   Min Lines         = 0.00
   Min Size          = 0.00
   Modeless          = FALSE
   No Close          = FALSE
   Resizable         = FALSE
   Scroll            = FALSE
   Size              = 44.50
   System Menu       = TRUE
   Title             = "Resepsiyon Oda Okeyleme ..."
   Title Bar         = TRUE
   Unit              = Cells
   User Gray         = TRUE
   User White        = TRUE
   Visible           = 1:TRUE
   Window Type       = Floating
   Wrap              = FALSE
   Event Procedure   = Form1-Event-Proc
   Exception Procedure = Form1-Exception-Proc
   Other(ex)         = Form1-Ex-Other
   Before Create     = Form1-Bef-Create
   After Initdata    = Form1-Aft-Initdata
   Begin Grid Form1-Gd-1
      SCREEN-COL        = 1.00
      SCREEN-LINE       = 1.00
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Gd-1
      Action            = (None)
      Adjustable Columns = FALSE
      Auto load         = 0
      Auto load ReadDirection = next
      Auto load StartDirection = >=
      Auto load StartValue = low-value
      Border            = 3D
      Centered Headings = FALSE
      Color             = 0
      Column            = 1.00
      Column Headings   = TRUE
      Columns' Setting  = ( X = 1, Name = Gd-1-Col-1 )
      Columns' Setting  = ( PIC = "X(10)", ALIGN = "U" )
      Columns' Setting  = ( DISP = 20, SEPA = 5, DIVI = 1 )
      Columns' Setting  = ( X = 2, Name = Gd-1-Col-2 )
      Columns' Setting  = ( PIC = "x(25)", ALIGN = "U" )
      Columns' Setting  = ( DISP = 25, SEPA = 5, DIVI = 1 )
      Cursor Color      = 480
      Cursor Frame Width = 3
      Cursor X          = 0
      Cursor Y          = 0
      Destroy Type      = Automatic
      Divider Color     = 13
      Drag Color        = 1
      Enable            = 1:TRUE
      End Color         = 0
      Font              = Default Font
      Heading Color     = 144
      Heading Divider Color = 1
      Heading Font      = Default Font
      Help ID           = 0
      Hscroll           = FALSE
      ID                = 17
      Last Row          = 0
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 1.00
      Lines             = 44.50
      No Cell Drag      = FALSE
      No Tab            = FALSE
      Num Column Headings = 1
      Num Columns       = 2
      Num Rows          = 0
      Paged             = FALSE
      Pop-Up Menu       = Form1-Mn-1-Handle
      Record Data       = Form1-Gd-1-Record
      Row Dividers      = 1
      Row Headings      = FALSE
      Size              = 44.50
      Tab Order         = 1
      Tiled Headings    = TRUE
      Use Tab           = FALSE
      Virtual Width     = 0
      Visible           = 1:TRUE
      Vpadding          = 50
      Vscroll           = TRUE
      Event Procedure   = Form1-Gd-1-Event-Proc
      Other             = Form1-Gd-1-Ev-Other
   End
   Begin Menu Form1-Mn-1
      SCREEN-COL        = 17.50
      SCREEN-LINE       = 14.50
      LOCK-CONTROL      = FALSE
      (Name)            = Form1-Mn-1
      Handle Variable   = Form1-Mn-1-Handle
      Style             = Pop-Up Menu
      Tab Order         = 2
   End
End

END-SPDATA

@}}

{{@REPORT:
*   Report Writer Data
*   Schema 6.0
*
BEGIN-RWDATA-6.0A

END-RWDATA

@}}

{{@PARAGRAPH:
*
 Form1-Bef-Create.
    perform adresleri-tasi.
    open input kllnc
       move k-kodu-tasi to K-KODU
       read kllnc no lock invalid
               continue
       end-read
     close kllnc
     initialize kodlar02-rec
     move "C" to kodlar02-tipi
     open input kodlar02
     move 1000 to i
     start kodlar02 key not < kodlar02-anah1 invalid continue
       not invalid
         perform with test after until fs-kodlar02 = "10"
           read kodlar02 next no lock end move "10" to fs-kodlar02
             not end
               if kodlar02-tipi not = "C" 
                  move "10" to fs-kodlar02
                else
                  add 1 to i
                  CALL "W$MENU" USING WMENU-ADD, Menu-Handle, 0, 0, kodlar02-adi, i
                  |////KUSADASI RAMADA ICIN KONULDUU
                  if k-durum-degistiremez = 1
                       CALL "W$MENU" USING WMENU-disable, Menu-Handle, 0, 0, kodlar02-adi, i
                  end-if
                  |////
                  initialize oda-dizi(i - 1000)
                  move kodlar02-kodu to oda-kod(i - 1000)
                  move i             to oda-key(i - 1000)
               end-if
           end-read
         end-perform
     end-start
     close kodlar02.
     .
*
 Grid-Goster.
    open input odalar kodlar02.
    modify form1-gd-1, reset-grid  = 1 mass-update = 1.
    move "Oda No"     to gd-1-col-1
    move "Oda Durumu" to gd-1-col-2
    modify form1-gd-1,record-to-add(form1-gd-1-record)
    move 1 to kayit-sayi
    initialize odalar-rec.
    start odalar key not < odalar-anah invalid continue
      not invalid
        perform with test after until fs-odalar = "10"
          read odalar next no lock end move "10" to fs-odalar
            not end 
              if odalar-aktif-pasif = 1
                 exit perform cycle 
              end-if
              move odalar-no to gd-1-col-1
              move odalar-durumu to kodlar02-kodu
              move "C" to kodlar02-tipi
              read kodlar02 no lock invalid move all "*" to kodlar02-adi,end-read
              move kodlar02-adi to gd-1-col-2
              add 1 to kayit-sayi
              modify form1-gd-1,record-to-add(form1-gd-1-record)
              modify form1-gd-1,
                     y = kayit-sayi
                     x = 1
          end-read
        end-perform
    end-start.
    modify form1-gd-1, mass-update = 0.
    close odalar kodlar02.
*
 Form1-Gd-1-Ev-Other.
    evaluate event-type 
         when Msg-Grid-Rbutton-Down
            inquire Form1-Gd-1, x in i y in ii
            inquire Form1-Gd-1(ii,1) cell-data in oda-num
         when msg-begin-entry
           inquire Form1-Gd-1, x in i y in ii
           move event-action-fail to event-action
    end-evaluate.
     .
*
 Form1-Aft-Initdata.
    perform Grid-Goster.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         
*
 Form1-Ex-Other.
    if key-status > 999 and key-status < 1030
       open i-o odalar
       initialize odalar-rec
       move oda-num to odalar-anah
       read odalar no lock invalid continue
         not invalid
           move oda-kod(key-status - 1000) to odalar-durumu house-durumu
           rewrite odalar-rec invalid continue 
           end-rewrite
               perform log-operation-odalar
       end-read
       close odalar

       initialize kodlar02-rec
       open input kodlar02
       move odalar-durumu to kodlar02-kodu
       move "C" to kodlar02-tipi
       read kodlar02 no lock invalid move all "*" to kodlar02-adi,end-read
       close kodlar02
       modify Form1-Gd-1(ii,2), cell-data = kodlar02-adi
       modify Form1-Gd-1, cursor-y = ii, cursor-x = 2, y = ii, x = 2
    end-if.
     .
@}}

[KEY_STATUS_FIELD_FORMAT]
PIC=9(4)
USAGE=[None]

[KEYSTATUS_CONTENT:KS1]
CONDITION=Exit-Pushed
VALUE=27

[KEYSTATUS_CONTENT:KS2]
CONDITION=Message-Received
VALUE=95

[KEYSTATUS_CONTENT:KS3]
CONDITION=Event-Occurred
VALUE=96

[KEYSTATUS_CONTENT:KS4]
CONDITION=Screen-No-Input-Field
VALUE=97

[CODE_GENERATION_OPTIONS]
FOLLOW_PROJECT_OPTIONS=1
GENERATE_PROGRAM_FILE=1
GENERATE_WORKING_STORAGE=1
GENERATE_EVENT_PARAGRAPH=1
GENERATE_SCREEN_SECTION=1
GENERATE_REPORT_SECTION=1
GENERATE_PROCEDURE_DIVISION=1
GENERATE_MENU_PARAGRAPH=1
GENERATE_LINKAGE_SECTION=1
REPLACE_REMARK_PART=1
EXCLUDE_PROGRAM_VARIABLE=0
EXCLUDE_PROGRAM_PARAGRAPH=0
PROGRAM_EXTENSION=.cbl
WORKINGSTORAGE_EXTENSION=.wrk
EVENT_EXTENSION=.evt
SCREEN_EXTENSION=.scr
REPORT_EXTENSION=.rpt
PROCEDURE_EXTENSION=.prd
MENU_EXTENSION=.mnu
LINKAGE_EXTENSION=.lks
PROGRAM_FILE_READ_ONLY=0
LINK_CLOSE_TO_OPEN=0
COPYBOOK_READ_ONLY=0
GENERATE_COPY_FILES=1
ACCEPT_CONTROL=4
ANSI_DOCUMENT_FORMAT=0