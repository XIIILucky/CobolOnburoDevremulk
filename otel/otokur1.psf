; CASEMaker AcuBench Program Structure File, Version 9.2
; WARNING: DO NOT MODIFY THIS FILE!

[PROGRAM_CONTENT]
QUIT_CONFIRM=0
INIT_PROGRAM=1
MAIN_SCREEN_NAME=Screen1

{{@DESCRIPTION:

@}}

[WORKING_STORAGE]
m_nType=1
m_strName=Working Storage
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionWK

@}}
[FDITEM0_WK]
m_nType=10
m_strName=Screen1-Handle
m_nUsage=24
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM0_WK

@}}
[FDITEM1_WK]
m_strName=max-kur
m_strDefaultValue=30
m_nItemLevel=78
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM1_WK

@}}
[FDITEM2_WK]
m_strName=kurlar-deg
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM2_WK

@}}
[FDITEM3_WK]
m_strName=kurlar-satir
m_strRawPic=x(300)
m_strPic=x(300)
m_nItemLevel=2
m_nSync=-1
m_bOccurs=1
m_bFixed=1
m_strRawSize=MAX-KUR
m_nSize=30
{{@DataItem_m_strDescriptionFDITEM3_WK

@}}
[FDITEM4_WK]
m_strName=xml-deg
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM4_WK

@}}
[FDITEM5_WK]
m_strName=xml-currency-kod
m_strRawPic=x(10)
m_strPic=x(10)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM5_WK

@}}
[FDITEM6_WK]
m_strName=xml-unit
m_strRawPic=x(10)
m_strPic=x(10)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM6_WK

@}}
[FDITEM7_WK]
m_strName=xml-forexbuying
m_strRawPic=x(15)
m_strPic=x(15)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM7_WK

@}}
[FDITEM8_WK]
m_strName=xml-forexselling
m_strRawPic=x(15)
m_strPic=x(15)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM8_WK

@}}
[FDITEM9_WK]
m_strName=xml-BanknoteBuying
m_strRawPic=x(15)
m_strPic=x(15)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM9_WK

@}}
[FDITEM10_WK]
m_strName=xml-BanknoteSelling
m_strRawPic=x(15)
m_strPic=x(15)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM10_WK

@}}
[FDITEM11_WK]
m_strName=xml-parse
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM11_WK

@}}
[FDITEM12_WK]
m_strName=xml-parse-kelime
m_strRawPic=x(30)
m_strPic=x(30)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM12_WK

@}}
[FDITEM13_WK]
m_strName=xml-parse-deger
m_strRawPic=x(30)
m_strPic=x(30)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM13_WK

@}}
[FDITEM14_WK]
m_strName=xml-parse-i
m_strRawPic=9(5)
m_strPic=9(5)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM14_WK

@}}
[FDITEM15_WK]
m_strName=xml-parse-ii
m_strRawPic=9(5)
m_strPic=9(5)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM15_WK

@}}
[FDITEM16_WK]
m_strName=xml-parse-iii
m_strRawPic=9(5)
m_strPic=9(5)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM16_WK

@}}
[FDITEM17_WK]
m_strName=xml-parse-boy
m_strRawPic=9(5)
m_strPic=9(5)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM17_WK

@}}
[FDITEM18_WK]
m_strName=bos
m_strRawPic=x(300)
m_strPic=x(300)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
m_strRawSize=MAX-KUR
m_nSize=30
{{@DataItem_m_strDescriptionFDITEM18_WK

@}}
[FDITEM19_WK]
m_strName=dalis
m_strRawPic=x(300)
m_strPic=x(300)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
m_strRawSize=MAX-KUR
m_nSize=30
{{@DataItem_m_strDescriptionFDITEM19_WK

@}}
[FDITEM20_WK]
m_strName=dsatis
m_strRawPic=x(300)
m_strPic=x(300)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
m_strRawSize=MAX-KUR
m_nSize=30
{{@DataItem_m_strDescriptionFDITEM20_WK

@}}
[FDITEM21_WK]
m_strName=ealis
m_strRawPic=x(300)
m_strPic=x(300)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
m_strRawSize=MAX-KUR
m_nSize=30
{{@DataItem_m_strDescriptionFDITEM21_WK

@}}
[FDITEM22_WK]
m_strName=esatis
m_strRawPic=x(300)
m_strPic=x(300)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
m_strRawSize=MAX-KUR
m_nSize=30
{{@DataItem_m_strDescriptionFDITEM22_WK

@}}
[FDITEM23_WK]
m_strName=br
m_strRawPic=x(300)
m_strPic=x(300)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
m_strRawSize=MAX-KUR
m_nSize=30
{{@DataItem_m_strDescriptionFDITEM23_WK

@}}
[FDITEM24_WK]
m_strName=birim
m_strRawPic=9(5)v9(7)
m_strPic=9(5)v9(7)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
m_strRawSize=MAX-KUR
m_nSize=30
{{@DataItem_m_strDescriptionFDITEM24_WK

@}}
[FDITEM25_WK]
m_strName=http-adres
m_strRawPic=x(100)
m_strPic=x(100)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM25_WK

@}}
[FDITEM26_WK]
m_strName=http-buffer
m_strRawPic=x(10000)
m_strPic=x(10000)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM26_WK

@}}
[FDITEM27_WK]
m_strName=http-buffer-size
m_strRawPic=x(4)
m_strPic=x(4)
m_nUsage=9
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM27_WK

@}}
[FDITEM28_WK]
m_strName=etutar
m_strRawPic=zzz,zzz.zzzzz
m_strPic=zzz,zzz.zzzzz
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM28_WK

@}}
[FDITEM29_WK]
m_strName=5-z
m_strRawPic=z,zzz
m_strPic=z,zzz
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM29_WK

@}}
[FDITEM30_WK]
m_strName=kur-adet
m_strRawPic=9(5)
m_strPic=9(5)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM30_WK

@}}
[FDITEM31_WK]
m_strName=i
m_strRawPic=9(10)
m_strPic=9(10)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM31_WK

@}}
[FDITEM32_WK]
m_strName=ii
m_strRawPic=9(10)
m_strPic=9(10)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM32_WK

@}}
[FDITEM33_WK]
m_strName=iii
m_strRawPic=9(10)
m_strPic=9(10)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM33_WK

@}}
[FDITEM34_WK]
m_nType=10
m_strName=tarih
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM34_WK

@}}
[FDITEM35_WK]
m_strName=yil
m_strRawPic=9999
m_strPic=9999
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM35_WK

@}}
[FDITEM36_WK]
m_strName=ay
m_strRawPic=99
m_strPic=99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM36_WK

@}}
[FDITEM37_WK]
m_strName=gun
m_strRawPic=99
m_strPic=99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM37_WK

@}}
[FDITEM38_WK]
m_strName=xml-tarih
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM38_WK

@}}
[FDITEM39_WK]
m_strName=xml-yil
m_strRawPic=9(4)
m_strPic=9(4)
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM39_WK

@}}
[FDITEM40_WK]
m_strName=xml-ay
m_strRawPic=99
m_strPic=99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM40_WK

@}}
[FDITEM41_WK]
m_strName=xml-gun
m_strRawPic=99
m_strPic=99
m_nItemLevel=2
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM41_WK

@}}
[FDITEM42_WK]
m_strName=donus
m_strRawPic=x
m_strPic=x
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM42_WK

@}}
[FDITEM43_WK]
m_strName=bugun-tar
m_strRawPic=x(8)
m_strPic=x(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM43_WK

@}}
[FDITEM44_WK]
m_strName=kurtar
m_strRawPic=x(8)
m_strPic=x(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM44_WK

@}}
[FDITEM45_WK]
m_strName=st
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM45_WK

@}}
[FDITEM46_WK]
m_strName=skurtar
m_strRawPic=9(8)
m_strPic=9(8)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM46_WK

@}}
[FDITEM47_WK]
m_strName=simdi
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM47_WK

@}}
[FDITEM48_WK]
m_strName=simdi-saat
m_strRawPic=9(2)
m_strPic=9(2)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM48_WK

@}}
[FDITEM49_WK]
m_strName=simdi-dak
m_strRawPic=9(2)
m_strPic=9(2)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM49_WK

@}}
[FDITEM50_WK]
m_strName=yuzde
m_strRawPic=9(10)
m_strPic=9(10)
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM50_WK

@}}
[FDITEM51_WK]
m_nType=10
m_strName=Small-Font
m_nUsage=37
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM51_WK

@}}
[FDITEM52_WK]
m_nType=10
m_strName=Screen1-Gd-1-Record
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM52_WK

@}}
[FDITEM53_WK]
m_nType=10
m_strName=Gd-1-Col-1
m_strRawPic=X(03)
m_strPic=X(03)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM53_WK

@}}
[FDITEM54_WK]
m_nType=10
m_strName=Gd-1-Col-7
m_strRawPic=X(01)
m_strPic=X(01)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM54_WK

@}}
[FDITEM55_WK]
m_nType=10
m_strName=Gd-1-Col-2
m_strRawPic=X(30)
m_strPic=X(30)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM55_WK

@}}
[FDITEM56_WK]
m_nType=10
m_strName=Gd-1-Col-8
m_strRawPic=X(05)
m_strPic=X(05)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM56_WK

@}}
[FDITEM57_WK]
m_nType=10
m_strName=Gd-1-Col-3
m_strRawPic=X(13)
m_strPic=X(13)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM57_WK

@}}
[FDITEM58_WK]
m_nType=10
m_strName=Gd-1-Col-4
m_strRawPic=X(13)
m_strPic=X(13)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM58_WK

@}}
[FDITEM59_WK]
m_nType=10
m_strName=Gd-1-Col-5
m_strRawPic=X(13)
m_strPic=X(13)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM59_WK

@}}
[FDITEM60_WK]
m_nType=10
m_strName=Gd-1-Col-6
m_strRawPic=X(13)
m_strPic=X(13)
m_nItemLevel=5
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM60_WK

@}}
[FDITEM61_WK]
m_nType=10
m_strName=yes-bmp
m_strRawPic=S9(6)
m_strPic=S9(6)
m_nUsage=5
m_strDefaultValue=0
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM61_WK

@}}
[FDITEM62_WK]
m_nType=10
m_strName=no-bmp
m_strRawPic=S9(6)
m_strPic=S9(6)
m_nUsage=5
m_strDefaultValue=0
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM62_WK

@}}
[FDITEM63_WK]
m_nType=10
m_strName=Screen1-LM
m_nUsage=54
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM63_WK

@}}
[FDITEM64_WK]
m_nType=10
m_strName=vis-1
m_strRawPic=9
m_strPic=9
m_strDefaultValue=1
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM64_WK

@}}
[FDITEM65_WK]
m_nType=10
m_strName=Screen1-St-1-Handle
m_nUsage=51
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM65_WK

@}}
[FDITEM66_WK]
m_nType=10
m_strName=MS-Serif18BU
m_nUsage=26
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM66_WK

@}}
[FDITEM67_WK]
m_nType=10
m_strName=tarih-onburo
m_strRawPic=X(8)
m_strPic=X(8)
m_nItemLevel=77
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM67_WK

@}}
[FDITEM68_WK]
m_strName=kac-git
m_strRawPic=9
m_strPic=9
m_strDefaultValue=0
m_nItemLevel=1
m_nSync=-1
m_bFixed=1
{{@DataItem_m_strDescriptionFDITEM68_WK

@}}


[LINKAGE_SECTION]
m_nType=1
m_strName=Linkage Section
m_bBlockRecords=1
m_bRecordFixed=1
m_bStandard=1
{{@FD_m_strDescriptionLK

@}}


{{@SCREEN:
*   Screen Painter Data
*   Schema 6.0
*
BEGIN-SPDATA

GRAPHICAL-SCREEN

Begin Screen Screen1
   PREFIX            = Screen1
   LOCK-CONTROL      = TRUE
   (Name)            = Screen1
   Absolute Column   = 0
   Absolute Line     = 0
   Action            = (None)
   Auto Minimize     = FALSE
   Auto Resize       = FALSE
   Bind To Thread    = FALSE
   Boxed             = FALSE
   Cell              = TRUE
   Cell Height       = 10
   Cell Measure      = Pixels
   Cell Width        = 10
   Color             = 65793
   Controls Uncropped = FALSE
   Erase Screen      = FALSE
   Font              = Small Font
   Font Variable     = Small-Font
   Handle Variable   = Screen1-Handle
   Help ID           = 0
   Label Offset      = 0
   Layout Manager    = None
   Layout Manager Handle = Screen1-LM
   Lines             = 57.50
   Link To Thread    = TRUE
   Max Lines         = 0.00
   Max Size          = 0.00
   Measuring Control = Label
   Measuring Font    = Default Font
   Measuring Style   = [None]
   Min Lines         = 0.00
   Min Size          = 0.00
   Modeless          = FALSE
   No Close          = FALSE
   Resizable         = FALSE
   Scroll            = FALSE
   Size              = 62.00
   System Menu       = TRUE
   Title             = "T.C.M.B.Kurlari ..."
   Title Bar         = TRUE
   Unit              = Cells
   User Gray         = FALSE
   User White        = FALSE
   Visible           = 1:TRUE
   Window Type       = Floating
   Wrap              = FALSE
   Event Procedure   = Screen1-Event-Proc
   Exception Procedure = Screen1-Exception-Proc
   Other(ex)         = Screen1-Ex-Other
   Before Create     = Screen1-Bef-Create
   After Initdata    = Screen1-Aft-Initdata
   Begin Grid Screen1-Gd-1
      SCREEN-COL        = 1.10
      SCREEN-LINE       = 11.50
      LOCK-CONTROL      = TRUE
      (Name)            = Screen1-Gd-1
      Action            = (None)
      Adjustable Columns = TRUE
      Auto load         = 0
      Auto load ReadDirection = next
      Auto load StartDirection = >=
      Auto load StartValue = low-value
      Border            = 3D
      Centered Headings = TRUE
      Color             = 0
      Column            = 1.10
      Column Headings   = TRUE
      Columns' Setting  = ( X = 1, Name = Gd-1-Col-1 )
      Columns' Setting  = ( PIC = "X(03)", ALIGN = "U" )
      Columns' Setting  = ( DISP = 5, SEPA = 5, DIVI = 1 )
      Columns' Setting  = ( X = 2, Name = Gd-1-Col-7 )
      Columns' Setting  = ( PIC = "X(01)", ALIGN = "C" )
      Columns' Setting  = ( DISP = 4, SEPA = 5, DIVI = 1 )
      Columns' Setting  = ( X = 3, Name = Gd-1-Col-2 )
      Columns' Setting  = ( PIC = "X(30)", ALIGN = "U" )
      Columns' Setting  = ( DISP = 30, SEPA = 5, DIVI = 1 )
      Columns' Setting  = ( X = 4, Name = Gd-1-Col-8 )
      Columns' Setting  = ( PIC = "X(05)", ALIGN = "R" )
      Columns' Setting  = ( DISP = 6, SEPA = 5, DIVI = 1 )
      Columns' Setting  = ( X = 5, Name = Gd-1-Col-3 )
      Columns' Setting  = ( PIC = "X(13)", ALIGN = "R" )
      Columns' Setting  = ( DISP = 14, SEPA = 5, DIVI = 1 )
      Columns' Setting  = ( X = 6, Name = Gd-1-Col-4 )
      Columns' Setting  = ( PIC = "X(13)", ALIGN = "R" )
      Columns' Setting  = ( DISP = 14, SEPA = 5, DIVI = 1 )
      Columns' Setting  = ( X = 7, Name = Gd-1-Col-5 )
      Columns' Setting  = ( PIC = "X(13)", ALIGN = "R" )
      Columns' Setting  = ( DISP = 14, SEPA = 5, DIVI = 1 )
      Columns' Setting  = ( X = 8, Name = Gd-1-Col-6 )
      Columns' Setting  = ( PIC = "X(13)", ALIGN = "R" )
      Columns' Setting  = ( DISP = 14, SEPA = 5, DIVI = 1 )
      Cursor Color      = 480
      Cursor Frame Width = 1
      Cursor X          = 0
      Cursor Y          = 0
      Destroy Type      = Automatic
      Divider Color     = 1
      Drag Color        = 1
      Enable            = 1:TRUE
      End Color         = 0
      Font              = Default Font
      Heading Color     = 257
      Heading Divider Color = 1
      Heading Font      = Default Font
      Help ID           = 0
      Hscroll           = FALSE
      ID                = 1
      Last Row          = 0
      Layout Data       = 17
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 11.50
      Lines             = 37.00
      No Cell Drag      = FALSE
      No Tab            = FALSE
      Num Column Headings = 1
      Num Columns       = 8
      Num Rows          = 0
      Paged             = FALSE
      Record Data       = Screen1-Gd-1-Record
      Row Dividers      = 1
      Row Headings      = TRUE
      Size              = 61.70
      Tab Order         = 1
      Tiled Headings    = TRUE
      Use Tab           = FALSE
      Virtual Width     = 100
      Visible           = 1:TRUE
      Vpadding          = 50
      Vscroll           = TRUE
      Event Procedure   = Screen1-Gd-1-Event-Proc
      Msg-Begin-Entry   = Screen1-Gd-1-Ev-Msg-Begin-Entry
   End
   Begin Frame Screen1-Fr-1
      SCREEN-COL        = 40.00
      SCREEN-LINE       = 49.00
      LOCK-CONTROL      = TRUE
      (Name)            = Screen1-Fr-1
      3D Style          = Rimmed
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 5
      Column            = 40.00
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 6
      Layout Data       = 32
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 49.00
      Lines             = 6.80
      Low Color         = 0
      Size              = 22.80
      Tab Order         = 2
      Thickness         = Default
      Title             = "Uyarilar"
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Frame Screen1-Fr-2
         SCREEN-COL        = 41.60
         SCREEN-LINE       = 50.30
         LOCK-CONTROL      = TRUE
         (Name)            = Screen1-Fr-2
         3D Style          = Raised
         Alternate         = FALSE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 2.60
         Csize             = 0
         Destroy Type      = Automatic
         Font              = Default Font
         Full Height       = FALSE
         Help ID           = 0
         High Color        = 0
         ID                = 7
         Layout Data       = 32
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.30
         Lines             = 4.50
         Low Color         = 0
         Size              = 9.00
         Tab Order         = 1
         Thickness         = Default
         Title Position    = 0:Unaligned
         Visible           = 1:TRUE
         Begin Bitmap Screen1-Bt-1
            SCREEN-COL        = 42.60
            SCREEN-LINE       = 51.90
            LOCK-CONTROL      = TRUE
            (Name)            = Screen1-Bt-1
            Bitmap            = "yes.bmp"
            Bitmap End        = 0
            Bitmap Handle     = yes-bmp
            Bitmap Number     = 1
            Bitmap Scale      = FALSE
            Bitmap Start      = 0
            Bitmap Timer      = 0
            Column            = 2.00
            Copy Resource     = TRUE
            Destroy Type      = Automatic
            Font              = Default Font
            Help ID           = 0
            ID                = 8
            Layout Data       = 32
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.60
            Lines in Pixels   = 18
            Size in Pixels    = 18
            Tab Order         = 1
            Transparent Color = -1
            Visible           = 1:TRUE
         End
         Begin Label Screen1-La-1
            SCREEN-COL        = 45.20
            SCREEN-LINE       = 52.00
            LOCK-CONTROL      = TRUE
            (Name)            = Screen1-La-1
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 5
            Column            = 4.60
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 9
            Justification     = Unaligned
            Label Offset      = 0
            Layout Data       = 32
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.70
            Lines             = 1.60
            No Key Letter     = FALSE
            Size              = 4.80
            Tab Order         = 2
            Title             = "Sorunsuz"
            Transparent       = FALSE
            Visible           = 1:TRUE
         End
      End
      Begin Frame Screen1-Fr-2a
         SCREEN-COL        = 52.60
         SCREEN-LINE       = 50.30
         LOCK-CONTROL      = TRUE
         (Name)            = Screen1-Fr-2a
         3D Style          = Raised
         Alternate         = FALSE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 13.60
         Csize             = 0
         Destroy Type      = Automatic
         Font              = Default Font
         Full Height       = FALSE
         Help ID           = 0
         High Color        = 0
         ID                = 10
         Layout Data       = 32
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.30
         Lines             = 4.50
         Low Color         = 0
         Size              = 9.00
         Tab Order         = 2
         Thickness         = Default
         Title Position    = 0:Unaligned
         Visible           = 1:TRUE
         Begin Bitmap Screen1-Bt-1a
            SCREEN-COL        = 53.60
            SCREEN-LINE       = 51.90
            LOCK-CONTROL      = TRUE
            (Name)            = Screen1-Bt-1a
            Bitmap            = "no.bmp"
            Bitmap End        = 0
            Bitmap Handle     = no-bmp
            Bitmap Number     = 1
            Bitmap Scale      = FALSE
            Bitmap Start      = 0
            Bitmap Timer      = 0
            Column            = 2.00
            Copy Resource     = TRUE
            Destroy Type      = Automatic
            Font              = Default Font
            Help ID           = 0
            ID                = 11
            Layout Data       = 32
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.60
            Lines in Pixels   = 18
            Size in Pixels    = 18
            Tab Order         = 1
            Transparent Color = -1
            Visible           = 1:TRUE
         End
         Begin Label Screen1-La-1a
            SCREEN-COL        = 56.20
            SCREEN-LINE       = 52.00
            LOCK-CONTROL      = TRUE
            (Name)            = Screen1-La-1a
            Ccol              = 0
            Cline             = 0
            Clines            = 0
            Color             = 5
            Column            = 4.60
            Csize             = 0
            Destroy Type      = Automatic
            Enable            = 1:TRUE
            Font              = Default Font
            Help ID           = 0
            ID                = 12
            Justification     = Unaligned
            Label Offset      = 0
            Layout Data       = 32
            Layout Data Max Height Cells = 0.00
            Layout Data Max Height Pixels = 0
            Layout Data Max Width Cells = 0.00
            Layout Data Max Width Pixels = 0
            Layout Data Min Height Cells = 0.00
            Layout Data Min Height Pixels = 0
            Layout Data Min Width Cells = 0.00
            Layout Data Min Width Pixels = 0
            Line              = 2.70
            Lines             = 1.60
            No Key Letter     = FALSE
            Size              = 4.80
            Tab Order         = 2
            Title             = "Kod yok"
            Transparent       = FALSE
            Visible           = 1:TRUE
         End
      End
   End
   Begin Status-Bar Screen1-St-1
      LOCK-CONTROL      = TRUE
      (Name)            = Screen1-St-1
      Font              = Small Font
      Font Variable     = Small-Font
      Grip              = TRUE
      Handle Variable   = Screen1-St-1-Handle
      PANEL-WIDTHS      = ( 100 )
      PANEL-STYLE       = ( 1 )
      Tab Order         = 3
   End
   Begin Frame Screen1-Fr-3
      SCREEN-COL        = 1.10
      SCREEN-LINE       = 7.00
      LOCK-CONTROL      = TRUE
      (Name)            = Screen1-Fr-3
      3D Style          = Raised
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 1.10
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 2
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 7.00
      Lines             = 4.10
      Low Color         = 0
      Size              = 61.70
      Tab Order         = 4
      Thickness         = Default
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Label Screen1-La-2
         SCREEN-COL        = 2.10
         SCREEN-LINE       = 8.70
         LOCK-CONTROL      = TRUE
         (Name)            = Screen1-La-2
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 5
         Column            = 2.00
         Csize             = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Font              = Default Font
         Help ID           = 0
         ID                = 13
         Justification     = Unaligned
         Label Offset      = 0
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.70
         Lines             = 1.40
         No Key Letter     = FALSE
         Size              = 8.20
         Tab Order         = 1
         Title             = "Tarih :"
         Transparent       = FALSE
         Visible           = 1:TRUE
      End
      Begin Date-Entry Screen1-De-1
         SCREEN-COL        = 11.10
         SCREEN-LINE       = 8.20
         LOCK-CONTROL      = TRUE
         (Name)            = Screen1-De-1
         Column            = 11.00
         Destroy Type      = Automatic
         Display Format    = SHORT-DATE
         Enable            = 1:TRUE
         Enable Variable   = vis-1
         Font              = Default Font
         Help ID           = 0
         ID                = 14
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.20
         Lines             = 2.00
         No F4             = FALSE
         No Tab            = FALSE
         No Updown         = FALSE
         Notify Change     = TRUE
         Right Align       = 0:FALSE
         Show None         = 0:FALSE
         Size              = 16.90
         Spinner           = 0:FALSE
         Tab Order         = 2
         Value Format      = YYYYMMDD
         Value Picture     = X(8)
         Value Variable    = tarih
         Visible           = 1:TRUE
         Exception Procedure = Screen1-De-1-Exception-Proc
         Ntf-Changed(ex)   = Screen1-De-1-Ex-Ntf-Changed
      End
      Begin Label Screen1-La-2a
         SCREEN-COL        = 35.60
         SCREEN-LINE       = 8.70
         LOCK-CONTROL      = FALSE
         (Name)            = Screen1-La-2a
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 5
         Column            = 35.50
         Csize             = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Font              = Default Font
         Help ID           = 0
         ID                = 16
         Justification     = Unaligned
         Label Offset      = 0
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.70
         Lines             = 1.40
         No Key Letter     = FALSE
         Size              = 8.20
         Tab Order         = 3
         Title             = "Onburo Tarihi :"
         Transparent       = FALSE
         Visible           = 1:TRUE
      End
      Begin Date-Entry Screen1-De-1a
         SCREEN-COL        = 43.60
         SCREEN-LINE       = 8.20
         LOCK-CONTROL      = FALSE
         (Name)            = Screen1-De-1a
         Column            = 43.50
         Destroy Type      = Automatic
         Display Format    = SHORT-DATE
         Enable            = 1:TRUE
         Enable Variable   = vis-1
         Font              = Default Font
         Help ID           = 0
         ID                = 17
         Layout Data       = 0
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 2.20
         Lines             = 2.00
         No F4             = FALSE
         No Tab            = FALSE
         No Updown         = FALSE
         Notify Change     = TRUE
         Right Align       = 0:FALSE
         Show None         = 0:FALSE
         Size              = 16.90
         Spinner           = 0:FALSE
         Tab Order         = 4
         Value Format      = YYYYMMDD
         Value Picture     = X(8)
         Value Variable    = tarih-onburo
         Visible           = 1:TRUE
      End
   End
   Begin Frame Screen1-Fr-4
      SCREEN-COL        = 2.00
      SCREEN-LINE       = 49.00
      LOCK-CONTROL      = TRUE
      (Name)            = Screen1-Fr-4
      3D Style          = Rimmed
      Alternate         = FALSE
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 0
      Column            = 2.00
      Csize             = 0
      Destroy Type      = Automatic
      Font              = Default Font
      Full Height       = FALSE
      Help ID           = 0
      High Color        = 0
      ID                = 4
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 49.00
      Lines             = 6.80
      Low Color         = 0
      Size              = 37.00
      Tab Order         = 5
      Thickness         = Default
      Title Position    = 0:Unaligned
      Visible           = 1:TRUE
      Begin Push-Button Screen1-Pb-1
         SCREEN-COL        = 7.20
         SCREEN-LINE       = 51.10
         LOCK-CONTROL      = TRUE
         (Name)            = Screen1-Pb-1
         Bitmap Frame      = FALSE
         Bitmap Number     = 1
         Bitmap Square     = TRUE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 6.20
         Copy Resource     = TRUE
         Csize             = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Exception Value   = 2
         Flat              = FALSE
         Font              = Default Font
         Help ID           = 0
         ID                = 5
         Is Link           = FALSE
         Layout Data       = 32
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 3.10
         Lines             = 3.40
         Multiline         = FALSE
         No Auto Default   = FALSE
         No Tab            = FALSE
         Self Act          = FALSE
         Size              = 11.10
         Style             = Other
         Tab Order         = 1
         Termination Value = 0
         Title             = "F2- Kaydet"
         Transparent Color = -1
         Visible           = 1:TRUE
      End
      Begin Push-Button Screen1-Pb-1a
         SCREEN-COL        = 22.70
         SCREEN-LINE       = 51.10
         LOCK-CONTROL      = TRUE
         (Name)            = Screen1-Pb-1a
         Bitmap Frame      = FALSE
         Bitmap Number     = 1
         Bitmap Square     = TRUE
         Ccol              = 0
         Cline             = 0
         Clines            = 0
         Color             = 0
         Column            = 21.70
         Copy Resource     = TRUE
         Csize             = 0
         Destroy Type      = Automatic
         Enable            = 1:TRUE
         Exception Value   = 27
         Flat              = FALSE
         Font              = Default Font
         Help ID           = 0
         ID                = 15
         Is Link           = FALSE
         Layout Data       = 32
         Layout Data Max Height Cells = 0.00
         Layout Data Max Height Pixels = 0
         Layout Data Max Width Cells = 0.00
         Layout Data Max Width Pixels = 0
         Layout Data Min Height Cells = 0.00
         Layout Data Min Height Pixels = 0
         Layout Data Min Width Cells = 0.00
         Layout Data Min Width Pixels = 0
         Line              = 3.10
         Lines             = 3.40
         Multiline         = FALSE
         No Auto Default   = FALSE
         No Tab            = FALSE
         Self Act          = FALSE
         Size              = 11.10
         Style             = Other
         Tab Order         = 2
         Termination Value = 0
         Title             = "Esc- Cikis"
         Transparent Color = -1
         Visible           = 1:TRUE
      End
   End
   Begin Label Screen1-La-3
      SCREEN-COL        = 1.50
      SCREEN-LINE       = 2.50
      LOCK-CONTROL      = TRUE
      (Name)            = Screen1-La-3
      Ccol              = 0
      Cline             = 0
      Clines            = 0
      Color             = 2
      Column            = 1.50
      Csize             = 0
      Destroy Type      = Automatic
      Enable            = 1:TRUE
      Font              = MS Serif/18/B/U:0
      Font Variable     = MS-Serif18BU
      Help ID           = 0
      ID                = 3
      Justification     = Center
      Label Offset      = 0
      Layout Data       = 0
      Layout Data Max Height Cells = 0.00
      Layout Data Max Height Pixels = 0
      Layout Data Max Width Cells = 0.00
      Layout Data Max Width Pixels = 0
      Layout Data Min Height Cells = 0.00
      Layout Data Min Height Pixels = 0
      Layout Data Min Width Cells = 0.00
      Layout Data Min Width Pixels = 0
      Line              = 2.50
      Lines             = 3.30
      No Key Letter     = FALSE
      Size              = 60.50
      Tab Order         = 6
      Title             = "INTERNET MERKEZ BANKASI KURLARI - XML"
      Transparent       = FALSE
      Visible           = 1:TRUE
   End
End

END-SPDATA

@}}

{{@REPORT:
*   Report Writer Data
*   Schema 6.0
*
BEGIN-RWDATA-6.0A

END-RWDATA

@}}

{{@PARAGRAPH:
* 
 Screen1-Bef-Create.
    move 0 to vis-1.
    perform adresleri-tasi.

    open input genel.
    move 1 to genel-anahtar
    read genel no lock invalid
          display message box 
                  "Genel parametre tanimsiz ..."
                  icon mb_error_icon
                  close genel
                  set exit-pushed to true
    end-read
    close genel.
        
    move tarih-tasi        to tarih tarih-onburo
    move all low-values    to http-adres
    string http-adres
           "https://www.tcmb.gov.tr/kurlar/today.xml" delimited by low-values
*           yil-tasi                         delimited by low-values
*           ay-tasi                          delimited by low-values
*           "/"                              delimited by low-values
*           gun-tasi                         delimited by low-values
*           ay-tasi                          delimited by low-values
*           yil-tasi                         delimited by low-values
*           ".xml"                          delimited by low-values
           into http-adres.
    inspect http-adres 
            replacing all low-values by spaces.
     .

*Tarihli olursa
*http://www.tcmb.gov.tr/kurlar/200707/04072007.html
*Gunun olursa
*http://www.tcmb.gov.tr/kurlar/today.html
*
*<?xml version="1.0" encoding="ISO-8859-9"?>
*<?xml-stylesheet type="text/xsl" href="isokur.xsl"?>
*<Tarih_Date Tarih="20.08.2010" Date="08/20/2010">
************** TEK SATORON ACILIMDA VAR AMA YANYANA GELÝYERÝ
*</Tarih_Date>


*/ Tek saitirn acilimi
*<Currency Kod="USD" CurrencyCode="USD">
*<Unit>1</Unit>
*<Isim>AMERÝKAN DOLARI</Isim>
*<CurrencyName>US DOLLAR</CurrencyName>
*<ForexBuying>1.5068</ForexBuying>
*<ForexSelling>1.5141</ForexSelling>
*<BanknoteBuying>1.5057</BanknoteBuying>
*<BanknoteSelling>1.5164</BanknoteSelling>
*<CrossRateUSD>1</CrossRateUSD>
*<CrossRateOther></CrossRateOther>
*</Currency>

*
 Screen1-Aft-Initdata.
*/-----------------------------\*  
*/---------DIL AYARLA----------\*    
*/-----------------------------\*    
     perform dil-ayarla-proc.
*/-----------------------------\*         

    modify Screen1-De-1, 
           value = calisma-tarihi.
    modify Screen1-St-1-Handle, title = http-adres.
    perform call-asya-readhttp.
    perform grid-reset.
    perform parse-kurlar.
*
 parse-kurlar.
 


 
    initialize kurlar-deg
    unstring http-buffer 
             delimited by "Kod="
             into bos
                  kurlar-satir(01)
                  kurlar-satir(02)
                  kurlar-satir(03)
                  kurlar-satir(04)
                  kurlar-satir(05)
                  kurlar-satir(06)
                  kurlar-satir(07)
                  kurlar-satir(08)
                  kurlar-satir(09)
                  kurlar-satir(10)
                  kurlar-satir(11)
                  kurlar-satir(12)
                  kurlar-satir(13)
                  kurlar-satir(14)
                  kurlar-satir(15)
                  kurlar-satir(16)
                  kurlar-satir(17)
                  kurlar-satir(18)
                  kurlar-satir(19)
                  kurlar-satir(20)
                  kurlar-satir(21)
                  kurlar-satir(22)
                  kurlar-satir(23)
                  kurlar-satir(24)
                  kurlar-satir(25)
                  kurlar-satir(26)
                  kurlar-satir(27)
                  kurlar-satir(28)
                  kurlar-satir(29)
                  kurlar-satir(30)
    open input doviz
    move 1 to kur-adet
    perform varying i
            from 1
            by 1
            until i > max-kur
*/ gelen dovizi parse et
            move 0 to ii
            inspect kurlar-satir(i) tallying ii for all "Unit"
            if ii = 0 
               exit perform cycle
            end-if
            initialize screen1-gd-1-record
            move kurlar-satir(i)(2:3)   to gd-1-col-1
            perform doviz-bul
            move d-adi-1                to gd-1-col-2


            initialize bos br dalis dsatis ealis esatis
            move all low-values to xml-parse-kelime xml-parse-deger
            string "<Unit>"            delimited by low-values into xml-parse-kelime
            perform parsci-basi
            move xml-parse-deger       to br

            move all low-values to xml-parse-kelime xml-parse-deger
            string "<ForexBuying>"     delimited by low-values into xml-parse-kelime
            perform parsci-basi
            move xml-parse-deger       to dalis

            move all low-values to xml-parse-kelime xml-parse-deger
            string "<ForexSelling>"    delimited by low-values into xml-parse-kelime
            perform parsci-basi
            move xml-parse-deger       to dsatis

            move all low-values to xml-parse-kelime xml-parse-deger
            string "<BanknoteBuying>"  delimited by low-values into xml-parse-kelime
            perform parsci-basi
            move xml-parse-deger       to ealis

            move all low-values to xml-parse-kelime xml-parse-deger
            string "<BanknoteSelling>" delimited by low-values into xml-parse-kelime
            perform parsci-basi
            move xml-parse-deger       to esatis

            
            move function numval-c(dalis)    to etutar
            move etutar                      to gd-1-col-3   
            move function numval-c(dsatis)   to etutar
            move etutar                      to gd-1-col-4   
            move function numval-c(ealis)    to etutar
            move etutar                      to gd-1-col-5   
            move function numval-c(esatis)   to etutar
            move etutar                      to gd-1-col-6 

            move function numval-c(br)       to 5-z
            move 5-z                         to gd-1-col-8 

            add 1                            to kur-adet
            modify screen1-gd-1,
                   record-to-add(screen1-gd-1-record)
            if donus = "E"
               modify Screen1-Gd-1(kur-adet,2),
                      bitmap = yes-bmp
                      bitmap-number = 1
                      bitmap-width = 16
                      hidden-data = "E"
            else
               modify Screen1-Gd-1(kur-adet,2),
                      bitmap = no-bmp
                      bitmap-number = 1
                      bitmap-width = 16
                      hidden-data = "H"
            end-if            
                 
    end-perform.
    close doviz.
    if kur-adet < 2
       display message box
               "Kurlar alinamadi !!!"
               icon mb_warning_icon
               title "Kur ...".

*<Currency Kod="USD" CurrencyCode="USD">
*<Unit>1</Unit>
*<Isim>AMERÝKAN DOLARI</Isim>
*<CurrencyName>US DOLLAR</CurrencyName>
*<ForexBuying>1.5068</ForexBuying>
*<ForexSelling>1.5141</ForexSelling>
*<BanknoteBuying>1.5057</BanknoteBuying>
*<BanknoteSelling>1.5164</BanknoteSelling>
*<CrossRateUSD>1</CrossRateUSD>
*<CrossRateOther></CrossRateOther>
*</Currency>

*
 parsci-basi.
    move 0 to xml-parse-i xml-parse-ii xml-parse-iii xml-parse-boy
    inspect xml-parse-kelime tallying xml-parse-boy for all low-values
    compute xml-parse-boy = function length(xml-parse-kelime) - xml-parse-boy

    perform varying ii
            from 1
            by 1
            until ii > function length(kurlar-satir(i))
                  if xml-parse-kelime(1:xml-parse-boy) = kurlar-satir(i)(ii:xml-parse-boy)
                     compute xml-parse-i = xml-parse-boy + ii
                     perform varying xml-parse-i
                             from xml-parse-i
                             by 1
                             until xml-parse-i > function length(kurlar-satir(i))
                                   if kurlar-satir(i)(xml-parse-i:1) = "<"
                                      perform nokta-virgul
                                      exit paragraph
                                   else
                                      add 1 to xml-parse-ii
                                      move kurlar-satir(i)(xml-parse-i:1)  to xml-parse-deger(xml-parse-ii:1)
                                   end-if
                     end-perform
                  end-if
    end-perform.
    perform nokta-virgul.

*
 nokta-virgul.
    if genel-nokta-virgul = ","
        inspect xml-parse-deger replacing all "." by "V"
        inspect xml-parse-deger replacing all "," by "."
        inspect xml-parse-deger replacing all "V" by ","
    end-if.
    
*
 grid-reset.
    modify Screen1-Gd-1, 
           reset-grid = 1
           mass-update = 1
    initialize screen1-gd-1-record
    move "Kur"               to gd-1-col-1
    move "Kur adi"           to gd-1-col-2
    move "Carpn"             to gd-1-col-8
    move "Doviz Alis"        to gd-1-col-3    
    move "Doviz Satis"       to gd-1-col-4
    move "Efektif Alis"      to gd-1-col-5
    move "Efektif Satis"     to gd-1-col-6
    modify screen1-gd-1,
           record-to-add(screen1-gd-1-record)
    modify Screen1-Gd-1, 
           mass-update = 0.


*
 eski-kur.
    perform grid-reset.

    inquire Screen1-De-1, 
            value in tarih.

    display message box 
            gun,"/",ay,"/",yil," tarihli merkez bankasi kurlari aliniyor"
            icon mb_default-icon
            title "Bilginize ...".

*http://www.tcmb.gov.tr/kurlar/200707/04072007.html
    move all low-values    to http-adres
    string http-adres
           "http://www.tcmb.gov.tr/kurlar/" delimited by low-values
           yil                              delimited by low-values
           ay                               delimited by low-values
           "/"                              delimited by low-values
           gun                              delimited by low-values
           ay                               delimited by low-values
           yil                              delimited by low-values
           ".xml"                          delimited by low-values
           into http-adres.
    inspect http-adres 
            replacing all low-values by spaces.


    modify Screen1-St-1-Handle, 
            title = http-adres.
    perform call-asya-readhttp.
    perform grid-reset.
    perform parse-kurlar.

    
*
 kaydet.
     move tarih-onburo to tarih
     accept bugun-tar    from century-date
     accept simdi from time
    if bugun-tar = tarih-tasi and tarih-onburo = tarih-tasi and simdi-saat = 15 then 
       display message box "Saat 15:00 ile 16:00 kur alamassiniz"
       exit paragraph
    end-if  
    if kur-adet < 2
       display message box 
               "Kurlar alinamadi !!!"
               icon mb_error_icon
               title "Hata"
               exit paragraph.

    inquire Screen1-De-1, 
            value in tarih.

    move tarih-onburo to tarih
    accept bugun-tar    from century-date
    accept simdi from time
    if bugun-tar = tarih-tasi and tarih-onburo = tarih-tasi and simdi-saat >= 16 then 
       move tarih to st

       move function date-of-integer(function integer-of-date(st) + 1 ) to skurtar
       move skurtar to kurtar

    else
       move  tarih to kurtar
    end-if

    open input banka
    move onkpara-merkez-banka-kodu    to banka-kodu
    read banka no lock invalid
         display message box 
                 "Onburo calisma parametreleri - Onkasa bolumunde Merkez",new-line
                 "Bankasi banka kodu tanimlamasi bulunamadi",new-line,new-line
                 "Kurlar aktarilamiyor once tanimlamayi yapiniz"
                 icon mb_error_icon
                 title "Hata"
         close banka
         exit paragraph
    end-read
    close banka.
       
    open input doviz banka
    open i-o kur
    perform varying i
            from 2
            by 1
            until i > kur-adet
            inquire screen1-gd-1(i),
                    record-data in screen1-gd-1-record
            inquire screen1-gd-1(i,2),
                    hidden-data in donus
            if donus <> "E"
               exit perform cycle
            end-if

            initialize banka-rec kac-git
            start banka key not < banka-kodu invalid
                  continue
            not invalid
            initialize fs-banka
            perform with test after until fs-banka = "10"
            read banka next no lock end move "10" to fs-banka
            not at end

                    if banka-merkez-bankasindan-al not = "E"
                       exit perform cycle
                    end-if


*                    if onkpara-merkez-banka-kodu <> banka-kodu 
*                       exit perform cycle
*                    end-if

                           
                    initialize kur-rec
                    move kurtar                          to kur-tarih
                    move banka-kodu                      to kur-banka
                    perform doviz-bul
                    move doviz-kodu                      to kur-doviz
                    read kur no lock invalid
                         move function numval-c(gd-1-col-8)   to birim
                         move function numval-c(gd-1-col-3)   to doviz-alis
                         compute doviz-alis = doviz-alis / birim 
                         move function numval-c(gd-1-col-4)   to doviz-satis
                         compute doviz-satis = doviz-satis / birim 
                         move function numval-c(gd-1-col-5)   to efektif-alis
                         compute efektif-alis = efektif-alis / birim 
                         move function numval-c(gd-1-col-6)   to efektif-satis
                         compute efektif-satis = efektif-satis / birim 
                         move k-kodu-tasi                     to doviz-staf
        
        
        
                         evaluate banka-cevrim
                         when 1
                            move efektif-satis                to doviz-alis                       
                         when 2
                            move doviz-satis                  to doviz-alis
                         end-evaluate
                          
                         if onkpara-merkez-banka-kodu <> kur-banka and 
                            banka-merkez-bankasina-orani <> 0 and banka-merkez-bankasindan-al = "E"
                              compute doviz-alis = doviz-alis + ((doviz-alis * banka-merkez-bankasina-orani) / 100)
                              compute doviz-satis = doviz-satis + ((doviz-satis * banka-merkez-bankasina-orani) / 100)
                              compute efektif-alis = efektif-alis + ((efektif-alis * banka-merkez-bankasina-orani) / 100)
                              compute efektif-satis = efektif-satis + ((efektif-satis * banka-merkez-bankasina-orani) / 100)
                         end-if
        
                         rewrite kur-rec invalid
                                 write kur-rec end-write
                         end-rewrite
                         perform log-operation-kur
                    not invalid
                        if kac-git = 0 
                           move 1 to kac-git
                           display message box "Kurlar daha once alinmistir." new-line
                                               "Duzeltmeler icin kur girisini kullanabilirsiniz." new-line
                                               "Islem iptal edilmistir.."
                        end-if          
                    end-read    

            end-read
            end-perform
            end-start

            if kac-git = 1 
               close doviz kur banka
               exit paragraph  
            end-if

                                      
    end-perform
      
*/ TL YAZILIYOR
    move "TL "             to gd-1-col-1
    perform doviz-bul
    if donus <> "E"
       move "YTL"          to gd-1-col-1
       perform doviz-bul
       if donus <> "E"
          display message box
          "Turk lirasi tanimlamasi bulunamadi ...",new-line,new-line
          "Doviz kodlari tanimlama programinda TL tanimlamasi Merkez Bankasi Kodu",new-line
          "bolumune TL veya YTL giriniz !!!"
          icon mb_error_icon
          title "Hata ..."
        end-if
    end-if


    if donus = "E"
            initialize banka-rec
            start banka key not < banka-kodu invalid
                  continue
            not invalid
            initialize fs-banka
            perform with test after until fs-banka = "10"
            read banka next no lock end move "10" to fs-banka
            not at end
                    if banka-merkez-bankasindan-al <> "E"
                       exit perform cycle
                    end-if
                 
                    initialize kur-rec
                    move kurtar                       to kur-tarih
                    move banka-kodu                  to kur-banka
                    move doviz-kodu                  to kur-doviz
                    move 1                           to doviz-alis doviz-satis 
                                                        efektif-alis efektif-satis
                    move k-kodu-tasi                 to doviz-staf
                    rewrite kur-rec invalid
                            write kur-rec end-write
                    end-rewrite
            end-read
            end-perform
    end-if

    close doviz kur banka.


    display message box 
           kurtar(7:2) "/" kurtar(5:2) "/" kurtar(1:4) " Tarihine Merkez Bankasi Kurlari Alindi"
            title "Bilginize ...".
    set exit-pushed to true.

*
 doviz-bul.
    initialize doviz-rec donus
    start doviz key not < doviz-kodu invalid
          continue
    not invalid
    initialize fs-doviz
    perform with test after until fs-doviz = "10"
    read doviz next no lock end move "10" to fs-doviz
    not at end            
         if d-merkez-banka-kodu = gd-1-col-1
            move "E" to donus
            exit perform
         end-if
    end-read
    end-perform
    end-start

    if donus <> "E"
       initialize d-adi-1
    end-if
     .

*
 Screen1-Gd-1-Ev-Msg-Begin-Entry.
    move event-action-fail to event-action.
     .
*
 Screen1-De-1-Ex-Ntf-Changed.
    perform eski-kur.
     .
*
 Screen1-Ex-Other.
     if key-status = 2
        perform kaydet
        if kac-git = 1
           display message box "TCBM'den kur alma islemi iptal edildi.."
        end-if
     else
        if key-status = 15
           move 1 to vis-1
        end-if
        display Screen1-De-1 Screen1-De-1a
     end-if.
     
     .
*
 call-asya-readhttp.
     if is-remote
        set ASYA-ReadHttp-Remote to true
        set ASYAdll_Remote       to true
     else
        set ASYA-ReadHttp-local to true
        set ASYAdll_local       to true
     end-if.

     call asyadll on exception
          perform callerr-proc
     end-call

     inspect http-adres replacing trailing spaces by low-values
     move all low-values to http-buffer
     move function length(http-buffer)        to http-buffer-size



     call ASYA_ReadHttp using 
                        by reference http-adres,
                        by reference http-buffer
                        by value http-buffer-size
     on exception
          display message box
                  "Asyadll.dll (ASYA_ReadHttp) bulunamadi !!!",x"0a0d",
                  "Kurlar alinamiyor, Luten Tekrar Deneyiniz ...",x"0a0d",
                  "Server'dan cekilecek *"
                  icon mb_error_icon
                  title "Hata"
          cancel asyadll
          call "c$copy" using "/asya/ytl/dll/asyadll.dll" 
                              "@[DISPLAY]:c:\acucorp\acucbl701\acugt\bin\asyadll.dll"
          set exit-pushed to true
    not on exception
    cancel ASYA_ReadHttp
    cancel asyadll
    end-call.
      
*


@}}

[KEY_STATUS_FIELD_FORMAT]
PIC=9(4)
USAGE=[None]

[KEYSTATUS_CONTENT:KS1]
CONDITION=Exit-Pushed
VALUE=27

[KEYSTATUS_CONTENT:KS2]
CONDITION=Message-Received
VALUE=95

[KEYSTATUS_CONTENT:KS3]
CONDITION=Event-Occurred
VALUE=96

[KEYSTATUS_CONTENT:KS4]
CONDITION=Screen-No-Input-Field
VALUE=97

[KEYSTATUS_CONTENT:KS5]
CONDITION=Screen-Time-Out
VALUE=99

[CODE_GENERATION_OPTIONS]
FOLLOW_PROJECT_OPTIONS=1
GENERATE_PROGRAM_FILE=1
GENERATE_WORKING_STORAGE=1
GENERATE_EVENT_PARAGRAPH=1
GENERATE_SCREEN_SECTION=1
GENERATE_REPORT_SECTION=1
GENERATE_PROCEDURE_DIVISION=1
GENERATE_MENU_PARAGRAPH=1
GENERATE_LINKAGE_SECTION=1
REPLACE_REMARK_PART=1
EXCLUDE_PROGRAM_VARIABLE=0
EXCLUDE_PROGRAM_PARAGRAPH=0
PROGRAM_EXTENSION=.cbl
WORKINGSTORAGE_EXTENSION=.wrk
EVENT_EXTENSION=.evt
SCREEN_EXTENSION=.scr
REPORT_EXTENSION=.rpt
PROCEDURE_EXTENSION=.prd
MENU_EXTENSION=.mnu
LINKAGE_EXTENSION=.lks
PROGRAM_FILE_READ_ONLY=0
LINK_CLOSE_TO_OPEN=0
COPYBOOK_READ_ONLY=0
GENERATE_COPY_FILES=1
ACCEPT_CONTROL=1
ANSI_DOCUMENT_FORMAT=0